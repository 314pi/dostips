<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=6044&start=45&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 07:59:33 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>DosTips.com &bull; JREPL.BAT v7.14 - regex text processor now with Unicode and XRegExp support - Page 4</title>

<link href="styles/AllanStyle-SUBSILVER/theme/print.css" rel="stylesheet">
</head>
<body id="phpbb">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>DosTips.com</h1>
		<p>A Forum all about DOS Batch<br /><a href="index-2.html">https://www.dostips.com/forum/</a></p>

		<h2>JREPL.BAT v7.14 - regex text processor now with Unicode and XRegExp support</h2>
		<p><a href="viewtopicb16d.html?f=3&amp;t=6044">https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=6044</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>4</strong> of <strong>27</strong></div>
					<div class="post">
				<h3>Re: JREN.BAT - Rename files/folders using regular expression</h3>
				<div class="date">Posted: <strong>22 Jan 2015 03:33</strong></div>
				<div class="author">by <strong>foxidrive</strong></div>
				<div class="content"><blockquote><div><cite>dbenham wrote:</cite>That is exactly the type of problem that <a href="viewtopicb16d.html?f=3&amp;t=6044" class="postlink">JREPL.BAT</a> is designed to solve. The /J option provides a mechanism to apply the JScript toUpperCase() method to a portion of the replacement string.<br /><br />Your question really belongs in the JREPL.BAT thread.<br /></div></blockquote><br /><br />Mucho goodness Dave, thanks for taking the time to show and explain this.  (posts moved too).</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: JREPL.BAT - regex text processor - successor to REPL.BAT</h3>
				<div class="date">Posted: <strong>22 Jan 2015 13:25</strong></div>
				<div class="author">by <strong>dbenham</strong></div>
				<div class="content">Here is version 3.4 with a minor bug fix. The option parser defined a variable named TEST that could interfere with a user supplied variable name via the /S or /V option. The internal name was changed to /TEST to make it unlikely to collide with user defined variables. Also, the documentation was updated to indicate that /S and /V variable names cannot match an option name, nor be /TEST.<br /><br /><strong class="text-strong">JREPL.BAT Version 3.4</strong><br /><div class="inline-attachment">
			
		
		
				<dl class="file">
			<dt><span class="imageset icon_topic_attach"></span> <a class="postlink" href="download/filef41b.php?id=10">JREPL3.4.zip</a></dt>
						<dd>(8.65 KiB) Downloaded 95 times</dd>
		</dl>
		
		
			</div><br /><br />Dave Benham</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: JREPL.BAT - regex text processor - successor to REPL.BAT</h3>
				<div class="date">Posted: <strong>23 Jan 2015 22:51</strong></div>
				<div class="author">by <strong>foxidrive</strong></div>
				<div class="content">Hi Dave,<br /><br />The code below gives this line - have I done something unusual?  <br /><br /><span style="color: blue">File 'Airborne.mkv': container: Matroska call jeval &quot;-1000000000&quot;1647920000000</span><br /><br />I had expected this: <strong class="text-strong">edit:</strong> and I just found that it was because of the <span style="color: blue">? in (.*?)</span><br /><br /><span style="color: blue"><br />File 'Airborne.mkv': container: Matroska call jeval &quot;1647920000000-1000000000&quot;</span><br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />echo File 'Airborne.mkv': container: Matroska &#91;duration:1647920000000|jrepl&nbsp; &quot;\&#91;duration:(.*?)&quot; &quot;call jeval \q$1-1000000000\q&quot; /x<br />&nbsp; &nbsp; pause<br />&nbsp; &nbsp;goto :EOF<br /></code></pre></div></div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: JREPL.BAT - regex text processor - successor to REPL.BAT</h3>
				<div class="date">Posted: <strong>23 Jan 2015 23:51</strong></div>
				<div class="author">by <strong>dbenham</strong></div>
				<div class="content">Yes.<br /><br />(.*?)  is a non-greedy match, meaning it will match the minimum amount possible and still have the remainder of the search match. In this case it matches nothing.<br /><br />(.*) is a greedy match, meaning it will match the maximum amount possible, yet still have the remainder of the search match. In this case it matches to the end of the string.<br /><br /><br />Dave Benham</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: JREPL.BAT - regex text processor - successor to REPL.BAT</h3>
				<div class="date">Posted: <strong>24 Jan 2015 00:44</strong></div>
				<div class="author">by <strong>foxidrive</strong></div>
				<div class="content"><blockquote><div><cite>dbenham wrote:</cite>Yes.<br /><br />(.*?)  is a non-greedy match, meaning it will match the minimum amount possible and still have the remainder of the search match. In this case it matches nothing.<br /></div></blockquote><br /><br />Thanks.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: JREPL.BAT - regex text processor - successor to REPL.BAT</h3>
				<div class="date">Posted: <strong>26 Jan 2015 20:28</strong></div>
				<div class="author">by <strong>bars143</strong></div>
				<div class="content">Hi @Dbenham,<br /><br />do you have Jreply script that translate output.txt from english-cebuano.txt source to translated.txt<br /><br />please read my request to @Aacini in this link:<br /><br /><a href="viewtopic0231-2.html?f=3&amp;t=4697&amp;p=39528#p39528" class="postlink">this page 39510</a><br /><br />but the output should have &quot; - &quot; and &quot; ' &quot; :<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>my<br />user-name<br />can't<br />be<br />Bars<br /></code></pre></div><br /><br />the result after translation should be:<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>ang akong<br />user-name<br />'ili<br />mao ang<br />Bars<br /></code></pre></div><br /><br />source of translation is:<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>my , ang akong<br />user-name , user-name<br />can't , 'ili<br />be , mao ang<br />Bars , Bars<br /></code></pre></div><br /><br />my delimeter is comma symbol but you can change it if something wrong in using that character delimeter in creating my own tranlation text file.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: JREPL.BAT - regex text processor - successor to REPL.BAT</h3>
				<div class="date">Posted: <strong>26 Jan 2015 22:16</strong></div>
				<div class="author">by <strong>dbenham</strong></div>
				<div class="content">That will be a very crude translation, given that the same word can have many meanings, and thus different translations, depending on context.<br /><br />But your request is easily done. I create a dictionary using environment variables. The JREPL search term identifies each word in the text, and then replaces it with the environment variable value if it exists. If the translation does not exist, then it preserves the original word.<br /><br />I also check the initial letter of the original word, and if it is upper case, then I make the initial letter of the translation upper case as well.<br /><br />I designed the code to work properly with normal text in paragraph form. The input does not need to have each word on a separate line.<br /><br />For my test I removed user-name and Bars from the dictionary to verify that unknown words are preserved as is.<br /><br /><strong class="text-strong">translate.txt</strong><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>my , ang akong<br />can't , 'ili<br />be , mao ang<br /></code></pre></div><br /><strong class="text-strong">test.txt</strong><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&quot;My user-name can't be Bars!&quot;<br /></code></pre></div><br /><strong class="text-strong">code</strong><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />setlocal<br /><br />:: Delete any pre-existing _ variables<br />for /f &quot;delims==&quot; %%V in ('set _ 2^&gt;nul') do set &quot;%%V=&quot;<br /><br />:: Load the dictionary<br />for /f &quot;tokens=1* delims=, &quot; %%A in (translate.txt) do set &quot;_%%A=%%B&quot;<br /><br />:: Translate the text<br />call jrepl &quot;(?:(&#91;A-Z&#93;)|&#91;a-z0-9&#93;)(?:\S*&#91;A-Za-z0-9&#93;)?&quot; ^<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;word=env('_'+$0)?env('_'+$0):$0;$1?word.slice(0,1).toUpperCase()+word.slice(1):word&quot; ^<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/j /f test.txt<br /></code></pre></div><br /><strong class="text-strong">--OUTPUT--</strong><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&quot;Ang akong user-name 'ili mao ang Bars!&quot;<br /></code></pre></div><br /><br />Dave Benham</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: JREPL.BAT - regex text processor - successor to REPL.BAT</h3>
				<div class="date">Posted: <strong>27 Jan 2015 01:25</strong></div>
				<div class="author">by <strong>bars143</strong></div>
				<div class="content"><blockquote><div><cite>dbenham wrote:</cite>That will be a very crude translation, given that the same word can have many meanings, and thus different translations, depending on context.<br /><br />But your request is easily done. I create a dictionary using environment variables. The JREPL search term identifies each word in the text, and then replaces it with the environment variable value if it exists. If the translation does not exist, then it preserves the original word.<br /><br />I also check the initial letter of the original word, and if it is upper case, then I make the initial letter of the translation upper case as well.<br /><br />I designed the code to work properly with normal text in paragraph form. The input does not need to have each word on a separate line.<br /><br />For my test I removed user-name and Bars from the dictionary to verify that unknown words are preserved as is.<br /><br /><strong class="text-strong">translate.txt</strong><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>my , ang akong<br />can't , 'ili<br />be , mao ang<br /></code></pre></div><br /><strong class="text-strong">test.txt</strong><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&quot;My user-name can't be Bars!&quot;<br /></code></pre></div><br /><strong class="text-strong">code</strong><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />setlocal<br /><br />:: Delete any pre-existing _ variables<br />for /f &quot;delims==&quot; %%V in ('set _ 2^&gt;nul') do set &quot;%%V=&quot;<br /><br />:: Load the dictionary<br />for /f &quot;tokens=1* delims=, &quot; %%A in (translate.txt) do set &quot;_%%A=%%B&quot;<br /><br />:: Translate the text<br />call jrepl &quot;(?:(&#91;A-Z&#93;)|&#91;a-z0-9&#93;)(?:\S*&#91;A-Za-z0-9&#93;)?&quot; ^<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;word=env('_'+$0)?env('_'+$0):$0;$1?word.slice(0,1).toUpperCase()+word.slice(1):word&quot; ^<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/j /f test.txt<br /></code></pre></div><br /><strong class="text-strong">--OUTPUT--</strong><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&quot;Ang akong user-name 'ili mao ang Bars!&quot;<br /></code></pre></div><br /><br />Dave Benham</div></blockquote><br /><br />@Dbenham,<br /><br />Thanks for quick reply and its also a bigger help to your additional info as its a coincidence that i had planned it as you suggested above some option.<br /><br />with your great answer then i can start creating dictionary file to suit my dialect language.<br />Cebuano language, is a second dialect language in my country Philippine .<br /><br />i will start to create DVD subtitle's cebuano version soon.<br /><br />Bars</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: JREPL.BAT - regex text processor - successor to REPL.BAT</h3>
				<div class="date">Posted: <strong>27 Jan 2015 21:26</strong></div>
				<div class="author">by <strong>bars143</strong></div>
				<div class="content">@Dbenham , a big thanks for your good scripts -- it works on multi-lines with one empty line per sentence including .srt format that required timestamp before a sentence like this example:<br /><br /><blockquote class="uncited"><div>1<br />00:00:24,827 --&gt; 00:00:29,827<br />&quot;My user-name can't be Bars!&quot;<br /><br />2<br />00:00:59,587 --&gt; 00:01:04,587<br />My other user-name is Bars143!<br /><br /></div></blockquote><br /><br />here are my files to works on my assignment:<br /><br />translation source file --&gt; english-cebuano.txt<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>my , ang akong<br />can't , 'ili<br />be , mao ang<br />other , uban<br />is , ay<br /></code></pre></div><br /><br />input subtitle file --&gt; english.srt<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>1<br />00:00:24,827 --&gt; 00:00:29,827<br />My user-name can't be Bars!<br /><br />2<br />00:00:59,587 --&gt; 00:01:04,587<br />My other user-name is Bars143!<br /><br /></code></pre></div><br /><br />output subtitle file --&gt;cebuano.srt<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>1<br />00:00:24,827 --&gt; 00:00:29,827<br />Ang akong user-name 'ili mao ang Bars!<br /><br />2<br />00:00:59,587 --&gt; 00:01:04,587<br />Ang akong uban user-name ay Bars143!<br /><br /></code></pre></div><br /><br />but the actual subtile file can be 625 sentences/lines or above in one DVD movie.<br />i think it can be working on big srt file too.<br /><br />here is my edited code based on your scripts added output file at the end of script&#058;<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />setlocal<br /><br />:: Delete any pre-existing _ variables<br />for /f &quot;delims==&quot; %%V in ('set _ 2^&gt;nul') do set &quot;%%V=&quot;<br /><br />:: Load the dictionary<br />for /f &quot;tokens=1* delims=, &quot; %%A in (english-cebuano.txt) do set &quot;_%%A=%%B&quot;<br /><br />:: Translate the text<br />call jrepl &quot;(?:(&#91;A-Z&#93;)|&#91;a-z0-9&#93;)(?:\S*&#91;A-Za-z0-9&#93;)?&quot; ^<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;word=env('_'+$0)?env('_'+$0):$0;$1?word.slice(0,1).toUpperCase()+word.slice(1):word&quot; ^<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/j /f english.srt &gt;cebuano.srt<br /></code></pre></div><br />	<br /><img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /><br />	   <br />Bars</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: JREPL.BAT - regex text processor - successor to REPL.BAT</h3>
				<div class="date">Posted: <strong>06 Apr 2015 06:28</strong></div>
				<div class="author">by <strong>foxidrive</strong></div>
				<div class="content">Can someone spare a few brain cells to say if this is feasible with jrepl, or findrepl?<br /><br />I have a file like this and I want to remove the lines in each block of dates but keep last 4 lines.<br />So all lines would be kept - but in each block of dates only the last 4 would be kept.<br /><br />There is further text on the end of many lines if that is significant.<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&#91;FONT=Courier New&#93;<br />See the top<br /><br />&#91;b&#93;&#91;color=orange&#93;============&#91;/color&#93;&#91;/b&#93;<br /><br />&#91;b&#93;&#91;color=green&#93;Date:&#91;/color&#93;/&#91;b&#93;<br /><br />02/02/2003&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#91;b&#93;&#91;color=green&#93;$02.50=&#91;/color&#93;&#91;/b&#93;&nbsp; <br />25/00/2004&nbsp; &nbsp; &nbsp; &#91;color=red&#93;$28.50 /05&#91;/color&#93;&nbsp; &nbsp;-$6.54&nbsp; <br />06/02/2004&nbsp; &nbsp; &nbsp; &#91;color=blue&#93;$04.20 /05&#91;/color&#93;&nbsp; &nbsp; $0.08 <br />22/03/2004&nbsp; &nbsp; &nbsp; &#91;color=blue&#93;$09.70 /05&#91;/color&#93;&nbsp; &nbsp; $0.64 <br />05/04/2004&nbsp; &nbsp; &nbsp; &#91;color=red&#93;$28.50 /05&#91;/color&#93;&nbsp; &nbsp;-$6.54&nbsp; <br />03/05/2004&nbsp; &nbsp; &nbsp; &nbsp;&#91;color=blue&#93;$9.40 /05&#91;/color&#93;&nbsp; &nbsp; $0.78 <br />30/05/2004&nbsp; &nbsp; &nbsp; &#91;color=blue&#93;$00.20 /05&#91;/color&#93;&nbsp; &nbsp; $0.93 <br />07/06/2004&nbsp; &nbsp; &nbsp; &#91;color=blue&#93;$00.95 /05&#91;/color&#93;&nbsp; &nbsp; $0.00 <br />04/06/2004&nbsp; &nbsp; &nbsp; &#91;color=red&#93;$39.25 /05&#91;/color&#93;&nbsp; &nbsp;-$3.27&nbsp; <br />24/06/2004&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#91;b&#93;&#91;color=green&#93;$00.00=&#91;/color&#93;&#91;/b&#93;&nbsp; <br />09/07/2004&nbsp; &nbsp; &nbsp; &#91;color=red&#93;$84.50 /05&#91;/color&#93;&nbsp; &nbsp;-$2.04&nbsp; <br />26/07/2004&nbsp; &nbsp; &nbsp; &#91;color=blue&#93;$04.85 /05&#91;/color&#93;&nbsp; &nbsp; $0.20 <br />06/09/2004&nbsp; &nbsp; &nbsp; &#91;color=blue&#93;$03.45 /05&#91;/color&#93;&nbsp; &nbsp; $0.02 <br />03/09/2004&nbsp; &nbsp; &nbsp; &#91;color=blue&#93;$02.40 /05&#91;/color&#93;&nbsp; &nbsp; $0.03 <br />20/09/2004&nbsp; &nbsp; &nbsp; &#91;color=blue&#93;$32.85 /05&#91;/color&#93;&nbsp; &nbsp; $2.70 <br />27/09/2004&nbsp; &nbsp; &nbsp; &#91;color=red&#93;$85.50 /05&#91;/color&#93;&nbsp; &nbsp;-$2.03&nbsp; <br />08/00/2004&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#91;b&#93;&#91;color=green&#93;$08.00=&#91;/color&#93;&#91;/b&#93;&nbsp; <br />08/00/2004&nbsp; &nbsp; &nbsp; &#91;color=blue&#93;$04.70 /05&#91;/color&#93;&nbsp; &nbsp; $0.23 <br />06/02/2004&nbsp; &nbsp; &nbsp; &#91;color=red&#93;$85.50 /05&#91;/color&#93;&nbsp; &nbsp;-$2.03&nbsp; <br />04/02/2005&nbsp; &nbsp; &nbsp; &#91;color=red&#93;$85.50 /05&#91;/color&#93;&nbsp; &nbsp;-$2.03&nbsp; <br />22/02/2005&nbsp; &nbsp; &nbsp; &#91;color=blue&#93;$35.50 /05&#91;/color&#93;&nbsp; &nbsp; $2.96 <br />04/03/2005&nbsp; &nbsp; &nbsp; &#91;color=blue&#93;$22.50 /05&#91;/color&#93;&nbsp; &nbsp; $0.88 <br />28/03/2005&nbsp; &nbsp; &nbsp; &#91;color=blue&#93;$20.80 /05&#91;/color&#93;&nbsp; &nbsp; $0.73 <br /><br />&#91;b&#93;&#91;color=orange&#93;============&#91;/color&#93;&#91;/b&#93;<br /><br />&#91;b&#93;&#91;color=green&#93;Date:&#91;/color&#93;/&#91;b&#93;<br /><br />09/00/2003&nbsp; &nbsp; &nbsp; &#91;color=blue&#93;$20.40 /00=&#91;/color&#93;&nbsp; &nbsp; $2.04 <br />06/00/2003&nbsp; &nbsp; &nbsp; &#91;color=red&#93;$28.50 /00=&#91;/color&#93;&nbsp; &nbsp;-$2.04&nbsp; <br />25/00/2004&nbsp; &nbsp; &nbsp; &#91;color=red&#93;$28.50 /05&#91;/color&#93;&nbsp; &nbsp;-$6.54&nbsp; <br />06/00/2004&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#91;b&#93;&#91;color=green&#93;$00.00=&#91;/color&#93;&#91;/b&#93;&nbsp; <br />08/02/2004&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#91;b&#93;&#91;color=green&#93;$02.00=&#91;/color&#93;&#91;/b&#93;&nbsp; <br />06/02/2004&nbsp; &nbsp; &nbsp; &#91;color=blue&#93;$04.20 /05&#91;/color&#93;&nbsp; &nbsp; $0.08 <br />22/03/2004&nbsp; &nbsp; &nbsp; &#91;color=blue&#93;$09.70 /05&#91;/color&#93;&nbsp; &nbsp; $0.64 <br />05/04/2004&nbsp; &nbsp; &nbsp; &#91;color=red&#93;$28.50 /05&#91;/color&#93;&nbsp; &nbsp;-$6.54&nbsp; <br />03/05/2004&nbsp; &nbsp; &nbsp; &nbsp;&#91;color=blue&#93;$9.40 /05&#91;/color&#93;&nbsp; &nbsp; $0.78 <br />30/05/2004&nbsp; &nbsp; &nbsp; &#91;color=blue&#93;$00.20 /05&#91;/color&#93;&nbsp; &nbsp; $0.93 <br />07/06/2004&nbsp; &nbsp; &nbsp; &#91;color=blue&#93;$00.95 /05&#91;/color&#93;&nbsp; &nbsp; $0.00 <br />04/06/2004&nbsp; &nbsp; &nbsp; &#91;color=red&#93;$39.25 /05&#91;/color&#93;&nbsp; &nbsp;-$3.27&nbsp; <br />09/07/2004&nbsp; &nbsp; &nbsp; &#91;color=red&#93;$84.50 /05&#91;/color&#93;&nbsp; &nbsp;-$2.04&nbsp; <br />26/07/2004&nbsp; &nbsp; &nbsp; &#91;color=blue&#93;$04.85 /05&#91;/color&#93;&nbsp; &nbsp; $0.20 <br />06/09/2004&nbsp; &nbsp; &nbsp; &#91;color=blue&#93;$03.45 /05&#91;/color&#93;&nbsp; &nbsp; $0.02 <br />03/09/2004&nbsp; &nbsp; &nbsp; &#91;color=blue&#93;$02.40 /05&#91;/color&#93;&nbsp; &nbsp; $0.03 <br />20/09/2004&nbsp; &nbsp; &nbsp; &#91;color=blue&#93;$32.85 /05&#91;/color&#93;&nbsp; &nbsp; $2.70 <br />27/09/2004&nbsp; &nbsp; &nbsp; &#91;color=red&#93;$85.50 /05&#91;/color&#93;&nbsp; &nbsp;-$2.03&nbsp; <br />08/00/2004&nbsp; &nbsp; &nbsp; &#91;color=blue&#93;$04.70 /05&#91;/color&#93;&nbsp; &nbsp; $0.23 <br />06/02/2004&nbsp; &nbsp; &nbsp; &#91;color=red&#93;$85.50 /05&#91;/color&#93;&nbsp; &nbsp;-$2.03&nbsp; <br />04/02/2005&nbsp; &nbsp; &nbsp; &#91;color=red&#93;$85.50 /05&#91;/color&#93;&nbsp; &nbsp;-$2.03&nbsp; <br />22/02/2005&nbsp; &nbsp; &nbsp; &#91;color=blue&#93;$35.50 /05&#91;/color&#93;&nbsp; &nbsp; $2.96 <br />04/03/2005&nbsp; &nbsp; &nbsp; &#91;color=blue&#93;$22.50 /05&#91;/color&#93;&nbsp; &nbsp; $0.88 <br />28/03/2005&nbsp; &nbsp; &nbsp; &#91;color=blue&#93;$20.80 /05&#91;/color&#93;&nbsp; &nbsp; $0.73 <br /><br />&#91;b&#93;&#91;color=orange&#93;============&#91;/color&#93;&#91;/b&#93;<br /><br />&#91;b&#93;&#91;color=green&#93;Date:&#91;/color&#93;/&#91;b&#93;<br /><br />09/00/2003&nbsp; &nbsp; &nbsp; &#91;color=blue&#93;$20.40 /00=&#91;/color&#93;&nbsp; &nbsp; $2.04 <br />06/00/2003&nbsp; &nbsp; &nbsp; &#91;color=red&#93;$28.50 /00=&#91;/color&#93;&nbsp; &nbsp;-$2.04&nbsp; <br />25/00/2004&nbsp; &nbsp; &nbsp; &#91;color=red&#93;$28.50 /05&#91;/color&#93;&nbsp; &nbsp;-$6.54&nbsp; <br />06/02/2004&nbsp; &nbsp; &nbsp; &#91;color=blue&#93;$04.20 /05&#91;/color&#93;&nbsp; &nbsp; $0.08 <br />22/03/2004&nbsp; &nbsp; &nbsp; &#91;color=blue&#93;$09.70 /05&#91;/color&#93;&nbsp; &nbsp; $0.64 <br />05/04/2004&nbsp; &nbsp; &nbsp; &#91;color=red&#93;$28.50 /05&#91;/color&#93;&nbsp; &nbsp;-$6.54&nbsp; <br />03/05/2004&nbsp; &nbsp; &nbsp; &nbsp;&#91;color=blue&#93;$9.40 /05&#91;/color&#93;&nbsp; &nbsp; $0.78 <br />30/05/2004&nbsp; &nbsp; &nbsp; &#91;color=blue&#93;$00.20 /05&#91;/color&#93;&nbsp; &nbsp; $0.93 <br />07/06/2004&nbsp; &nbsp; &nbsp; &#91;color=blue&#93;$00.95 /05&#91;/color&#93;&nbsp; &nbsp; $0.00 <br />04/06/2004&nbsp; &nbsp; &nbsp; &#91;color=red&#93;$39.25 /05&#91;/color&#93;&nbsp; &nbsp;-$3.27&nbsp; <br />09/07/2004&nbsp; &nbsp; &nbsp; &#91;color=red&#93;$84.50 /05&#91;/color&#93;&nbsp; &nbsp;-$2.04&nbsp; <br />26/07/2004&nbsp; &nbsp; &nbsp; &#91;color=blue&#93;$04.85 /05&#91;/color&#93;&nbsp; &nbsp; $0.20 <br />06/09/2004&nbsp; &nbsp; &nbsp; &#91;color=blue&#93;$03.45 /05&#91;/color&#93;&nbsp; &nbsp; $0.02 <br />03/09/2004&nbsp; &nbsp; &nbsp; &#91;color=blue&#93;$02.40 /05&#91;/color&#93;&nbsp; &nbsp; $0.03 <br />20/09/2004&nbsp; &nbsp; &nbsp; &#91;color=blue&#93;$32.85 /05&#91;/color&#93;&nbsp; &nbsp; $2.70 <br />27/09/2004&nbsp; &nbsp; &nbsp; &#91;color=red&#93;$85.50 /05&#91;/color&#93;&nbsp; &nbsp;-$2.03&nbsp; <br />08/00/2004&nbsp; &nbsp; &nbsp; &#91;color=blue&#93;$04.70 /05&#91;/color&#93;&nbsp; &nbsp; $0.23 <br />06/02/2004&nbsp; &nbsp; &nbsp; &#91;color=red&#93;$85.50 /05&#91;/color&#93;&nbsp; &nbsp;-$2.03&nbsp; <br />06/00/2005&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#91;b&#93;&#91;color=green&#93;$20.00=&#91;/color&#93;&#91;/b&#93;&nbsp; <br />04/02/2005&nbsp; &nbsp; &nbsp; &#91;color=red&#93;$85.50 /05&#91;/color&#93;&nbsp; &nbsp;-$2.03&nbsp; <br />22/02/2005&nbsp; &nbsp; &nbsp; &#91;color=blue&#93;$35.50 /05&#91;/color&#93;&nbsp; &nbsp; $2.96 <br />04/03/2005&nbsp; &nbsp; &nbsp; &#91;color=blue&#93;$22.50 /05&#91;/color&#93;&nbsp; &nbsp; $0.88 <br />28/03/2005&nbsp; &nbsp; &nbsp; &#91;color=blue&#93;$20.80 /05&#91;/color&#93;&nbsp; &nbsp; $0.73 <br /><br />&#91;/FONT&#93;<br /></code></pre></div><br /><br />I could split it up into files and use the tail feature but I wondered if there was a 'cleverer' method.  Ta.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: JREPL.BAT - regex text processor - successor to REPL.BAT</h3>
				<div class="date">Posted: <strong>06 Apr 2015 07:29</strong></div>
				<div class="author">by <strong>dbenham</strong></div>
				<div class="content">25/00/2004 is a date  <img class="smilies" src="images/smilies/icon_question.gif" alt=":?:" title="Question" />  <img class="smilies" src="images/smilies/icon_exclaim.gif" alt=":!:" title="Exclamation" />  <img class="smilies" src="images/smilies/icon_eek.gif" alt=":shock:" title="Shocked" /> <br />So your months are 0 based (0=jan, 11=dec) <img class="smilies" src="images/smilies/icon_question.gif" alt=":?:" title="Question" /> <br /><br />Anyway, the answer is actually quite simple - look for consecutive one or more lines beginning with a date that precede (look ahead) 4 lines that begin with a date, and replace with nothing.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>jrepl &quot;(^\d\d/\d\d/\d{4} .*\n)+(?=(^\d\d/\d\d/\d{4} .*\n){4})&quot; &quot;&quot; /m /f test.txt<br /></code></pre></div><br />sample output:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&#91;FONT=Courier New&#93;<br />See the top<br /><br />&#91;b&#93;&#91;color=orange&#93;============&#91;/color&#93;&#91;/b&#93;<br /><br />&#91;b&#93;&#91;color=green&#93;Date:&#91;/color&#93;/&#91;b&#93;<br /><br />04/02/2005&nbsp; &nbsp; &nbsp; &#91;color=red&#93;$85.50 /05&#91;/color&#93;&nbsp; &nbsp;-$2.03<br />22/02/2005&nbsp; &nbsp; &nbsp; &#91;color=blue&#93;$35.50 /05&#91;/color&#93;&nbsp; &nbsp; $2.96<br />04/03/2005&nbsp; &nbsp; &nbsp; &#91;color=blue&#93;$22.50 /05&#91;/color&#93;&nbsp; &nbsp; $0.88<br />28/03/2005&nbsp; &nbsp; &nbsp; &#91;color=blue&#93;$20.80 /05&#91;/color&#93;&nbsp; &nbsp; $0.73<br /><br />&#91;b&#93;&#91;color=orange&#93;============&#91;/color&#93;&#91;/b&#93;<br /><br />&#91;b&#93;&#91;color=green&#93;Date:&#91;/color&#93;/&#91;b&#93;<br /><br />04/02/2005&nbsp; &nbsp; &nbsp; &#91;color=red&#93;$85.50 /05&#91;/color&#93;&nbsp; &nbsp;-$2.03<br />22/02/2005&nbsp; &nbsp; &nbsp; &#91;color=blue&#93;$35.50 /05&#91;/color&#93;&nbsp; &nbsp; $2.96<br />04/03/2005&nbsp; &nbsp; &nbsp; &#91;color=blue&#93;$22.50 /05&#91;/color&#93;&nbsp; &nbsp; $0.88<br />28/03/2005&nbsp; &nbsp; &nbsp; &#91;color=blue&#93;$20.80 /05&#91;/color&#93;&nbsp; &nbsp; $0.73<br /><br />&#91;b&#93;&#91;color=orange&#93;============&#91;/color&#93;&#91;/b&#93;<br /><br />&#91;b&#93;&#91;color=green&#93;Date:&#91;/color&#93;/&#91;b&#93;<br /><br />04/02/2005&nbsp; &nbsp; &nbsp; &#91;color=red&#93;$85.50 /05&#91;/color&#93;&nbsp; &nbsp;-$2.03<br />22/02/2005 &#93;&nbsp; &nbsp; &nbsp;&#91;color=blue&#93;$35.50 /05&#91;/color&#93;&nbsp; &nbsp; $2.96<br />04/03/2005&nbsp; &nbsp; &nbsp; &#91;color=blue&#93;$22.50 /05&#91;/color&#93;&nbsp; &nbsp; $0.88<br />28/03/2005&nbsp; &nbsp; &nbsp; &#91;color=blue&#93;$20.80 /05&#91;/color&#93;&nbsp; &nbsp; $0.73<br /><br />&#91;/FONT&#93;<br /></code></pre></div><br /><br />Having solved this, I now realize that head and tail could be implemented without any user suplied JScript or /C option.<br /><br />head.bat<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>::head.bat&nbsp; &nbsp;count&nbsp; &nbsp;&#91;/F inFile&#93;&nbsp; &#91;/O outFile|-&#93;&nbsp; &#91;/N minWidth&#93;<br />@echo off<br />jrepl &quot;((.*\n){%~1})&#91;\s\S&#93;+&quot; &quot;$1&quot; /m %2 %3 %4 %5 %6 %7<br /></code></pre></div><br />tail.bat<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>::tail.bat&nbsp; &nbsp;count&nbsp; &nbsp;&#91;/F inFile&#93;&nbsp; &nbsp;&#91;/O outFile|-&#93;&nbsp; &nbsp;&#91;/N minWidth&#93;<br />@echo off<br />jrepl &quot;(.*\n)+(?=(.*\n|.+(?!&#91;\s\S&#93;)){%~1})&quot; &quot;&quot; /m %2 %3 %4 %5 %6 %7<br /></code></pre></div><br />But these new versions are limited to ~2GB files because of the /M option, and I think they also may be less efficient. I would still use the <a href="viewtopic7a89.html?p=38213#p38213" class="postlink">older versions</a>.<br /><br /><br />Dave Benham</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: JREPL.BAT - regex text processor - successor to REPL.BAT</h3>
				<div class="date">Posted: <strong>07 Apr 2015 04:56</strong></div>
				<div class="author">by <strong>foxidrive</strong></div>
				<div class="content"><blockquote><div><cite>dbenham wrote:</cite>25/00/2004 is a date  <img class="smilies" src="images/smilies/icon_question.gif" alt=":?:" title="Question" />  <img class="smilies" src="images/smilies/icon_exclaim.gif" alt=":!:" title="Exclamation" />  <img class="smilies" src="images/smilies/icon_eek.gif" alt=":shock:" title="Shocked" /> <br />So your months are 0 based (0=jan, 11=dec) <img class="smilies" src="images/smilies/icon_question.gif" alt=":?:" title="Question" /> <br /></div></blockquote><br /><br />I obfuscated the data a tad by globally replacing a few numbers with a different number, but your solution looks wonderful - if only I could figure out how it works.<br /><br /><blockquote class="uncited"><div>Anyway, the answer is actually quite simple - look for consecutive one or more lines beginning with a date that precede (look ahead) 4 lines that begin with a date, and replace with nothing.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>jrepl &quot;(^\d\d/\d\d/\d{4} .*\n)+(?=(^\d\d/\d\d/\d{4} .*\n){4})&quot; &quot;&quot; /m /f test.txt<br /></code></pre></div><br /></div></blockquote><br /><br />I can see it's checking for the date format at the start of the lines and taking the entire line with the CR at the end<br />and the next bit <span style="color: blue">+(?=(^\d\d/\d\d/\d{4} .*\n){4})</span> is adding 4 more of the same - using the + as some arithmetic <br />to add 4 of the next (same) terms.<br /><br />I have a basic appreciation of how it works but the technique mashes my brain like adding a quart of whiskey to my orange juice, <br />and I don't quite follow the lookaheads.   But thank you for your generous assistance and I'll be able to apply the same code<br />in future by copying and testing. <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br /><br /><blockquote class="uncited"><div>Having solved this, I now realize that head and tail could be implemented without any user suplied JScript or /C option.<br /><br />head.bat<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>::head.bat&nbsp; &nbsp;count&nbsp; &nbsp;&#91;/F inFile&#93;&nbsp; &#91;/O outFile|-&#93;&nbsp; &#91;/N minWidth&#93;<br />@echo off<br />jrepl &quot;((.*\n){%~1})&#91;\s\S&#93;+&quot; &quot;$1&quot; /m %2 %3 %4 %5 %6 %7<br /></code></pre></div><br />tail.bat<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>::tail.bat&nbsp; &nbsp;count&nbsp; &nbsp;&#91;/F inFile&#93;&nbsp; &nbsp;&#91;/O outFile|-&#93;&nbsp; &nbsp;&#91;/N minWidth&#93;<br />@echo off<br />jrepl &quot;(.*\n)+(?=(.*\n|.+(?!&#91;\s\S&#93;)){%~1})&quot; &quot;&quot; /m %2 %3 %4 %5 %6 %7<br /></code></pre></div><br />But these new versions are limited to ~2GB files because of the /M option, and I think they also may be less efficient. I would still use the <a href="viewtopic7a89.html?p=38213#p38213" class="postlink">older versions</a>.<br /><br /><br />Dave Benham</div></blockquote><br /><br />Thanks for these extra options too.<br /><br />My file is only 300 kb so it scrapes in. <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /></div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: JREPL.BAT - regex text processor - successor to REPL.BAT</h3>
				<div class="date">Posted: <strong>07 Apr 2015 05:20</strong></div>
				<div class="author">by <strong>dbenham</strong></div>
				<div class="content">You just need to study the regex syntax a bit more <img class="smilies" src="images/smilies/icon_wink.gif" alt=":wink:" title="Wink" /> <br /><br />The + means the previous expression must match 1 or more times (similar to * which matches 0 or more times)<br /><br />The ?= is a look-ahead construct, meaning the expression within the parentheses (the 4 lines) must follow the previous expression, but the content is not considered part of the match.<br /><br />So, in summary, it looks for as many matching lines as it can find that precede the 4 matching lines. Since the last 4 matching lines are not included in the match, we can replace everything with nothing.<br /><br /><br />Dave Benham</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: JREPL.BAT - regex text processor - successor to REPL.BAT</h3>
				<div class="date">Posted: <strong>07 Apr 2015 08:45</strong></div>
				<div class="author">by <strong>foxidrive</strong></div>
				<div class="content">Thanks for the clear explanation.  I see now where my mistaken impressions were failing me.<br /><br /><br /><br />Juts now I've been playing with another aspect, using the multi-line /m switch and here once more I seem to have misunderstood something.<br /><br />I had expected every text from <span style="color: #0040FF">*** and onwards</span> to be removed but this is not to be.<br />Can you please advise how I can remove the last part of the file from <span style="color: blue">***</span> at the start of a line?<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br /><br />(<br />echo(aaa<br />echo(<br />echo(***<br />echo(<br />echo(bbb<br />)&gt;accounts.txt<br /><br />:remove text at bottom from *** and onward<br />echo ======<br />call jrepl &quot;^(.*)\*\*\*.*&quot; &quot;$1&quot; /m /f accounts.txt<br />echo ======<br />call jrepl &quot;^(.*)\2A\2A\2A.*&quot; &quot;$1&quot; /x /m /f accounts.txt<br />echo ======<br />pause<br /></code></pre></div></div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: JREPL.BAT - regex text processor - successor to REPL.BAT</h3>
				<div class="date">Posted: <strong>07 Apr 2015 10:08</strong></div>
				<div class="author">by <strong>dbenham</strong></div>
				<div class="content">^\*\*\*$  Matches your *** line<br />[\s\S] matches any character<br />so [\s\S]* matches everything after your ***, including the \r and \n characters at the end of ***<br /><br />Putting it all together:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>jrepl &quot;^\*\*\*$&#91;\s\S&#93;*&quot; &quot;&quot; /m /f test.txt<br /></code></pre></div><br /><br />Dave Benham</div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="UTC-6">UTC-06:00</span><br />Page <strong>4</strong> of <strong>27</strong></div>
		<div class="copyright">Powered by phpBB&reg; Forum Software &copy; phpBB Limited<br />https://www.phpbb.com/</div>
	</div>
</div>

</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=6044&start=45&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 07:59:33 GMT -->
</html>
