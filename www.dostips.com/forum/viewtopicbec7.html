<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=7347&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 07:50:24 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>DosTips.com &bull; Creating a script to gather PC information - to assist those asking for help</title>

<link href="styles/AllanStyle-SUBSILVER/theme/print.css" rel="stylesheet">
</head>
<body id="phpbb">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>DosTips.com</h1>
		<p>A Forum all about DOS Batch<br /><a href="index-2.html">https://www.dostips.com/forum/</a></p>

		<h2>Creating a script to gather PC information - to assist those asking for help</h2>
		<p><a href="viewtopic1343.html?f=3&amp;t=7347">https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=7347</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>1</strong> of <strong>11</strong></div>
					<div class="post">
				<h3>Creating a script to gather PC information - to assist those asking for help</h3>
				<div class="date">Posted: <strong>10 Aug 2016 23:20</strong></div>
				<div class="author">by <strong>foxidrive</strong></div>
				<div class="content">I'm asking for help here:  this script provides essential information so that volunteer helpers have information about a question writer's computer. <br /><br />Help would be welcomed to think of extra details to add.<br /><br />aGerman and I have had discussion regarding this and here is the result so far: some extra samples from more computers would be valuable too.  There could be bugs lurking here...<br /><br /><span style="color: #FF0000">//EDIT: Latest Update -&gt;</span> <a href="viewtopica98d.html?f=3&amp;t=6108&amp;p=49091#p49091" class="postlink">http://www.dostips.com/forum/viewtopic.php?f=3&amp;t=6108&amp;p=49091#p49091</a><br /><br /><br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>Windows version:&nbsp; &nbsp;Microsoft Windows &#91;Version 6.3.9600&#93;<br />Product name:&nbsp; &nbsp; &nbsp; Windows 8.1 Pro with Media Center<br />Processor arch:&nbsp; &nbsp; x86 and 32 bit Windows<br /><br />Date format:&nbsp; &nbsp; &nbsp; &nbsp;dd/mm/yy =&nbsp; Wed 10/08/2016<br />Time format:&nbsp; &nbsp; &nbsp; &nbsp;24 hours =&nbsp; 14:09:50.35<br />Extensions:&nbsp; &nbsp; &nbsp; &nbsp; system:Enabled&nbsp; &nbsp;user:Enabled <br />Delayed expansion: system:Disabled&nbsp; user:Disabled<br />Locale name:&nbsp; &nbsp; &nbsp; &nbsp;en-AU&nbsp; &nbsp; &nbsp; Code Pages:&nbsp; &nbsp;OEM 850&nbsp; &nbsp; &nbsp;ANSI 1252<br />DIR&nbsp; format:&nbsp; &nbsp; &nbsp; &nbsp;06/08/2016&nbsp; 20:36&nbsp; &nbsp; &nbsp;3,484,418,048 pagefile.sys<br /></code></pre></div><br />pagefile.sys was chosen for the DIR format as it provides the last boot time of the computer and an indication of the amount of virtual memory.<br /><br /><br /><span style="color: green">The script</span><br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off &amp;setlocal EnableExtensions DisableDelayedExpansion<br />&nbsp;set &quot;International=HKCU\Control Panel\International&quot;<br />&nbsp;set &quot;CurrentVersion=HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion&quot;<br />&nbsp;set &quot;CodePage=HKLM\SYSTEM\CurrentControlSet\Control\Nls\CodePage&quot;<br />&nbsp;set &quot;CMDproc=Software\Microsoft\Command Processor&quot;<br />&nbsp;set bitness=32<br />&nbsp;if exist &quot;%SystemRoot%\SysWOW64\&quot; set bitness=64<br />&nbsp;for /f &quot;tokens=1,2,*&quot; %%a in ('reg query &quot;%International%&quot;^|find &quot;REG_&quot;')&nbsp; do set &quot;%%a=%%c&quot;<br />&nbsp;if &quot;%iDate%&quot;==&quot;0&quot; (set format=mm/dd/yy) else if &quot;%iDate%&quot;==&quot;1&quot; (set format=dd/mm/yy) else if &quot;%iDate%&quot;==&quot;2&quot; (set format=yy/mm/dd)<br />&nbsp;if &quot;%iTime%&quot;==&quot;0&quot; (set hours=12) else if &quot;%iTime%&quot;==&quot;1&quot; (set hours=24)<br />&nbsp;for /f &quot;delims=&quot; %%a in ('dir &quot;%SystemDrive%\pagefile.sys&quot; /a ^|find &quot;:&quot;') do set DirFormat=%%a<br />&nbsp;for %%a in (es eu ds du) do set &quot;%%a=Disabled&quot;<br />&nbsp;reg query &quot;HKLM\%CMDproc%&quot; /v &quot;EnableExtensions&quot; 2&gt;nul|find &quot;0x1&quot;&gt;nul &amp;&amp; set &quot;es=Enabled &quot;<br />&nbsp;reg query &quot;HKCU\%CMDproc%&quot; /v &quot;EnableExtensions&quot; 2&gt;nul|find &quot;0x1&quot;&gt;nul &amp;&amp; set &quot;eu=Enabled &quot;<br />&nbsp;reg query &quot;HKLM\%CMDproc%&quot; /v &quot;DelayedExpansion&quot; 2&gt;nul|find &quot;0x1&quot;&gt;nul &amp;&amp; set &quot;ds=Enabled &quot;<br />&nbsp;reg query &quot;HKCU\%CMDproc%&quot; /v &quot;DelayedExpansion&quot; 2&gt;nul|find &quot;0x1&quot;&gt;nul &amp;&amp; set &quot;du=Enabled &quot;<br />&nbsp;&gt;&quot;%temp%\info.txt&quot; (<br />&nbsp; echo &#91;code^&#93;<br />&nbsp; for /f &quot;delims=&quot; %%a in ('ver') do echo Windows version:&nbsp; &nbsp;%%a<br />&nbsp; for /f &quot;tokens=2*&quot; %%a in ('<br />&nbsp; &nbsp; reg query &quot;%CurrentVersion%&quot;^|find /i &quot;ProductName&quot;') do echo Product name:&nbsp; &nbsp; &nbsp; %%b<br />&nbsp; echo Processor arch:&nbsp; &nbsp; %PROCESSOR_ARCHITECTURE% and %Bitness% bit Windows&amp;echo(<br />&nbsp; echo Date format:&nbsp; &nbsp; &nbsp; &nbsp;%format% =&nbsp; %date%<br />&nbsp; echo Time format:&nbsp; &nbsp; &nbsp; &nbsp;%hours% hours =&nbsp; %time%<br />&nbsp; for /f &quot;tokens=3&quot; %%a in ('reg query &quot;%CodePage%&quot; /v &quot;OEMCP&quot;') do (<br />&nbsp; for /f &quot;tokens=3&quot; %%b in ('reg query &quot;%CodePage%&quot; /v &quot;ACP&quot;')&nbsp; &nbsp;do (<br />&nbsp; echo Extensions:&nbsp; &nbsp; &nbsp; &nbsp; system:%es%&nbsp; user:%eu%<br />&nbsp; echo Delayed expansion: system:%ds%&nbsp; user:%du%<br />&nbsp; echo Locale name:&nbsp; &nbsp; &nbsp; &nbsp;%LocaleName%&nbsp; &nbsp; &nbsp; Code Pages:&nbsp; &nbsp;OEM %%a&nbsp; &nbsp; &nbsp;ANSI %%b))<br />&nbsp; echo DIR&nbsp; format:&nbsp; &nbsp; &nbsp; &nbsp;%DirFormat%<br />&nbsp; echo &#91;/code^&#93;<br />)<br />clip &gt;nul 2&gt;&amp;1 &amp;&amp; clip &lt; &quot;%temp%\info.txt&quot;<br />start &quot;&quot; notepad.exe &quot;%temp%\info.txt&quot;<br />&gt;nul ping -n 2 localhost<br />del &quot;%temp%\info.txt&quot;</code></pre></div></div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Creating a script to gather PC information - to assist those asking for help</h3>
				<div class="date">Posted: <strong>11 Aug 2016 00:48</strong></div>
				<div class="author">by <strong>aGerman</strong></div>
				<div class="content">Some explanations about the data that the script collects.<br />- Windows version, name and bitness tell us something about available tools, folder structure, available environment variables, potential behavior of the script.<br />- Date/time formats are language dependent. Order, separators and number of tokens may differ. But often users ask for help how to parse.<br />- Usually command extensions are enabled and usually we assume that they are enabled. Nevertheless they could be disabled by changes in the registry. Things like FOR /F, IF /I, SET /P wouldn't work.<br />- If delayed variable expansion is enabled via registry you would have side effects if strings contain exclamation marks.<br />- The locale name tells us something about potential non-ASCII characters in the questioners environment.<br />- OEMCP and ACP may differ. Thus, the character encoding of the batch window and of the script may differ too.<br />- Users ask how to parse the output of DIR. Again date/time format and number of tokens may differ.<br /><br />What we are NOT interested in are things like user name, IP addresses and any kind of sensitive data.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Creating a script to gather PC information - to assist those asking for help</h3>
				<div class="date">Posted: <strong>11 Aug 2016 07:13</strong></div>
				<div class="author">by <strong>Squashman</strong></div>
				<div class="content">The <strong class="text-strong">systeminfo</strong> command can get you a lot of information as well.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Creating a script to gather PC information - to assist those asking for help</h3>
				<div class="date">Posted: <strong>11 Aug 2016 08:58</strong></div>
				<div class="author">by <strong>SIMMS7400</strong></div>
				<div class="content">Nice script!<br /><br />I use the system info command in a script I run.  <br /><br />However, I've incorporated parts of your script into mine - thanks!<br /><br />Note, computername/hostname, logon server, and domain will be displayed in this script.<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off &amp;setlocal EnableExtensions DisableDelayedExpansion<br /><br />REM --<br />REM -- SET VARIABLES --<br />REM --<br />set system=<br />set manufacturer=<br />set model=<br />set serialnumber=<br />set osname=<br />set sp=<br />setlocal ENABLEDELAYEDEXPANSION<br />set &quot;volume=C:&quot;<br />set totalMem=<br />set availableMem=<br />set usedMem=<br /><br />set &quot;International=HKCU\Control Panel\International&quot;<br />set &quot;CurrentVersion=HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion&quot;<br />set &quot;CodePage=HKLM\SYSTEM\CurrentControlSet\Control\Nls\CodePage&quot;<br />set &quot;CMDproc=Software\Microsoft\Command Processor&quot;<br /><br />set bitness=32<br />if exist &quot;%SystemRoot%\SysWOW64\&quot; set bitness=64<br /><br />for /f &quot;tokens=1,2,*&quot; %%a in ('reg query &quot;%International%&quot;^|find &quot;REG_&quot;')&nbsp; do set &quot;%%a=%%c&quot;<br />if &quot;%iDate%&quot;==&quot;0&quot; (set format=mm/dd/yy) else if &quot;%iDate%&quot;==&quot;1&quot; (set format=dd/mm/yy) else if &quot;%iDate%&quot;==&quot;2&quot; (set format=yy/mm/dd)<br />if &quot;%iTime%&quot;==&quot;0&quot; (set hours=12) else if &quot;%iTime%&quot;==&quot;1&quot; (set hours=24)<br /><br />for /f &quot;delims=&quot; %%a in ('dir &quot;%SystemDrive%\pagefile.sys&quot; /a ^|find &quot;:&quot;') do set DirFormat=%%a<br />for %%a in (es eu ds du) do set &quot;%%a=Disabled&quot;<br /><br />reg query &quot;HKLM\%CMDproc%&quot; /v &quot;EnableExtensions&quot; 2&gt;nul|find &quot;0x1&quot;&gt;nul &amp;&amp; set &quot;es=Enabled &quot;<br />reg query &quot;HKCU\%CMDproc%&quot; /v &quot;EnableExtensions&quot; 2&gt;nul|find &quot;0x1&quot;&gt;nul &amp;&amp; set &quot;eu=Enabled &quot;<br />reg query &quot;HKLM\%CMDproc%&quot; /v &quot;DelayedExpansion&quot; 2&gt;nul|find &quot;0x1&quot;&gt;nul &amp;&amp; set &quot;ds=Enabled &quot;<br />reg query &quot;HKCU\%CMDproc%&quot; /v &quot;DelayedExpansion&quot; 2&gt;nul|find &quot;0x1&quot;&gt;nul &amp;&amp; set &quot;du=Enabled &quot;<br /><br />echo&nbsp; &nbsp; &nbsp; \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\<br />echo&nbsp; &nbsp; &nbsp; \\&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;\\<br />echo&nbsp; &nbsp; &nbsp; \\&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WELCOME&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \\<br />echo&nbsp; &nbsp; &nbsp; \\&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;\\<br />echo&nbsp; &nbsp; &nbsp; \\&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DOS TIPS&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \\<br />echo&nbsp; &nbsp; &nbsp; \\&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;\\<br />echo&nbsp; &nbsp; &nbsp; \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\&nbsp; &nbsp;<br />echo. <br />echo Retrieving Data &#91;Computer: %computername%&#93;...<br />echo.<br />echo Please Wait....<br />echo.<br />echo The first section of output is a quick reference<br />echo The second section of output contains all System Info<br />echo.<br /><br />REM Get Computer Name<br />FOR /F &quot;tokens=2 delims='='&quot; %%A in ('wmic OS Get csname /value') do SET system=%%A<br /><br />REM Get Computer Manufacturer<br />FOR /F &quot;tokens=2 delims='='&quot; %%A in ('wmic ComputerSystem Get Manufacturer /value') do SET manufacturer=%%A<br /><br />REM Get Computer Model<br />FOR /F &quot;tokens=2 delims='='&quot; %%A in ('wmic ComputerSystem Get Model /value') do SET model=%%A<br /><br />REM Get Computer Serial Number<br />FOR /F &quot;tokens=2 delims='='&quot; %%A in ('wmic Bios Get SerialNumber /value') do SET serialnumber=%%A<br /><br />REM Get Memory<br />FOR /F &quot;tokens=4&quot; %%a in ('systeminfo ^| findstr Physical') do if defined totalMem (set availableMem=%%a) else (set totalMem=%%a)<br />set totalMem=%totalMem:,=%<br />set availableMem=%availableMem:,=%<br />set /a usedMem=totalMem-availableMem<br /><br />FOR /f &quot;tokens=1*delims=:&quot; %%i IN ('fsutil volume diskfree %volume%') DO (<br />&nbsp; &nbsp; SET &quot;diskfree=!disktotal!&quot;<br />&nbsp; &nbsp; SET &quot;disktotal=!diskavail!&quot;<br />&nbsp; &nbsp; SET &quot;diskavail=%%j&quot;<br />)<br />FOR /f &quot;tokens=1,2&quot; %%i IN (&quot;%disktotal% %diskavail%&quot;) DO SET &quot;disktotal=%%i&quot;&amp; SET &quot;diskavail=%%j&quot; <br />&nbsp;<br />&gt;&quot;%temp%\info.txt&quot; (<br /><br />echo ------------------------<br />echo System Name: %system%<br />echo ------------------------<br />echo.<br />echo Manufacturer:&nbsp; &nbsp; &nbsp; %manufacturer%<br />echo Model:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;%model%<br />echo Serial Number:&nbsp; &nbsp; &nbsp;%serialnumber%<br />echo.<br />for /f &quot;delims=&quot; %%a in ('ver') do echo Windows version:&nbsp; &nbsp;%%a<br />for /f &quot;tokens=2*&quot; %%a in ('<br />reg query &quot;%CurrentVersion%&quot;^|find /i &quot;ProductName&quot;') do echo Product name:&nbsp; &nbsp; &nbsp; %%b<br />echo Processor arch:&nbsp; &nbsp; %PROCESSOR_ARCHITECTURE% and %Bitness% bit Windows&amp;echo(<br />echo Service Pack:&nbsp; &nbsp; &nbsp; %sp%<br />echo.<br />echo Date format:&nbsp; &nbsp; &nbsp; &nbsp;%format% =&nbsp; %date%<br />echo Time format:&nbsp; &nbsp; &nbsp; &nbsp;%hours% hours =&nbsp; %time%<br />echo.<br />for /f &quot;tokens=3&quot; %%a in ('reg query &quot;%CodePage%&quot; /v &quot;OEMCP&quot;') do (<br />for /f &quot;tokens=3&quot; %%b in ('reg query &quot;%CodePage%&quot; /v &quot;ACP&quot;')&nbsp; &nbsp;do (<br />echo Extensions:&nbsp; &nbsp; &nbsp; &nbsp; system:%es%&nbsp; user:%eu%<br />echo Delayed expansion: system:%ds%&nbsp; user:%du%<br />echo Locale name:&nbsp; &nbsp; &nbsp; &nbsp;%LocaleName%&nbsp; &nbsp; &nbsp; Code Pages:&nbsp; &nbsp;OEM %%a&nbsp; &nbsp; &nbsp;ANSI %%b))<br />echo.<br />echo DIR&nbsp; format:&nbsp; &nbsp; &nbsp; &nbsp;%DirFormat%<br />echo.<br />echo -----------------<br />echo -- DISK SPACE ---<br />echo -----------------<br />echo C:\ Total: %disktotal:~0,-9% GB<br />echo C:\ Avail: %diskavail:~0,-9% GB<br />echo.<br />echo -------------------<br />echo&nbsp; &nbsp; -- MEMORY --<br />echo -------------------<br />echo Total Memory: %totalMem%<br />echo Used&nbsp; Memory: %usedMem%<br /><br />echo. <br />echo --------------------------------------------<br />echo --------------ALL SYSTEM INFO---------------<br />echo --------------------------------------------<br />systeminfo /S %computername%<br />echo -------------------------------------------- <br /><br />)<br />clip &gt;nul 2&gt;&amp;1 &amp;&amp; clip &lt; &quot;%temp%\info.txt&quot;<br />start &quot;&quot; notepad.exe &quot;%temp%\info.txt&quot;<br />&gt;nul ping -n 2 localhost<br />del &quot;%temp%\info.txt&quot;</code></pre></div></div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Creating a script to gather PC information - to assist those asking for help</h3>
				<div class="date">Posted: <strong>11 Aug 2016 11:46</strong></div>
				<div class="author">by <strong>aGerman</strong></div>
				<div class="content">@Squashman<br />SYSTEMIINFO is one of the damn commands that is completely language dependent  <img class="smilies" src="images/smilies/icon_sad.gif" alt=":(" title="Sad" /> <br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>Hostname:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DESKTOP-2KLLDT9<br />Betriebssystemname:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Microsoft Windows 10 Home<br />Betriebssystemversion:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;10.0.10586 Nicht zutreffend Build 10586<br />Betriebssystemhersteller:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Microsoft Corporation<br />Betriebssystemkonfiguration:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Eigenständige Arbeitsstation<br />... etc.<br /></code></pre></div><br />@SIMMS7400<br />Nice script <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /> <br />Although something like<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>...<br />-------------------<br />&nbsp; &nbsp;-- MEMORY --<br />-------------------<br />Total Memory: ,=<br />Used&nbsp; Memory: 0<br />...</code></pre></div><br />... is exactly what we try to avoid <img class="smilies" src="images/smilies/icon_wink.gif" alt=":wink:" title="Wink" /> <br /><br />~~~~~~~~~~~~~<br /><br />The purpose of the script shall be to collect data that would help to notice the differences of language settings and Windows versions. Hence the question is what informations would help and what commands and algorithms (that should be as downward compatible as possible) are suitable to gather these informations in a language independent manner.<br />I've seen people from all over the world here at DosTips. Most of them don't tell us where they are from or what OS they use. The consequence is that we guess something and afterwards the only reaction from the questioner is &quot;the script doesn't work&quot;. That's the point where we usually begin with endless inquiries ...  <img class="smilies" src="images/smilies/icon_cry.gif" alt=":cry:" title="Crying or Very sad" /> <br />However. Just to be clear - it's NOT the goal to collect as many informations as possible.<br /><br />What do you think - are there informations missing in the script above that would help to give the questioners from Russia, China, Italy, ... a good solution for their problems?<br /><br />Regards<br />aGerman</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Creating a script to gather PC information - to assist those asking for help</h3>
				<div class="date">Posted: <strong>11 Aug 2016 17:27</strong></div>
				<div class="author">by <strong>douglas.swehla</strong></div>
				<div class="content">Getting the Windows version is great, since it tells us what commands should be available on their system. To further that, maybe have a sticky post with a list of what commands should be available on which OS, for reference by helpers.<br /><br />What <em class="text-italics">should</em> be true often isn't, though, so maybe collect some &quot;make sure things aren't broken&quot; data?<br /><ul><li>Get the values of some key environment variables, like Path and PATHEXT, to make sure they're not corrupted.</li><li>Check for the existence of utilities that are version-dependent, like CHOICE and SLEEP.</li><li>Confirm that commonly used or recommended utilities are present and findable by running WHERE on them. Check for cscript, find, findstr, net, ping, etc.</li></ul><br />You could add a call to &quot;secondary.bat&quot; or to &quot;%~1&quot;, so that helpers can include additional, question-specific tests to run. You'd probably want to draw a clear distinction between the official, &quot;DosTips-approved&quot; script, and the unofficial, &quot;run it if you trust them&quot; script(s). Dunno how feasible that is, if we're worried about language issues in the first place.<br /><br />The ever-popular TRON script (<a href="https://www.reddit.com/r/TronScript/" class="postlink">https://www.reddit.com/r/TronScript/</a>, <a href="https://github.com/bmrf/tron/blob/master/tron.bat" class="postlink">https://github.com/bmrf/tron/blob/master/tron.bat</a>) checks for a lot of environment stuff in the prep stages, you might find something interesting in there.<br /><br />You can try to launch an elevated prompt, to see if user has admin rights.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Creating a script to gather PC information - to assist those asking for help</h3>
				<div class="date">Posted: <strong>11 Aug 2016 17:32</strong></div>
				<div class="author">by <strong>penpen</strong></div>
				<div class="content">If i remember right:<br />If one of the international settings is not present in &quot;HKCU\Control Panel\International&quot;,<br />then its value is read from &quot;HKU\.DEFAULT\Control Panel\International&quot; if present,<br />else the default values are used:<br />- iDate: 0<br />- iTime: 1<br />- <a href="https://technet.microsoft.com/en-us/library/cc978632.aspx" class="postlink">...</a><br /><br /><br />penpen</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Creating a script to gather PC information - to assist those asking for help</h3>
				<div class="date">Posted: <strong>12 Aug 2016 03:49</strong></div>
				<div class="author">by <strong>jacobcarl</strong></div>
				<div class="content">i am looking for Dos code which can retrieve system information of the graphics card as well as mother board.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Creating a script to gather PC information - to assist those asking for help</h3>
				<div class="date">Posted: <strong>12 Aug 2016 07:43</strong></div>
				<div class="author">by <strong>foxidrive</strong></div>
				<div class="content"><blockquote><div><cite>jacobcarl wrote:</cite>i am looking for Dos code which can retrieve system information of the graphics card as well as mother board.</div></blockquote><br /><br />Try this post.<br /><br /><!-- l --><a class="postlink-local" href="viewtopic1b82.html?p=48394#p48394">viewtopic.php?p=48394#p48394</a><!-- l --></div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Creating a script to gather PC information - to assist those asking for help</h3>
				<div class="date">Posted: <strong>12 Aug 2016 10:49</strong></div>
				<div class="author">by <strong>aGerman</strong></div>
				<div class="content"><blockquote><div><cite>douglas.swehla wrote:</cite><ul><li>Get the values of some key environment variables, like Path and PATHEXT, to make sure they're not corrupted.</li></ul></div></blockquote><br />OK, I agree. Although most of the time predefined variables are rather overwritten than corrupted. In that case you have to know the complete batch code of the questioner. Outputting these values by a separate script wouln't help.<br /><br /><blockquote><div><cite>douglas.swehla wrote:</cite><ul><li>Check for the existence of utilities that are version-dependent, like CHOICE and SLEEP.</li><li>Confirm that commonly used or recommended utilities are present and findable by running WHERE on them. Check for cscript, find, findstr, net, ping, etc.</li></ul></div></blockquote><br />We should already know what tools are available if we know the Windows version. That's the reason why I preferred this version check instead of verifying the existence of each single tool. On the other hand those tools could have been already downloaded. But at what point would you stop? CHOICE, SLEEP, WMIC, DEVCON, ...? I think the questioner would get a proper error message if something is missing.<br /><br /><blockquote><div><cite>douglas.swehla wrote:</cite>You could add a call to &quot;secondary.bat&quot; or to &quot;%~1&quot;, so that helpers can include additional, question-specific tests to run. You'd probably want to draw a clear distinction between the official, &quot;DosTips-approved&quot; script, and the unofficial, &quot;run it if you trust them&quot; script(s). Dunno how feasible that is, if we're worried about language issues in the first place.</div></blockquote><br />Good idea. If we assume a specific problem we could ask the questioner to run a specific script instead of including everything into one. Too much information could be more confusing than helpful.<br /><br /><blockquote><div><cite>douglas.swehla wrote:</cite>The ever-popular TRON script (<a href="https://www.reddit.com/r/TronScript/" class="postlink">https://www.reddit.com/r/TronScript/</a>, <a href="https://github.com/bmrf/tron/blob/master/tron.bat" class="postlink">https://github.com/bmrf/tron/blob/master/tron.bat</a>) checks for a lot of environment stuff in the prep stages, you might find something interesting in there.</div></blockquote><br />He's in a different league <img class="smilies" src="images/smilies/icon_lol.gif" alt=":lol:" title="Laughing" /> <br /><br /><blockquote><div><cite>douglas.swehla wrote:</cite>You can try to launch an elevated prompt, to see if user has admin rights.</div></blockquote><br />I'd like to work around<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>net localgroup<br />net user %username%</code></pre></div><br />Unfortunately NET is another damn language dependent command ... <img class="smilies" src="images/smilies/icon_sad.gif" alt=":(" title="Sad" /><br /><br /><blockquote><div><cite>penpen wrote:</cite>then its value is read from &quot;HKU\.DEFAULT\Control Panel\International&quot; if present</div></blockquote><br />Would you say we should try to read these values alternatively?<br /><br />Regards<br />aGerman</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Creating a script to gather PC information - to assist those asking for help</h3>
				<div class="date">Posted: <strong>12 Aug 2016 15:09</strong></div>
				<div class="author">by <strong>douglas.swehla</strong></div>
				<div class="content"><blockquote><div><cite>aGerman wrote:</cite><blockquote><div><cite>douglas.swehla wrote:</cite><ul><li>Get the values of some key environment variables, like Path and PATHEXT, to make sure they're not corrupted.</li></ul></div></blockquote><br />OK, I agree. Although most of the time predefined variables are rather overwritten than corrupted. In that case you have to know the complete batch code of the questioner. Outputting these values by a separate script wouln't help.<br /></div></blockquote> Overwritten is a better word choice than corrupted, thank. Not sure what you mean by the last couple sentences. To be clear, I'm thinking of situations where the asker thinks they're having trouble composing some command, when the real problem is that no commands are running at all, because they overwrote the PATH with some working directory, instead of appending it.<br /><br /><blockquote><div><cite>aGerman wrote:</cite><blockquote><div><cite>douglas.swehla wrote:</cite><ul><li>Check for the existence of utilities that are version-dependent, like CHOICE and SLEEP.</li><li>Confirm that commonly used or recommended utilities are present and findable by running WHERE on them. Check for cscript, find, findstr, net, ping, etc.</li></ul></div></blockquote><br />We should already know what tools are available if we know the Windows version. That's the reason why I preferred this version check instead of verifying the existence of each single tool. On the other hand those tools could have been already downloaded. But at what point would you stop? CHOICE, SLEEP, WMIC, DEVCON, ...? I think the questioner would get a proper error message if something is missing.<br /></div></blockquote><br />It's been my experience that &quot;what <em class="text-italics">should be</em>&quot; and &quot;what <em class="text-italics">is</em>&quot; often have little or nothing to do with each other.  <img class="smilies" src="images/smilies/icon_neutral.gif" alt=":|" title="Neutral" /> <br /><br />The idea here is to prevent helpers from suggesting solutions that the user doesn't have. Sure, most of us know that if they're on XP, they don't have CHOICE natively, but maybe (like you pointed out) they installed it. Some helpers don't have a good grip on which commands are available on which systems. Maybe one or more of the normal commands got moved/deleted/renamed/corrupted. I'm thinking of testing a list of, say, 20 of the most commonly used commands, and only mention them if any aren't found:<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>Command Availability<br />------------------------<br />CHOICE is not found on this system.<br />WMIC is not found on this system.<br /></code></pre></div><br /><br /><blockquote><div><cite>aGerman wrote:</cite><blockquote><div><cite>douglas.swehla wrote:</cite>You could add a call to &quot;secondary.bat&quot; or to &quot;%~1&quot;, so that helpers can include additional, question-specific tests to run. You'd probably want to draw a clear distinction between the official, &quot;DosTips-approved&quot; script, and the unofficial, &quot;run it if you trust them&quot; script(s). Dunno how feasible that is, if we're worried about language issues in the first place.</div></blockquote><br />Good idea. If we assume a specific problem we could ask the questioner to run a specific script instead of including everything into one. Too much information could be more confusing than helpful.<br /></div></blockquote><br />It's funny, I thought this would be the one to get shot down. Now I think about it, this would be a good place to test for particular utilities. You could have a few core ones, or none, in the main script, and if helper thinks a good solution would involve CHOICE or DEVCON or WEVTUTIL, they can check for it.<br /><br />I keep harping on CHOICE because it's so useful, and freaking MS took it out, but then they put it back, but you can get if you want, but a lot people don't know that, but it shouldn't matter because people are mostly off XP now, but a lot aren't, and I just never know if I can suggest it or not. If you kick out the rest of the &quot;check for utilities&quot; idea, can we at least keep that? Just a line saying &quot;The CHOICE command is[ not] available.&quot;<br /><br /><blockquote><div><cite>aGerman wrote:</cite><blockquote><div><cite>douglas.swehla wrote:</cite>The ever-popular TRON script (<a href="https://www.reddit.com/r/TronScript/" class="postlink">https://www.reddit.com/r/TronScript/</a>, <a href="https://github.com/bmrf/tron/blob/master/tron.bat" class="postlink">https://github.com/bmrf/tron/blob/master/tron.bat</a>) checks for a lot of environment stuff in the prep stages, you might find something interesting in there.</div></blockquote><br />He's in a different league <img class="smilies" src="images/smilies/icon_lol.gif" alt=":lol:" title="Laughing" /> <br /></div></blockquote><br />He's definitely a smart guy. Not actually into exotic scripting, though--that tool started out as just a traditional batch script, running one cleanup utility after another, with nothing esoteric at all. A lot of people have contributed to it over the years, and he's great about accepting and acknowledging help. If you want to help, you probably can.<br /><br /><blockquote><div><cite>aGerman wrote:</cite><blockquote><div><cite>douglas.swehla wrote:</cite>You can try to launch an elevated prompt, to see if user has admin rights.</div></blockquote><br />I'd like to work around<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>net localgroup<br />net user %username%</code></pre></div><br />Unfortunately NET is another damn language dependent command ... <img class="smilies" src="images/smilies/icon_sad.gif" alt=":(" title="Sad" /><br /></div></blockquote><br />Is this to get a list of possible admin names? Every system I've worked with recently has an &quot;administrator&quot; user. Not sure if that's built-in or added by convention. If it's a default, you could do something like this:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>rem :: Test for current admin status. Any of these commands will return an error if not in admin mode.<br />fsutil /?<br />net file<br />cacls.exe &quot;%SYSTEMROOT%\system32\config\system&quot;<br />cacls.exe &quot;%SYSTEMROOT%\SysWOW64\config\system&quot;<br /><br />rem :: If not in admin mode, see if we can get there. Will require user to enter password.<br />runas /user:administrator &quot;cmd /c exit&quot;<br /></code></pre></div><br /><br />Some resources on testing for and getting to elevated status. These rely on UAC &amp;/or VBS.<br /><ul><li><a href="http://stackoverflow.com/questions/1894967/how-to-request-administrator-access-inside-a-batch-file" class="postlink">http://stackoverflow.com/questions/1894967/how-to-request-administrator-access-inside-a-batch-file</a></li><li><a href="http://stackoverflow.com/questions/7044985/how-can-i-auto-elevate-my-batch-file-so-that-it-requests-from-uac-administrator" class="postlink">http://stackoverflow.com/questions/7044985/how-can-i-auto-elevate-my-batch-file-so-that-it-requests-from-uac-administrator</a></li></ul></div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Creating a script to gather PC information - to assist those asking for help</h3>
				<div class="date">Posted: <strong>12 Aug 2016 16:09</strong></div>
				<div class="author">by <strong>aGerman</strong></div>
				<div class="content"><blockquote><div><cite>douglas.swehla wrote:</cite>Not sure what you mean by the last couple sentences.</div></blockquote><br />Imagine the questioners script would look like that<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off &amp;setlocal<br />set /p &quot;path=Enter the path: &quot;<br />echo &quot;%path%&quot;|find &quot;C:&quot;<br />pause</code></pre></div><br />This will crash for sure. But it wouldn't even help if you check the path variable in another script. Most likely it would be ok.<br /><br /><blockquote><div><cite>douglas.swehla wrote:</cite>I'm thinking of testing a list of, say, 20 of the most commonly used commands, and only mention them if any aren't found</div></blockquote><br />Yeah. Maybe something like that:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off &amp;setlocal EnableExtensions DisableDelayedExpansion<br />for %%i in (<br />&nbsp; findstr wmic foo<br />) do for /f &quot;tokens=1,2 delims=?&quot; %%j in (&quot;%%i.exe?%%i.com&quot;) do if &quot;%%~$PATH:j%%~$PATH:k&quot;==&quot;&quot; echo %%i is missing<br />pause</code></pre></div><br /><br /><blockquote><div><cite>douglas.swehla wrote:</cite>Is this to get a list of possible admin names?</div></blockquote><br />I actually didn't want the questioner to run anything as admin only to check if he is able to obtain elevated permissions. That's what I was thinking about&#058;<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>set &quot;check=&quot;<br />for /f &quot;tokens=*&quot; %%a in ('net localgroup 2^&gt;nul^|findstr /ic:&quot;admin&quot;') do (<br />&nbsp; set &quot;check=1&quot;<br />&nbsp; net user %username%|findstr /c:&quot;%%a&quot;&gt;nul &amp;&amp;(<br />&nbsp; &nbsp; echo You belong to the local admins.<br />&nbsp; )||(<br />&nbsp; &nbsp; echo You don't belong to the local admins.<br />&nbsp; )<br />)<br />if not defined check echo You have no permissions to run the NET command.<br /></code></pre></div><br />The local group I belong to is <span style="color: #0000FF">*Administratoren</span>. I'm looking for &quot;admin&quot;. So probably the code will work for you as well. But with something like &quot;администраторы&quot; it would fail.<br /><br />Regards<br />aGerman</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Creating a script to gather PC information - to assist those asking for help</h3>
				<div class="date">Posted: <strong>12 Aug 2016 16:27</strong></div>
				<div class="author">by <strong>penpen</strong></div>
				<div class="content"><blockquote><div><cite>aGerman wrote:</cite><blockquote><div><cite>penpen wrote:</cite>then its value is read from &quot;HKU\.DEFAULT\Control Panel\International&quot; if present</div></blockquote><br />Would you say we should try to read these values alternatively?</div></blockquote>Yes, but only if not defined in &quot;HKCU\...&quot;; something like that:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />setlocal enableExtensions disableDelayedExpansion<br />for %%a in (&quot;iDate&quot; &quot;iTime&quot;) do set &quot;%%~a=&quot;<br />for /f &quot;tokens=1,2*&quot; %%a in ('reg query &quot;HKCU\Control Panel\International&quot; /v &quot;i???e&quot; ^| find &quot;REG_&quot;') do set &quot;%%~a=%%~c&quot;<br />for /f &quot;tokens=1,2*&quot; %%a in ('reg query &quot;HKU\.DEFAULT\Control Panel\International&quot; /v &quot;i???e&quot; ^| find &quot;REG_&quot;') do if not defined %%~a set &quot;%%~a=%%~c&quot;<br />if not defined iDate set &quot;iDate=0&quot;<br />if not defined iTime set &quot;iTime=1&quot;<br /><br />set iDate<br />set iTime<br /><br />endlocal</code></pre></div><br /><br />penpen<br /><br />Edit: Added set-/endlocal, and initializing of iDate and iTime.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Creating a script to gather PC information - to assist those asking for help</h3>
				<div class="date">Posted: <strong>12 Aug 2016 16:38</strong></div>
				<div class="author">by <strong>aGerman</strong></div>
				<div class="content">Cool. That can be easily implemented <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /></div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Creating a script to gather PC information - to assist those asking for help</h3>
				<div class="date">Posted: <strong>12 Aug 2016 19:45</strong></div>
				<div class="author">by <strong>douglas.swehla</strong></div>
				<div class="content"><blockquote><div><cite>aGerman wrote:</cite>Imagine the questioners script would look like that<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off &amp;setlocal<br />set /p &quot;path=Enter the path: &quot;<br />echo &quot;%path%&quot;|find &quot;C:&quot;<br />pause</code></pre></div><br />This will crash for sure. But it wouldn't even help if you check the path variable in another script. Most likely it would be ok.<br /></div></blockquote><br />Ah, okay. You're thinking of the case when the questioner has overwritten the path <em class="text-italics">in the script they're asking about</em>. I'm thinking of the case where it's broken <em class="text-italics">already</em>: maybe someone ran SETX or messed up the registry, and PATH is either undefined or doesn't have System32 or SysWOW64 in it for some reason.<br /><br />Another case is if they're trying to run a non-native program, and don't realize that they need to either specify the full path to the executable or have its directory stored in the PATH variable. In a recent thread, someone was jumping through hoops to find the full path of an executable on a remote system, when I think they could have just relied on that system's PATH. I asked about it, but never got a clear answer. If I had been able to see a report that said &quot;User's PATH is '%SystemRoot%\system32;%SystemRoot%;%SystemRoot%\System32\Wbem;%SYSTEMROOT%\System32\WindowsPowerShell\v1.0\'.&quot;, then I'd have known how to proceed.<br /><br /><blockquote><div><cite>aGerman wrote:</cite>Maybe something like that:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off &amp;setlocal EnableExtensions DisableDelayedExpansion<br />for %%i in (<br />&nbsp; findstr wmic foo<br />) do for /f &quot;tokens=1,2 delims=?&quot; %%j in (&quot;%%i.exe?%%i.com&quot;) do if &quot;%%~$PATH:j%%~$PATH:k&quot;==&quot;&quot; echo %%i is missing<br />pause</code></pre></div><br /></div></blockquote><br />Yes, exactly. You could also add a snippet to check for the existence of bad or confusing executables. If someone has a local batch file with the same name as some arcane command, that could mess things up.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />setlocal EnableExtensions DisableDelayedExpansion<br /><br />rem Make a bad file in a safe place for demo.<br />pushd &quot;%userprofile%&quot;<br />echo bad file &gt; wmic.bat<br /><br />for %%i in (findstr wmic foo) do (<br />&nbsp; &nbsp;rem Check for missing good version.<br />&nbsp; &nbsp;for /f &quot;tokens=1,2 delims=?&quot; %%j in (&quot;%%i.exe?%%i.com&quot;) do (<br />&nbsp; &nbsp;&nbsp; &nbsp;if &quot;%%~$PATH:j%%~$PATH:k&quot;==&quot;&quot; echo %%i not found as .exe or .com<br />&nbsp; &nbsp;)<br />&nbsp; &nbsp;rem Check for present bad version.<br />&nbsp; &nbsp;for /f &quot;tokens=* delims=&quot; %%j in ('where %%i 2^&gt;nul ^| findstr /i /v &quot;.exe .com&quot;') do (<br />&nbsp; &nbsp;&nbsp; &nbsp;echo %%i found as &quot;%%~j&quot;.<br />&nbsp; &nbsp;)<br />)<br /><br />rem Cleanup. Delete bad file.<br />del wmic.bat<br />popd<br /><br />endlocal<br />exit /b<br /></code></pre></div><br /><br /><br /><blockquote><div><cite>aGerman wrote:</cite>I actually didn't want the questioner to run anything as admin only to check if he is able to obtain elevated permissions.<br /></div></blockquote><br />Oh, agreed. That's why I did the immediate exit trick. I guess that's technically running something, but it's about as harmless as you can get.<br /><br /><blockquote><div><cite>aGerman wrote:</cite> That's what I was thinking about&#058;<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>set &quot;check=&quot;<br />for /f &quot;tokens=*&quot; %%a in ('net localgroup 2^&gt;nul^|findstr /ic:&quot;admin&quot;') do (<br />&nbsp; set &quot;check=1&quot;<br />&nbsp; net user %username%|findstr /c:&quot;%%a&quot;&gt;nul &amp;&amp;(<br />&nbsp; &nbsp; echo You belong to the local admins.<br />&nbsp; )||(<br />&nbsp; &nbsp; echo You don't belong to the local admins.<br />&nbsp; )<br />)<br />if not defined check echo You have no permissions to run the NET command.<br /></code></pre></div><br />The local group I belong to is <span style="color: #0000FF">*Administratoren</span>. I'm looking for &quot;admin&quot;. So probably the code will work for you as well. But with something like &quot;администраторы&quot; it would fail.<br /></div></blockquote><br />The language issue is tricky. I expect that between WMIC, VBscript, Jscript, and PowerShell, there's a language-independent way around that, though.</div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="UTC-6">UTC-06:00</span><br />Page <strong>1</strong> of <strong>11</strong></div>
		<div class="copyright">Powered by phpBB&reg; Forum Software &copy; phpBB Limited<br />https://www.phpbb.com/</div>
	</div>
</div>

</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=7347&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 07:50:24 GMT -->
</html>
