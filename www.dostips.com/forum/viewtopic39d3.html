<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=1827&start=15 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 08:33:54 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>Batch &quot;macros&quot; with arguments - Page 2 - DosTips.com</title>


	<link rel="canonical" href="viewtopic46e1.html?t=1827&amp;start=15">

<!--
	phpBB style name: Allan Style - SUBSILVER
	Based on style:   prosilver (this is the default phpBB3 style)
	Based on style:   subsilver2 (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:  Allan ( http://x-tk.ru/ )
-->

<link href="assets/css/font-awesome.mind772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/stylesheetd772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/en/stylesheetd772.css?assets_version=34" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="./styles/AllanStyle-SUBSILVER/theme/tweaks.css?assets_version=34" rel="stylesheet">
<![endif]-->




<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','../../www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-280191-1', 'auto');
	ga('send', 'pageview');
</script>

</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">

<div id="header-subsilver">
	<a id="top" class="top-anchor" accesskey="t"></a>
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description" class="site-description">
				<a id="logo" class="logo" href="../index.html" title="DosTips.com"><span class="site_logo"></span></a>
				<h1>DosTips.com</h1>
				<p>A Forum all about DOS Batch</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

									<div id="search-box" class="search-box search-header" role="search">
				<form action="https://www.dostips.com/forum/search.php" method="get" id="search">
				<fieldset>
					<input name="keywords" id="keywords" type="search" maxlength="128" title="Search for keywords" class="inputbox search tiny" size="20" value="" placeholder="Search…" />
					<button class="button button-search" type="submit" title="Search">
						<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
					</button>
					<a href="search.html" class="button button-search-end" title="Advanced search">
						<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
					</a>
					
				</fieldset>
				</form>
			</div>
						
			</div>
					</div>
</div>


<div id="wrap" class="wrap">
	<div id="page-header">
				<div class="navbar-top" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
																									<li>
								<a href="search33a7.html?search_id=unanswered" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="search526f.html?search_id=active_topics" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-blue" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="search.html" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
											<li class="separator"></li>
																			<li>
								<a href="memberlist4bfd.html?mode=team" role="menuitem">
									<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
								</a>
							</li>
																<li class="separator"></li>

									</ul>
			</div>
		</li>

				<li data-skip-responsive="true">
			<a href="app.php/help/faq.html" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
						
			<li class="rightside"  data-skip-responsive="true">
			<a href="ucp26c3.html?mode=login" title="Login" accesskey="x" role="menuitem">
				<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Login</span>
			</a>
		</li>
					<li class="rightside" data-skip-responsive="true">
				<a href="ucp8319.html?mode=register" role="menuitem">
					<i class="icon fa-pencil-square-o  fa-fw" aria-hidden="true"></i><span>Register</span>
				</a>
			</li>
						</ul>

	</div>
</div>

<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
						<li class="breadcrumbs">
							<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="../index.html" itemprop="url" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span itemprop="title">DosTips.com</span></a></span>
										<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="index.html" itemprop="url" accesskey="h" data-navbar-reference="index"><span itemprop="title">Board index</span></a></span>

											<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="4"><a href="viewforum31e6.html?f=4" itemprop="url"><span itemprop="title">DosTips - Dos Batch</span></a></span>
															<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="3"><a href="viewforum4d6b.html?f=3" itemprop="url"><span itemprop="title">DOS Batch Forum</span></a></span>
												</li>
		
					<li class="rightside responsive-search">
				<a href="search.html" title="View the advanced search options" role="menuitem">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</a>
			</li>
			</ul>

	</div>
</div>

<div class="navbar-top-link">
	<div class="inner">
		<ul>
			<li class="navbar-top-link-left"><a href="search33a7.html?search_id=unanswered">Unanswered topics</a></li>
			<li class="navbar-top-link-left"><a href="search526f.html?search_id=active_topics">Active topics</a></li>

											</ul>
	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
		
<h2 class="topic-title"><a href="viewtopic39d3.html?f=3&amp;t=1827&amp;start=15">Batch &quot;macros&quot; with arguments</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">Discussion forum for all Windows batch related topics.<br /></div>
<p>
	<strong>Moderator:</strong> <a href="memberlista6a8.html?mode=viewprofile&amp;u=5" class="username">DosItHelp</a>
</p>


<div class="action-bar bar-top">
	
			<a href="posting762c.html?mode=reply&amp;f=3&amp;t=1827" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopicbd51.html?f=3&amp;t=1827&amp;start=15&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="https://www.dostips.com/forum/search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topic…" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="search.html" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="1827" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			74 posts
							<ul>
			<li class="arrow previous"><a class="button button-icon-only" href="viewtopicbcaf.html?f=3&amp;t=1827" rel="prev" role="button"><i class="icon fa-chevron-left fa-fw" aria-hidden="true"></i><span class="sr-only">Previous</span></a></li>
				<li><a class="button" href="viewtopicbcaf.html?f=3&amp;t=1827" role="button">1</a></li>
			<li class="active"><span>2</span></li>
				<li><a class="button" href="viewtopic88ac.html?f=3&amp;t=1827&amp;start=30" role="button">3</a></li>
				<li><a class="button" href="viewtopica337.html?f=3&amp;t=1827&amp;start=45" role="button">4</a></li>
				<li><a class="button" href="viewtopicd76f.html?f=3&amp;t=1827&amp;start=60" role="button">5</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopic88ac.html?f=3&amp;t=1827&amp;start=30" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
		</div>




<div id="subsilver-nav-topic">
	<div class="inner"><div class="post has-profile">
		<div class="leftsided postbody subsilver-topic-title">Message</div>
		<div class="leftsided postprofile subsilver-topic-author">Author</div>
	</div></div>
</div>

			<div id="p7368" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile7368">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberliste2cd.html?mode=viewprofile&amp;u=2453" class="username">Ed Dyreen</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search0d5e.html?author_id=2453&amp;sr=posts">1497</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 16 May 2011 08:21</dd>		
		
																<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Flanders(Belgium)</dd>
							
							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact Ed Dyreen">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact Ed Dyreen</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="http://ed-dyreen.ddns.net/" title="Website" class="last-cell">
										<span class="contact-icon phpbb_website-icon">Website</span>
									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content7368">

						<h3 class="first"><a href="#p7368">Re: Batch &quot;macros&quot; with arguments</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingae44.html?mode=quote&amp;f=3&amp;p=7368" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicf376.html?p=7368#p7368" onclick="prompt('Message #16',this.href); return false;">#16</a></span> 
									<a class="unread" href="viewtopicf376.html?p=7368#p7368" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberliste2cd.html?mode=viewprofile&amp;u=2453" class="username">Ed Dyreen</a></strong> &raquo; </span>20 May 2011 06:51
			</p>
			
			
			
			<div class="content">Really, howcome its not working <img class="smilies" src="images/smilies/icon_question.gif" alt=":?:" title="Question" /> <br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>::for %%! in ( &quot;VAR&quot; ) do %IsDefined.Error% %(&gt;nul)%<br />::<br />for %%? in ( IsDefined.Error ) do set &quot;%%~?=set /a ERR = 0 ^&amp;( if not defined %%~^^^! set /a ERR = 1 ) ^&amp;( echo. ^&amp;echo. ^&amp;echo. IsDefined : '%%~^^^!' : ^&amp;set /p &quot;?= '^^^!%%~^^^!^^^!'&quot; ^&lt;nul ^&amp;if ^^^!ERR^^^! neq 0 ( set /p &quot;?= &#91;ERROR:^^^!ERR^^^!&#93;&quot; ^&lt;nul ) else &nbsp; &nbsp;set /p &quot;?= &#91;OK&#93;&quot; ^&lt;nul )&quot;<br /><br />set VAR=some<br /><br />for %%! in ( &quot;VAR&quot; ) do %IsDefined.Error% %(&gt;nul)%<br />echo.<br />echo.algorythm:<br />echo.!IsDefined.Error!_<br /><br /><br />for %%? in ( IsDefined.Error ) do set &quot;%%~?=( %\n%<br />echo.hello)&quot;<br /><br />for %%! in ( &quot;VAR&quot; ) do %IsDefined.Error% %(&gt;nul)%<br />echo.<br />echo.algorythm:<br />echo.!IsDefined.Error!_<br /><br />echo.endoftest<br />pause<br />exit<br /></code></pre></div><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&nbsp;IsDefined : 'VAR' :<br />&nbsp;'some' &#91;OK&#93;<br />algorythm:<br />set /a ERR = 0 &amp;( if not defined %~^! set /a ERR = 1 ) &amp;( echo. &amp;echo. &amp;echo. Is<br />Defined : '%~^!' : &amp;set /p &quot;?= '!%~!!'&quot; &lt;nul &amp;if ^!ERR^! neq 0 ( set /p &quot;?= &#91;ERR<br />OR:!ERR!&#93;&quot; &lt;nul ) else&nbsp; set /p &quot;?= &#91;OK&#93;&quot; &lt;nul )_<br />hello)&quot;<br />De syntaxis van de opdracht is onjuist.<br />Z:\ADMIN\REPAIR\OS\ED's_WinXPPro32x86\EDInstall_WinXPPro32x86 beta v1&gt;<br /></code></pre></div>With EnabledDelayedExpansion I need to see &amp;check my macro before I execute it!</div>

			
													<div class="notice">
					Last edited by <a href="memberliste2cd.html?mode=viewprofile&amp;u=2453" class="username">Ed Dyreen</a> on 20 May 2011 07:14, edited 3 times in total.
									</div>
			
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p7369" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile7369">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content7369">

						<h3 ><a href="#p7369">Re: Batch &quot;macros&quot; with arguments</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting485c.html?mode=quote&amp;f=3&amp;p=7369" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicdf17.html?p=7369#p7369" onclick="prompt('Message #17',this.href); return false;">#17</a></span> 
									<a class="unread" href="viewtopicdf17.html?p=7369#p7369" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>20 May 2011 06:59
			</p>
			
			
			
			<div class="content">OK - I have finally caught up with the macro &quot;calling&quot; macro discussion. Thanks Jeb and Ed, it's been a good exchange. <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /> <br /><br />I had been hoping that the expansion of the inner macro could be delayed until run-time because, as Ed pointed out, I was concerned about the size limit of any single macro definition. But I now realize that there is no avoiding the fact that at run time the entire fully expanded macro must exist in memory as one parsed &quot;statement&quot;, so it was a fools dream.<br /><br />So we agree that the macro must be fully expanded during definition. But what is the best way to do that.<br /><br />I see how Ed is able to accomplish this with simple calls using delayed expansion. But I very much want to avoid delayed expansion during macro definition because:<br /><br />1) I want the macro definitions to persist after the batch that defines them terminates.<br />2) Delayed expansion complicates the syntax of the definition for the reasons that Jeb has pointed out.<br /> <br /><img class="smilies" src="images/smilies/icon_idea.gif" alt=":idea:" title="Idea" /> I am working on a 2 part macro definition mechansim. First the macro is defined with embedded macros referenced in some way that will not be expanded but that can be identified as a macro reference. Something like <strong class="text-strong">${macroName}</strong>. Next I call a <strong class="text-strong">derefMacro</strong> function that recursively expands the <strong class="text-strong">${macroName}</strong> references. The <strong class="text-strong">derefMacro</strong> function will need delayed expansion, but all of the complicated logic will be encapsulated in one place where it can be reused for many macro definitions. I'll post the results of my experiments later.<br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p7370" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile7370">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberliste2cd.html?mode=viewprofile&amp;u=2453" class="username">Ed Dyreen</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search0d5e.html?author_id=2453&amp;sr=posts">1497</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 16 May 2011 08:21</dd>		
		
																<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Flanders(Belgium)</dd>
							
							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact Ed Dyreen">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact Ed Dyreen</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="http://ed-dyreen.ddns.net/" title="Website" class="last-cell">
										<span class="contact-icon phpbb_website-icon">Website</span>
									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content7370">

						<h3 ><a href="#p7370">Re: Batch &quot;macros&quot; with arguments</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingeba3.html?mode=quote&amp;f=3&amp;p=7370" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic5016.html?p=7370#p7370" onclick="prompt('Message #18',this.href); return false;">#18</a></span> 
									<a class="unread" href="viewtopic5016.html?p=7370#p7370" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberliste2cd.html?mode=viewprofile&amp;u=2453" class="username">Ed Dyreen</a></strong> &raquo; </span>20 May 2011 07:08
			</p>
			
			
			
			<div class="content"><blockquote class="uncited"><div>1) I want the macro definitions to persist after the batch that defines them terminates.<br /></div></blockquote>What do u mean, If the current DOS environment closes, there is nothing to persist in!<br /><br />I make the environment persist like :<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&gt;&quot;%%~!&quot; echo.@start &quot;Restart&quot; /low /min %%comspec%% /!COMMAND! &quot;!FullPath.LocalHost.SCRIPT!\!File.SCRIPT!&quot; ||echo.whooptiddy<br />start &quot;!TITLE!&quot; /low /min /wait /D &quot;!SystemROOT!\system32&quot; &quot;%comspec%&quot; /c &quot;%%~!&quot;<br />Exit 0<br /></code></pre></div>Can someone help me with my previous post? I really wan't to use \n with EnaDelayExpansion<br /><br />No wait this works ...<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>set ^&quot;var7=this^%LF%%LF%works again&quot;<br /><br />echo.!var7!<br />echo.endoftest<br />pause<br />exit<br /></code></pre></div></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p7373" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile7373">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content7373">

						<h3 ><a href="#p7373">Re: Batch &quot;macros&quot; with arguments</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinga5f5.html?mode=quote&amp;f=3&amp;p=7373" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicc3af.html?p=7373#p7373" onclick="prompt('Message #19',this.href); return false;">#19</a></span> 
									<a class="unread" href="viewtopicc3af.html?p=7373#p7373" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>20 May 2011 09:34
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>Ed Dyreen wrote:</cite>What do u mean, If the current DOS environment closes, there is nothing to persist in!<br /></div></blockquote><br />Just because the batch terminates doesn't mean the parent &quot;DOS&quot; session has to terminate. I've been meaning to ask why you always terminate your example code with <strong class="text-strong">exit</strong> - this practice indeed terminates the DOS session.<br /><br />I want to be able to run a batch file that loads a library of macros and then terminates with the DOS session still alive. The macro library file might end with <strong class="text-strong">exit /b</strong>, but not <strong class="text-strong">exit</strong>. At this point the macros are defined and available to any batch file that might be run subsequently.<br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p7374" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile7374">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberliste2cd.html?mode=viewprofile&amp;u=2453" class="username">Ed Dyreen</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search0d5e.html?author_id=2453&amp;sr=posts">1497</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 16 May 2011 08:21</dd>		
		
																<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Flanders(Belgium)</dd>
							
							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact Ed Dyreen">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact Ed Dyreen</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="http://ed-dyreen.ddns.net/" title="Website" class="last-cell">
										<span class="contact-icon phpbb_website-icon">Website</span>
									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content7374">

						<h3 ><a href="#p7374">Re: Batch &quot;macros&quot; with arguments</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingaf8f-2.html?mode=quote&amp;f=3&amp;p=7374" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopica7af-2.html?p=7374#p7374" onclick="prompt('Message #20',this.href); return false;">#20</a></span> 
									<a class="unread" href="viewtopica7af-2.html?p=7374#p7374" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberliste2cd.html?mode=viewprofile&amp;u=2453" class="username">Ed Dyreen</a></strong> &raquo; </span>20 May 2011 09:44
			</p>
			
			
			
			<div class="content">'<br />REALLY !, I did not know that . <img class="smilies" src="images/smilies/icon_cool.gif" alt="8)" title="Cool" /> <br />But have been progressing with macros &amp;enableddelayedexpansion, macro1 could be called directly or indirectly by another macro:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>::------------------------------------------------------------<br />::Pre Define LocalScope EnableDelayedExpansion<br />:: &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&gt;&gt;<br />::(<br />&nbsp; &nbsp;Setlocal EnableDelayedExpansion<br /><br />&nbsp; &nbsp;::Recreate single LineFeed once<br />&nbsp; &nbsp;set \n=^%LF%%LF%<br /><br />&nbsp; &nbsp;::Recreate single LineFeed twice<br />&nbsp; &nbsp;set \n2=^^^%lf%%lf%^%lf%%lf%<br />::)<br />::<br />::Post Define LocalScope EnableDelayedExpansion &nbsp; &nbsp;&nbsp; &nbsp;&lt;&lt;<br />::------------------------------------------------------------<br /><br />::----------------------------------------------------------------------------------<br />:: Pre Define See.Error &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&gt;&gt;<br />::<br />::(<br />&nbsp; &nbsp;set ^&quot;See.Error=( &nbsp; &nbsp;if ^^^!Error^^^! neq 0 ( %\n2%^<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;set /p &quot;?= &#91;Error:^!Error^!&#93;&quot; ^&lt;nul %\n2%^<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;) else &nbsp; &nbsp;set /p &quot;?= &#91;OK:^!Error^!&#93;&quot; ^&lt;nul %\n2%^<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;)&quot;<br />::)<br />::<br />:: Post Define See.Error &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&lt;&lt;<br />::----------------------------------------------------------------------------------<br /><br />::----------------------------------------------------------------------------------<br />:: Pre Define IsDefined.Error &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&gt;&gt;<br />::<br />::(<br />&nbsp; &nbsp;set ^&quot;IsDefined.Error=do ( %\n2%^<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;Setlocal EnableDelayedExpansion %\n2%^<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;if defined %%~^^^! ( set /a Error = 0 ) else set /a Error = 1 %\n2%^<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;( %\n2%^<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;echo. %\n2%^<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;echo. %\n2%^<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;echo. IsDefined : '%%~^^^!' : %\n2%^<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;set /p &quot;?= '^!%%~^!^!'&quot; ^&lt;nul %\n2%^<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;!See.Error! %\n2%^<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;) %\n2%^<br />&nbsp; &nbsp;)&quot;<br />::)<br />::<br />:: Post Define IsDefined.Error &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&lt;&lt;<br />::----------------------------------------------------------------------------------<br /><br />::------------------------------------------------------------<br />:: - Test.Macro &gt;&gt;<br />::<br />::(<br /><br />&nbsp; &nbsp;set &quot;Test.Macro=!IsDefined.Error!&quot;<br />&nbsp; &nbsp;::<br />&nbsp; &nbsp;echo.!Test.Macro!_<br />&nbsp; &nbsp;::<br />&nbsp; &nbsp;set &quot;var=filled&quot;<br />&nbsp; &nbsp;::<br />&nbsp; &nbsp;for %%! in ( &quot;VAR&quot; ) %Test.Macro% %(&gt;nul)%<br />&nbsp; &nbsp;::<br />&nbsp; &nbsp;echo.<br />&nbsp; &nbsp;echo.endoftest<br />&nbsp; &nbsp;pause<br />&nbsp; &nbsp;exit<br />::)<br /></code></pre></div>It looks promising and is exactly what I wanted.<br /><br />Also I am wondering if there would be a performance benefit if I left out all setlocal definitions, it is no problem if i use strict naming conventions for variable names.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p7388" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile7388">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content7388">

						<h3 ><a href="#p7388">Re: Batch &quot;macros&quot; with arguments</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingefa3.html?mode=quote&amp;f=3&amp;p=7388" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicbccb-2.html?p=7388#p7388" onclick="prompt('Message #21',this.href); return false;">#21</a></span> 
									<a class="unread" href="viewtopicbccb-2.html?p=7388#p7388" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>20 May 2011 17:15
			</p>
			
			
			
			<div class="content">Yipee!   <img class="smilies" src="images/smilies/icon_exclaim.gif" alt=":!:" title="Exclamation" />   <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /><br /><br />I've succeeded in implementing a macro calling a macro two levels deep. I used the <strong class="text-strong">drefMacro</strong> function I talked about in my last post.<br /><br />Warning - do not recurse macro definitions <img class="smilies" src="images/smilies/icon_exclaim.gif" alt=":!:" title="Exclamation" /><br /><br />Known bug:  <img class="smilies" src="images/smilies/icon_confused.gif" alt=":?" title="Confused" /> Jeb - I attempted to utilize a modified version of the special return beyond ENDLOCAL technique you developed in <a href="viewtopic116d.html?f=3&amp;t=1733&amp;start=15" class="postlink">New Functions - :asc, :chr, :str2Hex, :hex2Str</a>. But I ran into problems when the returning for loop used a variable that matched a variable in a macro def. I got around the problem by reserving  non-alpha characters @, &lt;period&gt;, &lt;quote&gt; for the deref returning loop. I don't know if it is my bug, or if there is a limit to your technique, but I suspect the problem is on my end.<br /><br />There are probably other bugs, but I wanted to post this once it was basically working.<br /><br />First is a batch file that does nothing but define a library of test macros. I use <strong class="text-strong">${macroName}</strong> syntax to reference a macro within a macro. Once they are all defined I use a loop to find all the defined macros and call <strong class="text-strong">drefMacro macroName</strong> to de-reference or expand the macro definitions.<br /><br /><strong class="text-strong">macroLib.bat</strong>:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br /><br />set LF=^<br /><br /><br />::Above 2 blank lines are required - do not remove<br /><br />set ^&quot;\n=^^^%LF%%LF%^%LF%%LF%^^&quot;<br /><br />set callMacro=for /f &quot;tokens=1-26&quot; %%a in<br /><br />set macro.StrLen=do (%\n%<br />&nbsp; setlocal enableDelayedExpansion%\n%<br />&nbsp; set &quot;str=A!%%~a!&quot;%\n%<br />&nbsp; set &quot;len=0&quot;%\n%<br />&nbsp; for /l %%A in (12,-1,0) do (%\n%<br />&nbsp; &nbsp; set /a &quot;len|=1&lt;&lt;%%A&quot;%\n%<br />&nbsp; &nbsp; for %%B in (!len!) do if &quot;!str:~%%B,1!&quot;==&quot;&quot; set /a &quot;len&amp;=~1&lt;&lt;%%A&quot;%\n%<br />&nbsp; )%\n%<br />&nbsp; for %%v in (!len!) do endlocal^&amp;if &quot;%%~b&quot; neq &quot;&quot; (set &quot;%%~b=%%v&quot;) else echo %%v%\n%<br />)<br /><br />set macro.1=do (%\n%<br />&nbsp; setLocal enableDelayedExpansion %\n%<br />&nbsp; echo in macro.1 prior to loop: a=%%a %\n%<br />&nbsp; for /l %%a in (1,1,3) do echo inside inner macro.1 loop: a=%%a %\n%<br />&nbsp; echo in macro.1 after loop: a=%%a %\n%<br />&nbsp; set &quot;part1=macro.1 Return Value&quot; %\n%<br />&nbsp; echo in macro.1: rtn=!part1! %\n%<br />&nbsp; set &quot;part2=&quot; %\n%<br />&nbsp; echo in macro.1 before &quot;call&quot; to macro.2: part2=!part2! %\n%<br />&nbsp; %callMacro% (&quot;part2&quot;) ${macro.2} %\n%<br />&nbsp; echo in macro.1 after &quot;call&quot; to macro.2: part2=!part2! %\n%<br />&nbsp; for /f &quot;delims=&quot; %%v in (&quot;!part1!:!part2!&quot;) do endlocal^&amp;set &quot;%%~a=%%v&quot; %\n%<br />)<br /><br />set macro.2=do (%\n%<br />&nbsp; setLocal enableDelayedExpansion %\n%<br />&nbsp; echo in macro.2: a=%%a %\n%<br />&nbsp; set &quot;rtn=macro.2 Return Value&quot; %\n%<br />&nbsp; echo in macro.2 before call to macro.3: rtn=!rtn! %\n%<br />&nbsp; %callMacro% (&quot;rtn&quot;) ${macro.3} %\n%<br />&nbsp; echo in macro.2 after call to macro.3: rtn=!rtn! %\n%<br />&nbsp; for /f &quot;delims=&quot; %%v in (&quot;!rtn!&quot;) do endlocal^&amp;set &quot;%%~a=%%v&quot; %\n%<br />)<br /><br />set macro.3=do (%\n%<br />&nbsp; setLocal enableDelayedExpansion %\n%<br />&nbsp; echo in macro.3: a=%%a %\n%<br />&nbsp; set &quot;rtn=!%%~a!:macro.3 Return Value&quot; %\n%<br />&nbsp; echo in macro.3 test ${falseMacroRef} %\n%<br />&nbsp; echo in macro.3: rtn=!rtn! %\n%<br />&nbsp; for /f &quot;delims=&quot; %%v in (&quot;!rtn!&quot;) do endlocal^&amp;set &quot;%%~a=%%v&quot; %\n%<br />)<br /><br />echo ----- before drefMacro ----------<br />set macro<br />for /f &quot;delims==&quot; %%v in ('set macro. ^| findstr /r /i &quot;/c:^macro.&quot;') do (<br />&nbsp; if /i not &quot;%%v&quot;==&quot;macro.&quot; call :derefMacro %%v<br />)<br />echo ----- after drefMacro ----------<br />set macro<br />echo:<br /><br />exit /b<br /><br />:derefMacro macroName<br />::<br />:: We don't know the name of any embedded macros so all local variables must<br />:: be named in such a way that they are &quot;guaranteed&quot; not to collide with the<br />:: macro names. I assume no macro name will ever start with &quot;_temp&quot;. Of course<br />:: if we follow the convention that all macro names begin with &quot;macro&quot;, then<br />:: this will never be a problem.<br />::<br />&nbsp; setlocal enableDelayedExpansion<br />&nbsp; set &quot;_tempMacro=!%~1!&quot;<br /><br />&nbsp; :derefMacro.Top<br />&nbsp; set &quot;_tempParse1=!_tempMacro!&quot;<br /><br />&nbsp; :derefMacro.Parse<br />&nbsp; set &quot;_tempParse2=!_tempParse1:*${=!&quot;<br />&nbsp; if &quot;!_tempParse2!&quot;==&quot;!_tempParse1!&quot; goto :derefMacro.End<br />&nbsp; if not defined _tempParse2 goto :derefMacro.End<br />&nbsp; set &quot;_tempParse3=!_tempParse2:*}=!&quot;<br />&nbsp; if &quot;!_tempParse3!&quot;==&quot;!_tempParse2!&quot; goto :derefMacro.End<br />&nbsp; %callMacro% (&quot;_tempMacro _tempLen1&quot;) %macro.StrLen%<br />&nbsp; %callMacro% (&quot;_tempParse2 _tempLen2&quot;) %macro.StrLen%<br />&nbsp; %callMacro% (&quot;_tempParse3 _tempSuffixLen&quot;) %macro.StrLen%<br />&nbsp; set /a &quot;_tempNameStart=_tempLen1-_tempLen2, _tempPrefixLen=_tempNameStart-2, _tempNameLen=_tempLen1-_tempPrefixLen-_tempSuffixLen-3&quot;<br />&nbsp; set &quot;_tempName=!_tempMacro:~%_tempNameStart%,%_tempNameLen%!&quot;<br />&nbsp; if not defined %_tempName% (<br />&nbsp; &nbsp; set &quot;_tempParse1=!_tempParse2!&quot;<br />&nbsp; &nbsp; goto :derefMacro.Parse<br />&nbsp; )<br />&nbsp; set &quot;_tempMacro=!_tempMacro:~0,%_tempPrefixLen%!!%_tempName%!!_tempMacro:~-%_tempSuffixLen%!&quot;<br />&nbsp; goto :derefMacro.Top<br /><br />&nbsp; :derefMacro.End<br />&nbsp; set &quot;_tempMacro=!_tempMacro:%%=%%~_!&quot;<br />&nbsp; set &quot;_tempMacro=!_tempMacro:&quot;=%%~.!&quot;<br />&nbsp; for %%l in (&quot;!LF!&quot;) do set &quot;_tempMacro=!_tempMacro:%%~l=%%~@!&quot;<br />&nbsp; for %%@ in (&quot;!LF!&quot;) do for %%. in (^&quot;&quot;&quot;) do for %%_ in (&quot;%%&quot;) do (<br />&nbsp; &nbsp; endlocal<br />&nbsp; &nbsp; set &quot;%~1=%_tempMacro%&quot;<br />&nbsp; )<br />exit /b<br /></code></pre></div><br /><br />Next is a simple test program to excersize the macros. It simply loads the library and calls macro.1, which in turn &quot;calls&quot; macro.2 and macro.3. But actually the calls are embedded within the macro.1 definition by now.<br /><br />It is Sooo much easier to include a library of macros than it is to include a library of functions <img class="smilies" src="images/smilies/icon_exclaim.gif" alt=":!:" title="Exclamation" />  <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /> <br /><br />simple macro test program:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />setlocal<br /><br />call macroLib.bat<br /><br />set var=<br />echo before call to macro.1: var=%var%<br />%callMacro% (&quot;var&quot;) %macro.1%<br />echo after call to macro.1: var=%var%<br /><br />exit /b<br /></code></pre></div><br /><br />And here are the results:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>----- before drefMacro ----------<br />macro.1=do (<br />&nbsp; setLocal enableDelayedExpansion<br />&nbsp; echo in macro.1 prior to loop: a=%a<br />&nbsp; for /l %a in (1,1,3) do echo inside inner macro.1 loop: a=%a<br />&nbsp; echo in macro.1 after loop: a=%a<br />&nbsp; set &quot;part1=macro.1 Return Value&quot;<br />&nbsp; echo in macro.1: rtn=!part1!<br />&nbsp; set &quot;part2=&quot;<br />&nbsp; echo in macro.1 before &quot;call&quot; to macro.2: part2=!part2!<br />&nbsp; for /f &quot;tokens=1-26&quot; %a in (&quot;part2&quot;) ${macro.2}<br />&nbsp; echo in macro.1 after &quot;call&quot; to macro.2: part2=!part2!<br />&nbsp; for /f &quot;delims=&quot; %v in (&quot;!part1!:!part2!&quot;) do set &quot;%~a=%v&quot;<br />)<br />macro.2=do (<br />&nbsp; setLocal enableDelayedExpansion<br />&nbsp; echo in macro.2: a=%a<br />&nbsp; set &quot;rtn=macro.2 Return Value&quot;<br />&nbsp; echo in macro.2 before call to macro.3: rtn=!rtn!<br />&nbsp; for /f &quot;tokens=1-26&quot; %a in (&quot;rtn&quot;) ${macro.3}<br />&nbsp; echo in macro.2 after call to macro.3: rtn=!rtn!<br />&nbsp; for /f &quot;delims=&quot; %v in (&quot;!rtn!&quot;) do set &quot;%~a=%v&quot;<br />)<br />macro.3=do (<br />&nbsp; setLocal enableDelayedExpansion<br />&nbsp; echo in macro.3: a=%a<br />&nbsp; set &quot;rtn=!%~a!:macro.3 Return Value&quot;<br />&nbsp; echo in macro.3 test ${falseMacroRef}<br />&nbsp; echo in macro.3: rtn=!rtn!<br />&nbsp; for /f &quot;delims=&quot; %v in (&quot;!rtn!&quot;) do set &quot;%~a=%v&quot;<br />)<br />macro.StrLen=do (<br />&nbsp; setlocal enableDelayedExpansion<br />&nbsp; set &quot;str=A!%~a!&quot;<br />&nbsp; set &quot;len=0&quot;<br />&nbsp; for /l %A in (12,-1,0) do (<br />&nbsp; &nbsp; set /a &quot;len|=1&lt;&lt;%A&quot;<br />&nbsp; &nbsp; for %B in (!len!) do if &quot;!str:~%B,1!&quot;==&quot;&quot; set /a &quot;len&amp;=~1&lt;&lt;%A&quot;<br />&nbsp; )<br />&nbsp; for %v in (!len!) do endlocal&amp;if &quot;%~b&quot; neq &quot;&quot; (set &quot;%~b=%v&quot;) else echo %v<br />)<br />----- after drefMacro ----------<br />macro.1=do (<br />&nbsp; setLocal enableDelayedExpansion<br />&nbsp; echo in macro.1 prior to loop: a=%a<br />&nbsp; for /l %a in (1,1,3) do echo inside inner macro.1 loop: a=%a<br />&nbsp; echo in macro.1 after loop: a=%a<br />&nbsp; set &quot;part1=macro.1 Return Value&quot;<br />&nbsp; echo in macro.1: rtn=!part1!<br />&nbsp; set &quot;part2=&quot;<br />&nbsp; echo in macro.1 before &quot;call&quot; to macro.2: part2=!part2!<br />&nbsp; for /f &quot;tokens=1-26&quot; %a in (&quot;part2&quot;) do (<br />&nbsp; setLocal enableDelayedExpansion<br />&nbsp; echo in macro.2: a=%a<br />&nbsp; set &quot;rtn=macro.2 Return Value&quot;<br />&nbsp; echo in macro.2 before call to macro.3: rtn=!rtn!<br />&nbsp; for /f &quot;tokens=1-26&quot; %a in (&quot;rtn&quot;) do (<br />&nbsp; setLocal enableDelayedExpansion<br />&nbsp; echo in macro.3: a=%a<br />&nbsp; set &quot;rtn=!%~a!:macro.3 Return Value&quot;<br />&nbsp; echo in macro.3 test ${falseMacroRef}<br />&nbsp; echo in macro.3: rtn=!rtn!<br />&nbsp; for /f &quot;delims=&quot; %v in (&quot;!rtn!&quot;) do set &quot;%~a=%v&quot;<br />)<br />&nbsp; echo in macro.2 after call to macro.3: rtn=!rtn!<br />&nbsp; for /f &quot;delims=&quot; %v in (&quot;!rtn!&quot;) do set &quot;%~a=%v&quot;<br />)<br />&nbsp; echo in macro.1 after &quot;call&quot; to macro.2: part2=!part2!<br />&nbsp; for /f &quot;delims=&quot; %v in (&quot;!part1!:!part2!&quot;) do set &quot;%~a=%v&quot;<br />)<br />macro.2=do (<br />&nbsp; setLocal enableDelayedExpansion<br />&nbsp; echo in macro.2: a=%a<br />&nbsp; set &quot;rtn=macro.2 Return Value&quot;<br />&nbsp; echo in macro.2 before call to macro.3: rtn=!rtn!<br />&nbsp; for /f &quot;tokens=1-26&quot; %a in (&quot;rtn&quot;) do (<br />&nbsp; setLocal enableDelayedExpansion<br />&nbsp; echo in macro.3: a=%a<br />&nbsp; set &quot;rtn=!%~a!:macro.3 Return Value&quot;<br />&nbsp; echo in macro.3 test ${falseMacroRef}<br />&nbsp; echo in macro.3: rtn=!rtn!<br />&nbsp; for /f &quot;delims=&quot; %v in (&quot;!rtn!&quot;) do set &quot;%~a=%v&quot;<br />)<br />&nbsp; echo in macro.2 after call to macro.3: rtn=!rtn!<br />&nbsp; for /f &quot;delims=&quot; %v in (&quot;!rtn!&quot;) do set &quot;%~a=%v&quot;<br />)<br />macro.3=do (<br />&nbsp; setLocal enableDelayedExpansion<br />&nbsp; echo in macro.3: a=%a<br />&nbsp; set &quot;rtn=!%~a!:macro.3 Return Value&quot;<br />&nbsp; echo in macro.3 test ${falseMacroRef}<br />&nbsp; echo in macro.3: rtn=!rtn!<br />&nbsp; for /f &quot;delims=&quot; %v in (&quot;!rtn!&quot;) do set &quot;%~a=%v&quot;<br />)<br />macro.StrLen=do (<br />&nbsp; setlocal enableDelayedExpansion<br />&nbsp; set &quot;str=A!%~a!&quot;<br />&nbsp; set &quot;len=0&quot;<br />&nbsp; for /l %A in (12,-1,0) do (<br />&nbsp; &nbsp; set /a &quot;len|=1&lt;&lt;%A&quot;<br />&nbsp; &nbsp; for %B in (!len!) do if &quot;!str:~%B,1!&quot;==&quot;&quot; set /a &quot;len&amp;=~1&lt;&lt;%A&quot;<br />&nbsp; )<br />&nbsp; for %v in (!len!) do endlocal&amp;if &quot;%~b&quot; neq &quot;&quot; (set &quot;%~b=%v&quot;) else echo %v<br />)<br /><br />before call to macro.1: var=<br />in macro.1 prior to loop: a=var<br />inside inner macro.1 loop: a=1<br />inside inner macro.1 loop: a=2<br />inside inner macro.1 loop: a=3<br />in macro.1 after loop: a=var<br />in macro.1: rtn=macro.1 Return Value<br />in macro.1 before &quot;call&quot; to macro.2: part2=<br />in macro.2: a=part2<br />in macro.2 before call to macro.3: rtn=macro.2 Return Value<br />in macro.3: a=rtn<br />in macro.3 test ${falseMacroRef}<br />in macro.3: rtn=macro.2 Return Value:macro.3 Return Value<br />in macro.2 after call to macro.3: rtn=macro.2 Return Value:macro.3 Return Value<br />in macro.1 after &quot;call&quot; to macro.2: part2=macro.2 Return Value:macro.3 Return Value<br />after call to macro.1: var=macro.1 Return Value:macro.2 Return Value:macro.3 Return Value<br /></code></pre></div><br /><br />Dave Benham</div>

			
													<div class="notice">
					Last edited by <a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a> on 21 May 2011 18:41, edited 2 times in total.
									</div>
			
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p7390" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile7390">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberliste2cd.html?mode=viewprofile&amp;u=2453" class="username">Ed Dyreen</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search0d5e.html?author_id=2453&amp;sr=posts">1497</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 16 May 2011 08:21</dd>		
		
																<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Flanders(Belgium)</dd>
							
							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact Ed Dyreen">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact Ed Dyreen</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="http://ed-dyreen.ddns.net/" title="Website" class="last-cell">
										<span class="contact-icon phpbb_website-icon">Website</span>
									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content7390">

						<h3 ><a href="#p7390">Re: Batch &quot;macros&quot; with arguments</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting51c2.html?mode=quote&amp;f=3&amp;p=7390" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic8377.html?p=7390#p7390" onclick="prompt('Message #22',this.href); return false;">#22</a></span> 
									<a class="unread" href="viewtopic8377.html?p=7390#p7390" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberliste2cd.html?mode=viewprofile&amp;u=2453" class="username">Ed Dyreen</a></strong> &raquo; </span>20 May 2011 19:53
			</p>
			
			
			
			<div class="content">'<br />So you are reducing the overhead aswell! By derefferencing first, it won't have to be done at execution phase brilliant <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p7391" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile7391">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content7391">

						<h3 ><a href="#p7391">Re: Batch &quot;macros&quot; with arguments</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingdf29.html?mode=quote&amp;f=3&amp;p=7391" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic5ead.html?p=7391#p7391" onclick="prompt('Message #23',this.href); return false;">#23</a></span> 
									<a class="unread" href="viewtopic5ead.html?p=7391#p7391" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>20 May 2011 21:19
			</p>
			
			
			
			<div class="content">I edited my prior post to fix a bug in the macroLib.bat code. I had forgotten the ENDLOCAL at the end of macro.1, macro.2 and macro.3. The test program was giving the correct visual output, but the local macro variables were still active after the &quot;calls&quot;. All is good now (till the next bug).<br /><br />=====================================<br /><br /><blockquote><div><cite>Ed Dyreen wrote:</cite>So you are reducing the overhead aswell! By derefferencing first, it won't have to be done at execution phase brilliant <br /></div></blockquote><br />Thanks, but I'm not so sure it is brilliant, more like the only way that it can work. Even your examples were expanded during the definition phase when you used traditional delayed expansion. The big advantage of <strong class="text-strong">${macroName} / derefMacro</strong> is we take control of when and how the macro is expanded, thus avoiding all of the problems associated with delayed expansion using <strong class="text-strong">!macroName!</strong>. Given that we can't predict how many layers deep the calls will go, trying to figure out how many times to escape the ^,  ! and &lt;LF&gt; characters would be a nightmare!<br /><br />=====================================<br /><br />Given that the macros enable delayed expansion within their body, we can't call them directly from the command prompt. They must be called from a batch file. But wouldn't it be nice to run them from the command prompt? I thought so, so I wrote:<br /><br /><strong class="text-strong">callMacro.bat</strong>:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />setlocal enableDelayedExpansion<br />set &quot;macro.temp=!%~1!&quot;<br />endlocal &amp; for /f &quot;tokens=2-27&quot; %%a in (&quot;%*&quot;) %macro.temp%<br />exit /b<br /></code></pre></div><br />This very small batch file is simply a batch wrapper around a macro. To call macro.StrLen you would use:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>callMacro macro.StrLen strVar &#91;rtnVar&#93;<br />or<br />call callMacro macro.StrLen strVar &#91;rtnVar&#93;<br /><br />where &#91;rtnVar&#93; is the optional output variable.<br /></code></pre></div><br />We have reintroduced the call function overhead, but we are not likely to notice the impact during an interactive session!<br /><br />Of course I am assuming the batch library (macroLib.bat in my test cases) has already been loaded (run) prior to calling callMacro.bat, and that callMacro.bat is in the current directory or the PATH.<br /><br />CallMacro.bat can also be useful within a batch file when the definition of a macro or other compound statement is exceeding the limits of DOS. Using the macro directly expands the macro within the compound statement. Calling :callMacro takes the expansion out of the compound statement and puts it in the function. The only requirement is that callMacro.bat reside in the current directory or the PATH. Or you could copy the function into your batch file.<br /><br />CallMacro.bat is not bullet proof - it does not gracefully handle arguments with special characters, especially the caret &quot;^&quot;. Special handling could be added, but that will add extra overhead.<br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p7392" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile7392">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content7392">

						<h3 ><a href="#p7392">Re: Batch &quot;macros&quot; with arguments</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting40cc.html?mode=quote&amp;f=3&amp;p=7392" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic9d09.html?p=7392#p7392" onclick="prompt('Message #24',this.href); return false;">#24</a></span> 
									<a class="unread" href="viewtopic9d09.html?p=7392#p7392" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>20 May 2011 22:30
			</p>
			
			
			
			<div class="content">OK - I need some advice on the best way to provide on-line help for macro libraries.<br /><br />I see two obvious strategies:<br /><br />1) Define the documentation as variables. Something like:<br /><br />set macro.args.macroName= argument list only on one line<br />set macro.help.macroName= ${macro.doc.args.macroName} followed by multi-line description using %\n%<br /><br />I really like this because the help is easily available using the SET command - No need to write a help function or macro. We can easily request help on a single command, or many commands. I also like the concept of keeping the help with the definitions - everything is in memory! But I'm worried about environment space bloat. Is there a practical limit to the size of the environment? I'm thinking the help text could end up being 1/4 to 1/2 the size of the macro definitions themselves.<br /><br />2) Keep the documentation as text within the library batch file. Write a function to extract and display the desired help text via creative use of the FINDSTR command. I've seen many examples of this, and I've done this myself many times.<br /><br />I would like to use option 1, but am thinking that option 2 is the safer, more conservative option.<br /><br />What say the experts?<br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p7393" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile7393">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberliste2cd.html?mode=viewprofile&amp;u=2453" class="username">Ed Dyreen</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search0d5e.html?author_id=2453&amp;sr=posts">1497</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 16 May 2011 08:21</dd>		
		
																<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Flanders(Belgium)</dd>
							
							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact Ed Dyreen">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact Ed Dyreen</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="http://ed-dyreen.ddns.net/" title="Website" class="last-cell">
										<span class="contact-icon phpbb_website-icon">Website</span>
									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content7393">

						<h3 ><a href="#p7393">Re: Batch &quot;macros&quot; with arguments</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingfdbf.html?mode=quote&amp;f=3&amp;p=7393" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic9079.html?p=7393#p7393" onclick="prompt('Message #25',this.href); return false;">#25</a></span> 
									<a class="unread" href="viewtopic9079.html?p=7393#p7393" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberliste2cd.html?mode=viewprofile&amp;u=2453" class="username">Ed Dyreen</a></strong> &raquo; </span>20 May 2011 23:46
			</p>
			
			
			
			<div class="content">'<br />I would implement both techniques, the help screen does not need to be fast in my opinion as you should not be in help screens most of the time. Variabes are still best if the messages are repetitive. strings like &quot;a b c d ...&quot; for mathematics. My script is horribly innefficient &amp;a huge amount of variables are loaded. So I don't think the environment is gonna be a problem.<br /><br />I have been using macros for a long time, Until now most output to con I handle with functions..<br />Some screens contain a lot of characters &amp;the macros can only contain 4096 of them. I've read somewhere it's the maximum for any command.<br /><br />I have done some progressing myself too, if it is of any interest to you, I have fallen back to an old habit delayed expansion <img class="smilies" src="images/smilies/icon_redface.gif" alt=":oops:" title="Embarassed" />  I like your way of building the macro's. Can it work for my macros too or ? Is that not possible ?<br /><br />I have a new problem now that i did not have before I used \n, I can no longer display the '!' anymore not even if i escape it 7 times ^^^^^^^!<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>::--------------------------------------------------------------------------------------------------------------------------<br />:: Pre Define Create.Object &gt;&gt;<br />::(<br />&nbsp; &nbsp;set ^&quot;@Create.Object=( %\n2%^<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;Setlocal EnableDelayedExpansion %\n2%^<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;set &quot;Name=%%~a&quot; %\n2%^<br />&nbsp; &nbsp;&nbsp; &nbsp;set &quot;Extension=%%~b&quot; %\n2%^<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;set &quot;StdIn=%%~c&quot; %\n2%^<br />&nbsp; &nbsp;&nbsp; &nbsp;set &quot;StdOut=&quot; %\n2%^<br />&nbsp; &nbsp;&nbsp; &nbsp;set &quot;SError=%%~d&quot; %\n2%^<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;if ^^^!Error^^^! equ 0 ( %\n2%^<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if /i &#91;&quot;^!Extension^!&quot;&#93; == &#91;&quot;File&quot;&#93; ( %\n2%^<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;%forAmacro% ( '&quot;^!Name^!&quot;¦&quot;^!StdIn^!&quot;¦&quot;%%~d&quot;' ) do !@Create.File! %\n2%^<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;%forRmacro% ( '&quot;^!StdOut^!&quot;' ) do set &quot;StdOut=&quot;^^^!%%~r^^^!&quot;¦&quot; %\n2%^<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;%forAmacro% ( '&quot;^!Name^!&quot;¦&quot;^!StdIn^!&quot;¦&quot;%%~d&quot;' ) do !@Create.FileName! %\n2%^<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;%forRmacro% ( '&quot;^!StdOut^!&quot;' ) do set &quot;StdOut=^!StdOut^!&quot;^^^!%%~r^^^!&quot;¦&quot; %\n2%^<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;) else &nbsp; &nbsp;if /i &#91;&quot;^!Extension^!&quot;&#93; == &#91;&quot;FileName&quot;&#93; ( %\n2%^<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;%forAmacro% ( '&quot;^!Name^!&quot;¦&quot;^!StdIn^!&quot;¦&quot;%%~d&quot;' ) do !@Create.FileName! %\n2%^<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;) %\n2%^<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;) %\n2%^<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;%forRmacro% ( %\n2%^<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;'&quot;^!Extension^!&quot;¦^^^!StdOut^^^!&quot;^!Error^!&quot;' %\n2%^<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;) do ( %\n2%^<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;Endlocal %\n2%^<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if /i &#91;&quot;%%~r&quot;&#93; == &#91;&quot;File&quot;&#93; ( %\n2%^<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;set &quot;%%~b.File=%%~s&quot; %\n2%^<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;set &quot;%%~b.FileName=%%~t&quot; %\n2%^<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;set /a Error = %%~u %\n2%^<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;) else &nbsp; &nbsp;if /i &#91;&quot;%%~r&quot;&#93; == &#91;&quot;FileName&quot;&#93; ( %\n2%^<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;set &quot;%%~b.FileName=%%~s&quot; %\n2%^<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;set /a Error = %%~t %\n2%^<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;) %\n2%^<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;) %\n2%^<br /><br />&nbsp; &nbsp;) ^&amp;( %\n2%^<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;echo. %\n2%^<br />&nbsp; &nbsp;&nbsp; &nbsp;echo. %\n2%^<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;echo. @Create.Object: '%%~a.%%~b' %\n2%^<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;echo.&nbsp; StdOut.%%~b&nbsp; : '^^^!%%~a.%%~b^^^!' %\n2%^<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;if /i &#91;&quot;%%~b&quot;&#93; == &#91;&quot;File&quot;&#93; ( %\n2%^<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;echo.&nbsp; StdOut.FileName: '^^^!%%~a.FileName^^^!' %\n2%^<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;) %\n2%^<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;echo.&nbsp; Error&nbsp; &nbsp; &nbsp; &nbsp; : '^^^!Error^^^!' %\n2%^<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;!@See.Error! %\n2%^<br />&nbsp; &nbsp;)&quot;<br />::)<br />::<br />:: Post Define Create.Object &lt;&lt;<br />::--------------------------------------------------------------------------------------------------------------------------<br /></code></pre></div></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p7408" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile7408">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content7408">

						<h3 ><a href="#p7408">Re: Batch &quot;macros&quot; with arguments</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting05b5.html?mode=quote&amp;f=3&amp;p=7408" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicf9ee.html?p=7408#p7408" onclick="prompt('Message #26',this.href); return false;">#26</a></span> 
									<a class="unread" href="viewtopicf9ee.html?p=7408#p7408" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>21 May 2011 17:52
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>Ed Dyreen wrote:</cite>I have done some progressing myself too, if it is of any interest to you, I have fallen back to an old habit delayed expansion.  I like your way of building the macro's. Can it work for my macros too or ? Is that not possible ?<br /></div></blockquote><br />I'm not sure how to interpret your question. I am almost sure that there is no way to delay expansion of a macro within a macro until run time. It must be expanded during the definition phase. Even if it were possible to delay, I see no benefit to it.<br /><br />In the examples I've seen you post you had delayed expansion enabled during the definition of the macro. Theoretically you should be able to embed a macro within a macro under these conditions with the correct escape sequences, but I wish you luck in maintaining such a code base. I know I never want to attempt that.<br /><br />I strongly recommend that macros be defined with delayed expansion disabled, and embedded macros be expanded with the derefMacro function in a 2nd definition phase. I see no reason why this should not work for you. BTW, I'm not very happy with the name of derefMacro, and am open to suggestions.<br /><br />I think we agree that all but the simplest macros will require delayed expansion at run time. My macros have SETLOCAL ENABLEDELAYEDEXPANSION within their definition - I do it because I want my macros to have their own local environment. But this is not necessary. You could opt to not enable delayed expansion within the body of the macro if you do something like the following:<br /><br />pseudo-code<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>:: delayed expansion should be disabled at this point, either explicitly, or implicitly<br />:: Define the macros<br /><br />:: phase 1<br />set macro=....<br />:: phase 2<br />call drefMacro macro<br /><br />:: End of macro definitions<br /><br />setlocal enableDelayedExpansion<br />:: you can now call your macros that require delayed expansion<br /></code></pre></div><br />BUT, bear in mind that your macros will now be dependent on delayed expansion being set before the call.<br /><br />----------------<br /><br />I have discovered another use for macros - really just a twist. Up until now macros have had global scope. But they can be very useful when defined within a function.<br /><br />In my original <a href="viewtopic06fa.html?f=3&amp;t=1786&amp;p=7407#p7407" class="postlink">hexDump batch function</a> I had a local auxiliary function called in multiple places within extensive loops. This really slowed the function down. I considered embedding the auxiliary function code within the loops, but was worried about readability and maintenance. I've since updated the function to use a locally defined macro and it provides a HUGE speed improvement.<br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p7409" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile7409">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberliste2cd.html?mode=viewprofile&amp;u=2453" class="username">Ed Dyreen</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search0d5e.html?author_id=2453&amp;sr=posts">1497</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 16 May 2011 08:21</dd>		
		
																<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Flanders(Belgium)</dd>
							
							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact Ed Dyreen">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact Ed Dyreen</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="http://ed-dyreen.ddns.net/" title="Website" class="last-cell">
										<span class="contact-icon phpbb_website-icon">Website</span>
									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content7409">

						<h3 ><a href="#p7409">Re: Batch &quot;macros&quot; with arguments</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting1b3b.html?mode=quote&amp;f=3&amp;p=7409" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicad4a.html?p=7409#p7409" onclick="prompt('Message #27',this.href); return false;">#27</a></span> 
									<a class="unread" href="viewtopicad4a.html?p=7409#p7409" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberliste2cd.html?mode=viewprofile&amp;u=2453" class="username">Ed Dyreen</a></strong> &raquo; </span>21 May 2011 18:14
			</p>
			
			
			
			<div class="content">'<br />You said you had problems with nested macros and 'Dreference' function. that you could dref only twice . When I first define 4 macros and macro1 calls macro2 calls macro3 calls macro4, the code expands to :<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>%forAmacro% ( *** ) do %forAmacro% ( *** ) do %forAmacro% ( *** ) do %forAmacro% ( *** ) do !@Macro!<br /></code></pre></div>Theoritically I can keep doing this forever, that is until the macro is full.<br />Can't you easily do this in disabled delayed expansion  <img class="smilies" src="images/smilies/icon_question.gif" alt=":?:" title="Question" /><br /><br />There is something I still can't do from inside a macro with enabled delayed expansion :<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>set which=%%~a<br />%forAmacro% ( *** ) do call %%@^^^!which^^^!Macro%%<br /></code></pre></div>%someMacro% not a valid command<br /><br />I've tried getting around it with<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>%formacro% ( 'call %%@^^^!which^^^!Macro%%' ) do %%~^^^!&nbsp; &nbsp; &nbsp;or&nbsp; &nbsp; &nbsp;<br />%formacro% ( &quot;%%@^^^!which^^^!Macro%%&quot; ) do echo.%%~^^^!<br /></code></pre></div>I'm afraid it's just not going to happen <img class="smilies" src="images/smilies/icon_neutral.gif" alt=":|" title="Neutral" /><br /><blockquote><div><cite>dbenham wrote:</cite>Given that we can't predict how many layers deep the calls will go, trying to figure out how many times to escape the ^, ! and &lt;LF&gt; characters would be a nightmare!<br /></div></blockquote>It doesn't matter how deep the macro is in enabled expansion .<br />^^^^^^^! to echo !<br />%%~^^^! to use token<br />%%~^! between quotes<br />or do you mean problems when dereferencing ? I don't understand .</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p7410" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile7410">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content7410">

						<h3 ><a href="#p7410">Re: Batch &quot;macros&quot; with arguments</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting4388.html?mode=quote&amp;f=3&amp;p=7410" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopica793.html?p=7410#p7410" onclick="prompt('Message #28',this.href); return false;">#28</a></span> 
									<a class="unread" href="viewtopica793.html?p=7410#p7410" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>21 May 2011 18:54
			</p>
			
			
			
			<div class="content">I don't remember saying I had problems DREFing more than twice. I said I had successfully tested dereferencing macro1 that calls macro2 that calls macro3. The derefMacro function is designed to handle any number of deref operations, I just haven't tested past 2. (one call loops through and dereferences as much as necessary)<br /><br />I tried that CALL macro syntax as well, and many others, all without success - hence my original macro calling macro question in the 1st post. Yes, the ${macro} / drefMacro combination is designed to resolve the issue.<br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p7456" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile7456">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist7125.html?mode=viewprofile&amp;u=417" class="username">jeb</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search73f1.html?author_id=417&amp;sr=posts">880</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 30 Aug 2007 08:05</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany, Bochum</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content7456">

						<h3 ><a href="#p7456">Re: Batch &quot;macros&quot; with arguments</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinga959-2.html?mode=quote&amp;f=3&amp;p=7456" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic6f96.html?p=7456#p7456" onclick="prompt('Message #29',this.href); return false;">#29</a></span> 
									<a class="unread" href="viewtopic6f96.html?p=7456#p7456" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist7125.html?mode=viewprofile&amp;u=417" class="username">jeb</a></strong> &raquo; </span>23 May 2011 13:35
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>Ed Dyreen wrote:</cite>Some screens contain a lot of characters &amp;the macros can only contain 4096 of them. I've read somewhere it's the maximum for any </div></blockquote><br /><br />The &quot;normal&quot; maximum line length is ~8192, the maximum line length for drag&amp;drop operations is ~2048.<br /><br />And even the 8192 can be exceeded with an FOR /F loop.<br /><br />jeb</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p8422" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile8422">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberliste2cd.html?mode=viewprofile&amp;u=2453" class="username">Ed Dyreen</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search0d5e.html?author_id=2453&amp;sr=posts">1497</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 16 May 2011 08:21</dd>		
		
																<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Flanders(Belgium)</dd>
							
							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact Ed Dyreen">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact Ed Dyreen</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="http://ed-dyreen.ddns.net/" title="Website" class="last-cell">
										<span class="contact-icon phpbb_website-icon">Website</span>
									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content8422">

						<h3 ><a href="#p8422">Re: Batch &quot;macros&quot; with arguments</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting2994.html?mode=quote&amp;f=3&amp;p=8422" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopica5c5.html?p=8422#p8422" onclick="prompt('Message #30',this.href); return false;">#30</a></span> 
									<a class="unread" href="viewtopica5c5.html?p=8422#p8422" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberliste2cd.html?mode=viewprofile&amp;u=2453" class="username">Ed Dyreen</a></strong> &raquo; </span>10 Jun 2011 16:34
			</p>
			
			
			
			<div class="content">'<br />@for_entire_line works with the %%r token but I can't make it work with %%!<br /><br />I know it has to do with the escapes that are changing behavior due to the !.<br />But I still can't solve it <img class="smilies" src="images/smilies/icon_sad.gif" alt=":(" title="Sad" /> <br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>set $LF=^<br /><br /><br />:: Two empty lines are neccessary<br /><br />set @MForEntireLine=for /f ^^^^^^^&quot;eol^^^^=^^^^^^^%$LF%%$LF%^%$LF%%$LF%^^^%$LF%%$LF%^%$LF%%$LF%^^^^ delims^^^^=^^^^^^^&quot;<br /><br />set @MacroForEntireLine=%@MForEntireLine% %%^^^! in ( &quot;;Please &lt;&lt;preserve this line&gt;&gt;&quot; ) do echo %%^^^!<br /><br />SetLocal EnableDelayedExpansion<br /><br />%@MacroForEntireLine%<br /></code></pre></div></div>

			
													<div class="notice">
					Last edited by <a href="memberliste2cd.html?mode=viewprofile&amp;u=2453" class="username">Ed Dyreen</a> on 15 Jun 2011 22:45, edited 1 time in total.
									</div>
			
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
	

	<div class="action-bar bar-bottom">
	
			<a href="posting762c.html?mode=reply&amp;f=3&amp;t=1827" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopicbd51.html?f=3&amp;t=1827&amp;start=15&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

			<form method="post" action="https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=1827&amp;start=15">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			74 posts
							<ul>
			<li class="arrow previous"><a class="button button-icon-only" href="viewtopicbcaf.html?f=3&amp;t=1827" rel="prev" role="button"><i class="icon fa-chevron-left fa-fw" aria-hidden="true"></i><span class="sr-only">Previous</span></a></li>
				<li><a class="button" href="viewtopicbcaf.html?f=3&amp;t=1827" role="button">1</a></li>
			<li class="active"><span>2</span></li>
				<li><a class="button" href="viewtopic88ac.html?f=3&amp;t=1827&amp;start=30" role="button">3</a></li>
				<li><a class="button" href="viewtopica337.html?f=3&amp;t=1827&amp;start=45" role="button">4</a></li>
				<li><a class="button" href="viewtopicd76f.html?f=3&amp;t=1827&amp;start=60" role="button">5</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopic88ac.html?f=3&amp;t=1827&amp;start=30" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="viewforum4d6b.html?f=3" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to “DOS Batch Forum”</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="viewforum31e6.html?f=4" class="jumpbox-cat-link"> <span> DosTips - Dos Batch</span></a></li>
																<li><a href="viewforum4d6b.html?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; DOS Batch Forum</span></a></li>
											</ul>
		</div>
	</div>

	</div>


			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
							<span class="crumb"><a href="../index.html" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>DosTips.com</span></a></span>									<span class="crumb"><a href="index.html" data-navbar-reference="index"><span>Board index</span></a></span>					</li>
		
				<li class="rightside">All times are <span title="UTC-6">UTC-06:00</span></li>
							<li class="rightside">
				<a href="ucp033a.html?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete all board cookies</span>
				</a>
			</li>
												<li class="rightside" data-last-responsive="true">
				<a href="memberlist4bfd.html?mode=team" role="menuitem">
					<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
				</a>
			</li>
									<li class="rightside" data-last-responsive="true">
				<a href="memberlist8733.html?mode=contactadmin" role="menuitem">
					<i class="icon fa-envelope fa-fw" aria-hidden="true"></i><span>Contact us</span>
				</a>
			</li>
			</ul>

	</div>
</div>

	<div class="copyright">
				<!-- WARNING NO DELETE -->Style developer by <a href="http://tricolor.x-tk.ru/">support forum tricolor</a>, <!-- END WARNING NO DELETE -->Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
									</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	<img src="cron5089.gif?cron_type=cron.task.text_reparser.post_text" width="1" height="1" alt="cron" /></div>

<script type="text/javascript" src="assets/javascript/jquery.mind772.js?assets_version=34"></script>
<script type="text/javascript" src="assets/javascript/cored772.js?assets_version=34"></script>



<script type="text/javascript" src="styles/prosilver/template/forum_fnd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/prosilver/template/ajaxd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/jquery-uid772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/collapsed772.js?assets_version=34"></script>



</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=1827&start=15 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 08:34:15 GMT -->
</html>
