<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=1827&start=30 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 08:34:15 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>Batch &quot;macros&quot; with arguments - Page 3 - DosTips.com</title>


	<link rel="canonical" href="viewtopic1dfa.html?t=1827&amp;start=30">

<!--
	phpBB style name: Allan Style - SUBSILVER
	Based on style:   prosilver (this is the default phpBB3 style)
	Based on style:   subsilver2 (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:  Allan ( http://x-tk.ru/ )
-->

<link href="assets/css/font-awesome.mind772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/stylesheetd772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/en/stylesheetd772.css?assets_version=34" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="./styles/AllanStyle-SUBSILVER/theme/tweaks.css?assets_version=34" rel="stylesheet">
<![endif]-->




<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','../../www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-280191-1', 'auto');
	ga('send', 'pageview');
</script>

</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">

<div id="header-subsilver">
	<a id="top" class="top-anchor" accesskey="t"></a>
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description" class="site-description">
				<a id="logo" class="logo" href="../index.html" title="DosTips.com"><span class="site_logo"></span></a>
				<h1>DosTips.com</h1>
				<p>A Forum all about DOS Batch</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

									<div id="search-box" class="search-box search-header" role="search">
				<form action="https://www.dostips.com/forum/search.php" method="get" id="search">
				<fieldset>
					<input name="keywords" id="keywords" type="search" maxlength="128" title="Search for keywords" class="inputbox search tiny" size="20" value="" placeholder="Search…" />
					<button class="button button-search" type="submit" title="Search">
						<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
					</button>
					<a href="search.html" class="button button-search-end" title="Advanced search">
						<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
					</a>
					
				</fieldset>
				</form>
			</div>
						
			</div>
					</div>
</div>


<div id="wrap" class="wrap">
	<div id="page-header">
				<div class="navbar-top" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
																									<li>
								<a href="search33a7.html?search_id=unanswered" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="search526f.html?search_id=active_topics" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-blue" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="search.html" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
											<li class="separator"></li>
																			<li>
								<a href="memberlist4bfd.html?mode=team" role="menuitem">
									<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
								</a>
							</li>
																<li class="separator"></li>

									</ul>
			</div>
		</li>

				<li data-skip-responsive="true">
			<a href="app.php/help/faq.html" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
						
			<li class="rightside"  data-skip-responsive="true">
			<a href="ucp26c3.html?mode=login" title="Login" accesskey="x" role="menuitem">
				<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Login</span>
			</a>
		</li>
					<li class="rightside" data-skip-responsive="true">
				<a href="ucp8319.html?mode=register" role="menuitem">
					<i class="icon fa-pencil-square-o  fa-fw" aria-hidden="true"></i><span>Register</span>
				</a>
			</li>
						</ul>

	</div>
</div>

<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
						<li class="breadcrumbs">
							<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="../index.html" itemprop="url" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span itemprop="title">DosTips.com</span></a></span>
										<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="index.html" itemprop="url" accesskey="h" data-navbar-reference="index"><span itemprop="title">Board index</span></a></span>

											<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="4"><a href="viewforum31e6.html?f=4" itemprop="url"><span itemprop="title">DosTips - Dos Batch</span></a></span>
															<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="3"><a href="viewforum4d6b.html?f=3" itemprop="url"><span itemprop="title">DOS Batch Forum</span></a></span>
												</li>
		
					<li class="rightside responsive-search">
				<a href="search.html" title="View the advanced search options" role="menuitem">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</a>
			</li>
			</ul>

	</div>
</div>

<div class="navbar-top-link">
	<div class="inner">
		<ul>
			<li class="navbar-top-link-left"><a href="search33a7.html?search_id=unanswered">Unanswered topics</a></li>
			<li class="navbar-top-link-left"><a href="search526f.html?search_id=active_topics">Active topics</a></li>

											</ul>
	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
		
<h2 class="topic-title"><a href="viewtopic88ac.html?f=3&amp;t=1827&amp;start=30">Batch &quot;macros&quot; with arguments</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">Discussion forum for all Windows batch related topics.<br /></div>
<p>
	<strong>Moderator:</strong> <a href="memberlista6a8.html?mode=viewprofile&amp;u=5" class="username">DosItHelp</a>
</p>


<div class="action-bar bar-top">
	
			<a href="posting762c.html?mode=reply&amp;f=3&amp;t=1827" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic6efe.html?f=3&amp;t=1827&amp;start=30&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="https://www.dostips.com/forum/search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topic…" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="search.html" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="1827" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			74 posts
							<ul>
			<li class="arrow previous"><a class="button button-icon-only" href="viewtopic39d3.html?f=3&amp;t=1827&amp;start=15" rel="prev" role="button"><i class="icon fa-chevron-left fa-fw" aria-hidden="true"></i><span class="sr-only">Previous</span></a></li>
				<li><a class="button" href="viewtopicbcaf.html?f=3&amp;t=1827" role="button">1</a></li>
				<li><a class="button" href="viewtopic39d3.html?f=3&amp;t=1827&amp;start=15" role="button">2</a></li>
			<li class="active"><span>3</span></li>
				<li><a class="button" href="viewtopica337.html?f=3&amp;t=1827&amp;start=45" role="button">4</a></li>
				<li><a class="button" href="viewtopicd76f.html?f=3&amp;t=1827&amp;start=60" role="button">5</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopica337.html?f=3&amp;t=1827&amp;start=45" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
		</div>




<div id="subsilver-nav-topic">
	<div class="inner"><div class="post has-profile">
		<div class="leftsided postbody subsilver-topic-title">Message</div>
		<div class="leftsided postprofile subsilver-topic-author">Author</div>
	</div></div>
</div>

			<div id="p8423" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile8423">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content8423">

						<h3 class="first"><a href="#p8423">Re: Batch &quot;macros&quot; with arguments</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting166a.html?mode=quote&amp;f=3&amp;p=8423" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic3ffe.html?p=8423#p8423" onclick="prompt('Message #31',this.href); return false;">#31</a></span> 
									<a class="unread" href="viewtopic3ffe.html?p=8423#p8423" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>10 Jun 2011 18:33
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>Ed Dyreen wrote:</cite>@for_entire_line works with the %%r token but I can't make it work with %%!<br /><br />I know it has to do with the escapes that are changing behavior due to the !.<br />But I still can't solve it <img class="smilies" src="images/smilies/icon_sad.gif" alt=":(" title="Sad" /> <br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>set $LF=^<br /><br /><br />:: Two empty lines are neccessary<br /><br />set @MForEntireLine=for /f ^^^^^^^&quot;eol^^^^=^^^^^^^%$LF%%$LF%^%$LF%%$LF%^^^%$LF%%$LF%^%$LF%%$LF%^^^^ delims^^^^=^^^^^^^&quot;<br /><br />set @MacroForEntireLine=%@MForEntireLine% %%^^^! in ( &quot;;Please &lt;&lt;preserve this line&gt;&gt;&quot; ) do echo %%^^^!<br /><br />SetLocal EnableDelayedExpansion<br /><br />%@MacroForEntireLine%<br /></code></pre></div></div></blockquote><br />You lost me Ed. I'm not seeing a problem. Here is the output from your code above on my machine:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&gt;set $LF=<br /><br /><br />&gt;set @MForEntireLine=for /f ^^^&quot;eol^^=^^^<br /><br />^<br /><br />^^ delims^^=^^^&quot;<br /><br />&gt;set @MacroForEntireLine=for /f ^&quot;eol^=^<br /><br />^ delims^=^&quot; %^! in ( &quot;;Please &lt;&lt;preserve this line&gt;&gt;&quot; ) do echo %^!<br /><br />&gt;SetLocal EnableDelayedExpansion<br /><br />&gt;for /F &quot;eol=<br />&nbsp;delims=&quot; %! in (&quot;;Please &lt;&lt;preserve this line&gt;&gt;&quot;) do echo %!<br /><br />&gt;echo ;Please &lt;&lt;preserve this line&gt;&gt;<br />;Please &lt;&lt;preserve this line&gt;&gt;</code></pre></div><br /><br />It also works without escaping the %%!:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code><br />set $LF=^<br /><br /><br />:: Two empty lines are neccessary<br /><br />set @MForEntireLine=for /f ^^^^^^^&quot;eol^^^^=^^^^^^^%$LF%%$LF%^%$LF%%$LF%^^^%$LF%%$LF%^%$LF%%$LF%^^^^ delims^^^^=^^^^^^^&quot;<br /><br />set @MacroForEntireLine=%@MForEntireLine% %%! in ( &quot;;Please &lt;&lt;preserve this line&gt;&gt;&quot; ) do echo %%!<br /><br />SetLocal EnableDelayedExpansion<br /><br />%@MacroForEntireLine%<br /></code></pre></div><br /><br />Results:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&gt;set $LF=<br /><br /><br />&gt;set @MForEntireLine=for /f ^^^&quot;eol^^=^^^<br /><br />^<br /><br />^^ delims^^=^^^&quot;<br /><br />&gt;set @MacroForEntireLine=for /f ^&quot;eol^=^<br /><br />^ delims^=^&quot; %! in ( &quot;;Please &lt;&lt;preserve this line&gt;&gt;&quot; ) do echo %!<br /><br />&gt;SetLocal EnableDelayedExpansion<br /><br />&gt;for /F &quot;eol=<br />&nbsp;delims=&quot; %! in (&quot;;Please &lt;&lt;preserve this line&gt;&gt;&quot;) do echo %!<br /><br />&gt;echo ;Please &lt;&lt;preserve this line&gt;&gt;<br />;Please &lt;&lt;preserve this line&gt;&gt;<br /></code></pre></div><br />Dave</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p8439" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile8439">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberliste2cd.html?mode=viewprofile&amp;u=2453" class="username">Ed Dyreen</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search0d5e.html?author_id=2453&amp;sr=posts">1497</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 16 May 2011 08:21</dd>		
		
																<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Flanders(Belgium)</dd>
							
							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact Ed Dyreen">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact Ed Dyreen</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="http://ed-dyreen.ddns.net/" title="Website" class="last-cell">
										<span class="contact-icon phpbb_website-icon">Website</span>
									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content8439">

						<h3 ><a href="#p8439">Re: Batch &quot;macros&quot; with arguments</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting7e09.html?mode=quote&amp;f=3&amp;p=8439" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicc3f8.html?p=8439#p8439" onclick="prompt('Message #32',this.href); return false;">#32</a></span> 
									<a class="unread" href="viewtopicc3f8.html?p=8439#p8439" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberliste2cd.html?mode=viewprofile&amp;u=2453" class="username">Ed Dyreen</a></strong> &raquo; </span>11 Jun 2011 08:10
			</p>
			
			
			
			<div class="content">'<br />I probably made a syntax error, yet posted an example without this error <img class="smilies" src="images/smilies/icon_redface.gif" alt=":oops:" title="Embarassed" /></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p8697" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile8697">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content8697">

						<h3 ><a href="#p8697">Batch &quot;macros&quot; with arguments - Major Update</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting2f54.html?mode=quote&amp;f=3&amp;p=8697" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicfd2b.html?p=8697#p8697" onclick="prompt('Message #33',this.href); return false;">#33</a></span> 
									<a class="unread" href="viewtopicfd2b.html?p=8697#p8697" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>23 Jun 2011 16:47
			</p>
			
			
			
			<div class="content">OK, I've finally got a significant update to this project.<br />Sorry this is so long, but there is a lot to cover.<br /><br /><span style="text-decoration: underline"><strong class="text-strong">1) New Developments</strong></span><br /><br /><strong class="text-strong">New strategy for &quot;calling&quot; a macro within a macro:</strong>I have abandoned the <strong class="text-strong">${calledMacroName}</strong> syntax and the relatively slow <strong class="text-strong">drefMacro</strong> function. I am now using delayed expansion to very quickly include a macro within a macro at definition time. I now realize it is not so difficult to escape ! and ^ as needed. (Ed - Sorry I was so pig headed before. I think you have been on the right path in this regard all along).  My concern about having the macro definition persist after the batch file terminates is handled by the next developement.<br /><br /><strong class="text-strong">New macros to return any string across the ENDLOCAL border:</strong> See the <em class="text-italics">macroLib_Return.bat</em> file later in this post. These macros are useful for both macro and function development. They not only allow macros to return any value across the ENDLOCAL border, they also allow us to preserve the macro definitions themselves across the ENDLOCAL border!<br /><br />For examples on how to use this library for function development, see <a href="viewtopicca19-2.html?f=3&amp;t=1910&amp;start=0" class="postlink">New Function Template - return ANY string safely and easily</a>. Note - the macros have changed some since my original post there.<br /><br />For examples on how to use this library for macro development, see in this post:<ul><li><em class="text-italics">macroLib_Strings.bat</em> : macro.ToUpper and macro.AnyToUpper for examples of using macro.Rtn1 and macro.AnyRtn1</li><li><em class="text-italics">macroLib_Swap.bat</em> : macro.Swap and macro.AnySwap for examples of using macro.RtnN and macro.AnyRtnN</li></ul><br /><strong class="text-strong">Modified <em class="text-italics">callMacro.bat</em> -</strong> this &quot;command&quot; allows macros to be called under almost any circumstance at a cost of reduced speed, (but still faster than calling a function with the same functionality). See the code posted later in this post for more information on its usage. The file now includes a call to %macro_EndAnyRtn% to support macros that use either macro.AnyRtn1 or macro.AnyRtnN. It also now has embedded help.<br /><br /><strong class="text-strong">Formalized naming convention and help system:</strong><br /><br /><em class="text-italics">macro.MacroName</em> - Specifies a macro that requires arguments.<br /><br /><em class="text-italics">macro\args.MacroName</em> - Contains calling syntax (argument list) for macro.MacroName<br /><br /><em class="text-italics">macro\help.MacroName</em> - Contains detailed help on usage of macro.MacroName<br /><br /><em class="text-italics">macro_SimpleMacro</em> - Specifies a simple macro that does not require arguments.<br /><br /><em class="text-italics">macro\args_SimpleMacro</em> - Displays as empty but contains a space: Used to inform  user of availability of a simple macro that does not require arguments.<br /><br /><em class="text-italics">macro\help_SimpleMacro</em> - Contains detailed help on usage of a simple macro named macro_SimpleMacro.<br /><br /><em class="text-italics">macro\load.LibraryName</em> - Allways set to 1: Used to indicate that the library has been loaded into memory.<br /><br /><strong class="text-strong">Help commands using DOSKEY macros</strong> - See <em class="text-italics">macroLib_Base.bat</em> for full documentation<br /><em class="text-italics">margs</em> - Convenient access to a list of available macros and their arguments.<br /><em class="text-italics">mhelp</em> - Convenient access to detailed macro usage information.<br /><em class="text-italics">mload</em> - Convenient access to the list of macro libraries that have been loaded.<br /><br /><strong class="text-strong">Adopted use of ECHO( instead of ECHO:</strong><br />- defined <strong class="text-strong">echo=echo(</strong> in macroLib_base.bat.<br />- replaced all instances of <strong class="text-strong">echo:</strong> with <strong class="text-strong">%echo%</strong> in all macro libraries.<br /><br /><br /><span style="text-decoration: underline"><strong class="text-strong">2) General Macro Development Design considerations</strong></span><br /><br /><strong class="text-strong">Need for local argument naming convention when passing multiple variables by reference.</strong>Macros (and functions) typically have local variables that are supposed to have no impact on the caller. But when passing multiple variables by reference we can get in trouble if the variable names passed in happen to match the names of local variables.<br /><br />I have a convention that all reference argument values are read into local variables that are prefixed with the macro name like so:  <strong class="text-strong">macro.Name.LocalVar</strong>. Once all of the argument values have been transferred, the macro is free to define any local variable using any name. This strategy eliminates the risk of name collision problems as long as the caller never passes in a variable that is prefixed with the called macro name.<br /><br /><strong class="text-strong">Macros make heavy use of delayed expansion:</strong> We need the ability to set a value within a macro and then subsequently read the value in the same macro. Since the macro is all within one statement block we cannot use <strong class="text-strong">%var%</strong> notation. We don't want to use <strong class="text-strong">CALL %%var%%</strong> notation because it is slow and a major purpose of defining a macro in the first place is for speed. This means we  almost always reference variables using delayed expansion as <strong class="text-strong">!var!</strong>. This leads to two constructs that are not normally used for function development but are often critical to macro development.<br /><br /><em class="text-italics">Parametized substring (or parametized search and replace):</em><br />- in a function we use <strong class="text-strong">SET variable=!variable:~%start%,%length%!</strong><br />- in a macro we use <strong class="text-strong">FOR /F &quot;tokens=1,2&quot; %%A IN (&quot;!start! !length!&quot;) DO set variable=!variable:~%%A,%%B!</strong><br /><br /><em class="text-italics">Passing Numbers and simple strings across the ENDLOCAL border:</em><br />- in a function we use <strong class="text-strong">(ENDLOCAL &amp; SET &quot;var=%val%&quot;)</strong><br />- in a macro we use <strong class="text-strong">FOR /F %macro_ForEntireLine% %%v (&quot;!val!&quot;) DO (ENDLOCAL &amp; SET &quot;var=%%v&quot;)</strong><br /><br /><br /><span style="text-decoration: underline"><strong class="text-strong">3) Open Issues</strong></span><br /><br /><strong class="text-strong">Dealing with multiple optional arguments</strong> - In functions we can shift varying numbers of leading option arguments so that required arguments are always in standard positions after options have been processed. We don't have any correlary to the SHIFT command for macro options.<br /><br /> <img class="smilies" src="images/smilies/icon_idea.gif" alt=":idea:" title="Idea" /> I am toying with the idea of treating the macro as an object and storing options as macro attributes - a limited adoption of what Ed Dyreen has been doing. The options would be set prior to the call using syntax like <strong class="text-strong">SET macro.MacroName.OptionName=value</strong>. The options could possibly reset automatically to default values upon macro completion.<br /><br /><strong class="text-strong">Passing string literals as arguments</strong> - There is no simple way to quote or escape argument delimiters so that they may be included in an argument value. We can define different macro_Call variants that use different delimiters, but there is not a generic solution that can receive any combination of characters. For this reason all my macros have been restricted to passing unconstrained string values by reference.<br /><br /><img class="smilies" src="images/smilies/icon_idea.gif" alt=":idea:" title="Idea" /> We could use the object attribute strategy here as well, but I don't really like it. I have a vague idea to pass all arguments as one string and then process the arguments with a dedicated &quot;load arguments&quot; macro. This macro would use a simple FOR loop to parse the arguments, but it would need special code to preserve * and ? characters. I'm not sure when (or if) I will get around to testing this.<br /><br /><br /><span style="text-decoration: underline"><strong class="text-strong">4) The Code</strong></span> <img class="smilies" src="images/smilies/icon_exclaim.gif" alt=":!:" title="Exclamation" /> (finally <img class="smilies" src="images/smilies/icon_rolleyes.gif" alt=":roll:" title="Rolling Eyes" />)<br /><br />I've broken up the code into multiple libraries based on functionality:<br /><em class="text-italics">macroLib_Base.bat</em> - basic definitions needed by every library, plus new help macros<br /><em class="text-italics">macroLib_Return.bat</em> - new macros for returning values across ENDLOCAL barrier<br /><em class="text-italics">macroLib_String.bat</em> - macros for basic string operations, including new macros to demo macro.Rtn1 and macro.AnyRtn1<br /><em class="text-italics">macroLib_Swap.bat</em> - new macros of limited functionality to demo usage of macro.RtnN and macro.AnyRtnN<br /><em class="text-italics">macroLib_Num.bat</em> - macros dealing with numbers (Random and Num2Hex)<br /><em class="text-italics">macroLib_Time.bat</em> - macros for dealing with time, useful for timing code<br /><em class="text-italics">callMacro.bat</em> - command used to call macros when %macro_call% cannot be used<br /><br /><strong class="text-strong">macroLib_Base.bat</strong><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />:: File = macroLib_Base.bat<br />:: Dependencies: &lt;none&gt;<br />:: This batch file will fail if called while delayed expansion is enabled.<br />::<br />:: This library defines basic macros and variables that are used by all other<br />:: macro libraries.<br />::<br />:: The following DOSKEY macros are installed to provide help on all currently<br />:: loaded macro libraries. These DOSKEY macros are only available from the<br />:: command line. They cannot be used within a batch file.<br />::<br />::&nbsp; &nbsp;margs &#91;MacroNameFilter&#93;<br />::<br />::&nbsp; &nbsp; &nbsp;List all macros along with their arguments.<br />::<br />::&nbsp; &nbsp; &nbsp;If the MacroNameFilter is specified then only list macros whose name<br />::&nbsp; &nbsp; &nbsp;begins with macro.MacroNameFilter or macro_MacroNameFilter.<br />::<br />::&nbsp; &nbsp;mhelp &#91;MacroNameFilter&#93;<br />::<br />::&nbsp; &nbsp; &nbsp;Display help for all macros.<br />::<br />::&nbsp; &nbsp; &nbsp;If the MacroNameFilter is specified then only display help for macros<br />::&nbsp; &nbsp; &nbsp;whose name begins with macro.MacroNameFilter or macro_MacroNameFilter.<br />::<br />::&nbsp; mload &#91;LibraryNameFilter&#93;<br />::<br />::&nbsp; &nbsp; Displays a list of all macro libraries that are currently loaded.<br />::<br />::&nbsp; &nbsp; If the LibraryNameFilter is specified then only display loaded libraries<br />::&nbsp; &nbsp; whose name begins with LibraryNameFilter.<br />::<br />:: The library is designed to be installed in a directory in your PATH.<br />:: Any batch file that requires it can include it by simply placing the<br />:: following line of code at the top before any SETLOCAL:<br />::<br />::&nbsp; &nbsp;IF NOT DEFINED macro\load.macroLib_Base CALL macroLib_Base<br />::<br />:: In this way the library becomes resident in your command shell environment<br />:: where it is available to any batch file that may need it. The IF condition<br />:: prevents unneccessary reloads of the same library.<br />::<br />::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::<br /><br />::define a Carriage Return string, only useable as !CR!<br />for /f %%a in ('copy /Z &quot;%~dpf0&quot; nul') do set &quot;CR=%%a&quot;<br /><br />::define a Line Feed (newline) string (normally only used as !LF!)<br />set LF=^<br /><br /><br />::Above 2 blank lines are required - do not remove<br /><br />::define a Line Feed string that can be used as %xLF%<br />set ^&quot;xLF=^^^%LF%%LF%^%LF%%LF%&quot;<br /><br />::define a newline with line continuation<br />set ^&quot;\n=^^^%LF%%LF%^%LF%%LF%^^&quot;<br /><br />::define a version of ECHO that supports displaying a blank line<br />set &quot;echo=echo(&quot;<br /><br />set &quot;esc1=^&quot;<br />set &quot;esc2=^^^&quot;<br />set &quot;esc3=^^^^^^^&quot;<br />set &quot;esc4=^^^^^^^^^^^^^^^&quot;<br /><br />set &quot;macro\args_ForEntireLine= &quot;<br />set macro\help_ForEntireLine=%\n%<br />&nbsp; %\n%<br />&nbsp; A simple macro to be used with the FOR /F command to disable the EOL and%\n%<br />&nbsp; DELIMS options, thus enabling preservation of the entire line regardless of%\n%<br />&nbsp; what the leading character is.%\n%<br />&nbsp; %\n%<br />&nbsp; There are two versions of this macro:%\n%<br />&nbsp; %\n%<br />&nbsp; ForEntireLine - For normal use within a batch file or on the command line.%\n%<br />&nbsp; &nbsp; If this macro is included in a macro definition then it must be referenced%\n%<br />&nbsp; &nbsp; as !ForEntireLine! and %%macro_BeginDef%% and %%macro.EndDef%% must be used%\n%<br />&nbsp; &nbsp; before and after the macro definition.%\n%<br />&nbsp; %\n%<br />&nbsp; macro_ForEntireLine - This version is used exclusively within a macro%\n%<br />&nbsp; &nbsp; definition as %%macro_ForEntireLine%% when macro_BeginDef and macro.EndDef%\n%<br />&nbsp; &nbsp; are not needed.%\n%<br />&nbsp; %\n%<br />&nbsp; Sample use from the command line:%\n%<br />&nbsp; %\n%<br />&nbsp; &nbsp; for /f %%ForEntireLine%% %%a in (&quot;;Preserve this entire line&quot;) do @echo %%a%xLF%<br />set macro_ForEntireLine=^^^^^^^&quot;eol^^^^=^^^^^^^%LF%%LF%^%LF%%LF%^^^%LF%%LF%^%LF%%LF%^^^^ delims^^^^=^^^^^^^&quot;<br />set ForEntireLine=%macro_ForEntireLine%<br /><br />set &quot;macro\args_Call= &quot;<br />set macro\help_Call=%\n%<br />&nbsp; %\n%<br />&nbsp; A simple macro used to call macros with arguments from within a batch file.%\n%<br />&nbsp; This is the fastest way to call a macro from within a batch file.%\n%<br />&nbsp; %\n%<br />&nbsp; Usage:%\n%<br />&nbsp; %\n%<br />&nbsp; &nbsp; %%macro_Call%% (&quot;arg1 arg2 arg3...&quot;) %%macro.macroName%%%\n%<br />&nbsp; %\n%<br />&nbsp; To call a macro from the command line use the callMacro.bat command instead.%\n%<br />&nbsp; Note that the macro. prefix is excluded from the macroName when using the%\n%<br />&nbsp; callMacro.bat command.%\n%<br />&nbsp; %\n%<br />&nbsp; &nbsp; callMacro macroName arg1 arg2 arg3...%\n%<br />&nbsp; %\n%<br />&nbsp; The callMacro.bat command can also be used within a batch as follows:%\n%<br />&nbsp; %\n%<br />&nbsp; &nbsp; call callMacro macroName arg1 arg2 arg3...%\n%<br />&nbsp; %\n%<br />&nbsp; There is a small performance penalty when calling a macro this way, but it is%\n%<br />&nbsp; usually still faster than calling a function with the same functionality.%\n%<br />&nbsp; The callMacro.bat command is especially useful within a batch file under any%\n%<br />&nbsp; of the following circumstances:%\n%<br />&nbsp; %\n%<br />&nbsp; &nbsp;- Performance is not overly important and the callMacro command is more%\n%<br />&nbsp; &nbsp; &nbsp;natural than the %%macro_Call%% syntax.%\n%<br />&nbsp; %\n%<br />&nbsp; &nbsp;- The macro must be called within a code block and the code block is%\n%<br />&nbsp; &nbsp; &nbsp;exceeding the ~8K limit.%\n%<br />&nbsp; %\n%<br />&nbsp; &nbsp;- An &quot;Any&quot; macro must be called within a code block. This is possible%\n%<br />&nbsp; &nbsp; &nbsp;because the callMacro.bat command implicitly calls macro_EndAnyRtn%\n%<br />&nbsp; &nbsp; &nbsp;outside of the calling code block.%\n%<br />&nbsp; %\n%<br />&nbsp; &nbsp;- The macro must be called within a macro definition and the macro%\n%<br />&nbsp; &nbsp; &nbsp;definition is exceeding the ~8K limit.%xLF%<br />set macro_Call=for /f &quot;tokens=1-26&quot; %%a in<br /><br /><br />::-----------------------------------------------------<br />:: DEFINE HELP MACROS (true DOSKEY macros)<br /><br />doskey margs=echo off$T%echo%$T2$Gnul set macro\args.$1$T2$Gnul set macro\args_$1$Techo on<br />doskey mhelp=echo off$T%echo%$T2$Gnul set macro\help.$1$T2$Gnul set macro\help_$1$Techo on<br />doskey mload=echo off$T%echo%$Tset macro\load.$1$Techo on<br /><br />::----------------------------------------------------<br />:: Mark that this library has been loaded.<br /><br />set macro\load.%~n0=1<br /></code></pre></div><br /><br /><strong class="text-strong">macroLib_Return.bat</strong><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />:: File = macroLib_Return.bat<br />:: Dependencies: macroLib_Base.bat<br />:: This batch file will fail if called while delayed expansion is enabled.<br />::<br />:: This library defines macros that enable the return of any string value(s)<br />:: across the ENDLOCAL border. These macros are very useful for creating<br />:: other macros and functions. Routines built with these macros are safe to<br />:: call even when delayed expansion is enabled.<br />::<br />:: The library is designed to be installed in a directory in your PATH.<br />:: Any batch file that requires it can include it by simply placing the<br />:: following line of code at the top before any SETLOCAL:<br />::<br />::&nbsp; &nbsp;IF NOT DEFINED macro\load.MacroLib_Return CALL macroLib_Return<br />::<br />:: In this way the library becomes resident in your command shell environment<br />:: where it is available to any batch file that may need it. The IF condition<br />:: prevents unneccessary reloads of the same library.<br />::<br />::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::<br /><br />:: Conditionally load dependencies (normally residing somewhere in the PATH)<br />if not defined macro\load.macroLib_Base call macroLib_Base<br /><br />set &quot;macro\args_InitRtn= &quot;<br />set macro\help_InitRtn=%\n%<br />&nbsp; %\n%<br />&nbsp; A simple macro used at the top of a macro definition to prepare%\n%<br />&nbsp; for a return by any of the Rtn macros.%\n%<br />&nbsp; %\n%<br />&nbsp; See any of the following for more information:%\n%<br />&nbsp; &nbsp; macro.Rtn1%\n%<br />&nbsp; &nbsp; macro.RtnN%\n%<br />&nbsp; &nbsp; macro.AnyRtn1%\n%<br />&nbsp; &nbsp; macro.AnyRtnN%xLF%<br />set macro_InitRtn=setlocal^&amp;set &quot;macro_NotDelayed=!&quot;^&amp;set &quot;macro_inFcn=&quot;<br /><br />set &quot;macro\args_InitFcnRtn= &quot;<br />set macro\help_InitFcnRtn=%\n%<br />&nbsp; %\n%<br />&nbsp; A simple macro used at the top of a function definition to prepare%\n%<br />&nbsp; for a return by any of the Rtn macros.%\n%<br />&nbsp; %\n%<br />&nbsp; See any of the following for more information:%\n%<br />&nbsp; &nbsp; macro.Rtn1%\n%<br />&nbsp; &nbsp; macro.RtnN%\n%<br />&nbsp; &nbsp; macro.AnyRtn1%\n%<br />&nbsp; &nbsp; macro.AnyRtnN%xLF%<br />set macro_InitFcnRtn=setlocal^&amp;set &quot;macro_NotDelayed=!&quot;^&amp;set &quot;macro_inFcn=true&quot;<br /><br />set &quot;macro\args_EndAnyRtn= &quot;<br />set macro\help_EndAnyRtn=%\n%<br />&nbsp; %\n%<br />&nbsp; A temporary simple macro that must immediately follow calls to any%\n%<br />&nbsp; of the following (or any macro that uses the following):%\n%<br />&nbsp; &nbsp; macro.AnyRtn1%\n%<br />&nbsp; &nbsp; macro.AnyRtnN%\n%<br />&nbsp; &nbsp; macro.EndDef%\n%<br />&nbsp; %\n%<br />&nbsp; The macro is not defined until one of the above macros is called,%\n%<br />&nbsp; and macro_EndAnyRtn undefines itself once it is called.%\n%<br />&nbsp; See any of the above macros for more information.%xLF%<br /><br />:: A simple macro for Rtn macro internal use<br />set &quot;macro_EndAnyRtnPrefix=for /f &quot;tokens=1-3&quot; %%1 in (&quot;!replace!&quot;) do for %%4 in (&quot;!LF!&quot;) do &quot;<br /><br />set macro\args.AnyRtn1=&nbsp; ErrLvl&nbsp; EndLocalCnt&nbsp; ValueVar&nbsp; &#91;RtnVar&#93;<br />set macro\help.AnyRtn1=&nbsp; ErrLvl&nbsp; EndLocalCnt&nbsp; ValueVar&nbsp; &#91;RtnVar&#93;%\n%<br />&nbsp; %\n%<br />&nbsp; Returns the contents of variable ValueVar across the ENDLOCAL border at the%\n%<br />&nbsp; end of a function or macro. The number of ENDLOCAL executions is controlled%\n%<br />&nbsp; by the EndLocalCnt which should match the number of times SETLOCAL was used%\n%<br />&nbsp; within the calling function/macro.%\n%<br />&nbsp; %\n%<br />&nbsp; The return value is stored in RtnVar%\n%<br />&nbsp; or the value is echoed if RtnVar is not specified.%\n%<br />&nbsp; The ERRORLEVEL is set to ErrLvl%\n%<br />&nbsp; %\n%<br />&nbsp; Numeric values ErrLvl and EndLocalCnt may be passed using any expression%\n%<br />&nbsp; supported by SET /A.%\n%<br />&nbsp; %\n%<br />&nbsp; This macro can return a string containing any combination of characters%\n%<br />&nbsp; supported by DOS, and the macro works regardless whether the target return%\n%<br />&nbsp; environment has enabled or disabled delayed expansion.%\n%<br />&nbsp; %\n%<br />&nbsp; In order for a function to use AnyRtn1, the calling function must start with%\n%<br />&nbsp; %%macro_InitFcnRtn%% at the top, and %%macro_EndAnyRtn%% must immediately follow%\n%<br />&nbsp; the call to %%macro.AnyRtn1%%.%\n%<br />&nbsp; &nbsp;%\n%<br />&nbsp; &nbsp; :func inputVar &#91;RtnVar&#93;%\n%<br />&nbsp; &nbsp; &nbsp; %%macro_InitFcnRtn%%%\n%<br />&nbsp; &nbsp; &nbsp; setlocal%\n%<br />&nbsp; &nbsp; &nbsp; {do whatever you need to do}%\n%<br />&nbsp; &nbsp; &nbsp; set rtnValue={your return value}%\n%<br />&nbsp; &nbsp; &nbsp; %%macro_Call%% (&quot;errorlevel 1 rtnValue %%~2&quot;) %%macro.AnyRtn1%%%\n%<br />&nbsp; &nbsp; &nbsp; %%macro_EndAnyRtn%%%\n%<br />&nbsp; &nbsp; exit /b%\n%<br />&nbsp; %\n%<br />&nbsp; In order for a macro to use AnyRtn1, the calling macro must start with%\n%<br />&nbsp; %%macro_InitRtn%% at the top. In the macro template below, assume the %%%%c%\n%<br />&nbsp; argument holds the name of the variable to receive the result.%\n%<br />&nbsp; %\n%<br />&nbsp; &nbsp; set macro.Name= do(%%\n%%%\n%<br />&nbsp; &nbsp; &nbsp; !macro_InitRtn!%%\n%%%\n%<br />&nbsp; &nbsp; &nbsp; setlocal%%\n%%%\n%<br />&nbsp; &nbsp; &nbsp; {do whatever you need to do}%\n%<br />&nbsp; &nbsp; &nbsp; set rtnValue={your return value}%%\n%%%\n%<br />&nbsp; &nbsp; &nbsp; !macro_Call! (&quot;errorlevel 1 rtnValue %%%%~c&quot;) !macro.AnyRtn1!%%\n%%%\n%<br />&nbsp; &nbsp; )%\n%<br />&nbsp; %\n%<br />&nbsp; Since this is a case of a macro &quot;calling&quot; a macro, the macro definition must%\n%<br />&nbsp; be preceded by %%macro_BeginDef%% and followed by a call to %%macro.EndDef%%%\n%<br />&nbsp; and %%macro_EndAnyRtn%%. See macro.EndDef for more information.%\n%<br />&nbsp; &nbsp;%\n%<br />&nbsp; Any call to a macro that uses AnyRtn1 must be followed by %%macro_EndAnyRtn%%.%\n%<br />&nbsp; The macro call and %%macro_EndAnyRtn%% must not share a common statement block.%\n%<br />&nbsp; This limitation can be overcome by calling the macro through the callMacro%\n%<br />&nbsp; function which implicitly calls %%macro_EndAnyRtn%%%xLF%<br />set macro.AnyRtn1=do (%\n%<br />&nbsp; setlocal enableDelayedExpansion%\n%<br />&nbsp; set /a &quot;macro.AnyRtn1.ErrLvl=(%%~a), macro.AnyRtn1.EndLocalCnt=(%%~b)&quot;%\n%<br />&nbsp; set &quot;rtn=!%%~c!&quot;%\n%<br />&nbsp; set ^&quot;replace=%% ^&quot;^&quot;^&quot; !CR!!CR!^&quot;%\n%<br />&nbsp; set &quot;macro_EndAnyRtn=!macro_EndAnyRtnPrefix!endlocal&amp;endlocal&quot;%\n%<br />&nbsp; for /l %%N in (1,1,!macro.AnyRtn1.EndLocalCnt!) do set &quot;macro_EndAnyRtn=!macro_EndAnyRtn!&amp;endlocal&quot;%\n%<br />&nbsp; if &quot;%%~d&quot; equ &quot;&quot; (%echo%!rtn!) else (%\n%<br />&nbsp; &nbsp; if defined rtn (%\n%<br />&nbsp; &nbsp; &nbsp; set &quot;rtn=!rtn:%%=%%~1!&quot;%\n%<br />&nbsp; &nbsp; &nbsp; set ^&quot;rtn=!rtn:^&quot;=%%~2!^&quot;%\n%<br />&nbsp; &nbsp; &nbsp; if defined CR for %%A in (&quot;!CR!&quot;) do set &quot;rtn=!rtn:%%~A=%%~3!&quot;%\n%<br />&nbsp; &nbsp; &nbsp; for %%A in (&quot;!LF!&quot;) do set &quot;rtn=!rtn:%%~A=%%~4!&quot;%\n%<br />&nbsp; &nbsp; &nbsp; if not defined macro_NotDelayed (%\n%<br />&nbsp; &nbsp; &nbsp; &nbsp; set &quot;rtn=!rtn:^=^^!&quot;%\n%<br />&nbsp; &nbsp; &nbsp; &nbsp; call set &quot;rtn=%%^rtn:^!=&quot;&quot;^!%%&quot; ! %\n%<br />&nbsp; &nbsp; &nbsp; &nbsp; set &quot;rtn=!rtn:&quot;&quot;=^!&quot;%\n%<br />&nbsp; &nbsp; &nbsp; )%\n%<br />&nbsp; &nbsp; )%\n%<br />&nbsp; &nbsp; set &quot;macro_EndAnyRtn=!macro_EndAnyRtn!&amp;set &quot;%%~d=!rtn!&quot; ^!&quot;%\n%<br />&nbsp; )%\n%<br />&nbsp; if defined macro_inFcn (%\n%<br />&nbsp; &nbsp; &nbsp; set &quot;macro_EndAnyRtn=!macro_EndAnyRtn!&amp;exit /b !macro.AnyRtn1.ErrLvl!&quot;%\n%<br />&nbsp; ) else if &quot;!macro.AnyRtn1.ErrLvl!&quot; == &quot;1&quot; (%\n%<br />&nbsp; &nbsp; &nbsp; set &quot;macro_EndAnyRtn=!macro_EndAnyRtn!&amp;(2&gt;nul set =)&quot;%\n%<br />&nbsp; ) else if &quot;!macro.AnyRtn1.ErrLvl!&quot; neq &quot;0&quot; (%\n%<br />&nbsp; &nbsp; &nbsp; set &quot;macro_EndAnyRtn=!macro_EndAnyRtn!&amp;cmd /d /c exit !macro.AnyRtn1.ErrLvl!&quot;%\n%<br />&nbsp; )%\n%<br />)<br /><br />set macro\args.AnyRtnN=&nbsp; ErrLvl&nbsp; EndLocalCnt&nbsp; ValVar1:RtnVar1&#91;,ValVar2:RtnVar2&#93;...<br />set macro\help.AnyRtnN=&nbsp; ErrLvl&nbsp; EndLocalCnt&nbsp; ValVar1:RtnVar1&#91;,ValVar2:RtnVar2&#93;...%\n%<br />&nbsp; %\n%<br />&nbsp; Returns the contents of multiple variables across the ENDLOCAL border at%\n%<br />&nbsp; the end of a function or macro. The number of ENDLOCAL executions is%\n%<br />&nbsp; controlled by the EndLocalCnt which should match the number of times%\n%<br />&nbsp; SETLOCAL was used within the calling function/macro. The errorlevel is%\n%<br />&nbsp; set to ErrLvl.%\n%<br />&nbsp; %\n%<br />&nbsp; A pair of variable names must be specified for each output value - the%\n%<br />&nbsp; name of the variable containing the value followed by a colon followed%\n%<br />&nbsp; by the name of the variable that is to receive the value. Multiple pairs%\n%<br />&nbsp; are delimited by commas. The list of outputs cannot contain any spaces,%\n%<br />&nbsp; and the variable names cannot contain asterisk ^(*^), question mark ^(?^),%\n%<br />&nbsp; colon ^(:^) or comma ^(,^).%\n%<br />&nbsp; %\n%<br />&nbsp; Numeric values ErrLvl and EndLocalCnt may be passed using any expression%\n%<br />&nbsp; supported by SET /A.%\n%<br />&nbsp; %\n%<br />&nbsp; This macro can return strings containing any combination of characters%\n%<br />&nbsp; supported by DOS, and the macro works regardless whether the target return%\n%<br />&nbsp; environment has enabled or disabled delayed expansion.%\n%<br />&nbsp; %\n%<br />&nbsp; In order for a function to use AnyRtnN, the calling function must start with%\n%<br />&nbsp; %%macro_InitFcnRtn%% at the top, and %%macro_EndAnyRtn%% must immediately follow%\n%<br />&nbsp; the call to %%macro.AnyRtn1%%.%\n%<br />&nbsp; &nbsp;%\n%<br />&nbsp; &nbsp; :func inputVar RtnVar1 RtnVar2%\n%<br />&nbsp; &nbsp; &nbsp; %%macro_InitFcnRtn%%%\n%<br />&nbsp; &nbsp; &nbsp; setlocal%\n%<br />&nbsp; &nbsp; &nbsp; {do whatever you need to do}%\n%<br />&nbsp; &nbsp; &nbsp; set rtnVal1={your first return value}%\n%<br />&nbsp; &nbsp; &nbsp; set rtnVal2={your second return value}%\n%<br />&nbsp; &nbsp; &nbsp; %%macro_Call%% (&quot;errorlevel 1 rtnVal1:%%~2,rtnVal2:%%~3&quot;) %%macro.AnyRtnN%%%\n%<br />&nbsp; &nbsp; &nbsp; %%macro_EndAnyRtn%%%\n%<br />&nbsp; &nbsp; exit /b%\n%<br />&nbsp; &nbsp;%\n%<br />&nbsp; In order for a macro to use AnyRtnN, the calling macro must start with%\n%<br />&nbsp; %%macro_InitRtn%% at the top. In the macro template below, assume the %%%%c%\n%<br />&nbsp; and %%%%~d arguments hold the name of the variables to receive the results.%\n%<br />&nbsp; %\n%<br />&nbsp; &nbsp; set macro.Name= do(%%\n%%%\n%<br />&nbsp; &nbsp; &nbsp; !macro_InitRtn!%%\n%%%\n%<br />&nbsp; &nbsp; &nbsp; setlocal%%\n%%%\n%<br />&nbsp; &nbsp; &nbsp; {do whatever you need to do}%\n%<br />&nbsp; &nbsp; &nbsp; set rtnVal1={your first return value}%%\n%%%\n%<br />&nbsp; &nbsp; &nbsp; set rtnVal2={your second return value}%%\n%%%\n%<br />&nbsp; &nbsp; &nbsp; !macro_Call! (&quot;errorlevel 1 rtnVal1:%%%%~c,rtnVal2:%%%%~d&quot;) !macro.AnyRtnN!%%\n%%%\n%<br />&nbsp; &nbsp; )%\n%<br />&nbsp; %\n%<br />&nbsp; Since this is a case of a macro &quot;calling&quot; a macro, the macro definition must%\n%<br />&nbsp; be preceded by %%macro_BeginDef%% and followed by a call to %%macro.EndDef%%%\n%<br />&nbsp; and %%macro_EndAnyRtn%%. See macro.EndDef for more information.%\n%<br />&nbsp; &nbsp;%\n%<br />&nbsp; Any call to a macro that uses AnyRtnN must be followed by %%macro_EndAnyRtn%%.%\n%<br />&nbsp; The macro call and %%macro_EndAnyRtn%% must not share a common statement block.%\n%<br />&nbsp; This limitation can be overcome by calling the macro through the callMacro%\n%<br />&nbsp; function which implicitly calls %%macro_EndAnyRtn%%%xLF%<br />set macro.AnyRtnN=do (%\n%<br />&nbsp; setlocal enableDelayedExpansion%\n%<br />&nbsp; set /a &quot;macro.AnyRtn1.ErrLvl=(%%~a), macro.AnyRtn1.EndLocalCnt=(%%~b)&quot;%\n%<br />&nbsp; set &quot;macro_EndAnyRtn=!macro_EndAnyRtnPrefix!endlocal&amp;endlocal&quot;%\n%<br />&nbsp; for /l %%N in (1,1,!macro.AnyRtn1.EndLocalCnt!) do set &quot;macro_EndAnyRtn=!macro_EndAnyRtn!&amp;endlocal&quot;%\n%<br />&nbsp; for %%c in (%%~c) do for /f &quot;tokens=1,2 eol=: delims=:&quot; %%c in (&quot;%%c&quot;) do (%\n%<br />&nbsp; &nbsp; set &quot;macro.AnyRtnN.rtn=!%%~c!&quot;%\n%<br />&nbsp; &nbsp; if defined macro.AnyRtnN.rtn (%\n%<br />&nbsp; &nbsp; &nbsp; set &quot;macro.AnyRtnN.rtn=!macro.AnyRtnN.rtn:%%=%%~1!&quot;%\n%<br />&nbsp; &nbsp; &nbsp; set ^&quot;macro.AnyRtnN.rtn=!macro.AnyRtnN.rtn:^&quot;=%%~2!^&quot;%\n%<br />&nbsp; &nbsp; &nbsp; if defined CR for %%A in (&quot;!CR!&quot;) do set &quot;macro.AnyRtnN.rtn=!macro.AnyRtnN.rtn:%%~A=%%~3!&quot;%\n%<br />&nbsp; &nbsp; &nbsp; for %%A in (&quot;!LF!&quot;) do set &quot;macro.AnyRtnN.rtn=!macro.AnyRtnN.rtn:%%~A=%%~4!&quot;%\n%<br />&nbsp; &nbsp; &nbsp; if not defined macro_NotDelayed (%\n%<br />&nbsp; &nbsp; &nbsp; &nbsp; set &quot;macro.AnyRtnN.rtn=!macro.AnyRtnN.rtn:^=^^!&quot;%\n%<br />&nbsp; &nbsp; &nbsp; &nbsp; call set &quot;macro.AnyRtnN.rtn=%%^macro.AnyRtnN.rtn:^!=&quot;&quot;^!%%&quot; ! %\n%<br />&nbsp; &nbsp; &nbsp; &nbsp; set &quot;macro.AnyRtnN.rtn=!macro.AnyRtnN.rtn:&quot;&quot;=^!&quot;%\n%<br />&nbsp; &nbsp; &nbsp; )%\n%<br />&nbsp; &nbsp; )%\n%<br />&nbsp; &nbsp; set &quot;macro_EndAnyRtn=!macro_EndAnyRtn!&amp;set &quot;%%~d=!macro.AnyRtnN.rtn!&quot; ^!&quot;%\n%<br />&nbsp; )%\n%<br />&nbsp; if defined macro_inFcn (%\n%<br />&nbsp; &nbsp; &nbsp; set &quot;macro_EndAnyRtn=!macro_EndAnyRtn!&amp;exit /b !macro.AnyRtn1.ErrLvl!&quot;%\n%<br />&nbsp; ) else if &quot;!macro.AnyRtn1.ErrLvl!&quot; == &quot;1&quot; (%\n%<br />&nbsp; &nbsp; &nbsp; set &quot;macro_EndAnyRtn=!macro_EndAnyRtn!&amp;(2&gt;nul set =)&quot;%\n%<br />&nbsp; ) else if &quot;!macro.AnyRtn1.ErrLvl!&quot; neq &quot;0&quot; (%\n%<br />&nbsp; &nbsp; &nbsp; set &quot;macro_EndAnyRtn=!macro_EndAnyRtn!&amp;cmd /d /c exit !macro.AnyRtn1.ErrLvl!&quot;%\n%<br />&nbsp; )%\n%<br />&nbsp; set ^&quot;replace=%% ^&quot;^&quot;^&quot; !CR!!CR!^&quot;%\n%<br />)<br /><br />set macro\args.Rtn1=&nbsp; ErrLvl&nbsp; EndLocalCnt&nbsp; ValueVar&nbsp; &#91;RtnVar&#93;<br />set macro\help.Rtn1=&nbsp; ErrLvl&nbsp; EndLocalCnt&nbsp; ValueVar&nbsp; &#91;RtnVar&#93;%\n%<br />&nbsp; %\n%<br />&nbsp; Returns the contents of variable ValueVar across the ENDLOCAL border at the%\n%<br />&nbsp; end of a function or macro. The number of ENDLOCAL executions is controlled%\n%<br />&nbsp; by the EndLocalCnt which should match the number of times SETLOCAL was used%\n%<br />&nbsp; within the calling function/macro.%\n%<br />&nbsp; %\n%<br />&nbsp; The return value is stored in RtnVar%\n%<br />&nbsp; or the value is echoed if RtnVar is not specified.%\n%<br />&nbsp; The ERRORLEVEL is set to ErrLvl%\n%<br />&nbsp; %\n%<br />&nbsp; Numeric values ErrLvl and EndLocalCnt may be passed using any expression%\n%<br />&nbsp; supported by SET /A.%\n%<br />&nbsp; %\n%<br />&nbsp; This macro can return a string containing any combination of characters%\n%<br />&nbsp; supported by DOS, except for 0x0A ^&lt;Line Feed^&gt; or 0x0D ^&lt;Carriage Return^&gt;.%\n%<br />&nbsp; The macro works regardless whether the target return environment has%\n%<br />&nbsp; enabled or disabled delayed expansion.%\n%<br />&nbsp; %\n%<br />&nbsp; In order for a function to use Rtn1, the calling function must start with%\n%<br />&nbsp; %%macro_InitFcnRtn%% at the top.%\n%<br />&nbsp; %\n%<br />&nbsp; &nbsp; :func inputVar &#91;RtnVar&#93;%\n%<br />&nbsp; &nbsp; &nbsp; %%macro_InitFcnRtn%%%\n%<br />&nbsp; &nbsp; &nbsp; setlocal%\n%<br />&nbsp; &nbsp; &nbsp; {do whatever you need to do}%\n%<br />&nbsp; &nbsp; &nbsp; set rtnValue={your return value}%\n%<br />&nbsp; &nbsp; &nbsp; %%macro_Call%% (&quot;errorlevel 1 rtnValue %%~2&quot;) %%macro.Rtn1%%%\n%<br />&nbsp; &nbsp; exit /b%\n%<br />&nbsp; %\n%<br />&nbsp; In order for a macro to use Rtn1, the calling macro must start with%\n%<br />&nbsp; %%macro_InitRtn%% at the top. In the macro template below, assume the %%%%c%\n%<br />&nbsp; argument holds the name of the variable to receive the result.%\n%<br />&nbsp; %\n%<br />&nbsp; &nbsp; set macro.Name=do (%%\n%%%\n%<br />&nbsp; &nbsp; &nbsp; !macro_InitRtn!%%\n%%%\n%<br />&nbsp; &nbsp; &nbsp; setlocal%%\n%%%\n%<br />&nbsp; &nbsp; &nbsp; {do whatever you need to do}%\n%<br />&nbsp; &nbsp; &nbsp; set rtnValue={your return value}%%\n%%%\n%<br />&nbsp; &nbsp; &nbsp; !macro_Call! (&quot;errorlevel 1 rtnValue %%%%~c&quot;) !macro.Rtn1!%%\n%%%\n%<br />&nbsp; &nbsp; )%\n%<br />&nbsp; %\n%<br />&nbsp; Since this is a case of a macro &quot;calling&quot; a macro, the macro definition%\n%<br />&nbsp; must be preceded by %%macro_BeginDef%% and followed by a call to %%macro.EndDef%%%\n%<br />&nbsp; and %%macro_EndAnyRtn%%. See macro.EndDef for more information.%xLF%<br />set macro.Rtn1=do (%\n%<br />&nbsp; setlocal enableDelayedExpansion%\n%<br />&nbsp; set /a &quot;macro.Rtn1.ErrLvl=(%%~a), macro.Rtn1.EndLocalCnt=(%%~b)+2&quot;%\n%<br />&nbsp; set &quot;rtn=!%%~c!&quot;%\n%<br />&nbsp; if defined macro_inFcn (%\n%<br />&nbsp; &nbsp; &nbsp; set &quot;errCmd=exit /b !macro.Rtn1.ErrLvl!&quot;%\n%<br />&nbsp; ) else if &quot;!macro.Rtn1.ErrLvl!&quot; == &quot;0&quot; (%\n%<br />&nbsp; &nbsp; &nbsp; set &quot;errCmd=rem&quot;%\n%<br />&nbsp; ) else if &quot;!macro.Rtn1.ErrLvl!&quot; == &quot;1&quot; (%\n%<br />&nbsp; &nbsp; &nbsp; set &quot;errCmd=set =&quot;%\n%<br />&nbsp; ) else (%\n%<br />&nbsp; &nbsp; &nbsp; set &quot;errCmd=cmd /d /c exit !macro.Rtn1.ErrLvl!&quot;%\n%<br />&nbsp; )%\n%<br />&nbsp; if &quot;%%~d&quot; equ &quot;&quot; (%echo%!rtn!) else if defined rtn if not defined macro_NotDelayed (%\n%<br />&nbsp; &nbsp; set &quot;rtn=!rtn:^=^^!&quot;%\n%<br />&nbsp; &nbsp; set &quot;rtn=!rtn:&quot;=&quot;&quot;Q!^&quot;%\n%<br />&nbsp; &nbsp; call set &quot;rtn=%%^rtn:^!=&quot;&quot;E^!%%&quot; ! %\n%<br />&nbsp; &nbsp; set &quot;rtn=!rtn:&quot;&quot;E=^!&quot;%\n%<br />&nbsp; &nbsp; set &quot;rtn=!rtn:&quot;&quot;Q=&quot;!^&quot;%\n%<br />&nbsp; )%\n%<br />&nbsp; for /f &quot;delims=&quot; %%e in (&quot;!errCmd!&quot;) do for /f %macro_ForEntireLine% %%v in (&quot;&quot;!rtn!&quot;&quot;) do (%\n%<br />&nbsp; &nbsp; for /l %%n in (1,1,!macro.Rtn1.EndLocalCnt!) do endlocal%\n%<br />&nbsp; &nbsp; if &quot;%%~d&quot; neq &quot;&quot; set &quot;%%~d=%%~v&quot; !%\n%<br />&nbsp; &nbsp; %%e 2^&gt;nul%\n%<br />&nbsp; )%\n%<br />)<br /><br />set macro\args.RtnN=&nbsp; ErrLvl&nbsp; EndLocalCnt&nbsp; ValVar1:RtnVar1&#91;,ValVar2:RtnVar2&#93;...<br />set macro\help.RtnN=&nbsp; ErrLvl&nbsp; EndLocalCnt&nbsp; ValVar1:RtnVar1&#91;,ValVar2:RtnVar2&#93;...%\n%<br />&nbsp; %\n%<br />&nbsp; Returns the contents of multiple variables across the ENDLOCAL border at%\n%<br />&nbsp; the end of a function or macro. The number of ENDLOCAL executions is%\n%<br />&nbsp; controlled by the EndLocalCnt which should match the number of times%\n%<br />&nbsp; SETLOCAL was used within the calling function/macro. The errorlevel is%\n%<br />&nbsp; set to ErrLvl.%\n%<br />&nbsp; %\n%<br />&nbsp; A pair of variable names must be specified for each output value - the%\n%<br />&nbsp; name of the variable containing the value followed by a colon followed%\n%<br />&nbsp; by the name of the variable that is to receive the value. Multiple pairs%\n%<br />&nbsp; are delimited by commas. The list of outputs cannot contain any spaces,%\n%<br />&nbsp; and the variable names cannot contain asterisk ^(*^), question mark ^(?^),%\n%<br />&nbsp; colon ^(:^) or comma ^(,^).%\n%<br />&nbsp; %\n%<br />&nbsp; Numeric values ErrLvl and EndLocalCnt may be passed using any expression%\n%<br />&nbsp; supported by SET /A.%\n%<br />&nbsp; %\n%<br />&nbsp; This macro can return strings containing any combination of characters%\n%<br />&nbsp; supported by DOS, except for 0x0A ^&lt;Line Feed^&gt; or 0x0D ^&lt;Carriage Return^&gt;.%\n%<br />&nbsp; The macro works regardless whether the target return environment has%\n%<br />&nbsp; enabled or disabled delayed expansion.%\n%<br />&nbsp; %\n%<br />&nbsp; In order for a function to use RtnN, the calling function must start with%\n%<br />&nbsp; %%macro_InitFcnRtn%% at the top.%\n%<br />&nbsp; %\n%<br />&nbsp; &nbsp; :func inputVar RtnVar1 RtnVar2%\n%<br />&nbsp; &nbsp; &nbsp; %%macro_InitFcnRtn%%%\n%<br />&nbsp; &nbsp; &nbsp; setlocal%\n%<br />&nbsp; &nbsp; &nbsp; {do whatever you need to do}%\n%<br />&nbsp; &nbsp; &nbsp; set rtnVal1={your first return value}%\n%<br />&nbsp; &nbsp; &nbsp; set rtnVal2={your second return value}%\n%<br />&nbsp; &nbsp; &nbsp; %%macro_Call%% (&quot;errorlevel 1 rtnVal1:%%~2,rtnVal2:%%~3&quot;) %%macro.RtnN%%%\n%<br />&nbsp; &nbsp; exit /b%\n%<br />&nbsp; %\n%<br />&nbsp; In order for a macro to use RtnN, the calling macro must start with%\n%<br />&nbsp; %%macro_InitRtn%% at the top. In the macro template below, assume the %%%%c%\n%<br />&nbsp; and %%%%~d arguments hold the name of the variables to receive the results.%\n%<br />&nbsp; %\n%<br />&nbsp; &nbsp; set macro.Name=do (%%\n%%%\n%<br />&nbsp; &nbsp; &nbsp; !macro_InitRtn!%%\n%%%\n%<br />&nbsp; &nbsp; &nbsp; setlocal%%\n%%%\n%<br />&nbsp; &nbsp; &nbsp; {do whatever you need to do}%\n%<br />&nbsp; &nbsp; &nbsp; set rtnVal1={your first return value}%%\n%%%\n%<br />&nbsp; &nbsp; &nbsp; set rtnVal2={your second return value}%%\n%%%\n%<br />&nbsp; &nbsp; &nbsp; !macro_Call! (&quot;errorlevel 1 rtnVal1:%%%%~c,rtnVal2:%%%%~d&quot;) !macro.RtnN!%%\n%%%\n%<br />&nbsp; &nbsp; )%\n%<br />&nbsp; %\n%<br />&nbsp; Since this is a case of a macro &quot;calling&quot; a macro, the macro definition%\n%<br />&nbsp; must be preceded by %%macro_BeginDef%% and followed by a call to %%macro.EndDef%%%\n%<br />&nbsp; and %%macro_EndAnyRtn%%. See macro.EndDef for more information.%xLF%<br />set macro.RtnN=do (%\n%<br />&nbsp; setlocal enableDelayedExpansion%\n%<br />&nbsp; set /a &quot;macro.RtnN.ErrLvl=(%%~a), macro.RtnN.EndLocalCnt=(%%~b)+2&quot;%\n%<br />&nbsp; set &quot;macro.RtnN.cmd=&quot;%\n%<br />&nbsp; for /l %%n in (1,1,!macro.RtnN.EndLocalCnt!) do set &quot;macro.RtnN.cmd=!macro.RtnN.cmd!endlocal!lf!&quot;%\n%<br />&nbsp; for %%c in (%%~c) do for /f &quot;tokens=1,2 eol=: delims=:&quot; %%c in (&quot;%%c&quot;) do (%\n%<br />&nbsp; &nbsp; set &quot;macro.RtnN.rtn=!%%~c!&quot;%\n%<br />&nbsp; &nbsp; if defined macro.RtnN.rtn if not defined macro_NotDelayed (%\n%<br />&nbsp; &nbsp; &nbsp; set &quot;macro.RtnN.rtn=!macro.RtnN.rtn:^=^^!&quot;%\n%<br />&nbsp; &nbsp; &nbsp; set &quot;macro.RtnN.rtn=!macro.RtnN.rtn:&quot;=&quot;&quot;Q!^&quot;%\n%<br />&nbsp; &nbsp; &nbsp; call set &quot;macro.RtnN.rtn=%%^macro.RtnN.rtn:^!=&quot;&quot;E^!%%&quot; ! %\n%<br />&nbsp; &nbsp; &nbsp; set &quot;macro.RtnN.rtn=!macro.RtnN.rtn:&quot;&quot;E=^!&quot;%\n%<br />&nbsp; &nbsp; &nbsp; set &quot;macro.RtnN.rtn=!macro.RtnN.rtn:&quot;&quot;Q=&quot;!^&quot;%\n%<br />&nbsp; &nbsp; )%\n%<br />&nbsp; &nbsp; set &quot;macro.RtnN.cmd=!macro.RtnN.cmd!set &quot;%%~d=!macro.RtnN.rtn!&quot;^!!lf!&quot;%\n%<br />&nbsp; )%\n%<br />&nbsp; if defined macro_inFcn (%\n%<br />&nbsp; &nbsp; &nbsp; set &quot;macro.RtnN.cmd=!macro.RtnN.cmd!exit /b !macro.RtnN.ErrLvl!!lf!&quot;%\n%<br />&nbsp; ) else if &quot;!macro.RtnN.ErrLvl!&quot; == &quot;0&quot; (%\n%<br />&nbsp; &nbsp; &nbsp; rem errorlevel set to 0 by default%\n%<br />&nbsp; ) else (%\n%<br />&nbsp; &nbsp; &nbsp; set &quot;macro.RtnN.cmd=!macro.RtnN.cmd!cmd /d /c exit !macro.RtnN.ErrLvl!!lf!&quot;%\n%<br />&nbsp; )%\n%<br />&nbsp; for /f &quot;delims=&quot; %%v in (&quot;!macro.RtnN.cmd!&quot;) do %%v%\n%<br />)<br /><br />set &quot;macro\args_BeginDef= &quot;<br />set macro\help_BeginDef=%\n%<br />&nbsp; %\n%<br />&nbsp; Define a simple macro to be used before defining a macro that includes%\n%<br />&nbsp; another macro in its definition. See macro.EndDef for more information%xLF%<br />set macro_BeginDef=(%\n%<br />&nbsp; setlocal enableDelayedExpansion%\n%<br />&nbsp; set &quot;macro_NotDelayed=1&quot;%\n%<br />&nbsp; set &quot;macro_inFcn=&quot;%\n%<br />)<br /><br />set macro\args.EndDef=&nbsp; MacroName<br />set macro\help.EndDef=&nbsp; MacroName%\n%<br />&nbsp; %\n%<br />&nbsp; One of three macros needed to define a macro that &quot;calls&quot; another macro%\n%<br />&nbsp; in its definition. %%macro_BeginDef%% is used before the macro definition%\n%<br />&nbsp; and %%macro.EndDef%% and %%macro_EndAnyRtn%% are used after the macro definition.%\n%<br />&nbsp; %\n%<br />&nbsp; Macro calling macro template:%\n%<br />&nbsp; %\n%<br />&nbsp; &nbsp; %%macro_BeginDef%%%\n%<br />&nbsp; &nbsp; set macro.Name=do (%%\n%%%\n%<br />&nbsp; &nbsp; &nbsp; {macro definition goes here}%\n%<br />&nbsp; &nbsp; )%\n%<br />&nbsp; &nbsp; %%macro_Call%% (&quot;macro.Name&quot;) %%macro.EndDef%%%\n%<br />&nbsp; &nbsp; %%macro_EndAnyRtn%%%\n%<br />&nbsp; %\n%<br />&nbsp; Calls to a macro within the definition should use delayed expansion:%\n%<br />&nbsp; %\n%<br />&nbsp; &nbsp; !macro_SimpleMacroName!%%\n%%%\n%<br />&nbsp; &nbsp; !macro_Call! (&quot;{macro aruments}&quot;) !macro.MacroName!%%\n%%%\n%<br />&nbsp; %\n%<br />&nbsp; Carets and exclamation points not involved with a macro call must be%\n%<br />&nbsp; escaped. Escape once if within quotes, twice if not within quotes:%\n%<br />&nbsp; %\n%<br />&nbsp; &nbsp; set &quot;caret=^^&quot;%%\n%%%\n%<br />&nbsp; &nbsp; set &quot;exclamation=^!&quot;%%\n%%%\n%<br />&nbsp; &nbsp; set caret=^^^^^^^^%%\n%%%\n%<br />&nbsp; &nbsp; set exclamation=^^^^^^!%%\n%%%xLF%<br />%macro_BeginDef%<br />set macro.EndDef=do !macro_call! (&quot;errorlevel 0 %%a %%a&quot;) !macro.AnyRtn1!<br />%macro_Call% (&quot;errorlevel 0 macro.EndDef macro.EndDef&quot;) %macro.AnyRtn1%<br />%macro_EndAnyRtn%<br /><br />set macro\args.SetErr=&nbsp; ErrLvl<br />set macro\help.SetErr=&nbsp; ErrLvl%\n%<br />&nbsp; %\n%<br />&nbsp; Sets ERRORLEVEL to the integral value ErrLvl%xLF%<br />set macro.SetErr=do (%\n%<br />&nbsp; if &quot;%%~a&quot; equ &quot;0&quot; (%\n%<br />&nbsp; &nbsp; verify ^&gt;nul%\n%<br />&nbsp; ) else if &quot;%%~a&quot; equ &quot;1&quot; (%\n%<br />&nbsp; &nbsp; set = 2^&gt;nul%\n%<br />&nbsp; ) else (%\n%<br />&nbsp; &nbsp; cmd /d /c exit %%~a%\n%<br />&nbsp; )%\n%<br />)<br /><br />::----------------------------------------------------<br />:: Mark that this library has been loaded.<br /><br />set macro\load.%~n0=1<br /></code></pre></div><br /><br /><strong class="text-strong">macroLib_String.bat</strong><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />:: File = macroLib_String.bat<br />:: Dependencies: macroLib_Base.bat, macroLib_Return.bat<br />:: This batch file will fail if called while delayed expansion is enabled.<br />::<br />:: This library defines macros that are useful for working with strings.<br />::<br />:: The library is designed to be installed in a directory in your PATH.<br />:: Any batch file that requires it can include it by simply placing the<br />:: following line of code at the top before any SETLOCAL:<br />::<br />::&nbsp; &nbsp;IF NOT DEFINED macro\load.MacroLib_String CALL macroLib_String<br />::<br />:: In this way the library becomes resident in your command shell environment<br />:: where it is available to any batch file that may need it. The IF condition<br />:: prevents unneccessary reloads of the same library.<br />::<br />::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::<br /><br />:: Conditionally load dependencies (normally residing somewhere in the PATH)<br />if not defined macro\load.macroLib_Return call macroLib_Return<br /><br />set macro\args.StrLen=&nbsp; StrVar&nbsp; &#91;RtnVar&#93;<br />set macro\help.StrLen=&nbsp; StrVar&nbsp; &#91;RtnVar&#93;%\n%<br />&nbsp; %\n%<br />&nbsp; Computes the length of the string within variable StrVar%\n%<br />&nbsp; %\n%<br />&nbsp; Sets RtnVar = result%\n%<br />&nbsp; or displays result if RtnVar not specified%xLF%<br />set macro.StrLen=do (%\n%<br />&nbsp; setlocal enableDelayedExpansion%\n%<br />&nbsp; set &quot;str=A!%%~a!&quot;%\n%<br />&nbsp; set &quot;len=0&quot;%\n%<br />&nbsp; for /l %%A in (12,-1,0) do (%\n%<br />&nbsp; &nbsp; set /a &quot;len|=1&lt;&lt;%%A&quot;%\n%<br />&nbsp; &nbsp; for %%B in (!len!) do if &quot;!str:~%%B,1!&quot;==&quot;&quot; set /a &quot;len&amp;=~1&lt;&lt;%%A&quot;%\n%<br />&nbsp; )%\n%<br />&nbsp; for %%v in (!len!) do endlocal^&amp;if &quot;%%~b&quot; neq &quot;&quot; (set &quot;%%~b=%%v&quot;) else %echo%%%v%\n%<br />)<br /><br />set macro\args.AnyToLower=&nbsp; StrVar&nbsp; &#91;RtnVar&#93;<br />set macro\help.AnyToLower=&nbsp; StrVar&nbsp; &#91;RtnVar&#93;%\n%<br />&nbsp; %\n%<br />&nbsp; Converts the string within variable StrVar to lower case%\n%<br />&nbsp; %\n%<br />&nbsp; Sets RtnVar = result%\n%<br />&nbsp; or displays result if RtnVar not specified%\n%<br />&nbsp; %\n%<br />&nbsp; Like all &quot;Any&quot; macros, this version of ToLower supports all characters%\n%<br />&nbsp; supported by DOS, including 0x0A ^&lt;LF^&gt; and 0x0D ^&lt;CR^&gt;.%\n%<br />&nbsp; %\n%<br />&nbsp; %%macro_EndAnyRtn%% must follow a call to this macro, and it cannot share%\n%<br />&nbsp; a code block with the call.%xLF%<br />%macro_BeginDef%<br />set macro.AnyToLower=do (%\n%<br />&nbsp; !macro_InitRtn!%\n%<br />&nbsp; setlocal enableDelayedExpansion%\n%<br />&nbsp; set &quot;str=^!%%~a^!&quot;%\n%<br />&nbsp; for %%A in (%\n%<br />&nbsp; &nbsp; &quot;A=a&quot; &quot;B=b&quot; &quot;C=c&quot; &quot;D=d&quot; &quot;E=e&quot; &quot;F=f&quot; &quot;G=g&quot; &quot;H=h&quot; &quot;I=i&quot;%\n%<br />&nbsp; &nbsp; &quot;J=j&quot; &quot;K=k&quot; &quot;L=l&quot; &quot;M=m&quot; &quot;N=n&quot; &quot;O=o&quot; &quot;P=p&quot; &quot;Q=q&quot; &quot;R=r&quot;%\n%<br />&nbsp; &nbsp; &quot;S=s&quot; &quot;T=t&quot; &quot;U=u&quot; &quot;V=v&quot; &quot;W=w&quot; &quot;X=x&quot; &quot;Y=y&quot; &quot;Z=z&quot; &quot;Ä=ä&quot;%\n%<br />&nbsp; &nbsp; &quot;Ö=ö&quot; &quot;Ü=ü&quot;%\n%<br />&nbsp; ) do set &quot;str=^!str:%%~A^!&quot;%\n%<br />&nbsp; !macro_Call! (&quot;^!errorlevel^! 1 str %%~b&quot;) !macro.AnyRtn1!%\n%<br />)<br />%macro_Call% (&quot;macro.AnyToLower&quot;) %macro.EndDef%<br />%macro_EndAnyRtn%<br /><br />set macro\args.AnyToUpper=&nbsp; StrVar&nbsp; &#91;RtnVar&#93;<br />set macro\help.AnyToUpper=&nbsp; StrVar&nbsp; &#91;RtnVar&#93;%\n%<br />&nbsp; %\n%<br />&nbsp; Converts the string within variable StrVar to upper case%\n%<br />&nbsp; %\n%<br />&nbsp; Sets RtnVar = result%\n%<br />&nbsp; or displays result if RtnVar not specified%\n%<br />&nbsp; %\n%<br />&nbsp; Like all &quot;Any&quot; macros, this version of ToUpper supports all characters%\n%<br />&nbsp; supported by DOS, including 0x0A ^&lt;LF^&gt; and 0x0D ^&lt;CR^&gt;.%\n%<br />&nbsp; %\n%<br />&nbsp; %%macro_EndAnyRtn%% must follow a call to this macro, and it cannot share%\n%<br />&nbsp; a code block with the call.%xLF%<br />%macro_BeginDef%<br />set macro.AnyToUpper=do (%\n%<br />&nbsp; !macro_InitRtn!%\n%<br />&nbsp; setlocal enableDelayedExpansion%\n%<br />&nbsp; set &quot;str=^!%%~a^!&quot;%\n%<br />&nbsp; for %%A in (%\n%<br />&nbsp; &nbsp; &quot;a=A&quot; &quot;b=B&quot; &quot;c=C&quot; &quot;d=D&quot; &quot;e=E&quot; &quot;f=F&quot; &quot;g=G&quot; &quot;h=H&quot; &quot;i=I&quot;%\n%<br />&nbsp; &nbsp; &quot;j=J&quot; &quot;k=K&quot; &quot;l=L&quot; &quot;m=M&quot; &quot;n=N&quot; &quot;o=O&quot; &quot;p=P&quot; &quot;q=Q&quot; &quot;r=R&quot;%\n%<br />&nbsp; &nbsp; &quot;s=S&quot; &quot;t=T&quot; &quot;u=U&quot; &quot;v=V&quot; &quot;w=W&quot; &quot;x=X&quot; &quot;y=Y&quot; &quot;z=Z&quot; &quot;ä=Ä&quot;%\n%<br />&nbsp; &nbsp; &quot;ö=Ö&quot; &quot;ü=Ü&quot;%\n%<br />&nbsp; ) do set &quot;str=^!str:%%~A^!&quot;%\n%<br />&nbsp; !macro_Call! (&quot;^!errorlevel^! 1 str %%~b&quot;) !macro.AnyRtn1!%\n%<br />)<br />%macro_call% (&quot;macro.AnyToUpper&quot;) %macro.EndDef%<br />%macro_EndAnyRtn%<br /><br />set macro\args.ToLower=&nbsp; StrVar&nbsp; &#91;RtnVar&#93;<br />set macro\help.ToLower=&nbsp; StrVar&nbsp; &#91;RtnVar&#93;%\n%<br />&nbsp; %\n%<br />&nbsp; Converts the string within variable StrVar to lower case%\n%<br />&nbsp; %\n%<br />&nbsp; Sets RtnVar = result%\n%<br />&nbsp; or displays result if RtnVar not specified%xLF%<br />%macro_BeginDef%<br />set macro.ToLower=do (%\n%<br />&nbsp; !macro_InitRtn!%\n%<br />&nbsp; setlocal enableDelayedExpansion%\n%<br />&nbsp; set &quot;str=^!%%~a^!&quot;%\n%<br />&nbsp; for %%A in (%\n%<br />&nbsp; &nbsp; &quot;A=a&quot; &quot;B=b&quot; &quot;C=c&quot; &quot;D=d&quot; &quot;E=e&quot; &quot;F=f&quot; &quot;G=g&quot; &quot;H=h&quot; &quot;I=i&quot;%\n%<br />&nbsp; &nbsp; &quot;J=j&quot; &quot;K=k&quot; &quot;L=l&quot; &quot;M=m&quot; &quot;N=n&quot; &quot;O=o&quot; &quot;P=p&quot; &quot;Q=q&quot; &quot;R=r&quot;%\n%<br />&nbsp; &nbsp; &quot;S=s&quot; &quot;T=t&quot; &quot;U=u&quot; &quot;V=v&quot; &quot;W=w&quot; &quot;X=x&quot; &quot;Y=y&quot; &quot;Z=z&quot; &quot;Ä=ä&quot;%\n%<br />&nbsp; &nbsp; &quot;Ö=ö&quot; &quot;Ü=ü&quot;%\n%<br />&nbsp; ) do set &quot;str=^!str:%%~A^!&quot;%\n%<br />&nbsp; !macro_Call! (&quot;^!errorlevel^! 1 str %%~b&quot;) !macro.Rtn1!%\n%<br />)<br />%macro_Call% (&quot;macro.ToLower&quot;) %macro.EndDef%<br />%macro_EndAnyRtn%<br /><br />set macro\args.ToUpper=&nbsp; StrVar&nbsp; &#91;RtnVar&#93;<br />set macro\help.ToUpper=&nbsp; StrVar&nbsp; &#91;RtnVar&#93;%\n%<br />&nbsp; %\n%<br />&nbsp; Converts the string within variable StrVar to upper case%\n%<br />&nbsp; %\n%<br />&nbsp; Sets RtnVar = result%\n%<br />&nbsp; or displays result if RtnVar not specified%xLF%<br />%macro_BeginDef%<br />set macro.ToUpper=do (%\n%<br />&nbsp; !macro_InitRtn!%\n%<br />&nbsp; setlocal enableDelayedExpansion%\n%<br />&nbsp; set &quot;str=^!%%~a^!&quot;%\n%<br />&nbsp; for %%A in (%\n%<br />&nbsp; &nbsp; &quot;a=A&quot; &quot;b=B&quot; &quot;c=C&quot; &quot;d=D&quot; &quot;e=E&quot; &quot;f=F&quot; &quot;g=G&quot; &quot;h=H&quot; &quot;i=I&quot;%\n%<br />&nbsp; &nbsp; &quot;j=J&quot; &quot;k=K&quot; &quot;l=L&quot; &quot;m=M&quot; &quot;n=N&quot; &quot;o=O&quot; &quot;p=P&quot; &quot;q=Q&quot; &quot;r=R&quot;%\n%<br />&nbsp; &nbsp; &quot;s=S&quot; &quot;t=T&quot; &quot;u=U&quot; &quot;v=V&quot; &quot;w=W&quot; &quot;x=X&quot; &quot;y=Y&quot; &quot;z=Z&quot; &quot;ä=Ä&quot;%\n%<br />&nbsp; &nbsp; &quot;ö=Ö&quot; &quot;ü=Ü&quot;%\n%<br />&nbsp; ) do set &quot;str=^!str:%%~A^!&quot;%\n%<br />&nbsp; !macro_Call! (&quot;^!errorlevel^! 1 str %%~b&quot;) !macro.Rtn1!%\n%<br />)<br />%macro_Call% (&quot;macro.ToUpper&quot;) %macro.EndDef%<br />%macro_EndAnyRtn%<br /><br />::------------------------------------------<br />:: MARK THAT THIS LIBRARY HAS BEEN LOADED<br /><br />set macro\load.%~n0=1<br /></code></pre></div><br /><br /><strong class="text-strong">macroLib_Swap.bat</strong><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />:: File = macroLib_Swap.bat<br />:: Dependencies: macroLib_Base.bat, macroLib_Return.bat<br />:: This batch file will fail if called while delayed expansion is enabled.<br />::<br />:: This library defines macros that swap values between two variables.<br />::<br />:: The library is designed to be installed in a directory in your PATH.<br />:: Any batch file that requires it can include it by simply placing the<br />:: following line of code at the top before any SETLOCAL:<br />::<br />::&nbsp; &nbsp;IF NOT DEFINED macro\load.MacroLib_Swap CALL macroLib_Swap<br />::<br />:: In this way the library becomes resident in your command shell environment<br />:: where it is available to any batch file that may need it. The IF condition<br />:: prevents unneccessary reloads of the same library.<br />::<br />::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::<br /><br />:: Conditionally load dependencies (normally residing somewhere in the PATH)<br />if not defined macro\load.macroLib_Return call macroLib_Return<br /><br />set macro\args.Swap=&nbsp; Var1&nbsp; Var2<br />set macro\help.Swap=&nbsp; Var1&nbsp; Var2%\n%<br />&nbsp; %\n%<br />&nbsp; Swap the contents of variable Var1 with variable Var2.%\n%<br />&nbsp; %\n%<br />&nbsp; The variables may contain any combination of characters supported by DOS%\n%<br />&nbsp; except for 0x0A ^&lt;Line Feed^&gt; or 0x0D ^&lt;Carriage Return^&gt;.%xLF%<br />%macro_BeginDef%<br />set macro.Swap=do (%\n%<br />&nbsp; !macro_InitRtn!%\n%<br />&nbsp; setlocal enableDelayedExpansion%\n%<br />&nbsp; set &quot;macro.swap.b=^!%%~a^!&quot;%\n%<br />&nbsp; set &quot;macro.swap.a=^!%%~b^!&quot;%\n%<br />&nbsp; !macro_Call! (&quot;errorlevel 1 macro.swap.a:%%~a,macro.swap.b:%%~b&quot;) !macro.RtnN!%\n%<br />)<br />%macro_Call% (&quot;macro.Swap&quot;) %macro.EndDef%<br />%macro_EndAnyRtn%<br /><br />set macro\args.AnySwap=&nbsp; Var1&nbsp; Var2<br />set macro\help.AnySwap=&nbsp; Var1&nbsp; Var2%\n%<br />&nbsp; %\n%<br />&nbsp; Swap the contents of variable Var1 with variable Var2.%\n%<br />&nbsp; %\n%<br />&nbsp; The variables may contain any combination of characters supported by DOS%\n%<br />&nbsp; including 0x0A ^&lt;Line Feed^&gt; and 0x0D ^&lt;Carriage Return^&gt;.%\n%<br />&nbsp; %\n%<br />&nbsp; %%macro_RtnAny%% must follow a call to this macro, and it cannot share a code%\n%<br />&nbsp; block with the call.%xLF%<br />%macro_BeginDef%<br />set macro.AnySwap=do (%\n%<br />&nbsp; !macro_InitRtn!%\n%<br />&nbsp; setlocal enableDelayedExpansion%\n%<br />&nbsp; set &quot;macro.anyswap.b=^!%%~a^!&quot;%\n%<br />&nbsp; set &quot;macro.anyswap.a=^!%%~b^!&quot;%\n%<br />&nbsp; !macro_Call! (&quot;errorlevel 1 macro.anyswap.a:%%~a,macro.anyswap.b:%%~b&quot;) !macro.AnyRtnN!%\n%<br />)<br />%macro_Call% (&quot;macro.AnySwap&quot;) %macro.EndDef%<br />%macro_EndAnyRtn%<br /><br />::----------------------------------------------------<br />:: Mark that this library has been loaded.<br /><br />set macro\load.%~n0=1<br /></code></pre></div><br /><br /><strong class="text-strong">macroLib_Num.bat</strong><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />:: File = macroLib_Num.bat<br />:: Dependencies: macroLib_Base.bat<br />:: This batch file will fail if called while delayed expansion is enabled.<br />::<br />:: This library defines macros that are useful for working with numbers.<br />::<br />:: The library is designed to be installed in a directory in your PATH.<br />:: Any batch file that requires it can include it by simply placing the<br />:: following line of code at the top before any SETLOCAL:<br />::<br />::&nbsp; &nbsp;IF NOT DEFINED macro\load.MacroLib_Num CALL macroLib_Num<br />::<br />:: In this way the library becomes resident in your command shell environment<br />:: where it is available to any batch file that may need it. The IF condition<br />:: prevents unneccessary reloads of the same library.<br />::<br />::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::<br /><br />:: Conditionally load dependencies (normally residing somewhere in the PATH)<br />if not defined macro\load.macroLib_Base call macroLib_Base<br /><br />set macro\args.Num2Hex=&nbsp; NumVal&nbsp; &#91;RtnVar&#93;<br />set macro\help.Num2Hex=&nbsp; NumVal&nbsp; &#91;RtnVar&#93;%\n%<br />&nbsp; %\n%<br />&nbsp; Converts the integer value NumVal to the hexadecimal representation%\n%<br />&nbsp; of a signed 32 bit integer.%\n%<br />&nbsp; %\n%<br />&nbsp; Sets RtnVar = result%\n%<br />&nbsp; or displays result if RtnVar not specified%\n%<br />&nbsp; %\n%<br />&nbsp; NumVal may be passed as any expression supported by SET /A%xLF%<br />set macro.Num2Hex=do (%\n%<br />&nbsp; setlocal enableDelayedExpansion%\n%<br />&nbsp; set /a &quot;dec=(%%~a)&quot;%\n%<br />&nbsp; if defined hex set &quot;hex=&quot;%\n%<br />&nbsp; set &quot;map=0123456789ABCDEF&quot;%\n%<br />&nbsp; for /l %%n in (1,1,8) do (%\n%<br />&nbsp; &nbsp; set /a &quot;d=dec&amp;15,dec&gt;&gt;=4&quot;%\n%<br />&nbsp; &nbsp; for %%d in (!d!) do set &quot;hex=!map:~%%d,1!!hex!&quot;%\n%<br />&nbsp; )%\n%<br />&nbsp; for %%v in (!hex!) do endlocal^&amp;if &quot;%%~b&quot; neq &quot;&quot; (set &quot;%%~b=%%v&quot;) else %echo%%%v%\n%<br />)<br /><br />set macro\args.Random=&nbsp; MinVal&nbsp; MaxVal&nbsp; &#91;RtnVar&#93;<br />set macro\help.Random=&nbsp; MinVal&nbsp; MaxVal&nbsp; &#91;RtnVar&#93;%\n%<br />&nbsp; %\n%<br />&nbsp; Compute a pseudo random integral value between numeric values%\n%<br />&nbsp; MinVal and MaxVal.%\n%<br />&nbsp; %\n%<br />&nbsp; Sets RtnVar = result%\n%<br />&nbsp; or displays result if RtnVar not specified%\n%<br />&nbsp; %\n%<br />&nbsp; MinVal and MaxVal may be specified using any expression supported%\n%<br />&nbsp; by SET /A%xLF%<br />set macro.Random=do (%\n%<br />&nbsp; setlocal enableDelayedExpansion%\n%<br />&nbsp; set /a &quot;macro.Random.rtn=!random! %% ((%%~b)-(%%~a)+1) + (%%~a)&quot;%\n%<br />&nbsp; for /f %%v in (&quot;!macro.Random.rtn!&quot;) do endlocal^&amp;if &quot;%%~c&quot; neq &quot;&quot; (set %%~c=%%v) else %echo%%%v%\n%<br />)<br /><br /><br />::------------------------------------------<br />:: MARK THAT THIS LIBRARY HAS BEEN LOADED<br /><br />set macro\load.%~n0=1<br /></code></pre></div><br /><br /><strong class="text-strong">macroLib_Time.bat</strong><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />:: File = macroLib_Time.bat<br />:: Dependencies: macroLib_Base.bat<br />:: This batch file will fail if called while delayed expansion is enabled.<br />::<br />:: This library defines macros that are useful for working with Time.<br />::<br />:: The library is designed to be installed in a directory in your PATH.<br />:: Any batch file that requires it can include it by simply placing the<br />:: following line of code at the top before any SETLOCAL:<br />::<br />::&nbsp; &nbsp;IF NOT DEFINED macro\load.MacroLib_Time CALL macroLib_Time<br />::<br />:: In this way the library becomes resident in your command shell environment<br />:: where it is available to any batch file that may need it. The IF condition<br />:: prevents unneccessary reloads of the same library.<br />::<br />::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::<br /><br />:: Conditionally load dependencies (normally residing somewhere in the PATH)<br />if not defined macro\load.macroLib_Base call macroLib_Base<br /><br />set macro\args.GetTime=&nbsp; &#91;RtnVar&#93;<br />set macro\help.GetTime=&nbsp; &#91;RtnVar&#93;%\n%<br />&nbsp; %\n%<br />&nbsp; Computes the current time of day measured as 1/100th seconds past midnight%\n%<br />&nbsp; %\n%<br />&nbsp; Sets RtnVar = result%\n%<br />&nbsp; or displays result if RtnVar not specified (&quot;&quot;&quot;&quot;)%xLF%<br />set macro.GetTime=do (%\n%<br />&nbsp; setlocal enableDelayedExpansion%\n%<br />&nbsp; set &quot;t=0&quot;%\n%<br />&nbsp; for /f &quot;tokens=1-4 delims=:.&quot; %%A in (&quot;!time: =0!&quot;) do set /a &quot;t=(((1%%A*60)+1%%B)*60+1%%C)*100+1%%D-36610100&quot;%\n%<br />&nbsp; for %%v in (!t!) do endlocal^&amp;if &quot;%%~a&quot; neq &quot;&quot; (set &quot;%%~a=%%v&quot;) else %echo%%%v%\n%<br />)<br /><br />set macro\args.DiffTime=&nbsp; StartTime&nbsp; StopTime&nbsp; &#91;RtnVar&#93;<br />set macro\help.DiffTime=&nbsp; StartTime&nbsp; StopTime&nbsp; &#91;RtnVar&#93;%\n%<br />&nbsp; %\n%<br />&nbsp; Computes the elapsed time between StartTime and%\n%<br />&nbsp; StopTime and formats the result as HH:MM:SS.DD%\n%<br />&nbsp; %\n%<br />&nbsp; StartTime and StopTime must be integral values%\n%<br />&nbsp; representing 1/100th seconds past midnight. These%\n%<br />&nbsp; values are typically gotten via calls to GetTime.%\n%<br />&nbsp; %\n%<br />&nbsp; Sets RtnVar=result%\n%<br />&nbsp; or displays result if RtnVar not specified%\n%<br />&nbsp; %\n%<br />&nbsp; DiffTime will properly handle elapsed times that span%\n%<br />&nbsp; midnight. However it cannot handle times that%\n%<br />&nbsp; reach 24 hours or more.%\n%<br />&nbsp; %\n%<br />&nbsp; Note that StartTime and StopTime may be passed using%\n%<br />&nbsp; any numeric expression supported by SET /A%xLF%<br />set macro.DiffTime=do (%\n%<br />&nbsp; setlocal enableDelayedExpansion%\n%<br />&nbsp; set /a &quot;DD=(%%~b)-(%%~a)&quot;%\n%<br />&nbsp; if !DD! lss 0 set /a &quot;DD+=24*60*60*100&quot;%\n%<br />&nbsp; set /a &quot;HH=DD/360000, DD-=HH*360000, MM=DD/6000, DD-=MM*6000, SS=DD/100, DD-=SS*100&quot;%\n%<br />&nbsp; if &quot;!HH:~1!&quot;==&quot;&quot; set &quot;HH=0!HH!&quot;%\n%<br />&nbsp; if &quot;!MM:~1!&quot;==&quot;&quot; set &quot;MM=0!MM!&quot;%\n%<br />&nbsp; if &quot;!SS:~1!&quot;==&quot;&quot; set &quot;SS=0!SS!&quot;%\n%<br />&nbsp; if &quot;!DD:~1!&quot;==&quot;&quot; set &quot;DD=0!DD!&quot;%\n%<br />&nbsp; for %%v in (!HH!:!MM!:!SS!.!DD!) do endlocal^&amp;if &quot;%%~c&quot; neq &quot;&quot; (set &quot;%%~c=%%v&quot;) else %echo%%%v%\n%<br />)<br /><br />::------------------------------------------<br />:: MARK THAT THIS LIBRARY HAS BEEN LOADED<br /><br />set macro\load.%~n0=1<br /></code></pre></div><br /><br /><strong class="text-strong">callMacro.bat</strong><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />&nbsp; if &quot;%~1&quot;==&quot;&quot; goto :help<br />&nbsp; setlocal enableDelayedExpansion<br />&nbsp; set &quot;macro.temp=!macro.%~1!&quot;<br />&nbsp; endlocal &amp; for /f &quot;tokens=2-27&quot; %%a in (&quot;%*&quot;) %macro.temp%<br />&nbsp; %macro_EndAnyRtn%<br />exit /b<br /><br />&nbsp; :help<br />&nbsp; &nbsp; echo(<br />&nbsp; &nbsp; for /f &quot;tokens=1* eol=: delims=:&quot; %%a in ('findstr /bn : %~f0') do echo(%%b<br />&nbsp; exit /b<br /><br />:callMacro&nbsp; MacroName&nbsp; Arg1&nbsp; &#91;ArgN&#93;...<br />::<br />::&nbsp; Calls macro MacroName via a function.<br />::&nbsp; The MacroName should not include the macro. prefix.<br />::<br />::&nbsp; Macros have restrictions on where they may be used. Calling a macro<br />::&nbsp; through this function eliminates most of the restrictions at a cost of<br />::&nbsp; reduced speed due to the function call overhead.<br />::<br />::&nbsp; Macros are normally called inside a batch file using the macro_Call macro.<br />::<br />::&nbsp; Use the following macro help command to get more information on options<br />::&nbsp; for calling a macro:<br />::<br />::&nbsp; &nbsp; mhelp call<br />::<br />::&nbsp; For a full list of available macros to call, use:<br />::<br />::&nbsp; &nbsp; margs<br />::<br />::&nbsp; For detailed help on a particular macro, use:<br />::<br />::&nbsp; &nbsp; mhelp macroName<br /></code></pre></div><br /><br /><span style="color: #0000FF">2011-Jun-26: Fixed major bug in macroLib_Return.bat - macro.Rtn1</span><br /><br />Enjoy! (maybe)<br /><br />Dave Benham</div>

			
													<div class="notice">
					Last edited by <a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a> on 26 Jun 2011 14:54, edited 2 times in total.
									</div>
			
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p8701" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile8701">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist4c42.html?mode=viewprofile&amp;u=2519" class="username">Acy Forsythe</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search2527.html?author_id=2519&amp;sr=posts">126</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Jun 2011 10:30</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content8701">

						<h3 ><a href="#p8701">Re: Batch &quot;macros&quot; with arguments</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting68db.html?mode=quote&amp;f=3&amp;p=8701" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopice142.html?p=8701#p8701" onclick="prompt('Message #34',this.href); return false;">#34</a></span> 
									<a class="unread" href="viewtopice142.html?p=8701#p8701" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist4c42.html?mode=viewprofile&amp;u=2519" class="username">Acy Forsythe</a></strong> &raquo; </span>23 Jun 2011 21:40
			</p>
			
			
			
			<div class="content">Holy Crap!<br /><br />I just asked for an updated example of a macro you already wrote. What happens if I ask for a whole function library? <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br /><br />But seriously Dave that's just awsome. Now I just have to forget half of what I've learned in the past few weeks and wrap my brain around this!</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p8722" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile8722">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberliste2cd.html?mode=viewprofile&amp;u=2453" class="username">Ed Dyreen</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search0d5e.html?author_id=2453&amp;sr=posts">1497</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 16 May 2011 08:21</dd>		
		
																<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Flanders(Belgium)</dd>
							
							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact Ed Dyreen">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact Ed Dyreen</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="http://ed-dyreen.ddns.net/" title="Website" class="last-cell">
										<span class="contact-icon phpbb_website-icon">Website</span>
									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content8722">

						<h3 ><a href="#p8722">Re: Batch &quot;macros&quot; with arguments</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingc8c1-2.html?mode=quote&amp;f=3&amp;p=8722" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic7217.html?p=8722#p8722" onclick="prompt('Message #35',this.href); return false;">#35</a></span> 
									<a class="unread" href="viewtopic7217.html?p=8722#p8722" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberliste2cd.html?mode=viewprofile&amp;u=2453" class="username">Ed Dyreen</a></strong> &raquo; </span>24 Jun 2011 12:03
			</p>
			
			
			
			<div class="content">☺<br />Dave, this is <span style="color: #0000BF">GOOD</span> input, I have been avoiding the PassAnyVariable over EndLocal for a while.<br />Like Jeb, I just didn't think it was possible. <img class="smilies" src="images/smilies/icon_rolleyes.gif" alt=":roll:" title="Rolling Eyes" /> <br />I need some time off now to study and crush this code down, see the basic tricks in action, assimilate. <img class="smilies" src="images/smilies/icon_mrgreen.gif" alt=":mrgreen:" title="Mr. Green" /></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p8723" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile8723">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content8723">

						<h3 ><a href="#p8723">Re: Batch &quot;macros&quot; with arguments</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting358b.html?mode=quote&amp;f=3&amp;p=8723" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicf548.html?p=8723#p8723" onclick="prompt('Message #36',this.href); return false;">#36</a></span> 
									<a class="unread" href="viewtopicf548.html?p=8723#p8723" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>24 Jun 2011 12:29
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>Ed Dyreen wrote:</cite>I have been avoiding the PassAnyVariable over EndLocal for a while. Like Jeb, I just didn't think it was possible. <img class="smilies" src="images/smilies/icon_rolleyes.gif" alt=":roll:" title="Rolling Eyes" /> <br /></div></blockquote><br />Actually I am using jeb's algorithms. He is the one that showed me how to do this for functions. I just encapsulated his methods into macros, with a few modifications to account for peculiarities of macro design.<br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p8754" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile8754">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberliste2cd.html?mode=viewprofile&amp;u=2453" class="username">Ed Dyreen</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search0d5e.html?author_id=2453&amp;sr=posts">1497</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 16 May 2011 08:21</dd>		
		
																<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Flanders(Belgium)</dd>
							
							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact Ed Dyreen">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact Ed Dyreen</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="http://ed-dyreen.ddns.net/" title="Website" class="last-cell">
										<span class="contact-icon phpbb_website-icon">Website</span>
									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content8754">

						<h3 ><a href="#p8754">Re: Batch &quot;macros&quot; with arguments</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingab67.html?mode=quote&amp;f=3&amp;p=8754" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicf4d2-2.html?p=8754#p8754" onclick="prompt('Message #37',this.href); return false;">#37</a></span> 
									<a class="unread" href="viewtopicf4d2-2.html?p=8754#p8754" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberliste2cd.html?mode=viewprofile&amp;u=2453" class="username">Ed Dyreen</a></strong> &raquo; </span>26 Jun 2011 08:10
			</p>
			
			
			
			<div class="content">'<br />I will need to take your code apart benham, I can't run this batch on XP !<br />You violated some simple rules that make it won't work on XP !<br />first of all, this can't be done in XP like that:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>set &quot;^getvar=do ( %\n%<br />&nbsp; &nbsp; set return=!%%a! %\n%<br />)&quot;<br /><br />for %%a in (&quot;var&quot;) %@getvar%<br /></code></pre></div>%%a won't expand on XP like that, I don't know why, but I need to replace it with %%b to get the desired results on an XP and there are more pecularities...<br /><br />Ok, so i figured out you replace &lt;LF&gt; with %~4, and I can get the desired result with<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>for %%4 in ( &quot;!$LF!&quot; ) do set &quot;result=%result%&quot;<br /></code></pre></div><span style="color: #FF0000">But it only works outside my macro ?, I tried this inside the macro and it fail:</span><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>for %%4 in ( &quot;!$LF!&quot; ) do call set &quot;result=%%result%%&quot;</code></pre></div></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p8756" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile8756">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist562d.html?mode=viewprofile&amp;u=2357" class="username">Cleptography</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search9546.html?author_id=2357&amp;sr=posts">287</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 16 Mar 2011 19:17</dd>		
		
																<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> scriptingpros.com</dd>
							
							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact Cleptography">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact Cleptography</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="https://www.scriptingpros.com.com/" title="Website" class="last-cell">
										<span class="contact-icon phpbb_website-icon">Website</span>
									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content8756">

						<h3 ><a href="#p8756">Re: Batch &quot;macros&quot; with arguments</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting038d.html?mode=quote&amp;f=3&amp;p=8756" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic79b3-2.html?p=8756#p8756" onclick="prompt('Message #38',this.href); return false;">#38</a></span> 
									<a class="unread" href="viewtopic79b3-2.html?p=8756#p8756" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist562d.html?mode=viewprofile&amp;u=2357" class="username">Cleptography</a></strong> &raquo; </span>26 Jun 2011 08:30
			</p>
			
			
			
			<div class="content"><img class="smilies" src="images/smilies/icon_mrgreen.gif" alt=":mrgreen:" title="Mr. Green" /></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p8763" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile8763">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content8763">

						<h3 ><a href="#p8763">Re: Batch &quot;macros&quot; with arguments</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting12f6.html?mode=quote&amp;f=3&amp;p=8763" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic59ea.html?p=8763#p8763" onclick="prompt('Message #39',this.href); return false;">#39</a></span> 
									<a class="unread" href="viewtopic59ea.html?p=8763#p8763" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>26 Jun 2011 16:23
			</p>
			
			
			
			<div class="content">OK, sorry everyone. At one point I had everything working but not with a consistent design and style. In trying to make everything consistent I broke the macro.Rtn1 routine and didn't test enough before posting.   <img class="smilies" src="images/smilies/icon_evil.gif" alt=":evil:" title="Evil or Very Mad" />  <img class="smilies" src="images/smilies/icon_redface.gif" alt=":oops:" title="Embarassed" /> <br /><br />I edited my earlier post and fixed the bug.<br />Here is the bugged line in macro.Rtn1 in macroLib_Return.bat:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&nbsp; if &quot;%%~d&quot; equ &quot;&quot; (%echo%!macro.Rtn1.rtn!) else if defined macro.Rtn1.rtn if not defined macro_NotDelayed (%\n%<br /></code></pre></div><br />And here is the fixed line:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&nbsp; if &quot;%%~d&quot; equ &quot;&quot; (%echo%!rtn!) else if defined rtn if not defined macro_NotDelayed (%\n%<br /></code></pre></div><br /><br />Ed - I've verified that the macros do work just fine on XP.<br /><br />Upon request -below is a single file that demonstrates how to use macro.Rtn1 and macro.AnyRtn1. All of the macros are straight from my (fixed) earlier posted libraries. I only included what was necessary to make the test work, and everything included is necessary. The macros in this test batch are local to the batch - they will not persist after the batch terminates because they were defined after SETLOCAL.<br /><br />Macro definitions that include other macros are defined with delayed expansion enabled. See the documentation on macro.EndDef in macroLib_Return.bat for help on how to make these macros persist after the batch file terminates.<br /><br />After the sample output I have the exact same test file except it doesn't include the macros definitions. Instead it loads the macros using the libraries as originally intended.<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />cls<br /><br />::::::::::::::::::::::::::::::::::::::::::::::::::::::::::<br />:: FIRST DEFINE THE MACROS<br />::<br />setlocal disableDelayedExpansion<br /><br />set LF=^<br /><br /><br />::Above 2 blank lines are required - do not remove<br />for /f %%a in ('copy /Z &quot;%~dpf0&quot; nul') do set &quot;CR=%%a&quot;<br />set ^&quot;\n=^^^%LF%%LF%^%LF%%LF%^^&quot;<br />set &quot;echo=echo(&quot;<br />set macro_ForEntireLine=^^^^^^^&quot;eol^^^^=^^^^^^^%LF%%LF%^%LF%%LF%^^^%LF%%LF%^%LF%%LF%^^^^ delims^^^^=^^^^^^^&quot;<br />set macro_Call=for /f &quot;tokens=1-26&quot; %%a in<br /><br />set macro_InitRtn=setlocal^&amp;set &quot;macro_NotDelayed=!&quot;^&amp;set &quot;macro_inFcn=&quot;<br />set &quot;macro_EndAnyRtnPrefix=for /f &quot;tokens=1-3&quot; %%1 in (&quot;!replace!&quot;) do for %%4 in (&quot;!LF!&quot;) do &quot;<br /><br />set macro.Rtn1=do (%\n%<br />&nbsp; setlocal enableDelayedExpansion%\n%<br />&nbsp; set /a &quot;macro.Rtn1.ErrLvl=(%%~a), macro.Rtn1.EndLocalCnt=(%%~b)+2&quot;%\n%<br />&nbsp; set &quot;rtn=!%%~c!&quot;%\n%<br />&nbsp; if defined macro_inFcn (%\n%<br />&nbsp; &nbsp; &nbsp; set &quot;errCmd=exit /b !macro.Rtn1.ErrLvl!&quot;%\n%<br />&nbsp; ) else if &quot;!macro.Rtn1.ErrLvl!&quot; == &quot;0&quot; (%\n%<br />&nbsp; &nbsp; &nbsp; set &quot;errCmd=rem&quot;%\n%<br />&nbsp; ) else if &quot;!macro.Rtn1.ErrLvl!&quot; == &quot;1&quot; (%\n%<br />&nbsp; &nbsp; &nbsp; set &quot;errCmd=set =&quot;%\n%<br />&nbsp; ) else (%\n%<br />&nbsp; &nbsp; &nbsp; set &quot;errCmd=cmd /d /c exit !macro.Rtn1.ErrLvl!&quot;%\n%<br />&nbsp; )%\n%<br />&nbsp; if &quot;%%~d&quot; equ &quot;&quot; (%echo%!rtn!) else if defined rtn if not defined macro_NotDelayed (%\n%<br />&nbsp; &nbsp; set &quot;rtn=!rtn:^=^^!&quot;%\n%<br />&nbsp; &nbsp; set &quot;rtn=!rtn:&quot;=&quot;&quot;Q!^&quot;%\n%<br />&nbsp; &nbsp; call set &quot;rtn=%%^rtn:^!=&quot;&quot;E^!%%&quot; ! %\n%<br />&nbsp; &nbsp; set &quot;rtn=!rtn:&quot;&quot;E=^!&quot;%\n%<br />&nbsp; &nbsp; set &quot;rtn=!rtn:&quot;&quot;Q=&quot;!^&quot;%\n%<br />&nbsp; )%\n%<br />&nbsp; for /f &quot;delims=&quot; %%e in (&quot;!errCmd!&quot;) do for /f %macro_ForEntireLine% %%v in (&quot;&quot;!rtn!&quot;&quot;) do (%\n%<br />&nbsp; &nbsp; for /l %%n in (1,1,!macro.Rtn1.EndLocalCnt!) do endlocal%\n%<br />&nbsp; &nbsp; if &quot;%%~d&quot; neq &quot;&quot; set &quot;%%~d=%%~v&quot; !%\n%<br />&nbsp; &nbsp; %%e 2^&gt;nul%\n%<br />&nbsp; )%\n%<br />)<br /><br />set macro.AnyRtn1=do (%\n%<br />&nbsp; setlocal enableDelayedExpansion%\n%<br />&nbsp; set /a &quot;macro.AnyRtn1.ErrLvl=(%%~a), macro.AnyRtn1.EndLocalCnt=(%%~b)&quot;%\n%<br />&nbsp; set &quot;rtn=!%%~c!&quot;%\n%<br />&nbsp; set ^&quot;replace=%% ^&quot;^&quot;^&quot; !CR!!CR!^&quot;%\n%<br />&nbsp; set &quot;macro_EndAnyRtn=!macro_EndAnyRtnPrefix!endlocal&amp;endlocal&quot;%\n%<br />&nbsp; for /l %%N in (1,1,!macro.AnyRtn1.EndLocalCnt!) do set &quot;macro_EndAnyRtn=!macro_EndAnyRtn!&amp;endlocal&quot;%\n%<br />&nbsp; if &quot;%%~d&quot; equ &quot;&quot; (%echo%!rtn!) else (%\n%<br />&nbsp; &nbsp; if defined rtn (%\n%<br />&nbsp; &nbsp; &nbsp; set &quot;rtn=!rtn:%%=%%~1!&quot;%\n%<br />&nbsp; &nbsp; &nbsp; set ^&quot;rtn=!rtn:^&quot;=%%~2!^&quot;%\n%<br />&nbsp; &nbsp; &nbsp; if defined CR for %%A in (&quot;!CR!&quot;) do set &quot;rtn=!rtn:%%~A=%%~3!&quot;%\n%<br />&nbsp; &nbsp; &nbsp; for %%A in (&quot;!LF!&quot;) do set &quot;rtn=!rtn:%%~A=%%~4!&quot;%\n%<br />&nbsp; &nbsp; &nbsp; if not defined macro_NotDelayed (%\n%<br />&nbsp; &nbsp; &nbsp; &nbsp; set &quot;rtn=!rtn:^=^^!&quot;%\n%<br />&nbsp; &nbsp; &nbsp; &nbsp; call set &quot;rtn=%%^rtn:^!=&quot;&quot;^!%%&quot; ! %\n%<br />&nbsp; &nbsp; &nbsp; &nbsp; set &quot;rtn=!rtn:&quot;&quot;=^!&quot;%\n%<br />&nbsp; &nbsp; &nbsp; )%\n%<br />&nbsp; &nbsp; )%\n%<br />&nbsp; &nbsp; set &quot;macro_EndAnyRtn=!macro_EndAnyRtn!&amp;set &quot;%%~d=!rtn!&quot; ^!&quot;%\n%<br />&nbsp; )%\n%<br />&nbsp; if defined macro_inFcn (%\n%<br />&nbsp; &nbsp; &nbsp; set &quot;macro_EndAnyRtn=!macro_EndAnyRtn!&amp;exit /b !macro.AnyRtn1.ErrLvl!&quot;%\n%<br />&nbsp; ) else if &quot;!macro.AnyRtn1.ErrLvl!&quot; == &quot;1&quot; (%\n%<br />&nbsp; &nbsp; &nbsp; set &quot;macro_EndAnyRtn=!macro_EndAnyRtn!&amp;(2&gt;nul set =)&quot;%\n%<br />&nbsp; ) else if &quot;!macro.AnyRtn1.ErrLvl!&quot; neq &quot;0&quot; (%\n%<br />&nbsp; &nbsp; &nbsp; set &quot;macro_EndAnyRtn=!macro_EndAnyRtn!&amp;cmd /d /c exit !macro.AnyRtn1.ErrLvl!&quot;%\n%<br />&nbsp; )%\n%<br />)<br /><br />::---------------------------------------------------------------------<br />:: The next 2 macros inlclude other macros so we need delayed expansion.<br />:: Normally this is done with %macro_BeginDef% at beginning and<br />:: %macro.EndDef% and %macro_EndAnyRtn% at end so that the macros<br />:: are installed in the cmd shell. But since these macros are only local<br />:: to this batch file I'll simply enable delayed expansion directly.<br /><br />setlocal enableDelayedExpansion<br /><br />set macro.ToUpper=do (%\n%<br />&nbsp; !macro_InitRtn!%\n%<br />&nbsp; setlocal enableDelayedExpansion%\n%<br />&nbsp; set &quot;str=^!%%~a^!&quot;%\n%<br />&nbsp; for %%A in (%\n%<br />&nbsp; &nbsp; &quot;a=A&quot; &quot;b=B&quot; &quot;c=C&quot; &quot;d=D&quot; &quot;e=E&quot; &quot;f=F&quot; &quot;g=G&quot; &quot;h=H&quot; &quot;i=I&quot;%\n%<br />&nbsp; &nbsp; &quot;j=J&quot; &quot;k=K&quot; &quot;l=L&quot; &quot;m=M&quot; &quot;n=N&quot; &quot;o=O&quot; &quot;p=P&quot; &quot;q=Q&quot; &quot;r=R&quot;%\n%<br />&nbsp; &nbsp; &quot;s=S&quot; &quot;t=T&quot; &quot;u=U&quot; &quot;v=V&quot; &quot;w=W&quot; &quot;x=X&quot; &quot;y=Y&quot; &quot;z=Z&quot; &quot;ä=Ä&quot;%\n%<br />&nbsp; &nbsp; &quot;ö=Ö&quot; &quot;ü=Ü&quot;%\n%<br />&nbsp; ) do set &quot;str=^!str:%%~A^!&quot;%\n%<br />&nbsp; !macro_Call! (&quot;^!errorlevel^! 1 str %%~b&quot;) !macro.Rtn1!%\n%<br />)<br /><br />set macro.AnyToUpper=do (%\n%<br />&nbsp; !macro_InitRtn!%\n%<br />&nbsp; setlocal enableDelayedExpansion%\n%<br />&nbsp; set &quot;str=^!%%~a^!&quot;%\n%<br />&nbsp; for %%A in (%\n%<br />&nbsp; &nbsp; &quot;a=A&quot; &quot;b=B&quot; &quot;c=C&quot; &quot;d=D&quot; &quot;e=E&quot; &quot;f=F&quot; &quot;g=G&quot; &quot;h=H&quot; &quot;i=I&quot;%\n%<br />&nbsp; &nbsp; &quot;j=J&quot; &quot;k=K&quot; &quot;l=L&quot; &quot;m=M&quot; &quot;n=N&quot; &quot;o=O&quot; &quot;p=P&quot; &quot;q=Q&quot; &quot;r=R&quot;%\n%<br />&nbsp; &nbsp; &quot;s=S&quot; &quot;t=T&quot; &quot;u=U&quot; &quot;v=V&quot; &quot;w=W&quot; &quot;x=X&quot; &quot;y=Y&quot; &quot;z=Z&quot; &quot;ä=Ä&quot;%\n%<br />&nbsp; &nbsp; &quot;ö=Ö&quot; &quot;ü=Ü&quot;%\n%<br />&nbsp; ) do set &quot;str=^!str:%%~A^!&quot;%\n%<br />&nbsp; !macro_Call! (&quot;^!errorlevel^! 1 str %%~b&quot;) !macro.AnyRtn1!%\n%<br />)<br />::<br />:: END OF MACRO DEFINITIONS<br />:::::::::::::::::::::::::::::::::::::::::::::::::::<br /><br />:::::::::::::::::::::::::::::::::::::::::::::::::::<br />:: NOW TEST THE MACROS<br />::<br />echo before ToUpper:<br />echo(<br />set macro_Call<br />echo(<br />set macro.Rtn1<br />echo(<br /><br />echo --------------------------------------------------<br />echo 1st with delayed expansion ENABLED<br />echo(<br />echo ToUpper Result - no return variable<br />%macro_Call% (&quot;macro_Call&quot;) %macro.ToUpper%<br />echo(<br />echo ToUpper Result - return in test<br />%macro_Call% (&quot;macro_Call test&quot;) %macro.ToUpper%<br />set test<br />:: The next calls return &lt;LF&gt; so we need the ANY version<br />:: followed by %macro_EndAnyRtn%<br />echo(<br />echo AnyToUpper Result - no return variable<br />%macro_Call% (&quot;macro.Rtn1&quot;) %macro.AnyToUpper%<br />%macro_EndAnyRtn%<br />echo(<br />echo AnyToUpper Result - return in test<br />%macro_Call% (&quot;macro.Rtn1 test&quot;) %macro.AnyToUpper%<br />%macro_EndAnyRtn%<br />set test<br /><br />setlocal disableDelayedExpansion<br />echo(<br />echo --------------------------------------------------<br />echo Now with delayed expansion DISABLED<br />echo(<br />echo ToUpper Result - no return variable<br />%macro_Call% (&quot;macro_Call&quot;) %macro.ToUpper%<br />echo(<br />echo ToUpper Result - return in test<br />%macro_Call% (&quot;macro_Call test&quot;) %macro.ToUpper%<br />set test<br />:: The next calls return &lt;LF&gt; so we need the ANY version<br />:: followed by %macro_EndAnyRtn%<br />echo(<br />echo AnyToUpper Result - no return variable<br />%macro_Call% (&quot;macro.Rtn1&quot;) %macro.AnyToUpper%<br />%macro_EndAnyRtn%<br />echo(<br />echo AnyToUpper Result - return in test<br />%macro_Call% (&quot;macro.Rtn1 test&quot;) %macro.AnyToUpper%<br />%macro_EndAnyRtn%<br />set test<br /></code></pre></div><br />Output:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>before ToUpper:<br /><br />macro_Call=for /f &quot;tokens=1-26&quot; %a in<br /><br />macro.Rtn1=do (<br />&nbsp; setlocal enableDelayedExpansion<br />&nbsp; set /a &quot;macro.Rtn1.ErrLvl=(%~a), macro.Rtn1.EndLocalCnt=(%~b)+2&quot;<br />&nbsp; set &quot;rtn=!%~c!&quot;<br />&nbsp; if defined macro_inFcn (<br />&nbsp; &nbsp; &nbsp; set &quot;errCmd=exit /b !macro.Rtn1.ErrLvl!&quot;<br />&nbsp; ) else if &quot;!macro.Rtn1.ErrLvl!&quot; == &quot;0&quot; (<br />&nbsp; &nbsp; &nbsp; set &quot;errCmd=rem&quot;<br />&nbsp; ) else if &quot;!macro.Rtn1.ErrLvl!&quot; == &quot;1&quot; (<br />&nbsp; &nbsp; &nbsp; set &quot;errCmd=set =&quot;<br />&nbsp; ) else (<br />&nbsp; &nbsp; &nbsp; set &quot;errCmd=cmd /d /c exit !macro.Rtn1.ErrLvl!&quot;<br />&nbsp; )<br />&nbsp; if &quot;%~d&quot; equ &quot;&quot; (echo(!rtn!) else if defined rtn if not defined macro_NotDelayed (<br />&nbsp; &nbsp; set &quot;rtn=!rtn:^=^^!&quot;<br />&nbsp; &nbsp; set &quot;rtn=!rtn:&quot;=&quot;&quot;Q!&quot;<br />&nbsp; &nbsp; call set &quot;rtn=%^rtn:^!=&quot;&quot;E^!%&quot; !<br />&nbsp; &nbsp; set &quot;rtn=!rtn:&quot;&quot;E=^!&quot;<br />&nbsp; &nbsp; set &quot;rtn=!rtn:&quot;&quot;Q=&quot;!&quot;<br />&nbsp; )<br />&nbsp; for /f &quot;delims=&quot; %e in (&quot;!errCmd!&quot;) do for /f ^&quot;eol^=^<br /><br />^ delims^=^&quot; %v in (&quot;&quot;!rtn!&quot;&quot;) do (<br />&nbsp; &nbsp; for /l %n in (1,1,!macro.Rtn1.EndLocalCnt!) do endlocal<br />&nbsp; &nbsp; if &quot;%~d&quot; neq &quot;&quot; set &quot;%~d=%~v&quot; !<br />&nbsp; &nbsp; %e 2&gt;nul<br />&nbsp; )<br />)<br /><br />--------------------------------------------------<br />1st with delayed expansion ENABLED<br /><br />ToUpper Result - no return variable<br />FOR /F &quot;TOKENS=1-26&quot; %A IN<br /><br />ToUpper Result - return in test<br />test=FOR /F &quot;TOKENS=1-26&quot; %A IN<br /><br />AnyToUpper Result - no return variable<br />DO (<br />&nbsp; SETLOCAL ENABLEDELAYEDEXPANSION<br />&nbsp; SET /A &quot;MACRO.RTN1.ERRLVL=(%~A), MACRO.RTN1.ENDLOCALCNT=(%~B)+2&quot;<br />&nbsp; SET &quot;RTN=!%~C!&quot;<br />&nbsp; IF DEFINED MACRO_INFCN (<br />&nbsp; &nbsp; &nbsp; SET &quot;ERRCMD=EXIT /B !MACRO.RTN1.ERRLVL!&quot;<br />&nbsp; ) ELSE IF &quot;!MACRO.RTN1.ERRLVL!&quot; == &quot;0&quot; (<br />&nbsp; &nbsp; &nbsp; SET &quot;ERRCMD=REM&quot;<br />&nbsp; ) ELSE IF &quot;!MACRO.RTN1.ERRLVL!&quot; == &quot;1&quot; (<br />&nbsp; &nbsp; &nbsp; SET &quot;ERRCMD=SET =&quot;<br />&nbsp; ) ELSE (<br />&nbsp; &nbsp; &nbsp; SET &quot;ERRCMD=CMD /D /C EXIT !MACRO.RTN1.ERRLVL!&quot;<br />&nbsp; )<br />&nbsp; IF &quot;%~D&quot; EQU &quot;&quot; (ECHO(!RTN!) ELSE IF DEFINED RTN IF NOT DEFINED MACRO_NOTDELAYED (<br />&nbsp; &nbsp; SET &quot;RTN=!RTN:^=^^!&quot;<br />&nbsp; &nbsp; SET &quot;RTN=!RTN:&quot;=&quot;&quot;Q!&quot;<br />&nbsp; &nbsp; CALL SET &quot;RTN=%^RTN:^!=&quot;&quot;E^!%&quot; !<br />&nbsp; &nbsp; SET &quot;RTN=!RTN:&quot;&quot;E=^!&quot;<br />&nbsp; &nbsp; SET &quot;RTN=!RTN:&quot;&quot;Q=&quot;!&quot;<br />&nbsp; )<br />&nbsp; FOR /F &quot;DELIMS=&quot; %E IN (&quot;!ERRCMD!&quot;) DO FOR /F ^&quot;EOL^=^<br /><br />^ DELIMS^=^&quot; %V IN (&quot;&quot;!RTN!&quot;&quot;) DO (<br />&nbsp; &nbsp; FOR /L %N IN (1,1,!MACRO.RTN1.ENDLOCALCNT!) DO ENDLOCAL<br />&nbsp; &nbsp; IF &quot;%~D&quot; NEQ &quot;&quot; SET &quot;%~D=%~V&quot; !<br />&nbsp; &nbsp; %E 2&gt;NUL<br />&nbsp; )<br />)<br /><br />AnyToUpper Result - return in test<br />test=DO (<br />&nbsp; SETLOCAL ENABLEDELAYEDEXPANSION<br />&nbsp; SET /A &quot;MACRO.RTN1.ERRLVL=(%~A), MACRO.RTN1.ENDLOCALCNT=(%~B)+2&quot;<br />&nbsp; SET &quot;RTN=!%~C!&quot;<br />&nbsp; IF DEFINED MACRO_INFCN (<br />&nbsp; &nbsp; &nbsp; SET &quot;ERRCMD=EXIT /B !MACRO.RTN1.ERRLVL!&quot;<br />&nbsp; ) ELSE IF &quot;!MACRO.RTN1.ERRLVL!&quot; == &quot;0&quot; (<br />&nbsp; &nbsp; &nbsp; SET &quot;ERRCMD=REM&quot;<br />&nbsp; ) ELSE IF &quot;!MACRO.RTN1.ERRLVL!&quot; == &quot;1&quot; (<br />&nbsp; &nbsp; &nbsp; SET &quot;ERRCMD=SET =&quot;<br />&nbsp; ) ELSE (<br />&nbsp; &nbsp; &nbsp; SET &quot;ERRCMD=CMD /D /C EXIT !MACRO.RTN1.ERRLVL!&quot;<br />&nbsp; )<br />&nbsp; IF &quot;%~D&quot; EQU &quot;&quot; (ECHO(!RTN!) ELSE IF DEFINED RTN IF NOT DEFINED MACRO_NOTDELAYED (<br />&nbsp; &nbsp; SET &quot;RTN=!RTN:^=^^!&quot;<br />&nbsp; &nbsp; SET &quot;RTN=!RTN:&quot;=&quot;&quot;Q!&quot;<br />&nbsp; &nbsp; CALL SET &quot;RTN=%^RTN:^!=&quot;&quot;E^!%&quot; !<br />&nbsp; &nbsp; SET &quot;RTN=!RTN:&quot;&quot;E=^!&quot;<br />&nbsp; &nbsp; SET &quot;RTN=!RTN:&quot;&quot;Q=&quot;!&quot;<br />&nbsp; )<br />&nbsp; FOR /F &quot;DELIMS=&quot; %E IN (&quot;!ERRCMD!&quot;) DO FOR /F ^&quot;EOL^=^<br /><br />^ DELIMS^=^&quot; %V IN (&quot;&quot;!RTN!&quot;&quot;) DO (<br />&nbsp; &nbsp; FOR /L %N IN (1,1,!MACRO.RTN1.ENDLOCALCNT!) DO ENDLOCAL<br />&nbsp; &nbsp; IF &quot;%~D&quot; NEQ &quot;&quot; SET &quot;%~D=%~V&quot; !<br />&nbsp; &nbsp; %E 2&gt;NUL<br />&nbsp; )<br />)<br /><br />--------------------------------------------------<br />Now with delayed expansion DISABLED<br /><br />ToUpper Result - no return variable<br />FOR /F &quot;TOKENS=1-26&quot; %A IN<br /><br />ToUpper Result - return in test<br />test=FOR /F &quot;TOKENS=1-26&quot; %A IN<br /><br />AnyToUpper Result - no return variable<br />DO (<br />&nbsp; SETLOCAL ENABLEDELAYEDEXPANSION<br />&nbsp; SET /A &quot;MACRO.RTN1.ERRLVL=(%~A), MACRO.RTN1.ENDLOCALCNT=(%~B)+2&quot;<br />&nbsp; SET &quot;RTN=!%~C!&quot;<br />&nbsp; IF DEFINED MACRO_INFCN (<br />&nbsp; &nbsp; &nbsp; SET &quot;ERRCMD=EXIT /B !MACRO.RTN1.ERRLVL!&quot;<br />&nbsp; ) ELSE IF &quot;!MACRO.RTN1.ERRLVL!&quot; == &quot;0&quot; (<br />&nbsp; &nbsp; &nbsp; SET &quot;ERRCMD=REM&quot;<br />&nbsp; ) ELSE IF &quot;!MACRO.RTN1.ERRLVL!&quot; == &quot;1&quot; (<br />&nbsp; &nbsp; &nbsp; SET &quot;ERRCMD=SET =&quot;<br />&nbsp; ) ELSE (<br />&nbsp; &nbsp; &nbsp; SET &quot;ERRCMD=CMD /D /C EXIT !MACRO.RTN1.ERRLVL!&quot;<br />&nbsp; )<br />&nbsp; IF &quot;%~D&quot; EQU &quot;&quot; (ECHO(!RTN!) ELSE IF DEFINED RTN IF NOT DEFINED MACRO_NOTDELAYED (<br />&nbsp; &nbsp; SET &quot;RTN=!RTN:^=^^!&quot;<br />&nbsp; &nbsp; SET &quot;RTN=!RTN:&quot;=&quot;&quot;Q!&quot;<br />&nbsp; &nbsp; CALL SET &quot;RTN=%^RTN:^!=&quot;&quot;E^!%&quot; !<br />&nbsp; &nbsp; SET &quot;RTN=!RTN:&quot;&quot;E=^!&quot;<br />&nbsp; &nbsp; SET &quot;RTN=!RTN:&quot;&quot;Q=&quot;!&quot;<br />&nbsp; )<br />&nbsp; FOR /F &quot;DELIMS=&quot; %E IN (&quot;!ERRCMD!&quot;) DO FOR /F ^&quot;EOL^=^<br /><br />^ DELIMS^=^&quot; %V IN (&quot;&quot;!RTN!&quot;&quot;) DO (<br />&nbsp; &nbsp; FOR /L %N IN (1,1,!MACRO.RTN1.ENDLOCALCNT!) DO ENDLOCAL<br />&nbsp; &nbsp; IF &quot;%~D&quot; NEQ &quot;&quot; SET &quot;%~D=%~V&quot; !<br />&nbsp; &nbsp; %E 2&gt;NUL<br />&nbsp; )<br />)<br /><br />AnyToUpper Result - return in test<br />test=DO (<br />&nbsp; SETLOCAL ENABLEDELAYEDEXPANSION<br />&nbsp; SET /A &quot;MACRO.RTN1.ERRLVL=(%~A), MACRO.RTN1.ENDLOCALCNT=(%~B)+2&quot;<br />&nbsp; SET &quot;RTN=!%~C!&quot;<br />&nbsp; IF DEFINED MACRO_INFCN (<br />&nbsp; &nbsp; &nbsp; SET &quot;ERRCMD=EXIT /B !MACRO.RTN1.ERRLVL!&quot;<br />&nbsp; ) ELSE IF &quot;!MACRO.RTN1.ERRLVL!&quot; == &quot;0&quot; (<br />&nbsp; &nbsp; &nbsp; SET &quot;ERRCMD=REM&quot;<br />&nbsp; ) ELSE IF &quot;!MACRO.RTN1.ERRLVL!&quot; == &quot;1&quot; (<br />&nbsp; &nbsp; &nbsp; SET &quot;ERRCMD=SET =&quot;<br />&nbsp; ) ELSE (<br />&nbsp; &nbsp; &nbsp; SET &quot;ERRCMD=CMD /D /C EXIT !MACRO.RTN1.ERRLVL!&quot;<br />&nbsp; )<br />&nbsp; IF &quot;%~D&quot; EQU &quot;&quot; (ECHO(!RTN!) ELSE IF DEFINED RTN IF NOT DEFINED MACRO_NOTDELAYED (<br />&nbsp; &nbsp; SET &quot;RTN=!RTN:^=^^!&quot;<br />&nbsp; &nbsp; SET &quot;RTN=!RTN:&quot;=&quot;&quot;Q!&quot;<br />&nbsp; &nbsp; CALL SET &quot;RTN=%^RTN:^!=&quot;&quot;E^!%&quot; !<br />&nbsp; &nbsp; SET &quot;RTN=!RTN:&quot;&quot;E=^!&quot;<br />&nbsp; &nbsp; SET &quot;RTN=!RTN:&quot;&quot;Q=&quot;!&quot;<br />&nbsp; )<br />&nbsp; FOR /F &quot;DELIMS=&quot; %E IN (&quot;!ERRCMD!&quot;) DO FOR /F ^&quot;EOL^=^<br /><br />^ DELIMS^=^&quot; %V IN (&quot;&quot;!RTN!&quot;&quot;) DO (<br />&nbsp; &nbsp; FOR /L %N IN (1,1,!MACRO.RTN1.ENDLOCALCNT!) DO ENDLOCAL<br />&nbsp; &nbsp; IF &quot;%~D&quot; NEQ &quot;&quot; SET &quot;%~D=%~V&quot; !<br />&nbsp; &nbsp; %E 2&gt;NUL<br />&nbsp; )<br />)<br /></code></pre></div><br /><br />Here is the same test using the libraries:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />cls<br /><br />if not defined macro\load.macroLib_String call macroLib_String<br /><br />echo before ToUpper:<br />echo(<br />set macro_Call<br />echo(<br />set macro.Rtn1<br />echo(<br /><br />setlocal enableDelayedExpansion<br />echo --------------------------------------------------<br />echo 1st with delayed expansion ENABLED<br />echo(<br />echo ToUpper Result - no return variable<br />%macro_Call% (&quot;macro_Call&quot;) %macro.ToUpper%<br />echo(<br />echo ToUpper Result - return in test<br />%macro_Call% (&quot;macro_Call test&quot;) %macro.ToUpper%<br />set test<br />:: The next calls return &lt;LF&gt; so we need the ANY version<br />:: followed by %macro_EndAnyRtn%<br />echo(<br />echo AnyToUpper Result - no return variable<br />%macro_Call% (&quot;macro.Rtn1&quot;) %macro.AnyToUpper%<br />%macro_EndAnyRtn%<br />echo(<br />echo AnyToUpper Result - return in test<br />%macro_Call% (&quot;macro.Rtn1 test&quot;) %macro.AnyToUpper%<br />%macro_EndAnyRtn%<br />set test<br />echo(<br /><br />setlocal disableDelayedExpansion<br />echo --------------------------------------------------<br />echo Now with delayed expansion DISABLED<br />echo(<br />echo ToUpper Result - no return variable<br />%macro_Call% (&quot;macro_Call&quot;) %macro.ToUpper%<br />echo(<br />echo ToUpper Result - return in test<br />%macro_Call% (&quot;macro_Call test&quot;) %macro.ToUpper%<br />set test<br />:: The next calls return &lt;LF&gt; so we need the ANY version<br />:: followed by %macro_EndAnyRtn%<br />echo(<br />echo AnyToUpper Result - no return variable<br />%macro_Call% (&quot;macro.Rtn1&quot;) %macro.AnyToUpper%<br />%macro_EndAnyRtn%<br />echo(<br />echo AnyToUpper Result - return in test<br />%macro_Call% (&quot;macro.Rtn1 test&quot;) %macro.AnyToUpper%<br />%macro_EndAnyRtn%<br />set test<br /></code></pre></div><br /><br /><span style="color: #0000FF">Edited 2011-Jun-27 - Removed unrelated additional commands from end of sample output. Eliminated unfinished comment from code.</span><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p8788" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile8788">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberliste2cd.html?mode=viewprofile&amp;u=2453" class="username">Ed Dyreen</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search0d5e.html?author_id=2453&amp;sr=posts">1497</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 16 May 2011 08:21</dd>		
		
																<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Flanders(Belgium)</dd>
							
							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact Ed Dyreen">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact Ed Dyreen</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="http://ed-dyreen.ddns.net/" title="Website" class="last-cell">
										<span class="contact-icon phpbb_website-icon">Website</span>
									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content8788">

						<h3 ><a href="#p8788">Re: Batch &quot;macros&quot; with arguments</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting3d0e.html?mode=quote&amp;f=3&amp;p=8788" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic494d.html?p=8788#p8788" onclick="prompt('Message #40',this.href); return false;">#40</a></span> 
									<a class="unread" href="viewtopic494d.html?p=8788#p8788" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberliste2cd.html?mode=viewprofile&amp;u=2453" class="username">Ed Dyreen</a></strong> &raquo; </span>28 Jun 2011 12:18
			</p>
			
			
			
			<div class="content">'<br />I created some macros, and succesfully pushed them over the endlocal border <img class="smilies" src="images/smilies/icon_cool.gif" alt="8)" title="Cool" /> <br /><br />But now I am trying to push a macro that seems to be too big.<br />Not at definition phase, not at execution phase, but while pushing it over it grows too big.<br />For every &quot; is replaced with %~1 = 3chars instead of one etc...<br /><br />I succeeded in getting the macro replaced by using arrays, but the final line is too big &amp;I can't solve it <br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>for %%! in ( &quot;!$replace!&quot; ) do (<br /><br />&nbsp; &nbsp;set &quot;@Macro=%@Macro.1%%@Macro.2%&quot;<br />)</code></pre></div>error: The inputline is too big<br /><br />I was thinking that maybe using a helperfile ?, but I really have no idea <img class="smilies" src="images/smilies/icon_neutral.gif" alt=":|" title="Neutral" /></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p8793" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile8793">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content8793">

						<h3 ><a href="#p8793">Re: Batch &quot;macros&quot; with arguments</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting430b.html?mode=quote&amp;f=3&amp;p=8793" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicba57.html?p=8793#p8793" onclick="prompt('Message #41',this.href); return false;">#41</a></span> 
									<a class="unread" href="viewtopicba57.html?p=8793#p8793" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>28 Jun 2011 15:01
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>Ed Dyreen wrote:</cite>I created some macros, and succesfully pushed them over the endlocal border  <img class="smilies" src="images/smilies/icon_cool.gif" alt="8)" title="Cool" /> <br /></div></blockquote>I'm glad you got it working  <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /> <br /><br /><br /><blockquote><div><cite>Ed Dyreen wrote:</cite>But now I am trying to push a macro that seems to be too big.<br />Not at definition phase, not at execution phase, but while pushing it over it grows too big.<br />For every &quot; is replaced with %~1 = 3chars instead of one etc...<br /><br />I succeeded in getting the macro replaced by using arrays, but the final line is too big &amp;I can't solve it<br /></div></blockquote>Do you mean that the macro gets defined, but when you try to use %macro.EndDef% followed by %macro_EndAnyRtn% ( or whatever you have replaced them with) it fails <img class="smilies" src="images/smilies/icon_question.gif" alt=":?:" title="Question" /> <br /><br />Whatever your situation, I think the size of the string that can be passed will be less than 8192 depending on the amount of substitution that must take place. If it is failing for you then you are probably near the hard limit anyway even without substitution. The substitution just takes it over the edge. (I'm sure someone could design a worst case problematic string that is far less than 8192 in length, but that doesn't seem like a real world situation).<br /><br /><br /><blockquote><div><cite>Ed Dyreen wrote:</cite>I was thinking that maybe using a helperfile ?, but I really have no idea  <img class="smilies" src="images/smilies/icon_neutral.gif" alt=":|" title="Neutral" /> <br /></div></blockquote>You mean a temporary batch file  <img class="smilies" src="images/smilies/icon_question.gif" alt=":?:" title="Question" />   That seems like it should work, but I try to avoid them.<br /><br />If this is a failure of defining a macro &quot;calling&quot; another macro at macro.EndDef time, then maybe it is time to switch to actually calling the referenced macro via your function instead of including it via delayed expansion.<br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p8794" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile8794">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberliste2cd.html?mode=viewprofile&amp;u=2453" class="username">Ed Dyreen</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search0d5e.html?author_id=2453&amp;sr=posts">1497</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 16 May 2011 08:21</dd>		
		
																<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Flanders(Belgium)</dd>
							
							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact Ed Dyreen">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact Ed Dyreen</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="http://ed-dyreen.ddns.net/" title="Website" class="last-cell">
										<span class="contact-icon phpbb_website-icon">Website</span>
									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content8794">

						<h3 ><a href="#p8794">Re: Batch &quot;macros&quot; with arguments</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting18d1.html?mode=quote&amp;f=3&amp;p=8794" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicfc8d.html?p=8794#p8794" onclick="prompt('Message #42',this.href); return false;">#42</a></span> 
									<a class="unread" href="viewtopicfc8d.html?p=8794#p8794" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberliste2cd.html?mode=viewprofile&amp;u=2453" class="username">Ed Dyreen</a></strong> &raquo; </span>28 Jun 2011 15:15
			</p>
			
			
			
			<div class="content">☺<br /><blockquote class="uncited"><div>If this is a failure of defining a macro &quot;calling&quot; another macro at macro.EndDef time, then maybe it is time to switch to actually calling the referenced macro via your function instead of including it via delayed expansion.<br /></div></blockquote>Function ?, how do I write a function in batch ?  <img class="smilies" src="images/smilies/icon_twisted.gif" alt=":twisted:" title="Twisted Evil" /> <span style="color: #0000BF">I know of only one function, a function that calls macros.</span><br /><br />Oops, you assume I used your code. No I just studied it for 3days, crushed it down to it's elements and rebuild it using my own preferences. I never use other peoples codes, especially if I don't understand it. This is how I build it, it needs an index:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&nbsp; &nbsp;set ^&quot;@AdvancedReturn=do ( %$n1c%<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;set &quot;$NotDelayedFlag=!&quot; %$n1c%<br />&nbsp; &nbsp;&nbsp; &nbsp;setlocal EnableDelayedExpansion %$n1c%<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;set &quot;$token=%%~!&quot; %$n1c%<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;set &quot;$RetVar=!$token!&quot; %$n1c%<br />&nbsp; &nbsp;&nbsp; &nbsp;set &quot;$RetVal=!%%~!!&quot; %$n1c%<br />&nbsp; &nbsp;&nbsp; &nbsp;^&gt;nul echo.$RetVal=!$RetVal! %$n1c%<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;if defined $RetVal ( %$n1c%<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;set &quot;$RetVal=!$RetVal:%%=%%~1!&quot; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;%Replace by injection% %$n1c%<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;set ^&quot;$RetVal=!$RetVal:^&quot;=%%~2!^&quot; %$n1c%<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if defined $CR for %%r in (&quot;!$CR!&quot;) do set &quot;$RetVal=!$RetVal:%%~r=%%~3!&quot; %$n1c%<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;for %%r in (&quot;!$LF!&quot;) do set &quot;$RetVal=!$RetVal:%%~r=%%~4!&quot; %$n1c%<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if defined $NotDelayedFlag ( %$n1c%<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;set &quot;$RetVal=!$RetVal:^=^^!&quot; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;%Replace directly% %$n1c%<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;call set &quot;$RetVal=%%^$RetVal:^!=&quot;&quot;^!%%&quot; ! %$n1c%<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;set &quot;$RetVal=!$RetVal:&quot;&quot;=^!&quot; %$n1c%<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;set &quot;$RetVal=!$RetVal!^!&quot; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;%Make sure our escapes dissapear% %$n1c%<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;) else ( %$n1c%<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;set &quot;$RetVal=!$RetVal:^=^^^^!&quot; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;%Replace directly% %$n1c%<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;call set &quot;$RetVal=%%^$RetVal:^!=&quot;&quot;^!%%&quot; ! %$n1c%<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;set &quot;$RetVal=!$RetVal:&quot;&quot;=^^^!&quot; %$n1c%<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;set &quot;$RetVal=!$RetVal!^^^!&quot; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;%Make sure our escapes dissapear% %$n1c%<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;) %$n1c%<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;) %$n1c%<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;for %%? in ( %$n1c%<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;!$RetVar!&quot; %$n1c%<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;) do &nbsp; &nbsp;%@MForEntireLine% ( %$n1c%<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&quot;&quot;!$RetVal!&quot;&quot; %$n1c%<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;) do ( %$n1c%<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;endlocal %$n1c%<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;set &quot;#%%~?=%%~r&quot; %$n1c%<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;echo.set &quot;#%%~?=%%~r&quot; %$n1c%<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;) %$n1c%<br />&nbsp; &nbsp;)&quot;<br /></code></pre></div><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&nbsp; &nbsp;set $Variable.Index=<br />&nbsp; &nbsp;::<br />&nbsp; &nbsp;echo. Building Index...<br />&nbsp; &nbsp;set $Variable.Index=^<br />%&nbsp; &nbsp;% $LF^<br />%&nbsp; &nbsp;% $CR^<br />%&nbsp; &nbsp;% $n0^<br />etc..<br />%&nbsp; &nbsp;% @AdvancedReturn^<br />%&nbsp; &nbsp;% @TestAdvancedReturn^<br />%&nbsp; &nbsp;% $Variable.Index<br />&nbsp; &nbsp;::<br />&nbsp; &nbsp;echo. Preparing involved variables...<br />&nbsp; &nbsp;for %%! in ( %$Variable.Index% ) %@AdvancedReturn%<br />&nbsp; &nbsp;echo. Making permanent...<br />&nbsp; &nbsp;setlocal EnableDelayedExpansion<br /><br />&nbsp; &nbsp;set &quot;$replace=%% &quot;&quot;&quot; ^!$CR^!^!$CR^!&quot;<br />&nbsp; &nbsp;::<br />&nbsp; &nbsp;for /f &quot;tokens=1-3&quot; %%1 in (<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&quot;!$replace!&quot;<br /><br />&nbsp; &nbsp;) do &nbsp; &nbsp;for %%4 in (<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&quot;!$LF!&quot;<br /><br />&nbsp; &nbsp;) do (<br />&nbsp; &nbsp;&nbsp; &nbsp;endlocal<br />&nbsp; &nbsp;&nbsp; &nbsp;endlocal<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;set &quot;$Variable.Index=%#$Variable.Index%&quot;<br />&nbsp; &nbsp;&nbsp; &nbsp;set &quot;$LF=%#$LF%&quot;<br />&nbsp; &nbsp;&nbsp; &nbsp;set &quot;$CR=%#$CR%&quot;<br />etc..<br />&nbsp; &nbsp;&nbsp; &nbsp;set &quot;@21nicho_#AsDLT=%#@21nicho_#AsDLT%&quot;<br />&nbsp; &nbsp;&nbsp; &nbsp;set &quot;@AdvancedReturn=%#@AdvancedReturn%&quot;<br />&nbsp; &nbsp;&nbsp; &nbsp;set &quot;@TestAdvancedReturn=%#@TestAdvancedReturn%&quot;<br />&nbsp; &nbsp;)<br />&nbsp; &nbsp;::<br />&nbsp; &nbsp;%@echo% This Works<br /></code></pre></div>I really don't care about the overhead a helperfile produces, <span style="color: #00BF00">It will only happen once for all involved variables</span> !<br />I just don't know (yet) how it could be done easily with the above example.<br /><br />I decided not to use your method because I simply want to push any variable over endlocal.<br />This way I find simpler, <span style="color: #0000BF">can you explain to me the cons and pros of my version against yours ?</span><br /><blockquote class="uncited"><div>Dealing with multiple optional arguments - In functions we can shift varying numbers of leading option arguments so that required arguments are always in standard positions after options have been processed. We don't have any correlary to the SHIFT command for macro options.<br /></div></blockquote>You really should take a look at my 'Ed's CMD v2.0 UDF beta' at <a href="http://www.scriptingpros.com/viewforum.php?f=152" class="postlink">http://www.scriptingpros.com/viewforum.php?f=152</a><br /><blockquote class="uncited"><div>:idea:  We could use the object attribute strategy here as well, but I don't really like it. I have a vague idea to pass all arguments as one string and then process the arguments with a dedicated &quot;load arguments&quot; macro. This macro would use a simple FOR loop to parse the arguments, but it would need special code to preserve * and ? characters. I'm not sure when (or if) I will get around to testing this.<br /></div></blockquote>That's exactly what @LeadIn and @LeadsIn is doing <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /> <br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>!@forEL! ( '%$Defines%, &quot;r#Name=%%~a&quot;, &quot;o#error.bool=%%~b&quot;' ) !@LeadIn! %$n1c%<br />%&nbsp; &nbsp;%&nbsp; #macro&nbsp; &nbsp; &nbsp;: required: callerfunc to push on $Debug.Array %$n1c%<br />%&nbsp; &nbsp;%&nbsp; r&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : optional: for element is required %$n1c%<br />%&nbsp; &nbsp;%&nbsp; o&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : optional: for element is optional %$n1c%<br />%&nbsp; &nbsp;%&nbsp; b&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : optional: 0 for optional, 1 for required %$n1c%<br />%&nbsp; &nbsp;%&nbsp; #&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : optional: for element is of type string %$n1c%<br />%&nbsp; &nbsp;%&nbsp; $&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : optional: for element is of type variable %$n1c%<br />%&nbsp; &nbsp;%&nbsp; ?&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : optional: for element is of type string v variable %$n1c%<br /></code></pre></div></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p8869" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile8869">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content8869">

						<h3 ><a href="#p8869">Re: Batch &quot;macros&quot; with arguments</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinga242.html?mode=quote&amp;f=3&amp;p=8869" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic58c9.html?p=8869#p8869" onclick="prompt('Message #43',this.href); return false;">#43</a></span> 
									<a class="unread" href="viewtopic58c9.html?p=8869#p8869" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>30 Jun 2011 23:16
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>Ed Dyreen wrote:</cite>Function ?, how do I write a function in batch ?   I know of only one function, a function that calls macros.</div></blockquote> Umm, like the functions that DosTips takes great pains to explain...  And your function that calls a macro is exactly what I had in mind.<br /><br /><blockquote><div><cite>Ed Dyreen wrote:</cite>Oops, you assume I used your code. </div></blockquote>No, I've seen enough of your posts to know better, hence my statement - &quot;or whatever you have replaced them with&quot;.<br /><br /><blockquote><div><cite>Ed Dyreen wrote:</cite>I decided not to use your method because I simply want to push any variable over endlocal.</div></blockquote> That is mostly all I want to do, I just added the ability to set the errorlevel as well.<br /><br /><blockquote><div><cite>Ed Dyreen wrote:</cite>This way I find simpler, can you explain to me the cons and pros of my version against yours ?</div></blockquote>I haven't completely traced your code, but it looks largely similar in function (certainly not style, but we knew that from before <img class="smilies" src="images/smilies/icon_lol.gif" alt=":lol:" title="Laughing" /> ) Here are major differences that I see:<br /><ul><li>You only encapsulated the 1st half of my RtnAny1 (or RtnAnyN) where you prepare the string to be returned. The last bit at the very end you have hard coded for specific variables. My goal was to build this last bit of code dynamically so that any macro or function can use it in a consistent manner without the need to write custom code. (what I call <strong class="text-strong">macro_EndAnyRtn</strong>). It seems to me your version requires new code be written every time you want to call <strong class="text-strong">@AdvancedReturn</strong>.</li><li>You are not allowing for a variable number of ENDLOCAL at the end. I sometimes find I need delayed expansion both enabled and disabled within one macro or function, so the ENDLOCAL count can vary.</li><li>You are missing the SETLOCAL prior to setting $NotDelayedFlag. This could cause problems if a macro or function calls another macro or function. The second call could corrupt the setting for the first call.</li></ul><br />It took me a while to realize you were using percents to add comments to your code - and it doesn't add to the length of the macro because it expands to nothing <img class="smilies" src="images/smilies/icon_exclaim.gif" alt=":!:" title="Exclamation" /> I hadn't seen that before <img class="smilies" src="images/smilies/icon_cool.gif" alt="8)" title="Cool" /><br /><br />You need to be careful - <a href="viewtopic59e2.html?f=3&amp;t=2009" class="postlink">your comment style doesn't seem to work if the comment contains a colon (:).</a><br /><br />Also, someone could define a variable name that matches your comment. You can prevent that if you add = since we can't include = in user defined variables. <strong class="text-strong">%= A comment like this with equals at beginning is safer%</strong> but <strong class="text-strong">%=c:%</strong> is a valid variable (there are a few more examples). To be absolutely sure your comment is safe you could include two = as in <strong class="text-strong">%= A secure way of commenting =%</strong>. Again, you still have problems if the comment contains a colon.<br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p8870" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile8870">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberliste2cd.html?mode=viewprofile&amp;u=2453" class="username">Ed Dyreen</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search0d5e.html?author_id=2453&amp;sr=posts">1497</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 16 May 2011 08:21</dd>		
		
																<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Flanders(Belgium)</dd>
							
							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact Ed Dyreen">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact Ed Dyreen</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="http://ed-dyreen.ddns.net/" title="Website" class="last-cell">
										<span class="contact-icon phpbb_website-icon">Website</span>
									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content8870">

						<h3 ><a href="#p8870">Re: Batch &quot;macros&quot; with arguments</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting27f3.html?mode=quote&amp;f=3&amp;p=8870" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic513b.html?p=8870#p8870" onclick="prompt('Message #44',this.href); return false;">#44</a></span> 
									<a class="unread" href="viewtopic513b.html?p=8870#p8870" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberliste2cd.html?mode=viewprofile&amp;u=2453" class="username">Ed Dyreen</a></strong> &raquo; </span>01 Jul 2011 00:04
			</p>
			
			
			
			<div class="content">☺<br />I've seen you doing it somewhere, but I can't find it anymore. I'm having a little problem:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&nbsp; &nbsp;set ^&quot;@Debug.on=( %$n1c%<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;set &quot;@DNul=&quot; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;%= A comment the way benham suggests :) =% %$n1c%<br />&nbsp; &nbsp;)&quot;<br />&nbsp; &nbsp;set ^&quot;@Debug.off=( %$n1c%<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;set &quot;@DNul=&gt;nul&quot; %$n1c%<br />&nbsp; &nbsp;)&quot;<br />&nbsp; &nbsp;set ^&quot;@TraceIn=do ( %$n1c%<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;^^^!@DNul^^^! echo.hello world %$n1c%<br />&nbsp; &nbsp;)&quot;<br />&nbsp; &nbsp;::<br />&nbsp; &nbsp;%@Debug.on%<br />&nbsp; &nbsp;%@forTS% ( &quot;yo&quot; ) %@TraceIn%<br />&nbsp; &nbsp;%@Debug.off%<br />&nbsp; &nbsp;%@forTS% ( &quot;yo&quot; ) %@TraceIn%<br />&nbsp; &nbsp;%@endoftest%<br /></code></pre></div>It doesn't work as expected, I need the contents send to nul if debugger is off  <img class="smilies" src="images/smilies/icon_sad.gif" alt=":(" title="Sad" /><br />This must be possible without using an if statement !</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p8878" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile8878">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content8878">

						<h3 ><a href="#p8878">Re: Batch &quot;macros&quot; with arguments</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinge1fc.html?mode=quote&amp;f=3&amp;p=8878" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic150d.html?p=8878#p8878" onclick="prompt('Message #45',this.href); return false;">#45</a></span> 
									<a class="unread" href="viewtopic150d.html?p=8878#p8878" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>01 Jul 2011 06:46
			</p>
			
			
			
			<div class="content">That only work with immediate expansion:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>echo stuff %@Dnul%<br /></code></pre></div><br />The following all fail because the redirection needs to be parsed before the expansion occurs:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>echo stuff !@Dnul!<br />call echo stuff !@Dnul!<br />call echo stuff %%@Dnul%%<br /></code></pre></div><br />I recommend defining an @dbug macro using IF and a $dbug switch:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />setlocal<br />cls<br />set &quot;@dbug=if defined $dbug echo(&quot;<br /><br />::test it<br />set &quot;@testDbug=%@dbug%Hello World<br />set &quot;$dbug=&quot;<br />echo First we get silence.<br />%@testDbug%<br />set &quot;$dbug=1&quot;<br />echo And finally a greeting!<br />%@testDbug%<br /></code></pre></div><br /><br /><blockquote><div><cite>Ed Dyreen wrote:</cite><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>%= A comment the way benham suggests :) =% <br /></code></pre></div></div></blockquote>I do NOT recommend that comment because it contains a colon. It will not work properly <img class="smilies" src="images/smilies/icon_exclaim.gif" alt=":!:" title="Exclamation" /><br />Take out the : and it works fine.<br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
	

	<div class="action-bar bar-bottom">
	
			<a href="posting762c.html?mode=reply&amp;f=3&amp;t=1827" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic6efe.html?f=3&amp;t=1827&amp;start=30&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

			<form method="post" action="https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=1827&amp;start=30">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			74 posts
							<ul>
			<li class="arrow previous"><a class="button button-icon-only" href="viewtopic39d3.html?f=3&amp;t=1827&amp;start=15" rel="prev" role="button"><i class="icon fa-chevron-left fa-fw" aria-hidden="true"></i><span class="sr-only">Previous</span></a></li>
				<li><a class="button" href="viewtopicbcaf.html?f=3&amp;t=1827" role="button">1</a></li>
				<li><a class="button" href="viewtopic39d3.html?f=3&amp;t=1827&amp;start=15" role="button">2</a></li>
			<li class="active"><span>3</span></li>
				<li><a class="button" href="viewtopica337.html?f=3&amp;t=1827&amp;start=45" role="button">4</a></li>
				<li><a class="button" href="viewtopicd76f.html?f=3&amp;t=1827&amp;start=60" role="button">5</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopica337.html?f=3&amp;t=1827&amp;start=45" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="viewforum4d6b.html?f=3" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to “DOS Batch Forum”</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="viewforum31e6.html?f=4" class="jumpbox-cat-link"> <span> DosTips - Dos Batch</span></a></li>
																<li><a href="viewforum4d6b.html?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; DOS Batch Forum</span></a></li>
											</ul>
		</div>
	</div>

	</div>


			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
							<span class="crumb"><a href="../index.html" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>DosTips.com</span></a></span>									<span class="crumb"><a href="index.html" data-navbar-reference="index"><span>Board index</span></a></span>					</li>
		
				<li class="rightside">All times are <span title="UTC-6">UTC-06:00</span></li>
							<li class="rightside">
				<a href="ucp033a.html?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete all board cookies</span>
				</a>
			</li>
												<li class="rightside" data-last-responsive="true">
				<a href="memberlist4bfd.html?mode=team" role="menuitem">
					<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
				</a>
			</li>
									<li class="rightside" data-last-responsive="true">
				<a href="memberlist8733.html?mode=contactadmin" role="menuitem">
					<i class="icon fa-envelope fa-fw" aria-hidden="true"></i><span>Contact us</span>
				</a>
			</li>
			</ul>

	</div>
</div>

	<div class="copyright">
				<!-- WARNING NO DELETE -->Style developer by <a href="http://tricolor.x-tk.ru/">support forum tricolor</a>, <!-- END WARNING NO DELETE -->Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
									</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	<img src="cron5495.gif?cron_type=cron.task.text_reparser.poll_title" width="1" height="1" alt="cron" /></div>

<script type="text/javascript" src="assets/javascript/jquery.mind772.js?assets_version=34"></script>
<script type="text/javascript" src="assets/javascript/cored772.js?assets_version=34"></script>



<script type="text/javascript" src="styles/prosilver/template/forum_fnd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/prosilver/template/ajaxd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/jquery-uid772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/collapsed772.js?assets_version=34"></script>



</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=1827&start=30 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 08:35:00 GMT -->
</html>
