<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=5198&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 09:14:00 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>DosTips.com &bull; Batch Wake-On-Lan</title>

<link href="styles/AllanStyle-SUBSILVER/theme/print.css" rel="stylesheet">
</head>
<body id="phpbb">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>DosTips.com</h1>
		<p>A Forum all about DOS Batch<br /><a href="index-2.html">https://www.dostips.com/forum/</a></p>

		<h2>Batch Wake-On-Lan</h2>
		<p><a href="viewtopicdafc.html?f=3&amp;t=5198">https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=5198</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>1</strong> of <strong>2</strong></div>
					<div class="post">
				<h3>Batch Wake-On-Lan</h3>
				<div class="date">Posted: <strong>24 Dec 2013 04:59</strong></div>
				<div class="author">by <strong>thephantomblu</strong></div>
				<div class="content">Is there any way to implement WOL functionality in batch without the need of third-party software?</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Batch Wake-On-Lan</h3>
				<div class="date">Posted: <strong>24 Dec 2013 05:05</strong></div>
				<div class="author">by <strong>ghostmachine4</strong></div>
				<div class="content"><blockquote><div><cite>thephantomblu wrote:</cite>Is there any way to implement WOL functionality in batch without the need of third-party software?</div></blockquote><br />you can do that with a vb script. I personally have not tried it but you can download the code <a href="http://community.spiceworks.com/scripts/show/240-script-to-enable-wake-on-lan-windows" class="postlink">here</a>.<br /><br />save it as something.vbs , edit the settings to your liking and execute<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>c:\&gt; cscript //nologo something.vbs<br /></code></pre></div></div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Batch Wake-On-Lan</h3>
				<div class="date">Posted: <strong>24 Dec 2013 05:13</strong></div>
				<div class="author">by <strong>thephantomblu</strong></div>
				<div class="content">No, you misunderstood me.<br /><br />Is there any way you can <strong class="text-strong">send</strong> WOL packets through batch without third-party software?</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Batch Wake-On-Lan</h3>
				<div class="date">Posted: <strong>24 Dec 2013 05:35</strong></div>
				<div class="author">by <strong>ghostmachine4</strong></div>
				<div class="content"><blockquote><div><cite>thephantomblu wrote:</cite>No, you misunderstood me.<br /><br />Is there any way you can <strong class="text-strong">send</strong> WOL packets through batch without third-party software?</div></blockquote><br /><br />To send WOL packets programmatically you need the UDP protocol and for that you need to program using a language that support the UDP packet programming. If you really cannot use any other third party software (note, vbscript is installed by default and to me not considered third party),  vbscript (or powershell) is your best bet. vbscript doesn't support sockets natively but you can call activex/com control ( Mswinsck.ocx etc ? Please research google for more) . if you have powershell on newer systems, you can make use of .Net libraries System.Net.Sockets API.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Batch Wake-On-Lan</h3>
				<div class="date">Posted: <strong>24 Dec 2013 05:44</strong></div>
				<div class="author">by <strong>thephantomblu</strong></div>
				<div class="content"><blockquote><div><cite>ghostmachine4 wrote:</cite>To send WOL packets programmatically you need the UDP protocol and for that you need to program using a language that support the UDP packet programming. If you really cannot use any other third party software (note, vbscript is installed by default and to me not considered third party),  vbscript (or powershell) is your best bet. vbscript doesn't support sockets natively but you can call activex/com control ( Mswinsck.ocx etc ? Please research google for more) . if you have powershell on newer systems, you can make use of .Net libraries System.Net.Sockets API.</div></blockquote><br /><br />Oh, okay. I will see if I can get anything about vbscript on Google. Thanks for the reply!</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Batch Wake-On-Lan</h3>
				<div class="date">Posted: <strong>24 Dec 2013 06:31</strong></div>
				<div class="author">by <strong>penpen</strong></div>
				<div class="content">Maybe this is what you are searching for:<br /><a href="http://analects.jeffharbert.com/a-vbscript-wake-on-lan-project/" class="postlink">http://analects.jeffharbert.com/a-vbscript-wake-on-lan-project/</a>.<br />(Especially the last script at the bottom of this page.)<br /><br />penpen</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Batch Wake-On-Lan</h3>
				<div class="date">Posted: <strong>24 Dec 2013 08:18</strong></div>
				<div class="author">by <strong>thephantomblu</strong></div>
				<div class="content"><blockquote><div><cite>penpen wrote:</cite>Maybe this is what you are searching for:<br /><a href="http://analects.jeffharbert.com/a-vbscript-wake-on-lan-project/" class="postlink">http://analects.jeffharbert.com/a-vbscript-wake-on-lan-project/</a>.<br />(Especially the last script at the bottom of this page.)<br /><br />penpen</div></blockquote><br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>Set objShell=CreateObject(“wscript.shell”)<br />strCommand=”C:\scripts\wol.exe” &amp; strMAC<br />Set objExec=objShell.Exec(strCommand)</code></pre></div><br /><br />It uses an external application wol.exe. Any other ideas?</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Batch Wake-On-Lan</h3>
				<div class="date">Posted: <strong>24 Dec 2013 09:16</strong></div>
				<div class="author">by <strong>penpen</strong></div>
				<div class="content">Sry, haven't inspected the source above fully (beside wol can be downloaded from <a href="http://www.gammadyne.com/cmdline.htm" class="postlink">http://www.gammadyne.com/cmdline.htm</a>).<br /><br />But maybe this may help you:<br /><a href="http://stackoverflow.com/questions/19508431/sending-magic-packet-with-vbs" class="postlink">http://stackoverflow.com/questions/19508431/sending-magic-packet-with-vbs</a><br />(This should be a VB.NET source file, if i see it right.)<br /><br />Additionally you may save this batch file as vbc.bat:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>:main<br />&nbsp; &nbsp;@echo off<br />&nbsp; &nbsp;setlocal<br />&nbsp; &nbsp;cls<br /><br />&nbsp; &nbsp;set &quot;vbc=&quot;<br /><br />&nbsp; &nbsp;pushd &quot;%SystemRoot%\Microsoft.NET\Framework&quot;<br />&nbsp; &nbsp;for /f &quot;tokens=* delims=&quot; %%i in ('dir /b /o:n &quot;v*&quot;') do (<br />&nbsp; &nbsp;&nbsp; &nbsp;dir /a-d /b &quot;%%~fi\vbc.exe&quot; &gt;nul 2&gt;&amp;1 &amp;&amp; set &quot;vbc=&quot;%%~fi\vbc.exe&quot;&quot;<br />&nbsp; &nbsp;)<br />&nbsp; &nbsp;popd<br /><br />&nbsp; &nbsp;if defined vbc (<br />&nbsp; &nbsp;&nbsp; &nbsp;echo most recent VB.NET compiler located in:<br />&nbsp; &nbsp;&nbsp; &nbsp;echo %vbc%.<br />&nbsp; &nbsp;) else (<br />&nbsp; &nbsp;&nbsp; &nbsp;echo VB.NET compiler not found.<br />&nbsp; &nbsp;&nbsp; &nbsp;goto :eof<br />&nbsp; &nbsp;)<br /><br />&nbsp; &nbsp;%vbc% /nologo /target:exe /out:&quot;%~f1.exe&quot; &quot;%~f1.vb&quot;<br />&nbsp; &nbsp;goto :eof<br /></code></pre></div>and compile the linked script using vbc.bat.<br /><br />penpen<br /><br />Edit: The .net framework has to be installed.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Batch Wake-On-Lan</h3>
				<div class="date">Posted: <strong>24 Dec 2013 14:21</strong></div>
				<div class="author">by <strong>penpen</strong></div>
				<div class="content">To avoid compiling an executable file, a powershell 2.0 version can be found here:<br /><a href="http://social.technet.microsoft.com/Forums/scriptcenter/en-US/51ef86e5-f3d4-459c-a08a-615c669aff2e/script-to-turn-on-wake-on-magic-packet-from-off-state?forum=ITCG" class="postlink">http://social.technet.microsoft.com/Forums/scriptcenter/en-US/51ef86e5-f3d4-459c-a08a-615c669aff2e/script-to-turn-on-wake-on-magic-packet-from-off-state?forum=ITCG</a><br /><br />penpen</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Batch Wake-On-Lan</h3>
				<div class="date">Posted: <strong>24 Dec 2013 15:35</strong></div>
				<div class="author">by <strong>Squashman</strong></div>
				<div class="content">good to see there is a way to do it with Powershell.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Batch Wake-On-Lan</h3>
				<div class="date">Posted: <strong>24 Dec 2013 22:43</strong></div>
				<div class="author">by <strong>brianmadam</strong></div>
				<div class="content"><blockquote><div><cite>thephantomblu wrote:</cite>Is there any way to implement WOL functionality in batch without the need of third-party software?</div></blockquote><br />what system are you running on? If its newer version, <a href="http://blogs.technet.com/b/heyscriptingguy/archive/2011/01/07/how-do-i-install-powershell-on-windows-7-and-other-questions.aspx" class="postlink">check if you have powershell installed</a>.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Batch Wake-On-Lan</h3>
				<div class="date">Posted: <strong>24 Dec 2013 23:17</strong></div>
				<div class="author">by <strong>foxidrive</strong></div>
				<div class="content">Here's a powershell solution that may work:<br /><br /><!-- m --><a class="postlink" href="http://gallery.technet.microsoft.com/scriptcenter/Wake-On-Lan-815424c4">http://gallery.technet.microsoft.com/sc ... n-815424c4</a><!-- m --></div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Batch Wake-On-Lan</h3>
				<div class="date">Posted: <strong>25 Dec 2013 00:00</strong></div>
				<div class="author">by <strong>thephantomblu</strong></div>
				<div class="content">So I think there is absolutely <strong class="text-strong">NO</strong> way to do this in native batch.<br /><br /><blockquote><div><cite>penpen wrote:</cite>To avoid compiling an executable file, a powershell 2.0 version can be found here:<br /><a href="http://social.technet.microsoft.com/Forums/scriptcenter/en-US/51ef86e5-f3d4-459c-a08a-615c669aff2e/script-to-turn-on-wake-on-magic-packet-from-off-state?forum=ITCG" class="postlink">http://social.technet.microsoft.com/Forums/scriptcenter/en-US/51ef86e5-f3d4-459c-a08a-615c669aff2e/script-to-turn-on-wake-on-magic-packet-from-off-state?forum=ITCG</a><br /><br />penpen</div></blockquote><br /><br />penpen, can we call Powershell scripts in a batch file?<br /><br /><blockquote><div><cite>foxidrive wrote:</cite>Here's a powershell solution that may work:<br /><br /><!-- m --><a class="postlink" href="http://gallery.technet.microsoft.com/scriptcenter/Wake-On-Lan-815424c4">http://gallery.technet.microsoft.com/sc ... n-815424c4</a><!-- m --></div></blockquote><br /><br />Thanks. This code looks cleaner!</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Batch Wake-On-Lan</h3>
				<div class="date">Posted: <strong>25 Dec 2013 00:05</strong></div>
				<div class="author">by <strong>foxidrive</strong></div>
				<div class="content"><blockquote><div><cite>thephantomblu wrote:</cite>can we call Powershell scripts in a batch file?<br /></div></blockquote><br /><br />You can, though there can be issues with permissions and the default restrictions in Powershell.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Batch Wake-On-Lan</h3>
				<div class="date">Posted: <strong>25 Dec 2013 00:11</strong></div>
				<div class="author">by <strong>berserker</strong></div>
				<div class="content"><blockquote><div><cite>thephantomblu wrote:</cite><br />penpen, can we call Powershell scripts in a batch file?<br /></div></blockquote><br /><br />you can run powershell from batch. See <a href="http://stackoverflow.com/questions/19335004/how-to-run-a-powershell-script-from-a-batch-file" class="postlink">here</a></div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="UTC-6">UTC-06:00</span><br />Page <strong>1</strong> of <strong>2</strong></div>
		<div class="copyright">Powered by phpBB&reg; Forum Software &copy; phpBB Limited<br />https://www.phpbb.com/</div>
	</div>
</div>

</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=5198&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 09:14:00 GMT -->
</html>
