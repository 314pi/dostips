<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=7583 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 06:18:00 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>SendMessage.exe: Access to advanced Windows features - DosTips.com</title>


	<link rel="canonical" href="viewtopic606a.html?t=7583">

<!--
	phpBB style name: Allan Style - SUBSILVER
	Based on style:   prosilver (this is the default phpBB3 style)
	Based on style:   subsilver2 (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:  Allan ( http://x-tk.ru/ )
-->

<link href="assets/css/font-awesome.mind772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/stylesheetd772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/en/stylesheetd772.css?assets_version=34" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="./styles/AllanStyle-SUBSILVER/theme/tweaks.css?assets_version=34" rel="stylesheet">
<![endif]-->




<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','../../www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-280191-1', 'auto');
	ga('send', 'pageview');
</script>

</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">

<div id="header-subsilver">
	<a id="top" class="top-anchor" accesskey="t"></a>
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description" class="site-description">
				<a id="logo" class="logo" href="../index.html" title="DosTips.com"><span class="site_logo"></span></a>
				<h1>DosTips.com</h1>
				<p>A Forum all about DOS Batch</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

									<div id="search-box" class="search-box search-header" role="search">
				<form action="https://www.dostips.com/forum/search.php" method="get" id="search">
				<fieldset>
					<input name="keywords" id="keywords" type="search" maxlength="128" title="Search for keywords" class="inputbox search tiny" size="20" value="" placeholder="Search…" />
					<button class="button button-search" type="submit" title="Search">
						<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
					</button>
					<a href="search.html" class="button button-search-end" title="Advanced search">
						<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
					</a>
					
				</fieldset>
				</form>
			</div>
						
			</div>
					</div>
</div>


<div id="wrap" class="wrap">
	<div id="page-header">
				<div class="navbar-top" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
																									<li>
								<a href="search33a7.html?search_id=unanswered" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="search526f.html?search_id=active_topics" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-blue" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="search.html" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
											<li class="separator"></li>
																			<li>
								<a href="memberlist4bfd.html?mode=team" role="menuitem">
									<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
								</a>
							</li>
																<li class="separator"></li>

									</ul>
			</div>
		</li>

				<li data-skip-responsive="true">
			<a href="app.php/help/faq.html" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
						
			<li class="rightside"  data-skip-responsive="true">
			<a href="ucp26c3.html?mode=login" title="Login" accesskey="x" role="menuitem">
				<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Login</span>
			</a>
		</li>
					<li class="rightside" data-skip-responsive="true">
				<a href="ucp8319.html?mode=register" role="menuitem">
					<i class="icon fa-pencil-square-o  fa-fw" aria-hidden="true"></i><span>Register</span>
				</a>
			</li>
						</ul>

	</div>
</div>

<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
						<li class="breadcrumbs">
							<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="../index.html" itemprop="url" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span itemprop="title">DosTips.com</span></a></span>
										<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="index.html" itemprop="url" accesskey="h" data-navbar-reference="index"><span itemprop="title">Board index</span></a></span>

											<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="4"><a href="viewforum31e6.html?f=4" itemprop="url"><span itemprop="title">DosTips - Dos Batch</span></a></span>
															<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="3"><a href="viewforum4d6b.html?f=3" itemprop="url"><span itemprop="title">DOS Batch Forum</span></a></span>
												</li>
		
					<li class="rightside responsive-search">
				<a href="search.html" title="View the advanced search options" role="menuitem">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</a>
			</li>
			</ul>

	</div>
</div>

<div class="navbar-top-link">
	<div class="inner">
		<ul>
			<li class="navbar-top-link-left"><a href="search33a7.html?search_id=unanswered">Unanswered topics</a></li>
			<li class="navbar-top-link-left"><a href="search526f.html?search_id=active_topics">Active topics</a></li>

											</ul>
	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
		
<h2 class="topic-title"><a href="viewtopic1ef6.html?f=3&amp;t=7583">SendMessage.exe: Access to advanced Windows features</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">Discussion forum for all Windows batch related topics.<br /></div>
<p>
	<strong>Moderator:</strong> <a href="memberlista6a8.html?mode=viewprofile&amp;u=5" class="username">DosItHelp</a>
</p>


<div class="action-bar bar-top">
	
			<a href="postingde94.html?mode=reply&amp;f=3&amp;t=7583" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic0ded.html?f=3&amp;t=7583&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="https://www.dostips.com/forum/search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topic…" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="search.html" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="7583" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			20 posts
							<ul>
		<li class="active"><span>1</span></li>
				<li><a class="button" href="viewtopicdd7c-2.html?f=3&amp;t=7583&amp;start=15" role="button">2</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopicdd7c-2.html?f=3&amp;t=7583&amp;start=15" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
		</div>




<div id="subsilver-nav-topic">
	<div class="inner"><div class="post has-profile">
		<div class="leftsided postbody subsilver-topic-title">Message</div>
		<div class="leftsided postprofile subsilver-topic-author">Author</div>
	</div></div>
</div>

			<div id="p50381" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile50381">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchdc63.html?author_id=2923&amp;sr=posts">1540</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 06 Dec 2011 22:15</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> México City, México</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content50381">

						<h3 class="first"><a href="#p50381">SendMessage.exe: Access to advanced Windows features</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting8475.html?mode=quote&amp;f=3&amp;p=50381" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic741e.html?p=50381#p50381" onclick="prompt('Message #1',this.href); return false;">#1</a></span> 
									<a class="unread" href="viewtopic741e.html?p=50381#p50381" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a></strong> &raquo; </span>02 Dec 2016 20:28
			</p>
			
			
			
			<div class="content"><strong class="text-strong">SendMessage.exe</strong> is an auxiliary .exe program that works as a wrapper for the Win-32 API <a href="https://msdn.microsoft.com/en-us/library/ms644950(VS.85).aspx" class="postlink">SendMessage function</a>. This function allows you to have access to several interesting Windows features in a very simple way. You may read an introduction to the use of SendMessage at <a href="http://pbdj.sys-con.com/node/198707/mobile" class="postlink">this article</a>.<br /><br />The operation of SendMessage.exe program is simple: it takes 3 values from the parameters and invoke the SendMessage function with them. This is the general usage format:<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>SendMessage.exe&nbsp; &#91;&quot;title&quot;&#93;&nbsp; Message&nbsp; &#91;wParam&nbsp; &#91;lParam&#93;&#93;<br /></code></pre></div><br />In this format, Message is the number of the wanted <a href="https://msdn.microsoft.com/en-us/library/ms644927(v=vs.85).aspx#system_defined" class="postlink">System-Defined Message</a> and the other two parameters vary accordingly. The optional window title allows to send the message to another window, instead of the current cmd.exe one. The key to make good use of SendMessage features is to know the values that can be used with it, but this information is not presented in the Windows API documentation in a coherent way. I spent more time browsing the documentation looking for useful cmd.exe message numbers than the time it tooks me to write the SendMessage.asm program!  <img class="smilies" src="images/smilies/icon_eek.gif" alt=":shock:" title="Shocked" />  <img class="smilies" src="images/smilies/icon_confused.gif" alt=":?" title="Confused" />  This is a list of the message numbers that I have successfully tested so far:<br /><br /><a href="https://msdn.microsoft.com/en-us/library/bb787577(v=vs.85).aspx" class="postlink">WM_VSCROLL</a>=277 <em class="text-italics">request</em>: Scrolls the window's vertical scroll bar.<br />Possible values for wParam=<em class="text-italics">request</em>:<br /><ul><li> <strong class="text-strong">SB_TOP</strong>=6:      Scrolls to top.</li><li> <strong class="text-strong">SB_PAGEUP</strong>=2:   Scrolls one page up.</li><li> <strong class="text-strong">SB_LINEUP</strong>=0:   Scrolls one line up.</li><li> <strong class="text-strong">SB_LINEDOWN</strong>=1: Scrolls one line down.</li><li> <strong class="text-strong">SB_PAGEDOWN</strong>=3: Scrolls one page down.</li><li> <strong class="text-strong">SB_BOTTOM</strong>=7:   Scrolls to bottom.</li><li> <strong class="text-strong">SB_THUMBPOSITION</strong>=4: Scrolls the line given in high part of wParam to top of screen:<br />set /A request=(line&lt;&lt;16)+SB_THUMBPOSITION</li></ul><br /><a href="https://msdn.microsoft.com/en-us/library/bb787575(v=vs.85).aspx" class="postlink">WM_HSCROLL</a>=276 <em class="text-italics">request</em>: Scrolls the window's horizontal scroll bar.<br />Possible values for wParam=<em class="text-italics">request</em>:<br /><ul><li> <strong class="text-strong">SB_LEFT</strong>=6:      Scrolls to left-most column.</li><li> <strong class="text-strong">SB_PAGELEFT</strong>=2:  Scrolls one page left.</li><li> <strong class="text-strong">SB_LINELEFT</strong>=0:  Scrolls one column left.</li><li> <strong class="text-strong">SB_LINERIGHT</strong>=1: Scrolls one column right.</li><li> <strong class="text-strong">SB_PAGERIGHT</strong>=3: Scrolls one page right.</li><li> <strong class="text-strong">SB_RIGHT</strong>=7:     Scrolls to right-most column.</li><li> <strong class="text-strong">SB_THUMBPOSITION</strong>=4: Scrolls the column given in high part of wParam to left of screen:<br />set /A request=(column&lt;&lt;16)+SB_THUMBPOSITION</li></ul><br /><a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms646360(v=vs.85).aspx" class="postlink">WM_SYSCOMMAND</a>=274 <em class="text-italics">item</em>: Selects an item from the window menu.<br />Possible values for wParam=<em class="text-italics">item</em>:<br /><ul><li> <strong class="text-strong">SC_MONITORPOWER</strong>=61808: Power the display on/low/off via lParam= -1/1/2.</li><li> <strong class="text-strong">SC_KEYMENU</strong>=61696:      Open the Alt-letter menu; code of letter in lParam.</li><li> <strong class="text-strong">SC_TASKLIST</strong>=61744:     Open the Start menu.</li><li> <strong class="text-strong">SC_SCREENSAVE</strong>=61760:   Executes the screen saver.</li><li> <strong class="text-strong">SC_NEXTWINDOW</strong>=61504:   Selects next window.</li><li> <strong class="text-strong">SC_PREVWINDOW</strong>=61520:   Selects previous window.</li><li> <strong class="text-strong">SC_MOVE</strong>=61456:         Enables window move.</li><li> <strong class="text-strong">SC_SIZE</strong>=61440:         Enables window resize.</li><li> <strong class="text-strong">SC_MINIMIZE</strong>=61472:     Minimizes the window.</li><li> <strong class="text-strong">SC_MAXIMIZE</strong>=61488:     Maximizes the window.</li><li> <strong class="text-strong">SC_RESTORE</strong>=61728:      Restores the window.</li><li> <strong class="text-strong">SC_CLOSE</strong>=61536:        Closes the window.</li><li> <strong class="text-strong">SC_SCROLL</strong>=65523:       Enables &quot;Scroll mode&quot; in cmd.exe window. (Note 1)</li><li> <strong class="text-strong">MF_ENABLED</strong>=0:      Enables the menu item. (Note 2)</li><li> <strong class="text-strong">MF_GRAYED</strong>=1:       Disables and gray the menu item. (Note 2)</li><li> <strong class="text-strong">MF_DISABLED</strong>=2:     Disables the menu item, but not gray it. (Note 2)</li></ul><br /><strong class="text-strong">Note 1</strong>: <a href="http://stackoverflow.com/questions/40837653/how-activate-cmd-exe-windows-scroll-mode-via-a-win-32-api-function" class="postlink">SC_SCROLL=0xFFF3</a>=65523 is an undocumented value that was researched by S.O. user MC ND.<br /><br />All previous values are defined in SendMessageValues.bat companion file as auxiliary variables via SET /A commands. For example:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>set /A WM_VSCROLL=277, SB_PAGEDOWN=3<br /></code></pre></div><br />As conclusion of previous description, the next command scrolls the cmd.exe window one page down:<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>SendMessage.exe&nbsp; %WM_VSCROLL%&nbsp; %SB_PAGEDOWN%<br /></code></pre></div><br />Interesting! Isn't it?  <img class="smilies" src="images/smilies/icon_cool.gif" alt="8)" title="Cool" />  Try it yourself:<br /><div class="inline-attachment">
			
		
		
				<dl class="file">
			<dt><span class="imageset icon_topic_attach"></span> <a class="postlink" href="download/file47c2.php?id=83">SendMessage.zip</a></dt>
			<dd><em>SendMessage.exe, SendMessage.txt and SendMessageValues.bat</em></dd>			<dd>(1.74 KiB) Downloaded 169 times</dd>
		</dl>
		
		
			</div><br /><strong class="text-strong">Note 2</strong>: MF_ENABLED, MF_GRAYED and MF_DISABLED values are <em class="text-italics">not</em> menu items, but parameters of Win-32 API <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms647636(v=vs.85).aspx" class="postlink">EnableMenuItem function</a> instead; this function is also included in SendMessage.exe program for convenience. When you use these values in wParam, the lParam must have the menu item that is processed; for example: <strong class="text-strong">SendMessage %WM_SYSCOMMAND% %MF_DISABLED% %SC_CLOSE%</strong> disable the red X &quot;close&quot; button. You may also specify an item by its <em class="text-italics">position</em> in the menu instead of its name; for example: <strong class="text-strong">SendMessage %WM_SYSCOMMAND% %MF_GRAYED% 3</strong> disable and gray the third item in the menu.<br /><br />Note that this is work in progress: there are much more messages that could be successfully used in the cmd.exe window, but it is necessary to test each one of them. My next step is try to implement the <a href="https://msdn.microsoft.com/en-us/library/ff485879(v=vs.85).aspx" class="postlink">ACM messages</a> that would permit the playing of silent .AVI video files. If you want that I test other values, post here such request with a link to the wanted messages.<br /><br /><strong class="text-strong">IMPORTANT</strong>: SendMessage.exe does <strong class="text-strong"><em class="text-italics">NOT</em></strong> check the values given in the parameters in any way; it just use such values to invoke SendMessage API function. I don't know if some of the values not listed here may be potentially dangerous! The full documentation of all possible values is given in a link above. If you don't know what you are doing, just don't use any value not listed here. I will NOT be responsible for any damage that could be caused by the use of SendMessage.exe program! <img class="smilies" src="images/smilies/icon_evil.gif" alt=":evil:" title="Evil or Very Mad" /> On the other hand, I'll appreciate it if you post here some additional values that you may successfully tested.<br /><br />Antonio</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50382" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile50382">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content50382">

						<h3 ><a href="#p50382">Re: SendMessage.exe: Access to advanced Windows features</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingee00.html?mode=quote&amp;f=3&amp;p=50382" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic894c.html?p=50382#p50382" onclick="prompt('Message #2',this.href); return false;">#2</a></span> 
									<a class="unread" href="viewtopic894c.html?p=50382#p50382" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>02 Dec 2016 22:54
			</p>
			
			
			
			<div class="content">Very cool <img class="smilies" src="images/smilies/icon_cool.gif" alt="8)" title="Cool" /> <br /><br />I'm not sure that I will ever use this utility, but it looks like it could be really powerful  <img class="smilies" src="images/smilies/icon_exclaim.gif" alt=":!:" title="Exclamation" /> <br /><br />Given that a window title is not always unique, could you provide some other mechanism to specify the window <img class="smilies" src="images/smilies/icon_question.gif" alt=":?:" title="Question" /> I'm thinking the PID might be a good candidate. We know how to derive the PID of the running batch script, and we also know how to launch a process with WMIC and return the PID. Perhaps we would need to walk up the parent tree to find the containing window, but that also sounds doable.<br /><br />I found some VB code to derive the Window handle from the PID at <!-- m --><a class="postlink" href="http://forums.codeguru.com/showthread.php?446691-RESOLVED-How-to-get-handle-of-main-form-using-ProcessID">http://forums.codeguru.com/showthread.p ... -ProcessID</a><!-- m --><br /><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50386" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile50386">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchdc63.html?author_id=2923&amp;sr=posts">1540</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 06 Dec 2011 22:15</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> México City, México</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content50386">

						<h3 ><a href="#p50386">Re: SendMessage.exe: Access to advanced Windows features</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinga6a3.html?mode=quote&amp;f=3&amp;p=50386" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic2e5a-2.html?p=50386#p50386" onclick="prompt('Message #3',this.href); return false;">#3</a></span> 
									<a class="unread" href="viewtopic2e5a-2.html?p=50386#p50386" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a></strong> &raquo; </span>03 Dec 2016 12:06
			</p>
			
			
			
			<div class="content">This program may be very useful in several ways. For example, when a command outputs several pages in the screen with no pause, I used to repeat the command adding &quot;| more&quot; or scroll the screen contents via clicks on the scroll bar, but that is annoying. <img class="smilies" src="images/smilies/icon_confused.gif" alt=":?" title="Confused" /> <br /><br />I defined a Batch file called <strong class="text-strong">S.bat</strong> with this line:<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@SendMessage 274 65523<br /></code></pre></div><br />Now, when a command outputs several pages in the screen I just run S.bat to enable the &quot;Scroll mode&quot;, so I can scroll the screen contents with PageUp, UpArrow, DownArrow and PageDown keys. <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" />  After that, I just press Enter key to disable the &quot;Scroll mode&quot;...<br /><br />Antonio</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50397" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile50397">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist54bd.html?mode=viewprofile&amp;u=5313" class="username">mcnd</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search92b3.html?author_id=5313&amp;sr=posts">27</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 08 Jan 2014 07:29</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content50397">

						<h3 ><a href="#p50397">Re: SendMessage.exe: Access to advanced Windows features</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting099b.html?mode=quote&amp;f=3&amp;p=50397" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic6a71.html?p=50397#p50397" onclick="prompt('Message #4',this.href); return false;">#4</a></span> 
									<a class="unread" href="viewtopic6a71.html?p=50397#p50397" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist54bd.html?mode=viewprofile&amp;u=5313" class="username">mcnd</a></strong> &raquo; </span>04 Dec 2016 05:41
			</p>
			
			
			
			<div class="content">Nice utility, thank you for the work and the invitation.<br /><br />I think that in your initial list of messages to you missed this<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />&nbsp; &nbsp; setlocal enableextensions disabledelayedexpansion<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; SendMessage 258 84 <br />&nbsp; &nbsp; SendMessage 258 101 <br />&nbsp; &nbsp; SendMessage 258 115 <br />&nbsp; &nbsp; SendMessage 258 116 <br /><br />&nbsp; &nbsp; set /p &quot;=What is this? &quot;<br /></code></pre></div><br />Where 258 = WM_CHAR</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50401" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile50401">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search661c.html?author_id=1265&amp;sr=posts">3386</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 22 Jan 2010 18:01</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content50401">

						<h3 ><a href="#p50401">Re: SendMessage.exe: Access to advanced Windows features</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingd3ae.html?mode=quote&amp;f=3&amp;p=50401" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic7c58.html?p=50401#p50401" onclick="prompt('Message #5',this.href); return false;">#5</a></span> 
									<a class="unread" href="viewtopic7c58.html?p=50401#p50401" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a></strong> &raquo; </span>04 Dec 2016 07:29
			</p>
			
			
			
			<div class="content">That's a helpful utility Antonio. Thanks for sharing <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /> <br /><br /><blockquote><div><cite>dbenham wrote:</cite>Given that a window title is not always unique, could you provide some other mechanism to specify the window <img class="smilies" src="images/smilies/icon_question.gif" alt=":?:" title="Question" /> I'm thinking the PID might be a good candidate.</div></blockquote><br />That's quite difficult Dave. Processes can have several windows. Every button, every check box, every text box, etc. is a child window. There is no direct relation between PID and a window. You have to enumerate everything. I assume it's a mess in Assembly (even if I don't speak ASM).<br /><br />Antonio<br />I don't know if it could be helpful for you. I wrote a C/WinAPI tool that sends WM_CLOSE to a window specified by its handle, process name, process ID, thread ID, or window title. (It's not the same as killing the process but rather similar to pressing the red X button which enables the process to tidy up.) It's pretty much what Dave said unless that the message sent is always the same. If it would be too comlicated to adopt it in your ASM code I could easily rewrite the C code ... Just tell me.<br /><br />Steffen<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>Tries to close the main window of a process by sending the WM_CLOSE message.<br /><br />Usage:<br />closewindow /L | /H HWND | /N &quot;process name&quot; | /P PID | /T TID | /W &quot;window title&quot;<br /><br />&nbsp; option /L&nbsp; &nbsp; &nbsp; Creates a list of all main windows.<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(window handle|process ID|process name|window title)<br />&nbsp; HWND&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Hexadecimal window handle as displayed using option /L.<br />&nbsp; process name&nbsp; &nbsp;Name (including .exe extension) of the process owning the window.<br />&nbsp; PID&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Process ID of the process owning the window.<br />&nbsp; TID&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Thread ID of the thread owning the window.<br />&nbsp; window title&nbsp; &nbsp;Window title as displayed in the task bar.<br /><br />Lists window handle, process ID, process name and window title of the window whereto<br />WM_CLOSE was sent.<br /><br />Returns 0 if the WM_CLOSE message was successfully sent to the found window. Otherwise 1<br />will be returned.<br /><br />NOTE: Sending WM_CLOSE to a window does neither guarantee that the window will be closed<br />nor that the process will be terminated.<br /></code></pre></div></div>

							<dl class="attachbox">
					<dt>
						Attachments
					</dt>
											<dd>
			
		
		
				<dl class="file">
			<dt><span class="imageset icon_topic_attach"></span> <a class="postlink" href="download/file7845.php?id=85">closewindow.zip</a></dt>
						<dd>(11.04 KiB) Downloaded 92 times</dd>
		</dl>
		
		
			</dd>
									</dl>
			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50416" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile50416">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchdc63.html?author_id=2923&amp;sr=posts">1540</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 06 Dec 2011 22:15</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> México City, México</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content50416">

						<h3 ><a href="#p50416">Re: SendMessage.exe: Access to advanced Windows features</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting598f.html?mode=quote&amp;f=3&amp;p=50416" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopica4dd.html?p=50416#p50416" onclick="prompt('Message #6',this.href); return false;">#6</a></span> 
									<a class="unread" href="viewtopica4dd.html?p=50416#p50416" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a></strong> &raquo; </span>04 Dec 2016 21:54
			</p>
			
			
			
			<div class="content">@mcnd,<br /><br />I quickly reviewed most messages and just completed more intensive tests on messages that correctly works in the first test. As I said before, there are much more messages that could be successfully used in the cmd.exe window. Please, include a link to the message you refer to; this avoids a further annoying search. For example: <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms646276(v=vs.85).aspx" class="postlink">WM_CHAR</a> message.<br /><br /><br />@dbenham, @aGerman,<br /><br />I started to do tests with this program just a couple hours before I posted it here. My firsts tests show that messages that are sent to other windows just works in certain cases, and this point depends on the relation that the cmd.exe window have with the recipient window. Given these conditions, and the fact that the same user will create both the recipient window and the corresponding SendMessage.exe command, I don't see a scenario where the recipient window could not be located by its title.<br /><br />However, if you show me an example of a <em class="text-italics">real</em> scenario where the recipient window could not be located by its title, but just by its PID or another value, I would evaluate the possibility of include such feature in SendMessage.exe, although I really would like to keep it small. When the code needed to parse parameters and complete preliminary steps is <em class="text-italics">much larger</em> than the code used to perform the program's task, then is time to choose an high level programming language instead, like C++.<br /><br />In order to put previous point in perspective, I am posting below the source code of SendMessage.asm program:<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>;&nbsp; &nbsp;SendMessage &#91;&quot;title&quot;&#93; message &#91;wParam &#91;lParam&#93;&#93;<br />;&nbsp; &nbsp;Send a System Defined Message to a given or current window<br />;&nbsp; &nbsp;Antonio Perez Ayala - Version 1.0 - Nov/2016<br /><br />&nbsp; &nbsp; .data<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; hWnd&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DD&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ?&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;handle of window<br />&nbsp; &nbsp; &nbsp; &nbsp; message&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DD&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ?&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;message number<br />&nbsp; &nbsp; &nbsp; &nbsp; wParam&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DD&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;first parameter<br />&nbsp; &nbsp; &nbsp; &nbsp; lParam&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DD&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;second parameter<br /><br />&nbsp; &nbsp; .code<br /><br />Main&nbsp; &nbsp; PROC<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; GetConsoleWindow&nbsp; &nbsp; &nbsp; &nbsp; ;EAX = console window handle<br />&nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp;hWnd, eax&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;store in its place<br />&nbsp; &nbsp; &nbsp; &nbsp; ;<br />&nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp;ecx, 3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;ECX = number of numeric params<br />&nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp;edi, OFFSET message&nbsp; &nbsp; &nbsp;;EDI -&gt; first number<br />&nbsp; &nbsp; &nbsp; &nbsp; ;<br />&nbsp; &nbsp; &nbsp; &nbsp; cld&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;to increment indexes<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; GetCmdLine&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;ESI -&gt; Command Line<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; GetNextArg&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;ESI -&gt; next arg<br />&nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp;al, &#91;esi&#93;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;load next char<br />&nbsp; &nbsp; &nbsp; &nbsp; inc&nbsp; &nbsp; &nbsp;esi&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;and advance index<br />&nbsp; &nbsp; &nbsp; &nbsp; ;<br />&nbsp; &nbsp; &nbsp; &nbsp; test&nbsp; &nbsp; al, al&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;parameter ends?<br />&nbsp; &nbsp; &nbsp; &nbsp; jz&nbsp; &nbsp; &nbsp; end_main&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;yes: terminate<br />&nbsp; &nbsp; &nbsp; &nbsp; ;<br />&nbsp; &nbsp; &nbsp; &nbsp; cmp&nbsp; &nbsp; &nbsp;al, '&quot;'&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;is quote?<br />&nbsp; &nbsp; &nbsp; &nbsp; jne&nbsp; &nbsp; &nbsp;SHORT get_number&nbsp; &nbsp; &nbsp; &nbsp; ;no: jump<br />&nbsp; &nbsp; &nbsp; &nbsp; ;<br />&nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp;ebx, esi&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;EBX -&gt; &quot;title&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; ;<br />@@:<br />&nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp;al, &#91;esi&#93;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;load next char<br />&nbsp; &nbsp; &nbsp; &nbsp; inc&nbsp; &nbsp; &nbsp;esi&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;and advance index<br />&nbsp; &nbsp; &nbsp; &nbsp; ;<br />&nbsp; &nbsp; &nbsp; &nbsp; or&nbsp; &nbsp; &nbsp; al, al&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;parameter ends?<br />&nbsp; &nbsp; &nbsp; &nbsp; jz&nbsp; &nbsp; &nbsp; end_main&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;yes: error (quote expected)<br />&nbsp; &nbsp; &nbsp; &nbsp; cmp&nbsp; &nbsp; &nbsp;al, '&quot;'&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;closing quote?<br />&nbsp; &nbsp; &nbsp; &nbsp; jne&nbsp; &nbsp; &nbsp;SHORT @B&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;no: go back<br />&nbsp; &nbsp; &nbsp; &nbsp; ;<br />&nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp;BYTE PTR &#91;esi-1&#93;, 0&nbsp; &nbsp; &nbsp;;change closing quote by ending zero<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; FindWindow, NULL, ebx&nbsp; &nbsp;;EAX = handle of given window<br />&nbsp; &nbsp; &nbsp; &nbsp; or&nbsp; &nbsp; &nbsp; eax, eax&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;window found?<br />&nbsp; &nbsp; &nbsp; &nbsp; jz&nbsp; &nbsp; &nbsp; end_main&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;no: terminate<br />&nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp;hWnd, eax&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;else: store handle<br />&nbsp; &nbsp; &nbsp; &nbsp; ;<br />@@:<br />&nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; GetNextArg&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;ESI -&gt; next arg<br />&nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp;al, &#91;esi&#93;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;load next char<br />&nbsp; &nbsp; &nbsp; &nbsp; inc&nbsp; &nbsp; &nbsp;esi&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;and advance index<br />&nbsp; &nbsp; &nbsp; &nbsp; ;<br />&nbsp; &nbsp; &nbsp; &nbsp; or&nbsp; &nbsp; &nbsp; al, al&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;parameter ends?<br />&nbsp; &nbsp; &nbsp; &nbsp; jz&nbsp; &nbsp; &nbsp; SHORT end_numbers&nbsp; &nbsp; &nbsp; &nbsp;;yes: jump<br />&nbsp; &nbsp; &nbsp; &nbsp; ;<br />get_number:<br />&nbsp; &nbsp; &nbsp; &nbsp; cmp&nbsp; &nbsp; &nbsp;al, '0'&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;less than '0'?<br />&nbsp; &nbsp; &nbsp; &nbsp; jb&nbsp; &nbsp; &nbsp; SHORT end_numbers&nbsp; &nbsp; &nbsp; &nbsp;;yes: continue<br />&nbsp; &nbsp; &nbsp; &nbsp; cmp&nbsp; &nbsp; &nbsp;al, '9'&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;greater than '9'?<br />&nbsp; &nbsp; &nbsp; &nbsp; ja&nbsp; &nbsp; &nbsp; SHORT end_numbers&nbsp; &nbsp; &nbsp; &nbsp;;yes: continue<br />&nbsp; &nbsp; &nbsp; &nbsp; ;<br />&nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; GetNumber&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;EAX = number, ESI -&gt; after number<br />&nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp;&#91;edi&#93;, eax&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;store it<br />&nbsp; &nbsp; &nbsp; &nbsp; add&nbsp; &nbsp; &nbsp;edi, 4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;and advance index<br />&nbsp; &nbsp; &nbsp; &nbsp; ;<br />&nbsp; &nbsp; &nbsp; &nbsp; loop&nbsp; &nbsp; SHORT @B&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;go back for up to 3 numbers<br />&nbsp; &nbsp; &nbsp; &nbsp; ;<br />end_numbers:<br />&nbsp; &nbsp; &nbsp; &nbsp; cmp&nbsp; &nbsp; &nbsp;ecx, 3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;at least one number?<br />&nbsp; &nbsp; &nbsp; &nbsp; je&nbsp; &nbsp; &nbsp; SHORT end_main&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;no: terminate<br />&nbsp; &nbsp; &nbsp; &nbsp; ;<br />&nbsp; &nbsp; &nbsp; &nbsp; cmp&nbsp; &nbsp; &nbsp;message, WM_SYSCOMMAND&nbsp; ;is this message?<br />&nbsp; &nbsp; &nbsp; &nbsp; jne&nbsp; &nbsp; &nbsp;SHORT send_message&nbsp; &nbsp; &nbsp; ;no: continue<br />&nbsp; &nbsp; &nbsp; &nbsp; cmp&nbsp; &nbsp; &nbsp;wParam, 0F000H&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;wParam (item) is &quot;standard&quot;?<br />&nbsp; &nbsp; &nbsp; &nbsp; jae&nbsp; &nbsp; &nbsp;SHORT send_message&nbsp; &nbsp; &nbsp; ;yes: continue<br />&nbsp; &nbsp; &nbsp; &nbsp; ;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;else: is the special case<br />&nbsp; &nbsp; &nbsp; &nbsp; cmp&nbsp; &nbsp; &nbsp;lParam, 0F000H&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;menu item is &quot;standard&quot;?<br />&nbsp; &nbsp; &nbsp; &nbsp; jae&nbsp; &nbsp; &nbsp;SHORT @F&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;yes: continue<br />&nbsp; &nbsp; &nbsp; &nbsp; or&nbsp; &nbsp; &nbsp; wParam, MF_BYPOSITION&nbsp; &nbsp;;else: the item is a position<br />&nbsp; &nbsp; &nbsp; &nbsp; ;<br />@@:<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; GetSystemMenu, hWnd, FALSE&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;EAX = handle of system menu<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; EnableMenuItem, eax, lParam, wParam&nbsp; &nbsp; &nbsp;;enable/disable menu item<br />&nbsp; &nbsp; &nbsp; &nbsp; jmp&nbsp; &nbsp; &nbsp;SHORT end_main&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;and terminate<br />&nbsp; &nbsp; &nbsp; &nbsp; ;<br />send_message:<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; SendMessage, hWnd, message, wParam, lParam&nbsp; &nbsp; &nbsp; ;send the message<br />&nbsp; &nbsp; &nbsp; &nbsp; ;<br />end_main:<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; ExitProcess, eax&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;return result value<br /><br />Main&nbsp; &nbsp; ENDP<br /><br />GetNumber PROC<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; and&nbsp; &nbsp; &nbsp;eax, 0FH&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;EAX = first digit<br />&nbsp; &nbsp; &nbsp; &nbsp; xor&nbsp; &nbsp; &nbsp;ebx, ebx&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;initialize EBX = 0<br />&nbsp; &nbsp; &nbsp; &nbsp; ;<br />@@:<br />&nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp;bl, &#91;esi&#93;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;load next digit<br />&nbsp; &nbsp; &nbsp; &nbsp; inc&nbsp; &nbsp; &nbsp;esi&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;and advance index<br />&nbsp; &nbsp; &nbsp; &nbsp; cmp&nbsp; &nbsp; &nbsp;bl, '0'&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;below '0'?<br />&nbsp; &nbsp; &nbsp; &nbsp; jb&nbsp; &nbsp; &nbsp; SHORT @F&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;yes: number ends<br />&nbsp; &nbsp; &nbsp; &nbsp; cmp&nbsp; &nbsp; &nbsp;bl, '9'&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;above '9'?<br />&nbsp; &nbsp; &nbsp; &nbsp; ja&nbsp; &nbsp; &nbsp; SHORT @F&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;yes: number ends<br />&nbsp; &nbsp; &nbsp; &nbsp; ;<br />&nbsp; &nbsp; &nbsp; &nbsp; and&nbsp; &nbsp; &nbsp;bl, 0FH&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;EBX = this digit <br />&nbsp; &nbsp; &nbsp; &nbsp; lea&nbsp; &nbsp; &nbsp;eax, &#91;eax*4+eax&#93;&nbsp; &nbsp; &nbsp; &nbsp; ;EAX = number * 5<br />&nbsp; &nbsp; &nbsp; &nbsp; lea&nbsp; &nbsp; &nbsp;eax, &#91;eax*2+ebx&#93;&nbsp; &nbsp; &nbsp; &nbsp; ;EAX = number * 10 + this digit<br />&nbsp; &nbsp; &nbsp; &nbsp; jmp&nbsp; &nbsp; &nbsp;SHORT @B&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;go back for next digit<br />&nbsp; &nbsp; &nbsp; &nbsp; ;<br />@@:<br />&nbsp; &nbsp; &nbsp; &nbsp; dec&nbsp; &nbsp; &nbsp;esi&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;get index back to delimiter<br />&nbsp; &nbsp; &nbsp; &nbsp; ret<br /><br />GetNumber ENDP<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; end&nbsp; &nbsp; &nbsp;Main<br /></code></pre></div><br />The <em class="text-italics">real</em> executable code of this program occupy just <em class="text-italics">290 bytes</em>!  <img class="smilies" src="images/smilies/icon_cool.gif" alt="8)" title="Cool" /> This is what I call &quot;small code&quot; and is the reason because I don't include help screens nor error messages in my assembly programs...<br /><br />Antonio</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50420" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile50420">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search661c.html?author_id=1265&amp;sr=posts">3386</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 22 Jan 2010 18:01</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content50420">

						<h3 ><a href="#p50420">Re: SendMessage.exe: Access to advanced Windows features</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting28b4.html?mode=quote&amp;f=3&amp;p=50420" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic35a7.html?p=50420#p50420" onclick="prompt('Message #7',this.href); return false;">#7</a></span> 
									<a class="unread" href="viewtopic35a7.html?p=50420#p50420" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a></strong> &raquo; </span>05 Dec 2016 06:05
			</p>
			
			
			
			<div class="content"><blockquote class="uncited"><div>I don't see a scenario where the recipient window could not be located by its title.</div></blockquote><br />I agree. It's rather unlikely (but still possible).<br /><br /><br /><blockquote class="uncited"><div>When the code needed to parse parameters and complete preliminary steps is much larger than the code used to perform the program's task, then is time to choose an high level programming language instead, like C++.</div></blockquote><br />That's what I already offered. If you want me to write a C utility I will do so. It's still your idea and hence your decision <img class="smilies" src="images/smilies/icon_wink.gif" alt=":wink:" title="Wink" /> <br /><br /><br /><blockquote class="uncited"><div>This is what I call &quot;small code&quot; and is the reason because I don't include help screens nor error messages in my assembly programs...</div></blockquote><br />Seems that we have a different approach <img class="smilies" src="images/smilies/icon_lol.gif" alt=":lol:" title="Laughing" /> <br />It's quite seldom that I share one of my own utilities because there are tools like NirCmd out there that already cover a range of applications that we reinvented.<br />Whenever I share a utility I push myself hard in order to be at least as descriptive as Microsoft and have more stable and a more predictable tools than Microsofts are. That includes a reasonable error handling especially for the user input / passed arguments. And yes, sometimes the actual code for the main task is only a fraction.<br />Anyway, including a help message will for sure increase the size of the code and the binary but has nothing to do with the performance of the tool. Loading some bytes more or less into memory doesn't make a difference. Waiting for the OS to start the new process takes much more time. Having a help message included is just a matter of usability and comfort (imho <img class="smilies" src="images/smilies/icon_wink.gif" alt=":wink:" title="Wink" />).<br /><br />Steffen</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50422" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile50422">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist54f1.html?mode=viewprofile&amp;u=8229" class="username">misol101</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha06d.html?author_id=8229&amp;sr=posts">356</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 02 May 2016 18:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content50422">

						<h3 ><a href="#p50422">Re: SendMessage.exe: Access to advanced Windows features</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting3ae0.html?mode=quote&amp;f=3&amp;p=50422" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic50d4.html?p=50422#p50422" onclick="prompt('Message #8',this.href); return false;">#8</a></span> 
									<a class="unread" href="viewtopic50d4.html?p=50422#p50422" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist54f1.html?mode=viewprofile&amp;u=8229" class="username">misol101</a></strong> &raquo; </span>05 Dec 2016 06:46
			</p>
			
			
			
			<div class="content">Small code, large comments!  <img class="smilies" src="images/smilies/icon_mrgreen.gif" alt=":mrgreen:" title="Mr. Green" /> <br /><br />I'm amazed by the fact that every single line is commented. Do you always do that?<br /><br />Then again, if I had done that, maybe I would still understand some of my more cryptic old assembler code  <img class="smilies" src="images/smilies/icon_wink.gif" alt=":wink:" title="Wink" /></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50427" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile50427">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content50427">

						<h3 ><a href="#p50427">Re: SendMessage.exe: Access to advanced Windows features</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingd721.html?mode=quote&amp;f=3&amp;p=50427" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicd6ae.html?p=50427#p50427" onclick="prompt('Message #9',this.href); return false;">#9</a></span> 
									<a class="unread" href="viewtopicd6ae.html?p=50427#p50427" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>05 Dec 2016 14:44
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>Aacini wrote:</cite>I started to do tests with this program just a couple hours before I posted it here. My firsts tests show that messages that are sent to other windows just works in certain cases, and this point depends on the relation that the cmd.exe window have with the recipient window. Given these conditions, and the fact that the same user will create both the recipient window and the corresponding SendMessage.exe command, I don't see a scenario where the recipient window could not be located by its title.<br /></div></blockquote><br />I didn't realize your utility had such constraints. With these constraints, I can see how the title should normally be adequate.<br /><br /><blockquote><div><cite>Aacini wrote:</cite>However, if you show me an example of a <em class="text-italics">real</em> scenario where the recipient window could not be located by its title, but just by its PID or another value, I would evaluate the possibility of include such feature in SendMessage.exe, although I really would like to keep it small. When the code needed to parse parameters and complete preliminary steps is <em class="text-italics">much larger</em> than the code used to perform the program's task, then is time to choose an high level programming language instead, like C++.<br /></div></blockquote><br />The user might not always be able to control the window title, even if the target is the window of a batch script. The user may not have written the target batch script, in which case the script could set its own title, even if the user STARTed the script with a unique title. I think it is even more likely to be a problem with exe files. If there are multiple windows running with the same program, and you cannot control the title, then you are out of luck.<br /><br />But I agree with your decision based on the complexity of my request, coupled with the tiny size of your existing program.<br /><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50430" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile50430">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search661c.html?author_id=1265&amp;sr=posts">3386</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 22 Jan 2010 18:01</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content50430">

						<h3 ><a href="#p50430">Re: SendMessage.exe: Access to advanced Windows features</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting9a36.html?mode=quote&amp;f=3&amp;p=50430" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic67fc.html?p=50430#p50430" onclick="prompt('Message #10',this.href); return false;">#10</a></span> 
									<a class="unread" href="viewtopic67fc.html?p=50430#p50430" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a></strong> &raquo; </span>05 Dec 2016 15:55
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>Aacini wrote:</cite>I spent more time browsing the documentation looking for useful cmd.exe message numbers than the time it tooks me to write the SendMessage.asm program!  <img class="smilies" src="images/smilies/icon_eek.gif" alt=":shock:" title="Shocked" />  <img class="smilies" src="images/smilies/icon_confused.gif" alt=":?" title="Confused" /> </div></blockquote><br />I took the winuser.h header file of MinGW and sorted all the macro definitions with integer values. Then I edited the lines using regex. Now they can be processed with SET /A. That's the result: <div class="inline-attachment">
			
		
		
				<dl class="file">
			<dt><span class="imageset icon_topic_attach"></span> <a class="postlink" href="download/filee8ec.php?id=91">winuser.zip</a></dt>
						<dd>(19.54 KiB) Downloaded 86 times</dd>
		</dl>
		
		
			</div><br />Still too many values and without explanation  <img class="smilies" src="images/smilies/icon_sad.gif" alt=":(" title="Sad" /> I'm not sure if it could be even useful.<br /><br />Steffen</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50434" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile50434">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist1319.html?mode=viewprofile&amp;u=8331" class="username">kero</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1fdc.html?author_id=8331&amp;sr=posts">16</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Jul 2016 00:49</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Moscow</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content50434">

						<h3 ><a href="#p50434">Re: SendMessage.exe: Access to advanced Windows features</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingd252.html?mode=quote&amp;f=3&amp;p=50434" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic5bf3.html?p=50434#p50434" onclick="prompt('Message #11',this.href); return false;">#11</a></span> 
									<a class="unread" href="viewtopic5bf3.html?p=50434#p50434" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist1319.html?mode=viewprofile&amp;u=8331" class="username">kero</a></strong> &raquo; </span>06 Dec 2016 00:31
			</p>
			
			
			
			<div class="content">Hi, Aacini!<br /><br />You wrote: &quot;SC_SCROLL=0xFFF3=65523 is an undocumented value that was researched by S.O. user MC ND.&quot;<br /><br />But it would be strange to document this value - it is just menuitem's ID from standard system menu of CMD window:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>Restore&nbsp; &nbsp; &nbsp; &nbsp;F120<br />Move&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;F010<br />Size&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; F000<br />Minimize&nbsp; &nbsp; &nbsp; F020<br />Maximize&nbsp; &nbsp; &nbsp;F030<br />Close&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;F060<br />Edit --------------------&gt; Mark&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FFF2<br />Defaults&nbsp; &nbsp; &nbsp; &nbsp;FFF8&nbsp; &nbsp; &nbsp; &nbsp; Copy&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FFF0<br />Properties&nbsp; &nbsp; FFF7&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Paste&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;FFF1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Select All&nbsp; &nbsp; FFF5<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Scroll&nbsp; &nbsp; &nbsp; &nbsp; FFF3<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Find...&nbsp; &nbsp; &nbsp; &nbsp;FFF4<br /></code></pre></div></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50435" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile50435">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchdc63.html?author_id=2923&amp;sr=posts">1540</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 06 Dec 2011 22:15</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> México City, México</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content50435">

						<h3 ><a href="#p50435">Re: SendMessage.exe: Access to advanced Windows features</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting99bd.html?mode=quote&amp;f=3&amp;p=50435" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic6c56.html?p=50435#p50435" onclick="prompt('Message #12',this.href); return false;">#12</a></span> 
									<a class="unread" href="viewtopic6c56.html?p=50435#p50435" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a></strong> &raquo; </span>06 Dec 2016 01:32
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>kero wrote:</cite>Hi, Aacini!<br /><br />You wrote: &quot;SC_SCROLL=0xFFF3=65523 is an undocumented value that was researched by S.O. user MC ND.&quot;<br /><br />But it would be strange to document this value - it is just menuitem's ID from standard system menu of CMD window:<br /></div></blockquote><br />Well, I think you are right: these values are just internal values used by cmd.exe, so there is no reason to document they...<br /><br />I suppose you wrote a program similiar to this pseudo-C:<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>hMenu = GetSystemMenu( GetConsoleWindow(), FALSE );<br />for ( i = 0; i &lt; GetMenuItemCount(hMenu); i++ ) {<br />&nbsp; &nbsp;printf(&quot;%X\n&quot;, GetMenuItemID(hMenu,i));<br />}<br /></code></pre></div><br />... that show the list of item ID's, but after that you should tested they one by one in order to know what is the purpose of each one; right? <img class="smilies" src="images/smilies/icon_cool.gif" alt="8)" title="Cool" />  Good job! <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /> <br /><br />Antonio</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50436" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile50436">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist1319.html?mode=viewprofile&amp;u=8331" class="username">kero</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1fdc.html?author_id=8331&amp;sr=posts">16</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Jul 2016 00:49</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Moscow</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content50436">

						<h3 ><a href="#p50436">Re: SendMessage.exe: Access to advanced Windows features</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting7f91.html?mode=quote&amp;f=3&amp;p=50436" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic75d3.html?p=50436#p50436" onclick="prompt('Message #13',this.href); return false;">#13</a></span> 
									<a class="unread" href="viewtopic75d3.html?p=50436#p50436" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist1319.html?mode=viewprofile&amp;u=8331" class="username">kero</a></strong> &raquo; </span>06 Dec 2016 02:27
			</p>
			
			
			
			<div class="content">&gt; I suppose you wrote a program similiar to this <br /><br />Much easier: I already had handy self-made program on menu -  combination of monitor and &quot;encyclopedia&quot; <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /> <br />If it is interesting - here it is: <!-- m --><a class="postlink" href="http://files.rsdn.org/42164/menuspy.zip">http://files.rsdn.org/42164/menuspy.zip</a><!-- m -->  (screenshot: <!-- m --><a class="postlink" href="../../files.rsdn.org/42164/menuspy.png">http://files.rsdn.org/42164/menuspy.png</a><!-- m -->).</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50574" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile50574">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchdc63.html?author_id=2923&amp;sr=posts">1540</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 06 Dec 2011 22:15</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> México City, México</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content50574">

						<h3 ><a href="#p50574">Re: SendMessage.exe: Access to advanced Windows features</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting0774.html?mode=quote&amp;f=3&amp;p=50574" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopice54c.html?p=50574#p50574" onclick="prompt('Message #14',this.href); return false;">#14</a></span> 
									<a class="unread" href="viewtopice54c.html?p=50574#p50574" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a></strong> &raquo; </span>17 Dec 2016 20:27
			</p>
			
			
			
			<div class="content">I completed several tests with most System-Defined messages and I have now more precise details about this matter. The bad news first: these messages can be send to <em class="text-italics">existing</em> windows components only, that is, a menu bar, scroll bar, selection boxes, etc. There is no way to <em class="text-italics">create</em> a new window component in order to make good use of the rest of messages, like creating an animation control to display an .AVI file via the <a href="https://msdn.microsoft.com/en-us/library/ff485879(v=vs.85).aspx" class="postlink">ACM messages</a>. However, there are still some messages not covered in the first post of this thread that can be used in the cmd.exe Window or in other applications.<br /><br />One of the simplest ones is <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms646276(v=vs.85).aspx" class="postlink">WM_CHAR</a>=0x0102=258 message (previously suggested by user mcnd) that allows to inject a key in the keyboard input buffer this way: <strong class="text-strong">SendMessage %WM_CHAR% AsciiCode</strong>. Although this message is <em class="text-italics">similar</em> to other keyboard input methods (like JScript's SendKeys) there are subtle differences, so I need to complete more tests in order to get precise details on this message (and also on <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms646357(v=vs.85).aspx" class="postlink">WM_SYSCHAR</a> similar one).<br /><br />Another useful message is <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms647591(v=vs.85).aspx" class="postlink">WM_COMMAND</a>=0x0111=273, that selects an item from the topmost menu of an application. All windows have a <em class="text-italics">Window menu</em> (formerly known as <em class="text-italics">System menu</em>, name that I prefer) represented by the title bar, that include the SC_MINIMIZE, SC_MAXIMIZE and SC_CLOSE item ID's at least. Most windows also include a <em class="text-italics">Topmost menu</em>, that is the standard application menu (an exception is cmd.exe, that groups its few edition options in the system menu). This means that each menu item must be selected with the right message: WM_SYSCOMMAND for System menu items and WM_COMMAND for Topmost menu items. This point return us to the same problem stated in the first post of this thread: know the values that allow us to access useful features in application programs.<br /><br />In order to solve this point, I wrote a program called InspectMenu.exe that inspect the system and topmost menus of an active application and list the values of their item ID's and the short description that appears in the corresponding pop-up menu. When I ran this program in the cmd.exe window I got a series of additional values for the system menu:<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>C:\Users\Antonio\Documents\ASMB&gt; InspectMenu.exe<br /><br />System&nbsp; menu:<br />0 - F120: &amp;Restaurar<br />1 - F010: &amp;Mover<br />2 - F000: &amp;Tama±o<br />3 - F020: Mi&amp;nimizar<br />4 - F030: Ma&amp;ximizar<br />5 - 0000:<br />6 - F060: &amp;Cerrar<br />7 - ---&gt;&nbsp; &amp;Editar<br />&nbsp; &nbsp; 0 - FFF2: M&amp;arcar<br />&nbsp; &nbsp; 1 - FFF0: C&amp;opiar&nbsp; &nbsp;Entrar<br />&nbsp; &nbsp; 2 - FFF1: &amp;Pegar<br />&nbsp; &nbsp; 3 - FFF5: &amp;Seleccionar todo<br />&nbsp; &nbsp; 4 - FFF3: &amp;Desplazar<br />&nbsp; &nbsp; 5 - FFF4: &amp;Buscar...<br />8 - FFF8: Pre&amp;determinados<br />9 - FFF7: &amp;Propiedades<br /><br />Topmost menu:<br />No menu<br /></code></pre></div><br />This point confirms that the SC_SCROLL=0xFFF3=65523 value, described in the first post of this thread, is <em class="text-italics">not</em> a standard item used to enable the scroll mode in any application, but a particular value used just by cmd.exe, so there is no reason to document it as user kero indicated. This means that &quot;SC_SCROLL&quot; is an incorrect name because it is not a general value, like the other standard names that starts with &quot;SC_&quot;, so I now choose the &quot;CMD_&quot; prefix for the particular values used in cmd.exe application.<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>rem Values for ItemID's in the System (Window) menu of cmd.exe:<br />set /A CMD_Mark=0xFFF2, CMD_Copy=0xFFF0, CMD_Paste=0xFFF1, CMD_SelectAll=0xFFF5, CMD_Scroll=0xFFF3, CMD_Find=0xFFF4<br />set /A CMD_Defaults=0xFFF8, CMD_Properties=0xFFF7<br /></code></pre></div><br />InspectMenu.exe may also show the menu items of other applications; just give the window title between quotes in the parameter. For example, to get the menu items of Windows Calculator accessory I used <strong class="text-strong">InspectMenu.exe &quot;Calculadora&quot;</strong> (in Spanish) that show a three-level topmost menu with 21 total final item ID's. Below there are some of these values (with &quot;CAL_&quot; prefix) and the most useful item ID's of Windows Notepad text editor (with &quot;NP_&quot; prefix).<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>rem Values for ItemID's in the topmost menu of calc.exe (Windows Calculator):<br />set /A CAL_Copy=0x012C, CAL_Paste=0x012D, CAL_GroupDigits=0x012F<br /><br />rem Values for ItemID's in the topmost menu of Windows Notepad.exe:<br />set /A NP_New=0x0001, NP_Open=0x0002, NP_Save=0x0003, NP_SaveAs=0x0004, NP_Quit=0x0007<br />set /A NP_Cut=0x0300, NP_Copy=0x0301, NP_Paste=0x0302, NP_Delete=0x0303<br />set /A NP_Find=0x0015, NP_FindNext=0x0016, NP_Replace=0x0017, NP_SelectAll=0x0019<br /></code></pre></div><br />When I was writting this text (in Notepad), I execute InspectMenu and then copy the output from the screen via the rudimentary right-click mouse method in order to paste it into the Notepad document. After just two times of do that I tired of the cumbersome procedure, so I opted to write the following <strong class="text-strong">PasteInto.bat</strong> Batch file:<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />setlocal<br /><br />rem PasteInto.bat: Take the screen contents of the current cmd.exe window<br />rem&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; and paste it into another Notepad active window<br />rem Antonio Perez Ayala<br /><br />if &quot;%~1&quot; neq &quot;&quot; goto begin<br />echo Copy-paste the contents of the cmd.exe screen into a Notepad window<br />echo/<br />echo PasteInto &quot;Title of Notepad recipient window&quot;<br />goto :EOF<br /><br />:begin<br /><br />rem Define auxiliary values<br />call SendMessageValues.bat<br /><br />rem Select all text in this window and copy it to clipboard<br />SendMessage %WM_SYSCOMMAND% %CMD_SelectAll%<br />SendMessage %WM_SYSCOMMAND% %CMD_Copy%<br /><br />rem Activate the other window via Minimize/Restore trick<br />SendMessage &quot;%~1&quot; %WM_SYSCOMMAND% %SC_MINIMIZE%<br />SendMessage &quot;%~1&quot; %WM_SYSCOMMAND% %SC_RESTORE%<br /><br />rem Paste clipboard contents into the other window<br />SendMessage &quot;%~1&quot; %WM_COMMAND% %NP_Paste%<br /></code></pre></div><br />The development of this program presented a problem: the items in the Notepad topmost menu can <em class="text-italics">not</em> be selected if the window was not active. I did some tests and discovered that this point depends on the relation that the cmd.exe window have (has?) with the other window and the particular program in the other window. For example, in the case of Calculator Windows accessory, its menu items can be selected when the window is not active, and even when the window is minimized! I tried to develop a method to activate other window from the cmd.exe one using just System-Defined messages. I did several tests using diverse combinations of <a href="https://msdn.microsoft.com/en-us/library/ms646274(v=vs.85).aspx" class="postlink">WM_ACTIVATE</a>, <a href="https://msdn.microsoft.com/en-us/library/ms632615(v=vs.85).aspx" class="postlink">WM_CANCELMODE</a>, <a href="https://msdn.microsoft.com/en-us/library/ms632621(v=vs.85).aspx" class="postlink">WM_ENABLE</a>, <a href="https://msdn.microsoft.com/en-us/library/ms632614(v=vs.85).aspx" class="postlink">WM_ACTIVATEAPP</a>, <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms646283(v=vs.85).aspx" class="postlink">WM_SETFOCUS</a> and <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms646282(v=vs.85).aspx" class="postlink">WM_KILLFOCUS</a> messages, with no success. Fortunately, the items <em class="text-italics">in the system menu</em> of any window can be selected from another window, and after a SC_RESTORE the restored window remains active; this behavior makes possible to activate Notepad and other windows from the cmd.exe one via a Minimize/Restore procedure.<br /><br />The mechanism used in this Batch file allow us to use other Windows applications as &quot;servers&quot; for a &quot;client&quot; Batch file in the way described in <a href="https://msdn.microsoft.com/en-us/library/ms648774(v=vs.85).aspx" class="postlink">Dynamic Data Exchange</a>, although in a rudimentary way. The following Batch file is an example of this technique that use the Calculator Windows accessory to perform arithmetic operations.<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />setlocal<br /><br />rem UseCalc.bat: Example of using Windows Calculator accessory as &quot;server&quot; for a &quot;client&quot; Batch file<br />rem Antonio Perez Ayala<br /><br />rem Define auxiliary variables<br />call SendMessageValues.bat<br />set &quot;1/x=R&quot; &amp; set &quot;Inv=I&quot; &amp; set &quot;Mod=D&quot; &amp; set &quot;Log=L&quot; &amp; set &quot;Int=;&quot; &amp; set &quot;Sqrt=@&quot; <br />set &quot;Sin=S&quot; &amp; set &quot;Cos=O&quot; &amp; set &quot;Tan=T&quot; &amp; set &quot;DMS=M&quot; &amp; set &quot;F-E=V&quot; &amp; set &quot;Pi=P&quot;<br />set &quot;Exp=X&quot; &amp; set &quot;x^2=Q&quot; &amp; set &quot;x^y=Y&quot; &amp; set &quot;x^3=#&quot; &amp; set &quot;Ln=N&quot;<br /><br />rem Start the &quot;server&quot; and minimize it<br />start calc<br />ping -n 2 localhost &gt; NUL<br />SendMessage &quot;Calculator&quot; %WM_SYSCOMMAND% %SC_MINIMIZE%<br /><br />rem Define a list of arithmetic expressions as examples<br />set &quot;X=1.5&quot;<br />for %%n in (^&quot;^<br />% Do NOT remove this line %<br />^&quot;) do for /F &quot;tokens=1,2&quot; %%a in (&quot;<br />&nbsp; &nbsp;&quot;e 1%Inv%%Ln%&quot; %%~n<br />&nbsp; &nbsp;&quot;Pi %Pi%&quot; %%~n<br />&nbsp; &nbsp;&quot;Ln(10) 10%Ln%&quot; %%~n<br />&nbsp; &nbsp;&quot;Sqrt(2) 2%Sqrt%&quot; %%~n<br />&nbsp; &nbsp;&quot;TanH(%X%) (%X%%Inv%%Ln%-(0-%X%)%Inv%%Ln%)/(%X%%Inv%%Ln%+(0-%X%)%Inv%%Ln%)&quot; %%~n<br />&nbsp; &nbsp;&quot;(4+5)/(6+7) (4+5)/(6+7)&quot; %%~n<br />&nbsp; &nbsp;&quot;(((4+5)*(2+3)+6)/(8+7))^9 (((4+5)*(2+3)+6)/(8+7))%x^y%9&quot; &quot;<br />) do (<br /><br />&nbsp; &nbsp;rem Copy the Calculator expression into clipboard<br />&nbsp; &nbsp;&lt; NUL (set /P &quot;=%%~b=&quot;| clip)<br /><br />&nbsp; &nbsp;rem Paste the expression to Calculator<br />&nbsp; &nbsp;SendMessage &quot;Calculator&quot; %WM_COMMAND% %CAL_Paste%<br /><br />&nbsp; &nbsp;rem Copy the result into clipboard<br />&nbsp; &nbsp;SendMessage &quot;Calculator&quot; %WM_COMMAND% %CAL_Copy%<br /><br />&nbsp; &nbsp;rem Read the result from clipboard (paste clipboard)<br />&nbsp; &nbsp;for /F %%c in ('PasteClip') do echo %%~a&nbsp; =&nbsp; %%c<br /><br />)<br /><br />rem Change number format to show a last result<br />SendMessage &quot;Calculator&quot; %WM_COMMAND% %CAL_GroupDigits%<br />echo 2%x^y%64=| clip<br />SendMessage &quot;Calculator&quot; %WM_COMMAND% %CAL_Paste%<br />SendMessage &quot;Calculator&quot; %WM_COMMAND% %CAL_Copy%<br />SendMessage &quot;Calculator&quot; %WM_COMMAND% %CAL_GroupDigits%<br />echo/<br />for /F %%c in ('PasteClip') do echo 2^^64&nbsp; =&nbsp; %%c<br /><br />rem Close the &quot;server&quot;<br />SendMessage &quot;Calculator&quot; %WM_SYSCOMMAND% %SC_CLOSE%<br /></code></pre></div><br />Output:<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>e&nbsp; =&nbsp; 2.7182818284590452353602874713527<br />Pi&nbsp; =&nbsp; 3.1415926535897932384626433832795<br />Ln(10)&nbsp; =&nbsp; 2.3025850929940456840179914546844<br />Sqrt(2)&nbsp; =&nbsp; 1.4142135623730950488016887242097<br />TanH(1.5)&nbsp; =&nbsp; 0.9051482536448664382423036964565<br />(4+5)/(6+7)&nbsp; =&nbsp; 0.69230769230769230769230769230769<br />(((4+5)*(2+3)+6)/(8+7))^9&nbsp; =&nbsp; 60716.992766464<br /><br />2^64&nbsp; =&nbsp; 18,446,744,073,709,551,616<br /></code></pre></div><br />You should note that the names of all Windows accessories are language dependant. I copied the keys used to assemble the arithmetic expression for Calculator from a list of <a href="http://superuser.com/a/546242/102933" class="postlink">Keyboard shortcuts</a>; the next step is test if WM_CHAR/WM_SYSCHAR message could be used to generate the rest of Alt- and Ctrl- Calculator keys. Although this Batch file is somewhat slow (because all those copy to/from clipboard commands), the interesting point is that it works!  <img class="smilies" src="images/smilies/icon_cool.gif" alt="8)" title="Cool" />  <img class="smilies" src="images/smilies/icon_mrgreen.gif" alt=":mrgreen:" title="Mr. Green" />  The next step is write a Batch file that use Notepad as server to replace strings in a text file. If I have success, I think that it would be possible to edit an Excell spreadsheet or access any other Window application in the same way! <img class="smilies" src="images/smilies/icon_eek.gif" alt=":shock:" title="Shocked" />  <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /> <br /><br /><strong class="text-strong">Technicall note</strong>. The cmd.exe system menu include the CMD_Paste item ID that effectively paste the clipboard contents <em class="text-italics">into cmd.exe keyboard input buffer</em>; this means that such input could be get via a SET /P command or any other method that read input via Stdin. For example, the &quot;Read the result from clipboard&quot; part in previous Batch file could be written this way:<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>rem Read the result from clipboard via SET /P<br />SendMessage %WM_SYSCOMMAND% %CMD_Paste%&nbsp; &amp;&nbsp; rem Paste clipboard contents<br />SendMessage %WM_CHAR% %EnterKey%&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&nbsp; rem Add an Enter to complete SET /P input<br />set /P &quot;result=&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&nbsp; rem Read a line from clipboard in result variable<br /></code></pre></div><br />You may also use a FOR that run a filter command to get such input, like FIND or FINDSTR, or you may use a COPY CON FILE.TXT command to copy all lines from clipboard to a file, but in these cases it would be necessary to insert a Ctrl-Z before the Enter in order to mark the end of input for these commands. For example:<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>rem Copy-Paste clipboard contents into Clipboard.txt file<br />SendMessage %WM_SYSCOMMAND% %CMD_Paste%&nbsp; &amp;&nbsp; rem Paste clipboard contents<br />SendMessage %WM_CHAR% %Ctrl_Z%&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&nbsp; rem Mark the End-Of-File for COPY command<br />SendMessage %WM_CHAR% %EnterKey%&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&nbsp; rem Add an Enter to complete the input<br />copy con Clipboard.txt&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;&nbsp; rem Do it!<br /></code></pre></div><br />These methods works correctly, but have a disadvantage: they all <em class="text-italics">show in the screen</em> the characters being pasted! This is logical because supposedly these characters are being typed in the keyboard, but they interfere with any program that require such paste operations. I tried to develop a method to avoid this text appearing in the screen, with no success. For this reason, I wrote PasteClip.exe program that performs the complementary function of native CLIP.EXE command: it read the clipboard contents and show it via its Stdout channel, so this output can be processed in the usual way with no problems.<br /><div class="inline-attachment">
			
		
		
				<dl class="file">
			<dt><span class="imageset icon_topic_attach"></span> <a class="postlink" href="download/file0468.php?id=99">SendMessage 2nd part.zip</a></dt>
			<dd><em>InspectMenu.exe, PasteClip.exe, PasteClip.txt, PasteInto.bat and UseCalc.bat; and updated version of SendMessageValues.bat</em></dd>			<dd>(4.75 KiB) Downloaded 117 times</dd>
		</dl>
		
		
			</div><br />Antonio  <img class="smilies" src="images/smilies/icon_razz.gif" alt=":P" title="Razz" /></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50597" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile50597">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist7eee.html?mode=viewprofile&amp;u=8185" class="username">Thor</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search0236.html?author_id=8185&amp;sr=posts">43</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 31 Mar 2016 15:02</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content50597">

						<h3 ><a href="#p50597">Re: SendMessage.exe: Access to advanced Windows features</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingab9b.html?mode=quote&amp;f=3&amp;p=50597" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicb3d4.html?p=50597#p50597" onclick="prompt('Message #15',this.href); return false;">#15</a></span> 
									<a class="unread" href="viewtopicb3d4.html?p=50597#p50597" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist7eee.html?mode=viewprofile&amp;u=8185" class="username">Thor</a></strong> &raquo; </span>20 Dec 2016 11:03
			</p>
			
			
			
			<div class="content">Thanks for the useful tool.<br />I have a question regarding the use of the &quot;Calculator&quot; in &quot;UseCalc.bat&quot;.<br />How could you define a key to use the &quot;factorial&quot; function, i.e. &quot;n!&quot;?<br />I want to calculate &quot;5!&quot;</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
	

	<div class="action-bar bar-bottom">
	
			<a href="postingde94.html?mode=reply&amp;f=3&amp;t=7583" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic0ded.html?f=3&amp;t=7583&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

			<form method="post" action="https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=7583">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			20 posts
							<ul>
		<li class="active"><span>1</span></li>
				<li><a class="button" href="viewtopicdd7c-2.html?f=3&amp;t=7583&amp;start=15" role="button">2</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopicdd7c-2.html?f=3&amp;t=7583&amp;start=15" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="viewforum4d6b.html?f=3" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to “DOS Batch Forum”</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="viewforum31e6.html?f=4" class="jumpbox-cat-link"> <span> DosTips - Dos Batch</span></a></li>
																<li><a href="viewforum4d6b.html?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; DOS Batch Forum</span></a></li>
											</ul>
		</div>
	</div>

	</div>


			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
							<span class="crumb"><a href="../index.html" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>DosTips.com</span></a></span>									<span class="crumb"><a href="index.html" data-navbar-reference="index"><span>Board index</span></a></span>					</li>
		
				<li class="rightside">All times are <span title="UTC-6">UTC-06:00</span></li>
							<li class="rightside">
				<a href="ucp033a.html?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete all board cookies</span>
				</a>
			</li>
												<li class="rightside" data-last-responsive="true">
				<a href="memberlist4bfd.html?mode=team" role="menuitem">
					<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
				</a>
			</li>
									<li class="rightside" data-last-responsive="true">
				<a href="memberlist8733.html?mode=contactadmin" role="menuitem">
					<i class="icon fa-envelope fa-fw" aria-hidden="true"></i><span>Contact us</span>
				</a>
			</li>
			</ul>

	</div>
</div>

	<div class="copyright">
				<!-- WARNING NO DELETE -->Style developer by <a href="http://tricolor.x-tk.ru/">support forum tricolor</a>, <!-- END WARNING NO DELETE -->Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
									</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	<img src="cron5495.gif?cron_type=cron.task.text_reparser.poll_title" width="1" height="1" alt="cron" /></div>

<script type="text/javascript" src="assets/javascript/jquery.mind772.js?assets_version=34"></script>
<script type="text/javascript" src="assets/javascript/cored772.js?assets_version=34"></script>



<script type="text/javascript" src="styles/prosilver/template/forum_fnd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/prosilver/template/ajaxd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/jquery-uid772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/collapsed772.js?assets_version=34"></script>



</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=7583 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 06:18:33 GMT -->
</html>
