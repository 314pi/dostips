<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=7549 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 06:39:10 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>Mouse-Selectable Menu from a data file - a/la CHOICE - DosTips.com</title>


	<link rel="canonical" href="viewtopic9c8f.html?t=7549">

<!--
	phpBB style name: Allan Style - SUBSILVER
	Based on style:   prosilver (this is the default phpBB3 style)
	Based on style:   subsilver2 (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:  Allan ( http://x-tk.ru/ )
-->

<link href="assets/css/font-awesome.mind772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/stylesheetd772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/en/stylesheetd772.css?assets_version=34" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="./styles/AllanStyle-SUBSILVER/theme/tweaks.css?assets_version=34" rel="stylesheet">
<![endif]-->




<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','../../www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-280191-1', 'auto');
	ga('send', 'pageview');
</script>

</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">

<div id="header-subsilver">
	<a id="top" class="top-anchor" accesskey="t"></a>
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description" class="site-description">
				<a id="logo" class="logo" href="../index.html" title="DosTips.com"><span class="site_logo"></span></a>
				<h1>DosTips.com</h1>
				<p>A Forum all about DOS Batch</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

									<div id="search-box" class="search-box search-header" role="search">
				<form action="https://www.dostips.com/forum/search.php" method="get" id="search">
				<fieldset>
					<input name="keywords" id="keywords" type="search" maxlength="128" title="Search for keywords" class="inputbox search tiny" size="20" value="" placeholder="Search…" />
					<button class="button button-search" type="submit" title="Search">
						<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
					</button>
					<a href="search.html" class="button button-search-end" title="Advanced search">
						<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
					</a>
					
				</fieldset>
				</form>
			</div>
						
			</div>
					</div>
</div>


<div id="wrap" class="wrap">
	<div id="page-header">
				<div class="navbar-top" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
																									<li>
								<a href="search33a7.html?search_id=unanswered" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="search526f.html?search_id=active_topics" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-blue" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="search.html" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
											<li class="separator"></li>
																			<li>
								<a href="memberlist4bfd.html?mode=team" role="menuitem">
									<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
								</a>
							</li>
																<li class="separator"></li>

									</ul>
			</div>
		</li>

				<li data-skip-responsive="true">
			<a href="app.php/help/faq.html" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
						
			<li class="rightside"  data-skip-responsive="true">
			<a href="ucp26c3.html?mode=login" title="Login" accesskey="x" role="menuitem">
				<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Login</span>
			</a>
		</li>
					<li class="rightside" data-skip-responsive="true">
				<a href="ucp8319.html?mode=register" role="menuitem">
					<i class="icon fa-pencil-square-o  fa-fw" aria-hidden="true"></i><span>Register</span>
				</a>
			</li>
						</ul>

	</div>
</div>

<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
						<li class="breadcrumbs">
							<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="../index.html" itemprop="url" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span itemprop="title">DosTips.com</span></a></span>
										<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="index.html" itemprop="url" accesskey="h" data-navbar-reference="index"><span itemprop="title">Board index</span></a></span>

											<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="4"><a href="viewforum31e6.html?f=4" itemprop="url"><span itemprop="title">DosTips - Dos Batch</span></a></span>
															<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="3"><a href="viewforum4d6b.html?f=3" itemprop="url"><span itemprop="title">DOS Batch Forum</span></a></span>
												</li>
		
					<li class="rightside responsive-search">
				<a href="search.html" title="View the advanced search options" role="menuitem">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</a>
			</li>
			</ul>

	</div>
</div>

<div class="navbar-top-link">
	<div class="inner">
		<ul>
			<li class="navbar-top-link-left"><a href="search33a7.html?search_id=unanswered">Unanswered topics</a></li>
			<li class="navbar-top-link-left"><a href="search526f.html?search_id=active_topics">Active topics</a></li>

											</ul>
	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
		
<h2 class="topic-title"><a href="viewtopiced53.html?f=3&amp;t=7549">Mouse-Selectable Menu from a data file - a/la CHOICE</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">Discussion forum for all Windows batch related topics.<br /></div>
<p>
	<strong>Moderator:</strong> <a href="memberlista6a8.html?mode=viewprofile&amp;u=5" class="username">DosItHelp</a>
</p>


<div class="action-bar bar-top">
	
			<a href="posting85bc-2.html?mode=reply&amp;f=3&amp;t=7549" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic3c66.html?f=3&amp;t=7549&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="https://www.dostips.com/forum/search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topic…" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="search.html" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="7549" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			17 posts
							<ul>
		<li class="active"><span>1</span></li>
				<li><a class="button" href="viewtopicb0e6.html?f=3&amp;t=7549&amp;start=15" role="button">2</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopicb0e6.html?f=3&amp;t=7549&amp;start=15" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
		</div>




<div id="subsilver-nav-topic">
	<div class="inner"><div class="post has-profile">
		<div class="leftsided postbody subsilver-topic-title">Message</div>
		<div class="leftsided postprofile subsilver-topic-author">Author</div>
	</div></div>
</div>

			<div id="p50143" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile50143">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist742a.html?mode=viewprofile&amp;u=6577" class="username">thefeduke</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search454a.html?author_id=6577&amp;sr=posts">211</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 05 Apr 2015 13:06</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> MA South Shore, USA</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content50143">

						<h3 class="first"><a href="#p50143">Mouse-Selectable Menu from a data file - a/la CHOICE</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting303a.html?mode=quote&amp;f=3&amp;p=50143" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic80ff.html?p=50143#p50143" onclick="prompt('Message #1',this.href); return false;">#1</a></span> 
									<a class="unread" href="viewtopic80ff.html?p=50143#p50143" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist742a.html?mode=viewprofile&amp;u=6577" class="username">thefeduke</a></strong> &raquo; </span>17 Nov 2016 00:58
			</p>
			
			
			
			<div class="content">Torn between having already overworked this script to make it better and reaping the potential benefits of the critique of the DOStips community, I am releasing the code in its current state: <blockquote><div><cite>MChoice.bat wrote:</cite>:::<br />:::  Usage Notes:<br />:::<br />:::<br />:::      Usage Considerations<br />:::<br />:::          This script is primarily designed to provide a MENU application<br />:::        where the choice is selected by using the mouse rather then the<br />:::        keyboard.  Although vaguely modeled on the CHOICE command, the<br />:::        design removes restrictions on the number of choices available and<br />:::        does not require the interpretation of return codes and the<br />:::        associated hard-coded decisions.  The input file defines the MENU<br />:::        and the returned string is as it appears on the display.  These<br />:::        data are easily changed and can be made to require as much parsing<br />:::        as desired or to be self-defining, even to the point of being<br />:::        directly executable.  The basics do appear to work on Windows XP.<br />:::<br /></div></blockquote>This first post will remain the focus for all changes.<br /><br />Here is output from supplied test data.  <span style="color: #0000BF">Edit: Original text output is replaced by a similar screen image for dramatic effect. </span><img src="../../i.imgur.com/rjR0duD.png" class="postimage" alt="Image" />Attachment, version 0.0, revised: <div class="inline-attachment">
			
		
		
				<dl class="file">
			<dt><span class="imageset icon_topic_attach"></span> <a class="postlink" href="download/file619c.php?id=62">Mouser.zip</a></dt>
			<dd><em>MChoice.bat, prerequisites and test data.<br />Added ReadME and refined testdata</em></dd>			<dd>(45.36 KiB) Downloaded 85 times</dd>
		</dl>
		
		
			</div><br />John A.</div>

			
													<div class="notice">
					Last edited by <a href="memberlist742a.html?mode=viewprofile&amp;u=6577" class="username">thefeduke</a> on 21 Nov 2016 00:22, edited 2 times in total.
									</div>
			
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50144" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile50144">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist742a.html?mode=viewprofile&amp;u=6577" class="username">thefeduke</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search454a.html?author_id=6577&amp;sr=posts">211</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 05 Apr 2015 13:06</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> MA South Shore, USA</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content50144">

						<h3 ><a href="#p50144">Re: Mouse-Selectable Menu from a data file - a/la CHOICE</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingfd74.html?mode=quote&amp;f=3&amp;p=50144" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic590f-2.html?p=50144#p50144" onclick="prompt('Message #2',this.href); return false;">#2</a></span> 
									<a class="unread" href="viewtopic590f-2.html?p=50144#p50144" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist742a.html?mode=viewprofile&amp;u=6577" class="username">thefeduke</a></strong> &raquo; </span>17 Nov 2016 02:12
			</p>
			
			
			
			<div class="content">Starting right in with my own improvement suggestion,  CHOICE has options for a timeout and a default selection.  I thought that it should be possible to do that, but I have not been able to make it work.<br /><br />I have a test script, taken out of context, below.  It attempts to use the /T flag of the GetInput.exe from  &quot;topic:: &quot;Advanced Batch features via auxiliary .exe programs&quot; by Aacini at <a href="viewtopicc107.html?p=17101#p17101" class="postlink">http://www.dostips.com/forum/viewtopic.php?p=17101#p17101</a>.  Can someone see an obvious logic error or how I may have misinterpreted the instructions for using this option?<br /><br />Here is my test script&#058; <div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@Echo Off&amp;SetLocal EnableDelayedExpansion<br />&nbsp; &nbsp; Set &quot;windowCols=80&quot; <br />&nbsp; &nbsp; CLS <br />&nbsp; &nbsp; Echo(A few Fields in row 00 <br />&nbsp; &nbsp; Echo(Row 1<br />&nbsp; &nbsp; Echo('Esc' to terminate. <br />&nbsp; &nbsp; Echo(<br />&nbsp; &nbsp; Echo(Row # 4 <br />&nbsp; &nbsp; Echo(<br />&nbsp; &nbsp; Echo(Use the keyboard or mouse now.<br />&nbsp; &nbsp; &nbsp; <br />:Basic&nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; GetInput /T 0 <br />&nbsp; &nbsp; Set /A &quot;input=%errorlevel%&quot;<br />&nbsp; &nbsp; If %input% EQU 0 Show &quot;timed out at %time%&quot; 13 10<br />&nbsp; &nbsp; If &quot;%input%&quot; EQU &quot;27&quot; GoTo :Nextloop<br />&nbsp; &nbsp; If %input% GTR 0 Show &quot;Keyboard activity detected.&quot; 13 10<br />&nbsp; &nbsp; If %input% LSS 0 Show &quot;Mouse activity detected.&quot; 13 10<br />&nbsp; &nbsp; Goto :Basic <br />&nbsp; &nbsp; &nbsp; <br />:NextLoop&nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; Echo(Starting another input loop <br />&nbsp; &nbsp; CursorPos&amp;Set /A &quot;BotRow=((!errorlevel!&gt;&gt;16)&amp;0xFFFF)-2, MsgRow=BotRow+3&quot;<br />::&nbsp; Interpret moused location using AuxProgram: GetInput<br />:InLoop<br />&nbsp; &nbsp; CursorPos 0 %MsgRow%<br />&nbsp; &nbsp; GetInput /T 9000 <br />&nbsp; &nbsp; Set /A &quot;input=%errorlevel%&quot;<br />&nbsp; &nbsp; If %input% GTR 0 (<br />&nbsp; &nbsp; &nbsp; &nbsp; CursorPos 0 -1<br />&nbsp; &nbsp; &nbsp; &nbsp; If &quot;%input%&quot; EQU &quot;27&quot; (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set /A &quot;CSlen=WindowCols-73&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ColorShow / &quot;Simulating a termination click because the '&quot; &quot;Esc&quot;&nbsp; &quot;' key was pressed. &quot; 32x!CSlen! 13 10 /07<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ColorShow / 32x%WindowCols% /<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set &quot;MRow=%BotRow%&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set &quot;MClick=Left&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CursorPos 0 %MsgRow%<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Goto :Escape<br />Rem.&nbsp; &nbsp; &nbsp; &nbsp; Possible future use - filter numerals for multiple word selection<br />&nbsp; &nbsp; &nbsp; &nbsp; ) Else (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set /A &quot;CSlen=WindowCols-18&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ColorShow / &quot;A key, loosely interpreted as the '&quot; %input%&nbsp; &quot;' key was pressed. &quot; 32x!CSlen! 13 10 /07<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set /A &quot;MRow=BotRow+5&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set &quot;MClick=None&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; )<br />&nbsp; &nbsp; ) Else If %input% EQU 0 (rem.Timed out with no interation - not enabled<br />&nbsp; &nbsp; &nbsp; &nbsp; Set /A &quot;MRow=BotRow+5&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; Set &quot;MClick=None&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; Show &quot;timed out at %time%&quot; 13 10<br />&nbsp; &nbsp; ) Else (rem.Mouse button clicked<br />&nbsp; &nbsp; &nbsp; &nbsp; Set /A &quot;input=-input, Mrow=input &gt;&gt; 16, Mcol=input &amp; 0xFFFF&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; if !Mcol! LSS 32768 (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CursorPos 0 -1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set /A &quot;CSlen=WindowCols-32&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ColorShow /07 &quot;LEFT button click at row !MRow!&quot; 32x!CSlen! 13 10<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set &quot;MClick=Left&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; ) Else (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set /A MCol-=32768<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CursorPos 0 -1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set /A &quot;CSlen=WindowCols-31&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ColorShow /07 &quot;RIGHT button click at row !MRow!&quot; 32x!CSlen! 13 10<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set &quot;MClick=Right&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; )<br />&nbsp; &nbsp; )<br /><br />&nbsp; &nbsp; If /I &quot;%MClick%&quot; EQU &quot;Left&quot; (CursorPos 0 -1&amp;Show &quot;Mouse Left-click at Row %MRow%, Col %MCol%&quot; 13 10)<br />&nbsp; &nbsp; Goto :InLoop <br />:Escape <br />&nbsp; &nbsp; Exit /B <br /></code></pre></div><br />John A.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50148" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile50148">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist742a.html?mode=viewprofile&amp;u=6577" class="username">thefeduke</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search454a.html?author_id=6577&amp;sr=posts">211</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 05 Apr 2015 13:06</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> MA South Shore, USA</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content50148">

						<h3 ><a href="#p50148">Re: Mouse-Selectable Menu from a data file - a/la CHOICE</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinge512.html?mode=quote&amp;f=3&amp;p=50148" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicd8e0.html?p=50148#p50148" onclick="prompt('Message #3',this.href); return false;">#3</a></span> 
									<a class="unread" href="viewtopicd8e0.html?p=50148#p50148" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist742a.html?mode=viewprofile&amp;u=6577" class="username">thefeduke</a></strong> &raquo; </span>17 Nov 2016 15:03
			</p>
			
			
			
			<div class="content">The .zip file in the first post has been revised with a ReadMe and better examples.<br /><br />John A.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50150" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile50150">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchdc63.html?author_id=2923&amp;sr=posts">1540</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 06 Dec 2011 22:15</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> México City, México</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content50150">

						<h3 ><a href="#p50150">Re: Mouse-Selectable Menu from a data file - a/la CHOICE</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingaecf.html?mode=quote&amp;f=3&amp;p=50150" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic7a0f.html?p=50150#p50150" onclick="prompt('Message #4',this.href); return false;">#4</a></span> 
									<a class="unread" href="viewtopic7a0f.html?p=50150#p50150" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a></strong> &raquo; </span>17 Nov 2016 16:46
			</p>
			
			
			
			<div class="content">You didn't explained what exactly the problem is... I did some GetInput.exe tests with &quot;/T millisec&quot; option at the command-line and it worked as expected: when no input, the program ends at the given lapse and return a zero; if a keyboard or mouse input is given before the timeout, the program ends and correctly report the event.<br /><br />I run your script and realized that in the first loop the mouse clicks are not reported. I modified the /T 0 number for values every time larger and quickly tapped a mouse button until the mouse clicks started to be reported. Then, I reviewed the source code of GetInput.asm program (that I wrote <em class="text-italics">more than 2 years ago</em>) and it looks correct: the delay is done via &quot;WaitForSingleObject( hInput, dwMilliseconds )&quot; and the input events are read with &quot;ReadConsoleInput( hInput, ADDR lpBuffer, 1, ADDR lpEvents )&quot;. It seems that mouse click events don't stay in the console input buffer in the same way as the keyboard input events, but before I investigate this matter a point must be cleared.<br /><br />A running Batch file is <em class="text-italics">not</em> event driven, but GetInput.exe seems to do that: you execute GetInput.exe and the Batch file stop at that point, but <em class="text-italics">as soon as</em> an input is made, GetInput.exe ends and the Batch file continue. If you try to write a loop controlled by mouse clicks (read via GetInput), then the program will always have problems derived by the slowness of Batch file processing...<br /><br />Perhaps if you explain what exactly you try to do we could find another solution. Please, do not say: &quot;Do the same thing of choice command&quot;; such &quot;description&quot; say nothing at all!<br /><br />Antonio</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50153" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile50153">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist54f1.html?mode=viewprofile&amp;u=8229" class="username">misol101</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha06d.html?author_id=8229&amp;sr=posts">356</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 02 May 2016 18:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content50153">

						<h3 ><a href="#p50153">Re: Mouse-Selectable Menu from a data file - a/la CHOICE</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting2bc2.html?mode=quote&amp;f=3&amp;p=50153" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicb263.html?p=50153#p50153" onclick="prompt('Message #5',this.href); return false;">#5</a></span> 
									<a class="unread" href="viewtopicb263.html?p=50153#p50153" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist54f1.html?mode=viewprofile&amp;u=8229" class="username">misol101</a></strong> &raquo; </span>17 Nov 2016 20:36
			</p>
			
			
			
			<div class="content">I don't know how Aacini's program GetInput works, but I changed your test script to use my program &quot;cmdwiz&quot; with the &quot;getch_and_mouse&quot; operation instead.<br /><br />I removed the first loop as it seemed redundant and go straight to &quot;NextLoop&quot;.<br /><br />I *think* this behaves the way you want it, i.e it reports key presses and left and right mouse clicks and their locations, and after 9 seconds it terminates. (Note: at the moment it terminates after 9 seconds even if you have pressed a mouse button. I guess you would want to jump out of the loop when pressing a mouse button, but this is just a test, so... I put commented-out goto statements there to use anyway)<br /><br />Also note that, like Getinput, &quot;cmdwiz getch_and_mouse&quot; supports a timeout value. However, for your purposes it's largely useless because:<br />1. cmdwiz getch_and_mouse also reports mouse movements, even when no mouse button is pressed<br />2. As long as the mouse pointer is inside the cmd window, periodic mouse events are received even when mouse is not moving<br /><br />Instead, I keep track of time using &quot;cmdwiz gettime&quot; inside the loop.<br /><br />Note that I still use a timeout (1000) for &quot;cmdwiz getch_and_mouse&quot;. This is because if you don't, the operation will wait forever IF the mouse pointer is outside the cmd window.<br />Also note I use &quot;cmdwiz setquickedit 0&quot;. If quickedit is enabled, mouse activity may sometimes result in starting a quickedit marking operation instead of reporting back to cmdwiz.<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@Echo Off&amp;SetLocal EnableDelayedExpansion<br />&nbsp; &nbsp; Set &quot;windowCols=80&quot; <br />&nbsp; &nbsp; CLS <br />&nbsp; &nbsp; Echo(A few Fields in row 00 <br />&nbsp; &nbsp; Echo(Row 1<br />&nbsp; &nbsp; Echo('Esc' to terminate. <br />&nbsp; &nbsp; Echo(<br />&nbsp; &nbsp; Echo(Row # 4 <br />&nbsp; &nbsp; Echo(<br />&nbsp; &nbsp; Echo(Use the keyboard or mouse now.<br /><br />&nbsp; &nbsp; set /a TIMEOUT=9000<br />&nbsp; &nbsp; cmdwiz gettime &amp; set /a STARTTIME=!errorlevel!<br />&nbsp; &nbsp; cmdwiz setquickedit 0<br /><br />&nbsp; &nbsp; CursorPos&amp;Set /A &quot;BotRow=((!errorlevel!&gt;&gt;16)&amp;0xFFFF)-2, MsgRow=BotRow+3&quot;<br />::&nbsp; Interpret moused location using AuxProgram: cmdwiz<br />:InLoop<br />&nbsp; &nbsp; CursorPos 0 %MsgRow%<br />&nbsp; &nbsp; cmdwiz getch_and_mouse 1000 &gt; mouse_out.txt<br /><br />&nbsp; &nbsp; for /F &quot;tokens=1,3,5,7,9,11,13 delims= &quot; %%a in (mouse_out.txt) do set EVENT=%%a&amp;set key=%%b&amp;set MOUSE_EVENT=%%c&amp;set MX=%%d&amp;set MY=%%e&amp;set LMB=%%f&amp;set RMB=%%g<br />&nbsp; &nbsp; if &quot;%EVENT%&quot; == &quot;NO_EVENT&quot; set key=0<br /><br />&nbsp; &nbsp; If %key% GTR 0 (<br />&nbsp; &nbsp; &nbsp; &nbsp; CursorPos 0 -1<br />&nbsp; &nbsp; &nbsp; &nbsp; If &quot;%key%&quot; EQU &quot;27&quot; (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set /A &quot;CSlen=WindowCols-73&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ColorShow / &quot;Simulating a termination click because the '&quot; &quot;Esc&quot;&nbsp; &quot;' key was pressed. &quot; 32x!CSlen! 13 10 /07<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ColorShow / 32x%WindowCols% /<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set &quot;MRow=%BotRow%&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CursorPos 0 %MsgRow%<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Goto :Escape<br />Rem.&nbsp; &nbsp; &nbsp; &nbsp; Possible future use - filter numerals for multiple word selection<br />&nbsp; &nbsp; &nbsp; &nbsp; ) Else (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set /A &quot;CSlen=WindowCols-18&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ColorShow / &quot;A key, loosely interpreted as the '&quot; %key%&nbsp; &quot;' key was pressed. &quot; 32x!CSlen! 13 10 /07<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set /A &quot;MRow=BotRow+5&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; )<br />&nbsp; &nbsp; )<br />&nbsp; &nbsp; if &quot;%LMB%&quot;==&quot;1&quot; (<br />&nbsp; &nbsp; &nbsp; &nbsp; CursorPos 0 -1<br />&nbsp; &nbsp; &nbsp; &nbsp; Set /A &quot;CSlen=WindowCols-32&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; ColorShow /07 &quot;LEFT button click at row !MY!&nbsp; &quot; 32x!CSlen! 13 10<br />&nbsp; &nbsp; &nbsp; &nbsp; Show &quot;Mouse Left-click at Row %MY%, Col %MX%&nbsp; &quot; 13 10)<br />&nbsp; &nbsp; &nbsp; &nbsp; ::goto Escape<br />&nbsp; &nbsp; )<br />&nbsp; &nbsp; if &quot;%RMB%&quot;==&quot;1&quot; (<br />&nbsp; &nbsp; &nbsp; &nbsp; CursorPos 0 -1<br />&nbsp; &nbsp; &nbsp; &nbsp; Set /A &quot;CSlen=WindowCols-31&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; ColorShow /07 &quot;RIGHT button click at row !MY!&nbsp; &quot; 32x!CSlen! 13 10<br />&nbsp; &nbsp; &nbsp; &nbsp; Show &quot;Mouse Right-click at Row %MY%, Col %MX%&nbsp; &quot; 13 10)<br />&nbsp; &nbsp; &nbsp; &nbsp; ::goto Escape<br />&nbsp; &nbsp; )<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; cmdwiz gettime &amp; set /a ELAPSEDTIME=!errorlevel!-%STARTTIME%<br />&nbsp; &nbsp; if %ELAPSEDTIME% gtr %TIMEOUT% (<br />&nbsp; &nbsp; &nbsp; &nbsp; Set /A &quot;MRow=BotRow+5&quot;&nbsp; &nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; Show &quot;Timed out at %time%, defaulted to Row !MRow!&quot; 13 10<br />&nbsp; &nbsp; &nbsp; &nbsp; goto Escape<br />&nbsp; &nbsp; )<br />&nbsp;<br />&nbsp; &nbsp; Goto :InLoop <br />:Escape <br />&nbsp; &nbsp; del /Q mouse_out.txt<br />&nbsp; &nbsp; Exit /B <br /></code></pre></div><br /><br />Edit: I'm saving a file called mouse_out.txt to the current folder. In a real script you would want to save that file to a %TEMP% location instead.<br /><br />Edit 2: as for the &quot;:Basic&quot; loop that I removed, a timeout value of 0 to getch_and_mouse will give similar headaches to what Aacini described in his post. You need to use higher timeout values.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50154" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile50154">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist742a.html?mode=viewprofile&amp;u=6577" class="username">thefeduke</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search454a.html?author_id=6577&amp;sr=posts">211</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 05 Apr 2015 13:06</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> MA South Shore, USA</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content50154">

						<h3 ><a href="#p50154">Re: Mouse-Selectable Menu from a data file - a/la CHOICE</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingb4f3.html?mode=quote&amp;f=3&amp;p=50154" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic461e.html?p=50154#p50154" onclick="prompt('Message #6',this.href); return false;">#6</a></span> 
									<a class="unread" href="viewtopic461e.html?p=50154#p50154" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist742a.html?mode=viewprofile&amp;u=6577" class="username">thefeduke</a></strong> &raquo; </span>17 Nov 2016 22:38
			</p>
			
			
			
			<div class="content">Thank you for looking at this for me. <blockquote><div><cite>Aacini wrote:</cite>It seems that mouse click events don't stay in the console input buffer in the same way as the keyboard input events, but before I investigate this matter a point must be cleared.</div></blockquote>It seems that before anything, I had to solve a very basic problem, as evidenced by: <div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>F:\John 16GB Px\Scripts\AuxPrograms&gt;where /R F:\ /t getinput<br />&nbsp; &nbsp; &nbsp; 1536&nbsp; &nbsp; 2/4/2014&nbsp; &nbsp; 6:53:48 PM&nbsp; F:\John 16GB Px\Script<br />&nbsp; &nbsp; &nbsp; 3072&nbsp; &nbsp; 3/5/2014&nbsp; &nbsp; 7:59:46 PM&nbsp; F:\John 16GB Px\Script<br />&nbsp; &nbsp; &nbsp; 3072&nbsp; &nbsp; 3/5/2014&nbsp; &nbsp; 7:59:46 PM&nbsp; F:\John 16GB Px\Script<br />&nbsp; &nbsp; &nbsp; 3072&nbsp; &nbsp; 3/5/2014&nbsp; &nbsp; 7:59:46 PM&nbsp; F:\John 16GB Px\Zani D</code></pre></div> I was not using your distributed version.  My experiments are going better, now that I have one that recognizes the switch in the first place.  I think that I picked that one up from a old topic where you checked for its presence and rebuilt it if it could not be found.<br /><br />As for the vague description, I was thinking of adding an option for a default selection if there were no action by the time that an optional timeout expired. <br /><br />I did find an interaction with Quick Edit that prevents mouse clicks from being recognized that I had not experience before using the /T switch in GetInput.  Once the window is opened with that property checked or unchecked, it has a memory that reverts to that state, without regard to manipulation by changing it with properties or cmdwiz in batch.  just running a command can reset it, but I don't know exactly how. The uploaded version does not seem to be affected.<br /><br />Thank you for your help.<br /><br />John A.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50155" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile50155">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist742a.html?mode=viewprofile&amp;u=6577" class="username">thefeduke</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search454a.html?author_id=6577&amp;sr=posts">211</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 05 Apr 2015 13:06</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> MA South Shore, USA</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content50155">

						<h3 ><a href="#p50155">Re: Mouse-Selectable Menu from a data file - a/la CHOICE</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingf674.html?mode=quote&amp;f=3&amp;p=50155" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic6ec7.html?p=50155#p50155" onclick="prompt('Message #7',this.href); return false;">#7</a></span> 
									<a class="unread" href="viewtopic6ec7.html?p=50155#p50155" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist742a.html?mode=viewprofile&amp;u=6577" class="username">thefeduke</a></strong> &raquo; </span>17 Nov 2016 23:07
			</p>
			
			
			
			<div class="content">Thank you for taking the trouble. <blockquote><div><cite>misol101 wrote:</cite>I removed the first loop as it seemed redundant and go straight to &quot;NextLoop&quot;.<br />.....<br /> However, for your purposes it's largely useless <br />.....<br />Also note I use &quot;cmdwiz setquickedit 0&quot;. If quickedit is enabled, mouse activity may sometimes result in starting a quickedit marking operation instead of reporting back to cmdwiz.<br />.....<br />Edit 2: as for the &quot;:Basic&quot; loop that I removed, a timeout value of 0 to getch_and_mouse will give similar headaches to what Aacini described in his post. You need to use higher timeout values.</div></blockquote>The redundant loop was just there to see if anything at all worked before I attempted decision-making and the timeout value was of no real consequence.  For my purposes, I agree, but useless is too strong a word.<br /><br />I am still troubled by quickedit.  Please see my previous post to Aacini.  Under the right conditions, the properties were used to uncheck the box and running getquickedit reported it on and back to properties it was indeed on.  I set it off with setquickedit and lo and behold running getquickedit turned it on. It's magic.<br /><br />John A.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50162" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile50162">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchdc63.html?author_id=2923&amp;sr=posts">1540</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 06 Dec 2011 22:15</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> México City, México</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content50162">

						<h3 ><a href="#p50162">Re: Mouse-Selectable Menu from a data file - a/la CHOICE</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingf061.html?mode=quote&amp;f=3&amp;p=50162" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic01aa.html?p=50162#p50162" onclick="prompt('Message #8',this.href); return false;">#8</a></span> 
									<a class="unread" href="viewtopic01aa.html?p=50162#p50162" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a></strong> &raquo; </span>18 Nov 2016 18:48
			</p>
			
			
			
			<div class="content">I created a .zip file with all auxiliary .exe programs and companion text files and attached it to the first post in <a href="viewtopicc107.html?p=17101#p17101" class="postlink">auxiliary .exe programs</a> thread; I suggest you to download such file so you have the current version of GetInput.exe.<br /><br />GetInput.exe program turn off QuickEdit, Ctrl-C and LineInput modes at start and recover the original settings at end, so it doesn't require any manual adjustment on this point.<br /><br />The CHOICE /D switch requires that the default be one of the given options, so you can not distinguish a timeout from the default option. GetInput.exe return zero when timeout, so you may choose if the timeout imply a default option or another different action. For example:<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br /><br />cls<br />echo&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ÉÍÍÍÍÍËÍÍÍÍÍ»<br />echo&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; º&nbsp; &nbsp; &nbsp;º&nbsp; &nbsp; &nbsp;º<br />echo Select an option via mouse click:&nbsp; º No&nbsp; º Yes º<br />echo&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; º&nbsp; &nbsp; &nbsp;º&nbsp; &nbsp; &nbsp;º<br />echo&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ÈÍÍÍÍÍÊÍÍÍÍÍ¼<br />echo/<br /><br />GetInput /T 9000 &quot;NY&quot; /M&nbsp; 36 1 40 3&nbsp; 42 1 46 3<br />if %errorlevel% equ 0 (<br />&nbsp; &nbsp;echo 9 seconds timeout!<br />) else if %errorlevel% equ 1 (<br />&nbsp; &nbsp;echo No...<br />) else if %errorlevel% equ 2 (<br />&nbsp; &nbsp;echo Yes!<br />)<br /></code></pre></div><br />Antonio</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50163" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile50163">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist742a.html?mode=viewprofile&amp;u=6577" class="username">thefeduke</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search454a.html?author_id=6577&amp;sr=posts">211</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 05 Apr 2015 13:06</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> MA South Shore, USA</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content50163">

						<h3 ><a href="#p50163"></a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinga7d7.html?mode=quote&amp;f=3&amp;p=50163" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicf704.html?p=50163#p50163" onclick="prompt('Message #9',this.href); return false;">#9</a></span> 
									<a class="unread" href="viewtopicf704.html?p=50163#p50163" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist742a.html?mode=viewprofile&amp;u=6577" class="username">thefeduke</a></strong> &raquo; </span>19 Nov 2016 01:48
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>Aacini wrote:</cite>..... <br />I suggest you to download such file so you have the current version of GetInput.exe.<br />.....<br />The CHOICE /D switch requires that the default be one of the given options, so you can not distinguish a timeout from the default option. GetInput.exe return zero when timeout, so you may choose if the timeout imply a default option or another different action. For example:</div></blockquote>I had resolved my version problem and am working from a library that I downloaded in Sept.  Thank you for the example.  I see what you mean, if I did this: <div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>GetInput /T 9000 /I &quot;123MNY&quot; /M&nbsp; 37 1 41 3&nbsp; 28 1 32 3 43 1 47 3 46 1 53 3 <br /></code></pre></div> only codes 5 and 6 are unique as only characters,  the 123 characters are place holders for the mouse, so that 4 has a shared meaning the is the same for click or keyboard.<br /><br />My intention is to assign a row number as a default selection and to use the timeout to simulate the results of a mouse-click on that row and then allow the existing structure to run its course. That fits into my philosophy of avoiding action hard-coded analysis of multiple return codes, based on one character choices.  Rather than a optional arguments like the /T and /D of CHOICE, why not continue to let the data define the menu?  Something like <div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>Rem.Timeout nnnnn Default rrr</code></pre></div>as the last line of the input would be visible in the view, execute harmlessly as a remark if clicked to run and be easily parsed into <span style="text-decoration: underline">Set &quot;TO=/T nnnnn&quot;</span> for a <span style="text-decoration: underline">GetInput %TO%</span> command.  <br /><br /><blockquote><div><cite>Aacini wrote:</cite>GetInput.exe program turn off QuickEdit, Ctrl-C and LineInput modes at start and recover the original settings at end, so it doesn't require any manual adjustment on this point. </div></blockquote>This is still a problem area for me.  I have touched on this in a couple of posts, but now I have some experimental results to narrow the problem.  Someone else may understand under the cover, but I can only document the behavior.  I start with two shortcuts to the Command Prompt. I set the QuickEdit property of one OFF and the other ON before opening either window.  The properties of the newly opened windows are as expected.  Dragging the left mouse button is also a good indication.  If you change the QuickEdit property of each window to its opposite, again everything appears as expected. The ugliness begins if you run <span style="text-decoration: underline">find /?</span>.  <span style="color: #BF0040">Both windows have reverted to their newly opened state.</span>  Some other commands also wreak this havoc: FINDSTR, cmdwiz getQuickEdit and likely others.  Remarkably,  cmdwiz setquickedit does its function, but just the act of checking with cmdwiz getquickedit has a chance of flipping the setting depending on the originally opened state.  <br /><br />What does it all mean?  Are there two sets of properties?  The real boss comes out of hiding when angered?  All of this means absolutely nothing to GetInput and MChoice as long as the /T switch of Getinput is not used.  Otherwise my mouse is preempted by QuickEdit only if the window was originally opened with QuickEdit set ON.  I cannot click, but I can cut and paste well.  I am: <div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&nbsp;INFO.BAT version 1.2<br />--------------------------------------------------------------------------------<br />Windows version&nbsp; &nbsp; &nbsp; &nbsp; :&nbsp; Microsoft Windows &#91;Version 10.0.14393&#93;<br />Product name&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;:&nbsp; Windows 10 Home, 64 bit<br />Performance indicators :&nbsp; Processor Cores: 2&nbsp; &nbsp; &nbsp; Visible RAM: 7951624 kilobytes<br /><br />Date/Time format&nbsp; &nbsp; &nbsp; &nbsp;:&nbsp; (mm/dd/yy)&nbsp; Sat 11/19/2016&nbsp; &nbsp;2:39:08.06<br />__APPDIR__&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;:&nbsp; C:\WINDOWS\system32\<br />ComSpec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :&nbsp; C:\WINDOWS\system32\cmd.exe<br />PathExt&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :&nbsp; .COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC<br />Extensions&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;:&nbsp; system: Enabled&nbsp; &nbsp;user: Enabled <br />Delayed expansion&nbsp; &nbsp; &nbsp; :&nbsp; system: Disabled&nbsp; user: Disabled<br />Locale name&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :&nbsp; en-US&nbsp; &nbsp; &nbsp; &nbsp;Code Pages: OEM&nbsp; 437&nbsp; &nbsp; ANSI 1252<br />DIR&nbsp; format&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :&nbsp; 11/13/2016&nbsp; 07:10 PM&nbsp; &nbsp; &nbsp; &nbsp;419,430,400 pagefile.sys<br />Permissions&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :&nbsp; Elevated Admin=No, Admin group=Yes<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Missing from the tool collection:&nbsp; debug<br /></code></pre></div> <br />John A.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50164" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile50164">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist54f1.html?mode=viewprofile&amp;u=8229" class="username">misol101</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha06d.html?author_id=8229&amp;sr=posts">356</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 02 May 2016 18:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content50164">

						<h3 ><a href="#p50164">Re: Mouse-Selectable Menu from a data file - a/la CHOICE</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinge31b-2.html?mode=quote&amp;f=3&amp;p=50164" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic8e02.html?p=50164#p50164" onclick="prompt('Message #10',this.href); return false;">#10</a></span> 
									<a class="unread" href="viewtopic8e02.html?p=50164#p50164" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist54f1.html?mode=viewprofile&amp;u=8229" class="username">misol101</a></strong> &raquo; </span>19 Nov 2016 03:10
			</p>
			
			
			
			<div class="content">I don't know about those quickedit problems. All I'm doing in &quot;cmdwiz getquickedit&quot; is call GetConsoleMode(GetStdHandle(STD_INPUT_HANDLE), &amp;fdwMode). So unless that Windows API is messed up somehow I don't have an explanation.<br /><br /><blockquote class="uncited"><div>GetInput.exe program turn off QuickEdit, Ctrl-C and LineInput modes at start and recover the original settings at end, so it doesn't require any manual adjustment on this point.</div></blockquote><br />I don't think this is enough though, you need to also disable quickedit when GetInput is not running (with cmdwiz setquickedit or similar), otherwise if quickedit is enabled a mouse click could possibly happen just before or just after GetInput runs, in which case you would get into quickedit marking mode (which you can visibly see).<br /><br />Edit: the above is true in a loop scenario such as your test script, but I guess your end result script MChoice won't have loops if the GetInput /T switch works properly, so then it won't be a problem and you can ignore what I wrote above</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50172" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile50172">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist742a.html?mode=viewprofile&amp;u=6577" class="username">thefeduke</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search454a.html?author_id=6577&amp;sr=posts">211</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 05 Apr 2015 13:06</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> MA South Shore, USA</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content50172">

						<h3 ><a href="#p50172">Re: Mouse-Selectable Menu from a data file - a/la CHOICE</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingb702.html?mode=quote&amp;f=3&amp;p=50172" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopica860.html?p=50172#p50172" onclick="prompt('Message #11',this.href); return false;">#11</a></span> 
									<a class="unread" href="viewtopica860.html?p=50172#p50172" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist742a.html?mode=viewprofile&amp;u=6577" class="username">thefeduke</a></strong> &raquo; </span>19 Nov 2016 15:09
			</p>
			
			
			
			<div class="content">Mikael,<blockquote><div><cite>misol101 wrote:</cite>So unless that Windows API is messed up somehow I don't have an explanation.</div></blockquote>Here is the briefest way to demonstrate the behaviour that I tried to explain in narrative, not in code.  I ran this script in two different windows: <div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@Echo Off<br />CmdWiz SetQuickEdit 0<br />Echo(Just ran SetQuickEdit 0<br />CmdWiz GetQuickEdit<br />Echo(rc from GetQuickEdit: %ErrorLevel%<br />CmdWiz SetQuickEdit 1<br />Echo(Just ran SetQuickEdit 1 <br />CmdWiz GetQuickEdit<br />Echo(rc from GetQuickEdit: %ErrorLevel%<br /></code></pre></div>and got these results:<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>Just ran SetQuickEdit 0<br />rc from GetQuickEdit: 1<br />Just ran SetQuickEdit 1<br />rc from GetQuickEdit: 1</code></pre></div><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>Just ran SetQuickEdit 0<br />rc from GetQuickEdit: 0<br />Just ran SetQuickEdit 1<br />rc from GetQuickEdit: 0</code></pre></div><br />John A.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50175" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile50175">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist54f1.html?mode=viewprofile&amp;u=8229" class="username">misol101</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha06d.html?author_id=8229&amp;sr=posts">356</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 02 May 2016 18:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content50175">

						<h3 ><a href="#p50175">Re: Mouse-Selectable Menu from a data file - a/la CHOICE</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting980a.html?mode=quote&amp;f=3&amp;p=50175" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic7db7.html?p=50175#p50175" onclick="prompt('Message #12',this.href); return false;">#12</a></span> 
									<a class="unread" href="viewtopic7db7.html?p=50175#p50175" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist54f1.html?mode=viewprofile&amp;u=8229" class="username">misol101</a></strong> &raquo; </span>19 Nov 2016 19:30
			</p>
			
			
			
			<div class="content">No clue to be honest, quite strange. It produces 0,0,1,1 here, like it should (Win 7). Does it actually behave like what GetQuickEdit reports? (for example in your second example, is quickedit actually off after the script finishes?)<br /><br />Edit: runs as expected on my Windows 8 machine too, so yeah, no clue really what's going on over there <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /></div>

			
													<div class="notice">
					Last edited by <a href="memberlist54f1.html?mode=viewprofile&amp;u=8229" class="username">misol101</a> on 20 Nov 2016 06:37, edited 1 time in total.
									</div>
			
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50176" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile50176">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist742a.html?mode=viewprofile&amp;u=6577" class="username">thefeduke</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search454a.html?author_id=6577&amp;sr=posts">211</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 05 Apr 2015 13:06</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> MA South Shore, USA</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content50176">

						<h3 ><a href="#p50176">Re: Mouse-Selectable Menu from a data file - a/la CHOICE</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting92e1.html?mode=quote&amp;f=3&amp;p=50176" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicd869.html?p=50176#p50176" onclick="prompt('Message #13',this.href); return false;">#13</a></span> 
									<a class="unread" href="viewtopicd869.html?p=50176#p50176" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist742a.html?mode=viewprofile&amp;u=6577" class="username">thefeduke</a></strong> &raquo; </span>19 Nov 2016 23:45
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>misol101 wrote:</cite>No clue to be honest, quite strange. It produces 0,0,1,1 here, like it should (Win 7). Does it actually behave like what GetQuickEdit reports? (for example in your second example, is quickedit actually off after the script finishes?)</div></blockquote>There is a reply that I can work with.  All experiments with a script peppered with PAUSEs and directly from the command line allow Quick Edit functions consistent with what GetQuickEdit reports. I no longer have a Windows 7 system.  My Windows 10 systems are based on Win8, Win7 64-bit and Win 7 32-bit.  GetQuickEdit consistently reports the Quick Edit status when the window first opened and then actually changes the behavior of the window to that reported state. I get exactly the same effect as running <span style="text-decoration: underline">FINDSTR /?</span>.  Since GetInput.exe acts the same with the /T switch and flawlessly without.  I'll just check the return code and activate /T appropriately, based on a Windows 10 internal difference.  <br /><br />My question in the second post is now resolved to my satisfaction  All I need now is any feedback about what I did roll out in the first post,  while I work on Version 0.1 .  Execution of the selected line is working and I am polishing up this timeout option.  Thanks to Antonio and Mikael for your comments.<br /><br />John.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50179" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile50179">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchdc63.html?author_id=2923&amp;sr=posts">1540</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 06 Dec 2011 22:15</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> México City, México</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content50179">

						<h3 ><a href="#p50179">Re: Mouse-Selectable Menu from a data file - a/la CHOICE</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingc266.html?mode=quote&amp;f=3&amp;p=50179" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic409b-2.html?p=50179#p50179" onclick="prompt('Message #14',this.href); return false;">#14</a></span> 
									<a class="unread" href="viewtopic409b-2.html?p=50179#p50179" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a></strong> &raquo; </span>20 Nov 2016 12:23
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>thefeduke wrote:</cite>My intention is to assign a row number as a default selection and to use the timeout to simulate the results of a mouse-click on that row and then allow the existing structure to run its course.<br /></div></blockquote><br />GetInput return zero when a timeout occur as I said before, so such zero is <em class="text-italics">not</em> related to anyone of the options. You may link the zero to anything you want via additional code (independant of GetInput operation).<br /><br /><blockquote><div><cite>thefeduke wrote:</cite>That fits into my philosophy of avoiding action hard-coded analysis of multiple return codes, based on one character choices. Rather than a optional arguments like the /T and /D of CHOICE, why not continue to let the data define the menu? <br /></div></blockquote><br />I am afraid I don't understand what you mean, but I think the code below is an example of &quot;avoid action hard-coded analysis of multiple return codes&quot;. In this program the actions are not hard-coded, but defined as data in an array that may also be read from a file; note that this method have no relation to GetInput, so it may also be used on values read by CHOICE, or SET /P commands. The positions of the mouse selection rectangles are not hard-coded either, but calculated (and modified) at run-time, and the &quot;default timeout selection&quot; is assigned to the center rectangle.<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br /><br />mode con: cols=80 lines=39<br />setlocal EnableDelayedExpansion<br />set &quot;action&#91;0&#93;=goto Timeout&quot;<br />set &quot;action&#91;1&#93;=set /A Top-=^!^!Top*2&quot;<br />set &quot;action&#91;2&#93;=set /A Left-=^!^!Left*3&quot;<br />set &quot;action&#91;3&#93;=set /A Left-=(Left-58&gt;&gt;31)*3&quot;<br />set &quot;action&#91;4&#93;=set /A Top-=(Top-25&gt;&gt;31)*2&quot;<br />set &quot;action&#91;5&#93;=goto Terminate&quot;<br /><br />set &quot;SP= &quot;<br />for /L %%i in (1,1,6) do set &quot;SP=!SP!!SP!&quot;<br />set F2=201 206 188 200<br />set F3=206 187 188 200<br />set F4=206 206 188 200<br />set /A Left=0, Top=0<br /><br />:loop<br />set /A L1=Left+6, T1=Top, L2=Left, T2=T1+4, L3=L1+6, T3=T1+4, L4=L1, T4=T3+4<br />set &quot;M=&quot;<br />for /L %%i in (1,1,4) do (<br />&nbsp; &nbsp;set /A R%%i=L%%i+6, B%%i=T%%i+4,&nbsp; L=L%%i+1, T=T%%i+1, R=R%%i-1, B=B%%i-1<br />&nbsp; &nbsp;set &quot;M=!M! !L! !T! !R! !B!&quot;<br />)<br />set /A L=L1+1, T=T2+1, R=R1-1, B=B2-1, Tp=Top+2<br />set &quot;M=%M% %L% %T% %R% %B%&quot;<br /><br />(<br />cls<br />for /L %%i in (1,1,%Tp%) do echo/<br />echo !SP:~0,%Left%!&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;UP<br />echo/&amp;echo/&amp;echo/<br />echo !SP:~0,%Left%! LEFT&nbsp; &nbsp; OK&nbsp; RIGHT<br />echo/&amp;echo/&amp;echo/<br />echo !SP:~0,%Left%!&nbsp; &nbsp; &nbsp; &nbsp; DOWN<br />for /L %%i in (1,1,4) do ColorBox !L%%i! !T%%i! !R%%i! !B%%i! /D !F%%i!<br />)<br /><br />rem&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP&nbsp; LEFT RIGHT DOWN ENTER<br />GetInput&nbsp; /T 9000&nbsp; 294 293&nbsp; 295&nbsp; &nbsp;296&nbsp; 13&nbsp; &nbsp; /M %M%<br />!action&#91;%errorlevel%&#93;!<br />goto loop<br /><br />:Timeout<br />echo/&amp;echo/<br />echo Timeout...<br />:Terminate<br />echo/&amp;echo/<br />echo You selected this position<br /></code></pre></div><br /><br /><blockquote><div><cite>thefeduke wrote:</cite><blockquote><div><cite>Aacini wrote:</cite>GetInput.exe program turn off QuickEdit, Ctrl-C and LineInput modes at start and recover the original settings at end, so it doesn't require any manual adjustment on this point.<br /></div></blockquote><br />This is still a problem area for me. I have touched on this in a couple of posts, but now I have some experimental results to narrow the problem. Someone else may understand under the cover, but I can only document the behavior. I start with two shortcuts to the Command Prompt. I set the QuickEdit property of one OFF and the other ON before opening either window. The properties of the newly opened windows are as expected. Dragging the left mouse button is also a good indication. If you change the QuickEdit property of each window to its opposite, again everything appears as expected. The ugliness begins if you run find /?. Both windows have reverted to their newly opened state. Some other commands also wreak this havoc: FINDSTR, cmdwiz getQuickEdit and likely others. Remarkably, cmdwiz setquickedit does its function, but just the act of checking with cmdwiz getquickedit has a chance of flipping the setting depending on the originally opened state. <br /><br />What does it all mean? Are there two sets of properties? The real boss comes out of hiding when angered? All of this means absolutely nothing to GetInput and MChoice as long as the /T switch of Getinput is not used. Otherwise my mouse is preempted by QuickEdit only if the window was originally opened with QuickEdit set ON. I cannot click, but I can cut and paste well.<br /></div></blockquote><br /><br />Well, if this involved description means that &quot;GetInput.exe fail when the cmd.exe window have the QuickEdit property set to ON and the /T switch is used&quot;, then YOU ARE RIGHT!  <img class="smilies" src="images/smilies/icon_eek.gif" alt=":shock:" title="Shocked" /> I confirmed this behavior <img class="smilies" src="images/smilies/icon_confused.gif" alt=":?" title="Confused" /> , so I carefully reviewed the description of <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms686033(v=vs.85).aspx" class="postlink">SetConsoleMode</a> Win-32 API function I used to develop this program and I can <em class="text-italics">NOT</em> found any error in my code! It seems that there are certain status combinations that are not documented. Then, I ignored the official documentation and completed some tests until I discovered that it is necessary to turn off <em class="text-italics">all status</em> (excepting ENABLE_MOUSE_INPUT) in order for this method to work: <strong class="text-strong">SetConsoleMode( hConsoleHandle, ENABLE_MOUSE_INPUT + ENABLE_EXTENDED_FLAGS )</strong>. After that, GetInput worked correctly always, don't matters the previous QuickEdit status.<br /><br />I updated the GetInput.exe version in the .zip file at the <a href="viewtopicc107.html?p=17101#p17101" class="postlink">auxiliary .exe programs post</a>; I suggest you to delete your GetInput.exe file(s) and download the .zip file again. Please, post the results with the new version.<br /><br />Antonio</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50190" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile50190">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist742a.html?mode=viewprofile&amp;u=6577" class="username">thefeduke</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search454a.html?author_id=6577&amp;sr=posts">211</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 05 Apr 2015 13:06</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> MA South Shore, USA</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content50190">

						<h3 ><a href="#p50190">Re: Mouse-Selectable Menu from a data file - a/la CHOICE</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting2bef.html?mode=quote&amp;f=3&amp;p=50190" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicf497.html?p=50190#p50190" onclick="prompt('Message #15',this.href); return false;">#15</a></span> 
									<a class="unread" href="viewtopicf497.html?p=50190#p50190" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist742a.html?mode=viewprofile&amp;u=6577" class="username">thefeduke</a></strong> &raquo; </span>21 Nov 2016 01:43
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>Aacini wrote:</cite><blockquote><div><cite>thefeduke wrote:</cite>My intention is to assign a row number as a default selection and to use the timeout to simulate the results of a mouse-click on that row and then allow the existing structure to run its course.<br /></div></blockquote><br />GetInput return zero when a timeout occur as I said before, so such zero is <em class="text-italics">not</em> related to anyone of the options. You may link the zero to anything you want via additional code (independent of GetInput operation).</div></blockquote>It seems that we are in complete agreement here.  Thank you for the encouragement.<blockquote><div><cite>Aacini wrote:</cite><blockquote><div><cite>thefeduke wrote:</cite>That fits into my philosophy of avoiding action hard-coded analysis of multiple return codes, based on one character choices. Rather than a optional arguments like the /T and /D of CHOICE, why not continue to let the data define the menu? <br /></div></blockquote><br />I am afraid I don't understand what you mean </div></blockquote>Because my approach is let the data define the menu I had no interest (in this particular application) in the <span style="text-decoration: underline">/I &quot;Chars&quot; keycode...</span> options of GetInput.  One still needs to code an action plan for each return code.  Your example is dynamic in the values for the five areas but it is programmed specifically for those five.  Consider adding it to you Aux examples. It seemed far less overwhelming than snake.bat. You already know why I was attracted to the Timeout option.  More inspiration: Those /M boxes might be less clumsy than what I did for the non-data selections, like the Quit line. <blockquote><div><cite>Aacini wrote:</cite>I updated the GetInput.exe version ... Please, post the results with the new version.</div></blockquote> Thank you for being so tenacious and responsive, especially after I had already &quot;cried wolf&quot; once when it was my error.  I am cursed in creating such &quot;rare&quot; isolated circumstances.  I am happy to report that my results were what I had hoped and you had expected.<br /><br />An image of the output screen for this test has replaced my original output example in the first post of this topic.<br /><br />John A.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
	

	<div class="action-bar bar-bottom">
	
			<a href="posting85bc-2.html?mode=reply&amp;f=3&amp;t=7549" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic3c66.html?f=3&amp;t=7549&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

			<form method="post" action="https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=7549">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			17 posts
							<ul>
		<li class="active"><span>1</span></li>
				<li><a class="button" href="viewtopicb0e6.html?f=3&amp;t=7549&amp;start=15" role="button">2</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopicb0e6.html?f=3&amp;t=7549&amp;start=15" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="viewforum4d6b.html?f=3" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to “DOS Batch Forum”</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="viewforum31e6.html?f=4" class="jumpbox-cat-link"> <span> DosTips - Dos Batch</span></a></li>
																<li><a href="viewforum4d6b.html?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; DOS Batch Forum</span></a></li>
											</ul>
		</div>
	</div>

	</div>


			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
							<span class="crumb"><a href="../index.html" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>DosTips.com</span></a></span>									<span class="crumb"><a href="index.html" data-navbar-reference="index"><span>Board index</span></a></span>					</li>
		
				<li class="rightside">All times are <span title="UTC-6">UTC-06:00</span></li>
							<li class="rightside">
				<a href="ucp033a.html?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete all board cookies</span>
				</a>
			</li>
												<li class="rightside" data-last-responsive="true">
				<a href="memberlist4bfd.html?mode=team" role="menuitem">
					<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
				</a>
			</li>
									<li class="rightside" data-last-responsive="true">
				<a href="memberlist8733.html?mode=contactadmin" role="menuitem">
					<i class="icon fa-envelope fa-fw" aria-hidden="true"></i><span>Contact us</span>
				</a>
			</li>
			</ul>

	</div>
</div>

	<div class="copyright">
				<!-- WARNING NO DELETE -->Style developer by <a href="http://tricolor.x-tk.ru/">support forum tricolor</a>, <!-- END WARNING NO DELETE -->Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
									</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	<img src="cron68e3.gif?cron_type=cron.task.text_reparser.pm_text" width="1" height="1" alt="cron" /></div>

<script type="text/javascript" src="assets/javascript/jquery.mind772.js?assets_version=34"></script>
<script type="text/javascript" src="assets/javascript/cored772.js?assets_version=34"></script>



<script type="text/javascript" src="styles/prosilver/template/forum_fnd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/prosilver/template/ajaxd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/jquery-uid772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/collapsed772.js?assets_version=34"></script>



</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=7549 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 06:39:32 GMT -->
</html>
