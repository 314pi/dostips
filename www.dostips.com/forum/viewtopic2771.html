<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?p=41031 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 06:46:16 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>JSORT.BAT v4.2 - Case sensitive sort with option for numeric sort - Page 3 - DosTips.com</title>


	<link rel="canonical" href="viewtopic37af.html?t=5595&amp;start=30">

<!--
	phpBB style name: Allan Style - SUBSILVER
	Based on style:   prosilver (this is the default phpBB3 style)
	Based on style:   subsilver2 (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:  Allan ( http://x-tk.ru/ )
-->

<link href="assets/css/font-awesome.mind772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/stylesheetd772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/en/stylesheetd772.css?assets_version=34" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="./styles/AllanStyle-SUBSILVER/theme/tweaks.css?assets_version=34" rel="stylesheet">
<![endif]-->




<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','../../www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-280191-1', 'auto');
	ga('send', 'pageview');
</script>

</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">

<div id="header-subsilver">
	<a id="top" class="top-anchor" accesskey="t"></a>
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description" class="site-description">
				<a id="logo" class="logo" href="../index.html" title="DosTips.com"><span class="site_logo"></span></a>
				<h1>DosTips.com</h1>
				<p>A Forum all about DOS Batch</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

									<div id="search-box" class="search-box search-header" role="search">
				<form action="https://www.dostips.com/forum/search.php" method="get" id="search">
				<fieldset>
					<input name="keywords" id="keywords" type="search" maxlength="128" title="Search for keywords" class="inputbox search tiny" size="20" value="" placeholder="Search…" />
					<button class="button button-search" type="submit" title="Search">
						<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
					</button>
					<a href="search.html" class="button button-search-end" title="Advanced search">
						<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
					</a>
					
				</fieldset>
				</form>
			</div>
						
			</div>
					</div>
</div>


<div id="wrap" class="wrap">
	<div id="page-header">
				<div class="navbar-top" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
																									<li>
								<a href="search33a7.html?search_id=unanswered" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="search526f.html?search_id=active_topics" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-blue" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="search.html" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
											<li class="separator"></li>
																			<li>
								<a href="memberlist4bfd.html?mode=team" role="menuitem">
									<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
								</a>
							</li>
																<li class="separator"></li>

									</ul>
			</div>
		</li>

				<li data-skip-responsive="true">
			<a href="app.php/help/faq.html" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
						
			<li class="rightside"  data-skip-responsive="true">
			<a href="ucp26c3.html?mode=login" title="Login" accesskey="x" role="menuitem">
				<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Login</span>
			</a>
		</li>
					<li class="rightside" data-skip-responsive="true">
				<a href="ucp8319.html?mode=register" role="menuitem">
					<i class="icon fa-pencil-square-o  fa-fw" aria-hidden="true"></i><span>Register</span>
				</a>
			</li>
						</ul>

	</div>
</div>

<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
						<li class="breadcrumbs">
							<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="../index.html" itemprop="url" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span itemprop="title">DosTips.com</span></a></span>
										<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="index.html" itemprop="url" accesskey="h" data-navbar-reference="index"><span itemprop="title">Board index</span></a></span>

											<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="4"><a href="viewforum31e6.html?f=4" itemprop="url"><span itemprop="title">DosTips - Dos Batch</span></a></span>
															<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="3"><a href="viewforum4d6b.html?f=3" itemprop="url"><span itemprop="title">DOS Batch Forum</span></a></span>
												</li>
		
					<li class="rightside responsive-search">
				<a href="search.html" title="View the advanced search options" role="menuitem">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</a>
			</li>
			</ul>

	</div>
</div>

<div class="navbar-top-link">
	<div class="inner">
		<ul>
			<li class="navbar-top-link-left"><a href="search33a7.html?search_id=unanswered">Unanswered topics</a></li>
			<li class="navbar-top-link-left"><a href="search526f.html?search_id=active_topics">Active topics</a></li>

											</ul>
	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
		
<h2 class="topic-title"><a href="viewtopicd770.html?f=3&amp;t=5595&amp;start=30">JSORT.BAT v4.2 - Case sensitive sort with option for numeric sort</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">Discussion forum for all Windows batch related topics.<br /></div>
<p>
	<strong>Moderator:</strong> <a href="memberlista6a8.html?mode=viewprofile&amp;u=5" class="username">DosItHelp</a>
</p>


<div class="action-bar bar-top">
	
			<a href="posting5cc0.html?mode=reply&amp;f=3&amp;t=5595" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic4a0f.html?f=3&amp;t=5595&amp;start=30&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="https://www.dostips.com/forum/search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topic…" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="search.html" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="5595" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			47 posts
							<ul>
			<li class="arrow previous"><a class="button button-icon-only" href="viewtopic4ecd.html?f=3&amp;t=5595&amp;start=15" rel="prev" role="button"><i class="icon fa-chevron-left fa-fw" aria-hidden="true"></i><span class="sr-only">Previous</span></a></li>
				<li><a class="button" href="viewtopicf1eb.html?f=3&amp;t=5595" role="button">1</a></li>
				<li><a class="button" href="viewtopic4ecd.html?f=3&amp;t=5595&amp;start=15" role="button">2</a></li>
			<li class="active"><span>3</span></li>
				<li><a class="button" href="viewtopic89dc.html?f=3&amp;t=5595&amp;start=45" role="button">4</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopic89dc.html?f=3&amp;t=5595&amp;start=45" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
		</div>




<div id="subsilver-nav-topic">
	<div class="inner"><div class="post has-profile">
		<div class="leftsided postbody subsilver-topic-title">Message</div>
		<div class="leftsided postprofile subsilver-topic-author">Author</div>
	</div></div>
</div>

			<div id="p39065" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile39065">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content39065">

						<h3 class="first"><a href="#p39065">Re: JSORT.BAT - Case sensitive sort with option for numeric</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting6fe1.html?mode=quote&amp;f=3&amp;p=39065" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic0fd3.html?p=39065#p39065" onclick="prompt('Message #31',this.href); return false;">#31</a></span> 
									<a class="unread" href="viewtopic0fd3.html?p=39065#p39065" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>05 Jan 2015 16:38
			</p>
			
			
			
			<div class="content">OK - below is release 3.3 that supports negative token numbers, meaning search for tokens from right to left, with -1 being the last token. Note that a negative value will only recognize tokens that occur after the delimiter.<br /><br />The solution for <a href="viewtopicc6f9.html?p=39056#p39056" class="postlink">foxidrives problem</a> is now as simple as:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>jsort test.txt /d &quot;(&quot; /t -1<br /></code></pre></div><br /><br />JSORT.BAT version 3.3<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@if (@X)==(@Y) @end /* Harmless hybrid line that begins a JScript comment<br /><br />::************ Documentation ***********<br />::JSORT.BAT version 3.3<br />:::<br />:::JSORT &#91;File&#93; &#91;/Option &#91;Value&#93;&#93;...<br />:::<br />:::&nbsp; Sort lines of text from stdin and write the result to stdout.<br />:::&nbsp; JSORT uses an ascending, case sensitive text sort by default.<br />:::<br />:::&nbsp; &nbsp; File - If the optional File argument is specified, then JSORT reads lines<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;from the file instead of from stdin. If specified, the File must<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;be the very first argument.<br />:::<br />:::&nbsp; Options:<br />:::<br />:::&nbsp; &nbsp; /C n - Number of sorted lines to print. Skipped lines are always printed<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;and do not contribute to the count. Default is -1 (all lines).<br />:::<br />:::&nbsp; &nbsp; /D String - Specifies the string used to delimit tokens. The delimiter<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;string is always case sensitive. A quote literal &quot; must be escaped<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;as \q, and a backslash literal \ must be escaped as \\.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;The default value is an empty string, meaning treat the entire<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;line as a single token.<br />:::<br />:::&nbsp; &nbsp; /I&nbsp; &nbsp;- Ignore case when sorting<br />:::<br />:::&nbsp; &nbsp; /N&nbsp; &nbsp;- Sort consecutive digits as numbers instead of text. The numbers<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;may be embedded within alpha text. JSort supports numbers up to<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;20 digits long.<br />:::<br />:::&nbsp; &nbsp; /O File - Writes the output to File instead of stdout.<br />:::<br />:::&nbsp; &nbsp; /P n - Begin sorting at character position n relative to the beginning<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;of the selected token. Lines that do not extend that far are<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;treated as equivalent values, and collate before all other lines.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;The default value is 1 (first character).<br />:::<br />:::&nbsp; &nbsp; /R&nbsp; &nbsp;- Sort the lines in Reverse (descending) order.<br />:::<br />:::&nbsp; &nbsp; /S n - Number of lines to skip - default is 0.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Skipped lines are not sorted (remain in place)<br />:::<br />:::&nbsp; &nbsp; /T n - Specify the token at which to begin sorting. The sort is not<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;restricted to the selected token, it just helps to identify where<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;to begin sorting. The default value is 1 (first token). A value of<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-1 represents the last token, -2 the penultimate token, etc.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;A value of 0 is invalid. Note that negative values only recognize<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;tokens that occur after a delimiter. If the requested token cannot<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;be found, then the line will collate before all other lines.<br />:::<br />:::&nbsp; &nbsp; /V&nbsp; &nbsp;- Display the version of JSORT.BAT.<br />:::<br />:::&nbsp; &nbsp; /?&nbsp; &nbsp;- Display this help<br />:::<br />:::JSORT.BAT was written by Dave Benham and originally posted at<br />:::http://www.dostips.com/forum/viewtopic.php?f=3&amp;t=5595<br />:::<br /><br />::************ Batch portion ***********<br />@echo off<br />setlocal disableDelayedExpansion<br /><br />:: Get optional input file<br />set &quot;infile=&quot;<br />set &quot;test=%~1&quot;<br />setlocal enableDelayedExpansion<br />if defined test if &quot;!test:~0,1!&quot; neq &quot;/&quot; (<br />&nbsp; endlocal<br />&nbsp; set ^&quot;infile=^&lt;&quot;%~1&quot;&quot;<br />&nbsp; shift /1<br />) else endlocal<br /><br />:: Define options<br />set &quot;options= /?: /i: /c:-1 /n: /p:1 /r: /s:0 /v: /d:&quot;&quot; /t:1 /o:&quot;&quot; &quot;<br /><br />:: Set default option values<br />for %%O in (%options%) do for /f &quot;tokens=1,* delims=:&quot; %%A in (&quot;%%O&quot;) do set &quot;%%A=%%~B&quot;<br /><br />:: Get options<br />:loop<br />if not &quot;%~1&quot;==&quot;&quot; (<br />&nbsp; setlocal enableDelayedExpansion<br />&nbsp; set &quot;test=!options:* %~1:=! &quot;<br />&nbsp; if &quot;!test!&quot;==&quot;!options! &quot; (<br />&nbsp; &nbsp; &nbsp; &gt;&amp;2 echo Error: Invalid option %~1<br />&nbsp; &nbsp; &nbsp; exit /b 1<br />&nbsp; ) else if &quot;!test:~0,1!&quot;==&quot; &quot; (<br />&nbsp; &nbsp; &nbsp; endlocal<br />&nbsp; &nbsp; &nbsp; set &quot;%~1=1&quot;<br />&nbsp; ) else (<br />&nbsp; &nbsp; &nbsp; endlocal<br />&nbsp; &nbsp; &nbsp; set &quot;%~1=%~2&quot;<br />&nbsp; &nbsp; &nbsp; shift /1<br />&nbsp; )<br />&nbsp; shift /1<br />&nbsp; goto :loop<br />)<br /><br />:: Display help<br />if defined /? (<br />&nbsp; for /f &quot;delims=: tokens=*&quot; %%A in ('findstr &quot;^:::&quot; &quot;%~f0&quot;') do echo(%%A<br />&nbsp; exit /b 0<br />)<br /><br />:: Display version<br />if defined /v (<br />&nbsp; for /f &quot;delims=: tokens=*&quot; %%A in ('findstr /bc:&quot;::JSORT.BAT version&quot; &quot;%~f0&quot;') do echo %%A<br />&nbsp; exit /b 0<br />)<br /><br />:: Transform and validate options<br />set /a &quot;case=0%/i%, num=0%/n%, pos=%/p%-1, tok=%/t%, order=1-2*0%/r%, 1/!(0x80000000&amp;pos), 1/tok&quot; 2&gt;nul || (<br />&nbsp; &gt;&amp;2 echo Error: Invalid option value.<br />&nbsp; exit /b 1<br />)<br />if %tok% gtr 0 set /a tok-=1<br />set &quot;outfile=&quot;<br />if defined /o set ^&quot;outfile=^&gt;&quot;%/o%&quot;&quot;<br /><br />:: Perform the sort<br />%infile% %outfile% cscript //E:JScript //nologo &quot;%~f0&quot; %case% %num% %pos% %order% %/s% %/c% %tok% &quot;%/d%&quot;<br /><br />exit /b 0<br />************* JScript portion **********/<br />var array=new Array(),<br />&nbsp; &nbsp; nocase =WScript.Arguments.Item(0),<br />&nbsp; &nbsp; numeric=WScript.Arguments.Item(1),<br />&nbsp; &nbsp; pos&nbsp; &nbsp; =WScript.Arguments.Item(2),<br />&nbsp; &nbsp; order&nbsp; =WScript.Arguments.Item(3),<br />&nbsp; &nbsp; skip&nbsp; &nbsp;=WScript.Arguments.Item(4),<br />&nbsp; &nbsp; count&nbsp; =WScript.Arguments.Item(5),<br />&nbsp; &nbsp; token&nbsp; =WScript.Arguments.Item(6),<br />&nbsp; &nbsp; delim&nbsp; =WScript.Arguments.Item(7).replace(/\\(?!q|\\)/g,'').replace(/\\\\/g,'\\s').replace(/\\q/g,'&quot;').replace(/\\s/g,'\\');<br />while (!WScript.StdIn.AtEndOfStream) {<br />&nbsp; if (skip &gt; 0) {<br />&nbsp; &nbsp; WScript.Echo(WScript.StdIn.ReadLine());<br />&nbsp; &nbsp; skip-=1<br />&nbsp; } else {<br />&nbsp; &nbsp; var expanded=&quot;&quot;, num=&quot;&quot;, raw=WScript.StdIn.ReadLine(), upper=((nocase==1)?raw.toUpperCase():raw);<br />&nbsp; &nbsp; for( var i=pos+FindToken(raw,delim,token); i&lt;raw.length; i++ ) {<br />&nbsp; &nbsp; &nbsp; var c=upper.substr(i,1);<br />&nbsp; &nbsp; &nbsp; if (numeric==1 &amp;&amp; c&gt;=&quot;0&quot; &amp;&amp; c&lt;=&quot;9&quot;) {<br />&nbsp; &nbsp; &nbsp; &nbsp; num+=c;<br />&nbsp; &nbsp; &nbsp; } else {<br />&nbsp; &nbsp; &nbsp; &nbsp; if (num != &quot;&quot;) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; num=&quot;00000000000000000000&quot; + num;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; expanded+=num.substr(num.length-20);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; num=&quot;&quot;;<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; expanded+=c;<br />&nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; if (num != &quot;&quot;) {<br />&nbsp; &nbsp; &nbsp; num=&quot;00000000000000000000&quot; + num;<br />&nbsp; &nbsp; &nbsp; expanded+=num.substr(num.length-20);<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; var obj={expanded:expanded, raw:raw};<br />&nbsp; &nbsp; array.push(obj);<br />&nbsp; }<br />}<br />if (count&lt;0) count=array.length;<br />if (count&gt;array.length) count=array.length;<br />array.sort(function(a,b){return order*((a.expanded&gt;b.expanded)-(a.expanded&lt;b.expanded));});<br />for (var i=0; i&lt;count; i++) WScript.Echo(array&#91;i&#93;.raw);<br /><br />function FindToken(str, str2, n) {<br />&nbsp; if (n!=0 &amp;&amp; str2==&quot;&quot;) return str.length;<br />&nbsp; if (n&gt;=0) {<br />&nbsp; &nbsp; var rtn = 0;<br />&nbsp; &nbsp; for( var i=n; i&gt;0; i-- ) {<br />&nbsp; &nbsp; &nbsp; rtn = str.indexOf(str2,rtn);<br />&nbsp; &nbsp; &nbsp; if (rtn&lt;0) return str.length;<br />&nbsp; &nbsp; &nbsp; rtn+=str2.length;<br />&nbsp; &nbsp; }<br />&nbsp; } else {<br />&nbsp; &nbsp; var rtn = str.length;<br />&nbsp; &nbsp; for (var i=n; i&lt;0; i++ ) {<br />&nbsp; &nbsp; &nbsp; rtn-=1;<br />&nbsp; &nbsp; &nbsp; rtn = str.lastIndexOf(str2,rtn);<br />&nbsp; &nbsp; &nbsp; if (rtn&lt;0) return str.length;<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; rtn+=str2.length;<br />&nbsp; }<br />&nbsp; return rtn;<br />}<br /></code></pre></div><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p39077" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile39077">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf147.html?author_id=3221&amp;sr=posts">6033</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Feb 2012 02:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content39077">

						<h3 ><a href="#p39077">Re: JSORT.BAT - Case sensitive sort with option for numeric</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting4b9d.html?mode=quote&amp;f=3&amp;p=39077" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic2493.html?p=39077#p39077" onclick="prompt('Message #32',this.href); return false;">#32</a></span> 
									<a class="unread" href="viewtopic2493.html?p=39077#p39077" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a></strong> &raquo; </span>06 Jan 2015 04:08
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>dbenham wrote:</cite>Just in case the source file alredy contains slashes.<br /></div></blockquote><br />ok, ta.  I gather that slashes treated as regexp characters there too then.<br /><blockquote class="uncited"><div>I don't see the problem. The /T option does not specify that only one token is sorted. It simply is part of the equation that determines the beginning position that is used for sorting. Each line is sorted based on the year through the end of the line. The content before the year is simply ignored.</div></blockquote><br />Oh, I wasn't aware of that last bit.  <br />It's just what I need here so thanks.<br /><blockquote><div><cite>dbenham wrote:</cite>release 3.3 that supports negative token numbers<br /><br />The solution for <a href="viewtopicc6f9.html?p=39056#p39056" class="postlink">foxidrives problem</a> is now as simple as:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>jsort test.txt /d &quot;(&quot; /t -1<br /></code></pre></div><br /></div></blockquote><br />Thanks for that - you're mucho helpful.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p39086" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile39086">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist2675.html?mode=viewprofile&amp;u=2988" style="color: #00AA00;" class="username-coloured">Squashman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1322.html?author_id=2988&amp;sr=posts">3970</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 Dec 2011 13:59</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content39086">

						<h3 ><a href="#p39086">Re: JSORT.BAT - Case sensitive sort with option for numeric </a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingb7a0.html?mode=quote&amp;f=3&amp;p=39086" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicdbc1.html?p=39086#p39086" onclick="prompt('Message #33',this.href); return false;">#33</a></span> 
									<a class="unread" href="viewtopicdbc1.html?p=39086#p39086" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist2675.html?mode=viewprofile&amp;u=2988" style="color: #00AA00;" class="username-coloured">Squashman</a></strong> &raquo; </span>06 Jan 2015 15:18
			</p>
			
			
			
			<div class="content">So is there a way to sort on multiple tokens.  Say token 5 then token 3. Or am I going to have to do it the old fashion way and move those two variables to the beginning of the line and then do a normal sort.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p39088" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile39088">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content39088">

						<h3 ><a href="#p39088">Re: JSORT.BAT - Case sensitive sort with option for numeric </a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting2bce.html?mode=quote&amp;f=3&amp;p=39088" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic1c04.html?p=39088#p39088" onclick="prompt('Message #34',this.href); return false;">#34</a></span> 
									<a class="unread" href="viewtopic1c04.html?p=39088#p39088" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>06 Jan 2015 15:27
			</p>
			
			
			
			<div class="content">No, I opted not to implement that feature. Coming up with useful syntax and rules became too messy for my taste.<br /><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p39089" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile39089">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist2675.html?mode=viewprofile&amp;u=2988" style="color: #00AA00;" class="username-coloured">Squashman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1322.html?author_id=2988&amp;sr=posts">3970</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 Dec 2011 13:59</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content39089">

						<h3 ><a href="#p39089">Re: JSORT.BAT - Case sensitive sort with option for numeric </a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting04a0.html?mode=quote&amp;f=3&amp;p=39089" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopica346.html?p=39089#p39089" onclick="prompt('Message #35',this.href); return false;">#35</a></span> 
									<a class="unread" href="viewtopica346.html?p=39089#p39089" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist2675.html?mode=viewprofile&amp;u=2988" style="color: #00AA00;" class="username-coloured">Squashman</a></strong> &raquo; </span>06 Jan 2015 15:38
			</p>
			
			
			
			<div class="content">I guess I will just do it the old fashion way then.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p39103" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile39103">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist7557.html?mode=viewprofile&amp;u=4243" class="username">carlsomo</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search15dd.html?author_id=4243&amp;sr=posts">91</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 02 Oct 2012 17:21</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content39103">

						<h3 ><a href="#p39103">Re: JSORT.BAT - Case sensitive sort with option for numeric</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting8ccd.html?mode=quote&amp;f=3&amp;p=39103" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicfe4d.html?p=39103#p39103" onclick="prompt('Message #36',this.href); return false;">#36</a></span> 
									<a class="unread" href="viewtopicfe4d.html?p=39103#p39103" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist7557.html?mode=viewprofile&amp;u=4243" class="username">carlsomo</a></strong> &raquo; </span>06 Jan 2015 21:59
			</p>
			
			
			
			<div class="content">It would be nice to have a date option so that date fields in the format: MM/DD/YYYY or m/d/y could be sorted by year month day? Just a suggestion. I currently have to write to a new file after converting dates to YYYYMMDD, run the sort with the date in the first position, then convert the dates back again and put the date field back where it started. Kind of tedious coding.<br /><br />carl</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p39105" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile39105">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf147.html?author_id=3221&amp;sr=posts">6033</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Feb 2012 02:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content39105">

						<h3 ><a href="#p39105">Re: JSORT.BAT - Case sensitive sort with option for numeric</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting7bb4.html?mode=quote&amp;f=3&amp;p=39105" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicd2f1.html?p=39105#p39105" onclick="prompt('Message #37',this.href); return false;">#37</a></span> 
									<a class="unread" href="viewtopicd2f1.html?p=39105#p39105" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a></strong> &raquo; </span>06 Jan 2015 23:39
			</p>
			
			
			
			<div class="content">carl,  FWIW I think that could be done with a single line using jrepl, also using sort, if the format is predictable.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p39106" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile39106">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist7557.html?mode=viewprofile&amp;u=4243" class="username">carlsomo</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search15dd.html?author_id=4243&amp;sr=posts">91</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 02 Oct 2012 17:21</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content39106">

						<h3 ><a href="#p39106">Re: JSORT.BAT - Case sensitive sort with option for numeric</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting1444.html?mode=quote&amp;f=3&amp;p=39106" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic4773.html?p=39106#p39106" onclick="prompt('Message #38',this.href); return false;">#38</a></span> 
									<a class="unread" href="viewtopic4773.html?p=39106#p39106" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist7557.html?mode=viewprofile&amp;u=4243" class="username">carlsomo</a></strong> &raquo; </span>08 Jan 2015 00:31
			</p>
			
			
			
			<div class="content">That would be cool, so sample csv file to sort by date, most recent year on top:<br /><br />Sample CSV File Title line<br />FRUIT,Dish,Date submitted,item<br />apple,taco,12/31/2000,bus ticket<br />banana,fruit pie,3/17/1958,table<br />orange,julius,1/5/1999,stool<br />pea pod,stew,04/9/2014,glider<br />key lime,pie,12/1/2000,ladder<br /><br />Is there a one liner for this?<br /><br />TIA, carl</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p39107" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile39107">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf147.html?author_id=3221&amp;sr=posts">6033</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Feb 2012 02:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content39107">

						<h3 ><a href="#p39107">Re: JSORT.BAT - Case sensitive sort with option for numeric</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting5c91.html?mode=quote&amp;f=3&amp;p=39107" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic9193.html?p=39107#p39107" onclick="prompt('Message #39',this.href); return false;">#39</a></span> 
									<a class="unread" href="viewtopic9193.html?p=39107#p39107" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a></strong> &raquo; </span>08 Jan 2015 01:35
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>carlsomo wrote:</cite>Is there a one liner for this?<br /></div></blockquote><br /><br />I'm not quite sure what output you want from that sample data<br /><br /><strong class="text-strong">Edit:</strong> I shortened the code<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />type &quot;file.csv&quot; | jrepl &quot;.*,(\d\d|\d)/(\d\d|\d)/(\d\d\d\d),.*&quot; &quot;$3+lpad($1,'00')+lpad($2,'00')+'|'+$0&quot; /j | sort /r | jrepl &quot;^.*?\|&quot; &quot;&quot;<br /></code></pre></div><br />This uses a helper batch file called `Jrepl.bat` (by dbenham) - download from:  <!-- m --><a class="postlink" href="https://www.dropbox.com/s/4otci4d4s8x5ni4/Jrepl.bat">https://www.dropbox.com/s/4otci4d4s8x5ni4/Jrepl.bat</a><!-- m --><br /><br />Place `Jrepl.bat` in the same folder as the batch file or in a folder that is on the path.<br /><br /><br /><span style="color: blue">Sample CSV File Title line<br />FRUIT,Dish,Date submitted,item<br />pea pod,stew,04/9/2014,glider<br />apple,taco,12/31/2000,bus ticket<br />key lime,pie,12/1/2000,ladder<br />orange,julius,1/5/1999,stool<br />banana,fruit pie,3/17/1958,table</span></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p40582" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile40582">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content40582">

						<h3 ><a href="#p40582">Re: JSORT.BAT - Case sensitive sort with option for numeric</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting5f5c.html?mode=quote&amp;f=3&amp;p=40582" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic1ffd.html?p=40582#p40582" onclick="prompt('Message #40',this.href); return false;">#40</a></span> 
									<a class="unread" href="viewtopic1ffd.html?p=40582#p40582" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>24 Mar 2015 20:51
			</p>
			
			
			
			<div class="content">Here is version 4.1<br /><br />I've added a /U option to write only Unique lines, after sorting. (Discard Duplicates)<br /><br />I've also fixed the option parser so that it properly supports no options. Versions 3.2, 3.3, and 4.0  had a bug that raised an error if no options were given.<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@if (@X)==(@Y) @end /* Harmless hybrid line that begins a JScript comment<br />@goto :Batch<br />&nbsp;<br />::************ Documentation ***********<br />::JSORT.BAT version 4.1<br />:::<br />:::JSORT &#91;File&#93; &#91;/Option &#91;Value&#93;&#93;...<br />:::<br />:::&nbsp; Sort lines of text from stdin and write the result to stdout.<br />:::&nbsp; JSORT uses an ascending, case sensitive text sort by default.<br />:::<br />:::&nbsp; &nbsp; File - If the optional File argument is specified, then JSORT reads lines<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;from the file instead of from stdin. If specified, the File must<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;be the very first argument.<br />:::<br />:::&nbsp; Options:<br />:::<br />:::&nbsp; &nbsp; /C n - Number of sorted lines to print. Skipped lines are always printed<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;and do not contribute to the count. Default is -1 (all lines).<br />:::<br />:::&nbsp; &nbsp; /D String - Specifies the string used to delimit tokens. The delimiter<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;string is always case sensitive. A quote literal &quot; must be escaped<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;as \q, and a backslash literal \ must be escaped as \\.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;The default value is an empty string, meaning treat the entire<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;line as a single token.<br />:::<br />:::&nbsp; &nbsp; /I&nbsp; &nbsp;- Ignore case when sorting (or when checking for uniqueness)<br />:::<br />:::&nbsp; &nbsp; /N&nbsp; &nbsp;- Sort consecutive digits as numbers instead of text. The numbers<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;may be embedded within alpha text. JSort supports numbers up to<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;20 digits long.<br />:::<br />:::&nbsp; &nbsp; /O File - Writes the output to File instead of stdout.<br />:::<br />:::&nbsp; &nbsp; /P n - Begin sorting at character position n relative to the beginning<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;of the selected token. Lines that do not extend that far are<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;treated as equivalent values, and collate before all other lines.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;The default value is 1 (first character).<br />:::<br />:::&nbsp; &nbsp; /R&nbsp; &nbsp;- Sort the lines in Reverse (descending) order.<br />:::<br />:::&nbsp; &nbsp; /S n - Number of lines to skip - default is 0.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Skipped lines are not sorted (remain in place)<br />:::<br />:::&nbsp; &nbsp; /T n - Specify the token at which to begin sorting. The sort is not<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;restricted to the selected token, it just helps to identify where<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;to begin sorting. The default value is 1 (first token). A value of<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-1 represents the last token, -2 the penultimate token, etc.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;A value of 0 is invalid. Note that negative values only recognize<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;tokens that occur after a delimiter. If the requested token cannot<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;be found, then the line will collate before all other lines.<br />:::<br />:::&nbsp; &nbsp; /U&nbsp; &nbsp;- Only write unique lines (discard duplicates)<br />:::<br />:::&nbsp; &nbsp; /V&nbsp; &nbsp;- Display the version of JSORT.BAT.<br />:::<br />:::&nbsp; &nbsp; /?&nbsp; &nbsp;- Display this help<br />:::<br />:::JSORT.BAT was written by Dave Benham and originally posted at<br />:::http://www.dostips.com/forum/viewtopic.php?f=3&amp;t=5595<br />:::<br /><br />============== :Batch portion =============<br />@echo off<br />setlocal disableDelayedExpansion<br /><br />:: Get optional input file<br />set &quot;infile=&quot;<br />set &quot;test=%~1&quot;<br />if defined test (<br />&nbsp; setlocal enableDelayedExpansion<br />&nbsp; if &quot;!test:~0,1!&quot; neq &quot;/&quot; (<br />&nbsp; &nbsp; endlocal<br />&nbsp; &nbsp; set ^&quot;infile=^&lt;&quot;%~1&quot;&quot;<br />&nbsp; &nbsp; shift /1<br />&nbsp; ) else endlocal<br />)<br /><br />:: Define options<br />set &quot;options= /?: /c:-1 /d:&quot;&quot; /i: /n: /o:&quot;&quot; /p:1 /r: /s:0 /t:1 /u: /v: &quot;<br /><br />:: Set default option values<br />for %%O in (%options%) do for /f &quot;tokens=1,* delims=:&quot; %%A in (&quot;%%O&quot;) do set &quot;%%A=%%~B&quot;<br /><br />:: Get options<br />:loop<br />if not &quot;%~1&quot;==&quot;&quot; (<br />&nbsp; setlocal enableDelayedExpansion<br />&nbsp; set &quot;test=!options:* %~1:=! &quot;<br />&nbsp; if &quot;!test!&quot;==&quot;!options! &quot; (<br />&nbsp; &nbsp; &nbsp; &gt;&amp;2 echo Error: Invalid option %~1<br />&nbsp; &nbsp; &nbsp; exit /b 1<br />&nbsp; ) else if &quot;!test:~0,1!&quot;==&quot; &quot; (<br />&nbsp; &nbsp; &nbsp; endlocal<br />&nbsp; &nbsp; &nbsp; set &quot;%~1=1&quot;<br />&nbsp; ) else (<br />&nbsp; &nbsp; &nbsp; endlocal<br />&nbsp; &nbsp; &nbsp; set &quot;%~1=%~2&quot;<br />&nbsp; &nbsp; &nbsp; shift /1<br />&nbsp; )<br />&nbsp; shift /1<br />&nbsp; goto :loop<br />)<br /><br />:: Display help<br />if defined /? (<br />&nbsp; for /f &quot;delims=: tokens=*&quot; %%A in ('findstr &quot;^:::&quot; &quot;%~f0&quot;') do echo(%%A<br />&nbsp; exit /b 0<br />)<br /><br />:: Display version<br />if defined /v (<br />&nbsp; for /f &quot;delims=: tokens=*&quot; %%A in ('findstr /bc:&quot;::JSORT.BAT version&quot; &quot;%~f0&quot;') do echo %%A<br />&nbsp; exit /b 0<br />)<br /><br />:: Transform and validate options<br />set /a &quot;case=0%/i%, num=0%/n%, pos=%/p%-1, tok=%/t%, unique=0%/u%, order=1-2*0%/r%, 1/!(0x80000000&amp;pos), 1/tok&quot; 2&gt;nul || (<br />&nbsp; &gt;&amp;2 echo Error: Invalid option value.<br />&nbsp; exit /b 1<br />)<br />if %tok% gtr 0 set /a tok-=1<br />set &quot;outfile=&quot;<br />if defined /o set ^&quot;outfile=^&gt;&quot;%/o%&quot;&quot;<br /><br />:: Perform the sort<br />%infile% %outfile% cscript //E:JScript //nologo &quot;%~f0&quot; %case% %num% %pos% %order% %/s% %/c% %tok% &quot;%/d%&quot; %unique%<br /><br />exit /b 0<br /><br />************* JScript portion **********/<br />var array=new Array(),<br />&nbsp; &nbsp; nocase =WScript.Arguments.Item(0),<br />&nbsp; &nbsp; numeric=WScript.Arguments.Item(1),<br />&nbsp; &nbsp; pos&nbsp; &nbsp; =WScript.Arguments.Item(2),<br />&nbsp; &nbsp; order&nbsp; =WScript.Arguments.Item(3),<br />&nbsp; &nbsp; skip&nbsp; &nbsp;=WScript.Arguments.Item(4),<br />&nbsp; &nbsp; count&nbsp; =WScript.Arguments.Item(5),<br />&nbsp; &nbsp; token&nbsp; =WScript.Arguments.Item(6),<br />&nbsp; &nbsp; delim&nbsp; =WScript.Arguments.Item(7).replace(/\\(?!q|\\)/g,'').replace(/\\\\/g,'\\s').replace(/\\q/g,'&quot;').replace(/\\s/g,'\\'),<br />&nbsp; &nbsp; unique =WScript.Arguments.Item(8);<br />while (!WScript.StdIn.AtEndOfStream) {<br />&nbsp; if (skip &gt; 0) {<br />&nbsp; &nbsp; WScript.Echo(WScript.StdIn.ReadLine());<br />&nbsp; &nbsp; skip-=1<br />&nbsp; } else {<br />&nbsp; &nbsp; var expanded=&quot;&quot;, num=&quot;&quot;, raw=WScript.StdIn.ReadLine(), upper=((nocase==1)?raw.toUpperCase():raw);<br />&nbsp; &nbsp; for( var i=pos+FindToken(raw,delim,token); i&lt;raw.length; i++ ) {<br />&nbsp; &nbsp; &nbsp; var c=upper.substr(i,1);<br />&nbsp; &nbsp; &nbsp; if (numeric==1 &amp;&amp; c&gt;=&quot;0&quot; &amp;&amp; c&lt;=&quot;9&quot;) {<br />&nbsp; &nbsp; &nbsp; &nbsp; num+=c;<br />&nbsp; &nbsp; &nbsp; } else {<br />&nbsp; &nbsp; &nbsp; &nbsp; if (num != &quot;&quot;) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; num=&quot;00000000000000000000&quot; + num;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; expanded+=num.substr(num.length-20);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; num=&quot;&quot;;<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; expanded+=c;<br />&nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; if (num != &quot;&quot;) {<br />&nbsp; &nbsp; &nbsp; num=&quot;00000000000000000000&quot; + num;<br />&nbsp; &nbsp; &nbsp; expanded+=num.substr(num.length-20);<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; var obj={expanded:expanded, raw:raw};<br />&nbsp; &nbsp; array.push(obj);<br />&nbsp; }<br />}<br />if (count&lt;0) count=array.length;<br />if (count&gt;array.length) count=array.length;<br />if (unique==1) {<br />&nbsp; array.sort( function(a,b){<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var rtn = (a.expanded&gt;b.expanded)-(a.expanded&lt;b.expanded);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (rtn==0) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var a2=(nocase==1)?a.raw.toUpperCase():a.raw;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var b2=(nocase==1)?b.raw.toUpperCase():b.raw;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; rtn = (a2&gt;b2)-(a2&lt;b2);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return order*rtn;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; });<br />&nbsp; if (count&gt;=1) WScript.Echo(array&#91;0&#93;.raw);<br />&nbsp; for (var i=1; i&lt;count; i++) {<br />&nbsp; &nbsp; if (nocase==1 &amp;&amp; array&#91;i&#93;.raw.toUpperCase() == array&#91;i-1&#93;.raw.toUpperCase()) continue;<br />&nbsp; &nbsp; if (nocase==0 &amp;&amp; array&#91;i&#93;.raw == array&#91;i-1&#93;.raw) continue;<br />&nbsp; &nbsp; WScript.Echo(array&#91;i&#93;.raw);<br />&nbsp; }<br />} else {<br />&nbsp; array.sort(function(a,b){return order*((a.expanded&gt;b.expanded)-(a.expanded&lt;b.expanded));});<br />&nbsp; for (var i=0; i&lt;count; i++) WScript.Echo(array&#91;i&#93;.raw);<br />}<br /><br />function FindToken(str, str2, n) {<br />&nbsp; if (n!=0 &amp;&amp; str2==&quot;&quot;) return str.length;<br />&nbsp; if (n&gt;=0) {<br />&nbsp; &nbsp; var rtn = 0;<br />&nbsp; &nbsp; for( var i=n; i&gt;0; i-- ) {<br />&nbsp; &nbsp; &nbsp; rtn = str.indexOf(str2,rtn);<br />&nbsp; &nbsp; &nbsp; if (rtn&lt;0) return str.length;<br />&nbsp; &nbsp; &nbsp; rtn+=str2.length;<br />&nbsp; &nbsp; }<br />&nbsp; } else {<br />&nbsp; &nbsp; var rtn = str.length;<br />&nbsp; &nbsp; for (var i=n; i&lt;0; i++ ) {<br />&nbsp; &nbsp; &nbsp; rtn-=1;<br />&nbsp; &nbsp; &nbsp; rtn = str.lastIndexOf(str2,rtn);<br />&nbsp; &nbsp; &nbsp; if (rtn&lt;0) return str.length;<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; rtn+=str2.length;<br />&nbsp; }<br />&nbsp; return rtn;<br />}<br /></code></pre></div><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p41024" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile41024">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf147.html?author_id=3221&amp;sr=posts">6033</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Feb 2012 02:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content41024">

						<h3 ><a href="#p41024">Re: JSORT.BAT - Case sensitive sort with option for numeric</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinga7ba-2.html?mode=quote&amp;f=3&amp;p=41024" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicdc59.html?p=41024#p41024" onclick="prompt('Message #41',this.href); return false;">#41</a></span> 
									<a class="unread" href="viewtopicdc59.html?p=41024#p41024" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a></strong> &raquo; </span>01 May 2015 01:29
			</p>
			
			
			
			<div class="content">Dave, What would be the best method to use leading hashes in a line and delete all the same lines, except one line?<br /><br />Can Jsort remove the last (or first line) - in a matching set that only considers field 1?<br /><br />If not would a syntax like this be useful:<br /><span style="color: blue">jsort file.txt /HB</span> or <br /><span style="color: blue">jsort file.txt /HE</span> <br />to filter out the <span style="color: blue">B</span>eginning line or <span style="color: blue">E</span>nd line in a set of leading <span style="color: blue">/H</span>ashs?<br /><br />For example, filter out (or maybe just include) the lines in blue which would be the <span style="color: blue">E</span>nd lines, after sorting the file.<br /><br />007B9E14 Reminderfox backups\Firefox profile-4938hge8.default-2015-03-28_14.28.11\reminderfox.ics.bak2<br />007B9E14 Reminderfox backups\Firefox profile-4938hge8.default-2015-03-28_15.11.09\reminderfox.ics.bak2<br />007B9E14 Reminderfox backups\Firefox profile-4938hge8.default-2015-03-28_16.13.10\reminderfox.ics.bak3<br />007B9E14 Reminderfox backups\Firefox profile-4938hge8.default-2015-03-28_16.15.12\reminderfox.ics.bak3<br />007B9E14 Reminderfox backups\Firefox profile-4938hge8.default-2015-03-28_16.27.24\reminderfox.ics.bak3<br />007B9E14 Reminderfox backups\Firefox profile-4938hge8.default-2015-03-28_16.29.17\reminderfox.ics.bak3<br />007B9E14 Reminderfox backups\Firefox profile-4938hge8.default-2015-03-28_16.29.24\reminderfox.ics.bak3<br /><span style="color: #0000FF">007B9E14 Reminderfox backups\Firefox profile-4938hge8.default-2015-03-28_16.59.08\reminderfox.ics.bak3</span><br />050EB09F Reminderfox backups\Firefox profile-4938hge8.default-2015-02-27_20.08.33\reminderfox.ics<br />050EB09F Reminderfox backups\Firefox profile-4938hge8.default-2015-02-27_21.48.20\reminderfox.ics<br /><span style="color: #0000FF">050EB09F Reminderfox backups\Firefox profile-4938hge8.default-2015-02-27_21.48.20\reminderfox.ics.bak1<br />069D347B Reminderfox backups\Firefox profile-4938hge8.default-2015-02-12_01.01.25\calDAVmap.css<br />07B5268C Reminderfox backups\reminderfox.ics.2014-07-12_03.09</span><br />07C51335 Reminderfox backups\reminderfox.ics.2014-03-31_02.08<br />07C51335 Reminderfox backups\reminderfox.ics.2014-03-31_15.07<br />07C51335 Reminderfox backups\reminderfox.ics.2014-03-31_15.14<br /><span style="color: #0000FF">07C51335 Reminderfox backups\reminderfox.ics.2014-03-31_15.15</span><br />0862C70B Reminderfox backups\reminderfox.ics.2014-12-13_03.54<br /><span style="color: #0000FF">0862C70B Reminderfox backups\reminderfox.ics.2014-12-13_04.19</span><br />0A077988 Reminderfox backups\reminderfox.ics.2014-02-06_15.50<br /><span style="color: #0000FF">0A077988 Reminderfox backups\reminderfox.ics.2014-02-06_17.28</span><br />0AC5D19A Reminderfox backups\reminderfox.ics.2015-01-11_03.56<br />0AC5D19A Reminderfox backups\Thunderbird profile-6978he18.default-2015-01-14_14.42.13\reminderfox.ics.bak2<br />0AC5D19A Reminderfox backups\Thunderbird profile-6978he18.default-2015-01-14_14.46.05\reminderfox.ics.bak2<br /><span style="color: #0000FF">0AC5D19A Reminderfox backups\Thunderbird profile-6978he18.default-2015-01-15_23.31.58\reminderfox.ics.bak3<br />0AFDCCA6 Reminderfox backups\reminderfox.ics.2014-08-10_03.29<br />0B58297D Reminderfox backups\reminderfox.ics.2014-08-19_00.12<br />0BF8B098 Reminderfox backups\reminderfox.ics.2014-02-25_11.08</span><br /><br /><strong class="text-strong">======================================================</strong><br /><br />I have a script that does this task with files, and recursively, but it might be a useful thing and I'm not clever enough to figure out any jscript to do it.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p41026" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile41026">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content41026">

						<h3 ><a href="#p41026">Re: JSORT.BAT - Case sensitive sort with option for numeric </a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingf010.html?mode=quote&amp;f=3&amp;p=41026" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic86c3.html?p=41026#p41026" onclick="prompt('Message #42',this.href); return false;">#42</a></span> 
									<a class="unread" href="viewtopic86c3.html?p=41026#p41026" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>01 May 2015 05:13
			</p>
			
			
			
			<div class="content">I wouldn't mess with JSORT at all. I would use SORT piped to JREPL<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>sort yourfile.log | jrepl &quot;^(.{8} ).*\n(\1.*\n)*(?=\1)&quot; &quot;&quot; /m<br /></code></pre></div><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p41027" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile41027">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf147.html?author_id=3221&amp;sr=posts">6033</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Feb 2012 02:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content41027">

						<h3 ><a href="#p41027">Re: JSORT.BAT - Case sensitive sort with option for numeric</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting43d5.html?mode=quote&amp;f=3&amp;p=41027" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic3ee0.html?p=41027#p41027" onclick="prompt('Message #43',this.href); return false;">#43</a></span> 
									<a class="unread" href="viewtopic3ee0.html?p=41027#p41027" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a></strong> &raquo; </span>01 May 2015 05:23
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>dbenham wrote:</cite>I wouldn't mess with JSORT at all. I would use SORT piped to JREPL<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>sort yourfile.log | jrepl &quot;^(.{8} ).*\n(\1.*\n)*(?=\1)&quot; &quot;&quot; /m<br /></code></pre></div><br /></div></blockquote><br /><br />My brain just exploded.<br /><br />Two questions though - will sort function effectively when case is taken into consideration, and <br />you may have read one of my edits but I'd like to filter out the matches and return the rest.<br /><br />On re-reading I wasn't clear that filtering out was my preference but that inclusive may have been useful as a secondary option - if it was added to Jsort, was my thinking.<br /><br />Thanks for your code.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p41028" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile41028">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content41028">

						<h3 ><a href="#p41028">Re: JSORT.BAT - Case sensitive sort with option for numeric </a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting7eb7.html?mode=quote&amp;f=3&amp;p=41028" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic03fb.html?p=41028#p41028" onclick="prompt('Message #44',this.href); return false;">#44</a></span> 
									<a class="unread" href="viewtopic03fb.html?p=41028#p41028" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>01 May 2015 07:21
			</p>
			
			
			
			<div class="content">SORT is not case sensitive. If you need case sensitive, then you can switch to JSORT.<br /><br />As far as the rest of your questions, I'm having trouble understanding the collective meaning of your words (with both your posts). For example, I'm not sure what you mean by &quot;filtering out&quot; - Are the filtered out lines discarded, or preserved? And what do you mean by &quot;inclusive&quot;.<br /><br />The way I derived my code was to look for a way to preserve the blue lines in your first post.<br /><br />The only feature I am thinking of adding to JSORT is the ability to specify a regex search/replace pair. The sort would be performed on the replace result, but the original lines would be preserved (except for duplicate removal if /U specified, though definition of duplicate is a bit hazy yet). But I haven't decided to leap and  develop this feature yet. It would require merging a lot of code from JSORT and JREPL. Perhaps it would be an entirely new utility - REGXSORT.<br /><br />A utility like REGXSORT would easily solve your problem in one step.<br /><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p41031" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile41031">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf147.html?author_id=3221&amp;sr=posts">6033</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Feb 2012 02:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content41031">

						<h3 ><a href="#p41031">Re: JSORT.BAT - Case sensitive sort with option for numeric</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting38cb.html?mode=quote&amp;f=3&amp;p=41031" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic2771.html?p=41031#p41031" onclick="prompt('Message #45',this.href); return false;">#45</a></span> 
									<a class="unread" href="viewtopic2771.html?p=41031#p41031" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a></strong> &raquo; </span>01 May 2015 16:39
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>dbenham wrote:</cite>I'm having trouble understanding the collective meaning of your words (with both your posts). For example, I'm not sure what you mean by &quot;filtering out&quot; - Are the filtered out lines discarded, or preserved? And what do you mean by &quot;inclusive&quot;.<br /></div></blockquote><br /><br />Yeah, sometimes I write like a retarded monkey with dyslexia.<br /><br />Filtering out - was meant to mean to discard those lines.<br />Inclusive - was meant to mean only print those lines (which is what your code does well).<br /><br /><blockquote class="uncited"><div>It would require merging a lot of code from JSORT and JREPL. Perhaps it would be an entirely new utility - REGXSORT.<br /><br />A utility like REGXSORT would easily solve your problem in one step.<br /></div></blockquote><br /><br />If you find the time and enthusiasm then it sounds like another great tool for the batch community. :thumbsup:</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
	

	<div class="action-bar bar-bottom">
	
			<a href="posting5cc0.html?mode=reply&amp;f=3&amp;t=5595" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic4a0f.html?f=3&amp;t=5595&amp;start=30&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

			<form method="post" action="https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=5595&amp;start=30">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			47 posts
							<ul>
			<li class="arrow previous"><a class="button button-icon-only" href="viewtopic4ecd.html?f=3&amp;t=5595&amp;start=15" rel="prev" role="button"><i class="icon fa-chevron-left fa-fw" aria-hidden="true"></i><span class="sr-only">Previous</span></a></li>
				<li><a class="button" href="viewtopicf1eb.html?f=3&amp;t=5595" role="button">1</a></li>
				<li><a class="button" href="viewtopic4ecd.html?f=3&amp;t=5595&amp;start=15" role="button">2</a></li>
			<li class="active"><span>3</span></li>
				<li><a class="button" href="viewtopic89dc.html?f=3&amp;t=5595&amp;start=45" role="button">4</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopic89dc.html?f=3&amp;t=5595&amp;start=45" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="viewforum4d6b.html?f=3" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to “DOS Batch Forum”</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="viewforum31e6.html?f=4" class="jumpbox-cat-link"> <span> DosTips - Dos Batch</span></a></li>
																<li><a href="viewforum4d6b.html?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; DOS Batch Forum</span></a></li>
											</ul>
		</div>
	</div>

	</div>


			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
							<span class="crumb"><a href="../index.html" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>DosTips.com</span></a></span>									<span class="crumb"><a href="index.html" data-navbar-reference="index"><span>Board index</span></a></span>					</li>
		
				<li class="rightside">All times are <span title="UTC-6">UTC-06:00</span></li>
							<li class="rightside">
				<a href="ucp033a.html?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete all board cookies</span>
				</a>
			</li>
												<li class="rightside" data-last-responsive="true">
				<a href="memberlist4bfd.html?mode=team" role="menuitem">
					<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
				</a>
			</li>
									<li class="rightside" data-last-responsive="true">
				<a href="memberlist8733.html?mode=contactadmin" role="menuitem">
					<i class="icon fa-envelope fa-fw" aria-hidden="true"></i><span>Contact us</span>
				</a>
			</li>
			</ul>

	</div>
</div>

	<div class="copyright">
				<!-- WARNING NO DELETE -->Style developer by <a href="http://tricolor.x-tk.ru/">support forum tricolor</a>, <!-- END WARNING NO DELETE -->Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
									</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	<img src="cron68e3.gif?cron_type=cron.task.text_reparser.pm_text" width="1" height="1" alt="cron" /></div>

<script type="text/javascript" src="assets/javascript/jquery.mind772.js?assets_version=34"></script>
<script type="text/javascript" src="assets/javascript/cored772.js?assets_version=34"></script>



<script type="text/javascript" src="styles/prosilver/template/forum_fnd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/prosilver/template/ajaxd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/jquery-uid772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/collapsed772.js?assets_version=34"></script>



</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?p=41031 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 06:46:17 GMT -->
</html>
