<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?p=56820 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 07:06:12 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>Dynamically change icon in context menu - DosTips.com</title>


	<link rel="canonical" href="viewtopic97fa.html?t=8559">

<!--
	phpBB style name: Allan Style - SUBSILVER
	Based on style:   prosilver (this is the default phpBB3 style)
	Based on style:   subsilver2 (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:  Allan ( http://x-tk.ru/ )
-->

<link href="assets/css/font-awesome.mind772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/stylesheetd772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/en/stylesheetd772.css?assets_version=34" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="./styles/AllanStyle-SUBSILVER/theme/tweaks.css?assets_version=34" rel="stylesheet">
<![endif]-->




<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','../../www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-280191-1', 'auto');
	ga('send', 'pageview');
</script>

</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">

<div id="header-subsilver">
	<a id="top" class="top-anchor" accesskey="t"></a>
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description" class="site-description">
				<a id="logo" class="logo" href="../index.html" title="DosTips.com"><span class="site_logo"></span></a>
				<h1>DosTips.com</h1>
				<p>A Forum all about DOS Batch</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

									<div id="search-box" class="search-box search-header" role="search">
				<form action="https://www.dostips.com/forum/search.php" method="get" id="search">
				<fieldset>
					<input name="keywords" id="keywords" type="search" maxlength="128" title="Search for keywords" class="inputbox search tiny" size="20" value="" placeholder="Search…" />
					<button class="button button-search" type="submit" title="Search">
						<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
					</button>
					<a href="search.html" class="button button-search-end" title="Advanced search">
						<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
					</a>
					
				</fieldset>
				</form>
			</div>
						
			</div>
					</div>
</div>


<div id="wrap" class="wrap">
	<div id="page-header">
				<div class="navbar-top" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
																									<li>
								<a href="search33a7.html?search_id=unanswered" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="search526f.html?search_id=active_topics" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-blue" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="search.html" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
											<li class="separator"></li>
																			<li>
								<a href="memberlist4bfd.html?mode=team" role="menuitem">
									<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
								</a>
							</li>
																<li class="separator"></li>

									</ul>
			</div>
		</li>

				<li data-skip-responsive="true">
			<a href="app.php/help/faq.html" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
						
			<li class="rightside"  data-skip-responsive="true">
			<a href="ucp26c3.html?mode=login" title="Login" accesskey="x" role="menuitem">
				<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Login</span>
			</a>
		</li>
					<li class="rightside" data-skip-responsive="true">
				<a href="ucp8319.html?mode=register" role="menuitem">
					<i class="icon fa-pencil-square-o  fa-fw" aria-hidden="true"></i><span>Register</span>
				</a>
			</li>
						</ul>

	</div>
</div>

<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
						<li class="breadcrumbs">
							<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="../index.html" itemprop="url" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span itemprop="title">DosTips.com</span></a></span>
										<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="index.html" itemprop="url" accesskey="h" data-navbar-reference="index"><span itemprop="title">Board index</span></a></span>

											<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="4"><a href="viewforum31e6.html?f=4" itemprop="url"><span itemprop="title">DosTips - Dos Batch</span></a></span>
															<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="3"><a href="viewforum4d6b.html?f=3" itemprop="url"><span itemprop="title">DOS Batch Forum</span></a></span>
												</li>
		
					<li class="rightside responsive-search">
				<a href="search.html" title="View the advanced search options" role="menuitem">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</a>
			</li>
			</ul>

	</div>
</div>

<div class="navbar-top-link">
	<div class="inner">
		<ul>
			<li class="navbar-top-link-left"><a href="search33a7.html?search_id=unanswered">Unanswered topics</a></li>
			<li class="navbar-top-link-left"><a href="search526f.html?search_id=active_topics">Active topics</a></li>

											</ul>
	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
		
<h2 class="topic-title"><a href="viewtopicff1c.html?f=3&amp;t=8559">Dynamically change icon in context menu</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">Discussion forum for all Windows batch related topics.<br /></div>
<p>
	<strong>Moderator:</strong> <a href="memberlista6a8.html?mode=viewprofile&amp;u=5" class="username">DosItHelp</a>
</p>


<div class="action-bar bar-top">
	
			<a href="posting65e2.html?mode=reply&amp;f=3&amp;t=8559" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic6df9.html?f=3&amp;t=8559&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="https://www.dostips.com/forum/search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topic…" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="search.html" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="8559" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			31 posts
							<ul>
		<li class="active"><span>1</span></li>
				<li><a class="button" href="viewtopic976b.html?f=3&amp;t=8559&amp;start=15" role="button">2</a></li>
				<li><a class="button" href="viewtopic1d7a.html?f=3&amp;t=8559&amp;start=30" role="button">3</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopic976b.html?f=3&amp;t=8559&amp;start=15" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
		</div>




<div id="subsilver-nav-topic">
	<div class="inner"><div class="post has-profile">
		<div class="leftsided postbody subsilver-topic-title">Message</div>
		<div class="leftsided postprofile subsilver-topic-author">Author</div>
	</div></div>
</div>

			<div id="p56758" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile56758">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist33bb.html?mode=viewprofile&amp;u=9204" class="username">MarioZac</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search8029.html?author_id=9204&amp;sr=posts">38</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 16 May 2018 00:12</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content56758">

						<h3 class="first"><a href="#p56758">Dynamically change icon in context menu</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingf5c5.html?mode=quote&amp;f=3&amp;p=56758" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopiccfa9.html?p=56758#p56758" onclick="prompt('Message #1',this.href); return false;">#1</a></span> 
									<a class="unread" href="viewtopiccfa9.html?p=56758#p56758" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist33bb.html?mode=viewprofile&amp;u=9204" class="username">MarioZac</a></strong> &raquo; </span>16 May 2018 00:26
			</p>
			
			
			
			<div class="content">I want to add a new item in Windows 10 to Desktop Context Menu like this:<br>

<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>[HKEY_CLASSES_ROOT\DesktopBackground\Shell\Switch Power Plan\Shell\Power Saver]
"MUIVerb"="Power Saver"
"Icon"="powercpl.dll"
</code></pre></div>

But the icon type shown in Context Menu on Mouse Hover should depend on whether the listed plan is active or not at present. I tried to do it that way, but it doesn't work:<br>

<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>"Icon"="for /f "delims=" %a in ('powercfg -getactivescheme') do echo %a | find /i "Saver" &gt; nul &amp;&amp; powercpl.dll,-1 || powercpl.dll,-506"</code></pre></div>

Any suggestions how to accomplish that?</div>

			
													<div class="notice">
					Last edited by <a href="memberlist33bb.html?mode=viewprofile&amp;u=9204" class="username">MarioZac</a> on 18 May 2018 07:00, edited 1 time in total.
									</div>
			
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p56767" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile56767">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistfcd5.html?mode=viewprofile&amp;u=4915" style="color: #00AA00;" class="username-coloured">penpen</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1bf7.html?author_id=4915&amp;sr=posts">1612</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 Jun 2013 06:15</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content56767">

						<h3 ><a href="#p56767">Re: Change icon in context menu</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingc8c5.html?mode=quote&amp;f=3&amp;p=56767" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic2db2.html?p=56767#p56767" onclick="prompt('Message #2',this.href); return false;">#2</a></span> 
									<a class="unread" href="viewtopic2db2.html?p=56767#p56767" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistfcd5.html?mode=viewprofile&amp;u=4915" style="color: #00AA00;" class="username-coloured">penpen</a></strong> &raquo; </span>16 May 2018 04:52
			</p>
			
			
			
			<div class="content">I'm unsure if it is possible to have such a dynamic context menue.<br>
<br>
You might better doing it in a similar way (just extend the related commands to also change the item in the context menue):<br>
<a href="https://winaero.com/blog/add-switch-power-plan-context-menu-to-desktop-in-windows-10/" class="postlink">https://winaero.com/blog/add-switch-pow ... indows-10/</a><br>
<br>
penpen</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p56769" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile56769">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist33bb.html?mode=viewprofile&amp;u=9204" class="username">MarioZac</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search8029.html?author_id=9204&amp;sr=posts">38</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 16 May 2018 00:12</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content56769">

						<h3 ><a href="#p56769">Re: Change icon in context menu</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting9ace.html?mode=quote&amp;f=3&amp;p=56769" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic1ba8.html?p=56769#p56769" onclick="prompt('Message #3',this.href); return false;">#3</a></span> 
									<a class="unread" href="viewtopic1ba8.html?p=56769#p56769" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist33bb.html?mode=viewprofile&amp;u=9204" class="username">MarioZac</a></strong> &raquo; </span>16 May 2018 06:36
			</p>
			
			
			
			<div class="content">The link you posted allows to add a choice of Power Plans to Desktop Context Menu. I just checked it and the suggested Registry hack works. The problem I described in the 1st post remains: current Power Plan is not highlighted. To highlight it, I'm thinking of the following change to the code you linked:<br>
<br>
[HKEY_CLASSES_ROOT\DesktopBackground\Shell\Switch Power Plan]<br>
"Icon"="powercpl.dll"<br>
"MUIVerb"="Switch Power Plan"<br>
"Position"="Top"<br>
"SubCommands"=""<br>
<br>
[HKEY_CLASSES_ROOT\DesktopBackground\Shell\Switch Power Plan\Command]<br>
@="path\\icon.bat"<br>
<br>
Rest of the code is the same as in the link, where <em class="text-italics">icon.bat</em> checks current Power Plan on mouse hover (not mouse click), and sets icon values to "powercpl.dll,-1" or "powercpl.dll,-506" for Power Plan entries in Context Menu "Balanced", High Performance", "Power Saver" listed in the linked code.<br>
What would be the shortest <em class="text-italics">icon.bat</em> code allowing to do that? Its better to run Cmd window hidden, and limit all activity on changing Power Plans in Context Menu to only one Cmd window, if possible.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p56784" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile56784">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist33bb.html?mode=viewprofile&amp;u=9204" class="username">MarioZac</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search8029.html?author_id=9204&amp;sr=posts">38</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 16 May 2018 00:12</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content56784">

						<h3 ><a href="#p56784">Re: Change icon in context menu</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting868b.html?mode=quote&amp;f=3&amp;p=56784" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic5e5b.html?p=56784#p56784" onclick="prompt('Message #4',this.href); return false;">#4</a></span> 
									<a class="unread" href="viewtopic5e5b.html?p=56784#p56784" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist33bb.html?mode=viewprofile&amp;u=9204" class="username">MarioZac</a></strong> &raquo; </span>17 May 2018 11:23
			</p>
			
			
			
			<div class="content">I wrote the batch <em class="text-italics">icon.bat</em>, and it works OK by itself. But the shell syntax above doesn't work, so the required Command must be likely placed into a different Registry key for the cascading menu to update icons. Any suggestions?<br>

<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off
:: The batch changes icon for currently Active Power Plan
setlocal EnableExtensions EnableDelayedExpansion
set "key=HKCR\DesktopBackground\Shell\Switch Power Plan\Shell" &amp; set /a i=0 &amp; set /a n=0
for /f "tokens=4,* skip=3" %%b in ('powercfg -l') do ( set /a i+=1
	echo %%c | find /i "*" &gt; nul &amp;&amp; set "icon!i!=powercpl.dll,-1" || set "icon!i!=powercpl.dll,-506" )
	for /f "tokens=*" %%d in ('reg query "%key%"') do ( set /a n+=1
		for /f "tokens=3,* skip=2" %%e in ('reg query "%%d" /v Icon') do ( call set "ico=%%icon!n!%%"
		if not "!ico!"=="%%e" ( reg add "%%d" /v Icon /d !ico! /f &gt; nul )))
endlocal
exit /b</code></pre></div></div>

			
													<div class="notice">
					Last edited by <a href="memberlist33bb.html?mode=viewprofile&amp;u=9204" class="username">MarioZac</a> on 18 May 2018 07:46, edited 3 times in total.
									</div>
			
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p56785" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile56785">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistfcd5.html?mode=viewprofile&amp;u=4915" style="color: #00AA00;" class="username-coloured">penpen</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1bf7.html?author_id=4915&amp;sr=posts">1612</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 Jun 2013 06:15</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content56785">

						<h3 ><a href="#p56785">Re: Change icon in context menu</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting1524.html?mode=quote&amp;f=3&amp;p=56785" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic767d.html?p=56785#p56785" onclick="prompt('Message #5',this.href); return false;">#5</a></span> 
									<a class="unread" href="viewtopic767d.html?p=56785#p56785" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistfcd5.html?mode=viewprofile&amp;u=4915" style="color: #00AA00;" class="username-coloured">penpen</a></strong> &raquo; </span>17 May 2018 13:20
			</p>
			
			
			
			<div class="content">My above idea more was something like this:
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>[HKEY_CLASSES_ROOT\DesktopBackground\Shell\Switch Power Plan\Shell\Balanced\Command]
@="\"C:\\Windows\\System32\\cmd.exe\" /C\"C:\\Windows\\System32\\reg.exe\" ADD \"HKCR\\DesktopBackground\\Shell\\Switch Power Plan\" /v \"Icon\" /d \"powercpl.dll\" &amp; "powercfg.exe /S..."
</code></pre></div>Note: I'm writing on my mobile phone, so the "..." must be extended to the full command.<br>
Also i actually can't test if this idea works - for example i'm unsure, i fear you probably don't have the rights to change the HKCR values from any user profile.<br>
<br>
penpen</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p56787" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile56787">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist33bb.html?mode=viewprofile&amp;u=9204" class="username">MarioZac</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search8029.html?author_id=9204&amp;sr=posts">38</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 16 May 2018 00:12</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content56787">

						<h3 ><a href="#p56787">Re: Change icon in context menu</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingf323.html?mode=quote&amp;f=3&amp;p=56787" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic540d.html?p=56787#p56787" onclick="prompt('Message #6',this.href); return false;">#6</a></span> 
									<a class="unread" href="viewtopic540d.html?p=56787#p56787" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist33bb.html?mode=viewprofile&amp;u=9204" class="username">MarioZac</a></strong> &raquo; </span>17 May 2018 17:52
			</p>
			
			
			
			<div class="content">Did you mean
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@="\"C:\\Windows\\System32\\cmd.exe\" /C\"C:\\Windows\\System32\\reg.exe\" ADD \"HKCR\\DesktopBackground\\Shell\\Switch Power Plan\\Shell\\Balanced\" /v \"Icon\" /d \"powercpl.dll\" /f &amp; "powercfg.exe /S..."</code></pre></div>

You still need to restore the previous icon when the plan is changed again. Unless you suggest to show an icon only for Active plan, and remove it for other plans? Both approaches result in lengthy commandline, so rather require calling a modified batch with a parameter to change the icon while also changing the Plan. So the key below is not required, and Cmd window can be called only once, minimized. I wonder if REG_MULTI_SZ value can be used in the Command key to place a mini-batch into it line by line? Will test that.
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>[HKEY_CLASSES_ROOT\DesktopBackground\Shell\Switch Power Plan\Command]</code></pre></div></div>

			
													<div class="notice">
					Last edited by <a href="memberlist33bb.html?mode=viewprofile&amp;u=9204" class="username">MarioZac</a> on 18 May 2018 07:09, edited 1 time in total.
									</div>
			
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p56788" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile56788">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist33bb.html?mode=viewprofile&amp;u=9204" class="username">MarioZac</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search8029.html?author_id=9204&amp;sr=posts">38</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 16 May 2018 00:12</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content56788">

						<h3 ><a href="#p56788">Re: Change icon in context menu</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinge3bd.html?mode=quote&amp;f=3&amp;p=56788" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicc516.html?p=56788#p56788" onclick="prompt('Message #7',this.href); return false;">#7</a></span> 
									<a class="unread" href="viewtopicc516.html?p=56788#p56788" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist33bb.html?mode=viewprofile&amp;u=9204" class="username">MarioZac</a></strong> &raquo; </span>18 May 2018 00:10
			</p>
			
			
			
			<div class="content">Following your suggestion, I changed the <em class="text-italics">icon.bat</em> :<br>

<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off
:: Batch changes Active Power Plan and its icon. Run with parameter [1,2,3] corresponding to chosen Plan
if not defined mini set "mini=true" &amp;&amp; start "" /min "%~dpnx0" %1 &amp;&amp; exit
setlocal EnableExtensions EnableDelayedExpansion
set "key=HKCR\DesktopBackground\Shell\Switch Power Plan\Shell" &amp; set "plan1=Balanced" &amp; set "plan2=High Performance" &amp; set "plan3=Power Saver"
set "guid1=381b4222-f694-41f0-9685-ff5bb260df2e" &amp; set "guid2=8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c" &amp; set "guid3=a1841308-3541-4fab-bc81-f71556f20b4a"
for /f "tokens=5,6" %%a in ('powercfg -getactivescheme') do echo %%a %%b | find /i "!plan%1!" &gt; nul &amp;&amp; goto :end
for %%d in (1 2 3) do (
	if %%d==%1 ( reg add "%key%\!plan%%d!" /v Icon /d powercpl.dll,-1 /f &gt; nul &amp; powercfg.exe /S !guid%%d!
	) else ( reg add "%key%\!plan%%d!" /v Icon /d powercpl.dll,-506 /f &gt; nul ))
:end
endlocal
exit</code></pre></div>

Respectively, Command keys in <a href="https://winaero.com/blog/add-switch-power-plan-context-menu-to-desktop-in-windows-10/" class="postlink">this</a> referenced script now look like below.<br>

<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>[HKEY_CLASSES_ROOT\DesktopBackground\Shell\Switch Power Plan\Shell\Balanced\Command]
@="path\\icon.bat 1"
[HKEY_CLASSES_ROOT\DesktopBackground\Shell\Switch Power Plan\Shell\High Performance\Command]
@="path\\icon.bat 2"
[HKEY_CLASSES_ROOT\DesktopBackground\Shell\Switch Power Plan\Shell\Power Saver\Command]
@="path\\icon.bat 3"</code></pre></div>

One must change Users permission to Full Control for these keys in Registry for the code to work:
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>[HKEY_CLASSES_ROOT\DesktopBackground\Shell\Switch Power Plan\Shell\Balanced]
[HKEY_CLASSES_ROOT\DesktopBackground\Shell\Switch Power Plan\Shell\High Performance]
[HKEY_CLASSES_ROOT\DesktopBackground\Shell\Switch Power Plan\Shell\Power Saver]</code></pre></div>

<div class="inline-attachment">
			
		
				<dl class="file">
			<dt class="attach-image"><img src="download/file46ee.jpg?id=358" class="postimage" alt="ContextMenu1.jpg" onclick="viewableArea(this);" /></dt>
						<dd>ContextMenu1.jpg (14.02 KiB) Viewed 1032 times</dd>
		</dl>
		
		
		
			</div>
Here's how the Context Menu <a href="https://postimg.cc/image/6gzmcn313/" class="postlink"> looks</a> now. <br>
<br>
To run the batch minimized, or at least minimize the time of showing Cmd window, I added the 3rd line in the code. To run the batch hidden, one can use the <a href="https://www.raymond.cc/blog/hidden-start-runs-batch-files-silently-without-flickering-console/" class="postlink">following</a> tools. I wonder if anyone can suggest a faster or more elegant solution, possibly based on <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ff468984(v=vs.85).aspx" class="postlink">these</a> <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ee453696(v=vs.85).aspx" class="postlink">methods</a>?</div>

			
													<div class="notice">
					Last edited by <a href="memberlist33bb.html?mode=viewprofile&amp;u=9204" class="username">MarioZac</a> on 18 May 2018 10:52, edited 4 times in total.
									</div>
			
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p56795" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile56795">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistfcd5.html?mode=viewprofile&amp;u=4915" style="color: #00AA00;" class="username-coloured">penpen</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1bf7.html?author_id=4915&amp;sr=posts">1612</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 Jun 2013 06:15</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content56795">

						<h3 ><a href="#p56795">Re: Change icon in context menu</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting8177.html?mode=quote&amp;f=3&amp;p=56795" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopice688.html?p=56795#p56795" onclick="prompt('Message #8',this.href); return false;">#8</a></span> 
									<a class="unread" href="viewtopice688.html?p=56795#p56795" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistfcd5.html?mode=viewprofile&amp;u=4915" style="color: #00AA00;" class="username-coloured">penpen</a></strong> &raquo; </span>18 May 2018 09:39
			</p>
			
			
			
			<div class="content"><blockquote><div><cite><a href="memberlist33bb.html?mode=viewprofile&amp;u=9204">MarioZac</a> wrote: <a href="viewtopic540d.html?p=56787#p56787" data-post-id="56787" onclick="if(document.getElementById(hash.substr(1)))href=hash">↑</a><div class="responsive-hide">17 May 2018 17:52</div></cite>
You still need to restore the previous icon when the plan is changed again. Unless you suggest to show an icon only for Active plan, and remove it for other plans?</div></blockquote>The idea was, that you have a menuitem called "Switch Power Plan" with should display the actual power plan representation icon.<br>
You then change the actual power plan and the icon of the "Switch Power Plan" menuitem by clicking the submenuitems "Balanced", "High Performance", and "Power Saver":<br>
- Clicking on "Balanced" changes the active powerplan to "Balanced" and also changes the "Switch Power Plan" to "Balanced" icon choice.<br>
- Clicking on "High Performance" changes the active powerplan to "High Performance" and also changes the "Switch Power Plan" to "High Performance" icon choice.<br>
- Clicking on "Power Saver" changes the active powerplan to "Power Saver" and also changes the "Switch Power Plan" to "Power Saver" icon choice.<br>
<br>
The bad thing i just noticed is, that you can change the active power plan without using these submenuitems, so the item won't change in that case... .<br>
<br>
Another idea:<br>
It might be possible to use the task scheduler ("%windir%\system32\taskschd.msc /s") to execute a program (a script that only changes the icon of the "witch Power Plan" menuitem), whenever "powercfg.exe" changes the power plan.<br>
According to my google skills, an event (see: "%windir%\system32\eventvwr.msc /s", Windows Protocols\System, Information with source "UserModePowerService") should be triggered, with these properties:<br>
- Protocol: "System"<br>
- Source: "UserModePowerService"<br>
- Event-ID: 12<br>
<br>
Sample change icon script (still needs enough rights; maybe you could create that scheduled task using an admin account, so the rights should be ok then):
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off
powercfg /getactivescheme | &gt;nul findstr "381b4222-f694-41f0-9685-ff5bb260df2e" &amp;&amp; reg add "HKCR\DesktopBackground\Shell\Switch Power Plan" /v "Icon" /d "powercpl.dll,0" /f || ^
powercfg /getactivescheme | &gt;nul findstr "a1841308-3541-4fab-bc81-f71556f20b4a" &amp;&amp; reg add "HKCR\DesktopBackground\Shell\Switch Power Plan" /v "Icon" /d "powercpl.dll,1" /f || ^
powercfg /getactivescheme | &gt;nul findstr "8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c" &amp;&amp; reg add "HKCR\DesktopBackground\Shell\Switch Power Plan" /v "Icon" /d "powercpl.dll,2" /f || ^
reg add "HKCR\DesktopBackground\Shell\Switch Power Plan" /v "Icon" /d "powercpl.dll,4" /f
goto :eof
</code></pre></div>
But i'm not firm in using the task scheduler, so I'm not sure what exactly to do to create that.<br>
<br>
<br>
penpen</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p56797" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile56797">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist33bb.html?mode=viewprofile&amp;u=9204" class="username">MarioZac</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search8029.html?author_id=9204&amp;sr=posts">38</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 16 May 2018 00:12</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content56797">

						<h3 ><a href="#p56797">Re: Dynamically change icon in context menu</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingcfa0.html?mode=quote&amp;f=3&amp;p=56797" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic4f55.html?p=56797#p56797" onclick="prompt('Message #9',this.href); return false;">#9</a></span> 
									<a class="unread" href="viewtopic4f55.html?p=56797#p56797" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist33bb.html?mode=viewprofile&amp;u=9204" class="username">MarioZac</a></strong> &raquo; </span>18 May 2018 10:36
			</p>
			
			
			
			<div class="content">Thanks, the task added in Task Scheduler will fix the remaining bug, when icons in Context Menu remain unchanged if a Power Plan was changed by other means like using Power Options panel.<br>
<br>
This is the only example I could google of dynamically changing Context Menu icons. However, code examples of using Windows Shell <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ee453696(v=vs.85).aspx" class="postlink">native means</a> to do that would be interesting to see. It should be cleaner, faster, and won't require extra scheduled tasks.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p56799" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile56799">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistfcd5.html?mode=viewprofile&amp;u=4915" style="color: #00AA00;" class="username-coloured">penpen</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1bf7.html?author_id=4915&amp;sr=posts">1612</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 Jun 2013 06:15</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content56799">

						<h3 ><a href="#p56799">Re: Dynamically change icon in context menu</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting687e.html?mode=quote&amp;f=3&amp;p=56799" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic0138.html?p=56799#p56799" onclick="prompt('Message #10',this.href); return false;">#10</a></span> 
									<a class="unread" href="viewtopic0138.html?p=56799#p56799" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistfcd5.html?mode=viewprofile&amp;u=4915" style="color: #00AA00;" class="username-coloured">penpen</a></strong> &raquo; </span>18 May 2018 14:21
			</p>
			
			
			
			<div class="content">I just noticed something plain trivial and actually i feel really stupid:<br>
Why the heck did we use HKEY_CLASSES_ROOT all the time... .<br>
<br>
How about that "SwitchPowerPlanUser.reg" (before you test this make sure you deleted the stuff from "HKEY_CLASSES_ROOT\DesktopBackground\Shell\Switch Power Plan" within the registry - but backup your sources, or export to *.reg file before deleting):
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>Windows Registry Editor Version 5.00

; Created by https://winaero.com
; Modified by penpen https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=8559

[HKEY_CURRENT_USER\Software\Classes\DesktopBackground\Shell\Switch Power Plan]
"Icon"="powercpl.dll,4"
"MUIVerb"="Switch Power Plan"
"Position"="Top"
"SubCommands"=""

[HKEY_CURRENT_USER\Software\Classes\DesktopBackground\Shell\Switch Power Plan\Shell\Balanced]
"MUIVerb"="Balanced"
"Icon"="powercpl.dll,0"

[HKEY_CURRENT_USER\Software\Classes\DesktopBackground\Shell\Switch Power Plan\Shell\Balanced\Command]
@="cmd /c\"powercfg.exe /S 381b4222-f694-41f0-9685-ff5bb260df2e&amp;powercfg /getactivescheme | &gt;nul findstr \"381b4222-f694-41f0-9685-ff5bb260df2e\" &amp;&amp;reg add \"HKCU\\Software\\Classes\\DesktopBackground\\Shell\\Switch Power Plan\" /v \"Icon\" /d \"powercpl.dll,0\" /f\""

[HKEY_CURRENT_USER\Software\Classes\DesktopBackground\Shell\Switch Power Plan\Shell\High Performance]
"MUIVerb"="High Performance"
"Icon"="powercpl.dll,2"

[HKEY_CURRENT_USER\Software\Classes\DesktopBackground\Shell\Switch Power Plan\Shell\High Performance\Command]
@="cmd /c\"powercfg.exe /S 8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c&amp;powercfg /getactivescheme | &gt;nul findstr \"8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c\" &amp;&amp;reg add \"HKCU\\Software\\Classes\\DesktopBackground\\Shell\\Switch Power Plan\" /v \"Icon\" /d \"powercpl.dll,2\" /f\""

[HKEY_CURRENT_USER\Software\Classes\DesktopBackground\Shell\Switch Power Plan\Shell\Power Saver]
"MUIVerb"="Power Saver"
"Icon"="powercpl.dll,1"

[HKEY_CURRENT_USER\Software\Classes\DesktopBackground\Shell\Switch Power Plan\Shell\Power Saver\Command]
@="cmd /c\"powercfg.exe /S a1841308-3541-4fab-bc81-f71556f20b4a&amp;powercfg /getactivescheme | &gt;nul findstr \"a1841308-3541-4fab-bc81-f71556f20b4a\" &amp;&amp;reg add \"HKCU\\Software\\Classes\\DesktopBackground\\Shell\\Switch Power Plan\" /v \"Icon\" /d \"powercpl.dll,1\" /f\""
</code></pre></div>(No need to give any user write access to HKCR.)<br>
(Note this version doesn't check for executing "powercfg.exe /S" from somewhere else. You still might want to use the task scheduler to update the icons in that case - but the current user is sufficient - no need for admin rights, too.)<br>
<br>
penpen</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p56804" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile56804">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist33bb.html?mode=viewprofile&amp;u=9204" class="username">MarioZac</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search8029.html?author_id=9204&amp;sr=posts">38</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 16 May 2018 00:12</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content56804">

						<h3 ><a href="#p56804">Re: Dynamically change icon in context menu</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting0400.html?mode=quote&amp;f=3&amp;p=56804" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicfd09.html?p=56804#p56804" onclick="prompt('Message #11',this.href); return false;">#11</a></span> 
									<a class="unread" href="viewtopicfd09.html?p=56804#p56804" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist33bb.html?mode=viewprofile&amp;u=9204" class="username">MarioZac</a></strong> &raquo; </span>18 May 2018 14:44
			</p>
			
			
			
			<div class="content">I tested it, and it works very well. This solution requires no extra batch, and neither changing Registry key permissions. Its also very intuitive. Great!<br>
<br>
The only issue remaining is the need to have a scheduled task running to update icons when the plan is changed from Power Options panel. However, this shortcoming can possibly be fixed by adding a Command key to <em class="text-italics">HKEY_CURRENT_USER\Software\Classes\DesktopBackground\Shell\Switch Power Plan</em> that will update on Mouse Hover rather than Click. Just dreaming, but there might be other ideas to eliminate the scheduled task, since it must be manually added by a user, and most users have little experience working with Scheduler? Other thing I noticed overtime, generated Event IDs tend to change with Windows updates for the same events or diversify, meaning the task may stop working later.<br>
<br>
Another minor issue is Cmd window stays open for awhile, that's why I added to the above batch version to keep it minimized:
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>if not defined mini set "mini=true" &amp;&amp; start "" /min "%~dpnx0" %1 &amp;&amp; exit
</code></pre></div>
<div class="inline-attachment">
			
		
				<dl class="file">
			<dt class="attach-image"><img src="download/fileef1f.jpg?id=360" class="postimage" alt="ContextMenu2.jpg" onclick="viewableArea(this);" /></dt>
						<dd>ContextMenu2.jpg (13.26 KiB) Viewed 984 times</dd>
		</dl>
		
		
		
			</div></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p56817" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile56817">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistfcd5.html?mode=viewprofile&amp;u=4915" style="color: #00AA00;" class="username-coloured">penpen</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1bf7.html?author_id=4915&amp;sr=posts">1612</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 Jun 2013 06:15</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content56817">

						<h3 ><a href="#p56817">Re: Dynamically change icon in context menu</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting4aa2.html?mode=quote&amp;f=3&amp;p=56817" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicb53f.html?p=56817#p56817" onclick="prompt('Message #12',this.href); return false;">#12</a></span> 
									<a class="unread" href="viewtopicb53f.html?p=56817#p56817" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistfcd5.html?mode=viewprofile&amp;u=4915" style="color: #00AA00;" class="username-coloured">penpen</a></strong> &raquo; </span>19 May 2018 13:22
			</p>
			
			
			
			<div class="content"><blockquote><div><cite><a href="memberlist33bb.html?mode=viewprofile&amp;u=9204">MarioZac</a> wrote: <a href="viewtopicfd09.html?p=56804#p56804" data-post-id="56804" onclick="if(document.getElementById(hash.substr(1)))href=hash">↑</a><div class="responsive-hide">18 May 2018 14:44</div></cite>This solution requires no extra batch</div></blockquote>Somehow i missed the fact, that i gave a solution without any batch in a batch forum, where someone/you asked for a batch solution  <img class="smilies" src="images/smilies/icon_redface.gif" width="15" height="15" alt=":oops:" title="Embarassed"> !<br>
I will do better, and there's the chance:
<blockquote><div><cite><a href="memberlist33bb.html?mode=viewprofile&amp;u=9204">MarioZac</a> wrote: <a href="viewtopicfd09.html?p=56804#p56804" data-post-id="56804" onclick="if(document.getElementById(hash.substr(1)))href=hash">↑</a><div class="responsive-hide">18 May 2018 14:44</div></cite>The only issue remaining is the need to have a scheduled task running to update icons when the plan is changed from Power Options panel.</div></blockquote>
This could be done using a hybrid JScript/batch file.<br>
<br>
I have more than the three power plans on my pc, so i created a small "Switch Power Plan.Setup.bat", that should add them all:<br>
Updated to "Switch Power Plan.Setup v1_1.bat" which can be found <a href="viewtopicc25d.html?f=3&amp;t=8559&amp;p=56847#p56847" class="postlink">viewtopic.php?f=3&amp;t=8559&amp;p=56847#p56847</a>.<br>
<br>
You probably only want to use default values, so just hit the [ENTER] key until all is done.<br>
If you run setup a second time without deleting the involved directory, then one of the questions must be answered by hitting the [Y]/[N]/[A]-key (or [CTRL+C][Y])<br>
If needed you could see the resulting reg and hybrid jscript/batch file in "%LOCALAPPDATA%\Switch Power Plan" (if you are using the default values).<br>
You might delete the reg file if you want, but the hybrid jscript/batch file is needed.<br>
(Task completed and i used a batch file <img class="smilies" src="images/smilies/icon_biggrin.gif" width="15" height="15" alt=":D" title="Very Happy"> .)<br>
<br>
penpen<br>
<br>
Edit: Removed the old code and set a link to version 1.1.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p56820" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile56820">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist33bb.html?mode=viewprofile&amp;u=9204" class="username">MarioZac</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search8029.html?author_id=9204&amp;sr=posts">38</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 16 May 2018 00:12</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content56820">

						<h3 ><a href="#p56820">Re: Dynamically change icon in context menu</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting80fb.html?mode=quote&amp;f=3&amp;p=56820" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopiccc3c.html?p=56820#p56820" onclick="prompt('Message #13',this.href); return false;">#13</a></span> 
									<a class="unread" href="viewtopiccc3c.html?p=56820#p56820" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist33bb.html?mode=viewprofile&amp;u=9204" class="username">MarioZac</a></strong> &raquo; </span>19 May 2018 15:46
			</p>
			
			
			
			<div class="content">I'm not very familiar with hybrid batches, and some other readers probably too. Would you be able to take a moment to explain without details how this new approach works in general, and in particular to eliminate the Scheduled Task?  <img class="smilies" src="images/smilies/icon_wink.gif" width="15" height="15" alt=":wink:" title="Wink"> <br>
<br>
Does it update only <em class="text-italics">HKCU\Software\Classes\DesktopBackground\Shell\Switch Power Plan</em> icon each time Power Plan is changed from Power Options panel, while changing <em class="text-italics">HKCU\Software\Classes\DesktopBackground\Shell\Switch Power Plan</em> key icon and current Power Plan GUID when Power Plan is changed from Desktop Context Menu? If that's correct, what triggers Jscript execution - mouse hover on Switch Power Plan menu option?</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p56823" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile56823">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistfcd5.html?mode=viewprofile&amp;u=4915" style="color: #00AA00;" class="username-coloured">penpen</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1bf7.html?author_id=4915&amp;sr=posts">1612</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 Jun 2013 06:15</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content56823">

						<h3 ><a href="#p56823">Re: Dynamically change icon in context menu</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting2c5a.html?mode=quote&amp;f=3&amp;p=56823" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopice3c7.html?p=56823#p56823" onclick="prompt('Message #14',this.href); return false;">#14</a></span> 
									<a class="unread" href="viewtopice3c7.html?p=56823#p56823" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistfcd5.html?mode=viewprofile&amp;u=4915" style="color: #00AA00;" class="username-coloured">penpen</a></strong> &raquo; </span>20 May 2018 00:07
			</p>
			
			
			
			<div class="content"><blockquote><div><cite><a href="memberlist33bb.html?mode=viewprofile&amp;u=9204">MarioZac</a> wrote: <a href="viewtopiccc3c.html?p=56820#p56820" data-post-id="56820" onclick="if(document.getElementById(hash.substr(1)))href=hash">↑</a><div class="responsive-hide">19 May 2018 15:46</div></cite>I'm not very familiar with hybrid batches, and some other readers probably too. Would you be able to take a moment to explain without details how this new approach works in general, and in particular to eliminate the Scheduled Task?  <img class="smilies" src="images/smilies/icon_wink.gif" width="15" height="15" alt=":wink:" title="Wink"> </div></blockquote>Sad to say it's not a new approach:<br>
It's (nearly) the same, as before - the jscript part just executes the the batch portion that changes the icon within a hidden frame.<br>
<br>
As i had not much to to with the task scheduler, i'm unsure if you could create that part using scripts only:<br>
I will try to, but this might take some time.<br>
<br>
If someone says something is a hybrid script/source file, then he means, that this file could be used by two or more interpreters/compilers.<br>
In case of a hybrid JScript/batch file this single file is a valid JScript file and it is also a valid batch file:
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@if (true==false) @end /*
@echo off
powercfg.exe /S "%~1"
for %%a in ("HKCU\Software\Classes\DesktopBackground\Shell\Switch Power Plan") do (
	powercfg /getactivescheme | findstr "%~1" &amp;&amp; reg add "%%~a" /v "Icon" /d "%~2" /f || reg add "%%~a" /v "Icon" /d "%~3" /f
)

goto :eof
*/

if (WScript.Arguments.Length == 3) {
	var WshShell = WScript.CreateObject("WScript.Shell");
	WshShell.Run ("\"" + WScript.ScriptFullName   + "\" \"" + WScript.Arguments(0) + "\" \"" + WScript.Arguments(1) + "\" \"" + WScript.Arguments(2) + "\" ", 0, false);
} else {
	WScript.Echo("Usage: WScript.ScriptName \"powerplanId\" \"powerplanIcon\" \"fallbackIcon\".");
}
</code></pre></div>The trick in this case is, that the first line, from the perspective of the JScript, is a valid conditional execution (which is never executed because true isn't false; and also won't do anything even if because there is no text parsed between the ')' and "@end"). The "/*" starts a multiline comment, which ends after the batch code so that is completely ignored by JScript. After that the JScript starts itself as a hidden batch frame.<br>
From the perspective of a batch file the "@" is a special character that tells the command processor not to display the command (within the same line) that should be executed. The next command is an if and the command processor also doesn't execute this line because the strings "(true" and "false)" don't match. So the command processor doesn't even try to interpret the " @end /*" command (which would raise an error message).<br>
then the batch file updates the icon (based on parameters and success of enabling the new power plan.<br>
<br>
I added a fallback item if the power plan couldn't be activated, because someone might delete those.<br>
In that case you have to run the setup batch a second time.<br>
Maybe one could also trigger that using the task scheduler, but on the one hand actually i don't know if there is an event that could trigger what is needed, and on the other hand batch simply cannot read the mind of the user, so i don't know which icons to use if someone wishes to have different than std ones, especially if he/she has added own power plans (like me).<br>
Raising an info message probably would be better in such a case.<br>
<br>
<br>
penpen</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p56824" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile56824">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist33bb.html?mode=viewprofile&amp;u=9204" class="username">MarioZac</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search8029.html?author_id=9204&amp;sr=posts">38</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 16 May 2018 00:12</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content56824">

						<h3 ><a href="#p56824">Re: Dynamically change icon in context menu</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingd349.html?mode=quote&amp;f=3&amp;p=56824" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicec37.html?p=56824#p56824" onclick="prompt('Message #15',this.href); return false;">#15</a></span> 
									<a class="unread" href="viewtopicec37.html?p=56824#p56824" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist33bb.html?mode=viewprofile&amp;u=9204" class="username">MarioZac</a></strong> &raquo; </span>20 May 2018 07:12
			</p>
			
			
			
			<div class="content">Thanks for the explanation. I found it amazing there isn't much posted on the web about using Windows Shell native methods to program Context Menu, such as <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ee453696(v=vs.85).aspx" class="postlink">Dynamic Verbs</a>, <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/bb776086(v=vs.85).aspx" class="postlink">IconMenu</a>, <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ff468984(v=vs.85).aspx" class="postlink">Shell Extensions</a>. I wonder if someone could point to a forum where such <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/dd758091(v=vs.85).aspx" class="postlink">methods</a> are discussed from practical programming standpoint with examples? My assumption is it might be easy to program the task at hand using Windows Shell native means.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
	

	<div class="action-bar bar-bottom">
	
			<a href="posting65e2.html?mode=reply&amp;f=3&amp;t=8559" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic6df9.html?f=3&amp;t=8559&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

			<form method="post" action="https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=8559">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			31 posts
							<ul>
		<li class="active"><span>1</span></li>
				<li><a class="button" href="viewtopic976b.html?f=3&amp;t=8559&amp;start=15" role="button">2</a></li>
				<li><a class="button" href="viewtopic1d7a.html?f=3&amp;t=8559&amp;start=30" role="button">3</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopic976b.html?f=3&amp;t=8559&amp;start=15" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="viewforum4d6b.html?f=3" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to “DOS Batch Forum”</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="viewforum31e6.html?f=4" class="jumpbox-cat-link"> <span> DosTips - Dos Batch</span></a></li>
																<li><a href="viewforum4d6b.html?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; DOS Batch Forum</span></a></li>
											</ul>
		</div>
	</div>

	</div>


			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
							<span class="crumb"><a href="../index.html" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>DosTips.com</span></a></span>									<span class="crumb"><a href="index.html" data-navbar-reference="index"><span>Board index</span></a></span>					</li>
		
				<li class="rightside">All times are <span title="UTC-6">UTC-06:00</span></li>
							<li class="rightside">
				<a href="ucp033a.html?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete all board cookies</span>
				</a>
			</li>
												<li class="rightside" data-last-responsive="true">
				<a href="memberlist4bfd.html?mode=team" role="menuitem">
					<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
				</a>
			</li>
									<li class="rightside" data-last-responsive="true">
				<a href="memberlist8733.html?mode=contactadmin" role="menuitem">
					<i class="icon fa-envelope fa-fw" aria-hidden="true"></i><span>Contact us</span>
				</a>
			</li>
			</ul>

	</div>
</div>

	<div class="copyright">
				<!-- WARNING NO DELETE -->Style developer by <a href="http://tricolor.x-tk.ru/">support forum tricolor</a>, <!-- END WARNING NO DELETE -->Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
									</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	<img src="cron5495.gif?cron_type=cron.task.text_reparser.poll_title" width="1" height="1" alt="cron" /></div>

<script type="text/javascript" src="assets/javascript/jquery.mind772.js?assets_version=34"></script>
<script type="text/javascript" src="assets/javascript/cored772.js?assets_version=34"></script>



<script type="text/javascript" src="styles/prosilver/template/forum_fnd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/prosilver/template/ajaxd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/jquery-uid772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/collapsed772.js?assets_version=34"></script>



</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?p=56820 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 07:06:12 GMT -->
</html>
