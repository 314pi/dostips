<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=5132 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 08:37:24 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>CPU History on title - DosTips.com</title>


	<link rel="canonical" href="viewtopicab4c.html?t=5132">

<!--
	phpBB style name: Allan Style - SUBSILVER
	Based on style:   prosilver (this is the default phpBB3 style)
	Based on style:   subsilver2 (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:  Allan ( http://x-tk.ru/ )
-->

<link href="assets/css/font-awesome.mind772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/stylesheetd772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/en/stylesheetd772.css?assets_version=34" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="./styles/AllanStyle-SUBSILVER/theme/tweaks.css?assets_version=34" rel="stylesheet">
<![endif]-->




<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','../../www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-280191-1', 'auto');
	ga('send', 'pageview');
</script>

</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">

<div id="header-subsilver">
	<a id="top" class="top-anchor" accesskey="t"></a>
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description" class="site-description">
				<a id="logo" class="logo" href="../index.html" title="DosTips.com"><span class="site_logo"></span></a>
				<h1>DosTips.com</h1>
				<p>A Forum all about DOS Batch</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

									<div id="search-box" class="search-box search-header" role="search">
				<form action="https://www.dostips.com/forum/search.php" method="get" id="search">
				<fieldset>
					<input name="keywords" id="keywords" type="search" maxlength="128" title="Search for keywords" class="inputbox search tiny" size="20" value="" placeholder="Search…" />
					<button class="button button-search" type="submit" title="Search">
						<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
					</button>
					<a href="search.html" class="button button-search-end" title="Advanced search">
						<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
					</a>
					
				</fieldset>
				</form>
			</div>
						
			</div>
					</div>
</div>


<div id="wrap" class="wrap">
	<div id="page-header">
				<div class="navbar-top" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
																									<li>
								<a href="search33a7.html?search_id=unanswered" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="search526f.html?search_id=active_topics" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-blue" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="search.html" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
											<li class="separator"></li>
																			<li>
								<a href="memberlist4bfd.html?mode=team" role="menuitem">
									<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
								</a>
							</li>
																<li class="separator"></li>

									</ul>
			</div>
		</li>

				<li data-skip-responsive="true">
			<a href="app.php/help/faq.html" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
						
			<li class="rightside"  data-skip-responsive="true">
			<a href="ucp26c3.html?mode=login" title="Login" accesskey="x" role="menuitem">
				<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Login</span>
			</a>
		</li>
					<li class="rightside" data-skip-responsive="true">
				<a href="ucp8319.html?mode=register" role="menuitem">
					<i class="icon fa-pencil-square-o  fa-fw" aria-hidden="true"></i><span>Register</span>
				</a>
			</li>
						</ul>

	</div>
</div>

<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
						<li class="breadcrumbs">
							<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="../index.html" itemprop="url" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span itemprop="title">DosTips.com</span></a></span>
										<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="index.html" itemprop="url" accesskey="h" data-navbar-reference="index"><span itemprop="title">Board index</span></a></span>

											<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="4"><a href="viewforum31e6.html?f=4" itemprop="url"><span itemprop="title">DosTips - Dos Batch</span></a></span>
															<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="3"><a href="viewforum4d6b.html?f=3" itemprop="url"><span itemprop="title">DOS Batch Forum</span></a></span>
												</li>
		
					<li class="rightside responsive-search">
				<a href="search.html" title="View the advanced search options" role="menuitem">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</a>
			</li>
			</ul>

	</div>
</div>

<div class="navbar-top-link">
	<div class="inner">
		<ul>
			<li class="navbar-top-link-left"><a href="search33a7.html?search_id=unanswered">Unanswered topics</a></li>
			<li class="navbar-top-link-left"><a href="search526f.html?search_id=active_topics">Active topics</a></li>

											</ul>
	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
		
<h2 class="topic-title"><a href="viewtopic8973.html?f=3&amp;t=5132">CPU History on title</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">Discussion forum for all Windows batch related topics.<br /></div>
<p>
	<strong>Moderator:</strong> <a href="memberlista6a8.html?mode=viewprofile&amp;u=5" class="username">DosItHelp</a>
</p>


<div class="action-bar bar-top">
	
			<a href="postingf1ee.html?mode=reply&amp;f=3&amp;t=5132" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic6622.html?f=3&amp;t=5132&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="https://www.dostips.com/forum/search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topic…" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="search.html" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="5132" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			28 posts
							<ul>
		<li class="active"><span>1</span></li>
				<li><a class="button" href="viewtopic1046.html?f=3&amp;t=5132&amp;start=15" role="button">2</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopic1046.html?f=3&amp;t=5132&amp;start=15" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
		</div>




<div id="subsilver-nav-topic">
	<div class="inner"><div class="post has-profile">
		<div class="leftsided postbody subsilver-topic-title">Message</div>
		<div class="leftsided postprofile subsilver-topic-author">Author</div>
	</div></div>
</div>

			<div id="p30293" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile30293">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlista071.html?mode=viewprofile&amp;u=3864" class="username">einstein1969</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searche2bd.html?author_id=3864&amp;sr=posts">762</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 15 Jun 2012 13:16</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Italy, Rome</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content30293">

						<h3 class="first"><a href="#p30293">CPU History on title</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting08fc.html?mode=quote&amp;f=3&amp;p=30293" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic3d83.html?p=30293#p30293" onclick="prompt('Message #1',this.href); return false;">#1</a></span> 
									<a class="unread" href="viewtopic3d83.html?p=30293#p30293" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlista071.html?mode=viewprofile&amp;u=3864" class="username">einstein1969</a></strong> &raquo; </span>30 Nov 2013 17:17
			</p>
			
			
			
			<div class="content">Hi,<br /><br />I have made this code for display the CPU usage on title bar.<br /><br />This show a history like a graphics on the title bar<br /><br />I have two problem:<br /><br />- There are output of set /a that i don't want visible.<br />- There are strange error on initial startup.<br /><br />I have investigated but without being able to find why  <img class="smilies" src="images/smilies/icon_sad.gif" alt=":(" title="Sad" />  Experts Needed!<br /><br />EDIT: thanks to penpen i have resolved. this is worked version on seven 32bit<br />         An more readable and reliability (work better) version by penpen is <a href="viewtopic7b98-2.html?p=30330#p30330" class="postlink">here</a><br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off &amp; setlocal EnableDelayedExpansion &amp; if not &quot;%1&quot;==&quot;&quot; goto %1<br /><br />chcp 850<br /><br />rem sample of 5 seconds<br />start &quot;&quot; /B %0 title_cpu 5<br /><br />pause<br /><br />goto :eof<br /><br /><br />:title_cpu %1=sample_interval_sec<br />&nbsp;shift<br /><br />&nbsp;set &quot;counter=\Processore(_Total)\%% Tempo Processore&quot; &amp; rem italian version<br />&nbsp;rem set &quot;counter=\processor(_total)\%%%% processor time&quot; &amp; rem english version<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;typeperf &quot;!counter!&quot; -si %1 | cmd /v:on /c&quot;set S=_,..~-=ùùïî&amp;set Bcpu= &amp;for /L %%n in () do @(set v=&amp;set /p v=&amp;if defined v (set cpu=^!v:*,=^!&amp;set cpu=&nbsp; ^!cpu:~1,-6^!&amp;set /a i=^!cpu:~0^,-2^!*10/100&gt;nul 2&gt;nul&amp;if defined i for %%b in (^!i^!^) do @(set Bcpu=^!Bcpu^!^!S:~%%b,1^!^)&amp;set Bcpu=^!Bcpu:~-50^!&amp;title CPU:^!cpu:~-5^!%%&nbsp; ^!Bcpu^!^)^) &quot;<br /><br />goto :eof<br /></code></pre></div><br /><br /><img src="../../i41.tinypic.com/2lcbmrq.png" class="postimage" alt="Image" /><br /><br />Einstein1969</div>

			
													<div class="notice">
					Last edited by <a href="memberlista071.html?mode=viewprofile&amp;u=3864" class="username">einstein1969</a> on 03 Dec 2013 05:06, edited 3 times in total.
									</div>
			
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p30295" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile30295">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistfcd5.html?mode=viewprofile&amp;u=4915" style="color: #00AA00;" class="username-coloured">penpen</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1bf7.html?author_id=4915&amp;sr=posts">1612</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 Jun 2013 06:15</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content30295">

						<h3 ><a href="#p30295">Re: CPU History on title</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinge930.html?mode=quote&amp;f=3&amp;p=30295" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopica11f.html?p=30295#p30295" onclick="prompt('Message #2',this.href); return false;">#2</a></span> 
									<a class="unread" href="viewtopica11f.html?p=30295#p30295" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistfcd5.html?mode=viewprofile&amp;u=4915" style="color: #00AA00;" class="username-coloured">penpen</a></strong> &raquo; </span>30 Nov 2013 19:44
			</p>
			
			
			
			<div class="content">I'm currently using WinXP home, that has no typeperf.exe, so i only can try to solve this:<br /><blockquote><div><cite>einstein1969 wrote:</cite>- There are output of set /a that i not want visible.<br /></div></blockquote>As you are using set /A wthin the cmd shell (and not a bat/cmd script),<br />you may want to redirect the unwanted output to nul (&gt;nul), or<br />you may want to execute the part after the '|' from a bat/cmd script where this output isn't produced.<br /><br />May i use this to simulate a valid output of typeref (format guessed),<br />or is the format wrong, or are there missing info/empty lines<br />(maybe such lines are causing the problem, if yes just filter using findstr/find)?<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>setlocal enableDelayedExpansion<br />(<br />for /L %%a in (11,1,30) do for /L %%b in (0,1,9) do echo &quot;!date!!time!&quot;,&quot;%%a.%%b01234&quot;<br />)&gt;&quot;typeref.txt&quot;<br />endlocal<br /></code></pre></div>Tomorrow i'll have a closer look at your script (too late now, sry).<br /><br />penpen<br /><br />Edit: Changed the typeref simulated output.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p30303" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile30303">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlista071.html?mode=viewprofile&amp;u=3864" class="username">einstein1969</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searche2bd.html?author_id=3864&amp;sr=posts">762</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 15 Jun 2012 13:16</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Italy, Rome</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content30303">

						<h3 ><a href="#p30303">Re: CPU History on title</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingd950.html?mode=quote&amp;f=3&amp;p=30303" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic0337.html?p=30303#p30303" onclick="prompt('Message #3',this.href); return false;">#3</a></span> 
									<a class="unread" href="viewtopic0337.html?p=30303#p30303" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlista071.html?mode=viewprofile&amp;u=3864" class="username">einstein1969</a></strong> &raquo; </span>01 Dec 2013 11:48
			</p>
			
			
			
			<div class="content">Hi penpen,<br /><br />thanks for replay.<br /><br />I have added the &gt;nul and 2&gt;nul for the problem and now working.<br /><br />The output of typeperf is this:<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&quot;(PDH-CSV 4.0)&quot;,&quot;\\ACER-ASP-5100\Processore(_Total)\% Tempo Processore&quot;<br />&quot;12/01/2013 18:44:54.935&quot;,&quot;3.125000&quot;<br />&quot;12/01/2013 18:44:55.935&quot;,&quot;1.562500&quot;<br />&quot;12/01/2013 18:44:56.935&quot;,&quot;3.125000&quot;<br /></code></pre></div><br /><br />the first line may create problem but i don't wanted add other process. This use very low cpu for display this info. &lt;0,3%<br /><br />thanks again penpen!<br /><br />einstein1969</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p30304" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile30304">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistfcd5.html?mode=viewprofile&amp;u=4915" style="color: #00AA00;" class="username-coloured">penpen</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1bf7.html?author_id=4915&amp;sr=posts">1612</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 Jun 2013 06:15</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content30304">

						<h3 ><a href="#p30304">Re: CPU History on title</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting5dfd.html?mode=quote&amp;f=3&amp;p=30304" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic339a.html?p=30304#p30304" onclick="prompt('Message #4',this.href); return false;">#4</a></span> 
									<a class="unread" href="viewtopic339a.html?p=30304#p30304" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistfcd5.html?mode=viewprofile&amp;u=4915" style="color: #00AA00;" class="username-coloured">penpen</a></strong> &raquo; </span>01 Dec 2013 11:56
			</p>
			
			
			
			<div class="content">I think, i have found a possible problem:<br />You are using &quot;for /L&quot; and &quot;set /P&quot; to read the piped data.<br />There is no guarantee that the line is fully written to the pipe, before &quot;set/p&quot; has read the data fully.<br />Additionally there is no guarentee, that the typeperf output waits, until &quot;set/p&quot; has read the line, before additional data is written to the pipe.<br />As a result the lines could be messed up, especially, when loading first.<br /><br />So you have to parse the data to lines, or better let another program (for example findstr) let do this.<br />So with the &quot;set/A&quot; redirected to nul this may help you (only the piped line):<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>type typeperf.txt | cmd /V:ON /C &quot;@echo off&amp;set S=_,.-ùïî&amp;set Bcpu=K&amp;for /F %%a in ('findstr &quot;,&quot;') do (set v=%%a&amp;if defined v (set cpu=!v:*,=!&amp;set cpu=&nbsp; !cpu:~1,-6!&amp;(set /a i=!cpu:~0,-2!*6/100)&gt;nul&amp;for %%b in (!i!) do @(set Bcpu=!Bcpu!!S:~%%b,1!)&amp;set Bcpu=!Bcpu:~-30!&amp;title CPU:!cpu:~-5!%%&nbsp; !Bcpu!))&quot;<br /></code></pre></div><br />penpen<br /><br />Edit: You may avoid using cmd /V:ON ... by using &quot;typeperf ...|&quot; within the for loop prior to findstr.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p30308" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile30308">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlista071.html?mode=viewprofile&amp;u=3864" class="username">einstein1969</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searche2bd.html?author_id=3864&amp;sr=posts">762</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 15 Jun 2012 13:16</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Italy, Rome</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content30308">

						<h3 ><a href="#p30308">Re: CPU History on title</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting15ff.html?mode=quote&amp;f=3&amp;p=30308" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicb891.html?p=30308#p30308" onclick="prompt('Message #5',this.href); return false;">#5</a></span> 
									<a class="unread" href="viewtopicb891.html?p=30308#p30308" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlista071.html?mode=viewprofile&amp;u=3864" class="username">einstein1969</a></strong> &raquo; </span>01 Dec 2013 15:54
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>penpen wrote:</cite>I think, i have found a possible problem:<br />You are using &quot;for /L&quot; and &quot;set /P&quot; to read the piped data.<br />There is no guarantee that the line is fully written to the pipe, before &quot;set/p&quot; has read the data fully.<br />Additionally there is no guarentee, that the typeperf output waits, until &quot;set/p&quot; has read the line, before additional data is written to the pipe.<br />As a result the lines could be messed up, especially, when loading first.<br /><br />So you have to parse the data to lines, or better let another program (for example findstr) let do this.<br />So with the &quot;set/A&quot; redirected to nul this may help you (only the piped line):<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>type typeperf.txt | cmd /V:ON /C &quot;@echo off&amp;set S=_,.-ùïî&amp;set Bcpu=K&amp;for /F %%a in ('findstr &quot;,&quot;') do (set v=%%a&amp;if defined v (set cpu=!v:*,=!&amp;set cpu=&nbsp; !cpu:~1,-6!&amp;(set /a i=!cpu:~0,-2!*6/100)&gt;nul&amp;for %%b in (!i!) do @(set Bcpu=!Bcpu!!S:~%%b,1!)&amp;set Bcpu=!Bcpu:~-30!&amp;title CPU:!cpu:~-5!%%&nbsp; !Bcpu!))&quot;<br /></code></pre></div><br />penpen<br /><br />Edit: You may avoid using cmd /V:ON ... by using &quot;typeperf ...|&quot; within the for loop prior to findstr.</div></blockquote><br /><br />first i have tried<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off &amp; setlocal EnableDelayedExpansion &amp; if not &quot;%1&quot;==&quot;&quot; goto %1<br /><br />chcp 850<br /><br />rem goto :test<br />rem goto :scopre<br /><br />start &quot;&quot; /B %0 title_cpu 5<br /><br />pause<br /><br />goto :eof<br /><br /><br />:title_cpu %1=sample_interval_sec<br />&nbsp;shift<br /><br />&nbsp;set &quot;counter=\Processore(_Total)\%% Tempo Processore&quot; &amp; rem italian version<br />&nbsp;rem set &quot;counter=\processor(_total)\%%%% processor time&quot; &amp; rem english version<br /><br />&nbsp;typeperf &quot;!counter!&quot; -si %1&nbsp; | cmd /V:ON /C &quot;@echo off&amp;set S=_,.-ùïî&amp;set Bcpu=K&amp;for /F %%a in ('findstr &quot;,&quot;') do (set v=%%a&amp;if defined v (set cpu=!v:*,=!&amp;set cpu=&nbsp; !cpu:~1,-6!&amp;(set /a i=!cpu:~0,-2!*6/100)&gt;nul&amp;for %%b in (!i!) do @(set Bcpu=!Bcpu!!S:~%%b,1!)&amp;set Bcpu=!Bcpu:~-30!&amp;title CPU:!cpu:~-5!%%&nbsp; !Bcpu!))&quot;<br /><br />goto :eof<br /></code></pre></div><br /><br />but is blocked , nothing appear<br /><br />but this work :  typeperf &quot;!counter!&quot; -si %1  | findstr &quot;,&quot;<br /><br />what do you mean with &quot;parse the data to lines&quot; . I have undestand the problem with set /p . <br />But I don't know what do findstr in this case.<br /><br />Einstein1969</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p30309" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile30309">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistfcd5.html?mode=viewprofile&amp;u=4915" style="color: #00AA00;" class="username-coloured">penpen</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1bf7.html?author_id=4915&amp;sr=posts">1612</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 Jun 2013 06:15</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content30309">

						<h3 ><a href="#p30309">Re: CPU History on title</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting5f45.html?mode=quote&amp;f=3&amp;p=30309" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic63e5.html?p=30309#p30309" onclick="prompt('Message #6',this.href); return false;">#6</a></span> 
									<a class="unread" href="viewtopic63e5.html?p=30309#p30309" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistfcd5.html?mode=viewprofile&amp;u=4915" style="color: #00AA00;" class="username-coloured">penpen</a></strong> &raquo; </span>01 Dec 2013 17:46
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>einstein1969 wrote:</cite>...<br />but is blocked , nothing appear<br /></div></blockquote>Curious thing, that the above does not work as i expect... with &quot;type typeperf.txt | ...&quot; it works without problems on my WinXP home... .<br />I fear, that i have to test it on a system with typeperf (may take a while).<br /><br /><blockquote><div><cite>einstein1969 wrote:</cite>what do you mean with &quot;parse the data to lines&quot; . I have undestand the problem with set /p . <br />But I don't know what do findstr in this case.<br /></div></blockquote>With &quot;parse the data to lines&quot; i wanted to say you have to reconstruct the text lines on the receiver side of the pipe (sender | receiver).<br /><br />The program findstr searches for pattern of texts linewise, so it reconstructs the lines, and if using within a &quot;for/F&quot; loop the reconstructed lines are assigned to the loop variable(s) if specified.<br /><br />penpen</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p30310" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile30310">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistfcd5.html?mode=viewprofile&amp;u=4915" style="color: #00AA00;" class="username-coloured">penpen</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1bf7.html?author_id=4915&amp;sr=posts">1612</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 Jun 2013 06:15</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content30310">

						<h3 ><a href="#p30310">Re: CPU History on title</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting59ab.html?mode=quote&amp;f=3&amp;p=30310" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopica14a-2.html?p=30310#p30310" onclick="prompt('Message #7',this.href); return false;">#7</a></span> 
									<a class="unread" href="viewtopica14a-2.html?p=30310#p30310" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistfcd5.html?mode=viewprofile&amp;u=4915" style="color: #00AA00;" class="username-coloured">penpen</a></strong> &raquo; </span>01 Dec 2013 17:56
			</p>
			
			
			
			<div class="content">Right now, i see an error in my above post... &quot;tokens=* delims=&quot; is missing in the for loop i have posted..., sry for that (and the type command is wrong, too).<br />With some good luck this may be the reason for the lock.<br />So this should be the corrected line:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>typeperf &quot;!counter!&quot; -si %1 | cmd /V:ON /C &quot;@echo off&amp;set S=_,.-ùïî&amp;set Bcpu=K&amp;for /F &quot;tokens=* delims=&quot; %%a in ('findstr &quot;,&quot;') do (set v=%%a&amp;if defined v (set cpu=!v:*,=!&amp;set cpu=&nbsp; !cpu:~1,-6!&amp;(set /a i=!cpu:~0,-2!*6/100)&gt;nul&amp;for %%b in (!i!) do @(set Bcpu=!Bcpu!!S:~%%b,1!)&amp;set Bcpu=!Bcpu:~-30!&amp;title CPU:!cpu:~-5!%%&nbsp; !Bcpu!))&quot;<br /></code></pre></div><br />penpen</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p30311" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile30311">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlista071.html?mode=viewprofile&amp;u=3864" class="username">einstein1969</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searche2bd.html?author_id=3864&amp;sr=posts">762</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 15 Jun 2012 13:16</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Italy, Rome</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content30311">

						<h3 ><a href="#p30311">Re: CPU History on title</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting0e06.html?mode=quote&amp;f=3&amp;p=30311" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic3134.html?p=30311#p30311" onclick="prompt('Message #8',this.href); return false;">#8</a></span> 
									<a class="unread" href="viewtopic3134.html?p=30311#p30311" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlista071.html?mode=viewprofile&amp;u=3864" class="username">einstein1969</a></strong> &raquo; </span>01 Dec 2013 18:56
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>penpen wrote:</cite>Right now, i see an error in my above post... &quot;tokens=* delims=&quot; is missing in the for loop i have posted..., sry for that (and the type command is wrong, too).<br />With some good luck this may be the reason for the lock.<br />So this should be the corrected line:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>typeperf &quot;!counter!&quot; -si %1 | cmd /V:ON /C &quot;@echo off&amp;set S=_,.-ùïî&amp;set Bcpu=K&amp;for /F &quot;tokens=* delims=&quot; %%a in ('findstr &quot;,&quot;') do (set v=%%a&amp;if defined v (set cpu=!v:*,=!&amp;set cpu=&nbsp; !cpu:~1,-6!&amp;(set /a i=!cpu:~0,-2!*6/100)&gt;nul&amp;for %%b in (!i!) do @(set Bcpu=!Bcpu!!S:~%%b,1!)&amp;set Bcpu=!Bcpu:~-30!&amp;title CPU:!cpu:~-5!%%&nbsp; !Bcpu!))&quot;<br /></code></pre></div><br />penpen</div></blockquote><br /><br />I don't try this because is late. I will tomorrow. But the question is:<br /><br />findstr wait that the stream in input ending before processing?<br /><br />The initial script launch typeperf in an endless mode.<br /><br />I'm looking a long time for a method that processing the input while the output is generated. But seem the alternative is using only set /p  <img class="smilies" src="images/smilies/icon_sad.gif" alt=":(" title="Sad" /><br /><br />I search this method for interprocess communication for parallel processing sync too.<br /><br />Einstein1969</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p30319" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile30319">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistfcd5.html?mode=viewprofile&amp;u=4915" style="color: #00AA00;" class="username-coloured">penpen</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1bf7.html?author_id=4915&amp;sr=posts">1612</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 Jun 2013 06:15</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content30319">

						<h3 ><a href="#p30319">Re: CPU History on title</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting0641.html?mode=quote&amp;f=3&amp;p=30319" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicd9ed.html?p=30319#p30319" onclick="prompt('Message #9',this.href); return false;">#9</a></span> 
									<a class="unread" href="viewtopicd9ed.html?p=30319#p30319" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistfcd5.html?mode=viewprofile&amp;u=4915" style="color: #00AA00;" class="username-coloured">penpen</a></strong> &raquo; </span>02 Dec 2013 06:35
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>einstein1969 wrote:</cite>...<br />But the question is:<br /><br />findstr wait that the stream in input ending before processing?<br /><br />The initial script launch typeperf in an endless mode.<br /><br />I'm looking a long time for a method that processing the input while the output is generated. But seem the alternative is using only set /p  <img class="smilies" src="images/smilies/icon_sad.gif" alt=":(" title="Sad" /><br /><br />I search this method for interprocess communication for parallel processing sync too.<br /></div></blockquote>Yes, findstr is buffering data before it displays it.<br />Normally this may be fixed using find, but the &quot;for /F&quot; loop seems to buffer, too.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>Z:\&gt;(echo 1,&amp;echo 2,&amp; echo 3,&amp;echo pause,&amp;((ping 192.168.0.10 -n 1 -w 5000)&gt;nul<br />2&gt;nul)&amp;echo 4,&amp;echo 5,&amp; echo 6,) | (@echo off&amp;find /N &quot;,&quot;)<br /><br />versus<br /><br />Z:\&gt;(echo 1,&amp;echo 2,&amp; echo 3,&amp;echo pause,&amp;((ping 192.168.0.10 -n 1 -w 5000)&gt;nul<br />2&gt;nul)&amp;echo 4,&amp;echo 5,&amp; echo 6,) | (@echo off&amp;for /F %a in ('find /N &quot;,&quot;') do ec<br />ho %a)<br /></code></pre></div>You may be forced to use a batch at the receiver side of the pipe with a goto loop and &quot;set/P&quot;, if &quot;for /L&quot; is buffering, too.<br />AND it looks like there is a problem using &quot;for /L&quot;/&quot;set/P&quot; <img class="smilies" src="images/smilies/icon_evil.gif" alt=":evil:" title="Evil or Very Mad" /> :<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>Z:\&gt;(echo 1,&amp;echo 2,&amp; echo 3,&amp;echo pause,&amp;((ping 192.168.0.10 -n 1 -w 5000)&gt;nul<br />2&gt;nul)&amp;echo 4,&amp;echo 5,&amp; echo 6,) | cmd /V:ON /C &quot;(@echo off&amp;for /L %a in (1,1,20<br />) do (set v=&amp;set /P v=&amp;echo &#91;%a&#93;!v!))&quot;<br />&#91;1&#93;1,<br />&#91;2&#93;4,<br />&#91;3&#93;5,<br />&#91;4&#93;!v!<br />&#91;5&#93;!v!<br />&#91;6&#93;!v!<br />&#91;7&#93;!v!<br />&#91;8&#93;!v!<br />&#91;9&#93;!v!<br />&#91;10&#93;!v!<br />&#91;11&#93;!v!<br />&#91;12&#93;!v!<br />&#91;13&#93;!v!<br />&#91;14&#93;!v!<br />&#91;15&#93;!v!<br />&#91;16&#93;!v!<br />&#91;17&#93;!v!<br />&#91;18&#93;!v!<br />&#91;19&#93;!v!<br />&#91;20&#93;!v!<br /></code></pre></div><br />penpen<br /><br />Edited: Corrected the &quot;for /L&quot;/&quot;set/P&quot; problem.</div>

			
													<div class="notice">
					Last edited by <a href="memberlistfcd5.html?mode=viewprofile&amp;u=4915" style="color: #00AA00;" class="username-coloured">penpen</a> on 02 Dec 2013 07:55, edited 1 time in total.
									</div>
			
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p30321" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile30321">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistfcd5.html?mode=viewprofile&amp;u=4915" style="color: #00AA00;" class="username-coloured">penpen</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1bf7.html?author_id=4915&amp;sr=posts">1612</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 Jun 2013 06:15</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content30321">

						<h3 ><a href="#p30321">Re: CPU History on title</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting8a1c.html?mode=quote&amp;f=3&amp;p=30321" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicc2a1.html?p=30321#p30321" onclick="prompt('Message #10',this.href); return false;">#10</a></span> 
									<a class="unread" href="viewtopicc2a1.html?p=30321#p30321" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistfcd5.html?mode=viewprofile&amp;u=4915" style="color: #00AA00;" class="username-coloured">penpen</a></strong> &raquo; </span>02 Dec 2013 07:51
			</p>
			
			
			
			<div class="content">Additionally: Sad to say that set /P seems to have problems with pipes, when any line ending character is involved, so you have to reformat the data (replace the newlines, carriage returns) before sending it to the pipe.<br /><br />If you would replace the line end chars by a '#' and avoid '=' chars, then this is a simple piping and line reconstructing example:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>::source.bat<br />@echo off<br />setlocal<br />for %%a in (a b c d e # f g h i j # k l m n o p #) do &lt;nul set /p &quot;=%%a&quot;<br />for %%a in (a b c d e f g #) do &lt;nul set /p &quot;=%%a&quot;<br />for %%a in (h i j k l m n o p #) do &lt;nul set /p &quot;=%%a&quot;<br />&lt;nul set /p &quot;=q&quot;<br />endlocal<br /></code></pre></div><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>::pipeOut.bat<br />@echo off<br />cls<br />&nbsp; &nbsp;setlocal enableDelayedExpansion<br />&nbsp; &nbsp;echo:%0: started<br />&nbsp; &nbsp;set &quot;buffer=&quot;<br />&nbsp; &nbsp;set &quot;line=&quot;<br />&nbsp; &nbsp;set &quot;endOfStream=q&quot;<br />:readkey<br />&nbsp; &nbsp;set &quot;input=&quot;<br />&nbsp; &nbsp;set /p &quot;input=&quot;<br />&nbsp; &nbsp;if DEFINED input goto :inputAvailable<br />&nbsp; &nbsp;goto :readkey<br /><br />:inputAvailable<br />&nbsp; &nbsp;set &quot;buffer=%buffer%%input%&quot;<br /><br />&nbsp; &nbsp;echo:%0: input=&quot;%input%&quot;,&nbsp; &nbsp;buffer=&quot;%buffer%&quot;<br />&nbsp; &nbsp;<br />:detectLine<br />&nbsp; &nbsp;if not defined buffer goto :noBuffer<br />&nbsp; &nbsp;set &quot;line=%buffer:*#=%&quot;<br />&nbsp; &nbsp;if defined line (<br />&nbsp; &nbsp;&nbsp; &nbsp;set &quot;line=!buffer:%line%=!&quot;<br />&nbsp; &nbsp;) else (<br />&nbsp; &nbsp;&nbsp; &nbsp;set &quot;line=%buffer%&quot;<br />&nbsp; &nbsp;)<br />&nbsp; &nbsp;if defined line (<br />&nbsp; &nbsp;&nbsp; &nbsp;set &quot;buffer=%buffer:*#=%&quot;<br />&nbsp; &nbsp;&nbsp; &nbsp;echo line found: &quot;%line:~0,-1%&quot;, buffer=&quot;!buffer!&quot;<br />&nbsp; &nbsp;&nbsp; &nbsp;goto :detectLine<br />&nbsp; &nbsp;)<br /><br />:noBuffer<br />&nbsp; &nbsp;set &quot;isEndOfStream=!input:%endOfStream%=%endOfStream%_!&quot;<br />&nbsp; &nbsp;if %input% == %isEndOfStream% goto :readkey<br />&nbsp; &nbsp;echo:%0: leaving<br />&nbsp; &nbsp;endlocal<br /></code></pre></div><br />penpen</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p30326" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile30326">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlista071.html?mode=viewprofile&amp;u=3864" class="username">einstein1969</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searche2bd.html?author_id=3864&amp;sr=posts">762</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 15 Jun 2012 13:16</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Italy, Rome</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content30326">

						<h3 ><a href="#p30326">Re: CPU History on title</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingcbef.html?mode=quote&amp;f=3&amp;p=30326" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic5bb0.html?p=30326#p30326" onclick="prompt('Message #11',this.href); return false;">#11</a></span> 
									<a class="unread" href="viewtopic5bb0.html?p=30326#p30326" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlista071.html?mode=viewprofile&amp;u=3864" class="username">einstein1969</a></strong> &raquo; </span>02 Dec 2013 08:56
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>penpen wrote:</cite><blockquote><div><cite>einstein1969 wrote:</cite>...<br />But the question is:<br /><br />findstr wait that the stream in input ending before processing?<br /><br />The initial script launch typeperf in an endless mode.<br /><br />I'm looking a long time for a method that processing the input while the output is generated. But seem the alternative is using only set /p  <img class="smilies" src="images/smilies/icon_sad.gif" alt=":(" title="Sad" /><br /><br />I search this method for interprocess communication for parallel processing sync too.<br /></div></blockquote>Yes, findstr is buffering data before it displays it.<br />Normally this may be fixed using find, but the &quot;for /F&quot; loop seems to buffer, too.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>Z:\&gt;(echo 1,&amp;echo 2,&amp; echo 3,&amp;echo pause,&amp;((ping 192.168.0.10 -n 1 -w 5000)&gt;nul<br />2&gt;nul)&amp;echo 4,&amp;echo 5,&amp; echo 6,) | (@echo off&amp;find /N &quot;,&quot;)<br /><br />versus<br /><br />Z:\&gt;(echo 1,&amp;echo 2,&amp; echo 3,&amp;echo pause,&amp;((ping 192.168.0.10 -n 1 -w 5000)&gt;nul<br />2&gt;nul)&amp;echo 4,&amp;echo 5,&amp; echo 6,) | (@echo off&amp;for /F %a in ('find /N &quot;,&quot;') do ec<br />ho %a)<br /></code></pre></div>You may be forced to use a batch at the receiver side of the pipe with a goto loop and &quot;set/P&quot;, if &quot;for /L&quot; is buffering, too.<br />AND it looks like there is a problem using &quot;for /L&quot;/&quot;set/P&quot; <img class="smilies" src="images/smilies/icon_evil.gif" alt=":evil:" title="Evil or Very Mad" /> :<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>Z:\&gt;(echo 1,&amp;echo 2,&amp; echo 3,&amp;echo pause,&amp;((ping 192.168.0.10 -n 1 -w 5000)&gt;nul<br />2&gt;nul)&amp;echo 4,&amp;echo 5,&amp; echo 6,) | cmd /V:ON /C &quot;(@echo off&amp;for /L %a in (1,1,20<br />) do (set v=&amp;set /P v=&amp;echo &#91;%a&#93;!v!))&quot;<br />&#91;1&#93;1,<br />&#91;2&#93;4,<br />&#91;3&#93;5,<br />&#91;4&#93;!v!<br />&#91;5&#93;!v!<br />&#91;6&#93;!v!<br />&#91;7&#93;!v!<br />&#91;8&#93;!v!<br />&#91;9&#93;!v!<br />&#91;10&#93;!v!<br />&#91;11&#93;!v!<br />&#91;12&#93;!v!<br />&#91;13&#93;!v!<br />&#91;14&#93;!v!<br />&#91;15&#93;!v!<br />&#91;16&#93;!v!<br />&#91;17&#93;!v!<br />&#91;18&#93;!v!<br />&#91;19&#93;!v!<br />&#91;20&#93;!v!<br /></code></pre></div><br />penpen<br /><br />Edited: Corrected the &quot;for /L&quot;/&quot;set/P&quot; problem.</div></blockquote><br /><br />the problem seem not the FOR /L<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>(echo 1,&amp;echo 2,&amp; echo 3,&amp;echo pause,&amp;((ping 192.168.0.10 -n 1 -w 5000)&gt;nul2&gt;nul)&amp;echo 4,&amp;echo 5,&amp; echo 6,) | cmd /V:ON /C &quot;(@echo off&amp;set v=&amp;set /P v=&amp;echo &#91;1&#93;!v!&amp;set v=&amp;set /P v=&amp;echo &#91;2&#93;!v!&amp;set v=&amp;set /P v=&amp;echo &#91;3&#93;!v!&amp;set v=&amp;set /P v=&amp;echo &#91;4&#93;!v!&amp;set v=&amp;set /P v=&amp;echo &#91;5&#93;!v!&amp;set v=&amp;set /P v=&amp;echo &#91;6&#93;!v!&amp;set v=&amp;set /P v=&amp;echo &#91;7&#93;!v!&amp;set v=&amp;set /P v=&amp;echo &#91;8&#93;!v!)&quot;<br />&#91;1&#93;1,<br />&#91;2&#93;4,<br />&#91;3&#93;5,<br />&#91;4&#93;6,<br />&#91;5&#93;!v!<br />&#91;6&#93;!v!<br />&#91;7&#93;!v!<br />&#91;8&#93;!v!</code></pre></div><br /><br />Einstein1969</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p30327" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile30327">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlista071.html?mode=viewprofile&amp;u=3864" class="username">einstein1969</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searche2bd.html?author_id=3864&amp;sr=posts">762</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 15 Jun 2012 13:16</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Italy, Rome</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content30327">

						<h3 ><a href="#p30327">Re: CPU History on title</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingb0b4.html?mode=quote&amp;f=3&amp;p=30327" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic5210.html?p=30327#p30327" onclick="prompt('Message #12',this.href); return false;">#12</a></span> 
									<a class="unread" href="viewtopic5210.html?p=30327#p30327" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlista071.html?mode=viewprofile&amp;u=3864" class="username">einstein1969</a></strong> &raquo; </span>02 Dec 2013 10:13
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>penpen wrote:</cite>Additionally: Sad to say that set /P seems to have problems with pipes, when any line ending character is involved, so you have to reformat the data (replace the newlines, carriage returns) before sending it to the pipe.<br /><br />If you would replace the line end chars by a '#' and avoid '=' chars, then this is a simple piping and line reconstructing example:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>::source.bat<br />@echo off<br />setlocal<br />for %%a in (a b c d e # f g h i j # k l m n o p #) do &lt;nul set /p &quot;=%%a&quot;<br />for %%a in (a b c d e f g #) do &lt;nul set /p &quot;=%%a&quot;<br />for %%a in (h i j k l m n o p #) do &lt;nul set /p &quot;=%%a&quot;<br />&lt;nul set /p &quot;=q&quot;<br />endlocal<br /></code></pre></div><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>::pipeOut.bat<br />@echo off<br />cls<br />&nbsp; &nbsp;setlocal enableDelayedExpansion<br />&nbsp; &nbsp;echo:%0: started<br />&nbsp; &nbsp;set &quot;buffer=&quot;<br />&nbsp; &nbsp;set &quot;line=&quot;<br />&nbsp; &nbsp;set &quot;endOfStream=q&quot;<br />:readkey<br />&nbsp; &nbsp;set &quot;input=&quot;<br />&nbsp; &nbsp;set /p &quot;input=&quot;<br />&nbsp; &nbsp;if DEFINED input goto :inputAvailable<br />&nbsp; &nbsp;goto :readkey<br /><br />:inputAvailable<br />&nbsp; &nbsp;set &quot;buffer=%buffer%%input%&quot;<br /><br />&nbsp; &nbsp;echo:%0: input=&quot;%input%&quot;,&nbsp; &nbsp;buffer=&quot;%buffer%&quot;<br />&nbsp; &nbsp;<br />:detectLine<br />&nbsp; &nbsp;if not defined buffer goto :noBuffer<br />&nbsp; &nbsp;set &quot;line=%buffer:*#=%&quot;<br />&nbsp; &nbsp;if defined line (<br />&nbsp; &nbsp;&nbsp; &nbsp;set &quot;line=!buffer:%line%=!&quot;<br />&nbsp; &nbsp;) else (<br />&nbsp; &nbsp;&nbsp; &nbsp;set &quot;line=%buffer%&quot;<br />&nbsp; &nbsp;)<br />&nbsp; &nbsp;if defined line (<br />&nbsp; &nbsp;&nbsp; &nbsp;set &quot;buffer=%buffer:*#=%&quot;<br />&nbsp; &nbsp;&nbsp; &nbsp;echo line found: &quot;%line:~0,-1%&quot;, buffer=&quot;!buffer!&quot;<br />&nbsp; &nbsp;&nbsp; &nbsp;goto :detectLine<br />&nbsp; &nbsp;)<br /><br />:noBuffer<br />&nbsp; &nbsp;set &quot;isEndOfStream=!input:%endOfStream%=%endOfStream%_!&quot;<br />&nbsp; &nbsp;if %input% == %isEndOfStream% goto :readkey<br />&nbsp; &nbsp;echo:%0: leaving<br />&nbsp; &nbsp;endlocal<br /></code></pre></div><br />penpen</div></blockquote><br /><br />umh, this is work for only one line?<br /><br />I need that work for a variable number of lines.  <img class="smilies" src="images/smilies/icon_sad.gif" alt=":(" title="Sad" /> <br /><br />Other question on this type of working is :<br /><br />How to detect CR or LF or the pair in any order and trasform it?<br /><br />In the mini-monitor i have found a solution that use two trick : 1) use of start, 2 use of more<br /><br />Seem that cmd versus start is the difference for working set /p a little better<br /><br />The other <strong class="text-strong">important </strong>question is :<br /><br />why this is more stable?<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&gt;start &quot;&quot; /B cmd /c &quot;echo 1,&amp;echo 2,&amp;echo 3,&amp;echo pause,&amp;((ping 192.168.0.10 -n 1 -w 5000)&gt;nul2&gt;nul)&amp;echo 4,&amp;echo 5,&amp; echo 6,&quot; | cmd /V:ON /c &quot;@echo off&amp;for /L %a in (1,1,2000) do (set v=&amp;set /P v=&amp;if defined v echo &#91;%a&#93;!v!)&quot;<br />&#91;1&#93;1,<br />&#91;2&#93;2,<br />&#91;3&#93;3,<br />&#91;4&#93;pause,<br />&#91;5&#93;4,<br />&#91;6&#93;5,<br />&#91;7&#93;6,<br /></code></pre></div><br /><br />EDIT: This work with /WAIT also<br /><br />Einstein1969</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p30328" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile30328">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistfcd5.html?mode=viewprofile&amp;u=4915" style="color: #00AA00;" class="username-coloured">penpen</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1bf7.html?author_id=4915&amp;sr=posts">1612</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 Jun 2013 06:15</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content30328">

						<h3 ><a href="#p30328">Re: CPU History on title</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting153b.html?mode=quote&amp;f=3&amp;p=30328" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic645d-2.html?p=30328#p30328" onclick="prompt('Message #13',this.href); return false;">#13</a></span> 
									<a class="unread" href="viewtopic645d-2.html?p=30328#p30328" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistfcd5.html?mode=viewprofile&amp;u=4915" style="color: #00AA00;" class="username-coloured">penpen</a></strong> &raquo; </span>02 Dec 2013 10:40
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>einstein1969 wrote:</cite>umh, this is work for only one line?<br /><br />I need that work for a variable number of lines. <img class="smilies" src="images/smilies/icon_sad.gif" alt=":(" title="Sad" /> <br /></div></blockquote>It is for a variable number of line, but it is transmitted as one line:<br /><blockquote><div><cite>source text file wrote:</cite>line 1<br />line 2<br />...<br />line n<br /></div></blockquote><blockquote><div><cite>coded source text file to send it through the pipe wrote:</cite>line1#line2#...#linen#q<br /></div></blockquote>You may transmit any number of lines you want, you just have to avoid using '#', 'q', '=', NL, CR, and some problematic control characters, i assume. (should all not be in the typeperf output, if i see it right).<br /><br /><blockquote><div><cite>einstein1969 wrote:</cite>The other important question is :<br /><br />why this is more stable?<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&gt;start &quot;&quot; /B cmd /c &quot;echo 1,&amp;echo 2,&amp;echo 3,&amp;echo pause,&amp;((ping 192.168.0.10 -n 1 -w 5000)&gt;nul2&gt;nul)&amp;echo 4,&amp;echo 5,&amp; echo 6,&quot; | cmd /V:ON /c &quot;@echo off&amp;for /L %a in (1,1,2000) do (set v=&amp;set /P v=&amp;if defined v echo &#91;%a&#93;!v!)&quot;<br />&#91;1&#93;1,<br />&#91;2&#93;2,<br />&#91;3&#93;3,<br />&#91;4&#93;pause,<br />&#91;5&#93;4,<br />&#91;6&#93;5,<br />&#91;7&#93;6,<br /></code></pre></div><br /><br />EDIT: This work with /WAIT also<br /></div></blockquote>Although this indeed seems to be more stable on my WinXP home, this sometimes return wrong results, too:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>Z:\&gt;start &quot;&quot; /B cmd /c &quot;echo 1,&amp;echo 2,&amp;echo 3,&amp;echo pause,&amp;((ping 192.168.0.10<br />-n 1 -w 5000)&gt;nul2&gt;nul)&amp;echo 4,&amp;echo 5,&amp; echo 6,&quot; | cmd /V:ON /c &quot;@echo off&amp;for<br />/L %a in (1,1,2000) do (set v=&amp;set /P v=&amp;if defined v echo &#91;%a&#93;!v!)&quot;<br />&#91;1&#93;1,<br />&#91;2&#93;2,<br />&#91;3&#93;4,<br />&#91;4&#93;5,<br /></code></pre></div><br />penpen<br /><br />Edit: Added 'q' to the forbidden characters.</div>

			
													<div class="notice">
					Last edited by <a href="memberlistfcd5.html?mode=viewprofile&amp;u=4915" style="color: #00AA00;" class="username-coloured">penpen</a> on 02 Dec 2013 11:06, edited 1 time in total.
									</div>
			
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p30330" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile30330">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistfcd5.html?mode=viewprofile&amp;u=4915" style="color: #00AA00;" class="username-coloured">penpen</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1bf7.html?author_id=4915&amp;sr=posts">1612</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 Jun 2013 06:15</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content30330">

						<h3 ><a href="#p30330">Re: CPU History on title</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting29e5.html?mode=quote&amp;f=3&amp;p=30330" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic7b98-2.html?p=30330#p30330" onclick="prompt('Message #14',this.href); return false;">#14</a></span> 
									<a class="unread" href="viewtopic7b98-2.html?p=30330#p30330" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistfcd5.html?mode=viewprofile&amp;u=4915" style="color: #00AA00;" class="username-coloured">penpen</a></strong> &raquo; </span>02 Dec 2013 11:02
			</p>
			
			
			
			<div class="content">I've just got a flash of inspiration, but it will only work, if you are able to make typeperf to output only one measured value:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>:: reserved file name, is not allowed to contain any space: &quot;abort.txt&quot;<br />set abort=abort.txt<br />if exist %abort% echo Unexpected critical error: Reserved file &quot;%abort%&quot; is in use.&amp;goto :eof<br />copy nul %abort% /Y<br />:loop<br />if not exist %abort% goto :eof<br />@echo off<br />set S=_,.-ùïî<br />set Bcpu=K<br />for /F &quot;tokens=* delims=&quot; %%a in ('type typeperfOne.txt&nbsp; ^| findstr &quot;,&quot;') do (<br />&nbsp; &nbsp;set v=%%a<br />&nbsp; &nbsp;if defined v (<br />&nbsp; &nbsp;&nbsp; &nbsp;set cpu=!v:*,=!<br />&nbsp; &nbsp;&nbsp; &nbsp;set cpu=&nbsp; !cpu:~1,-6!<br />&nbsp; &nbsp;&nbsp; &nbsp;(set /a i=!cpu:~0,-2!*6/100)&gt;nul<br />&nbsp; &nbsp;&nbsp; &nbsp;for %%b in (!i!) do @(set Bcpu=!Bcpu!!S:~%%b,1!)<br />&nbsp; &nbsp;&nbsp; &nbsp;set Bcpu=!Bcpu:~-30!&amp;title CPU:!cpu:~-5!%%&nbsp; !Bcpu!<br />&nbsp; &nbsp;)<br />)<br />goto :loop<br /></code></pre></div>You only have to replace &quot;type typeperfOne.txt&quot; with the typeperf command that only forces one measure value.<br />This way it costs some more performance, but it should work.<br />The endless loop is breaked, if you delete the file specified by the variable abort.<br />The main advantage: Much more readable <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /> .<br /><br />penpen</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p30351" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile30351">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlista071.html?mode=viewprofile&amp;u=3864" class="username">einstein1969</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searche2bd.html?author_id=3864&amp;sr=posts">762</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 15 Jun 2012 13:16</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Italy, Rome</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content30351">

						<h3 ><a href="#p30351">Re: CPU History on title</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting7b72.html?mode=quote&amp;f=3&amp;p=30351" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic8a9e.html?p=30351#p30351" onclick="prompt('Message #15',this.href); return false;">#15</a></span> 
									<a class="unread" href="viewtopic8a9e.html?p=30351#p30351" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlista071.html?mode=viewprofile&amp;u=3864" class="username">einstein1969</a></strong> &raquo; </span>03 Dec 2013 05:04
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>penpen wrote:</cite>I've just got a flash of inspiration, but it will only work, if you are able to make typeperf to output only one measured value:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>:: reserved file name, is not allowed to contain any space: &quot;abort.txt&quot;<br />set abort=abort.txt<br />if exist %abort% echo Unexpected critical error: Reserved file &quot;%abort%&quot; is in use.&amp;goto :eof<br />copy nul %abort% /Y<br />:loop<br />if not exist %abort% goto :eof<br />@echo off<br />set S=_,.-ùïî<br />set Bcpu=K<br />for /F &quot;tokens=* delims=&quot; %%a in ('type typeperfOne.txt&nbsp; ^| findstr &quot;,&quot;') do (<br />&nbsp; &nbsp;set v=%%a<br />&nbsp; &nbsp;if defined v (<br />&nbsp; &nbsp;&nbsp; &nbsp;set cpu=!v:*,=!<br />&nbsp; &nbsp;&nbsp; &nbsp;set cpu=&nbsp; !cpu:~1,-6!<br />&nbsp; &nbsp;&nbsp; &nbsp;(set /a i=!cpu:~0,-2!*6/100)&gt;nul<br />&nbsp; &nbsp;&nbsp; &nbsp;for %%b in (!i!) do @(set Bcpu=!Bcpu!!S:~%%b,1!)<br />&nbsp; &nbsp;&nbsp; &nbsp;set Bcpu=!Bcpu:~-30!&amp;title CPU:!cpu:~-5!%%&nbsp; !Bcpu!<br />&nbsp; &nbsp;)<br />)<br />goto :loop<br /></code></pre></div>You only have to replace &quot;type typeperfOne.txt&quot; with the typeperf command that only forces one measure value.<br />This way it costs some more performance, but it should work.<br />The endless loop is breaked, if you delete the file specified by the variable abort.<br />The main advantage: Much more readable <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /> .<br /><br />penpen</div></blockquote><br /><br />For me, unfortunately, one of the requirements for an application that monitors the cpu usage is to use little CPU and few processes. Anyway, thank you for giving a more readable form. The insert in the first post stands out as before.<br /><br />Einstein1969</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
	

	<div class="action-bar bar-bottom">
	
			<a href="postingf1ee.html?mode=reply&amp;f=3&amp;t=5132" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic6622.html?f=3&amp;t=5132&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

			<form method="post" action="https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=5132">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			28 posts
							<ul>
		<li class="active"><span>1</span></li>
				<li><a class="button" href="viewtopic1046.html?f=3&amp;t=5132&amp;start=15" role="button">2</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopic1046.html?f=3&amp;t=5132&amp;start=15" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="viewforum4d6b.html?f=3" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to “DOS Batch Forum”</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="viewforum31e6.html?f=4" class="jumpbox-cat-link"> <span> DosTips - Dos Batch</span></a></li>
																<li><a href="viewforum4d6b.html?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; DOS Batch Forum</span></a></li>
											</ul>
		</div>
	</div>

	</div>


			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
							<span class="crumb"><a href="../index.html" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>DosTips.com</span></a></span>									<span class="crumb"><a href="index.html" data-navbar-reference="index"><span>Board index</span></a></span>					</li>
		
				<li class="rightside">All times are <span title="UTC-6">UTC-06:00</span></li>
							<li class="rightside">
				<a href="ucp033a.html?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete all board cookies</span>
				</a>
			</li>
												<li class="rightside" data-last-responsive="true">
				<a href="memberlist4bfd.html?mode=team" role="menuitem">
					<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
				</a>
			</li>
									<li class="rightside" data-last-responsive="true">
				<a href="memberlist8733.html?mode=contactadmin" role="menuitem">
					<i class="icon fa-envelope fa-fw" aria-hidden="true"></i><span>Contact us</span>
				</a>
			</li>
			</ul>

	</div>
</div>

	<div class="copyright">
				<!-- WARNING NO DELETE -->Style developer by <a href="http://tricolor.x-tk.ru/">support forum tricolor</a>, <!-- END WARNING NO DELETE -->Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
									</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	<img src="cron68e3.gif?cron_type=cron.task.text_reparser.pm_text" width="1" height="1" alt="cron" /></div>

<script type="text/javascript" src="assets/javascript/jquery.mind772.js?assets_version=34"></script>
<script type="text/javascript" src="assets/javascript/cored772.js?assets_version=34"></script>



<script type="text/javascript" src="styles/prosilver/template/forum_fnd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/prosilver/template/ajaxd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/jquery-uid772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/collapsed772.js?assets_version=34"></script>



</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=5132 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 08:37:56 GMT -->
</html>
