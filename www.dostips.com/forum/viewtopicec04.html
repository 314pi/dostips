<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=8720&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 06:49:42 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>DosTips.com &bull; URGENT! Problem with script from testing machine to production</title>

<link href="styles/AllanStyle-SUBSILVER/theme/print.css" rel="stylesheet">
</head>
<body id="phpbb">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>DosTips.com</h1>
		<p>A Forum all about DOS Batch<br /><a href="index-2.html">https://www.dostips.com/forum/</a></p>

		<h2>URGENT! Problem with script from testing machine to production</h2>
		<p><a href="viewtopica0dc.html?f=3&amp;t=8720">https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=8720</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>1</strong> of <strong>1</strong></div>
					<div class="post">
				<h3>URGENT! Problem with script from testing machine to production</h3>
				<div class="date">Posted: <strong>16 Jul 2018 10:54</strong></div>
				<div class="author">by <strong>Scarlet</strong></div>
				<div class="content">Hi everyone, <br>
<br>
I have a problem with a script running on Windows 2008. The script is 2000 rows each made of 120 characters with basic commands. Whenever I run the script on test machine, everything works smoothly, but when I try and make it run on the production machine (same Windows version and setup), I get a syntax error.<br>
<br>
<br>
Error is: exit not expected at this time<br>
Am I missing anything? Is there any setting I should make that I am not aware of?<br>
<br>
Thanks for any help!</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: URGENT! Problem with script from testing machine to production</h3>
				<div class="date">Posted: <strong>16 Jul 2018 11:17</strong></div>
				<div class="author">by <strong>ShadowThief</strong></div>
				<div class="content">Without telling us what syntax error you get (and ideally providing a sample of code that also causes the same problem), we really have no way of knowing how to help you.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: URGENT! Problem with script from testing machine to production</h3>
				<div class="date">Posted: <strong>16 Jul 2018 11:27</strong></div>
				<div class="author">by <strong>Scarlet</strong></div>
				<div class="content">Error is: exit not expected at this time... I cannot provide script example right now since I'm commuting <img class="smilies" src="images/smilies/icon_sad.gif" width="15" height="15" alt=":(" title="Sad"></div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: URGENT! Problem with script from testing machine to production</h3>
				<div class="date">Posted: <strong>16 Jul 2018 11:57</strong></div>
				<div class="author">by <strong>Scarlet</strong></div>
				<div class="content">This is part of the script and IT WORKS in TEST, but not in PRODUCTION:<br>

<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>setlocal EnableExtensions EnableDelayedExpansion
set path=%1
set endname=%2
set acreate=%3
set docserver=%4
set vdruser=%5
set vdrpasswd=%6
set tickedId=%7
if not x%endname:file1_xxxx_=%==x%endname% (
   %acreate% -S %docserver% -u %vdruser%  -p %vdrpasswd% -f %path%\%fname% -r file1_DER -m P -c file1_DER
   exit /b !ERRORLEVEL!
) else if not x%endname:file2_Yyyy_=%==x%endname% (
   %acreate% -S %docserver% -u %vdruser%  -p %vdrpasswd% -f %path%\%fname% -r file2_DER -m P -c file2_DER
   exit /b !ERRORLEVEL!
)</code></pre></div></div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: URGENT! Problem with script from testing machine to production</h3>
				<div class="date">Posted: <strong>16 Jul 2018 12:45</strong></div>
				<div class="author">by <strong>aGerman</strong></div>
				<div class="content">Several issues could cause your error.<br>
First of all NEVER overwrite the already predefined path variable. Command line utilities will not be found anymore. Use another variable name.<br>
Delayed expansion may cause failures if the passed parameters contain exclamation points.<br>
Special characters like spaces, ampersands, or parentheses in the parameters may cause issues. Especially parentheses would fit to your error description.<br>
<br>
It's all just guessing since nobody knows what parameters you passed though.<br>
<br>
Steffen</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: URGENT! Problem with script from testing machine to production</h3>
				<div class="date">Posted: <strong>16 Jul 2018 13:13</strong></div>
				<div class="author">by <strong>Squashman</strong></div>
				<div class="content">Another best practice is to use double quotes for your string comparisons.  If the variable you are comparing has any special characters or spaces, the IF command will fail.<br>
<br>
Try to get in the habit of doing this.
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>if not "x%endname:file1_xxxx_=%"=="x%endname%" command</code></pre></div></div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: URGENT! Problem with script from testing machine to production</h3>
				<div class="date">Posted: <strong>18 Jul 2018 11:49</strong></div>
				<div class="author">by <strong>Scarlet</strong></div>
				<div class="content">Thanks everyone, I solved the problem. Basically I rewrote the script.</div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="UTC-6">UTC-06:00</span><br />Page <strong>1</strong> of <strong>1</strong></div>
		<div class="copyright">Powered by phpBB&reg; Forum Software &copy; phpBB Limited<br />https://www.phpbb.com/</div>
	</div>
</div>

</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=8720&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 06:49:42 GMT -->
</html>
