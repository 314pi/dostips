<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=6081&p=45635 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 07:58:38 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>JREN.BAT v2.8 - Rename files/folders using regular expressions - Page 2 - DosTips.com</title>


	<link rel="canonical" href="viewtopic5da9.html?t=6081&amp;start=15">

<!--
	phpBB style name: Allan Style - SUBSILVER
	Based on style:   prosilver (this is the default phpBB3 style)
	Based on style:   subsilver2 (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:  Allan ( http://x-tk.ru/ )
-->

<link href="assets/css/font-awesome.mind772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/stylesheetd772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/en/stylesheetd772.css?assets_version=34" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="./styles/AllanStyle-SUBSILVER/theme/tweaks.css?assets_version=34" rel="stylesheet">
<![endif]-->




<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','../../www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-280191-1', 'auto');
	ga('send', 'pageview');
</script>

</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">

<div id="header-subsilver">
	<a id="top" class="top-anchor" accesskey="t"></a>
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description" class="site-description">
				<a id="logo" class="logo" href="../index.html" title="DosTips.com"><span class="site_logo"></span></a>
				<h1>DosTips.com</h1>
				<p>A Forum all about DOS Batch</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

									<div id="search-box" class="search-box search-header" role="search">
				<form action="https://www.dostips.com/forum/search.php" method="get" id="search">
				<fieldset>
					<input name="keywords" id="keywords" type="search" maxlength="128" title="Search for keywords" class="inputbox search tiny" size="20" value="" placeholder="Search…" />
					<button class="button button-search" type="submit" title="Search">
						<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
					</button>
					<a href="search.html" class="button button-search-end" title="Advanced search">
						<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
					</a>
					
				</fieldset>
				</form>
			</div>
						
			</div>
					</div>
</div>


<div id="wrap" class="wrap">
	<div id="page-header">
				<div class="navbar-top" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
																									<li>
								<a href="search33a7.html?search_id=unanswered" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="search526f.html?search_id=active_topics" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-blue" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="search.html" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
											<li class="separator"></li>
																			<li>
								<a href="memberlist4bfd.html?mode=team" role="menuitem">
									<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
								</a>
							</li>
																<li class="separator"></li>

									</ul>
			</div>
		</li>

				<li data-skip-responsive="true">
			<a href="app.php/help/faq.html" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
						
			<li class="rightside"  data-skip-responsive="true">
			<a href="ucp26c3.html?mode=login" title="Login" accesskey="x" role="menuitem">
				<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Login</span>
			</a>
		</li>
					<li class="rightside" data-skip-responsive="true">
				<a href="ucp8319.html?mode=register" role="menuitem">
					<i class="icon fa-pencil-square-o  fa-fw" aria-hidden="true"></i><span>Register</span>
				</a>
			</li>
						</ul>

	</div>
</div>

<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
						<li class="breadcrumbs">
							<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="../index.html" itemprop="url" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span itemprop="title">DosTips.com</span></a></span>
										<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="index.html" itemprop="url" accesskey="h" data-navbar-reference="index"><span itemprop="title">Board index</span></a></span>

											<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="4"><a href="viewforum31e6.html?f=4" itemprop="url"><span itemprop="title">DosTips - Dos Batch</span></a></span>
															<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="3"><a href="viewforum4d6b.html?f=3" itemprop="url"><span itemprop="title">DOS Batch Forum</span></a></span>
												</li>
		
					<li class="rightside responsive-search">
				<a href="search.html" title="View the advanced search options" role="menuitem">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</a>
			</li>
			</ul>

	</div>
</div>

<div class="navbar-top-link">
	<div class="inner">
		<ul>
			<li class="navbar-top-link-left"><a href="search33a7.html?search_id=unanswered">Unanswered topics</a></li>
			<li class="navbar-top-link-left"><a href="search526f.html?search_id=active_topics">Active topics</a></li>

											</ul>
	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
		
<h2 class="topic-title"><a href="viewtopice449.html?f=3&amp;t=6081&amp;start=15">JREN.BAT v2.8 - Rename files/folders using regular expressions</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">Discussion forum for all Windows batch related topics.<br /></div>
<p>
	<strong>Moderator:</strong> <a href="memberlista6a8.html?mode=viewprofile&amp;u=5" class="username">DosItHelp</a>
</p>


<div class="action-bar bar-top">
	
			<a href="postingb188.html?mode=reply&amp;f=3&amp;t=6081" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic8cc6.html?f=3&amp;t=6081&amp;start=15&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="https://www.dostips.com/forum/search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topic…" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="search.html" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="6081" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			50 posts
							<ul>
			<li class="arrow previous"><a class="button button-icon-only" href="viewtopic7124.html?f=3&amp;t=6081" rel="prev" role="button"><i class="icon fa-chevron-left fa-fw" aria-hidden="true"></i><span class="sr-only">Previous</span></a></li>
				<li><a class="button" href="viewtopic7124.html?f=3&amp;t=6081" role="button">1</a></li>
			<li class="active"><span>2</span></li>
				<li><a class="button" href="viewtopic0809.html?f=3&amp;t=6081&amp;start=30" role="button">3</a></li>
				<li><a class="button" href="viewtopiccac4.html?f=3&amp;t=6081&amp;start=45" role="button">4</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopic0809.html?f=3&amp;t=6081&amp;start=30" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
		</div>




<div id="subsilver-nav-topic">
	<div class="inner"><div class="post has-profile">
		<div class="leftsided postbody subsilver-topic-title">Message</div>
		<div class="leftsided postprofile subsilver-topic-author">Author</div>
	</div></div>
</div>

			<div id="p42088" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile42088">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content42088">

						<h3 class="first"><a href="#p42088">Re: JREN.BAT - Rename files/folders using regular expression</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting736b.html?mode=quote&amp;f=3&amp;p=42088" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicb660.html?p=42088#p42088" onclick="prompt('Message #16',this.href); return false;">#16</a></span> 
									<a class="unread" href="viewtopicb660.html?p=42088#p42088" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>15 Jul 2015 15:46
			</p>
			
			
			
			<div class="content">I recently made some changes to the HELP and called it Version 2.4.<br />I developed version 2.3 back in March for improved /T and /LIST options, but neglected to post it. <br /><br />The changes since 2.2 are fairly minor:<br /><br />1) If using /T (test mode), then illegal characters in resultant file name causes abort with an error message.<br />2) If using /LIST option, then illegal characters are allowed (ignored) in the output.<br />3) Added /?? and /??TS() options for paged help via MORE<br /><br />JREN.BAT Version 2.4<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@if (@X)==(@Y) @end /* Harmless hybrid line that begins a JScript comment<br />@goto :Batch<br /><br />::JREN.BAT version 2.4 by Dave Benham<br />::<br />::&nbsp; Release History:<br />::&nbsp; &nbsp; 2.4&nbsp; 2015-07-15: Added /?? and /??TS() paged help options<br />::&nbsp; &nbsp; 2.3&nbsp; 2015-03-03: Ignore invalid characters if /LIST mode<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Bug fix - abort if invalid character with /T mode<br />::&nbsp; &nbsp; 2.2&nbsp; 2014-12-10: Bug fix - forgot to make the search regex global<br />::&nbsp; &nbsp; 2.1&nbsp; 2014-12-10: Additional dt: options for FileSystemObject timestamps<br />::&nbsp; &nbsp; 2.0&nbsp; 2014-12-07: New /LIST option.<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Added ts() function and /?ts() documentation<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Many new JScript functions for use with /J with /LIST<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Added GOTO at top to improve startup performance<br />::&nbsp; &nbsp; 1.1&nbsp; 2014-12-02: Options may be prefaced with / or -<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Corrected some documentation<br />::&nbsp; &nbsp; 1.0&nbsp; 2014-11-30: Initial release<br />::<br />::============ Documentation ===========<br />:::<br />:::JREN&nbsp; Search&nbsp; Replace&nbsp; &#91;/Option&nbsp; &#91;Value&#93;&#93;...<br />:::JREN&nbsp; /?&#91;REGEX|REPLACE|VERSION|TS()&#93;<br />:::JREN&nbsp; /??&#91;ts()&#93;<br />:::<br />:::&nbsp; Rename files in the current directory by performing a regular expression<br />:::&nbsp; search/replace on the old file name to generate the new file name.<br />:::&nbsp; This includes read only, hidden, and system files.<br />:::<br />:::&nbsp; Search&nbsp; - By default, this is a case sensitive JScript (ECMA) regular<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; expression expressed as a string. The search is applied globally<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; to the entire file name.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; JScript regex syntax documentation is available at<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; http://msdn.microsoft.com/en-us/library/ae5bf541(v=vs.80).aspx<br />:::<br />:::&nbsp; Replace - By default, this is the string to be used as a replacement for<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; each found search expression. Full support is provided for<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; substituion patterns available to the JScript replace method.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; For example, $&amp; represents the portion of the source that matched<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the entire search pattern, $1 represents the first captured<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; submatch, $2 the second captured submatch, etc. A $ literal<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; can be escaped as $$.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; An empty replacement string must be represented as &quot;&quot;.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Replace substitution pattern syntax is fully documented at<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; http://msdn.microsoft.com/en-US/library/efy6s3e6(v=vs.80).aspx<br />:::<br />:::&nbsp; Options:&nbsp; Behavior may be altered by appending one or more options.<br />:::&nbsp; The option names are case insensitive, and may appear in any order<br />:::&nbsp; after the Replace argument. Options may be prefaced with / or -<br />:::<br />:::&nbsp; &nbsp; &nbsp; /D&nbsp; - Rename Directories instead of files.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /FM FileOrFolderMask<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Only rename files or folders that match any of the pattern(s)<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using standard wildcards. Multiple patterns are delimited by a<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pipe (|). Only complete name matches count.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * matches any 0 or more characters<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ? matches any 0 or 1 character except .<br />:::<br />:::&nbsp; &nbsp; &nbsp; /FX FileOrFolderExclusion<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exclude files or folders that match any of the pattern(s)<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using standard wildcards. Multiple patterns are delimited by a<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pipe (|). Only complete name matches count.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * matches any 0 or more characters<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ? matches any 0 or 1 character except .<br />:::<br />:::&nbsp; &nbsp; &nbsp; /I&nbsp; - Ignore case when matching.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /J&nbsp; - Treat Replace as a JScript expression.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The following variables contain details about each match:<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $0 = the substring that matched the Search<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $1 through $n = captured submatch strings<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $off = the offset where the match occurred<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $src = the original source string<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The following are also available:<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $n = An incrementing number for use in the name. The value<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;is reset to the /NBEG value for each directory.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;It increases by the /NINC value for each renamed file.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;The value may be zero padded to the width specified by<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the /NPAD value.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lc(str)<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Convert str to lower case. Shorthand for str.toLowerCase().<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uc(str)<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Convert str to upper case. Shorthand for str.toUpperCase().<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lpad(string,pad)<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Used to left pad string str to a minimum length. If the<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;str already has length &gt;= the pad string length, then no<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;change is made. Otherwise it left pads the value with the<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;characters of the pad string to the length of pad.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Examples:<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lpad(15,'0000')&nbsp; &nbsp; returns &quot;0015&quot;<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lpad(15,'&nbsp; &nbsp; ')&nbsp; &nbsp; returns &quot;&nbsp; 15&quot;<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lpad(19011,'0000') returns &quot;19011&quot;<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; rpad(string,pad)<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Used to right pad the string to a minimum length. If the<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;str already has length &gt;= the pad string length, then no<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;change is made. Otherwise it right pads the value with the<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;characters of the pad string to the length of pad.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ts( {option:value, option:value...} )<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Perform date/time computations and produce formatted<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;timestamps. This function can get the current date/and time,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;or get the created/lastModified/lastAccessed timestamps for<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the file being renamed, or parse a date/time from the name<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;of the file, or use a user specified value.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Use JREN /?TS() to get help on the ts() function<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; attr( &#91;offChar&#93; )<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Lists the attributes of the file/folder. Set attributes are<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;listed in upper case and unset attributes are shown as the<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;offChar, or lower case. The listed attributes are:<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;R - Read Only<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;H - Hidden<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;S - System<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;A - Archive<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;L - Link or Shortcut<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;C - Compressed<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; size( &#91;pad&#93; )<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;File/folder size, optionally left padded to the length of<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the pad string.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; type( &#91;pad&#93; )<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;File/folder type, optionally right padded to the length of<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the pad string.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; name( &#91;pad&#93; )<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Name of the file/folder, optionally right padded to<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the length of the pad string.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; path( &#91;pad&#93; )<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Full Path of file/folder, optionally right padded to<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the length of the pad string.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; parent( &#91;pad&#93; )<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Path of the parent folder, optionally right padded to<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the length of the pad string.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sName( &#91;pad &#93;)<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Short (8.3) name of the file/folder, optionally right padded<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;to the length of the pad string.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sPath( &#91;pad&#93; )<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Path of the file/folder using short (8.3) names, optionally<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;right padded to the length of the pad string.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sParent( &#91;pad&#93; )<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Path of the parent folder using short (8.3) names,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;optionally right padded to the length of the pad string.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /L&nbsp; - Convert names to Lower case. Entire names can be converted to<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lower case without any other changes by using empty strings (&quot;&quot;)<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for both Search and Replace.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /LIST - List the Rename results only, without quotes, and without<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; renaming anything. Invalid file name characters are ignored.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The resulting &quot;name&quot; is always listed, even if no change.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /NBEG BeginValue<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Specifies the initial $n value for each directory. The value<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; must be an integer &gt;= 0. The default value is 1.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /NINC IncrementValue<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Specifies the amount $n is incremented after each rename.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The value must be an integer &gt;=1. The default value is 1.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /NPAD MinWidth<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Specifies the minimum width for each $n value. If the $n value<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; has fewer digits than MinWidth, then the value is zero padded<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; on the left to achieve the MinWidth. The value must be &gt;= 1.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The default value is 3.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /P RootPath<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Specifies the path where the rename is to take place.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The default of . represents the current directory.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Wildcards are not allowed.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /PM PathMask<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Only rename files or folders whose parent folder path matches<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; any of the PathMask pattern(s) using augmented wildcards.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Multiple patterns are delimited by a pipe (|). Only full path<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; matches count.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /P:&nbsp; matches the root path specified by option /P<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; **&nbsp; &nbsp;matches any 0 or more characters<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *&nbsp; &nbsp; matches any 0 or more characters except \<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ?&nbsp; &nbsp; matches any 0 or 1 character except . or \<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This option is only useful if the /S option is used.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /PX PathExclusion<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exclude files or folders whose parent folder path matches any<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; of the PathExclusion pattern(s) using augmented wildcards.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Multiple patterns are delimited by a pipe (|). Only full path<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; matches count.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /P:&nbsp; matches the root path specified by option /P<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; **&nbsp; &nbsp;matches any 0 or more characters<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *&nbsp; &nbsp; matches any 0 or more characters except \<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ?&nbsp; &nbsp; matches any 0 or 1 character except . or \<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This option is only useful if the /S option is used.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /Q&nbsp; - Do not list the renamed files/folders (Quiet mode).<br />:::<br />:::&nbsp; &nbsp; &nbsp; /RFM RegexFileOrFoldereMask<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Only rename files or folders that match the regular expression,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ignoring case. Partial name matches count.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /RFX RegexFileOrFolderExclusion<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exclude files or folders that match the regular Expression,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ignoring case. Partial name matches count.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /RPM RegexPathMask<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Only rename files or folders whose parent folder path matches the<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RegexPathMask regular expression, ignoring case. Partial path<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; matches count. This option is really only useful if the /S<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; option is used.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /RPX RegexPathExclusion<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exclude files or folders whose parent folder path matches the<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RegexPathExclusion regular expression, ignoring case. Partial<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; path matches count. This option is really only useful if the<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /S option is used.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /S&nbsp; - Recurse Subdirectories.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /T&nbsp; - List the rename operations that would be attempted,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; but do not rename anything. (Test mode)<br />:::<br />:::&nbsp; &nbsp; &nbsp; /U&nbsp; - Convert names to Upper case. Entire names can be converted to<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; upper case without any other changes by using empty strings (&quot;&quot;)<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for both Search and Replace.<br />:::<br />:::&nbsp; Help is available by supplying a single argument beginning with /?:<br />:::<br />:::&nbsp; &nbsp; &nbsp; /?&nbsp; &nbsp; &nbsp; &nbsp; - Writes this help documentation to stdout.<br />:::&nbsp; &nbsp; &nbsp; /??&nbsp; &nbsp; &nbsp; &nbsp;- Same as /? except uses MORE to provide pagination<br />:::<br />:::&nbsp; &nbsp; &nbsp; /?REGEX&nbsp; &nbsp;- Opens up Microsoft's JScript regular expression<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; documentation within your browser.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /?REPLACE - Opens up Microsoft's JScript REPLACE documentation<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; within your browser.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /?VERSION - Writes the JREN version number to stdout.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /?TS()&nbsp; &nbsp; - Writes documentation for the ts() function to stdout.<br />:::&nbsp; &nbsp; &nbsp; /??TS()&nbsp; &nbsp;- Same as /??TS() except uses MORE for pagination.<br />:::<br />:::&nbsp; JREN.BAT was written by Dave Benham, and originally posted at<br />:::&nbsp; http://www.dostips.com/forum/viewtopic.php?f=3&amp;t=6081<br />:::<br />:: =============== ts() documentation ===============<br />::+<br />::+ts( &#91; { &#91;option:value &#91;,option:value&#93;...&#93; } &#93; )<br />::+&nbsp; <br />::+&nbsp; A JScript function that can performs date and time computations and return<br />::+&nbsp; a formatted time string.<br />::+&nbsp; <br />::+&nbsp; The option object argument within curly braces is optional - if no argument<br />::+&nbsp; is given, then it returns the current timestamp using compressed ISO 8601<br />::+&nbsp; format with milliseconds and local time zone - YYYYMMDDThhmmss.fff+zzzz<br />::+&nbsp; <br />::+&nbsp; &nbsp; Examples:<br />::+&nbsp; &nbsp; &nbsp; ts()&nbsp; - Current date/time:&nbsp; YYYYMMDDThhmmss.fff+zzzz<br />::+&nbsp; &nbsp; &nbsp; ts({dt:'created',fmt:'{iso-dt}'})&nbsp; - The file create date:&nbsp; YYYY-MM-DD<br />::+&nbsp; &nbsp; &nbsp; ts({od:-1,fmt:'{YYYY}_{MM}_{DD}'}) - Yesterday's date:&nbsp; YYYY_MM_DD<br />::+&nbsp; <br />::+&nbsp; Option names are case sensitive. There are 5 types of options:<br />::+&nbsp; &nbsp; 1) Specify the base date&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - dt:<br />::+&nbsp; &nbsp; 2) Specify date/time offsets&nbsp; &nbsp; &nbsp; - oy: om: od: oh: on: os: of:<br />::+&nbsp; &nbsp; 3) Specify the output time zone&nbsp; &nbsp;- tz:<br />::+&nbsp; &nbsp; 4) Specify the output format&nbsp; &nbsp; &nbsp; - fmt:<br />::+&nbsp; &nbsp; 5) Configure the day-of-week and&nbsp; - wkd: weekday: mth: month:<br />::+&nbsp; &nbsp; &nbsp; &nbsp;month names for non-English<br />::+&nbsp; &nbsp; &nbsp; &nbsp;users<br />::+<br />::+&nbsp; Specify the base date and time<br />::+<br />::+&nbsp; &nbsp; dt:&nbsp; Value specifies the base date and time. Many formats supported:<br />::+<br />::+&nbsp; &nbsp; &nbsp; Current local date/time<br />::+&nbsp; &nbsp; &nbsp; &nbsp; - do not specify a dt: value<br />::+&nbsp; &nbsp; &nbsp; &nbsp; - undefined value<br />::+&nbsp; &nbsp; &nbsp; &nbsp; - empty string ''<br />::+<br />::+&nbsp; &nbsp; &nbsp; &nbsp; Examples:<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:''<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:undefined<br />::+<br />::+&nbsp; &nbsp; &nbsp; Milliseconds since 1970-01-01 00:00:00 UTC<br />::+&nbsp; &nbsp; &nbsp; &nbsp; - NumericExpression (math OK)<br />::+&nbsp; &nbsp; &nbsp; &nbsp; - NumericString (no math)<br />::+<br />::+&nbsp; &nbsp; &nbsp; &nbsp; Examples:<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt: 1391230800000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = January 1, 19970 00:00:00 UTC<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt: 1391230000000+800000&nbsp; &nbsp;= January 1, 19970 00:00:00 UTC<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:'1391230800000'&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= January 1, 19970 00:00:00 UTC<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:'1391230000000+800000'&nbsp; = error<br />::+<br />::+&nbsp; &nbsp; &nbsp; String timestamp representation<br />::+&nbsp; &nbsp; &nbsp; &nbsp; - Any string accepted by the JScript Date.Parse() method.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; See http://msdn.microsoft.com/en-us/library/k4w173wk(v=vs.84).aspx<br />::+<br />::+&nbsp; &nbsp; &nbsp; &nbsp; Examples: All of the following represent Midnight on January 4, 2013<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; assuming local time zone is U.S Eastern Standard Time (EST)<br />::+<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:'1-4-2013'&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Defaults to local time zone<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:'January 4, 2013 EST'&nbsp; &nbsp; &nbsp; &nbsp;Explicit Eastern Std Time (US)<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:'2013/1/4 -05'&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Explicit Eastern Std Time (US)<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:'Jan 3 2013 23: CST'&nbsp; &nbsp; &nbsp; &nbsp; Central Standard Time (US)<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:'2013 3 Jan 9:00 pm -0800'&nbsp; Pacific Standard Time (US)<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:'01/04/2013 05:00:00 UTC'&nbsp; &nbsp;Universal Coordinated Time<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:'1/4/2013 05:30 +0530'&nbsp; &nbsp; &nbsp; India Standard Time<br />::+<br />::+&nbsp; &nbsp; &nbsp; File timestamps to millisecond accuracy using WMI. Very slow, but<br />::+&nbsp; &nbsp; &nbsp; locale agnostic. WMI call may not work on some older machines.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; - 'created'&nbsp; &nbsp;= Creation date/time of the file<br />::+&nbsp; &nbsp; &nbsp; &nbsp; - 'modified'&nbsp; = Last Modified date/time of the file<br />::+&nbsp; &nbsp; &nbsp; &nbsp; - 'accessed'&nbsp; = Last Accessed date/time of the file<br />::+<br />::+&nbsp; &nbsp; &nbsp; &nbsp; Example:<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:'created'&nbsp; = creation date/time of the file to be renamed<br />::+<br />::+&nbsp; &nbsp; &nbsp; File timestamps to second accuracy using FileSystemObject. Very fast,<br />::+&nbsp; &nbsp; &nbsp; but locale dependent. May not parse properly for some countries.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; - 'fsoCreated'&nbsp; = Creation date/time of the file<br />::+&nbsp; &nbsp; &nbsp; &nbsp; - 'fsoModified' = Last Modified date/time of the file<br />::+&nbsp; &nbsp; &nbsp; &nbsp; - 'fsoAccessed' = Last Accessed date/time of the file<br />::+<br />::+&nbsp; &nbsp; &nbsp; Array with 2 to 7 numeric expressions (local time only)<br />::+&nbsp; &nbsp; &nbsp; &nbsp; - &#91;year,months,days,hours,minutes,seconds,milliseconds&#93;<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; year and months are required, the rest are optional<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Missing values are assumed to be 0<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Missing values are not allowed between specified values<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; month 0 = January<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; day 1 = First day of month, day 0 = Last day of prior month<br />::+<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Examples:<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:&#91;2014,3,1,17,30,22,457&#93;&nbsp; = April 1, 2014, 17:30:22.457<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:&#91;2014,0,1&#93;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= January 1, 2014, 00:00:00<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:&#91;2014,0&#93;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= December 31, 2013, 00:00:00<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:&#91;2014,,10&#93;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= error<br />::+<br />::+&nbsp; Date/Time offsets and time zone options all use the same syntax.<br />::+&nbsp; The value represents a numeric offset for the specified time unit.<br />::+&nbsp; It may be expressed as a numeric expression (math allowed), or<br />::+&nbsp; a numeric string (no math allowed). Both positive and negative<br />::+&nbsp; values may be used.<br />::+<br />::+&nbsp; &nbsp; oy:&nbsp; Year offset<br />::+&nbsp; &nbsp; om:&nbsp; Months offset<br />::+&nbsp; &nbsp; od:&nbsp; Days offset<br />::+&nbsp; &nbsp; oh:&nbsp; Hours offset<br />::+&nbsp; &nbsp; on:&nbsp; Minutes offset<br />::+&nbsp; &nbsp; os:&nbsp; Seconds offset<br />::+&nbsp; &nbsp; of:&nbsp; Milliseconds (Fractional seconds) offset<br />::+<br />::+&nbsp; &nbsp; tz:&nbsp; Time zone used for output = minutes offset from UTC<br />::+<br />::+&nbsp; The fmt: option is a string that specifies the format of the output.<br />::+&nbsp; Strings within curly braces are replaced by dynamic components that are<br />::+&nbsp; derived from the computed time stamp. Strings within braces that do not<br />::+&nbsp; match a fmt: component are left as is. Strings not in braces are left<br />::+&nbsp; as is. The format component names are not case senstive.<br />::+<br />::+&nbsp; For example, a U.S. date would be represented as fmt:'{yyyy}/{mm}/{dd}'<br />::+<br />::+&nbsp; The default format is '{ISOTS}', which yields YYYYMMDDThhmmss.fff+hhmm<br />::+<br />::+&nbsp; &nbsp; {YYYY}&nbsp; 4 digit year, zero padded<br />::+<br />::+&nbsp; &nbsp; {YY}&nbsp; &nbsp; 2 digit year, zero padded<br />::+<br />::+&nbsp; &nbsp; {Y}&nbsp; &nbsp; &nbsp;year without zero padding<br />::+<br />::+&nbsp; &nbsp; {MONTH} month name<br />::+<br />::+&nbsp; &nbsp; {MTH}&nbsp; &nbsp;month abbreviation<br />::+<br />::+&nbsp; &nbsp; {MM}&nbsp; &nbsp; 2 digit month, zero padded<br />::+<br />::+&nbsp; &nbsp; {M}&nbsp; &nbsp; &nbsp;month without zero padding<br />::+<br />::+&nbsp; &nbsp; {WEEKDAY} day of week name<br />::+<br />::+&nbsp; &nbsp; {WKD}&nbsp; &nbsp;day of week abbreviation<br />::+<br />::+&nbsp; &nbsp; {W}&nbsp; &nbsp; &nbsp;day of week number, 0=Sunday<br />::+<br />::+&nbsp; &nbsp; {DD}&nbsp; &nbsp; 2 digit day, zero padded<br />::+<br />::+&nbsp; &nbsp; {D}&nbsp; &nbsp; &nbsp;day without zero padding<br />::+<br />::+&nbsp; &nbsp; {HH}&nbsp; &nbsp; 2 digit hours, 24 hour format, zero padded<br />::+<br />::+&nbsp; &nbsp; {H}&nbsp; &nbsp; &nbsp;hours, 24 hour format without zero padding<br />::+<br />::+&nbsp; &nbsp; {HH12}&nbsp; 2 digit hours, 12 hour format, zero padded<br />::+<br />::+&nbsp; &nbsp; {H12}&nbsp; &nbsp;hours, 12 hour format without zero padding<br />::+<br />::+&nbsp; &nbsp; {NN}&nbsp; &nbsp; 2 digit minutes, zero padded<br />::+<br />::+&nbsp; &nbsp; {N}&nbsp; &nbsp; &nbsp;minutes without padding<br />::+<br />::+&nbsp; &nbsp; {SS}&nbsp; &nbsp; 2 digit seconds, zero padded<br />::+<br />::+&nbsp; &nbsp; {S}&nbsp; &nbsp; &nbsp;seconds without padding<br />::+<br />::+&nbsp; &nbsp; {FFF}&nbsp; &nbsp;3 digit milliseconds, zero padded<br />::+<br />::+&nbsp; &nbsp; {F}&nbsp; &nbsp; &nbsp;milliseconds without padding<br />::+<br />::+&nbsp; &nbsp; {AM}&nbsp; &nbsp; AM or PM in upper case<br />::+<br />::+&nbsp; &nbsp; {PM}&nbsp; &nbsp; am or pm in lower case<br />::+<br />::+&nbsp; &nbsp; {ZZZZ}&nbsp; timezone expressed as minutes offset from UTC,<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; zero padded to 3 digits with sign<br />::+<br />::+&nbsp; &nbsp; {Z}&nbsp; &nbsp; &nbsp;timzone minutes offset from UTC without padding<br />::+<br />::+&nbsp; &nbsp; {ZS}&nbsp; &nbsp; timezone sign<br />::+<br />::+&nbsp; &nbsp; {ZH}&nbsp; &nbsp; timezone hours hours offset from UTC, (no sign),<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; padded to 2 digits<br />::+<br />::+&nbsp; &nbsp; {ZM}&nbsp; &nbsp; timezone minutes offset from UTC (no sign),<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; padded to 2 digits<br />::+<br />::+&nbsp; &nbsp; {ISOTS} YYYYMMDDThhmmss.fff+hhss<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Compressed ISO 8601 date/time (timestamp) with milliseconds<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; and time zone<br />::+<br />::+&nbsp; &nbsp; {ISODT} YYYYMMDD<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Compressed ISO 8601 date format<br />::+<br />::+&nbsp; &nbsp; {ISOTM} hhmmss.fff<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Compressed ISO 8601 time format with milliseconds<br />::+<br />::+&nbsp; &nbsp; {ISOTZ} +hhmm<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Compressed ISO 8601 timezone format<br />::+<br />::+&nbsp; &nbsp; {ISO-TS} YYYY-MM-DDThh:mm:ss.fff+hh:ss<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ISO 8601 date/time (timestamp) with milliseconds and time zone<br />::+<br />::+&nbsp; &nbsp; {ISO-DT} YYYY-MM-DD<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ISO 8601 date format<br />::+<br />::+&nbsp; &nbsp; {ISO-TM} hh:mm:ss.fff<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ISO 8601 time format with milliseconds<br />::+<br />::+&nbsp; &nbsp; {ISO-TZ} +hh:mm<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ISO 8601 timezone<br />::+<br />::+&nbsp; &nbsp; {U}&nbsp; &nbsp; &nbsp;Unix Epoch time: same as {US}<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Seconds since 1970-01-01 00:00:00 UTC.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Negative numbers represent dates prior to 1970-01-01.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This value should not be used with the -TZ option<br />::+<br />::+&nbsp; &nbsp; {UMS}&nbsp; &nbsp;Milliseconds since 1970-01-01 00:00:00.000 UTC.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Negative numbers represent days prior to 1970-01-01.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This value should not be used with the -TZ option<br />::+<br />::+&nbsp; &nbsp; {US}&nbsp; &nbsp; Seconds since 1970-01-01 00:00:00.000 UTC.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Negative numbers represent days prior to 1970-01-01.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This value should not be used with the -TZ option<br />::+<br />::+&nbsp; &nbsp; {UM}&nbsp; &nbsp; Minutes since 1970-01-01 00:00:00.000 UTC.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Negative numbers represent days prior to 1970-01-01.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This value should not be used with the -TZ option<br />::+<br />::+&nbsp; &nbsp; {UH}&nbsp; &nbsp; Hours since 1970-01-01 00:00:00.000 UTC.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Negative numbers represent days prior to 1970-01-01.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This value should not be used with the -TZ option<br />::+<br />::+&nbsp; &nbsp; {UD}&nbsp; &nbsp; Days since 1970-01-01 00:00:00.000 UTC.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Negative numbers represent days prior to 1970-01-01.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This value should not be used with the -TZ option<br />::+<br />::+&nbsp; &nbsp; {USD}&nbsp; &nbsp;Decimal seconds since 1970-01-01 00:00:00.000 UTC.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Negative numbers represent days prior to 1970-01-01.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This value should not be used with the -TZ option<br />::+<br />::+&nbsp; &nbsp; {UMD}&nbsp; &nbsp;Decimal minutes since 1970-01-01 00:00:00.000 UTC.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Negative numbers represent days prior to 1970-01-01.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This value should not be used with the -TZ option<br />::+<br />::+&nbsp; &nbsp; {UHD}&nbsp; &nbsp;Decimal hours since 1970-01-01 00:00:00.000 UTC.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Negative numbers represent days prior to 1970-01-01.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This value should not be used with the -TZ option<br />::+<br />::+&nbsp; &nbsp; {UDD}&nbsp; &nbsp;Decimal days since 1970-01-01 00:00:00.000 UTC.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Negative numbers represent days prior to 1970-01-01.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This value should not be used with the -TZ option<br />::+<br />::+&nbsp; &nbsp; {{}&nbsp; &nbsp; &nbsp;A { character<br />::+<br />::+&nbsp; The following options override the default English names for the months<br />::+&nbsp; and days of the week. The value for each option is a space delimited list<br />::+&nbsp; of names or abbreviations.<br />::+<br />::+&nbsp; &nbsp; wkd: Day of week abbreviations<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;default = 'Sun Mon Tue Wed Thu Fri Sat'<br />::+<br />::+&nbsp; &nbsp; weekday: Day of week names<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;default = 'Sunday Monday Tuesday Wednesday Thursday Friday'<br />::+<br />::+&nbsp; &nbsp; mth: Month abbreviations<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;default = 'Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec'<br />::+<br />::+&nbsp; &nbsp; month: Month names<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;default = 'January February March April May Jun July August'<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+ ' September October November December'<br />::+<br />============= :Batch portion ============<br />@echo off<br />setlocal disableDelayedExpansion<br /><br />if .%2 equ . (<br />&nbsp; set &quot;test=%~1&quot;<br />&nbsp; setlocal enableDelayedExpansion<br />&nbsp; if &quot;!test:~0,1!&quot; equ &quot;-&quot; set &quot;test=/!test:~1!&quot;<br />&nbsp; if &quot;!test!&quot; equ &quot;/?&quot; (<br />&nbsp; &nbsp; for /f &quot;tokens=* delims=:&quot; %%A in ('findstr &quot;^:::&quot; &quot;%~f0&quot;') do @echo(%%A<br />&nbsp; &nbsp; exit /b 0<br />&nbsp; ) else if &quot;!test!&quot; equ &quot;/??&quot; 2&gt;nul (<br />&nbsp; &nbsp; (for /f &quot;tokens=* delims=:&quot; %%A in ('findstr &quot;^:::&quot; &quot;%~f0&quot;') do @echo(%%A)|more /e<br />&nbsp; &nbsp; exit /b 0<br />&nbsp; ) else if /i &quot;!test!&quot; equ &quot;/?ts()&quot; (<br />&nbsp; &nbsp; for /f &quot;tokens=* delims=:+&quot; %%A in ('findstr &quot;^::+&quot; &quot;%~f0&quot;') do @echo(%%A<br />&nbsp; &nbsp; exit /b 0<br />&nbsp; ) else if /i &quot;!test!&quot; equ &quot;/??ts()&quot; 2&gt;nul (<br />&nbsp; &nbsp; (for /f &quot;tokens=* delims=:+&quot; %%A in ('findstr &quot;^::+&quot; &quot;%~f0&quot;') do @echo(%%A)|more /e<br />&nbsp; &nbsp; exit /b 0<br />&nbsp; ) else if /i &quot;!test!&quot; equ &quot;/?regex&quot; (<br />&nbsp; &nbsp; explorer &quot;http://msdn.microsoft.com/en-us/library/ae5bf541(v=vs.80).aspx&quot;<br />&nbsp; &nbsp; exit /b 0<br />&nbsp; ) else if /i &quot;!test!&quot; equ &quot;/?replace&quot; (<br />&nbsp; &nbsp; explorer &quot;http://msdn.microsoft.com/en-US/library/efy6s3e6(v=vs.80).aspx&quot;<br />&nbsp; &nbsp; exit /b 0<br />&nbsp; ) else if /i &quot;!test!&quot; equ &quot;/?version&quot; (<br />&nbsp; &nbsp; for /f &quot;tokens=* delims=:&quot; %%A in ('findstr &quot;^::JREN\.BAT&quot; &quot;%~f0&quot;') do @echo(%%A<br />&nbsp; &nbsp; exit /b 0<br />&nbsp; ) else (<br />&nbsp; &nbsp; call :err &quot;Insufficient arguments&quot;<br />&nbsp; &nbsp; exit /b 2<br />&nbsp; )<br />)<br /><br />:: Define options<br />set &quot;options= /D: /FM:&quot;&quot; /FX:&quot;&quot; /I: /J: /L: /LIST: /NBEG:1 /NINC:1 /NPAD:3 /P:. /PM:&quot;&quot; /PX:&quot;&quot; /RFM:&quot;&quot; /RFX:&quot;&quot; /RPM:&quot;&quot; /RPX:&quot;&quot; /Q: /S: /T: /U: &quot;<br /><br />:: Set default option values<br />for %%O in (%options%) do for /f &quot;tokens=1,* delims=:&quot; %%A in (&quot;%%O&quot;) do set &quot;%%A=%%~B&quot;<br /><br />:: Get options<br />:loop<br />if not &quot;%~3&quot;==&quot;&quot; (<br />&nbsp; set &quot;test=%~3&quot;<br />&nbsp; setlocal enableDelayedExpansion<br />&nbsp; if &quot;!test:~0,1!&quot; equ &quot;-&quot; set &quot;test=/!test:~1!&quot;<br />&nbsp; if &quot;!test:~0,1!&quot; neq &quot;/&quot; (<br />&nbsp; &nbsp; call :err &quot;Too many arguments&quot;<br />&nbsp; &nbsp; exit /b 2<br />&nbsp; )<br />&nbsp; for /f &quot;delims=&quot; %%A in (&quot;!test!&quot;) do (<br />&nbsp; &nbsp; set &quot;test=!options:*%%A:=! &quot;<br />&nbsp; &nbsp; if &quot;!test!&quot;==&quot;!options! &quot; (<br />&nbsp; &nbsp; &nbsp; &nbsp; endlocal<br />&nbsp; &nbsp; &nbsp; &nbsp; call :err &quot;Invalid option %~3&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; exit /b 2<br />&nbsp; &nbsp; ) else if &quot;!test:~0,1!&quot;==&quot; &quot; (<br />&nbsp; &nbsp; &nbsp; &nbsp; endlocal<br />&nbsp; &nbsp; &nbsp; &nbsp; set &quot;%%A=1&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; if /i &quot;%%A&quot; equ &quot;/L&quot; set &quot;/U=&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; if /i &quot;%%A&quot; equ &quot;/U&quot; set &quot;/L=&quot;<br />&nbsp; &nbsp; ) else (<br />&nbsp; &nbsp; &nbsp; &nbsp; endlocal<br />&nbsp; &nbsp; &nbsp; &nbsp; if %4. equ . (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call :err &quot;Missing %~3 value&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit /b 2<br />&nbsp; &nbsp; &nbsp; &nbsp; )<br />&nbsp; &nbsp; &nbsp; &nbsp; set &quot;%%A=%~4&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; shift /3<br />&nbsp; &nbsp; )<br />&nbsp; )<br />&nbsp; shift /3<br />&nbsp; goto :loop<br />)<br /><br />:: Execute<br />cscript //E:JScript //nologo &quot;%~f0&quot; %1 %2<br />exit /b %errorlevel%<br /><br />:err<br />&gt;&amp;2 (<br />&nbsp; echo ERROR: %~1<br />)<br />exit /b<br /><br />************* JScript portion **********/<br />var $n<br />var _g=new Object();<br />try {<br /><br />&nbsp; _g.defineReplFunc=function() {<br />&nbsp; &nbsp; eval(_g.replFunc);<br />&nbsp; }<br /><br />&nbsp; _g.main=function() {<br /><br />&nbsp; &nbsp; function err( msg, rtn ) {<br />&nbsp; &nbsp; &nbsp; WScript.StdErr.WriteLine(msg);<br />&nbsp; &nbsp; &nbsp; if (rtn) WScript.Quit(rtn);<br />&nbsp; &nbsp; }<br /><br />&nbsp; &nbsp; function BuildRegex( loc, regex, options ) {<br />&nbsp; &nbsp; &nbsp; try {<br />&nbsp; &nbsp; &nbsp; &nbsp; return regex ? new RegExp( regex, options ) : false;<br />&nbsp; &nbsp; &nbsp; } catch(e) {<br />&nbsp; &nbsp; &nbsp; &nbsp; err( 'Invalid '+loc+' regular expression: '+e.message, 1);<br />&nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; }<br /><br />&nbsp; &nbsp; function GetInt( loc, numStr, minVal ) {<br />&nbsp; &nbsp; &nbsp; var n = parseInt( numStr );<br />&nbsp; &nbsp; &nbsp; if (isNaN(n) || n&lt;minVal) {<br />&nbsp; &nbsp; &nbsp; &nbsp; err( 'Error: Invalid '+loc+' value', 1 );<br />&nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; return n;<br />&nbsp; &nbsp; }<br /><br />&nbsp; &nbsp; var env = WScript.CreateObject(&quot;WScript.Shell&quot;).Environment(&quot;Process&quot;),<br />&nbsp; &nbsp; &nbsp; &nbsp; fso = new ActiveXObject(&quot;Scripting.FileSystemObject&quot;);<br /><br />&nbsp; &nbsp; try {<br />&nbsp; &nbsp; &nbsp; var root = fso.GetFolder( env('/P') );<br />&nbsp; &nbsp; } catch(e) {<br />&nbsp; &nbsp; &nbsp; err( 'Invalid /P path: '+e.message, 1 );<br />&nbsp; &nbsp; }<br /><br />&nbsp; &nbsp; function MaskRepl($0) {<br />&nbsp; &nbsp; &nbsp; switch ($0) {<br />&nbsp; &nbsp; &nbsp; &nbsp; case '/P:':<br />&nbsp; &nbsp; &nbsp; &nbsp; case '/p:': return root.Path.replace(/&#91;.^$*+?()&#91;{\\|&#93;/g,&quot;\\$&amp;&quot;);<br />&nbsp; &nbsp; &nbsp; &nbsp; case '**':&nbsp; return '.*';<br />&nbsp; &nbsp; &nbsp; &nbsp; case '*':&nbsp; &nbsp;return '&#91;^\\\\&#93;*';<br />&nbsp; &nbsp; &nbsp; &nbsp; case '?':&nbsp; &nbsp;return '&#91;^\\\\.&#93;?';<br />&nbsp; &nbsp; &nbsp; &nbsp; default:&nbsp; &nbsp; return '\\'+$0;<br />&nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; }<br /><br />&nbsp; &nbsp; var args=WScript.Arguments,<br />&nbsp; &nbsp; &nbsp; &nbsp; search = BuildRegex( 'Search', args.Item(0), env('/I')?'gi':'g' ),<br />&nbsp; &nbsp; &nbsp; &nbsp; replace=args.Item(1),<br />&nbsp; &nbsp; &nbsp; &nbsp; rMask = BuildRegex( '/RFM', env('/RFM'), 'i' ),<br />&nbsp; &nbsp; &nbsp; &nbsp; rExclude = BuildRegex( '/RFX', env('/RFX'), 'i' ),<br />&nbsp; &nbsp; &nbsp; &nbsp; rPathMask = BuildRegex( '/RPM', env('/RPM'), 'i' ),<br />&nbsp; &nbsp; &nbsp; &nbsp; rPathExclude = BuildRegex( '/RPX', env('/RPX'), 'i' ),<br />&nbsp; &nbsp; &nbsp; &nbsp; regex = new RegExp(&quot;/P:|&#91;*&#93;&#91;*&#93;|&#91;*&#93;|&#91;?&#93;|&#91;.^$+()&#91;{\\\\&#93;&quot;,&quot;ig&quot;);<br />&nbsp; &nbsp; &nbsp; &nbsp; mask = env('/FM') ? new RegExp( '^(?:' + env('/FM').replace(regex,MaskRepl) + ')$', 'i' ) : false;<br />&nbsp; &nbsp; &nbsp; &nbsp; exclude = env('/FX') ? new RegExp( '^(?:' + env('/FX').replace(regex,MaskRepl) + ')$', 'i' ) : false;<br />&nbsp; &nbsp; &nbsp; &nbsp; pathMask = env('/PM') ? new RegExp( '^(?:' + env('/PM').replace(regex,MaskRepl) + ')$', 'i' ) : false;<br />&nbsp; &nbsp; &nbsp; &nbsp; pathExclude = env('/PX') ? new RegExp( '^(?:' + env('/PX').replace(regex,MaskRepl) + ')$', 'i' ) : false;<br />&nbsp; &nbsp; &nbsp; &nbsp; upper = env('/U'),<br />&nbsp; &nbsp; &nbsp; &nbsp; lower = env('/L'),<br />&nbsp; &nbsp; &nbsp; &nbsp; recurse = env('/S'),<br />&nbsp; &nbsp; &nbsp; &nbsp; jscript = env('/J'),<br />&nbsp; &nbsp; &nbsp; &nbsp; list = env('/LIST'),<br />&nbsp; &nbsp; &nbsp; &nbsp; beg = GetInt( '/NBEG', env('/NBEG'), 0 ),<br />&nbsp; &nbsp; &nbsp; &nbsp; inc = GetInt( '/NINC', env('/NINC'), 1 ),<br />&nbsp; &nbsp; &nbsp; &nbsp; pad = GetInt( '/NPAD', env('/NPAD'), 1 ),<br />&nbsp; &nbsp; &nbsp; &nbsp; padStr = Array( pad+1 ).join('0'),<br />&nbsp; &nbsp; &nbsp; &nbsp; test = env('/T'),<br />&nbsp; &nbsp; &nbsp; &nbsp; quiet = env('/Q');<br /><br />&nbsp; &nbsp; _g.dirs = env('/D');<br /><br />&nbsp; &nbsp; function ProcessFolder( folder ) {<br />&nbsp; &nbsp; &nbsp; var i, a=&#91;&#93;;<br />&nbsp; &nbsp; &nbsp; var num = beg;<br />&nbsp; &nbsp; &nbsp; if (recurse || _g.dirs) {<br />&nbsp; &nbsp; &nbsp; &nbsp; var folders = new Enumerator(folder.SubFolders);<br />&nbsp; &nbsp; &nbsp; &nbsp; for( i=0 ; !folders.atEnd(); folders.moveNext()) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; a&#91;i++&#93;=folders.item()<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (recurse) ProcessFolder(folders.item());<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; if ( (!pathMask || pathMask.test(folder.Path)) &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(!rPathMask || rPathMask.test(folder.Path)) &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(!pathExclude || !pathExclude.test(folder.Path)) &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(!rPathExclude || !rPathExclude.test(folder.Path)) ) {<br />&nbsp; &nbsp; &nbsp; &nbsp; if (!_g.dirs) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; a=&#91;&#93;;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var files = new Enumerator(folder.Files);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for (i=0; !files.atEnd(); files.moveNext()) a&#91;i++&#93;=files.item();<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; for (i=0; i&lt;a.length; i++) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; _g.file = a&#91;i&#93;;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; _g.wmiFile = undefined;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var oldName = a&#91;i&#93;.Name;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ( (!mask || mask.test(oldName)) &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(!rMask || rMask.test(oldName)) &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(!exclude || !exclude.test(oldName)) &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(!rExclude || !rExclude.test(oldName)) ) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (jscript) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $n = num.toString();<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ($n.length&lt;pad) $n = (padStr+$n).slice(-pad);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; try {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var newName = oldName.replace( search, replace );<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } catch(e) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; err( 'Replace error: '+e.message, 1 );<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!list) newName=newName.replace( /&#91; .&#93;+$/, &quot;&quot; );<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (jscript &amp;&amp; !list &amp;&amp; newName.search(/&#91;&lt;&gt;|:/\\*?&quot;\x00-\x1F&#93;/)&gt;=0) err('Error: Invalid file name character in Replace',1);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (upper) newName = uc(newName);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (lower) newName = lc(newName);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (newName != oldName || list) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; try {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var oldPath=a&#91;i&#93;.Path;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!test &amp;&amp; !list) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (a&#91;i&#93;.Name.toUpperCase() == newName.toUpperCase()) a&#91;i&#93;.Name = '_{JREN_tempName}_';<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; a&#91;i&#93;.Name = newName;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (list) WScript.echo(newName);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else if (!quiet) WScript.echo( '&quot;'+oldPath+'&quot;&nbsp; --&gt;&nbsp; &quot;'+newName+'&quot;' );<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } catch(e) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (a&#91;i&#93;.Name != oldName) a&#91;i&#93;.Name = oldName;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; err( 'Unable to rename &quot;'+a&#91;i&#93;.Path+'&quot;&nbsp; --&gt;&nbsp; &quot;'+newName+'&quot; : &quot;'+e.message, 0 );<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; num+=inc;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; }<br /><br />&nbsp; &nbsp; if (jscript) {<br />&nbsp; &nbsp; &nbsp; var regex=new RegExp('.|'+search,''),<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cnt;<br />&nbsp; &nbsp; &nbsp; 'x'.replace( regex, function(){cnt=arguments.length-2; return '';} );<br />&nbsp; &nbsp; &nbsp; _g.replFunc='_g.replFunc=function($0';<br />&nbsp; &nbsp; &nbsp; for (var i=1; i&lt;cnt; i++) _g.replFunc+=',$'+i;<br />&nbsp; &nbsp; &nbsp; _g.replFunc+=',$off,$src){return eval(_g.replace);}';<br />&nbsp; &nbsp; &nbsp; _g.defineReplFunc();<br />&nbsp; &nbsp; &nbsp; _g.replace = replace;<br />&nbsp; &nbsp; &nbsp; replace = _g.replFunc;<br />&nbsp; &nbsp; } else if (!list &amp;&amp; replace.search(/&#91;&lt;&gt;|:/\\*?&quot;\x00-\x1F&#93;/)&gt;=0) err('Error: Invalid file name character in Replace',1);<br /><br />&nbsp; &nbsp; ProcessFolder( root );<br />&nbsp; &nbsp; WScript.Quit(0);<br />&nbsp; }<br /><br />&nbsp; _g.main();<br /><br />} catch(e) {<br />&nbsp; WScript.StdErr.WriteLine(&quot;JScript runtime error: &quot;+e.message);<br />&nbsp; WScript.Quit(1);<br />}<br /><br />function lc(str) { return str.toLowerCase(); }<br /><br />function uc(str) { return str.toUpperCase(); }<br /><br />function lpad( val, pad ) {<br />&nbsp; if (!pad) pad='';<br />&nbsp; var rtn=val.toString();<br />&nbsp; return (rtn.length&lt;pad.length) ? (pad+rtn).slice(-pad.length) : val;<br />}<br /><br />function rpad( val, pad ) {<br />&nbsp; if (!pad) pad='';<br />&nbsp; var rtn=val.toString();<br />&nbsp; return (rtn.length&lt;pad.length) ? (rtn+pad).slice(0,pad.length) : val;<br />}<br /><br />function ts(opt) {<br />&nbsp; if (opt===undefined) opt={};<br />&nbsp; if (opt.constructor !== Object) badOp('ts()');<br />&nbsp; if (!opt.wkd)&nbsp; &nbsp; &nbsp;opt.wkd='Sun Mon Tue Wed Thu Fri Sat';<br />&nbsp; if (!opt.weekday) opt.weekday='Sunday Monday Tuesday Wednesday Thursday Friday Saturday';<br />&nbsp; if (!opt.mth)&nbsp; &nbsp; &nbsp;opt.mth='Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec';<br />&nbsp; if (!opt.month)&nbsp; &nbsp;opt.month='January February March April May June July August September October November December';<br />&nbsp; if (!opt.fmt)&nbsp; &nbsp; &nbsp;opt.fmt='{isots}';<br /><br />&nbsp; var wkd&nbsp; &nbsp; &nbsp;= opt.wkd.split(' '),<br />&nbsp; &nbsp; &nbsp; weekday = opt.weekday.split(' '),<br />&nbsp; &nbsp; &nbsp; mth&nbsp; &nbsp; &nbsp;= opt.mth.split(' '),<br />&nbsp; &nbsp; &nbsp; month&nbsp; &nbsp;= opt.month.split(' '),<br />&nbsp; &nbsp; &nbsp; y,m,d,w,h,h12,n,s,f,u,z,zs,za, dt,<br />&nbsp; &nbsp; &nbsp; sp=' ', ps='/', pc=':', pd='-', pp='.', p2='00', p3='000', p4='0000';<br />&nbsp; if (wkd.length!=7)&nbsp; &nbsp; &nbsp;badOp('wkd');<br />&nbsp; if (weekday.length!=7) badOp('weekday');<br />&nbsp; if (mth.length!=12)&nbsp; &nbsp; badOp('mth');<br />&nbsp; if (month.length!=12)&nbsp; badOp('month');<br /><br />&nbsp; dt = getDt(opt.dt);<br />&nbsp; if (opt.oy) dt.setFullYear(&nbsp; &nbsp; &nbsp;dt.getFullYear()&nbsp; &nbsp; +getNum('oy'));<br />&nbsp; if (opt.om) dt.setMonth(&nbsp; &nbsp; &nbsp; &nbsp; dt.getMonth()&nbsp; &nbsp; &nbsp; &nbsp;+getNum('om'));<br />&nbsp; if (opt.od) dt.setDate(&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dt.getDate()&nbsp; &nbsp; &nbsp; &nbsp; +getNum('od'));<br />&nbsp; if (opt.oh) dt.setHours(&nbsp; &nbsp; &nbsp; &nbsp; dt.getHours()&nbsp; &nbsp; &nbsp; &nbsp;+getNum('oh'));<br />&nbsp; if (opt.on) dt.setMinutes(&nbsp; &nbsp; &nbsp; dt.getMinutes()&nbsp; &nbsp; &nbsp;+getNum('on'));<br />&nbsp; if (opt.os) dt.setSeconds(&nbsp; &nbsp; &nbsp; dt.getSeconds()&nbsp; &nbsp; &nbsp;+getNum('os'));<br />&nbsp; if (opt.of) dt.setMilliseconds( dt.getMilliseconds()+getNum('of'));<br />&nbsp; if (opt.tz) dt.setMinutes(&nbsp; &nbsp; &nbsp; dt.getMinutes()&nbsp; +(z=getNum('tz')));<br /><br />&nbsp; y = opt.tz!==undefined ? dt.getUTCFullYear(): dt.getFullYear();<br />&nbsp; m = opt.tz!==undefined ? dt.getUTCMonth()&nbsp; &nbsp;: dt.getMonth();<br />&nbsp; d = opt.tz!==undefined ? dt.getUTCDate()&nbsp; &nbsp; : dt.getDate();<br />&nbsp; w = opt.tz!==undefined ? dt.getUTCDay()&nbsp; &nbsp; &nbsp;: dt.getDay();<br />&nbsp; h = opt.tz!==undefined ? dt.getUTCHours()&nbsp; &nbsp;: dt.getHours();<br />&nbsp; n = opt.tz!==undefined ? dt.getUTCMinutes() : dt.getMinutes();<br />&nbsp; s = opt.tz!==undefined ? dt.getUTCSeconds() : dt.getSeconds();<br />&nbsp; f = opt.tz!==undefined ? dt.getUTCMilliseconds() : dt.getMilliseconds();<br />&nbsp; u = dt.getTime();<br /><br />&nbsp; h12 = h%12;<br />&nbsp; if (!h12) h12=12;<br /><br />&nbsp; if (!opt.tz) z=-dt.getTimezoneOffset();<br />&nbsp; zs = z&lt;0 ? '-' : '+';<br />&nbsp; za = Math.abs(z);<br /><br />&nbsp; return opt.fmt.replace( /\{(.*?)\}/gi, repl );<br /><br />&nbsp; function getNum( v ) {<br />&nbsp; &nbsp; var rtn = Number(opt&#91;v&#93;);<br />&nbsp; &nbsp; if (isNaN(rtn-rtn)) badOp(v);<br />&nbsp; &nbsp; return rtn;<br />&nbsp; }<br /><br />&nbsp; function getDt( v ) {<br />&nbsp; &nbsp; var dt, n;<br />&nbsp; &nbsp; if (v===undefined) {<br />&nbsp; &nbsp; &nbsp; dt = new Date();<br />&nbsp; &nbsp; } else switch (v.constructor) {<br />&nbsp; &nbsp; &nbsp; case Date:<br />&nbsp; &nbsp; &nbsp; case Number:<br />&nbsp; &nbsp; &nbsp; &nbsp; dt = new Date(v);<br />&nbsp; &nbsp; &nbsp; &nbsp; break;<br />&nbsp; &nbsp; &nbsp; case Array:<br />&nbsp; &nbsp; &nbsp; &nbsp; try {dt=eval( 'new Date('+v.join(',')+')' )} catch(e){}<br />&nbsp; &nbsp; &nbsp; &nbsp; break;<br />&nbsp; &nbsp; &nbsp; case String:<br />&nbsp; &nbsp; &nbsp; &nbsp; switch (v.toLowerCase()) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case '':&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dt = new Date(); break;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case 'created':&nbsp; dt = getWmiDt('c'); break;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case 'modified': dt = getWmiDt('m'); break;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case 'accessed': dt = getWmiDt('a'); break;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case 'fsocreated':&nbsp; dt = new Date(_g.file.DateCreated); break;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case 'fsomodified': dt = new Date(_g.file.DateLastModified); break;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case 'fsoaccessed': dt = new Date(_g.file.DateLastAccessed); break;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; default:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; n=Number(v);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (isNaN(n-n)) dt = new Date(v);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt = new Date(n);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; break;<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; if (isNaN(dt)) badOp('dt');<br />&nbsp; &nbsp; return dt;<br />&nbsp; }<br />&nbsp;<br />&nbsp; function badOp(option) {<br />&nbsp; &nbsp; throw new Error('Invalid '+option+' value');<br />&nbsp; }<br /><br />&nbsp; function trunc( n ) { return Math&#91;n&gt;0?&quot;floor&quot;:&quot;ceil&quot;&#93;(n); }<br />&nbsp;<br />&nbsp; function repl($0,$1) {<br />&nbsp; &nbsp; switch ($1.toUpperCase()) {<br />&nbsp; &nbsp; &nbsp; case 'YYYY' : return lpad(y,p4);<br />&nbsp; &nbsp; &nbsp; case 'YY'&nbsp; &nbsp;: return (p2+y.toString()).slice(-2);<br />&nbsp; &nbsp; &nbsp; case 'Y'&nbsp; &nbsp; : return y.toString();<br />&nbsp; &nbsp; &nbsp; case 'MM'&nbsp; &nbsp;: return lpad(m+1,p2);<br />&nbsp; &nbsp; &nbsp; case 'M'&nbsp; &nbsp; : return (m+1).toString();<br />&nbsp; &nbsp; &nbsp; case 'DD'&nbsp; &nbsp;: return lpad(d,p2);<br />&nbsp; &nbsp; &nbsp; case 'D'&nbsp; &nbsp; : return d.toString();<br />&nbsp; &nbsp; &nbsp; case 'W'&nbsp; &nbsp; : return w.toString();<br />&nbsp; &nbsp; &nbsp; case 'HH'&nbsp; &nbsp;: return lpad(h,p2);<br />&nbsp; &nbsp; &nbsp; case 'H'&nbsp; &nbsp; : return h.toString();<br />&nbsp; &nbsp; &nbsp; case 'HH12' : return lpad(h12,p2);<br />&nbsp; &nbsp; &nbsp; case 'H12'&nbsp; : return h12.toString();<br />&nbsp; &nbsp; &nbsp; case 'NN'&nbsp; &nbsp;: return lpad(n,p2);<br />&nbsp; &nbsp; &nbsp; case 'N'&nbsp; &nbsp; : return n.toString();<br />&nbsp; &nbsp; &nbsp; case 'SS'&nbsp; &nbsp;: return lpad(s,p2);<br />&nbsp; &nbsp; &nbsp; case 'S'&nbsp; &nbsp; : return s.toString();<br />&nbsp; &nbsp; &nbsp; case 'FFF'&nbsp; : return lpad(f,p3);<br />&nbsp; &nbsp; &nbsp; case 'F'&nbsp; &nbsp; : return f.toString();<br />&nbsp; &nbsp; &nbsp; case 'AM'&nbsp; &nbsp;: return h&gt;=12 ? 'PM' : 'AM';<br />&nbsp; &nbsp; &nbsp; case 'PM'&nbsp; &nbsp;: return h&gt;=12 ? 'pm' : 'am';<br />&nbsp; &nbsp; &nbsp; case 'UMS'&nbsp; : return u.toString();<br />&nbsp; &nbsp; &nbsp; case 'USD'&nbsp; : return (u/1000).toString();<br />&nbsp; &nbsp; &nbsp; case 'UMD'&nbsp; : return (u/1000/60).toString();<br />&nbsp; &nbsp; &nbsp; case 'UHD'&nbsp; : return (u/1000/60/60).toString();<br />&nbsp; &nbsp; &nbsp; case 'UDD'&nbsp; : return (u/1000/60/60/24).toString();<br />&nbsp; &nbsp; &nbsp; case 'U'&nbsp; &nbsp; : return trunc(u/1000).toString();<br />&nbsp; &nbsp; &nbsp; case 'US'&nbsp; &nbsp;: return trunc(u/1000).toString();<br />&nbsp; &nbsp; &nbsp; case 'UM'&nbsp; &nbsp;: return trunc(u/1000/60).toString();<br />&nbsp; &nbsp; &nbsp; case 'UH'&nbsp; &nbsp;: return trunc(u/1000/60/60).toString();<br />&nbsp; &nbsp; &nbsp; case 'UD'&nbsp; &nbsp;: return trunc(u/1000/60/60/24).toString();<br />&nbsp; &nbsp; &nbsp; case 'ZZZZ' : return zs+lpad(za,p3);<br />&nbsp; &nbsp; &nbsp; case 'Z'&nbsp; &nbsp; : return z.toString();<br />&nbsp; &nbsp; &nbsp; case 'ZS'&nbsp; &nbsp;: return zs;<br />&nbsp; &nbsp; &nbsp; case 'ZH'&nbsp; &nbsp;: return lpad(trunc(za/60),p2);<br />&nbsp; &nbsp; &nbsp; case 'ZM'&nbsp; &nbsp;: return lpad(za%60,p2);<br />&nbsp; &nbsp; &nbsp; case 'ISOTS'&nbsp; : return ''+lpad(y,p4)+lpad(m+1,p2)+lpad(d,p2)+'T'+lpad(h,p2)+lpad(n,p2)+lpad(s,p2)+pp+lpad(f,p3)+zs+lpad(trunc(za/60),p2)+lpad(za%60,p2);<br />&nbsp; &nbsp; &nbsp; case 'ISODT'&nbsp; : return ''+lpad(y,p4)+lpad(m+1,p2)+lpad(d,p2);<br />&nbsp; &nbsp; &nbsp; case 'ISOTM'&nbsp; : return ''+lpad(h,p2)+lpad(n,p2)+lpad(s,p2)+pp+lpad(f,p3);<br />&nbsp; &nbsp; &nbsp; case 'ISOTZ'&nbsp; : return ''+zs+lpad(trunc(za/60),p2)+lpad(za%60,p2);<br />&nbsp; &nbsp; &nbsp; case 'ISO-TS' : return ''+lpad(y,p4)+pd+lpad(m+1,p2)+pd+lpad(d,p2)+'T'+lpad(h,p2)+pc+lpad(n,p2)+pc+lpad(s,p2)+pp+lpad(f,p3)+zs+lpad(trunc(za/60),p2)+pc+lpad(za%60,p2);<br />&nbsp; &nbsp; &nbsp; case 'ISO-DT' : return ''+lpad(y,p4)+pd+lpad(m+1,p2)+pd+lpad(d,p2);<br />&nbsp; &nbsp; &nbsp; case 'ISO-TM' : return ''+lpad(h,p2)+pc+lpad(n,p2)+pc+lpad(s,p2)+pp+lpad(f,p3);<br />&nbsp; &nbsp; &nbsp; case 'ISO-TZ' : return ''+zs+lpad(trunc(za/60),p2)+pc+lpad(za%60,p2);<br />&nbsp; &nbsp; &nbsp; case 'WEEKDAY': return weekday&#91;w&#93;;<br />&nbsp; &nbsp; &nbsp; case 'WKD'&nbsp; &nbsp; : return wkd&#91;w&#93;;<br />&nbsp; &nbsp; &nbsp; case 'MONTH'&nbsp; : return month&#91;m&#93;;<br />&nbsp; &nbsp; &nbsp; case 'MTH'&nbsp; &nbsp; : return mth&#91;m&#93;;<br />&nbsp; &nbsp; &nbsp; case '{'&nbsp; &nbsp; &nbsp; : return $1;<br />&nbsp; &nbsp; &nbsp; default&nbsp; &nbsp; &nbsp; &nbsp;: return $0;<br />&nbsp; &nbsp; }<br />&nbsp; }<br /><br />&nbsp; function getWmiDt( prop ) {<br />&nbsp; &nbsp; if (_g.wmi===undefined) {<br />&nbsp; &nbsp; &nbsp; var svcLoc = new ActiveXObject(&quot;WbemScripting.SWbemLocator&quot;);<br />&nbsp; &nbsp; &nbsp; _g.wmi = svcLoc.ConnectServer(&quot;.&quot;, &quot;root\\cimv2&quot;);<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; if (_g.wmiFile===undefined) {<br />&nbsp; &nbsp; &nbsp; _g.wmiFile = new Enumerator(_g.wmi.ExecQuery(<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;Select * From &quot;+(_g.dirs?&quot;Win32_Directory&quot;:&quot;Cim_DataFile&quot;)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+&quot; Where Name = '&quot;+_g.file.Path.replace(/\\/g,&quot;\\\\&quot;).replace(/'/g,&quot;\\'&quot;)+&quot;'&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )).item();<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; var wmiDt;<br />&nbsp; &nbsp; switch (prop.toLowerCase()) {<br />&nbsp; &nbsp; &nbsp; case 'c': wmiDt=_g.wmiFile.CreationDate; break;<br />&nbsp; &nbsp; &nbsp; case 'm': wmiDt=_g.wmiFile.LastModified; break;<br />&nbsp; &nbsp; &nbsp; case 'a': wmiDt=_g.wmiFile.LastAccessed; break;<br />&nbsp; &nbsp; &nbsp; default: return undefined;<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; var tz=Number(wmiDt.substr(22));<br />&nbsp; &nbsp; var dt = new Date(&nbsp; &nbsp; &nbsp;wmiDt.substr(0,4)+ps+wmiDt.substr(4,2)+ps+wmiDt.substr(6,2)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+sp+wmiDt.substr(8,2)+pc+wmiDt.substr(10,2)+pc+wmiDt.substr(12,2)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+sp+wmiDt.substr(21,1)+lpad(trunc(tz/60),p2)+lpad(tz%60,p2)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;);<br />&nbsp; &nbsp; dt.setMilliseconds(Number(wmiDt.substr(15,3)));<br />&nbsp; &nbsp; return dt;<br />&nbsp; }<br /><br />}<br /><br />function attr(off) {<br />&nbsp; var a=_g.file.Attributes;<br />&nbsp; var o=off?off.substr(0,1):'';<br />&nbsp; return&nbsp; (a&amp;1&nbsp; &nbsp;?'R':o?o:'r')&nbsp; //Read only<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+(a&amp;2&nbsp; &nbsp;?'H':o?o:'h')&nbsp; //Hidden<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+(a&amp;4&nbsp; &nbsp;?'S':o?o:'s')&nbsp; //System<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+(a&amp;32&nbsp; ?'A':o?o:'a')&nbsp; //Archive<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+(a&amp;1024?'L':o?o:'l')&nbsp; //Link or Shortcut<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+(a&amp;2048?'C':o?o:'c'); //Compressed<br />}<br /><br />function size(pad) {return lpad(_g.file.Size,pad);}<br /><br />function type(pad) {return rpad(_g.file.Type,pad);}<br /><br />function path(pad) {return rpad(_g.file.Path,pad);}<br /><br />function parent(pad) {return rpad(_g.file.ParentFolder.Path,pad);}<br /><br />function name(pad) {return rpad(_g.file.Name,pad);}<br /><br />function sPath(pad) {return rpad(_g.file.ShortPath,pad);}<br /><br />function sParent(pad) {return rpad(_g.file.ParentFolder.ShortPath,pad);}<br /><br />function sName(pad) {return rpad(_g.file.ShortName,pad);}<br /></code></pre></div><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p44090" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile44090">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist2675.html?mode=viewprofile&amp;u=2988" style="color: #00AA00;" class="username-coloured">Squashman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1322.html?author_id=2988&amp;sr=posts">3970</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 Dec 2011 13:59</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content44090">

						<h3 ><a href="#p44090">Re: JREN.BAT - Rename files/folders using regular expression</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingfc0b.html?mode=quote&amp;f=3&amp;p=44090" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicc1e2.html?p=44090#p44090" onclick="prompt('Message #17',this.href); return false;">#17</a></span> 
									<a class="unread" href="viewtopicc1e2.html?p=44090#p44090" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist2675.html?mode=viewprofile&amp;u=2988" style="color: #00AA00;" class="username-coloured">Squashman</a></strong> &raquo; </span>24 Nov 2015 14:13
			</p>
			
			
			
			<div class="content">Dave, I have still yet to master even the basics of any of your regular expression utilities.  I use RegExp all the time in SAS yet find it difficult to understand how to use them in any of your hybrid jscript utilities. It should all carry over but I think it may just me not understanding the syntax of how to use your scripts.<br /><br />Was trying to figure out how to use JREN to solve this SO question today.   I gave up after an hour of banging my head against the wall.<br /><br /><!-- m --><a class="postlink" href="http://stackoverflow.com/questions/33901753/strip-file-name-of-non-alphanumeric-characters">http://stackoverflow.com/questions/3390 ... characters</a><!-- m --></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p44144" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile44144">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content44144">

						<h3 ><a href="#p44144">Re: JREN.BAT - Rename files/folders using regular expressions</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingfe6f.html?mode=quote&amp;f=3&amp;p=44144" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic76bd.html?p=44144#p44144" onclick="prompt('Message #18',this.href); return false;">#18</a></span> 
									<a class="unread" href="viewtopic76bd.html?p=44144#p44144" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>27 Nov 2015 20:10
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>StackOverflow Question wrote:</cite><br />How can I rename a file to a file name stripped of all other characters except letters and numbers?<br /><br />For example:<br /><br />&quot;It's_A Brand (New) #Year,,2016!.txt&quot; renamed to &quot;ItsABrandNewYear2016.txt&quot;<br /><br />Is it possible to do this with Windows batch?<br /></div></blockquote><br />@Squashman<br /><br />If you didn't have to worry about the extension dot, then it would be simple:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>jren &quot;&#91;^a-z0-9&#93;&quot; &quot;&quot; /i /fm &quot;It's_A Brand (New) #Year,,2016!.txt&quot;<br /></code></pre></div><br />Note that the File Mask (/FM) is totally independent of the find and replace.<br /><br />Here is an exact solution that uses the negative look ahead feature to preserve the extension dot:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>jren &quot;&#91;^a-z0-9.&#93;|\.(?!txt$)&quot; &quot;&quot; /i /fm &quot;It's_A Brand (New) #Year,,2016!.txt&quot;<br /></code></pre></div><br /><br />And here is a variant that removes all non-alphanumeric characters, except the extension dot, from all files in the current folder:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>jren &quot;&#91;^a-z0-9.&#93;|\.(?!&#91;^.&#93;+$)&quot; &quot;&quot; /i<br /></code></pre></div><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p45615" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile45615">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist1587.html?mode=viewprofile&amp;u=8148" class="username">MatthewGrantAU</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchd298.html?author_id=8148&amp;sr=posts">2</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 06 Mar 2016 22:58</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content45615">

						<h3 ><a href="#p45615">Re: JREN.BAT - Rename files/folders using regular expressions</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting7089.html?mode=quote&amp;f=3&amp;p=45615" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopice40d-2.html?p=45615#p45615" onclick="prompt('Message #19',this.href); return false;">#19</a></span> 
									<a class="unread" href="viewtopice40d-2.html?p=45615#p45615" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist1587.html?mode=viewprofile&amp;u=8148" class="username">MatthewGrantAU</a></strong> &raquo; </span>06 Mar 2016 23:24
			</p>
			
			
			
			<div class="content">Hi,<br /><br />I am trying to do a variant of this date parsing example that was posted above:<br /><br />&gt; old name: &quot;Some multiple word title Mon dd, yyyy - Some multiple word description.pdf&quot;<br />&gt; new name: &quot;yyyy-mm-dd - Some multiple word title - Some multiple word description.pdf&quot;<br />&gt; Code: <div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>C:\test&gt;jren &quot;^(.* )(&#91;A-Z&#93;&#91;a-z&#93;{2} \d\d?, \d\d\d\d) -&quot; &quot;ts({dt:$2,fmt:'{iso-dt}'})+' - '+$1+'-'&quot; /j /fm *.pdf</code></pre></div><br /><br />My filename is always: YYYY-MM-DD description of file.txt (eg. 2016-03-07 description of file.txt)<br />and I need: YYYYMMM description of file.txt (eg. 2016Mar description of file.txt)<br /><br />my code is: <div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>jren &quot;(\d{4}-\d{2}-\d{2})(.*\.txt)&quot; &quot;ts({dt:$1,fmt:'{YYYY}{MTH}'})+$2&quot; -t -j</code></pre></div>  (test mode)<br /><br />but I get: Replace Error: Invalid dt value<br /><br />It seems the dt:$1 is the problem, as it cannot determine the date format it is being passed.  I have tested with filenames using different date formatting (eg. ddd dd, yyyy) and it works ok. <br />How can I tell dt that the incoming string is YYYY-MM-DD, and not YYYY-DD-MM or something else?<br /><br />thanks,<br />Matt</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p45624" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile45624">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content45624">

						<h3 ><a href="#p45624">Re: JREN.BAT - Rename files/folders using regular expressions</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting499f.html?mode=quote&amp;f=3&amp;p=45624" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopica2dc.html?p=45624#p45624" onclick="prompt('Message #20',this.href); return false;">#20</a></span> 
									<a class="unread" href="viewtopica2dc.html?p=45624#p45624" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>07 Mar 2016 06:34
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>MatthewGrantAU wrote:</cite>How can I tell dt that the incoming string is YYYY-MM-DD, and not YYYY-DD-MM or something else?<br /></div></blockquote><br />You can't. JREN uses the JScript Date.parse() method to convert a string into a date. It is flexible, but non configurable. See <!-- m --><a class="postlink" href="http://technet.microsoft.com/en-us/library/k4w173wk(v=vs.84">http://technet.microsoft.com/en-us/libr ... wk(v=vs.84</a><!-- m -->).aspx for a description of the rules for what it will accept.<br /><br />But you already know the source date format, so you can easily parse it yourself.<br /><br />You can specify the date as an array of values, remembering to subtract 1 from the month to make it 0 based:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>jren &quot;^(\d{4})-(\d{2})-(\d{2})(?!\d)&quot; &quot;ts({ dt:&#91;$1,$2-1,$3&#93;, fmt:'{YYYY}{MTH}' })&quot; /t /j /fm *.txt<br /></code></pre></div><br />Or you can build your own string that ts() can recognize:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>jren &quot;^(\d{4})-(\d{2})-(\d{2})(?!\d)&quot; &quot;ts({ dt:$2+'/'+$3+'/'+$1, fmt:'{YYYY}{MTH}' })&quot; /t /j /fm *.txt<br /></code></pre></div><br />Note that in both cases:<ul><li> I use ^ to only match files that begin with the date.<br /></li><li> I use the (?!\d) look-ahead assertion to make sure that the next character after the date is not another digit, else we are probably not dealing with a date.<br /></li><li> Rather than matching the remainder of the file name and including it in the replacement string, I use the /FM file mask option to restrict the search to .txt files.</li></ul><br />Since we are only replacing the date portion of the name, you can add the uc() function to convert the month abbreviation into all caps, if wanted:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>jren &quot;^(\d{4})-(\d{2})-(\d{2})(?!\d)&quot; &quot;uc(ts({ dt:&#91;$1,$2-1,$3&#93;, fmt:'{YYYY}{MTH}' }))&quot; /t /j /fm *.txt<br /></code></pre></div><br /><br />Use JREN /? to get general help, and JREN /?TS() to get help on the ts() function.<br /><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p45635" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile45635">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist1587.html?mode=viewprofile&amp;u=8148" class="username">MatthewGrantAU</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchd298.html?author_id=8148&amp;sr=posts">2</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 06 Mar 2016 22:58</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content45635">

						<h3 ><a href="#p45635">Re: JREN.BAT - Rename files/folders using regular expressions</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting0d73.html?mode=quote&amp;f=3&amp;p=45635" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic3fa5.html?p=45635#p45635" onclick="prompt('Message #21',this.href); return false;">#21</a></span> 
									<a class="unread" href="viewtopic3fa5.html?p=45635#p45635" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist1587.html?mode=viewprofile&amp;u=8148" class="username">MatthewGrantAU</a></strong> &raquo; </span>07 Mar 2016 19:32
			</p>
			
			
			
			<div class="content">Hi Dave.<br /><br />thank you so much for the quick reply.<br /><br />While waiting, I have been reading and then re-reading &quot;jren /?ts()&quot; until I was cross-eyed<br />and in the last ten minutes finally discovered what Date.Parse() was looking for! ( and the fact that dt: could accept a string like $1+$2)<br /><br />so I built<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&quot;^(\d{4})-(\d\d)-(\d\d)&quot; &quot;ts({dt:$2+'-'+$3+'-'+$1,fmt:'{YYYY}{MTH}'})&quot;&nbsp; /j /fm *.txt<br /></code></pre></div><br />which worked!  <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /> <br /><br />I very much appreciate the suggestion of adding the (?!\d) for looking ahead.  The files come from a website, exported in the &quot;yyyy-mm-dd ...&quot; format, but will add that to my code to be thorough.<br />And the uc() is great!  (I wanted CAPS for mth, and had cheated by editing the code in jren.bat to JAN, FEB, ...)  I did not realise that I could make the uc() only affect the ts() function.<br /><br />THANKS!!<br /><br />regards,<br />Matt</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p47662" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile47662">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content47662">

						<h3 ><a href="#p47662">Re: JREN.BAT - Rename files/folders using regular expressions</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting9bd8.html?mode=quote&amp;f=3&amp;p=47662" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopice57b.html?p=47662#p47662" onclick="prompt('Message #22',this.href); return false;">#22</a></span> 
									<a class="unread" href="viewtopice57b.html?p=47662#p47662" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>09 Jul 2016 14:16
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>MatthewGrantAU wrote:</cite>(I wanted CAPS for mth, and had cheated by editing the code in jren.bat to JAN, FEB, ...)</div></blockquote><br />There should never be a need to edit the code to modify the names of the days or months. There are built in ts() options to specify whatever values you want for dayOfWeek/month names/abbreviations.<br /><br />From the ts() help:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&nbsp; The following options override the default English names for the months<br />&nbsp; and days of the week. The value for each option is a space delimited list<br />&nbsp; of names or abbreviations.<br /><br />&nbsp; &nbsp; wkd: Day of week abbreviations<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;default = 'Sun Mon Tue Wed Thu Fri Sat'<br /><br />&nbsp; &nbsp; weekday: Day of week names<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;default = 'Sunday Monday Tuesday Wednesday Thursday Friday'<br /><br />&nbsp; &nbsp; mth: Month abbreviations<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;default = 'Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec'<br /><br />&nbsp; &nbsp; month: Month names<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;default = 'January February March April May Jun July August'<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+ ' September October November December'<br /></code></pre></div><br />I opted to use the uc() function, but I could have just as easily redefined the month abbreviations using the mth option<br /><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p47681" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile47681">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content47681">

						<h3 ><a href="#p47681">Re: JREN.BAT - Rename files/folders using regular expressions</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting6603.html?mode=quote&amp;f=3&amp;p=47681" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicb50b.html?p=47681#p47681" onclick="prompt('Message #23',this.href); return false;">#23</a></span> 
									<a class="unread" href="viewtopicb50b.html?p=47681#p47681" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>10 Jul 2016 12:53
			</p>
			
			
			
			<div class="content">Here is version 2.6 of JREN.BAT<br /><br />I have fixed a bug in the ts() function dealing with date/time offsets. The offsets now specify precise time intervals that are not dependent on local daylight savings conditions - they are always relative to UTC time, which ignores daylight savings. <em class="text-italics">(Note - I had attempted to do this in release 2.5, but I screwed that up. So I deleted that post and jumped to version 2.6)</em><br /><br />I have also aded the <strong class="text-strong">olm:</strong> and <strong class="text-strong">old:</strong> ts() options that support local month and local day offsets in a way that the local hour never changes. These options do adjust for local daylight savings conditions, so the absolute offset may not be an even multiple of 24 hours. 1 hour less will be added if going from standard to daylight savings, and 1 hour more will be added if going form daylight savings to standard.<br /><br /><strong class="text-strong">JREN.BAT version 2.6</strong><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@if (@X)==(@Y) @end /* Harmless hybrid line that begins a JScript comment<br />@goto :Batch<br /><br />::JREN.BAT version 2.6 by Dave Benham<br />::<br />::&nbsp; Release History:<br />::&nbsp; &nbsp; 2.6&nbsp; 2016-07-10: Fixed bug in ts() offset computations when the before and<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;after have different timezones due to daylight savings.<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Added olm: and old: options to the ts() function to allow<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the addition of months/years without changing the local hour.<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;In other words, the computation compensates for changes in<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dayling savings conditions.<br />::&nbsp; &nbsp; 2.4&nbsp; 2015-07-15: Added /?? and /??TS() paged help options<br />::&nbsp; &nbsp; 2.3&nbsp; 2015-03-03: Ignore invalid characters if /LIST mode<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Bug fix - abort if invalid character with /T mode<br />::&nbsp; &nbsp; 2.2&nbsp; 2014-12-10: Bug fix - forgot to make the search regex global<br />::&nbsp; &nbsp; 2.1&nbsp; 2014-12-10: Additional dt: options for FileSystemObject timestamps<br />::&nbsp; &nbsp; 2.0&nbsp; 2014-12-07: New /LIST option.<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Added ts() function and /?ts() documentation<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Many new JScript functions for use with /J with /LIST<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Added GOTO at top to improve startup performance<br />::&nbsp; &nbsp; 1.1&nbsp; 2014-12-02: Options may be prefaced with / or -<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Corrected some documentation<br />::&nbsp; &nbsp; 1.0&nbsp; 2014-11-30: Initial release<br />::<br />::============ Documentation ===========<br />:::<br />:::JREN&nbsp; Search&nbsp; Replace&nbsp; &#91;/Option&nbsp; &#91;Value&#93;&#93;...<br />:::JREN&nbsp; /?&#91;REGEX|REPLACE|VERSION|TS()&#93;<br />:::JREN&nbsp; /??&#91;ts()&#93;<br />:::<br />:::&nbsp; Rename files in the current directory by performing a regular expression<br />:::&nbsp; search/replace on the old file name to generate the new file name.<br />:::&nbsp; This includes read only, hidden, and system files.<br />:::<br />:::&nbsp; Search&nbsp; - By default, this is a case sensitive JScript (ECMA) regular<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; expression expressed as a string. The search is applied globally<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; to the entire file name.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; JScript regex syntax documentation is available at<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; http://msdn.microsoft.com/en-us/library/ae5bf541(v=vs.80).aspx<br />:::<br />:::&nbsp; Replace - By default, this is the string to be used as a replacement for<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; each found search expression. Full support is provided for<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; substituion patterns available to the JScript replace method.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; For example, $&amp; represents the portion of the source that matched<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the entire search pattern, $1 represents the first captured<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; submatch, $2 the second captured submatch, etc. A $ literal<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; can be escaped as $$.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; An empty replacement string must be represented as &quot;&quot;.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Replace substitution pattern syntax is fully documented at<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; http://msdn.microsoft.com/en-US/library/efy6s3e6(v=vs.80).aspx<br />:::<br />:::&nbsp; Options:&nbsp; Behavior may be altered by appending one or more options.<br />:::&nbsp; The option names are case insensitive, and may appear in any order<br />:::&nbsp; after the Replace argument. Options may be prefaced with / or -<br />:::<br />:::&nbsp; &nbsp; &nbsp; /D&nbsp; - Rename Directories instead of files.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /FM FileOrFolderMask<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Only rename files or folders that match any of the pattern(s)<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using standard wildcards. Multiple patterns are delimited by a<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pipe (|). Only complete name matches count.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * matches any 0 or more characters<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ? matches any 0 or 1 character except .<br />:::<br />:::&nbsp; &nbsp; &nbsp; /FX FileOrFolderExclusion<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exclude files or folders that match any of the pattern(s)<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using standard wildcards. Multiple patterns are delimited by a<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pipe (|). Only complete name matches count.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * matches any 0 or more characters<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ? matches any 0 or 1 character except .<br />:::<br />:::&nbsp; &nbsp; &nbsp; /I&nbsp; - Ignore case when matching.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /J&nbsp; - Treat Replace as a JScript expression.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The following variables contain details about each match:<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $0 = the substring that matched the Search<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $1 through $n = captured submatch strings<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $off = the offset where the match occurred<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $src = the original source string<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The following are also available:<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $n = An incrementing number for use in the name. The value<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;is reset to the /NBEG value for each directory.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;It increases by the /NINC value for each renamed file.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;The value may be zero padded to the width specified by<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the /NPAD value.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lc(str)<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Convert str to lower case. Shorthand for str.toLowerCase().<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uc(str)<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Convert str to upper case. Shorthand for str.toUpperCase().<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lpad(string,pad)<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Used to left pad string str to a minimum length. If the<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;str already has length &gt;= the pad string length, then no<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;change is made. Otherwise it left pads the value with the<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;characters of the pad string to the length of pad.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Examples:<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lpad(15,'0000')&nbsp; &nbsp; returns &quot;0015&quot;<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lpad(15,'&nbsp; &nbsp; ')&nbsp; &nbsp; returns &quot;&nbsp; 15&quot;<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lpad(19011,'0000') returns &quot;19011&quot;<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; rpad(string,pad)<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Used to right pad the string to a minimum length. If the<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;str already has length &gt;= the pad string length, then no<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;change is made. Otherwise it right pads the value with the<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;characters of the pad string to the length of pad.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ts( {option:value, option:value...} )<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Perform date/time computations and produce formatted<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;timestamps. This function can get the current date/and time,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;or get the created/lastModified/lastAccessed timestamps for<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the file being renamed, or parse a date/time from the name<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;of the file, or use a user specified value.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Use JREN /?TS() to get help on the ts() function<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; attr( &#91;offChar&#93; )<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Lists the attributes of the file/folder. Set attributes are<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;listed in upper case and unset attributes are shown as the<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;offChar, or lower case. The listed attributes are:<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;R - Read Only<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;H - Hidden<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;S - System<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;A - Archive<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;L - Link or Shortcut<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;C - Compressed<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; size( &#91;pad&#93; )<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;File/folder size, optionally left padded to the length of<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the pad string.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; type( &#91;pad&#93; )<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;File/folder type, optionally right padded to the length of<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the pad string.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; name( &#91;pad&#93; )<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Name of the file/folder, optionally right padded to<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the length of the pad string.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; path( &#91;pad&#93; )<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Full Path of file/folder, optionally right padded to<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the length of the pad string.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; parent( &#91;pad&#93; )<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Path of the parent folder, optionally right padded to<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the length of the pad string.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sName( &#91;pad &#93;)<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Short (8.3) name of the file/folder, optionally right padded<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;to the length of the pad string.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sPath( &#91;pad&#93; )<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Path of the file/folder using short (8.3) names, optionally<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;right padded to the length of the pad string.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sParent( &#91;pad&#93; )<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Path of the parent folder using short (8.3) names,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;optionally right padded to the length of the pad string.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /L&nbsp; - Convert names to Lower case. Entire names can be converted to<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lower case without any other changes by using empty strings (&quot;&quot;)<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for both Search and Replace.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /LIST - List the Rename results only, without quotes, and without<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; renaming anything. Invalid file name characters are ignored.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The resulting &quot;name&quot; is always listed, even if no change.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /NBEG BeginValue<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Specifies the initial $n value for each directory. The value<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; must be an integer &gt;= 0. The default value is 1.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /NINC IncrementValue<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Specifies the amount $n is incremented after each rename.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The value must be an integer &gt;=1. The default value is 1.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /NPAD MinWidth<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Specifies the minimum width for each $n value. If the $n value<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; has fewer digits than MinWidth, then the value is zero padded<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; on the left to achieve the MinWidth. The value must be &gt;= 1.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The default value is 3.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /P RootPath<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Specifies the path where the rename is to take place.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The default of . represents the current directory.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Wildcards are not allowed.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /PM PathMask<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Only rename files or folders whose parent folder path matches<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; any of the PathMask pattern(s) using augmented wildcards.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Multiple patterns are delimited by a pipe (|). Only full path<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; matches count.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /P:&nbsp; matches the root path specified by option /P<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; **&nbsp; &nbsp;matches any 0 or more characters<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *&nbsp; &nbsp; matches any 0 or more characters except \<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ?&nbsp; &nbsp; matches any 0 or 1 character except . or \<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This option is only useful if the /S option is used.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /PX PathExclusion<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exclude files or folders whose parent folder path matches any<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; of the PathExclusion pattern(s) using augmented wildcards.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Multiple patterns are delimited by a pipe (|). Only full path<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; matches count.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /P:&nbsp; matches the root path specified by option /P<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; **&nbsp; &nbsp;matches any 0 or more characters<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *&nbsp; &nbsp; matches any 0 or more characters except \<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ?&nbsp; &nbsp; matches any 0 or 1 character except . or \<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This option is only useful if the /S option is used.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /Q&nbsp; - Do not list the renamed files/folders (Quiet mode).<br />:::<br />:::&nbsp; &nbsp; &nbsp; /RFM RegexFileOrFoldereMask<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Only rename files or folders that match the regular expression,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ignoring case. Partial name matches count.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /RFX RegexFileOrFolderExclusion<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exclude files or folders that match the regular Expression,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ignoring case. Partial name matches count.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /RPM RegexPathMask<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Only rename files or folders whose parent folder path matches the<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RegexPathMask regular expression, ignoring case. Partial path<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; matches count. This option is really only useful if the /S<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; option is used.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /RPX RegexPathExclusion<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exclude files or folders whose parent folder path matches the<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RegexPathExclusion regular expression, ignoring case. Partial<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; path matches count. This option is really only useful if the<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /S option is used.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /S&nbsp; - Recurse Subdirectories.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /T&nbsp; - List the rename operations that would be attempted,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; but do not rename anything. (Test mode)<br />:::<br />:::&nbsp; &nbsp; &nbsp; /U&nbsp; - Convert names to Upper case. Entire names can be converted to<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; upper case without any other changes by using empty strings (&quot;&quot;)<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for both Search and Replace.<br />:::<br />:::&nbsp; Help is available by supplying a single argument beginning with /?:<br />:::<br />:::&nbsp; &nbsp; &nbsp; /?&nbsp; &nbsp; &nbsp; &nbsp; - Writes this help documentation to stdout.<br />:::&nbsp; &nbsp; &nbsp; /??&nbsp; &nbsp; &nbsp; &nbsp;- Same as /? except uses MORE to provide pagination<br />:::<br />:::&nbsp; &nbsp; &nbsp; /?REGEX&nbsp; &nbsp;- Opens up Microsoft's JScript regular expression<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; documentation within your browser.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /?REPLACE - Opens up Microsoft's JScript REPLACE documentation<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; within your browser.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /?VERSION - Writes the JREN version number to stdout.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /?TS()&nbsp; &nbsp; - Writes documentation for the ts() function to stdout.<br />:::&nbsp; &nbsp; &nbsp; /??TS()&nbsp; &nbsp;- Same as /??TS() except uses MORE for pagination.<br />:::<br />:::&nbsp; JREN.BAT was written by Dave Benham, and originally posted at<br />:::&nbsp; http://www.dostips.com/forum/viewtopic.php?f=3&amp;t=6081<br />:::<br />:: =============== ts() documentation ===============<br />::+<br />::+ts( &#91; { &#91;option:value &#91;,option:value&#93;...&#93; } &#93; )<br />::+&nbsp; <br />::+&nbsp; A JScript function that can performs date and time computations and return<br />::+&nbsp; a formatted time string.<br />::+&nbsp; <br />::+&nbsp; The option object argument within curly braces is optional - if no argument<br />::+&nbsp; is given, then it returns the current timestamp using compressed ISO 8601<br />::+&nbsp; format with milliseconds and local time zone - YYYYMMDDThhmmss.fff+zzzz<br />::+&nbsp; <br />::+&nbsp; &nbsp; Examples:<br />::+&nbsp; &nbsp; &nbsp; ts()&nbsp; - Current date/time:&nbsp; YYYYMMDDThhmmss.fff+zzzz<br />::+&nbsp; &nbsp; &nbsp; ts({dt:'created',fmt:'{iso-dt}'})&nbsp; - The file create date:&nbsp; YYYY-MM-DD<br />::+&nbsp; &nbsp; &nbsp; ts({od:-1,fmt:'{YYYY}_{MM}_{DD}'}) - Yesterday's date:&nbsp; YYYY_MM_DD<br />::+&nbsp; <br />::+&nbsp; Option names are case sensitive. There are 5 types of options:<br />::+&nbsp; &nbsp; 1) Specify the base date&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - dt:<br />::+&nbsp; &nbsp; 2) Specify date/time offsets&nbsp; &nbsp; &nbsp; - oy: om: od: oh: on: os: of:<br />::+&nbsp; &nbsp; 3) Specify the output time zone&nbsp; &nbsp;- tz:<br />::+&nbsp; &nbsp; 4) Specify the output format&nbsp; &nbsp; &nbsp; - fmt:<br />::+&nbsp; &nbsp; 5) Configure the day-of-week and&nbsp; - wkd: weekday: mth: month:<br />::+&nbsp; &nbsp; &nbsp; &nbsp;month names for non-English<br />::+&nbsp; &nbsp; &nbsp; &nbsp;users<br />::+<br />::+&nbsp; Specify the base date and time<br />::+<br />::+&nbsp; &nbsp; dt:&nbsp; Value specifies the base date and time. Many formats supported:<br />::+<br />::+&nbsp; &nbsp; &nbsp; Current local date/time<br />::+&nbsp; &nbsp; &nbsp; &nbsp; - do not specify a dt: value<br />::+&nbsp; &nbsp; &nbsp; &nbsp; - undefined value<br />::+&nbsp; &nbsp; &nbsp; &nbsp; - empty string ''<br />::+<br />::+&nbsp; &nbsp; &nbsp; &nbsp; Examples:<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:''<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:undefined<br />::+<br />::+&nbsp; &nbsp; &nbsp; Milliseconds since 1970-01-01 00:00:00 UTC<br />::+&nbsp; &nbsp; &nbsp; &nbsp; - NumericExpression (math OK)<br />::+&nbsp; &nbsp; &nbsp; &nbsp; - NumericString (no math)<br />::+<br />::+&nbsp; &nbsp; &nbsp; &nbsp; Examples:<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt: 1391230800000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = January 1, 19970 00:00:00 UTC<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt: 1391230000000+800000&nbsp; &nbsp;= January 1, 19970 00:00:00 UTC<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:'1391230800000'&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= January 1, 19970 00:00:00 UTC<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:'1391230000000+800000'&nbsp; = error<br />::+<br />::+&nbsp; &nbsp; &nbsp; String timestamp representation<br />::+&nbsp; &nbsp; &nbsp; &nbsp; - Any string accepted by the JScript Date.Parse() method.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; See http://msdn.microsoft.com/en-us/library/k4w173wk(v=vs.84).aspx<br />::+<br />::+&nbsp; &nbsp; &nbsp; &nbsp; Examples: All of the following represent Midnight on January 4, 2013<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; assuming local time zone is U.S Eastern Standard Time (EST)<br />::+<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:'1-4-2013'&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Defaults to local time zone<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:'January 4, 2013 EST'&nbsp; &nbsp; &nbsp; &nbsp;Explicit Eastern Std Time (US)<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:'2013/1/4 -05'&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Explicit Eastern Std Time (US)<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:'Jan 3 2013 23: CST'&nbsp; &nbsp; &nbsp; &nbsp; Central Standard Time (US)<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:'2013 3 Jan 9:00 pm -0800'&nbsp; Pacific Standard Time (US)<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:'01/04/2013 05:00:00 UTC'&nbsp; &nbsp;Universal Coordinated Time<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:'1/4/2013 05:30 +0530'&nbsp; &nbsp; &nbsp; India Standard Time<br />::+<br />::+&nbsp; &nbsp; &nbsp; File timestamps to millisecond accuracy using WMI. Very slow, but<br />::+&nbsp; &nbsp; &nbsp; locale agnostic. WMI call may not work on some older machines.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; - 'created'&nbsp; &nbsp;= Creation date/time of the file<br />::+&nbsp; &nbsp; &nbsp; &nbsp; - 'modified'&nbsp; = Last Modified date/time of the file<br />::+&nbsp; &nbsp; &nbsp; &nbsp; - 'accessed'&nbsp; = Last Accessed date/time of the file<br />::+<br />::+&nbsp; &nbsp; &nbsp; &nbsp; Example:<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:'created'&nbsp; = creation date/time of the file to be renamed<br />::+<br />::+&nbsp; &nbsp; &nbsp; File timestamps to second accuracy using FileSystemObject. Very fast,<br />::+&nbsp; &nbsp; &nbsp; but locale dependent. May not parse properly for some countries.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; - 'fsoCreated'&nbsp; = Creation date/time of the file<br />::+&nbsp; &nbsp; &nbsp; &nbsp; - 'fsoModified' = Last Modified date/time of the file<br />::+&nbsp; &nbsp; &nbsp; &nbsp; - 'fsoAccessed' = Last Accessed date/time of the file<br />::+<br />::+&nbsp; &nbsp; &nbsp; Array with 2 to 7 numeric expressions (local time only)<br />::+&nbsp; &nbsp; &nbsp; &nbsp; - &#91;year,months,days,hours,minutes,seconds,milliseconds&#93;<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; year and months are required, the rest are optional<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Missing values are assumed to be 0<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Missing values are not allowed between specified values<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; month 0 = January<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; day 1 = First day of month, day 0 = Last day of prior month<br />::+<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Examples:<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:&#91;2014,3,1,17,30,22,457&#93;&nbsp; = April 1, 2014, 17:30:22.457<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:&#91;2014,0,1&#93;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= January 1, 2014, 00:00:00<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:&#91;2014,0&#93;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= December 31, 2013, 00:00:00<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:&#91;2014,,10&#93;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= error<br />::+<br />::+&nbsp; Date/Time offsets and time zone options all use the same syntax.<br />::+&nbsp; The value represents a numeric offset for the specified time unit.<br />::+&nbsp; It may be expressed as a numeric expression (math allowed), or<br />::+&nbsp; a numeric string (no math allowed). Both positive and negative<br />::+&nbsp; values may be used.<br />::+<br />::+&nbsp; &nbsp; oy:&nbsp; Year offset<br />::+&nbsp; &nbsp; om:&nbsp; Months offset<br />::+&nbsp; &nbsp; od:&nbsp; Days offset<br />::+&nbsp; &nbsp; oh:&nbsp; Hours offset<br />::+&nbsp; &nbsp; on:&nbsp; Minutes offset<br />::+&nbsp; &nbsp; os:&nbsp; Seconds offset<br />::+&nbsp; &nbsp; of:&nbsp; Milliseconds (Fractional seconds) offset<br />::+<br />::+&nbsp; &nbsp; olm: LocalMonths offset (adjusted for changes in daylight savings)<br />::+&nbsp; &nbsp; old: LocalDays offset (adjusted for changes in daylight savings)<br />::+<br />::+&nbsp; &nbsp; tz:&nbsp; Time zone used for output = minutes offset from UTC<br />::+<br />::+&nbsp; The fmt: option is a string that specifies the format of the output.<br />::+&nbsp; Strings within curly braces are replaced by dynamic components that are<br />::+&nbsp; derived from the computed time stamp. Strings within braces that do not<br />::+&nbsp; match a fmt: component are left as is. Strings not in braces are left<br />::+&nbsp; as is. The format component names are not case senstive.<br />::+<br />::+&nbsp; For example, a U.S. date would be represented as fmt:'{yyyy}/{mm}/{dd}'<br />::+<br />::+&nbsp; The default format is '{ISOTS}', which yields YYYYMMDDThhmmss.fff+hhmm<br />::+<br />::+&nbsp; &nbsp; {YYYY}&nbsp; 4 digit year, zero padded<br />::+<br />::+&nbsp; &nbsp; {YY}&nbsp; &nbsp; 2 digit year, zero padded<br />::+<br />::+&nbsp; &nbsp; {Y}&nbsp; &nbsp; &nbsp;year without zero padding<br />::+<br />::+&nbsp; &nbsp; {MONTH} month name<br />::+<br />::+&nbsp; &nbsp; {MTH}&nbsp; &nbsp;month abbreviation<br />::+<br />::+&nbsp; &nbsp; {MM}&nbsp; &nbsp; 2 digit month, zero padded<br />::+<br />::+&nbsp; &nbsp; {M}&nbsp; &nbsp; &nbsp;month without zero padding<br />::+<br />::+&nbsp; &nbsp; {WEEKDAY} day of week name<br />::+<br />::+&nbsp; &nbsp; {WKD}&nbsp; &nbsp;day of week abbreviation<br />::+<br />::+&nbsp; &nbsp; {W}&nbsp; &nbsp; &nbsp;day of week number, 0=Sunday<br />::+<br />::+&nbsp; &nbsp; {DD}&nbsp; &nbsp; 2 digit day, zero padded<br />::+<br />::+&nbsp; &nbsp; {D}&nbsp; &nbsp; &nbsp;day without zero padding<br />::+<br />::+&nbsp; &nbsp; {HH}&nbsp; &nbsp; 2 digit hours, 24 hour format, zero padded<br />::+<br />::+&nbsp; &nbsp; {H}&nbsp; &nbsp; &nbsp;hours, 24 hour format without zero padding<br />::+<br />::+&nbsp; &nbsp; {HH12}&nbsp; 2 digit hours, 12 hour format, zero padded<br />::+<br />::+&nbsp; &nbsp; {H12}&nbsp; &nbsp;hours, 12 hour format without zero padding<br />::+<br />::+&nbsp; &nbsp; {NN}&nbsp; &nbsp; 2 digit minutes, zero padded<br />::+<br />::+&nbsp; &nbsp; {N}&nbsp; &nbsp; &nbsp;minutes without padding<br />::+<br />::+&nbsp; &nbsp; {SS}&nbsp; &nbsp; 2 digit seconds, zero padded<br />::+<br />::+&nbsp; &nbsp; {S}&nbsp; &nbsp; &nbsp;seconds without padding<br />::+<br />::+&nbsp; &nbsp; {FFF}&nbsp; &nbsp;3 digit milliseconds, zero padded<br />::+<br />::+&nbsp; &nbsp; {F}&nbsp; &nbsp; &nbsp;milliseconds without padding<br />::+<br />::+&nbsp; &nbsp; {AM}&nbsp; &nbsp; AM or PM in upper case<br />::+<br />::+&nbsp; &nbsp; {PM}&nbsp; &nbsp; am or pm in lower case<br />::+<br />::+&nbsp; &nbsp; {ZZZZ}&nbsp; timezone expressed as minutes offset from UTC,<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; zero padded to 3 digits with sign<br />::+<br />::+&nbsp; &nbsp; {Z}&nbsp; &nbsp; &nbsp;timzone minutes offset from UTC without padding<br />::+<br />::+&nbsp; &nbsp; {ZS}&nbsp; &nbsp; timezone sign<br />::+<br />::+&nbsp; &nbsp; {ZH}&nbsp; &nbsp; timezone hours hours offset from UTC, (no sign),<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; padded to 2 digits<br />::+<br />::+&nbsp; &nbsp; {ZM}&nbsp; &nbsp; timezone minutes offset from UTC (no sign),<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; padded to 2 digits<br />::+<br />::+&nbsp; &nbsp; {ISOTS} YYYYMMDDThhmmss.fff+hhss<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Compressed ISO 8601 date/time (timestamp) with milliseconds<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; and time zone<br />::+<br />::+&nbsp; &nbsp; {ISODT} YYYYMMDD<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Compressed ISO 8601 date format<br />::+<br />::+&nbsp; &nbsp; {ISOTM} hhmmss.fff<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Compressed ISO 8601 time format with milliseconds<br />::+<br />::+&nbsp; &nbsp; {ISOTZ} +hhmm<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Compressed ISO 8601 timezone format<br />::+<br />::+&nbsp; &nbsp; {ISO-TS} YYYY-MM-DDThh:mm:ss.fff+hh:ss<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ISO 8601 date/time (timestamp) with milliseconds and time zone<br />::+<br />::+&nbsp; &nbsp; {ISO-DT} YYYY-MM-DD<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ISO 8601 date format<br />::+<br />::+&nbsp; &nbsp; {ISO-TM} hh:mm:ss.fff<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ISO 8601 time format with milliseconds<br />::+<br />::+&nbsp; &nbsp; {ISO-TZ} +hh:mm<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ISO 8601 timezone<br />::+<br />::+&nbsp; &nbsp; {U}&nbsp; &nbsp; &nbsp;Unix Epoch time: same as {US}<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Seconds since 1970-01-01 00:00:00 UTC.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Negative numbers represent dates prior to 1970-01-01.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This value should not be used with the -TZ option<br />::+<br />::+&nbsp; &nbsp; {UMS}&nbsp; &nbsp;Milliseconds since 1970-01-01 00:00:00.000 UTC.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Negative numbers represent days prior to 1970-01-01.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This value should not be used with the -TZ option<br />::+<br />::+&nbsp; &nbsp; {US}&nbsp; &nbsp; Seconds since 1970-01-01 00:00:00.000 UTC.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Negative numbers represent days prior to 1970-01-01.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This value should not be used with the -TZ option<br />::+<br />::+&nbsp; &nbsp; {UM}&nbsp; &nbsp; Minutes since 1970-01-01 00:00:00.000 UTC.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Negative numbers represent days prior to 1970-01-01.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This value should not be used with the -TZ option<br />::+<br />::+&nbsp; &nbsp; {UH}&nbsp; &nbsp; Hours since 1970-01-01 00:00:00.000 UTC.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Negative numbers represent days prior to 1970-01-01.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This value should not be used with the -TZ option<br />::+<br />::+&nbsp; &nbsp; {UD}&nbsp; &nbsp; Days since 1970-01-01 00:00:00.000 UTC.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Negative numbers represent days prior to 1970-01-01.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This value should not be used with the -TZ option<br />::+<br />::+&nbsp; &nbsp; {USD}&nbsp; &nbsp;Decimal seconds since 1970-01-01 00:00:00.000 UTC.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Negative numbers represent days prior to 1970-01-01.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This value should not be used with the -TZ option<br />::+<br />::+&nbsp; &nbsp; {UMD}&nbsp; &nbsp;Decimal minutes since 1970-01-01 00:00:00.000 UTC.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Negative numbers represent days prior to 1970-01-01.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This value should not be used with the -TZ option<br />::+<br />::+&nbsp; &nbsp; {UHD}&nbsp; &nbsp;Decimal hours since 1970-01-01 00:00:00.000 UTC.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Negative numbers represent days prior to 1970-01-01.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This value should not be used with the -TZ option<br />::+<br />::+&nbsp; &nbsp; {UDD}&nbsp; &nbsp;Decimal days since 1970-01-01 00:00:00.000 UTC.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Negative numbers represent days prior to 1970-01-01.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This value should not be used with the -TZ option<br />::+<br />::+&nbsp; &nbsp; {{}&nbsp; &nbsp; &nbsp;A { character<br />::+<br />::+&nbsp; The following options override the default English names for the months<br />::+&nbsp; and days of the week. The value for each option is a space delimited list<br />::+&nbsp; of names or abbreviations.<br />::+<br />::+&nbsp; &nbsp; wkd: Day of week abbreviations<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;default = 'Sun Mon Tue Wed Thu Fri Sat'<br />::+<br />::+&nbsp; &nbsp; weekday: Day of week names<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;default = 'Sunday Monday Tuesday Wednesday Thursday Friday'<br />::+<br />::+&nbsp; &nbsp; mth: Month abbreviations<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;default = 'Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec'<br />::+<br />::+&nbsp; &nbsp; month: Month names<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;default = 'January February March April May Jun July August'<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+ ' September October November December'<br />::+<br />============= :Batch portion ============<br />@echo off<br />setlocal disableDelayedExpansion<br /><br />if .%2 equ . (<br />&nbsp; set &quot;test=%~1&quot;<br />&nbsp; setlocal enableDelayedExpansion<br />&nbsp; if &quot;!test:~0,1!&quot; equ &quot;-&quot; set &quot;test=/!test:~1!&quot;<br />&nbsp; if &quot;!test!&quot; equ &quot;/?&quot; (<br />&nbsp; &nbsp; for /f &quot;tokens=* delims=:&quot; %%A in ('findstr &quot;^:::&quot; &quot;%~f0&quot;') do @echo(%%A<br />&nbsp; &nbsp; exit /b 0<br />&nbsp; ) else if &quot;!test!&quot; equ &quot;/??&quot; 2&gt;nul (<br />&nbsp; &nbsp; (for /f &quot;tokens=* delims=:&quot; %%A in ('findstr &quot;^:::&quot; &quot;%~f0&quot;') do @echo(%%A)|more /e<br />&nbsp; &nbsp; exit /b 0<br />&nbsp; ) else if /i &quot;!test!&quot; equ &quot;/?ts()&quot; (<br />&nbsp; &nbsp; for /f &quot;tokens=* delims=:+&quot; %%A in ('findstr &quot;^::+&quot; &quot;%~f0&quot;') do @echo(%%A<br />&nbsp; &nbsp; exit /b 0<br />&nbsp; ) else if /i &quot;!test!&quot; equ &quot;/??ts()&quot; 2&gt;nul (<br />&nbsp; &nbsp; (for /f &quot;tokens=* delims=:+&quot; %%A in ('findstr &quot;^::+&quot; &quot;%~f0&quot;') do @echo(%%A)|more /e<br />&nbsp; &nbsp; exit /b 0<br />&nbsp; ) else if /i &quot;!test!&quot; equ &quot;/?regex&quot; (<br />&nbsp; &nbsp; explorer &quot;http://msdn.microsoft.com/en-us/library/ae5bf541(v=vs.80).aspx&quot;<br />&nbsp; &nbsp; exit /b 0<br />&nbsp; ) else if /i &quot;!test!&quot; equ &quot;/?replace&quot; (<br />&nbsp; &nbsp; explorer &quot;http://msdn.microsoft.com/en-US/library/efy6s3e6(v=vs.80).aspx&quot;<br />&nbsp; &nbsp; exit /b 0<br />&nbsp; ) else if /i &quot;!test!&quot; equ &quot;/?version&quot; (<br />&nbsp; &nbsp; for /f &quot;tokens=* delims=:&quot; %%A in ('findstr &quot;^::JREN\.BAT&quot; &quot;%~f0&quot;') do @echo(%%A<br />&nbsp; &nbsp; exit /b 0<br />&nbsp; ) else (<br />&nbsp; &nbsp; call :err &quot;Insufficient arguments&quot;<br />&nbsp; &nbsp; exit /b 2<br />&nbsp; )<br />)<br /><br />:: Define options<br />set &quot;options= /D: /FM:&quot;&quot; /FX:&quot;&quot; /I: /J: /L: /LIST: /NBEG:1 /NINC:1 /NPAD:3 /P:. /PM:&quot;&quot; /PX:&quot;&quot; /RFM:&quot;&quot; /RFX:&quot;&quot; /RPM:&quot;&quot; /RPX:&quot;&quot; /Q: /S: /T: /U: &quot;<br /><br />:: Set default option values<br />for %%O in (%options%) do for /f &quot;tokens=1,* delims=:&quot; %%A in (&quot;%%O&quot;) do set &quot;%%A=%%~B&quot;<br /><br />:: Get options<br />:loop<br />if not &quot;%~3&quot;==&quot;&quot; (<br />&nbsp; set &quot;test=%~3&quot;<br />&nbsp; setlocal enableDelayedExpansion<br />&nbsp; if &quot;!test:~0,1!&quot; equ &quot;-&quot; set &quot;test=/!test:~1!&quot;<br />&nbsp; if &quot;!test:~0,1!&quot; neq &quot;/&quot; (<br />&nbsp; &nbsp; call :err &quot;Too many arguments&quot;<br />&nbsp; &nbsp; exit /b 2<br />&nbsp; )<br />&nbsp; for /f &quot;delims=&quot; %%A in (&quot;!test!&quot;) do (<br />&nbsp; &nbsp; set &quot;test=!options:*%%A:=! &quot;<br />&nbsp; &nbsp; if &quot;!test!&quot;==&quot;!options! &quot; (<br />&nbsp; &nbsp; &nbsp; &nbsp; endlocal<br />&nbsp; &nbsp; &nbsp; &nbsp; call :err &quot;Invalid option %~3&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; exit /b 2<br />&nbsp; &nbsp; ) else if &quot;!test:~0,1!&quot;==&quot; &quot; (<br />&nbsp; &nbsp; &nbsp; &nbsp; endlocal<br />&nbsp; &nbsp; &nbsp; &nbsp; set &quot;%%A=1&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; if /i &quot;%%A&quot; equ &quot;/L&quot; set &quot;/U=&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; if /i &quot;%%A&quot; equ &quot;/U&quot; set &quot;/L=&quot;<br />&nbsp; &nbsp; ) else (<br />&nbsp; &nbsp; &nbsp; &nbsp; endlocal<br />&nbsp; &nbsp; &nbsp; &nbsp; if %4. equ . (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call :err &quot;Missing %~3 value&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit /b 2<br />&nbsp; &nbsp; &nbsp; &nbsp; )<br />&nbsp; &nbsp; &nbsp; &nbsp; set &quot;%%A=%~4&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; shift /3<br />&nbsp; &nbsp; )<br />&nbsp; )<br />&nbsp; shift /3<br />&nbsp; goto :loop<br />)<br /><br />:: Execute<br />cscript //E:JScript //nologo &quot;%~f0&quot; %1 %2<br />exit /b %errorlevel%<br /><br />:err<br />&gt;&amp;2 (<br />&nbsp; echo ERROR: %~1<br />)<br />exit /b<br /><br />************* JScript portion **********/<br />var $n<br />var _g=new Object();<br />try {<br /><br />&nbsp; _g.defineReplFunc=function() {<br />&nbsp; &nbsp; eval(_g.replFunc);<br />&nbsp; }<br /><br />&nbsp; _g.main=function() {<br /><br />&nbsp; &nbsp; function err( msg, rtn ) {<br />&nbsp; &nbsp; &nbsp; WScript.StdErr.WriteLine(msg);<br />&nbsp; &nbsp; &nbsp; if (rtn) WScript.Quit(rtn);<br />&nbsp; &nbsp; }<br /><br />&nbsp; &nbsp; function BuildRegex( loc, regex, options ) {<br />&nbsp; &nbsp; &nbsp; try {<br />&nbsp; &nbsp; &nbsp; &nbsp; return regex ? new RegExp( regex, options ) : false;<br />&nbsp; &nbsp; &nbsp; } catch(e) {<br />&nbsp; &nbsp; &nbsp; &nbsp; err( 'Invalid '+loc+' regular expression: '+e.message, 1);<br />&nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; }<br /><br />&nbsp; &nbsp; function GetInt( loc, numStr, minVal ) {<br />&nbsp; &nbsp; &nbsp; var n = parseInt( numStr );<br />&nbsp; &nbsp; &nbsp; if (isNaN(n) || n&lt;minVal) {<br />&nbsp; &nbsp; &nbsp; &nbsp; err( 'Error: Invalid '+loc+' value', 1 );<br />&nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; return n;<br />&nbsp; &nbsp; }<br /><br />&nbsp; &nbsp; var env = WScript.CreateObject(&quot;WScript.Shell&quot;).Environment(&quot;Process&quot;),<br />&nbsp; &nbsp; &nbsp; &nbsp; fso = new ActiveXObject(&quot;Scripting.FileSystemObject&quot;);<br /><br />&nbsp; &nbsp; try {<br />&nbsp; &nbsp; &nbsp; var root = fso.GetFolder( env('/P') );<br />&nbsp; &nbsp; } catch(e) {<br />&nbsp; &nbsp; &nbsp; err( 'Invalid /P path: '+e.message, 1 );<br />&nbsp; &nbsp; }<br /><br />&nbsp; &nbsp; function MaskRepl($0) {<br />&nbsp; &nbsp; &nbsp; switch ($0) {<br />&nbsp; &nbsp; &nbsp; &nbsp; case '/P:':<br />&nbsp; &nbsp; &nbsp; &nbsp; case '/p:': return root.Path.replace(/&#91;.^$*+?()&#91;{\\|&#93;/g,&quot;\\$&amp;&quot;);<br />&nbsp; &nbsp; &nbsp; &nbsp; case '**':&nbsp; return '.*';<br />&nbsp; &nbsp; &nbsp; &nbsp; case '*':&nbsp; &nbsp;return '&#91;^\\\\&#93;*';<br />&nbsp; &nbsp; &nbsp; &nbsp; case '?':&nbsp; &nbsp;return '&#91;^\\\\.&#93;?';<br />&nbsp; &nbsp; &nbsp; &nbsp; default:&nbsp; &nbsp; return '\\'+$0;<br />&nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; }<br /><br />&nbsp; &nbsp; var args=WScript.Arguments,<br />&nbsp; &nbsp; &nbsp; &nbsp; search = BuildRegex( 'Search', args.Item(0), env('/I')?'gi':'g' ),<br />&nbsp; &nbsp; &nbsp; &nbsp; replace=args.Item(1),<br />&nbsp; &nbsp; &nbsp; &nbsp; rMask = BuildRegex( '/RFM', env('/RFM'), 'i' ),<br />&nbsp; &nbsp; &nbsp; &nbsp; rExclude = BuildRegex( '/RFX', env('/RFX'), 'i' ),<br />&nbsp; &nbsp; &nbsp; &nbsp; rPathMask = BuildRegex( '/RPM', env('/RPM'), 'i' ),<br />&nbsp; &nbsp; &nbsp; &nbsp; rPathExclude = BuildRegex( '/RPX', env('/RPX'), 'i' ),<br />&nbsp; &nbsp; &nbsp; &nbsp; regex = new RegExp(&quot;/P:|&#91;*&#93;&#91;*&#93;|&#91;*&#93;|&#91;?&#93;|&#91;.^$+()&#91;{\\\\&#93;&quot;,&quot;ig&quot;);<br />&nbsp; &nbsp; &nbsp; &nbsp; mask = env('/FM') ? new RegExp( '^(?:' + env('/FM').replace(regex,MaskRepl) + ')$', 'i' ) : false;<br />&nbsp; &nbsp; &nbsp; &nbsp; exclude = env('/FX') ? new RegExp( '^(?:' + env('/FX').replace(regex,MaskRepl) + ')$', 'i' ) : false;<br />&nbsp; &nbsp; &nbsp; &nbsp; pathMask = env('/PM') ? new RegExp( '^(?:' + env('/PM').replace(regex,MaskRepl) + ')$', 'i' ) : false;<br />&nbsp; &nbsp; &nbsp; &nbsp; pathExclude = env('/PX') ? new RegExp( '^(?:' + env('/PX').replace(regex,MaskRepl) + ')$', 'i' ) : false;<br />&nbsp; &nbsp; &nbsp; &nbsp; upper = env('/U'),<br />&nbsp; &nbsp; &nbsp; &nbsp; lower = env('/L'),<br />&nbsp; &nbsp; &nbsp; &nbsp; recurse = env('/S'),<br />&nbsp; &nbsp; &nbsp; &nbsp; jscript = env('/J'),<br />&nbsp; &nbsp; &nbsp; &nbsp; list = env('/LIST'),<br />&nbsp; &nbsp; &nbsp; &nbsp; beg = GetInt( '/NBEG', env('/NBEG'), 0 ),<br />&nbsp; &nbsp; &nbsp; &nbsp; inc = GetInt( '/NINC', env('/NINC'), 1 ),<br />&nbsp; &nbsp; &nbsp; &nbsp; pad = GetInt( '/NPAD', env('/NPAD'), 1 ),<br />&nbsp; &nbsp; &nbsp; &nbsp; padStr = Array( pad+1 ).join('0'),<br />&nbsp; &nbsp; &nbsp; &nbsp; test = env('/T'),<br />&nbsp; &nbsp; &nbsp; &nbsp; quiet = env('/Q');<br /><br />&nbsp; &nbsp; _g.dirs = env('/D');<br /><br />&nbsp; &nbsp; function ProcessFolder( folder ) {<br />&nbsp; &nbsp; &nbsp; var i, a=&#91;&#93;;<br />&nbsp; &nbsp; &nbsp; var num = beg;<br />&nbsp; &nbsp; &nbsp; if (recurse || _g.dirs) {<br />&nbsp; &nbsp; &nbsp; &nbsp; var folders = new Enumerator(folder.SubFolders);<br />&nbsp; &nbsp; &nbsp; &nbsp; for( i=0 ; !folders.atEnd(); folders.moveNext()) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; a&#91;i++&#93;=folders.item()<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (recurse) ProcessFolder(folders.item());<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; if ( (!pathMask || pathMask.test(folder.Path)) &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(!rPathMask || rPathMask.test(folder.Path)) &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(!pathExclude || !pathExclude.test(folder.Path)) &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(!rPathExclude || !rPathExclude.test(folder.Path)) ) {<br />&nbsp; &nbsp; &nbsp; &nbsp; if (!_g.dirs) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; a=&#91;&#93;;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var files = new Enumerator(folder.Files);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for (i=0; !files.atEnd(); files.moveNext()) a&#91;i++&#93;=files.item();<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; for (i=0; i&lt;a.length; i++) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; _g.file = a&#91;i&#93;;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; _g.wmiFile = undefined;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var oldName = a&#91;i&#93;.Name;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ( (!mask || mask.test(oldName)) &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(!rMask || rMask.test(oldName)) &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(!exclude || !exclude.test(oldName)) &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(!rExclude || !rExclude.test(oldName)) ) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (jscript) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $n = num.toString();<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ($n.length&lt;pad) $n = (padStr+$n).slice(-pad);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; try {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var newName = oldName.replace( search, replace );<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } catch(e) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; err( 'Replace error: '+e.message, 1 );<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!list) newName=newName.replace( /&#91; .&#93;+$/, &quot;&quot; );<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (jscript &amp;&amp; !list &amp;&amp; newName.search(/&#91;&lt;&gt;|:/\\*?&quot;\x00-\x1F&#93;/)&gt;=0) err('Error: Invalid file name character in Replace',1);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (upper) newName = uc(newName);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (lower) newName = lc(newName);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (newName != oldName || list) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; try {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var oldPath=a&#91;i&#93;.Path;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!test &amp;&amp; !list) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (a&#91;i&#93;.Name.toUpperCase() == newName.toUpperCase()) a&#91;i&#93;.Name = '_{JREN_tempName}_';<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; a&#91;i&#93;.Name = newName;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (list) WScript.echo(newName);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else if (!quiet) WScript.echo( '&quot;'+oldPath+'&quot;&nbsp; --&gt;&nbsp; &quot;'+newName+'&quot;' );<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } catch(e) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (a&#91;i&#93;.Name != oldName) a&#91;i&#93;.Name = oldName;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; err( 'Unable to rename &quot;'+a&#91;i&#93;.Path+'&quot;&nbsp; --&gt;&nbsp; &quot;'+newName+'&quot; : &quot;'+e.message, 0 );<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; num+=inc;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; }<br /><br />&nbsp; &nbsp; if (jscript) {<br />&nbsp; &nbsp; &nbsp; var regex=new RegExp('.|'+search,''),<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cnt;<br />&nbsp; &nbsp; &nbsp; 'x'.replace( regex, function(){cnt=arguments.length-2; return '';} );<br />&nbsp; &nbsp; &nbsp; _g.replFunc='_g.replFunc=function($0';<br />&nbsp; &nbsp; &nbsp; for (var i=1; i&lt;cnt; i++) _g.replFunc+=',$'+i;<br />&nbsp; &nbsp; &nbsp; _g.replFunc+=',$off,$src){return eval(_g.replace);}';<br />&nbsp; &nbsp; &nbsp; _g.defineReplFunc();<br />&nbsp; &nbsp; &nbsp; _g.replace = replace;<br />&nbsp; &nbsp; &nbsp; replace = _g.replFunc;<br />&nbsp; &nbsp; } else if (!list &amp;&amp; replace.search(/&#91;&lt;&gt;|:/\\*?&quot;\x00-\x1F&#93;/)&gt;=0) err('Error: Invalid file name character in Replace',1);<br /><br />&nbsp; &nbsp; ProcessFolder( root );<br />&nbsp; &nbsp; WScript.Quit(0);<br />&nbsp; }<br /><br />&nbsp; _g.main();<br /><br />} catch(e) {<br />&nbsp; WScript.StdErr.WriteLine(&quot;JScript runtime error: &quot;+e.message);<br />&nbsp; WScript.Quit(1);<br />}<br /><br />function lc(str) { return str.toLowerCase(); }<br /><br />function uc(str) { return str.toUpperCase(); }<br /><br />function lpad( val, pad ) {<br />&nbsp; if (!pad) pad='';<br />&nbsp; var rtn=val.toString();<br />&nbsp; return (rtn.length&lt;pad.length) ? (pad+rtn).slice(-pad.length) : val;<br />}<br /><br />function rpad( val, pad ) {<br />&nbsp; if (!pad) pad='';<br />&nbsp; var rtn=val.toString();<br />&nbsp; return (rtn.length&lt;pad.length) ? (rtn+pad).slice(0,pad.length) : val;<br />}<br /><br />function ts(opt) {<br />&nbsp; if (opt===undefined) opt={};<br />&nbsp; if (opt.constructor !== Object) badOp('ts()');<br />&nbsp; if (!opt.wkd)&nbsp; &nbsp; &nbsp;opt.wkd='Sun Mon Tue Wed Thu Fri Sat';<br />&nbsp; if (!opt.weekday) opt.weekday='Sunday Monday Tuesday Wednesday Thursday Friday Saturday';<br />&nbsp; if (!opt.mth)&nbsp; &nbsp; &nbsp;opt.mth='Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec';<br />&nbsp; if (!opt.month)&nbsp; &nbsp;opt.month='January February March April May June July August September October November December';<br />&nbsp; if (!opt.fmt)&nbsp; &nbsp; &nbsp;opt.fmt='{isots}';<br /><br />&nbsp; var wkd&nbsp; &nbsp; &nbsp;= opt.wkd.split(' '),<br />&nbsp; &nbsp; &nbsp; weekday = opt.weekday.split(' '),<br />&nbsp; &nbsp; &nbsp; mth&nbsp; &nbsp; &nbsp;= opt.mth.split(' '),<br />&nbsp; &nbsp; &nbsp; month&nbsp; &nbsp;= opt.month.split(' '),<br />&nbsp; &nbsp; &nbsp; y,m,d,w,h,h12,n,s,f,u,z,zs,za, dt,<br />&nbsp; &nbsp; &nbsp; sp=' ', ps='/', pc=':', pd='-', pp='.', p2='00', p3='000', p4='0000';<br />&nbsp; if (wkd.length!=7)&nbsp; &nbsp; &nbsp;badOp('wkd');<br />&nbsp; if (weekday.length!=7) badOp('weekday');<br />&nbsp; if (mth.length!=12)&nbsp; &nbsp; badOp('mth');<br />&nbsp; if (month.length!=12)&nbsp; badOp('month');<br /><br />&nbsp; dt = getDt(opt.dt);<br />&nbsp; if (opt.oy) dt.setUTCFullYear(&nbsp; &nbsp; &nbsp;dt.getUTCFullYear()&nbsp; &nbsp; +getNum('oy'));<br />&nbsp; if (opt.om) dt.setUTCMonth(&nbsp; &nbsp; &nbsp; &nbsp; dt.getUTCMonth()&nbsp; &nbsp; &nbsp; &nbsp;+getNum('om'));<br />&nbsp; if (opt.od) dt.setUTCDate(&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dt.getUTCDate()&nbsp; &nbsp; &nbsp; &nbsp; +getNum('od'));<br />&nbsp; if (opt.oh) dt.setUTCHours(&nbsp; &nbsp; &nbsp; &nbsp; dt.getUTCHours()&nbsp; &nbsp; &nbsp; &nbsp;+getNum('oh'));<br />&nbsp; if (opt.on) dt.setUTCMinutes(&nbsp; &nbsp; &nbsp; dt.getUTCMinutes()&nbsp; &nbsp; &nbsp;+getNum('on'));<br />&nbsp; if (opt.os) dt.setUTCSeconds(&nbsp; &nbsp; &nbsp; dt.getUTCSeconds()&nbsp; &nbsp; &nbsp;+getNum('os'));<br />&nbsp; if (opt.of) dt.setUTCMilliseconds( dt.getUTCMilliseconds()+getNum('of'));<br />&nbsp; if (opt.tz) dt.setUTCMinutes(&nbsp; &nbsp; &nbsp; dt.getUTCMinutes()&nbsp; +(z=getNum('tz')));<br /><br />&nbsp; if (opt.olm) dt.setMonth(&nbsp; &nbsp; &nbsp; &nbsp; dt.getMonth()&nbsp; &nbsp; &nbsp; &nbsp;+getNum('olm'));<br />&nbsp; if (opt.old) dt.setDate(&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dt.getDate()&nbsp; &nbsp; &nbsp; &nbsp; +getNum('old'));<br /><br />&nbsp; y = opt.tz!==undefined ? dt.getUTCFullYear(): dt.getFullYear();<br />&nbsp; m = opt.tz!==undefined ? dt.getUTCMonth()&nbsp; &nbsp;: dt.getMonth();<br />&nbsp; d = opt.tz!==undefined ? dt.getUTCDate()&nbsp; &nbsp; : dt.getDate();<br />&nbsp; w = opt.tz!==undefined ? dt.getUTCDay()&nbsp; &nbsp; &nbsp;: dt.getDay();<br />&nbsp; h = opt.tz!==undefined ? dt.getUTCHours()&nbsp; &nbsp;: dt.getHours();<br />&nbsp; n = opt.tz!==undefined ? dt.getUTCMinutes() : dt.getMinutes();<br />&nbsp; s = opt.tz!==undefined ? dt.getUTCSeconds() : dt.getSeconds();<br />&nbsp; f = opt.tz!==undefined ? dt.getUTCMilliseconds() : dt.getMilliseconds();<br />&nbsp; u = dt.getTime();<br /><br />&nbsp; h12 = h%12;<br />&nbsp; if (!h12) h12=12;<br /><br />&nbsp; if (!opt.tz) z=-dt.getTimezoneOffset();<br />&nbsp; zs = z&lt;0 ? '-' : '+';<br />&nbsp; za = Math.abs(z);<br /><br />&nbsp; return opt.fmt.replace( /\{(.*?)\}/gi, repl );<br /><br />&nbsp; function getNum( v ) {<br />&nbsp; &nbsp; var rtn = Number(opt&#91;v&#93;);<br />&nbsp; &nbsp; if (isNaN(rtn-rtn)) badOp(v);<br />&nbsp; &nbsp; return rtn;<br />&nbsp; }<br /><br />&nbsp; function getDt( v ) {<br />&nbsp; &nbsp; var dt, n;<br />&nbsp; &nbsp; if (v===undefined) {<br />&nbsp; &nbsp; &nbsp; dt = new Date();<br />&nbsp; &nbsp; } else switch (v.constructor) {<br />&nbsp; &nbsp; &nbsp; case Date:<br />&nbsp; &nbsp; &nbsp; case Number:<br />&nbsp; &nbsp; &nbsp; &nbsp; dt = new Date(v);<br />&nbsp; &nbsp; &nbsp; &nbsp; break;<br />&nbsp; &nbsp; &nbsp; case Array:<br />&nbsp; &nbsp; &nbsp; &nbsp; try {dt=eval( 'new Date('+v.join(',')+')' )} catch(e){}<br />&nbsp; &nbsp; &nbsp; &nbsp; break;<br />&nbsp; &nbsp; &nbsp; case String:<br />&nbsp; &nbsp; &nbsp; &nbsp; switch (v.toLowerCase()) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case '':&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dt = new Date(); break;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case 'created':&nbsp; dt = getWmiDt('c'); break;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case 'modified': dt = getWmiDt('m'); break;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case 'accessed': dt = getWmiDt('a'); break;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case 'fsocreated':&nbsp; dt = new Date(_g.file.DateCreated); break;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case 'fsomodified': dt = new Date(_g.file.DateLastModified); break;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case 'fsoaccessed': dt = new Date(_g.file.DateLastAccessed); break;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; default:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; n=Number(v);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (isNaN(n-n)) dt = new Date(v);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt = new Date(n);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; break;<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; if (isNaN(dt)) badOp('dt');<br />&nbsp; &nbsp; return dt;<br />&nbsp; }<br />&nbsp;<br />&nbsp; function badOp(option) {<br />&nbsp; &nbsp; throw new Error('Invalid '+option+' value');<br />&nbsp; }<br /><br />&nbsp; function trunc( n ) { return Math&#91;n&gt;0?&quot;floor&quot;:&quot;ceil&quot;&#93;(n); }<br />&nbsp;<br />&nbsp; function repl($0,$1) {<br />&nbsp; &nbsp; switch ($1.toUpperCase()) {<br />&nbsp; &nbsp; &nbsp; case 'YYYY' : return lpad(y,p4);<br />&nbsp; &nbsp; &nbsp; case 'YY'&nbsp; &nbsp;: return (p2+y.toString()).slice(-2);<br />&nbsp; &nbsp; &nbsp; case 'Y'&nbsp; &nbsp; : return y.toString();<br />&nbsp; &nbsp; &nbsp; case 'MM'&nbsp; &nbsp;: return lpad(m+1,p2);<br />&nbsp; &nbsp; &nbsp; case 'M'&nbsp; &nbsp; : return (m+1).toString();<br />&nbsp; &nbsp; &nbsp; case 'DD'&nbsp; &nbsp;: return lpad(d,p2);<br />&nbsp; &nbsp; &nbsp; case 'D'&nbsp; &nbsp; : return d.toString();<br />&nbsp; &nbsp; &nbsp; case 'W'&nbsp; &nbsp; : return w.toString();<br />&nbsp; &nbsp; &nbsp; case 'HH'&nbsp; &nbsp;: return lpad(h,p2);<br />&nbsp; &nbsp; &nbsp; case 'H'&nbsp; &nbsp; : return h.toString();<br />&nbsp; &nbsp; &nbsp; case 'HH12' : return lpad(h12,p2);<br />&nbsp; &nbsp; &nbsp; case 'H12'&nbsp; : return h12.toString();<br />&nbsp; &nbsp; &nbsp; case 'NN'&nbsp; &nbsp;: return lpad(n,p2);<br />&nbsp; &nbsp; &nbsp; case 'N'&nbsp; &nbsp; : return n.toString();<br />&nbsp; &nbsp; &nbsp; case 'SS'&nbsp; &nbsp;: return lpad(s,p2);<br />&nbsp; &nbsp; &nbsp; case 'S'&nbsp; &nbsp; : return s.toString();<br />&nbsp; &nbsp; &nbsp; case 'FFF'&nbsp; : return lpad(f,p3);<br />&nbsp; &nbsp; &nbsp; case 'F'&nbsp; &nbsp; : return f.toString();<br />&nbsp; &nbsp; &nbsp; case 'AM'&nbsp; &nbsp;: return h&gt;=12 ? 'PM' : 'AM';<br />&nbsp; &nbsp; &nbsp; case 'PM'&nbsp; &nbsp;: return h&gt;=12 ? 'pm' : 'am';<br />&nbsp; &nbsp; &nbsp; case 'UMS'&nbsp; : return u.toString();<br />&nbsp; &nbsp; &nbsp; case 'USD'&nbsp; : return (u/1000).toString();<br />&nbsp; &nbsp; &nbsp; case 'UMD'&nbsp; : return (u/1000/60).toString();<br />&nbsp; &nbsp; &nbsp; case 'UHD'&nbsp; : return (u/1000/60/60).toString();<br />&nbsp; &nbsp; &nbsp; case 'UDD'&nbsp; : return (u/1000/60/60/24).toString();<br />&nbsp; &nbsp; &nbsp; case 'U'&nbsp; &nbsp; : return trunc(u/1000).toString();<br />&nbsp; &nbsp; &nbsp; case 'US'&nbsp; &nbsp;: return trunc(u/1000).toString();<br />&nbsp; &nbsp; &nbsp; case 'UM'&nbsp; &nbsp;: return trunc(u/1000/60).toString();<br />&nbsp; &nbsp; &nbsp; case 'UH'&nbsp; &nbsp;: return trunc(u/1000/60/60).toString();<br />&nbsp; &nbsp; &nbsp; case 'UD'&nbsp; &nbsp;: return trunc(u/1000/60/60/24).toString();<br />&nbsp; &nbsp; &nbsp; case 'ZZZZ' : return zs+lpad(za,p3);<br />&nbsp; &nbsp; &nbsp; case 'Z'&nbsp; &nbsp; : return z.toString();<br />&nbsp; &nbsp; &nbsp; case 'ZS'&nbsp; &nbsp;: return zs;<br />&nbsp; &nbsp; &nbsp; case 'ZH'&nbsp; &nbsp;: return lpad(trunc(za/60),p2);<br />&nbsp; &nbsp; &nbsp; case 'ZM'&nbsp; &nbsp;: return lpad(za%60,p2);<br />&nbsp; &nbsp; &nbsp; case 'ISOTS'&nbsp; : return ''+lpad(y,p4)+lpad(m+1,p2)+lpad(d,p2)+'T'+lpad(h,p2)+lpad(n,p2)+lpad(s,p2)+pp+lpad(f,p3)+zs+lpad(trunc(za/60),p2)+lpad(za%60,p2);<br />&nbsp; &nbsp; &nbsp; case 'ISODT'&nbsp; : return ''+lpad(y,p4)+lpad(m+1,p2)+lpad(d,p2);<br />&nbsp; &nbsp; &nbsp; case 'ISOTM'&nbsp; : return ''+lpad(h,p2)+lpad(n,p2)+lpad(s,p2)+pp+lpad(f,p3);<br />&nbsp; &nbsp; &nbsp; case 'ISOTZ'&nbsp; : return ''+zs+lpad(trunc(za/60),p2)+lpad(za%60,p2);<br />&nbsp; &nbsp; &nbsp; case 'ISO-TS' : return ''+lpad(y,p4)+pd+lpad(m+1,p2)+pd+lpad(d,p2)+'T'+lpad(h,p2)+pc+lpad(n,p2)+pc+lpad(s,p2)+pp+lpad(f,p3)+zs+lpad(trunc(za/60),p2)+pc+lpad(za%60,p2);<br />&nbsp; &nbsp; &nbsp; case 'ISO-DT' : return ''+lpad(y,p4)+pd+lpad(m+1,p2)+pd+lpad(d,p2);<br />&nbsp; &nbsp; &nbsp; case 'ISO-TM' : return ''+lpad(h,p2)+pc+lpad(n,p2)+pc+lpad(s,p2)+pp+lpad(f,p3);<br />&nbsp; &nbsp; &nbsp; case 'ISO-TZ' : return ''+zs+lpad(trunc(za/60),p2)+pc+lpad(za%60,p2);<br />&nbsp; &nbsp; &nbsp; case 'WEEKDAY': return weekday&#91;w&#93;;<br />&nbsp; &nbsp; &nbsp; case 'WKD'&nbsp; &nbsp; : return wkd&#91;w&#93;;<br />&nbsp; &nbsp; &nbsp; case 'MONTH'&nbsp; : return month&#91;m&#93;;<br />&nbsp; &nbsp; &nbsp; case 'MTH'&nbsp; &nbsp; : return mth&#91;m&#93;;<br />&nbsp; &nbsp; &nbsp; case '{'&nbsp; &nbsp; &nbsp; : return $1;<br />&nbsp; &nbsp; &nbsp; default&nbsp; &nbsp; &nbsp; &nbsp;: return $0;<br />&nbsp; &nbsp; }<br />&nbsp; }<br /><br />&nbsp; function getWmiDt( prop ) {<br />&nbsp; &nbsp; if (_g.wmi===undefined) {<br />&nbsp; &nbsp; &nbsp; var svcLoc = new ActiveXObject(&quot;WbemScripting.SWbemLocator&quot;);<br />&nbsp; &nbsp; &nbsp; _g.wmi = svcLoc.ConnectServer(&quot;.&quot;, &quot;root\\cimv2&quot;);<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; if (_g.wmiFile===undefined) {<br />&nbsp; &nbsp; &nbsp; _g.wmiFile = new Enumerator(_g.wmi.ExecQuery(<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;Select * From &quot;+(_g.dirs?&quot;Win32_Directory&quot;:&quot;Cim_DataFile&quot;)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+&quot; Where Name = '&quot;+_g.file.Path.replace(/\\/g,&quot;\\\\&quot;).replace(/'/g,&quot;\\'&quot;)+&quot;'&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )).item();<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; var wmiDt;<br />&nbsp; &nbsp; switch (prop.toLowerCase()) {<br />&nbsp; &nbsp; &nbsp; case 'c': wmiDt=_g.wmiFile.CreationDate; break;<br />&nbsp; &nbsp; &nbsp; case 'm': wmiDt=_g.wmiFile.LastModified; break;<br />&nbsp; &nbsp; &nbsp; case 'a': wmiDt=_g.wmiFile.LastAccessed; break;<br />&nbsp; &nbsp; &nbsp; default: return undefined;<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; var tz=Number(wmiDt.substr(22));<br />&nbsp; &nbsp; var dt = new Date(&nbsp; &nbsp; &nbsp;wmiDt.substr(0,4)+ps+wmiDt.substr(4,2)+ps+wmiDt.substr(6,2)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+sp+wmiDt.substr(8,2)+pc+wmiDt.substr(10,2)+pc+wmiDt.substr(12,2)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+sp+wmiDt.substr(21,1)+lpad(trunc(tz/60),p2)+lpad(tz%60,p2)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;);<br />&nbsp; &nbsp; dt.setMilliseconds(Number(wmiDt.substr(15,3)));<br />&nbsp; &nbsp; return dt;<br />&nbsp; }<br /><br />}<br /><br />function attr(off) {<br />&nbsp; var a=_g.file.Attributes;<br />&nbsp; var o=off?off.substr(0,1):'';<br />&nbsp; return&nbsp; (a&amp;1&nbsp; &nbsp;?'R':o?o:'r')&nbsp; //Read only<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+(a&amp;2&nbsp; &nbsp;?'H':o?o:'h')&nbsp; //Hidden<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+(a&amp;4&nbsp; &nbsp;?'S':o?o:'s')&nbsp; //System<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+(a&amp;32&nbsp; ?'A':o?o:'a')&nbsp; //Archive<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+(a&amp;1024?'L':o?o:'l')&nbsp; //Link or Shortcut<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+(a&amp;2048?'C':o?o:'c'); //Compressed<br />}<br /><br />function size(pad) {return lpad(_g.file.Size,pad);}<br /><br />function type(pad) {return rpad(_g.file.Type,pad);}<br /><br />function path(pad) {return rpad(_g.file.Path,pad);}<br /><br />function parent(pad) {return rpad(_g.file.ParentFolder.Path,pad);}<br /><br />function name(pad) {return rpad(_g.file.Name,pad);}<br /><br />function sPath(pad) {return rpad(_g.file.ShortPath,pad);}<br /><br />function sParent(pad) {return rpad(_g.file.ParentFolder.ShortPath,pad);}<br /><br />function sName(pad) {return rpad(_g.file.ShortName,pad);}<br /></code></pre></div><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p49860" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile49860">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content49860">

						<h3 ><a href="#p49860">Re: JREN.BAT - Rename files/folders using regular expressions</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting85ca.html?mode=quote&amp;f=3&amp;p=49860" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic2330.html?p=49860#p49860" onclick="prompt('Message #24',this.href); return false;">#24</a></span> 
									<a class="unread" href="viewtopic2330.html?p=49860#p49860" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>26 Oct 2016 10:01
			</p>
			
			
			
			<div class="content">Version 2.7 fixes a ts() bug - it failed to return UTC time when setting time zone to 0 (tz:0)<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@if (@X)==(@Y) @end /* Harmless hybrid line that begins a JScript comment<br />@goto :Batch<br /><br />::JREN.BAT version 2.7 by Dave Benham<br />::<br />::&nbsp; Release History:<br />::&nbsp; &nbsp; 2.7&nbsp; 2016-10-26: Fixed ts() bug - tz:0 was not working<br />::&nbsp; &nbsp; 2.6&nbsp; 2016-07-10: Fixed bug in ts() offset computations when the before and<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;after have different timezones due to daylight savings.<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Added olm: and old: options to the ts() function to allow<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the addition of months/years without changing the local hour.<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;In other words, the computation compensates for changes in<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dayling savings conditions.<br />::&nbsp; &nbsp; 2.4&nbsp; 2015-07-15: Added /?? and /??TS() paged help options<br />::&nbsp; &nbsp; 2.3&nbsp; 2015-03-03: Ignore invalid characters if /LIST mode<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Bug fix - abort if invalid character with /T mode<br />::&nbsp; &nbsp; 2.2&nbsp; 2014-12-10: Bug fix - forgot to make the search regex global<br />::&nbsp; &nbsp; 2.1&nbsp; 2014-12-10: Additional dt: options for FileSystemObject timestamps<br />::&nbsp; &nbsp; 2.0&nbsp; 2014-12-07: New /LIST option.<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Added ts() function and /?ts() documentation<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Many new JScript functions for use with /J with /LIST<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Added GOTO at top to improve startup performance<br />::&nbsp; &nbsp; 1.1&nbsp; 2014-12-02: Options may be prefaced with / or -<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Corrected some documentation<br />::&nbsp; &nbsp; 1.0&nbsp; 2014-11-30: Initial release<br />::<br />::============ Documentation ===========<br />:::<br />:::JREN&nbsp; Search&nbsp; Replace&nbsp; &#91;/Option&nbsp; &#91;Value&#93;&#93;...<br />:::JREN&nbsp; /?&#91;REGEX|REPLACE|VERSION|TS()&#93;<br />:::JREN&nbsp; /??&#91;ts()&#93;<br />:::<br />:::&nbsp; Rename files in the current directory by performing a regular expression<br />:::&nbsp; search/replace on the old file name to generate the new file name.<br />:::&nbsp; This includes read only, hidden, and system files.<br />:::<br />:::&nbsp; Search&nbsp; - By default, this is a case sensitive JScript (ECMA) regular<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; expression expressed as a string. The search is applied globally<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; to the entire file name.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; JScript regex syntax documentation is available at<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; http://msdn.microsoft.com/en-us/library/ae5bf541(v=vs.80).aspx<br />:::<br />:::&nbsp; Replace - By default, this is the string to be used as a replacement for<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; each found search expression. Full support is provided for<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; substituion patterns available to the JScript replace method.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; For example, $&amp; represents the portion of the source that matched<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the entire search pattern, $1 represents the first captured<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; submatch, $2 the second captured submatch, etc. A $ literal<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; can be escaped as $$.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; An empty replacement string must be represented as &quot;&quot;.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Replace substitution pattern syntax is fully documented at<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; http://msdn.microsoft.com/en-US/library/efy6s3e6(v=vs.80).aspx<br />:::<br />:::&nbsp; Options:&nbsp; Behavior may be altered by appending one or more options.<br />:::&nbsp; The option names are case insensitive, and may appear in any order<br />:::&nbsp; after the Replace argument. Options may be prefaced with / or -<br />:::<br />:::&nbsp; &nbsp; &nbsp; /D&nbsp; - Rename Directories instead of files.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /FM FileOrFolderMask<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Only rename files or folders that match any of the pattern(s)<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using standard wildcards. Multiple patterns are delimited by a<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pipe (|). Only complete name matches count.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * matches any 0 or more characters<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ? matches any 0 or 1 character except .<br />:::<br />:::&nbsp; &nbsp; &nbsp; /FX FileOrFolderExclusion<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exclude files or folders that match any of the pattern(s)<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using standard wildcards. Multiple patterns are delimited by a<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pipe (|). Only complete name matches count.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * matches any 0 or more characters<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ? matches any 0 or 1 character except .<br />:::<br />:::&nbsp; &nbsp; &nbsp; /I&nbsp; - Ignore case when matching.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /J&nbsp; - Treat Replace as a JScript expression.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The following variables contain details about each match:<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $0 = the substring that matched the Search<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $1 through $n = captured submatch strings<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $off = the offset where the match occurred<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $src = the original source string<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The following are also available:<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $n = An incrementing number for use in the name. The value<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;is reset to the /NBEG value for each directory.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;It increases by the /NINC value for each renamed file.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;The value may be zero padded to the width specified by<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the /NPAD value.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lc(str)<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Convert str to lower case. Shorthand for str.toLowerCase().<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uc(str)<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Convert str to upper case. Shorthand for str.toUpperCase().<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lpad(string,pad)<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Used to left pad string str to a minimum length. If the<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;str already has length &gt;= the pad string length, then no<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;change is made. Otherwise it left pads the value with the<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;characters of the pad string to the length of pad.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Examples:<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lpad(15,'0000')&nbsp; &nbsp; returns &quot;0015&quot;<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lpad(15,'&nbsp; &nbsp; ')&nbsp; &nbsp; returns &quot;&nbsp; 15&quot;<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lpad(19011,'0000') returns &quot;19011&quot;<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; rpad(string,pad)<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Used to right pad the string to a minimum length. If the<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;str already has length &gt;= the pad string length, then no<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;change is made. Otherwise it right pads the value with the<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;characters of the pad string to the length of pad.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ts( {option:value, option:value...} )<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Perform date/time computations and produce formatted<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;timestamps. This function can get the current date/and time,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;or get the created/lastModified/lastAccessed timestamps for<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the file being renamed, or parse a date/time from the name<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;of the file, or use a user specified value.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Use JREN /?TS() to get help on the ts() function<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; attr( &#91;offChar&#93; )<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Lists the attributes of the file/folder. Set attributes are<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;listed in upper case and unset attributes are shown as the<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;offChar, or lower case. The listed attributes are:<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;R - Read Only<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;H - Hidden<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;S - System<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;A - Archive<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;L - Link or Shortcut<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;C - Compressed<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; size( &#91;pad&#93; )<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;File/folder size, optionally left padded to the length of<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the pad string.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; type( &#91;pad&#93; )<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;File/folder type, optionally right padded to the length of<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the pad string.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; name( &#91;pad&#93; )<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Name of the file/folder, optionally right padded to<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the length of the pad string.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; path( &#91;pad&#93; )<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Full Path of file/folder, optionally right padded to<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the length of the pad string.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; parent( &#91;pad&#93; )<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Path of the parent folder, optionally right padded to<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the length of the pad string.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sName( &#91;pad &#93;)<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Short (8.3) name of the file/folder, optionally right padded<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;to the length of the pad string.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sPath( &#91;pad&#93; )<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Path of the file/folder using short (8.3) names, optionally<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;right padded to the length of the pad string.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sParent( &#91;pad&#93; )<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Path of the parent folder using short (8.3) names,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;optionally right padded to the length of the pad string.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /L&nbsp; - Convert names to Lower case. Entire names can be converted to<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lower case without any other changes by using empty strings (&quot;&quot;)<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for both Search and Replace.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /LIST - List the Rename results only, without quotes, and without<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; renaming anything. Invalid file name characters are ignored.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The resulting &quot;name&quot; is always listed, even if no change.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /NBEG BeginValue<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Specifies the initial $n value for each directory. The value<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; must be an integer &gt;= 0. The default value is 1.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /NINC IncrementValue<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Specifies the amount $n is incremented after each rename.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The value must be an integer &gt;=1. The default value is 1.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /NPAD MinWidth<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Specifies the minimum width for each $n value. If the $n value<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; has fewer digits than MinWidth, then the value is zero padded<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; on the left to achieve the MinWidth. The value must be &gt;= 1.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The default value is 3.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /P RootPath<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Specifies the path where the rename is to take place.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The default of . represents the current directory.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Wildcards are not allowed.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /PM PathMask<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Only rename files or folders whose parent folder path matches<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; any of the PathMask pattern(s) using augmented wildcards.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Multiple patterns are delimited by a pipe (|). Only full path<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; matches count.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /P:&nbsp; matches the root path specified by option /P<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; **&nbsp; &nbsp;matches any 0 or more characters<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *&nbsp; &nbsp; matches any 0 or more characters except \<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ?&nbsp; &nbsp; matches any 0 or 1 character except . or \<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This option is only useful if the /S option is used.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /PX PathExclusion<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exclude files or folders whose parent folder path matches any<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; of the PathExclusion pattern(s) using augmented wildcards.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Multiple patterns are delimited by a pipe (|). Only full path<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; matches count.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /P:&nbsp; matches the root path specified by option /P<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; **&nbsp; &nbsp;matches any 0 or more characters<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *&nbsp; &nbsp; matches any 0 or more characters except \<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ?&nbsp; &nbsp; matches any 0 or 1 character except . or \<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This option is only useful if the /S option is used.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /Q&nbsp; - Do not list the renamed files/folders (Quiet mode).<br />:::<br />:::&nbsp; &nbsp; &nbsp; /RFM RegexFileOrFoldereMask<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Only rename files or folders that match the regular expression,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ignoring case. Partial name matches count.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /RFX RegexFileOrFolderExclusion<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exclude files or folders that match the regular Expression,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ignoring case. Partial name matches count.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /RPM RegexPathMask<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Only rename files or folders whose parent folder path matches the<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RegexPathMask regular expression, ignoring case. Partial path<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; matches count. This option is really only useful if the /S<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; option is used.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /RPX RegexPathExclusion<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exclude files or folders whose parent folder path matches the<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RegexPathExclusion regular expression, ignoring case. Partial<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; path matches count. This option is really only useful if the<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /S option is used.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /S&nbsp; - Recurse Subdirectories.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /T&nbsp; - List the rename operations that would be attempted,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; but do not rename anything. (Test mode)<br />:::<br />:::&nbsp; &nbsp; &nbsp; /U&nbsp; - Convert names to Upper case. Entire names can be converted to<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; upper case without any other changes by using empty strings (&quot;&quot;)<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for both Search and Replace.<br />:::<br />:::&nbsp; Help is available by supplying a single argument beginning with /?:<br />:::<br />:::&nbsp; &nbsp; &nbsp; /?&nbsp; &nbsp; &nbsp; &nbsp; - Writes this help documentation to stdout.<br />:::&nbsp; &nbsp; &nbsp; /??&nbsp; &nbsp; &nbsp; &nbsp;- Same as /? except uses MORE to provide pagination<br />:::<br />:::&nbsp; &nbsp; &nbsp; /?REGEX&nbsp; &nbsp;- Opens up Microsoft's JScript regular expression<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; documentation within your browser.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /?REPLACE - Opens up Microsoft's JScript REPLACE documentation<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; within your browser.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /?VERSION - Writes the JREN version number to stdout.<br />:::<br />:::&nbsp; &nbsp; &nbsp; /?TS()&nbsp; &nbsp; - Writes documentation for the ts() function to stdout.<br />:::&nbsp; &nbsp; &nbsp; /??TS()&nbsp; &nbsp;- Same as /??TS() except uses MORE for pagination.<br />:::<br />:::&nbsp; JREN.BAT was written by Dave Benham, and originally posted at<br />:::&nbsp; http://www.dostips.com/forum/viewtopic.php?f=3&amp;t=6081<br />:::<br />:: =============== ts() documentation ===============<br />::+<br />::+ts( &#91; { &#91;option:value &#91;,option:value&#93;...&#93; } &#93; )<br />::+&nbsp; <br />::+&nbsp; A JScript function that can performs date and time computations and return<br />::+&nbsp; a formatted time string.<br />::+&nbsp; <br />::+&nbsp; The option object argument within curly braces is optional - if no argument<br />::+&nbsp; is given, then it returns the current timestamp using compressed ISO 8601<br />::+&nbsp; format with milliseconds and local time zone - YYYYMMDDThhmmss.fff+zzzz<br />::+&nbsp; <br />::+&nbsp; &nbsp; Examples:<br />::+&nbsp; &nbsp; &nbsp; ts()&nbsp; - Current date/time:&nbsp; YYYYMMDDThhmmss.fff+zzzz<br />::+&nbsp; &nbsp; &nbsp; ts({dt:'created',fmt:'{iso-dt}'})&nbsp; - The file create date:&nbsp; YYYY-MM-DD<br />::+&nbsp; &nbsp; &nbsp; ts({od:-1,fmt:'{YYYY}_{MM}_{DD}'}) - Yesterday's date:&nbsp; YYYY_MM_DD<br />::+&nbsp; <br />::+&nbsp; Option names are case sensitive. There are 5 types of options:<br />::+&nbsp; &nbsp; 1) Specify the base date&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - dt:<br />::+&nbsp; &nbsp; 2) Specify date/time offsets&nbsp; &nbsp; &nbsp; - oy: om: od: oh: on: os: of:<br />::+&nbsp; &nbsp; 3) Specify the output time zone&nbsp; &nbsp;- tz:<br />::+&nbsp; &nbsp; 4) Specify the output format&nbsp; &nbsp; &nbsp; - fmt:<br />::+&nbsp; &nbsp; 5) Configure the day-of-week and&nbsp; - wkd: weekday: mth: month:<br />::+&nbsp; &nbsp; &nbsp; &nbsp;month names for non-English<br />::+&nbsp; &nbsp; &nbsp; &nbsp;users<br />::+<br />::+&nbsp; Specify the base date and time<br />::+<br />::+&nbsp; &nbsp; dt:&nbsp; Value specifies the base date and time. Many formats supported:<br />::+<br />::+&nbsp; &nbsp; &nbsp; Current local date/time<br />::+&nbsp; &nbsp; &nbsp; &nbsp; - do not specify a dt: value<br />::+&nbsp; &nbsp; &nbsp; &nbsp; - undefined value<br />::+&nbsp; &nbsp; &nbsp; &nbsp; - empty string ''<br />::+<br />::+&nbsp; &nbsp; &nbsp; &nbsp; Examples:<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:''<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:undefined<br />::+<br />::+&nbsp; &nbsp; &nbsp; Milliseconds since 1970-01-01 00:00:00 UTC<br />::+&nbsp; &nbsp; &nbsp; &nbsp; - NumericExpression (math OK)<br />::+&nbsp; &nbsp; &nbsp; &nbsp; - NumericString (no math)<br />::+<br />::+&nbsp; &nbsp; &nbsp; &nbsp; Examples:<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt: 1391230800000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = January 1, 19970 00:00:00 UTC<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt: 1391230000000+800000&nbsp; &nbsp;= January 1, 19970 00:00:00 UTC<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:'1391230800000'&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= January 1, 19970 00:00:00 UTC<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:'1391230000000+800000'&nbsp; = error<br />::+<br />::+&nbsp; &nbsp; &nbsp; String timestamp representation<br />::+&nbsp; &nbsp; &nbsp; &nbsp; - Any string accepted by the JScript Date.Parse() method.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; See http://msdn.microsoft.com/en-us/library/k4w173wk(v=vs.84).aspx<br />::+<br />::+&nbsp; &nbsp; &nbsp; &nbsp; Examples: All of the following represent Midnight on January 4, 2013<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; assuming local time zone is U.S Eastern Standard Time (EST)<br />::+<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:'1-4-2013'&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Defaults to local time zone<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:'January 4, 2013 EST'&nbsp; &nbsp; &nbsp; &nbsp;Explicit Eastern Std Time (US)<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:'2013/1/4 -05'&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Explicit Eastern Std Time (US)<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:'Jan 3 2013 23: CST'&nbsp; &nbsp; &nbsp; &nbsp; Central Standard Time (US)<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:'2013 3 Jan 9:00 pm -0800'&nbsp; Pacific Standard Time (US)<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:'01/04/2013 05:00:00 UTC'&nbsp; &nbsp;Universal Coordinated Time<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:'1/4/2013 05:30 +0530'&nbsp; &nbsp; &nbsp; India Standard Time<br />::+<br />::+&nbsp; &nbsp; &nbsp; File timestamps to millisecond accuracy using WMI. Very slow, but<br />::+&nbsp; &nbsp; &nbsp; locale agnostic. WMI call may not work on some older machines.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; - 'created'&nbsp; &nbsp;= Creation date/time of the file<br />::+&nbsp; &nbsp; &nbsp; &nbsp; - 'modified'&nbsp; = Last Modified date/time of the file<br />::+&nbsp; &nbsp; &nbsp; &nbsp; - 'accessed'&nbsp; = Last Accessed date/time of the file<br />::+<br />::+&nbsp; &nbsp; &nbsp; &nbsp; Example:<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:'created'&nbsp; = creation date/time of the file to be renamed<br />::+<br />::+&nbsp; &nbsp; &nbsp; File timestamps to second accuracy using FileSystemObject. Very fast,<br />::+&nbsp; &nbsp; &nbsp; but locale dependent. May not parse properly for some countries.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; - 'fsoCreated'&nbsp; = Creation date/time of the file<br />::+&nbsp; &nbsp; &nbsp; &nbsp; - 'fsoModified' = Last Modified date/time of the file<br />::+&nbsp; &nbsp; &nbsp; &nbsp; - 'fsoAccessed' = Last Accessed date/time of the file<br />::+<br />::+&nbsp; &nbsp; &nbsp; Array with 2 to 7 numeric expressions (local time only)<br />::+&nbsp; &nbsp; &nbsp; &nbsp; - &#91;year,months,days,hours,minutes,seconds,milliseconds&#93;<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; year and months are required, the rest are optional<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Missing values are assumed to be 0<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Missing values are not allowed between specified values<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; month 0 = January<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; day 1 = First day of month, day 0 = Last day of prior month<br />::+<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Examples:<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:&#91;2014,3,1,17,30,22,457&#93;&nbsp; = April 1, 2014, 17:30:22.457<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:&#91;2014,0,1&#93;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= January 1, 2014, 00:00:00<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:&#91;2014,0&#93;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= December 31, 2013, 00:00:00<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt:&#91;2014,,10&#93;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= error<br />::+<br />::+&nbsp; Date/Time offsets and time zone options all use the same syntax.<br />::+&nbsp; The value represents a numeric offset for the specified time unit.<br />::+&nbsp; It may be expressed as a numeric expression (math allowed), or<br />::+&nbsp; a numeric string (no math allowed). Both positive and negative<br />::+&nbsp; values may be used.<br />::+<br />::+&nbsp; &nbsp; oy:&nbsp; Year offset<br />::+&nbsp; &nbsp; om:&nbsp; Months offset<br />::+&nbsp; &nbsp; od:&nbsp; Days offset<br />::+&nbsp; &nbsp; oh:&nbsp; Hours offset<br />::+&nbsp; &nbsp; on:&nbsp; Minutes offset<br />::+&nbsp; &nbsp; os:&nbsp; Seconds offset<br />::+&nbsp; &nbsp; of:&nbsp; Milliseconds (Fractional seconds) offset<br />::+<br />::+&nbsp; &nbsp; olm: LocalMonths offset (adjusted for changes in daylight savings)<br />::+&nbsp; &nbsp; old: LocalDays offset (adjusted for changes in daylight savings)<br />::+<br />::+&nbsp; &nbsp; tz:&nbsp; Time zone used for output = minutes offset from UTC<br />::+<br />::+&nbsp; The fmt: option is a string that specifies the format of the output.<br />::+&nbsp; Strings within curly braces are replaced by dynamic components that are<br />::+&nbsp; derived from the computed time stamp. Strings within braces that do not<br />::+&nbsp; match a fmt: component are left as is. Strings not in braces are left<br />::+&nbsp; as is. The format component names are not case senstive.<br />::+<br />::+&nbsp; For example, a U.S. date would be represented as fmt:'{yyyy}/{mm}/{dd}'<br />::+<br />::+&nbsp; The default format is '{ISOTS}', which yields YYYYMMDDThhmmss.fff+hhmm<br />::+<br />::+&nbsp; &nbsp; {YYYY}&nbsp; 4 digit year, zero padded<br />::+<br />::+&nbsp; &nbsp; {YY}&nbsp; &nbsp; 2 digit year, zero padded<br />::+<br />::+&nbsp; &nbsp; {Y}&nbsp; &nbsp; &nbsp;year without zero padding<br />::+<br />::+&nbsp; &nbsp; {MONTH} month name<br />::+<br />::+&nbsp; &nbsp; {MTH}&nbsp; &nbsp;month abbreviation<br />::+<br />::+&nbsp; &nbsp; {MM}&nbsp; &nbsp; 2 digit month, zero padded<br />::+<br />::+&nbsp; &nbsp; {M}&nbsp; &nbsp; &nbsp;month without zero padding<br />::+<br />::+&nbsp; &nbsp; {WEEKDAY} day of week name<br />::+<br />::+&nbsp; &nbsp; {WKD}&nbsp; &nbsp;day of week abbreviation<br />::+<br />::+&nbsp; &nbsp; {W}&nbsp; &nbsp; &nbsp;day of week number, 0=Sunday<br />::+<br />::+&nbsp; &nbsp; {DD}&nbsp; &nbsp; 2 digit day, zero padded<br />::+<br />::+&nbsp; &nbsp; {D}&nbsp; &nbsp; &nbsp;day without zero padding<br />::+<br />::+&nbsp; &nbsp; {HH}&nbsp; &nbsp; 2 digit hours, 24 hour format, zero padded<br />::+<br />::+&nbsp; &nbsp; {H}&nbsp; &nbsp; &nbsp;hours, 24 hour format without zero padding<br />::+<br />::+&nbsp; &nbsp; {HH12}&nbsp; 2 digit hours, 12 hour format, zero padded<br />::+<br />::+&nbsp; &nbsp; {H12}&nbsp; &nbsp;hours, 12 hour format without zero padding<br />::+<br />::+&nbsp; &nbsp; {NN}&nbsp; &nbsp; 2 digit minutes, zero padded<br />::+<br />::+&nbsp; &nbsp; {N}&nbsp; &nbsp; &nbsp;minutes without padding<br />::+<br />::+&nbsp; &nbsp; {SS}&nbsp; &nbsp; 2 digit seconds, zero padded<br />::+<br />::+&nbsp; &nbsp; {S}&nbsp; &nbsp; &nbsp;seconds without padding<br />::+<br />::+&nbsp; &nbsp; {FFF}&nbsp; &nbsp;3 digit milliseconds, zero padded<br />::+<br />::+&nbsp; &nbsp; {F}&nbsp; &nbsp; &nbsp;milliseconds without padding<br />::+<br />::+&nbsp; &nbsp; {AM}&nbsp; &nbsp; AM or PM in upper case<br />::+<br />::+&nbsp; &nbsp; {PM}&nbsp; &nbsp; am or pm in lower case<br />::+<br />::+&nbsp; &nbsp; {ZZZZ}&nbsp; timezone expressed as minutes offset from UTC,<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; zero padded to 3 digits with sign<br />::+<br />::+&nbsp; &nbsp; {Z}&nbsp; &nbsp; &nbsp;timzone minutes offset from UTC without padding<br />::+<br />::+&nbsp; &nbsp; {ZS}&nbsp; &nbsp; timezone sign<br />::+<br />::+&nbsp; &nbsp; {ZH}&nbsp; &nbsp; timezone hours hours offset from UTC, (no sign),<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; padded to 2 digits<br />::+<br />::+&nbsp; &nbsp; {ZM}&nbsp; &nbsp; timezone minutes offset from UTC (no sign),<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; padded to 2 digits<br />::+<br />::+&nbsp; &nbsp; {ISOTS} YYYYMMDDThhmmss.fff+hhss<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Compressed ISO 8601 date/time (timestamp) with milliseconds<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; and time zone<br />::+<br />::+&nbsp; &nbsp; {ISODT} YYYYMMDD<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Compressed ISO 8601 date format<br />::+<br />::+&nbsp; &nbsp; {ISOTM} hhmmss.fff<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Compressed ISO 8601 time format with milliseconds<br />::+<br />::+&nbsp; &nbsp; {ISOTZ} +hhmm<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Compressed ISO 8601 timezone format<br />::+<br />::+&nbsp; &nbsp; {ISO-TS} YYYY-MM-DDThh:mm:ss.fff+hh:ss<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ISO 8601 date/time (timestamp) with milliseconds and time zone<br />::+<br />::+&nbsp; &nbsp; {ISO-DT} YYYY-MM-DD<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ISO 8601 date format<br />::+<br />::+&nbsp; &nbsp; {ISO-TM} hh:mm:ss.fff<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ISO 8601 time format with milliseconds<br />::+<br />::+&nbsp; &nbsp; {ISO-TZ} +hh:mm<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ISO 8601 timezone<br />::+<br />::+&nbsp; &nbsp; {U}&nbsp; &nbsp; &nbsp;Unix Epoch time: same as {US}<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Seconds since 1970-01-01 00:00:00 UTC.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Negative numbers represent dates prior to 1970-01-01.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This value should not be used with the -TZ option<br />::+<br />::+&nbsp; &nbsp; {UMS}&nbsp; &nbsp;Milliseconds since 1970-01-01 00:00:00.000 UTC.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Negative numbers represent days prior to 1970-01-01.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This value should not be used with the -TZ option<br />::+<br />::+&nbsp; &nbsp; {US}&nbsp; &nbsp; Seconds since 1970-01-01 00:00:00.000 UTC.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Negative numbers represent days prior to 1970-01-01.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This value should not be used with the -TZ option<br />::+<br />::+&nbsp; &nbsp; {UM}&nbsp; &nbsp; Minutes since 1970-01-01 00:00:00.000 UTC.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Negative numbers represent days prior to 1970-01-01.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This value should not be used with the -TZ option<br />::+<br />::+&nbsp; &nbsp; {UH}&nbsp; &nbsp; Hours since 1970-01-01 00:00:00.000 UTC.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Negative numbers represent days prior to 1970-01-01.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This value should not be used with the -TZ option<br />::+<br />::+&nbsp; &nbsp; {UD}&nbsp; &nbsp; Days since 1970-01-01 00:00:00.000 UTC.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Negative numbers represent days prior to 1970-01-01.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This value should not be used with the -TZ option<br />::+<br />::+&nbsp; &nbsp; {USD}&nbsp; &nbsp;Decimal seconds since 1970-01-01 00:00:00.000 UTC.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Negative numbers represent days prior to 1970-01-01.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This value should not be used with the -TZ option<br />::+<br />::+&nbsp; &nbsp; {UMD}&nbsp; &nbsp;Decimal minutes since 1970-01-01 00:00:00.000 UTC.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Negative numbers represent days prior to 1970-01-01.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This value should not be used with the -TZ option<br />::+<br />::+&nbsp; &nbsp; {UHD}&nbsp; &nbsp;Decimal hours since 1970-01-01 00:00:00.000 UTC.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Negative numbers represent days prior to 1970-01-01.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This value should not be used with the -TZ option<br />::+<br />::+&nbsp; &nbsp; {UDD}&nbsp; &nbsp;Decimal days since 1970-01-01 00:00:00.000 UTC.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Negative numbers represent days prior to 1970-01-01.<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This value should not be used with the -TZ option<br />::+<br />::+&nbsp; &nbsp; {{}&nbsp; &nbsp; &nbsp;A { character<br />::+<br />::+&nbsp; The following options override the default English names for the months<br />::+&nbsp; and days of the week. The value for each option is a space delimited list<br />::+&nbsp; of names or abbreviations.<br />::+<br />::+&nbsp; &nbsp; wkd: Day of week abbreviations<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;default = 'Sun Mon Tue Wed Thu Fri Sat'<br />::+<br />::+&nbsp; &nbsp; weekday: Day of week names<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;default = 'Sunday Monday Tuesday Wednesday Thursday Friday'<br />::+<br />::+&nbsp; &nbsp; mth: Month abbreviations<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;default = 'Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec'<br />::+<br />::+&nbsp; &nbsp; month: Month names<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;default = 'January February March April May Jun July August'<br />::+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+ ' September October November December'<br />::+<br />============= :Batch portion ============<br />@echo off<br />setlocal disableDelayedExpansion<br /><br />if .%2 equ . (<br />&nbsp; set &quot;test=%~1&quot;<br />&nbsp; setlocal enableDelayedExpansion<br />&nbsp; if &quot;!test:~0,1!&quot; equ &quot;-&quot; set &quot;test=/!test:~1!&quot;<br />&nbsp; if &quot;!test!&quot; equ &quot;/?&quot; (<br />&nbsp; &nbsp; for /f &quot;tokens=* delims=:&quot; %%A in ('findstr &quot;^:::&quot; &quot;%~f0&quot;') do @echo(%%A<br />&nbsp; &nbsp; exit /b 0<br />&nbsp; ) else if &quot;!test!&quot; equ &quot;/??&quot; 2&gt;nul (<br />&nbsp; &nbsp; (for /f &quot;tokens=* delims=:&quot; %%A in ('findstr &quot;^:::&quot; &quot;%~f0&quot;') do @echo(%%A)|more /e<br />&nbsp; &nbsp; exit /b 0<br />&nbsp; ) else if /i &quot;!test!&quot; equ &quot;/?ts()&quot; (<br />&nbsp; &nbsp; for /f &quot;tokens=* delims=:+&quot; %%A in ('findstr &quot;^::+&quot; &quot;%~f0&quot;') do @echo(%%A<br />&nbsp; &nbsp; exit /b 0<br />&nbsp; ) else if /i &quot;!test!&quot; equ &quot;/??ts()&quot; 2&gt;nul (<br />&nbsp; &nbsp; (for /f &quot;tokens=* delims=:+&quot; %%A in ('findstr &quot;^::+&quot; &quot;%~f0&quot;') do @echo(%%A)|more /e<br />&nbsp; &nbsp; exit /b 0<br />&nbsp; ) else if /i &quot;!test!&quot; equ &quot;/?regex&quot; (<br />&nbsp; &nbsp; explorer &quot;http://msdn.microsoft.com/en-us/library/ae5bf541(v=vs.80).aspx&quot;<br />&nbsp; &nbsp; exit /b 0<br />&nbsp; ) else if /i &quot;!test!&quot; equ &quot;/?replace&quot; (<br />&nbsp; &nbsp; explorer &quot;http://msdn.microsoft.com/en-US/library/efy6s3e6(v=vs.80).aspx&quot;<br />&nbsp; &nbsp; exit /b 0<br />&nbsp; ) else if /i &quot;!test!&quot; equ &quot;/?version&quot; (<br />&nbsp; &nbsp; for /f &quot;tokens=* delims=:&quot; %%A in ('findstr &quot;^::JREN\.BAT&quot; &quot;%~f0&quot;') do @echo(%%A<br />&nbsp; &nbsp; exit /b 0<br />&nbsp; ) else (<br />&nbsp; &nbsp; call :err &quot;Insufficient arguments&quot;<br />&nbsp; &nbsp; exit /b 2<br />&nbsp; )<br />)<br /><br />:: Define options<br />set &quot;options= /D: /FM:&quot;&quot; /FX:&quot;&quot; /I: /J: /L: /LIST: /NBEG:1 /NINC:1 /NPAD:3 /P:. /PM:&quot;&quot; /PX:&quot;&quot; /RFM:&quot;&quot; /RFX:&quot;&quot; /RPM:&quot;&quot; /RPX:&quot;&quot; /Q: /S: /T: /U: &quot;<br /><br />:: Set default option values<br />for %%O in (%options%) do for /f &quot;tokens=1,* delims=:&quot; %%A in (&quot;%%O&quot;) do set &quot;%%A=%%~B&quot;<br /><br />:: Get options<br />:loop<br />if not &quot;%~3&quot;==&quot;&quot; (<br />&nbsp; set &quot;test=%~3&quot;<br />&nbsp; setlocal enableDelayedExpansion<br />&nbsp; if &quot;!test:~0,1!&quot; equ &quot;-&quot; set &quot;test=/!test:~1!&quot;<br />&nbsp; if &quot;!test:~0,1!&quot; neq &quot;/&quot; (<br />&nbsp; &nbsp; call :err &quot;Too many arguments&quot;<br />&nbsp; &nbsp; exit /b 2<br />&nbsp; )<br />&nbsp; for /f &quot;delims=&quot; %%A in (&quot;!test!&quot;) do (<br />&nbsp; &nbsp; set &quot;test=!options:*%%A:=! &quot;<br />&nbsp; &nbsp; if &quot;!test!&quot;==&quot;!options! &quot; (<br />&nbsp; &nbsp; &nbsp; &nbsp; endlocal<br />&nbsp; &nbsp; &nbsp; &nbsp; call :err &quot;Invalid option %~3&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; exit /b 2<br />&nbsp; &nbsp; ) else if &quot;!test:~0,1!&quot;==&quot; &quot; (<br />&nbsp; &nbsp; &nbsp; &nbsp; endlocal<br />&nbsp; &nbsp; &nbsp; &nbsp; set &quot;%%A=1&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; if /i &quot;%%A&quot; equ &quot;/L&quot; set &quot;/U=&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; if /i &quot;%%A&quot; equ &quot;/U&quot; set &quot;/L=&quot;<br />&nbsp; &nbsp; ) else (<br />&nbsp; &nbsp; &nbsp; &nbsp; endlocal<br />&nbsp; &nbsp; &nbsp; &nbsp; if %4. equ . (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call :err &quot;Missing %~3 value&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit /b 2<br />&nbsp; &nbsp; &nbsp; &nbsp; )<br />&nbsp; &nbsp; &nbsp; &nbsp; set &quot;%%A=%~4&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; shift /3<br />&nbsp; &nbsp; )<br />&nbsp; )<br />&nbsp; shift /3<br />&nbsp; goto :loop<br />)<br /><br />:: Execute<br />cscript //E:JScript //nologo &quot;%~f0&quot; %1 %2<br />exit /b %errorlevel%<br /><br />:err<br />&gt;&amp;2 (<br />&nbsp; echo ERROR: %~1<br />)<br />exit /b<br /><br />************* JScript portion **********/<br />var $n<br />var _g=new Object();<br />try {<br /><br />&nbsp; _g.defineReplFunc=function() {<br />&nbsp; &nbsp; eval(_g.replFunc);<br />&nbsp; }<br /><br />&nbsp; _g.main=function() {<br /><br />&nbsp; &nbsp; function err( msg, rtn ) {<br />&nbsp; &nbsp; &nbsp; WScript.StdErr.WriteLine(msg);<br />&nbsp; &nbsp; &nbsp; if (rtn) WScript.Quit(rtn);<br />&nbsp; &nbsp; }<br /><br />&nbsp; &nbsp; function BuildRegex( loc, regex, options ) {<br />&nbsp; &nbsp; &nbsp; try {<br />&nbsp; &nbsp; &nbsp; &nbsp; return regex ? new RegExp( regex, options ) : false;<br />&nbsp; &nbsp; &nbsp; } catch(e) {<br />&nbsp; &nbsp; &nbsp; &nbsp; err( 'Invalid '+loc+' regular expression: '+e.message, 1);<br />&nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; }<br /><br />&nbsp; &nbsp; function GetInt( loc, numStr, minVal ) {<br />&nbsp; &nbsp; &nbsp; var n = parseInt( numStr );<br />&nbsp; &nbsp; &nbsp; if (isNaN(n) || n&lt;minVal) {<br />&nbsp; &nbsp; &nbsp; &nbsp; err( 'Error: Invalid '+loc+' value', 1 );<br />&nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; return n;<br />&nbsp; &nbsp; }<br /><br />&nbsp; &nbsp; var env = WScript.CreateObject(&quot;WScript.Shell&quot;).Environment(&quot;Process&quot;),<br />&nbsp; &nbsp; &nbsp; &nbsp; fso = new ActiveXObject(&quot;Scripting.FileSystemObject&quot;);<br /><br />&nbsp; &nbsp; try {<br />&nbsp; &nbsp; &nbsp; var root = fso.GetFolder( env('/P') );<br />&nbsp; &nbsp; } catch(e) {<br />&nbsp; &nbsp; &nbsp; err( 'Invalid /P path: '+e.message, 1 );<br />&nbsp; &nbsp; }<br /><br />&nbsp; &nbsp; function MaskRepl($0) {<br />&nbsp; &nbsp; &nbsp; switch ($0) {<br />&nbsp; &nbsp; &nbsp; &nbsp; case '/P:':<br />&nbsp; &nbsp; &nbsp; &nbsp; case '/p:': return root.Path.replace(/&#91;.^$*+?()&#91;{\\|&#93;/g,&quot;\\$&amp;&quot;);<br />&nbsp; &nbsp; &nbsp; &nbsp; case '**':&nbsp; return '.*';<br />&nbsp; &nbsp; &nbsp; &nbsp; case '*':&nbsp; &nbsp;return '&#91;^\\\\&#93;*';<br />&nbsp; &nbsp; &nbsp; &nbsp; case '?':&nbsp; &nbsp;return '&#91;^\\\\.&#93;?';<br />&nbsp; &nbsp; &nbsp; &nbsp; default:&nbsp; &nbsp; return '\\'+$0;<br />&nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; }<br /><br />&nbsp; &nbsp; var args=WScript.Arguments,<br />&nbsp; &nbsp; &nbsp; &nbsp; search = BuildRegex( 'Search', args.Item(0), env('/I')?'gi':'g' ),<br />&nbsp; &nbsp; &nbsp; &nbsp; replace=args.Item(1),<br />&nbsp; &nbsp; &nbsp; &nbsp; rMask = BuildRegex( '/RFM', env('/RFM'), 'i' ),<br />&nbsp; &nbsp; &nbsp; &nbsp; rExclude = BuildRegex( '/RFX', env('/RFX'), 'i' ),<br />&nbsp; &nbsp; &nbsp; &nbsp; rPathMask = BuildRegex( '/RPM', env('/RPM'), 'i' ),<br />&nbsp; &nbsp; &nbsp; &nbsp; rPathExclude = BuildRegex( '/RPX', env('/RPX'), 'i' ),<br />&nbsp; &nbsp; &nbsp; &nbsp; regex = new RegExp(&quot;/P:|&#91;*&#93;&#91;*&#93;|&#91;*&#93;|&#91;?&#93;|&#91;.^$+()&#91;{\\\\&#93;&quot;,&quot;ig&quot;);<br />&nbsp; &nbsp; &nbsp; &nbsp; mask = env('/FM') ? new RegExp( '^(?:' + env('/FM').replace(regex,MaskRepl) + ')$', 'i' ) : false;<br />&nbsp; &nbsp; &nbsp; &nbsp; exclude = env('/FX') ? new RegExp( '^(?:' + env('/FX').replace(regex,MaskRepl) + ')$', 'i' ) : false;<br />&nbsp; &nbsp; &nbsp; &nbsp; pathMask = env('/PM') ? new RegExp( '^(?:' + env('/PM').replace(regex,MaskRepl) + ')$', 'i' ) : false;<br />&nbsp; &nbsp; &nbsp; &nbsp; pathExclude = env('/PX') ? new RegExp( '^(?:' + env('/PX').replace(regex,MaskRepl) + ')$', 'i' ) : false;<br />&nbsp; &nbsp; &nbsp; &nbsp; upper = env('/U'),<br />&nbsp; &nbsp; &nbsp; &nbsp; lower = env('/L'),<br />&nbsp; &nbsp; &nbsp; &nbsp; recurse = env('/S'),<br />&nbsp; &nbsp; &nbsp; &nbsp; jscript = env('/J'),<br />&nbsp; &nbsp; &nbsp; &nbsp; list = env('/LIST'),<br />&nbsp; &nbsp; &nbsp; &nbsp; beg = GetInt( '/NBEG', env('/NBEG'), 0 ),<br />&nbsp; &nbsp; &nbsp; &nbsp; inc = GetInt( '/NINC', env('/NINC'), 1 ),<br />&nbsp; &nbsp; &nbsp; &nbsp; pad = GetInt( '/NPAD', env('/NPAD'), 1 ),<br />&nbsp; &nbsp; &nbsp; &nbsp; padStr = Array( pad+1 ).join('0'),<br />&nbsp; &nbsp; &nbsp; &nbsp; test = env('/T'),<br />&nbsp; &nbsp; &nbsp; &nbsp; quiet = env('/Q');<br /><br />&nbsp; &nbsp; _g.dirs = env('/D');<br /><br />&nbsp; &nbsp; function ProcessFolder( folder ) {<br />&nbsp; &nbsp; &nbsp; var i, a=&#91;&#93;;<br />&nbsp; &nbsp; &nbsp; var num = beg;<br />&nbsp; &nbsp; &nbsp; if (recurse || _g.dirs) {<br />&nbsp; &nbsp; &nbsp; &nbsp; var folders = new Enumerator(folder.SubFolders);<br />&nbsp; &nbsp; &nbsp; &nbsp; for( i=0 ; !folders.atEnd(); folders.moveNext()) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; a&#91;i++&#93;=folders.item()<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (recurse) ProcessFolder(folders.item());<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; if ( (!pathMask || pathMask.test(folder.Path)) &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(!rPathMask || rPathMask.test(folder.Path)) &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(!pathExclude || !pathExclude.test(folder.Path)) &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(!rPathExclude || !rPathExclude.test(folder.Path)) ) {<br />&nbsp; &nbsp; &nbsp; &nbsp; if (!_g.dirs) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; a=&#91;&#93;;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var files = new Enumerator(folder.Files);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for (i=0; !files.atEnd(); files.moveNext()) a&#91;i++&#93;=files.item();<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; for (i=0; i&lt;a.length; i++) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; _g.file = a&#91;i&#93;;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; _g.wmiFile = undefined;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var oldName = a&#91;i&#93;.Name;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ( (!mask || mask.test(oldName)) &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(!rMask || rMask.test(oldName)) &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(!exclude || !exclude.test(oldName)) &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(!rExclude || !rExclude.test(oldName)) ) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (jscript) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $n = num.toString();<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ($n.length&lt;pad) $n = (padStr+$n).slice(-pad);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; try {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var newName = oldName.replace( search, replace );<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } catch(e) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; err( 'Replace error: '+e.message, 1 );<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!list) newName=newName.replace( /&#91; .&#93;+$/, &quot;&quot; );<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (jscript &amp;&amp; !list &amp;&amp; newName.search(/&#91;&lt;&gt;|:/\\*?&quot;\x00-\x1F&#93;/)&gt;=0) err('Error: Invalid file name character in Replace',1);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (upper) newName = uc(newName);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (lower) newName = lc(newName);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (newName != oldName || list) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; try {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var oldPath=a&#91;i&#93;.Path;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!test &amp;&amp; !list) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (a&#91;i&#93;.Name.toUpperCase() == newName.toUpperCase()) a&#91;i&#93;.Name = '_{JREN_tempName}_';<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; a&#91;i&#93;.Name = newName;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (list) WScript.echo(newName);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else if (!quiet) WScript.echo( '&quot;'+oldPath+'&quot;&nbsp; --&gt;&nbsp; &quot;'+newName+'&quot;' );<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } catch(e) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (a&#91;i&#93;.Name != oldName) a&#91;i&#93;.Name = oldName;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; err( 'Unable to rename &quot;'+a&#91;i&#93;.Path+'&quot;&nbsp; --&gt;&nbsp; &quot;'+newName+'&quot; : &quot;'+e.message, 0 );<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; num+=inc;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; }<br /><br />&nbsp; &nbsp; if (jscript) {<br />&nbsp; &nbsp; &nbsp; var regex=new RegExp('.|'+search,''),<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cnt;<br />&nbsp; &nbsp; &nbsp; 'x'.replace( regex, function(){cnt=arguments.length-2; return '';} );<br />&nbsp; &nbsp; &nbsp; _g.replFunc='_g.replFunc=function($0';<br />&nbsp; &nbsp; &nbsp; for (var i=1; i&lt;cnt; i++) _g.replFunc+=',$'+i;<br />&nbsp; &nbsp; &nbsp; _g.replFunc+=',$off,$src){return eval(_g.replace);}';<br />&nbsp; &nbsp; &nbsp; _g.defineReplFunc();<br />&nbsp; &nbsp; &nbsp; _g.replace = replace;<br />&nbsp; &nbsp; &nbsp; replace = _g.replFunc;<br />&nbsp; &nbsp; } else if (!list &amp;&amp; replace.search(/&#91;&lt;&gt;|:/\\*?&quot;\x00-\x1F&#93;/)&gt;=0) err('Error: Invalid file name character in Replace',1);<br /><br />&nbsp; &nbsp; ProcessFolder( root );<br />&nbsp; &nbsp; WScript.Quit(0);<br />&nbsp; }<br /><br />&nbsp; _g.main();<br /><br />} catch(e) {<br />&nbsp; WScript.StdErr.WriteLine(&quot;JScript runtime error: &quot;+e.message);<br />&nbsp; WScript.Quit(1);<br />}<br /><br />function lc(str) { return str.toLowerCase(); }<br /><br />function uc(str) { return str.toUpperCase(); }<br /><br />function lpad( val, pad ) {<br />&nbsp; if (!pad) pad='';<br />&nbsp; var rtn=val.toString();<br />&nbsp; return (rtn.length&lt;pad.length) ? (pad+rtn).slice(-pad.length) : val;<br />}<br /><br />function rpad( val, pad ) {<br />&nbsp; if (!pad) pad='';<br />&nbsp; var rtn=val.toString();<br />&nbsp; return (rtn.length&lt;pad.length) ? (rtn+pad).slice(0,pad.length) : val;<br />}<br /><br />function ts(opt) {<br />&nbsp; if (opt===undefined) opt={};<br />&nbsp; if (opt.constructor !== Object) badOp('ts()');<br />&nbsp; if (!opt.wkd)&nbsp; &nbsp; &nbsp;opt.wkd='Sun Mon Tue Wed Thu Fri Sat';<br />&nbsp; if (!opt.weekday) opt.weekday='Sunday Monday Tuesday Wednesday Thursday Friday Saturday';<br />&nbsp; if (!opt.mth)&nbsp; &nbsp; &nbsp;opt.mth='Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec';<br />&nbsp; if (!opt.month)&nbsp; &nbsp;opt.month='January February March April May June July August September October November December';<br />&nbsp; if (!opt.fmt)&nbsp; &nbsp; &nbsp;opt.fmt='{isots}';<br /><br />&nbsp; var wkd&nbsp; &nbsp; &nbsp;= opt.wkd.split(' '),<br />&nbsp; &nbsp; &nbsp; weekday = opt.weekday.split(' '),<br />&nbsp; &nbsp; &nbsp; mth&nbsp; &nbsp; &nbsp;= opt.mth.split(' '),<br />&nbsp; &nbsp; &nbsp; month&nbsp; &nbsp;= opt.month.split(' '),<br />&nbsp; &nbsp; &nbsp; y,m,d,w,h,h12,n,s,f,u,z,zs,za, dt,<br />&nbsp; &nbsp; &nbsp; sp=' ', ps='/', pc=':', pd='-', pp='.', p2='00', p3='000', p4='0000';<br />&nbsp; if (wkd.length!=7)&nbsp; &nbsp; &nbsp;badOp('wkd');<br />&nbsp; if (weekday.length!=7) badOp('weekday');<br />&nbsp; if (mth.length!=12)&nbsp; &nbsp; badOp('mth');<br />&nbsp; if (month.length!=12)&nbsp; badOp('month');<br /><br />&nbsp; dt = getDt(opt.dt);<br />&nbsp; if (opt.oy) dt.setUTCFullYear(&nbsp; &nbsp; &nbsp;dt.getUTCFullYear()&nbsp; &nbsp; +getNum('oy'));<br />&nbsp; if (opt.om) dt.setUTCMonth(&nbsp; &nbsp; &nbsp; &nbsp; dt.getUTCMonth()&nbsp; &nbsp; &nbsp; &nbsp;+getNum('om'));<br />&nbsp; if (opt.od) dt.setUTCDate(&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dt.getUTCDate()&nbsp; &nbsp; &nbsp; &nbsp; +getNum('od'));<br />&nbsp; if (opt.oh) dt.setUTCHours(&nbsp; &nbsp; &nbsp; &nbsp; dt.getUTCHours()&nbsp; &nbsp; &nbsp; &nbsp;+getNum('oh'));<br />&nbsp; if (opt.on) dt.setUTCMinutes(&nbsp; &nbsp; &nbsp; dt.getUTCMinutes()&nbsp; &nbsp; &nbsp;+getNum('on'));<br />&nbsp; if (opt.os) dt.setUTCSeconds(&nbsp; &nbsp; &nbsp; dt.getUTCSeconds()&nbsp; &nbsp; &nbsp;+getNum('os'));<br />&nbsp; if (opt.of) dt.setUTCMilliseconds( dt.getUTCMilliseconds()+getNum('of'));<br />&nbsp; if (opt.tz!==undefined) dt.setUTCMinutes(&nbsp; &nbsp; &nbsp; dt.getUTCMinutes()&nbsp; +(z=getNum('tz')));<br /><br />&nbsp; if (opt.olm) dt.setMonth(&nbsp; &nbsp; &nbsp; &nbsp; dt.getMonth()&nbsp; &nbsp; &nbsp; &nbsp;+getNum('olm'));<br />&nbsp; if (opt.old) dt.setDate(&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dt.getDate()&nbsp; &nbsp; &nbsp; &nbsp; +getNum('old'));<br /><br />&nbsp; y = opt.tz!==undefined ? dt.getUTCFullYear(): dt.getFullYear();<br />&nbsp; m = opt.tz!==undefined ? dt.getUTCMonth()&nbsp; &nbsp;: dt.getMonth();<br />&nbsp; d = opt.tz!==undefined ? dt.getUTCDate()&nbsp; &nbsp; : dt.getDate();<br />&nbsp; w = opt.tz!==undefined ? dt.getUTCDay()&nbsp; &nbsp; &nbsp;: dt.getDay();<br />&nbsp; h = opt.tz!==undefined ? dt.getUTCHours()&nbsp; &nbsp;: dt.getHours();<br />&nbsp; n = opt.tz!==undefined ? dt.getUTCMinutes() : dt.getMinutes();<br />&nbsp; s = opt.tz!==undefined ? dt.getUTCSeconds() : dt.getSeconds();<br />&nbsp; f = opt.tz!==undefined ? dt.getUTCMilliseconds() : dt.getMilliseconds();<br />&nbsp; u = dt.getTime();<br /><br />&nbsp; h12 = h%12;<br />&nbsp; if (!h12) h12=12;<br /><br />&nbsp; if (opt.tz==undefined) z=-dt.getTimezoneOffset();<br />&nbsp; zs = z&lt;0 ? '-' : '+';<br />&nbsp; za = Math.abs(z);<br /><br />&nbsp; return opt.fmt.replace( /\{(.*?)\}/gi, repl );<br /><br />&nbsp; function getNum( v ) {<br />&nbsp; &nbsp; var rtn = Number(opt&#91;v&#93;);<br />&nbsp; &nbsp; if (isNaN(rtn-rtn)) badOp(v);<br />&nbsp; &nbsp; return rtn;<br />&nbsp; }<br /><br />&nbsp; function getDt( v ) {<br />&nbsp; &nbsp; var dt, n;<br />&nbsp; &nbsp; if (v===undefined) {<br />&nbsp; &nbsp; &nbsp; dt = new Date();<br />&nbsp; &nbsp; } else switch (v.constructor) {<br />&nbsp; &nbsp; &nbsp; case Date:<br />&nbsp; &nbsp; &nbsp; case Number:<br />&nbsp; &nbsp; &nbsp; &nbsp; dt = new Date(v);<br />&nbsp; &nbsp; &nbsp; &nbsp; break;<br />&nbsp; &nbsp; &nbsp; case Array:<br />&nbsp; &nbsp; &nbsp; &nbsp; try {dt=eval( 'new Date('+v.join(',')+')' )} catch(e){}<br />&nbsp; &nbsp; &nbsp; &nbsp; break;<br />&nbsp; &nbsp; &nbsp; case String:<br />&nbsp; &nbsp; &nbsp; &nbsp; switch (v.toLowerCase()) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case '':&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dt = new Date(); break;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case 'created':&nbsp; dt = getWmiDt('c'); break;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case 'modified': dt = getWmiDt('m'); break;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case 'accessed': dt = getWmiDt('a'); break;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case 'fsocreated':&nbsp; dt = new Date(_g.file.DateCreated); break;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case 'fsomodified': dt = new Date(_g.file.DateLastModified); break;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case 'fsoaccessed': dt = new Date(_g.file.DateLastAccessed); break;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; default:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; n=Number(v);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (isNaN(n-n)) dt = new Date(v);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt = new Date(n);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; break;<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; if (isNaN(dt)) badOp('dt');<br />&nbsp; &nbsp; return dt;<br />&nbsp; }<br />&nbsp;<br />&nbsp; function badOp(option) {<br />&nbsp; &nbsp; throw new Error('Invalid '+option+' value');<br />&nbsp; }<br /><br />&nbsp; function trunc( n ) { return Math&#91;n&gt;0?&quot;floor&quot;:&quot;ceil&quot;&#93;(n); }<br />&nbsp;<br />&nbsp; function repl($0,$1) {<br />&nbsp; &nbsp; switch ($1.toUpperCase()) {<br />&nbsp; &nbsp; &nbsp; case 'YYYY' : return lpad(y,p4);<br />&nbsp; &nbsp; &nbsp; case 'YY'&nbsp; &nbsp;: return (p2+y.toString()).slice(-2);<br />&nbsp; &nbsp; &nbsp; case 'Y'&nbsp; &nbsp; : return y.toString();<br />&nbsp; &nbsp; &nbsp; case 'MM'&nbsp; &nbsp;: return lpad(m+1,p2);<br />&nbsp; &nbsp; &nbsp; case 'M'&nbsp; &nbsp; : return (m+1).toString();<br />&nbsp; &nbsp; &nbsp; case 'DD'&nbsp; &nbsp;: return lpad(d,p2);<br />&nbsp; &nbsp; &nbsp; case 'D'&nbsp; &nbsp; : return d.toString();<br />&nbsp; &nbsp; &nbsp; case 'W'&nbsp; &nbsp; : return w.toString();<br />&nbsp; &nbsp; &nbsp; case 'HH'&nbsp; &nbsp;: return lpad(h,p2);<br />&nbsp; &nbsp; &nbsp; case 'H'&nbsp; &nbsp; : return h.toString();<br />&nbsp; &nbsp; &nbsp; case 'HH12' : return lpad(h12,p2);<br />&nbsp; &nbsp; &nbsp; case 'H12'&nbsp; : return h12.toString();<br />&nbsp; &nbsp; &nbsp; case 'NN'&nbsp; &nbsp;: return lpad(n,p2);<br />&nbsp; &nbsp; &nbsp; case 'N'&nbsp; &nbsp; : return n.toString();<br />&nbsp; &nbsp; &nbsp; case 'SS'&nbsp; &nbsp;: return lpad(s,p2);<br />&nbsp; &nbsp; &nbsp; case 'S'&nbsp; &nbsp; : return s.toString();<br />&nbsp; &nbsp; &nbsp; case 'FFF'&nbsp; : return lpad(f,p3);<br />&nbsp; &nbsp; &nbsp; case 'F'&nbsp; &nbsp; : return f.toString();<br />&nbsp; &nbsp; &nbsp; case 'AM'&nbsp; &nbsp;: return h&gt;=12 ? 'PM' : 'AM';<br />&nbsp; &nbsp; &nbsp; case 'PM'&nbsp; &nbsp;: return h&gt;=12 ? 'pm' : 'am';<br />&nbsp; &nbsp; &nbsp; case 'UMS'&nbsp; : return u.toString();<br />&nbsp; &nbsp; &nbsp; case 'USD'&nbsp; : return (u/1000).toString();<br />&nbsp; &nbsp; &nbsp; case 'UMD'&nbsp; : return (u/1000/60).toString();<br />&nbsp; &nbsp; &nbsp; case 'UHD'&nbsp; : return (u/1000/60/60).toString();<br />&nbsp; &nbsp; &nbsp; case 'UDD'&nbsp; : return (u/1000/60/60/24).toString();<br />&nbsp; &nbsp; &nbsp; case 'U'&nbsp; &nbsp; : return trunc(u/1000).toString();<br />&nbsp; &nbsp; &nbsp; case 'US'&nbsp; &nbsp;: return trunc(u/1000).toString();<br />&nbsp; &nbsp; &nbsp; case 'UM'&nbsp; &nbsp;: return trunc(u/1000/60).toString();<br />&nbsp; &nbsp; &nbsp; case 'UH'&nbsp; &nbsp;: return trunc(u/1000/60/60).toString();<br />&nbsp; &nbsp; &nbsp; case 'UD'&nbsp; &nbsp;: return trunc(u/1000/60/60/24).toString();<br />&nbsp; &nbsp; &nbsp; case 'ZZZZ' : return zs+lpad(za,p3);<br />&nbsp; &nbsp; &nbsp; case 'Z'&nbsp; &nbsp; : return z.toString();<br />&nbsp; &nbsp; &nbsp; case 'ZS'&nbsp; &nbsp;: return zs;<br />&nbsp; &nbsp; &nbsp; case 'ZH'&nbsp; &nbsp;: return lpad(trunc(za/60),p2);<br />&nbsp; &nbsp; &nbsp; case 'ZM'&nbsp; &nbsp;: return lpad(za%60,p2);<br />&nbsp; &nbsp; &nbsp; case 'ISOTS'&nbsp; : return ''+lpad(y,p4)+lpad(m+1,p2)+lpad(d,p2)+'T'+lpad(h,p2)+lpad(n,p2)+lpad(s,p2)+pp+lpad(f,p3)+zs+lpad(trunc(za/60),p2)+lpad(za%60,p2);<br />&nbsp; &nbsp; &nbsp; case 'ISODT'&nbsp; : return ''+lpad(y,p4)+lpad(m+1,p2)+lpad(d,p2);<br />&nbsp; &nbsp; &nbsp; case 'ISOTM'&nbsp; : return ''+lpad(h,p2)+lpad(n,p2)+lpad(s,p2)+pp+lpad(f,p3);<br />&nbsp; &nbsp; &nbsp; case 'ISOTZ'&nbsp; : return ''+zs+lpad(trunc(za/60),p2)+lpad(za%60,p2);<br />&nbsp; &nbsp; &nbsp; case 'ISO-TS' : return ''+lpad(y,p4)+pd+lpad(m+1,p2)+pd+lpad(d,p2)+'T'+lpad(h,p2)+pc+lpad(n,p2)+pc+lpad(s,p2)+pp+lpad(f,p3)+zs+lpad(trunc(za/60),p2)+pc+lpad(za%60,p2);<br />&nbsp; &nbsp; &nbsp; case 'ISO-DT' : return ''+lpad(y,p4)+pd+lpad(m+1,p2)+pd+lpad(d,p2);<br />&nbsp; &nbsp; &nbsp; case 'ISO-TM' : return ''+lpad(h,p2)+pc+lpad(n,p2)+pc+lpad(s,p2)+pp+lpad(f,p3);<br />&nbsp; &nbsp; &nbsp; case 'ISO-TZ' : return ''+zs+lpad(trunc(za/60),p2)+pc+lpad(za%60,p2);<br />&nbsp; &nbsp; &nbsp; case 'WEEKDAY': return weekday&#91;w&#93;;<br />&nbsp; &nbsp; &nbsp; case 'WKD'&nbsp; &nbsp; : return wkd&#91;w&#93;;<br />&nbsp; &nbsp; &nbsp; case 'MONTH'&nbsp; : return month&#91;m&#93;;<br />&nbsp; &nbsp; &nbsp; case 'MTH'&nbsp; &nbsp; : return mth&#91;m&#93;;<br />&nbsp; &nbsp; &nbsp; case '{'&nbsp; &nbsp; &nbsp; : return $1;<br />&nbsp; &nbsp; &nbsp; default&nbsp; &nbsp; &nbsp; &nbsp;: return $0;<br />&nbsp; &nbsp; }<br />&nbsp; }<br /><br />&nbsp; function getWmiDt( prop ) {<br />&nbsp; &nbsp; if (_g.wmi===undefined) {<br />&nbsp; &nbsp; &nbsp; var svcLoc = new ActiveXObject(&quot;WbemScripting.SWbemLocator&quot;);<br />&nbsp; &nbsp; &nbsp; _g.wmi = svcLoc.ConnectServer(&quot;.&quot;, &quot;root\\cimv2&quot;);<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; if (_g.wmiFile===undefined) {<br />&nbsp; &nbsp; &nbsp; _g.wmiFile = new Enumerator(_g.wmi.ExecQuery(<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;Select * From &quot;+(_g.dirs?&quot;Win32_Directory&quot;:&quot;Cim_DataFile&quot;)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+&quot; Where Name = '&quot;+_g.file.Path.replace(/\\/g,&quot;\\\\&quot;).replace(/'/g,&quot;\\'&quot;)+&quot;'&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )).item();<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; var wmiDt;<br />&nbsp; &nbsp; switch (prop.toLowerCase()) {<br />&nbsp; &nbsp; &nbsp; case 'c': wmiDt=_g.wmiFile.CreationDate; break;<br />&nbsp; &nbsp; &nbsp; case 'm': wmiDt=_g.wmiFile.LastModified; break;<br />&nbsp; &nbsp; &nbsp; case 'a': wmiDt=_g.wmiFile.LastAccessed; break;<br />&nbsp; &nbsp; &nbsp; default: return undefined;<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; var tz=Number(wmiDt.substr(22));<br />&nbsp; &nbsp; var dt = new Date(&nbsp; &nbsp; &nbsp;wmiDt.substr(0,4)+ps+wmiDt.substr(4,2)+ps+wmiDt.substr(6,2)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+sp+wmiDt.substr(8,2)+pc+wmiDt.substr(10,2)+pc+wmiDt.substr(12,2)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+sp+wmiDt.substr(21,1)+lpad(trunc(tz/60),p2)+lpad(tz%60,p2)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;);<br />&nbsp; &nbsp; dt.setMilliseconds(Number(wmiDt.substr(15,3)));<br />&nbsp; &nbsp; return dt;<br />&nbsp; }<br /><br />}<br /><br />function attr(off) {<br />&nbsp; var a=_g.file.Attributes;<br />&nbsp; var o=off?off.substr(0,1):'';<br />&nbsp; return&nbsp; (a&amp;1&nbsp; &nbsp;?'R':o?o:'r')&nbsp; //Read only<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+(a&amp;2&nbsp; &nbsp;?'H':o?o:'h')&nbsp; //Hidden<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+(a&amp;4&nbsp; &nbsp;?'S':o?o:'s')&nbsp; //System<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+(a&amp;32&nbsp; ?'A':o?o:'a')&nbsp; //Archive<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+(a&amp;1024?'L':o?o:'l')&nbsp; //Link or Shortcut<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+(a&amp;2048?'C':o?o:'c'); //Compressed<br />}<br /><br />function size(pad) {return lpad(_g.file.Size,pad);}<br /><br />function type(pad) {return rpad(_g.file.Type,pad);}<br /><br />function path(pad) {return rpad(_g.file.Path,pad);}<br /><br />function parent(pad) {return rpad(_g.file.ParentFolder.Path,pad);}<br /><br />function name(pad) {return rpad(_g.file.Name,pad);}<br /><br />function sPath(pad) {return rpad(_g.file.ShortPath,pad);}<br /><br />function sParent(pad) {return rpad(_g.file.ParentFolder.ShortPath,pad);}<br /><br />function sName(pad) {return rpad(_g.file.ShortName,pad);}<br /></code></pre></div><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p49861" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile49861">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist2675.html?mode=viewprofile&amp;u=2988" style="color: #00AA00;" class="username-coloured">Squashman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1322.html?author_id=2988&amp;sr=posts">3970</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 Dec 2011 13:59</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content49861">

						<h3 ><a href="#p49861">Re: JREN.BAT - Rename files/folders using regular expressions</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting26ed.html?mode=quote&amp;f=3&amp;p=49861" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic4b29.html?p=49861#p49861" onclick="prompt('Message #25',this.href); return false;">#25</a></span> 
									<a class="unread" href="viewtopic4b29.html?p=49861#p49861" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist2675.html?mode=viewprofile&amp;u=2988" style="color: #00AA00;" class="username-coloured">Squashman</a></strong> &raquo; </span>26 Oct 2016 10:07
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>dbenham wrote:</cite>Version 2.7 fixes a ts() bug - it failed to return UTC time when setting time zone to 0 (tz:0)<br /></div></blockquote><br />As punishment you get a time out!  <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" />  <img class="smilies" src="images/smilies/icon_lol.gif" alt=":lol:" title="Laughing" /></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50539" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile50539">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist413a.html?mode=viewprofile&amp;u=8547" class="username">crazyroot</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search5630.html?author_id=8547&amp;sr=posts">13</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 14 Dec 2016 19:44</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content50539">

						<h3 ><a href="#p50539">Re: JREN.BAT - Rename files/folders using regular expressions</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting055a.html?mode=quote&amp;f=3&amp;p=50539" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic1821.html?p=50539#p50539" onclick="prompt('Message #26',this.href); return false;">#26</a></span> 
									<a class="unread" href="viewtopic1821.html?p=50539#p50539" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist413a.html?mode=viewprofile&amp;u=8547" class="username">crazyroot</a></strong> &raquo; </span>14 Dec 2016 19:53
			</p>
			
			
			
			<div class="content">Hi Dave,<br /><br />I like very much JREN, thank you for this beautiful work !<br /><br />Could you please explain me if it's possible to get simply $n (incrementing number for use in the name) not to be reset for each directory ?<br />I'm not very used to DOS' for loop so I didn't find a quick solution in case you have one ?<br />Thank you !!!<br />Cheers<br /><br />EDIT : I have a bonus question as I noticed that jren with $n searches regular expression not ordered by name like 'dir /on ' for instance, so that the $n incrmenting doesn't follow alphabetical order : is there an argument or a quick solution to force alphabetical order for $n incrementing ?</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50551" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile50551">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content50551">

						<h3 ><a href="#p50551">Re: JREN.BAT - Rename files/folders using regular expressions</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingd518.html?mode=quote&amp;f=3&amp;p=50551" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic7736.html?p=50551#p50551" onclick="prompt('Message #27',this.href); return false;">#27</a></span> 
									<a class="unread" href="viewtopic7736.html?p=50551#p50551" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>15 Dec 2016 22:13
			</p>
			
			
			
			<div class="content">Well that was an easy mod <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /> <br /><br />There was no way to prevent version 2.6 from resetting $n for each folder. So I added two simple lines of code, and modified two lines, (not including documentation), and now there is the new /NKEEP option that prevents $n from resetting. But beware - child folders are processed before parents. So the /NBEG value will appear in a child folder, not the root.<br /><br />So here is JREN.BAT version 2.7:<div class="inline-attachment">
			
		
		
				<dl class="file">
			<dt><span class="imageset icon_topic_attach"></span> <a class="postlink" href="download/fileacbf.php?id=98">jren2.7.zip</a></dt>
						<dd>(10.58 KiB) Downloaded 108 times</dd>
		</dl>
		
		
			</div><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50552" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile50552">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist413a.html?mode=viewprofile&amp;u=8547" class="username">crazyroot</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search5630.html?author_id=8547&amp;sr=posts">13</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 14 Dec 2016 19:44</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content50552">

						<h3 ><a href="#p50552">Re: JREN.BAT - Rename files/folders using regular expressions</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting2e1d.html?mode=quote&amp;f=3&amp;p=50552" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic2040.html?p=50552#p50552" onclick="prompt('Message #28',this.href); return false;">#28</a></span> 
									<a class="unread" href="viewtopic2040.html?p=50552#p50552" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist413a.html?mode=viewprofile&amp;u=8547" class="username">crazyroot</a></strong> &raquo; </span>16 Dec 2016 02:38
			</p>
			
			
			
			<div class="content">Thank you Dave, /nkeep is really great !!<br /><br />I'm still struggling with the sorting (directories+files) to get songs in order, like I explained it the topic :<br /><a href="viewtopic86ef.html?f=3&amp;t=7617" class="postlink">http://www.dostips.com/forum/viewtopic.php?f=3&amp;t=7617</a><br /><br />jren is really fantastic, dream becomes reality <img class="smilies" src="images/smilies/icon_wink.gif" alt=";)" title="Wink" /></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50998" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile50998">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist4cb1.html?mode=viewprofile&amp;u=8513" class="username">bangaio64</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search9219.html?author_id=8513&amp;sr=posts">2</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 Nov 2016 16:38</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content50998">

						<h3 ><a href="#p50998">Re: JREN.BAT - Rename files/folders using regular expressions</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingba77.html?mode=quote&amp;f=3&amp;p=50998" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic0af1.html?p=50998#p50998" onclick="prompt('Message #29',this.href); return false;">#29</a></span> 
									<a class="unread" href="viewtopic0af1.html?p=50998#p50998" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist4cb1.html?mode=viewprofile&amp;u=8513" class="username">bangaio64</a></strong> &raquo; </span>01 Feb 2017 03:17
			</p>
			
			
			
			<div class="content">Suppose I have files with the following naming structure,<br />%username%_YYYY-MM-DD_%uniqueID%.txt<br /><br />And I want to rename it to <br />%username%_YYYY.MM-%sequentialnumbering%<br />The sequential numbering would be specific for each month.<br /><br />For example,<br />user1_2017-01-15_1426786413773592719.txt to user1_2017.01-01.txt<br />user1_2017-01-28_1426786414779595637.txt to user1_2017.01-02.txt<br />user1_2017-02-01_1426786413779592215.txt to user1_2017.02-01.txt<br />user1_2017-02-01_1426786414779592719.txt to user1_2017.02-02.txt<br />and so on.<br /><br />I got this but of course the numbering isn't reset with each month:<br />jren &quot;^(user1_)([0-9]{4})-(.*)-.*(\.txt)$&quot; &quot;$1+$2+'.'+lpad($3,'00')+'-'+$n+$4&quot; /J  /T /NBEG 1 /NPAD 2<br /><br />Is this possible to do natively with jren?</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p51000" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile51000">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content51000">

						<h3 ><a href="#p51000">Re: JREN.BAT - Rename files/folders using regular expressions</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting2da8.html?mode=quote&amp;f=3&amp;p=51000" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic9b8e.html?p=51000#p51000" onclick="prompt('Message #30',this.href); return false;">#30</a></span> 
									<a class="unread" href="viewtopic9b8e.html?p=51000#p51000" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>01 Feb 2017 07:59
			</p>
			
			
			
			<div class="content">Not with a single JREN call.<br /><br />I believe this is a bit trickier than you realize. I think you also want to reset $n every time the user and/or year changes. I can give you a relatively simple solution if you use my <a href="viewtopic75d9.html?t=6044" class="postlink">JREPL.BAT utility</a> instead. It is a general purpose regular expression text processor that gives greater flexibility with added custom JScript logic.<br /><br />I'm assuming the month and day values are already zero padded in your original names, and that the uniqueIDs are strictly numeric. Adjust the regex if my assumptions are wrong.<br /><br />This code is untested, so I put an ECHO before the rename command. Remove ECHO once everything appears to be correct.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />setlocal<br />set &quot;find=^(.*_\d{4}-\d\d-)\d\d_\d+\.txt$&quot;<br />set &quot;repl='$txt=$0+'|'+$1+lpad(($1.toLowerCase()==prev?(n+=1):(n=1)),'00'); $prev=$1.toLowerCase()&quot;<br />set &quot;beg=var prev='', n=0&quot;<br />for /f &quot;delims=| tokens=1,2&quot; %%A in (<br />&nbsp; 'dir /b /a-d /on *_????-??-??-*.txt ^| jrepl find repl /v /jmatchq /i /jbeg beg'<br />) do echo ren &quot;%%A&quot; &quot;%%B.txt&quot;<br /></code></pre></div><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
	

	<div class="action-bar bar-bottom">
	
			<a href="postingb188.html?mode=reply&amp;f=3&amp;t=6081" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic8cc6.html?f=3&amp;t=6081&amp;start=15&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

			<form method="post" action="https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=6081&amp;start=15">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			50 posts
							<ul>
			<li class="arrow previous"><a class="button button-icon-only" href="viewtopic7124.html?f=3&amp;t=6081" rel="prev" role="button"><i class="icon fa-chevron-left fa-fw" aria-hidden="true"></i><span class="sr-only">Previous</span></a></li>
				<li><a class="button" href="viewtopic7124.html?f=3&amp;t=6081" role="button">1</a></li>
			<li class="active"><span>2</span></li>
				<li><a class="button" href="viewtopic0809.html?f=3&amp;t=6081&amp;start=30" role="button">3</a></li>
				<li><a class="button" href="viewtopiccac4.html?f=3&amp;t=6081&amp;start=45" role="button">4</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopic0809.html?f=3&amp;t=6081&amp;start=30" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="viewforum4d6b.html?f=3" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to “DOS Batch Forum”</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="viewforum31e6.html?f=4" class="jumpbox-cat-link"> <span> DosTips - Dos Batch</span></a></li>
																<li><a href="viewforum4d6b.html?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; DOS Batch Forum</span></a></li>
											</ul>
		</div>
	</div>

	</div>


			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
							<span class="crumb"><a href="../index.html" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>DosTips.com</span></a></span>									<span class="crumb"><a href="index.html" data-navbar-reference="index"><span>Board index</span></a></span>					</li>
		
				<li class="rightside">All times are <span title="UTC-6">UTC-06:00</span></li>
							<li class="rightside">
				<a href="ucp033a.html?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete all board cookies</span>
				</a>
			</li>
												<li class="rightside" data-last-responsive="true">
				<a href="memberlist4bfd.html?mode=team" role="menuitem">
					<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
				</a>
			</li>
									<li class="rightside" data-last-responsive="true">
				<a href="memberlist8733.html?mode=contactadmin" role="menuitem">
					<i class="icon fa-envelope fa-fw" aria-hidden="true"></i><span>Contact us</span>
				</a>
			</li>
			</ul>

	</div>
</div>

	<div class="copyright">
				<!-- WARNING NO DELETE -->Style developer by <a href="http://tricolor.x-tk.ru/">support forum tricolor</a>, <!-- END WARNING NO DELETE -->Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
									</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	<img src="cron5089.gif?cron_type=cron.task.text_reparser.post_text" width="1" height="1" alt="cron" /></div>

<script type="text/javascript" src="assets/javascript/jquery.mind772.js?assets_version=34"></script>
<script type="text/javascript" src="assets/javascript/cored772.js?assets_version=34"></script>



<script type="text/javascript" src="styles/prosilver/template/forum_fnd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/prosilver/template/ajaxd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/jquery-uid772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/collapsed772.js?assets_version=34"></script>



</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=6081&p=45635 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 07:58:38 GMT -->
</html>
