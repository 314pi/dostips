<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?p=57783 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 06:23:31 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>Alternate method to get TAB, Carriage return and possibly all others - Page 3 - DosTips.com</title>


	<link rel="canonical" href="viewtopic6119.html?t=8513&amp;start=30">

<!--
	phpBB style name: Allan Style - SUBSILVER
	Based on style:   prosilver (this is the default phpBB3 style)
	Based on style:   subsilver2 (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:  Allan ( http://x-tk.ru/ )
-->

<link href="assets/css/font-awesome.mind772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/stylesheetd772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/en/stylesheetd772.css?assets_version=34" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="./styles/AllanStyle-SUBSILVER/theme/tweaks.css?assets_version=34" rel="stylesheet">
<![endif]-->




<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','../../www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-280191-1', 'auto');
	ga('send', 'pageview');
</script>

</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">

<div id="header-subsilver">
	<a id="top" class="top-anchor" accesskey="t"></a>
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description" class="site-description">
				<a id="logo" class="logo" href="../index.html" title="DosTips.com"><span class="site_logo"></span></a>
				<h1>DosTips.com</h1>
				<p>A Forum all about DOS Batch</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

									<div id="search-box" class="search-box search-header" role="search">
				<form action="https://www.dostips.com/forum/search.php" method="get" id="search">
				<fieldset>
					<input name="keywords" id="keywords" type="search" maxlength="128" title="Search for keywords" class="inputbox search tiny" size="20" value="" placeholder="Search…" />
					<button class="button button-search" type="submit" title="Search">
						<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
					</button>
					<a href="search.html" class="button button-search-end" title="Advanced search">
						<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
					</a>
					
				</fieldset>
				</form>
			</div>
						
			</div>
					</div>
</div>


<div id="wrap" class="wrap">
	<div id="page-header">
				<div class="navbar-top" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
																									<li>
								<a href="search33a7.html?search_id=unanswered" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="search526f.html?search_id=active_topics" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-blue" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="search.html" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
											<li class="separator"></li>
																			<li>
								<a href="memberlist4bfd.html?mode=team" role="menuitem">
									<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
								</a>
							</li>
																<li class="separator"></li>

									</ul>
			</div>
		</li>

				<li data-skip-responsive="true">
			<a href="app.php/help/faq.html" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
						
			<li class="rightside"  data-skip-responsive="true">
			<a href="ucp26c3.html?mode=login" title="Login" accesskey="x" role="menuitem">
				<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Login</span>
			</a>
		</li>
					<li class="rightside" data-skip-responsive="true">
				<a href="ucp8319.html?mode=register" role="menuitem">
					<i class="icon fa-pencil-square-o  fa-fw" aria-hidden="true"></i><span>Register</span>
				</a>
			</li>
						</ul>

	</div>
</div>

<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
						<li class="breadcrumbs">
							<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="../index.html" itemprop="url" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span itemprop="title">DosTips.com</span></a></span>
										<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="index.html" itemprop="url" accesskey="h" data-navbar-reference="index"><span itemprop="title">Board index</span></a></span>

											<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="4"><a href="viewforum31e6.html?f=4" itemprop="url"><span itemprop="title">DosTips - Dos Batch</span></a></span>
															<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="3"><a href="viewforum4d6b.html?f=3" itemprop="url"><span itemprop="title">DOS Batch Forum</span></a></span>
												</li>
		
					<li class="rightside responsive-search">
				<a href="search.html" title="View the advanced search options" role="menuitem">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</a>
			</li>
			</ul>

	</div>
</div>

<div class="navbar-top-link">
	<div class="inner">
		<ul>
			<li class="navbar-top-link-left"><a href="search33a7.html?search_id=unanswered">Unanswered topics</a></li>
			<li class="navbar-top-link-left"><a href="search526f.html?search_id=active_topics">Active topics</a></li>

											</ul>
	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
		
<h2 class="topic-title"><a href="viewtopicdaff.html?f=3&amp;t=8513&amp;start=30">Alternate method to get TAB, Carriage return and possibly all others</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">Discussion forum for all Windows batch related topics.<br /></div>
<p>
	<strong>Moderator:</strong> <a href="memberlista6a8.html?mode=viewprofile&amp;u=5" class="username">DosItHelp</a>
</p>


<div class="action-bar bar-top">
	
			<a href="postingaec8.html?mode=reply&amp;f=3&amp;t=8513" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopicd298.html?f=3&amp;t=8513&amp;start=30&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="https://www.dostips.com/forum/search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topic…" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="search.html" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="8513" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			33 posts
							<ul>
			<li class="arrow previous"><a class="button button-icon-only" href="viewtopic61d9.html?f=3&amp;t=8513&amp;start=15" rel="prev" role="button"><i class="icon fa-chevron-left fa-fw" aria-hidden="true"></i><span class="sr-only">Previous</span></a></li>
				<li><a class="button" href="viewtopic5bd3.html?f=3&amp;t=8513" role="button">1</a></li>
				<li><a class="button" href="viewtopic61d9.html?f=3&amp;t=8513&amp;start=15" role="button">2</a></li>
			<li class="active"><span>3</span></li>
	</ul>
					</div>
		</div>




<div id="subsilver-nav-topic">
	<div class="inner"><div class="post has-profile">
		<div class="leftsided postbody subsilver-topic-title">Message</div>
		<div class="leftsided postprofile subsilver-topic-author">Author</div>
	</div></div>
</div>

			<div id="p57783" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile57783">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist0354.html?mode=viewprofile&amp;u=9161" class="username">sst</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search6fff.html?author_id=9161&amp;sr=posts">64</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Apr 2018 23:45</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content57783">

						<h3 class="first"><a href="#p57783">Re: Alternate method to get TAB, Carriage return and possibly all others</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting1283.html?mode=quote&amp;f=3&amp;p=57783" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic215c.html?p=57783#p57783" onclick="prompt('Message #31',this.href); return false;">#31</a></span> 
									<a class="unread" href="viewtopic215c.html?p=57783#p57783" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist0354.html?mode=viewprofile&amp;u=9161" class="username">sst</a></strong> &raquo; </span>19 Aug 2018 07:47
			</p>
			
			
			
			<div class="content">Another variant for getting CR using pipe. both method in separate functions below
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off
call :getCR.FullBuffer CR1
call :getCR.Pipe CR2

setlocal EnableDelayedExpansion
echo(      World!CR1!Hello&amp;
echo(      World!CR2!Hello&amp;
pause
exit /b

:getCR.FullBuffer
setlocal DisableDelayedExpansion
if "%~1"=="" (set "ret=CR") else set "ret=%~1"
for /F %%Z in ('
    @"%COMSPEC%" /e:on /v:on /q /d /c
    set "line= "^^^&amp;
    (for /L %%Z in (1 1 12^) do set "line=!line!!line!"^)^^^&amp;
    echo(!line!!line:~0^,-2!^^^&amp;echo(
') do (
    (goto)2&gt;nul
    set "%ret%=%%Z"
)


:getCR.Pipe
setlocal
if "%~1"=="" (set "ret=CR") else set "ret=%~1"
set "CR="
for /F %%Z in ('
    set CR^=^^!^&amp;
    "%COMSPEC%" /u /d /c "echo(&amp;echo(("^|
    "%COMSPEC%" /e:on /v:on /d /c "set CR= &amp;set /p CR=&amp;echo(%%CR%%CR%%CR%%"
') do (
    (goto)2&gt;nul
    set "%ret%=%%Z"
)
endlocal &amp; goto %0
</code></pre></div>

<strong class="text-strong">Edit</strong><br>
I forgot about the problem of CMD AutoRun registry settings. with FOR /F CMD will not disable processing of AuroRun commands by passing the /D switch to the child instance, so if any thing there outputs a single character, not only the above functions will fail, but the whole batch code will be in an unpredictable state, and most probably will be terminated, depending on the depth of the call stack and the amount of output lines by the AutoRun command(s).<br>
<br>
I don't understand why the folks coding the CMD didn't consider this, they did this for pipes so why not for FOR /F ?  And this can break many batch codes out there, for instance Dave's <a href="viewtopic2192.html?f=3&amp;t=6133&amp;start=30#p38870" class="postlink">getPID routine</a>. Surely the practice of putting something in AutoRun is not common, but peaple do crazy things when they made aware of some feature, without knowing the possible consequences of doing so.<br>
<br>
OK, complaining doesn't solve any thing, this is the replacement code, fortunately, for this case the workaround is simple.
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>:getCR.FullBuffer
setlocal DisableDelayedExpansion
if "%~1"=="" (set "ret=CR") else set "ret=%~1"
for /F %%Z in ('
    @"%COMSPEC%" /e:on /v:on /q /d /c
    set "line= "^^^&amp;
    (for /L %%Z in (1 1 12^) do set "line=!line!!line!"^)^^^&amp;
    echo(!line!!line:~0^,-2!^^^&amp;echo(
') do set "CR=%%Z"
setlocal EnableDelayedExpansion
for %%Z in ("!CR!") do (
    (goto)2&gt;nul
    set "%ret%=%%~Z"
)

:getCR.Pipe
setlocal EnableDelayedExpansion
if "%~1"=="" (set "ret=CR") else set "ret=%~1"
set "CR="
for /F %%Z in ('
    set CR^=^^!^&amp;
    "%COMSPEC%" /u /d /c "echo(&amp;echo(("^|
    "%COMSPEC%" /e:on /v:on /d /c "set CR=#&amp;set /p CR=&amp;echo(%%CR%%CR%%CR%%"
') do set "CR=%%Z"
if "!CR!"=="#" endlocal &amp; goto %0
for %%Z in ("!CR!") do (
    (goto)2&gt;nul
    set "%ret%=%%~Z"
)
</code></pre></div></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p57834" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile57834">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist7125.html?mode=viewprofile&amp;u=417" class="username">jeb</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search73f1.html?author_id=417&amp;sr=posts">880</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 30 Aug 2007 08:05</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany, Bochum</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content57834">

						<h3 ><a href="#p57834">Re: Alternate method to get TAB, Carriage return and possibly all others</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinge3ee.html?mode=quote&amp;f=3&amp;p=57834" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic67f9.html?p=57834#p57834" onclick="prompt('Message #32',this.href); return false;">#32</a></span> 
									<a class="unread" href="viewtopic67f9.html?p=57834#p57834" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist7125.html?mode=viewprofile&amp;u=417" class="username">jeb</a></strong> &raquo; </span>28 Aug 2018 07:15
			</p>
			
			
			
			<div class="content">Hi sst,<br>
<br>
clever way to use the buffer overflow without a temporary file.<br>
<br>
I never thought of your pipe solution.<br>
But still it has a bad taste to use a buffer overflow, I'm not convinced that there aren't some nasty side effects.<br>

<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off
call :CreateCR
setlocal EnableDelayedExpansion
echo 12345!CR!#
exit /b


::: CR should  be used only with DelayedExpansion
:CreateCR
setlocal EnableDelayedExpansion EnableExtensions
set "X=."
for /L %%c in (1,1,13) DO set "X=!X:~0,4093!!X:~0,4093!"

&gt; %temp%\cr.tmp (
(echo !X!    )
echo(
)

for /f "tokens=2 usebackq" %%a in ("%temp%\cr.tmp") do (
   endlocal
   set "cr=%%a"
   rem set x=
   goto :eof
)
goto :eof</code></pre></div></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p57846" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile57846">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist0354.html?mode=viewprofile&amp;u=9161" class="username">sst</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search6fff.html?author_id=9161&amp;sr=posts">64</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Apr 2018 23:45</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content57846">

						<h3 ><a href="#p57846">Re: Alternate method to get TAB, Carriage return and possibly all others</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting1f7c.html?mode=quote&amp;f=3&amp;p=57846" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicd0ba-2.html?p=57846#p57846" onclick="prompt('Message #33',this.href); return false;">#33</a></span> 
									<a class="unread" href="viewtopicd0ba-2.html?p=57846#p57846" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist0354.html?mode=viewprofile&amp;u=9161" class="username">sst</a></strong> &raquo; </span>29 Aug 2018 02:04
			</p>
			
			
			
			<div class="content">Hi jeb,<br>
<br>
I don't see any buffer overflow, I believe it's just an exhausted buffer, nothing will be written beyond. If we can cause buffer overflow this easy, then the side effects of getting CR this way would be the least our worries.<br>
<br>
But to be sure I've traced the relevant parts of cmd code in debugger, and I couldn't find any evidence of buffer overflow being occured. In this particular case the only place that is susceptible to cause overflow is where 'echo ' tries to append CRLF to the passed argument.<br>
<br>
Let's see:
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>echo(!line!!line:~0^,-2! ---&gt; '(' + &lt;4096&gt; + &lt;4094&gt; = 8191
</code></pre></div>
So far so good.<br>
<br>
The rest is self explanatory<br>
<br>
pseudo code (Windows 7 CMD):
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>int eEcho (struct *s)
{
    ret = OnOffCheck(s-&gt;argptr, 0);
    switch (ret)
    {
        case 2:
            // Print echo on/off message based on current echo state.
        case 3:
            cmd_printf("%s\r\n", s-&gt;argptr+1) //skip over the first character then print
        default:
            echoState=ret;
    }
    return 0;
}

void cmd_printf(wchar *format, ...)
{
    va_list argList;
    va_start(argList,format); 
    // Win7 CMD calls StringCchVPrintfW which internally calls vsnwprintf but WinXP CMD directly calls vsnwprintf
    // format="%s\r\n"
    StringCchVPrintfW(Dest, 8192, format, argList); // No overflow.
    len=wcslen(Dest);
    CmdPutChars(Dest, len);
    return;
}

int CmdPutChars(wchar *Buffer, unsigned int CharsToWrite)
{
    if ( FileIsConsole(stdout) ) {
        WriteConsoleW(....);
        //Error handling
    } else {
       MyWriteFile(....);
       //Error handling
    }
    return ret;
}
</code></pre></div>

<br>
Disassembly listings (Win7 CMD 32bit module v6.1.7601.23403)<br>
eEcho:
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>CPU Disasm
Address   Hex dump          Command                                  Comments
4A07598D      8BFF          MOV EDI,EDI
4A07598F  /.  55            PUSH EBP
4A075990  |.  8BEC          MOV EBP,ESP
4A075992  |.  56            PUSH ESI
4A075993  |.  8B75 08       MOV ESI,DWORD PTR SS:[EBP+8]
4A075996  |.  57            PUSH EDI
4A075997  |.  33FF          XOR EDI,EDI
4A075999  |.  57            PUSH EDI                                 ; /Arg2
4A07599A  |.  FF76 3C       PUSH DWORD PTR DS:[ESI+3C]               ; |Arg1
4A07599D  |.  E8 30000000   CALL _OnOffCheck@8                       ; \cmd._OnOffCheck@8
4A0759A2  |.  8BC8          MOV ECX,EAX
4A0759A4  |.  49            DEC ECX                                  ; Switch (cases 2..3, 3 exits)
4A0759A5  |.  49            DEC ECX
4A0759A6  |.- 0F84 15E60000 JZ 4A083FC1
4A0759AC  |.  49            DEC ECX
4A0759AD  |.- 0F85 5CFCFFFF JNZ 4A07560F
4A0759B3  |.  8B46 3C       MOV EAX,DWORD PTR DS:[ESI+3C]            ; Case 3 of switch cmd.4A0759A4
4A0759B6  |.  40            INC EAX
4A0759B7  |.  40            INC EAX
4A0759B8  |.  50            PUSH EAX                                 ; /&lt;%s&gt;
4A0759B9  |.  68 A846094A   PUSH OFFSET _Fmt17                       ; |Format = "%s\r\n"
4A0759BE  |.  E8 30FFFFFF   CALL _cmd_printf                         ; \cmd._cmd_printf
4A0759C3  |&gt;  59            POP ECX
4A0759C4  |.  59            POP ECX
4A0759C5  |&gt;  5F            POP EDI                                  ; Default case of switch cmd.4A0759A4
4A0759C6  |.  33C0          XOR EAX,EAX
4A0759C8  |.  5E            POP ESI
4A0759C9  |.  5D            POP EBP
4A0759CA  \.  C2 0400       RETN 4
</code></pre></div>

cmd_printf:
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>CPU Disasm
Address   Hex dump          Command                                  Comments
4A0758F3  /$  8BFF          MOV EDI,EDI                              ; cmd._cmd_printf(guessed Format...)
4A0758F5  |.  55            PUSH EBP
4A0758F6  |.  8BEC          MOV EBP,ESP
4A0758F8  |.  56            PUSH ESI
4A0758F9  |.  8D45 0C       LEA EAX,[EBP+0C]
4A0758FC  |.  50            PUSH EAX                                 ; /Arg4
4A0758FD  |.  FF75 08       PUSH DWORD PTR SS:[EBP+8]                ; |Arg3
4A075900  |.  BE 40460A4A   MOV ESI,OFFSET _MsgBuf                   ; |
4A075905  |.  68 00200000   PUSH 2000                                ; |Arg2 = 2000
4A07590A  |.  56            PUSH ESI                                 ; |Arg1
4A07590B  |.  E8 80FFFFFF   CALL _StringCchVPrintfW@16               ; \cmd._StringCchVPrintfW@16
4A075910  |.  8BC6          MOV EAX,ESI
4A075912  |.  8D48 02       LEA ECX,[EAX+2]
4A075915  |&gt;  66:8B10       /MOV DX,WORD PTR DS:[EAX]
4A075918  |.  40            |INC EAX
4A075919  |.  40            |INC EAX
4A07591A  |.  66:85D2       |TEST DX,DX
4A07591D  |.- 75 F6         \JNZ SHORT 4A075915
4A07591F  |.  2BC1          SUB EAX,ECX
4A075921  |.  D1F8          SAR EAX,1
4A075923  |.  50            PUSH EAX                                 ; /Arg2
4A075924  |.  56            PUSH ESI                                 ; |Arg1
4A075925  |.  E8 08000000   CALL _CmdPutChars@8                      ; \cmd._CmdPutChars@8
4A07592A  |.  5E            POP ESI
4A07592B  |.  5D            POP EBP
4A07592C  \.  C3            RETN
</code></pre></div></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
	

	<div class="action-bar bar-bottom">
	
			<a href="postingaec8.html?mode=reply&amp;f=3&amp;t=8513" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopicd298.html?f=3&amp;t=8513&amp;start=30&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

			<form method="post" action="https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=8513&amp;start=30">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			33 posts
							<ul>
			<li class="arrow previous"><a class="button button-icon-only" href="viewtopic61d9.html?f=3&amp;t=8513&amp;start=15" rel="prev" role="button"><i class="icon fa-chevron-left fa-fw" aria-hidden="true"></i><span class="sr-only">Previous</span></a></li>
				<li><a class="button" href="viewtopic5bd3.html?f=3&amp;t=8513" role="button">1</a></li>
				<li><a class="button" href="viewtopic61d9.html?f=3&amp;t=8513&amp;start=15" role="button">2</a></li>
			<li class="active"><span>3</span></li>
	</ul>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="viewforum4d6b.html?f=3" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to “DOS Batch Forum”</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="viewforum31e6.html?f=4" class="jumpbox-cat-link"> <span> DosTips - Dos Batch</span></a></li>
																<li><a href="viewforum4d6b.html?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; DOS Batch Forum</span></a></li>
											</ul>
		</div>
	</div>

	</div>


			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
							<span class="crumb"><a href="../index.html" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>DosTips.com</span></a></span>									<span class="crumb"><a href="index.html" data-navbar-reference="index"><span>Board index</span></a></span>					</li>
		
				<li class="rightside">All times are <span title="UTC-6">UTC-06:00</span></li>
							<li class="rightside">
				<a href="ucp033a.html?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete all board cookies</span>
				</a>
			</li>
												<li class="rightside" data-last-responsive="true">
				<a href="memberlist4bfd.html?mode=team" role="menuitem">
					<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
				</a>
			</li>
									<li class="rightside" data-last-responsive="true">
				<a href="memberlist8733.html?mode=contactadmin" role="menuitem">
					<i class="icon fa-envelope fa-fw" aria-hidden="true"></i><span>Contact us</span>
				</a>
			</li>
			</ul>

	</div>
</div>

	<div class="copyright">
				<!-- WARNING NO DELETE -->Style developer by <a href="http://tricolor.x-tk.ru/">support forum tricolor</a>, <!-- END WARNING NO DELETE -->Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
									</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	<img src="cron5089.gif?cron_type=cron.task.text_reparser.post_text" width="1" height="1" alt="cron" /></div>

<script type="text/javascript" src="assets/javascript/jquery.mind772.js?assets_version=34"></script>
<script type="text/javascript" src="assets/javascript/cored772.js?assets_version=34"></script>



<script type="text/javascript" src="styles/prosilver/template/forum_fnd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/prosilver/template/ajaxd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/jquery-uid772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/collapsed772.js?assets_version=34"></script>



</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?p=57783 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 06:23:31 GMT -->
</html>
