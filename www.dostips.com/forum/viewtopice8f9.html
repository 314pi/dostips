<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=4847&start=30 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 07:57:58 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>getTimestamp.bat for time and date processing - Page 3 - DosTips.com</title>


	<link rel="canonical" href="viewtopic0fdd.html?t=4847&amp;start=30">

<!--
	phpBB style name: Allan Style - SUBSILVER
	Based on style:   prosilver (this is the default phpBB3 style)
	Based on style:   subsilver2 (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:  Allan ( http://x-tk.ru/ )
-->

<link href="assets/css/font-awesome.mind772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/stylesheetd772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/en/stylesheetd772.css?assets_version=34" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="./styles/AllanStyle-SUBSILVER/theme/tweaks.css?assets_version=34" rel="stylesheet">
<![endif]-->




<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','../../www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-280191-1', 'auto');
	ga('send', 'pageview');
</script>

</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">

<div id="header-subsilver">
	<a id="top" class="top-anchor" accesskey="t"></a>
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description" class="site-description">
				<a id="logo" class="logo" href="../index.html" title="DosTips.com"><span class="site_logo"></span></a>
				<h1>DosTips.com</h1>
				<p>A Forum all about DOS Batch</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

									<div id="search-box" class="search-box search-header" role="search">
				<form action="https://www.dostips.com/forum/search.php" method="get" id="search">
				<fieldset>
					<input name="keywords" id="keywords" type="search" maxlength="128" title="Search for keywords" class="inputbox search tiny" size="20" value="" placeholder="Search…" />
					<button class="button button-search" type="submit" title="Search">
						<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
					</button>
					<a href="search.html" class="button button-search-end" title="Advanced search">
						<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
					</a>
					
				</fieldset>
				</form>
			</div>
						
			</div>
					</div>
</div>


<div id="wrap" class="wrap">
	<div id="page-header">
				<div class="navbar-top" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
																									<li>
								<a href="search33a7.html?search_id=unanswered" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="search526f.html?search_id=active_topics" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-blue" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="search.html" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
											<li class="separator"></li>
																			<li>
								<a href="memberlist4bfd.html?mode=team" role="menuitem">
									<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
								</a>
							</li>
																<li class="separator"></li>

									</ul>
			</div>
		</li>

				<li data-skip-responsive="true">
			<a href="app.php/help/faq.html" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
						
			<li class="rightside"  data-skip-responsive="true">
			<a href="ucp26c3.html?mode=login" title="Login" accesskey="x" role="menuitem">
				<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Login</span>
			</a>
		</li>
					<li class="rightside" data-skip-responsive="true">
				<a href="ucp8319.html?mode=register" role="menuitem">
					<i class="icon fa-pencil-square-o  fa-fw" aria-hidden="true"></i><span>Register</span>
				</a>
			</li>
						</ul>

	</div>
</div>

<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
						<li class="breadcrumbs">
							<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="../index.html" itemprop="url" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span itemprop="title">DosTips.com</span></a></span>
										<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="index.html" itemprop="url" accesskey="h" data-navbar-reference="index"><span itemprop="title">Board index</span></a></span>

											<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="4"><a href="viewforum31e6.html?f=4" itemprop="url"><span itemprop="title">DosTips - Dos Batch</span></a></span>
															<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="3"><a href="viewforum4d6b.html?f=3" itemprop="url"><span itemprop="title">DOS Batch Forum</span></a></span>
												</li>
		
					<li class="rightside responsive-search">
				<a href="search.html" title="View the advanced search options" role="menuitem">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</a>
			</li>
			</ul>

	</div>
</div>

<div class="navbar-top-link">
	<div class="inner">
		<ul>
			<li class="navbar-top-link-left"><a href="search33a7.html?search_id=unanswered">Unanswered topics</a></li>
			<li class="navbar-top-link-left"><a href="search526f.html?search_id=active_topics">Active topics</a></li>

											</ul>
	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
		
<h2 class="topic-title"><a href="viewtopice8f9.html?f=3&amp;t=4847&amp;start=30">getTimestamp.bat for time and date processing</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">Discussion forum for all Windows batch related topics.<br /></div>
<p>
	<strong>Moderator:</strong> <a href="memberlista6a8.html?mode=viewprofile&amp;u=5" class="username">DosItHelp</a>
</p>


<div class="action-bar bar-top">
	
			<a href="postingfde4.html?mode=reply&amp;f=3&amp;t=4847" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopicbe59.html?f=3&amp;t=4847&amp;start=30&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="https://www.dostips.com/forum/search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topic…" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="search.html" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="4847" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			46 posts
							<ul>
			<li class="arrow previous"><a class="button button-icon-only" href="viewtopic4c44.html?f=3&amp;t=4847&amp;start=15" rel="prev" role="button"><i class="icon fa-chevron-left fa-fw" aria-hidden="true"></i><span class="sr-only">Previous</span></a></li>
				<li><a class="button" href="viewtopic5ecb.html?f=3&amp;t=4847" role="button">1</a></li>
				<li><a class="button" href="viewtopic4c44.html?f=3&amp;t=4847&amp;start=15" role="button">2</a></li>
			<li class="active"><span>3</span></li>
				<li><a class="button" href="viewtopiccf06.html?f=3&amp;t=4847&amp;start=45" role="button">4</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopiccf06.html?f=3&amp;t=4847&amp;start=45" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
		</div>




<div id="subsilver-nav-topic">
	<div class="inner"><div class="post has-profile">
		<div class="leftsided postbody subsilver-topic-title">Message</div>
		<div class="leftsided postprofile subsilver-topic-author">Author</div>
	</div></div>
</div>

			<div id="p44151" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile44151">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf147.html?author_id=3221&amp;sr=posts">6033</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Feb 2012 02:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content44151">

						<h3 class="first"><a href="#p44151">Re: getTimestamp.bat for time and date processing</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting28f3.html?mode=quote&amp;f=3&amp;p=44151" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic5777-3.html?p=44151#p44151" onclick="prompt('Message #31',this.href); return false;">#31</a></span> 
									<a class="unread" href="viewtopic5777-3.html?p=44151#p44151" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a></strong> &raquo; </span>27 Nov 2015 23:24
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>dbenham wrote:</cite>I've been pretty much off the grid for a few months, concentrating on work and music.<br /></div></blockquote><br /><br />Do you play music Dave, or is listening your primary enjoyment?<br /><br />I was a musician - played guitar and sang with others.  Taught myself keyboard, played recorder as a kid, fiddled with a mouth organ and accordion.<br />All good fun!<br /><br /><br />Thanks for the gettimestamp update...</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p44156" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile44156">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content44156">

						<h3 ><a href="#p44156">Re: getTimestamp.bat for time and date processing</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinga8ba.html?mode=quote&amp;f=3&amp;p=44156" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic802c.html?p=44156#p44156" onclick="prompt('Message #32',this.href); return false;">#32</a></span> 
									<a class="unread" href="viewtopic802c.html?p=44156#p44156" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>28 Nov 2015 09:05
			</p>
			
			
			
			<div class="content">[OffTopic]<br />I used to sing a lot with various choral groups, the most satisfying being the Baltimore Choral Arts Society, and the Baltimore Symphony Chorus. But I've pretty much given up singing for the moment.<br /><br />For the past 6 years I have been playing Native American flutes, mostly at open mics. It's all improvisation. I especially like to jam with one or more additional musicians. A slow week I may play only once. But recently I've been active as much as 5 nights in one week.<br /><br />I have a bunch of music posted to the internet:<br />The host of my favorite open mic has posted a handful of my performances within his <a href="http://www.youtube.com/watch?v=DiVJkPfJoZc&amp;list=PLaL1NtKJqn1zFMzuGAVVQFkrScpsB2hHq" class="postlink">&quot;Favorite Open Mic moments&quot; playlist</a><br />I've got 40+ videos I've posted myself on <a href="http://www.youtube.com/playlist?list=PLaL1NtKJqn1zFMzuGAVVQFkrScpsB2hHq" class="postlink">my YouTube channel</a><br />And I have over 3+ hours of music posted on my SoundCloud page at <!-- m --><a class="postlink" href="http://soundcloud.com/dave-benham">http://soundcloud.com/dave-benham</a><!-- m --><br />There are additional videos others have posted of me out there somewhere.<br />[/OffTopic]<br /><br /><br />Dave Benham</div>

			
													<div class="notice">
					Last edited by <a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a> on 03 Dec 2015 06:50, edited 1 time in total.
									</div>
			
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p44164" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile44164">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist2675.html?mode=viewprofile&amp;u=2988" style="color: #00AA00;" class="username-coloured">Squashman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1322.html?author_id=2988&amp;sr=posts">3970</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 Dec 2011 13:59</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content44164">

						<h3 ><a href="#p44164">Re: getTimestamp.bat for time and date processing</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting8910.html?mode=quote&amp;f=3&amp;p=44164" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicb20c.html?p=44164#p44164" onclick="prompt('Message #33',this.href); return false;">#33</a></span> 
									<a class="unread" href="viewtopicb20c.html?p=44164#p44164" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist2675.html?mode=viewprofile&amp;u=2988" style="color: #00AA00;" class="username-coloured">Squashman</a></strong> &raquo; </span>28 Nov 2015 16:06
			</p>
			
			
			
			<div class="content">My oldest son is on year 8 singing with the Green Bay Boy Choir and my youngest joined this year as well. They went to sing in Austria and the Czech Republic last year.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p44246" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile44246">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf147.html?author_id=3221&amp;sr=posts">6033</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Feb 2012 02:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content44246">

						<h3 ><a href="#p44246">Re: getTimestamp.bat for time and date processing</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting6169-2.html?mode=quote&amp;f=3&amp;p=44246" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic59f2.html?p=44246#p44246" onclick="prompt('Message #34',this.href); return false;">#34</a></span> 
									<a class="unread" href="viewtopic59f2.html?p=44246#p44246" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a></strong> &raquo; </span>03 Dec 2015 03:08
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>dbenham wrote:</cite>[OffTopic]<br />I used to sing a lot with various choral groups, the most satisfying being the Baltimore Choral Arts Society, and the Baltimore Symphony Chorus. But I've pretty much given up singing for the moment.<br /><br />For the past 6 years I have been playing Native American flutes, mostly at open mics. It's all improvisation.  recently I've been active as much as 5 nights in one week.<br />[/OffTopic]<br /></div></blockquote><br /><br />I love the gentle sound of the flute Dave.  You and your companions make lovely music.<br /><br /><blockquote><div><cite>Squashman wrote:</cite>My oldest son is on year 8 singing with the Green Bay Boy Choir and my youngest joined this year as well. They went to sing in Austria and the Czech Republic last year.</div></blockquote><br /><br />That can only be a great experience for them Squashman.  Making music is a highlight in my life, and I'm sure they will treasure it into the future too.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p46009" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile46009">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content46009">

						<h3 ><a href="#p46009">Re: getTimestamp.bat for time and date processing</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting4433-2.html?mode=quote&amp;f=3&amp;p=46009" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic11d4.html?p=46009#p46009" onclick="prompt('Message #35',this.href); return false;">#35</a></span> 
									<a class="unread" href="viewtopic11d4.html?p=46009#p46009" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>01 Apr 2016 11:59
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>MCP wrote:</cite><span style="color: #800000">This original post is at <!-- l --><a class="postlink-local" href="viewtopic0d2c.html?p=45979#p45979">viewtopic.php?p=45979#p45979</a><!-- l --></span><br /><br />Foxidrive,<br />Thanks for the link. I'm sure someone could probably use that script to code part of what I'm trying to accomplish but for me it is beyond my current experience level to understand it and then write the additional code required to use it in the way I need in any kind of timely manner.<br /><br />I'm really looking for something a bit more &quot;turn key&quot; that I can just copy and plug-in to my batch file. If you have any additional examples that are a little closer to my requirements or can put together something that specifically targets what I need then that would be fantastic.<br /><br />Mike</div></blockquote><br />It doesn't get much more turnkey than <a href="viewtopic6b09.html?t=4847" class="postlink">getTimestamp.bat</a>.<br /><br />You need to know the date and time format used by your locale. For me I need mm-dd-yyyy and hh:mm:ss.ff, where hh is in 24 hour format, and .ff is optional fractional seconds. Also, you must be running as administrator if you want to modify your computer's system date/time.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>for /f &quot;tokens=1,2&quot; %%A in (<br />&nbsp; 'gettimestamp /oh -3 /f &quot;{mm}-{dd}-{yyyy} {hh}:{nn}:{ss}&quot;'<br />) do date %%A &amp; time %%B<br /></code></pre></div><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p47646" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile47646">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf147.html?author_id=3221&amp;sr=posts">6033</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Feb 2012 02:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content47646">

						<h3 ><a href="#p47646">Re: getTimestamp.bat for time and date processing</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingaf89.html?mode=quote&amp;f=3&amp;p=47646" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic6e55.html?p=47646#p47646" onclick="prompt('Message #36',this.href); return false;">#36</a></span> 
									<a class="unread" href="viewtopic6e55.html?p=47646#p47646" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a></strong> &raquo; </span>08 Jul 2016 19:06
			</p>
			
			
			
			<div class="content">Dave, I have a task to add these times one-by-one and get a cumulative result from each step, but also adding the day in a 2 digit zero padded figure.<br /><br />Can you give me a clue please?<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>00:00:00:000<br />01:25:56.606<br />01:29:11.410<br />01:30:35.314<br />01:28:31.956<br />00:46:53.378<br />01:30:01.046<br />01:30:21.032<br />01:32:05.801<br />01:30:50.729<br />01:30:44.546<br />01:31:11.407<br />01:29:52.438<br />00:47:12.321<br />01:40:47.929<br />01:29:07.127<br />00:47:58.977<br />01:31:00.337<br />01:31:01.505<br />01:29:55.248<br />01:32:21.105</code></pre></div></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p47647" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile47647">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist8beb.html?mode=viewprofile&amp;u=5056" class="username">ShadowThief</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search9642.html?author_id=5056&amp;sr=posts">853</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 06 Sep 2013 21:28</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Virginia, United States</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content47647">

						<h3 ><a href="#p47647">Re: getTimestamp.bat for time and date processing</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingcae9.html?mode=quote&amp;f=3&amp;p=47647" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicf3f9.html?p=47647#p47647" onclick="prompt('Message #37',this.href); return false;">#37</a></span> 
									<a class="unread" href="viewtopicf3f9.html?p=47647#p47647" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist8beb.html?mode=viewprofile&amp;u=5056" class="username">ShadowThief</a></strong> &raquo; </span>08 Jul 2016 20:03
			</p>
			
			
			
			<div class="content">Couldn't you just convert the entire timestamp to seconds and do math that way?</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p47654" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile47654">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf147.html?author_id=3221&amp;sr=posts">6033</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Feb 2012 02:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content47654">

						<h3 ><a href="#p47654">Re: getTimestamp.bat for time and date processing</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting5de2-2.html?mode=quote&amp;f=3&amp;p=47654" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic4fd1.html?p=47654#p47654" onclick="prompt('Message #38',this.href); return false;">#38</a></span> 
									<a class="unread" href="viewtopic4fd1.html?p=47654#p47654" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a></strong> &raquo; </span>09 Jul 2016 05:01
			</p>
			
			
			
			<div class="content">That's the hard bit for me.   I have panic attacks when I have to add 3 cents and 4 cents at the supermarket.<br /><br />It would need to be done in milliseconds and I don't understand all the complexity in gettimestamp.bat<br />Maybe jeval.bat would be better but my brain is still not up to the task.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p47660" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile47660">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content47660">

						<h3 ><a href="#p47660">Re: getTimestamp.bat for time and date processing</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingd10f.html?mode=quote&amp;f=3&amp;p=47660" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicb6d1.html?p=47660#p47660" onclick="prompt('Message #39',this.href); return false;">#39</a></span> 
									<a class="unread" href="viewtopicb6d1.html?p=47660#p47660" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>09 Jul 2016 14:00
			</p>
			
			
			
			<div class="content">This post is for releasing getTimestamp version 2.5<br /><br />I discovered a significant bug with version 2.4 when doing date/time offset computations where the local timezone of the original value is different than the local timezone of the result due to daylight savings issues.<br /><br />Here is a simple loop that demonstrates the 2.4 bug<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>C:\test&gt;for /l %M in (0 1 12) do @getTimestamp -d &quot;'1/1/2016 UTC'&quot; -od %M*30 -u<br />2016-01-01T00:00:00.000+00:00<br />2016-01-31T00:00:00.000+00:00<br />2016-03-01T00:00:00.000+00:00<br />2016-03-30T23:00:00.000+00:00<br />2016-04-29T23:00:00.000+00:00<br />2016-05-29T23:00:00.000+00:00<br />2016-06-28T23:00:00.000+00:00<br />2016-07-28T23:00:00.000+00:00<br />2016-08-27T23:00:00.000+00:00<br />2016-09-26T23:00:00.000+00:00<br />2016-10-26T23:00:00.000+00:00<br />2016-11-26T00:00:00.000+00:00<br />2016-12-26T00:00:00.000+00:00<br /></code></pre></div>My base timestamp is midnight, Jan 1, 2016 UTC, and I add multiples of 30 days. My local time zone is the U.S. Eastern Time, which follows daylight savings. The time should remain midnight throughout. But notice how the daylight savings months are off by an hour <img class="smilies" src="images/smilies/icon_exclaim.gif" alt=":!:" title="Exclamation" />  <img class="smilies" src="images/smilies/icon_sad.gif" alt=":(" title="Sad" /> <br /><br />The fix was quite simple. I just had to make sure I <strong class="text-strong"><em class="text-italics">always</em></strong> use the UTC functions whenever I perform date computations<br /><br />So here is the correct result using version 2.5:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>C:\test&gt;for /l %M in (0 1 12) do @getTimestamp -d &quot;'1/1/2016 UTC'&quot; -od %M*30 -u<br />2016-01-01T00:00:00.000+00:00<br />2016-01-31T00:00:00.000+00:00<br />2016-03-01T00:00:00.000+00:00<br />2016-03-31T00:00:00.000+00:00<br />2016-04-30T00:00:00.000+00:00<br />2016-05-30T00:00:00.000+00:00<br />2016-06-29T00:00:00.000+00:00<br />2016-07-29T00:00:00.000+00:00<br />2016-08-28T00:00:00.000+00:00<br />2016-09-27T00:00:00.000+00:00<br />2016-10-27T00:00:00.000+00:00<br />2016-11-26T00:00:00.000+00:00<br />2016-12-26T00:00:00.000+00:00<br /></code></pre></div><br /><br /><strong class="text-strong">And here is getTimestamp version 2.5</strong><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@if (@X)==(@Y) @end&nbsp; /* harmless hybrid line that begins a JScript comment<br />@goto :batch<br />::<br />::getTimestamp.bat version 2.5 by Dave Benham<br />::<br />::&nbsp; Release History:<br />::&nbsp; &nbsp; 2.5 2016-07-09 - Fixed bug with offset computations when the before and<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;after have different time zones due to daylight savings.<br />::&nbsp; &nbsp; 2.4 2015-11-27 - Added formats to support comma as decimal mark in<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ISO 8601 time and timestamp formats.<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Added formats to support ISO 8601 week dates<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;and ordinal dates.<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Rearranged documentation, and added examples for<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;base date specified as a list of numeric values.<br />::&nbsp; &nbsp; 2.3 2015-07-11 - Added {ISO-xx}, {ISOxx}, {DY} and {DDY} formats<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Added -?? (paged help) option<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Allow user defined default option values by defining<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;variables of the form &quot;GetTimestamp-OPTION=VALUE&quot;<br />::&nbsp; &nbsp; 2.2 2014-12-03 - Doc fix: -R ReturnVariable is unchanged if err occurs<br />::&nbsp; &nbsp; 2.1 2014-12-03 - Added GOTO at top to increase performance (32% faster)<br />::&nbsp; &nbsp; 2.0 2014-12-02 - Major rewrite: most code now in JScript (25% faster)<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Better error handling<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;May now use /Option or -Option<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Added -V option<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Added {{} format value to enable unambiguous { literal<br />::&nbsp; &nbsp; 1.1 ????-??-?? - Added -Z option and obscure bug fixes<br />::&nbsp; &nbsp; 1.0 2013-07-17 - Initial release<br />::<br />::============ Documentation ===========<br />:::<br />:::getTimestamp&nbsp; &#91;-option &#91;value&#93;&#93;...<br />:::<br />:::&nbsp; Displays a formatted timestamp. Defaults to the current local date<br />:::&nbsp; and time using an ISO 8601 format with milliseconds, time zone<br />:::&nbsp; and punctuation, using period as a decimal mark.<br />:::<br />:::&nbsp; Returned ERRORLEVEL is 0 upon success, 1 if failure.<br />:::<br />:::&nbsp; Options may be prefaced with - or /<br />:::<br />:::&nbsp; All options have default values. The default value can be overridden by<br />:::&nbsp; defining an evironment variable of the form &quot;GetTimestamp-OPTION=VALUE&quot;.<br />:::&nbsp; For example, upper case English weekday abbreviations can be specified as<br />:::&nbsp; the default by defining &quot;GetTimestamp-WKD=SUN MON TUE WED THU FRI SAT&quot;.<br />:::<br />:::&nbsp; Command line option values take precedence, followed by environment variable<br />:::&nbsp; defaults, followed by built in defaults.<br />:::<br />:::&nbsp; The following options are all case insensitive:<br />:::<br />:::&nbsp; &nbsp; -?&nbsp; : Prints this documentation for getTimestamp<br />:::<br />:::&nbsp; &nbsp; -?? : Prints this documentation with pagination via MORE<br />:::<br />:::&nbsp; &nbsp; -V&nbsp; : Prints the version of getTimeStamp<br />:::<br />:::&nbsp; &nbsp; -D DateSpec<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the base date and time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default value is current local date and time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;The DateSpec supports many formats:<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;&quot;&nbsp; &nbsp; (no value)<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Current date and time - the default<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;milliseconds<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;A JScript numeric expression that represents the number of<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;milliseconds since 1970-01-01 00:00:00 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Decimal values are truncated.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative values represent dates prior to 1970-01-01.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'Date &#91;Time&#93; &#91;TimeZone&#93;'&quot;<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;A string representation of the date and time. The date information<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;is required, the time and time zone are optional. Missing time info<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;is assumed to be 0 (midnight). Missing time zone info is assumed to<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;be local time zone.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;The Date, Time, and TimeZone information can be represented as any<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;string that is accepted by the JScript Date.Parse() method.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;There are many formatting options. Documentation is available at:<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;http://msdn.microsoft.com/en-us/library/k4w173wk(v=vs.84).aspx<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Examples of equivalent representations of Midnight on January 4,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2013 assuming local time zone is U.S Eastern Standard Time (EST):<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'1-4-2013'&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Defaults to local time zone<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'January 4, 2013 EST'&quot;&nbsp; &nbsp; &nbsp; &nbsp;Explicit Eastern Std Time (US)<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'2013/1/4 -05'&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Explicit Eastern Std Time (US)<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'Jan 3 2013 23: CST'&quot;&nbsp; &nbsp; &nbsp; &nbsp; Central Standard Time (US)<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'2013 3 Jan 9:00 pm -0800'&quot;&nbsp; Pacific Standard Time (US)<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'01/04/2013 05:00:00 UTC'&quot;&nbsp; &nbsp;Universal Coordinated Time<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'1/4/2013 05:30 +0530'&quot;&nbsp; &nbsp; &nbsp; India Standard Time<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;year, month&#91;, day&#91;, hour&#91;, minute&#91;, second&#91;, millisecond&#93;&#93;&#93;&#93;&#93;&quot;<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;A comma delimited list of numeric JScript expressions representing<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;various components of date and time. Year and month are required,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the rest are optional. Missing values are treated as 0.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Decimal values are truncated. A 0 month represents January.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;A 1 day represents the first day of the month. A 0 day represents<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the last day of the prior month. The date/time value is always<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;in local time. There is no mechanism to specify a time zone.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Examples: (all in local time)<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;2012,0,1,12,45,3,121&quot;&nbsp; 12:45:03.121 on Jan 1, 2012<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;2012,0,1,12&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Noon on Jan 1, 2012<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;2012,1,1&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Midnight on Feb 1, 2012<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;2012,2,0&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Midnight on Feb 29, 2012 (last day of Feb)<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;2012,2&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Midnight on Feb 29, 2012 (last day of Feb)<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;The ability to use JScript expressions makes it convenient to do<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;date and time offset computations in a very compact form.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;For example, starting with:<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;2015,8,7,14,5&quot;&nbsp; &nbsp; &nbsp; &nbsp; Sep 7, 2015 at 14:05:00<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;It is simple to subtract 30 days and 30 minutes from the above:<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;2015,8,7-30,14,5-30&quot;&nbsp; Aug 8, 2015 at 13:35:00<br />:::<br />:::&nbsp; &nbsp; -U&nbsp; : Returns a UTC timestamp instead of local timestamp.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Default is a local timestamp.<br />:::<br />:::&nbsp; &nbsp; -Z TimeZoneMinuteOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Returns the timestamp using the specified time zone offset.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;TimeZoneMinuteOffset is a JScript numeric expression that<br />:::&nbsp; &nbsp; &nbsp; &nbsp;represents the number of minutes offset from UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Decimal values are truncated.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is empty, meaning local timezone.<br />:::<br />:::&nbsp; &nbsp; -OY YearOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the number of years to offset the base date/time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;The JScript numeric expression is truncated to an integral number.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is 0<br />:::<br />:::&nbsp; &nbsp; -OM MonthOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the number of months to offset the base date/time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;The JScript numeric expression is truncated to an integral number.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is 0<br />:::<br />:::&nbsp; &nbsp; -OD DayOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the number of days to offset the base date/time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;The JScript numeric expression is truncated to an integral number.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is 0<br />:::<br />:::&nbsp; &nbsp; -OH HourOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the number of hours to offset the base date/time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;The JScript numeric expression is truncated to an integral number.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is 0<br />:::<br />:::&nbsp; &nbsp; -ON MinuteOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the number of minutes to offset the base date/time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;The JScript numeric expression is truncated to an integral number.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is 0<br />:::<br />:::&nbsp; &nbsp; -OS SecondOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the number of seconds to offset the base date/time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;The JScript numeric expression is truncated to an integral number.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is 0<br />:::<br />:::&nbsp; &nbsp; -OF MillisecondOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the number of milliseconds to offset the base date/time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;The JScript numeric expression is truncated to an integral number.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is 0<br />:::<br />:::&nbsp; &nbsp; -F FormatString<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the timestamp format.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is &quot;{ISO-TS.}&quot;<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Strings within braces are dynamic components.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;All other strings are literals.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Available components (case insensitive) are:<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{YYYY}&nbsp; 4 digit year, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{YY}&nbsp; &nbsp; 2 digit year, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{Y}&nbsp; &nbsp; &nbsp;year without zero padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{MONTH} month name, as preferentially specified by:<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1) -MONTH option<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2) GetTimestamp-MONTH environment variable<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3) Mixed case, English month names<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{MTH}&nbsp; &nbsp;month abbreviation, as preferentially specified by:<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1) -MTH option<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2) GetTimestamp-MTH environment variable<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3) Mixed case, English month abbreviations<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{MM}&nbsp; &nbsp; 2 digit month number, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{M}&nbsp; &nbsp; &nbsp;month number without zero padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{WEEKDAY} day of week name, as preferentially specified by:<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1) -WEEKDAY option<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2) GetTimestamp-WEEKDAY environment variable<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3) Mixed case, English day names<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{WKD}&nbsp; &nbsp;day of week abbreviation, as preferentially specified by:<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1) -WKD option<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2) GetTimestamp-WKD environment variable<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3) Mixed case, English day abbreviations<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{W}&nbsp; &nbsp; &nbsp;day of week number: 0=Sunday, 6=Saturday<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{DD}&nbsp; &nbsp; 2 digit day of month number, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{D}&nbsp; &nbsp; &nbsp;day of month number, without zero padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{DDY}&nbsp; &nbsp;3 digit day of year number, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{DY}&nbsp; &nbsp; day of year number, without zero padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{HH}&nbsp; &nbsp; 2 digit hours, 24 hour format, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{H}&nbsp; &nbsp; &nbsp;hours, 24 hour format without zero padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{HH12}&nbsp; 2 digit hours, 12 hour format, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{H12}&nbsp; &nbsp;hours, 12 hour format without zero padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{NN}&nbsp; &nbsp; 2 digit minutes, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{N}&nbsp; &nbsp; &nbsp;minutes without padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{SS}&nbsp; &nbsp; 2 digit seconds, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{S}&nbsp; &nbsp; &nbsp;seconds without padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{FFF}&nbsp; &nbsp;3 digit milliseconds, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{F}&nbsp; &nbsp; &nbsp;milliseconds without padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{AM}&nbsp; &nbsp; AM or PM in upper case<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{PM}&nbsp; &nbsp; am or pm in lower case<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ZZZZ}&nbsp; timezone expressed as minutes offset from UTC,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;zero padded to 3 digits with sign<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{Z}&nbsp; &nbsp; &nbsp;timzone expressed as minutes offset from UTC without padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ZS}&nbsp; &nbsp; ISO 8601 timezone sign<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ZH}&nbsp; &nbsp; ISO 8601 timezone hours (no sign)<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ZM}&nbsp; &nbsp; ISO 8601 timezone minutes (no sign)<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{TZ}&nbsp; &nbsp; ISO 8601 timezone in +/-hh:mm format<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISOTS}&nbsp; same as {ISOTS.}<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISOTS.} YYYYMMDDThhmmss.fff+hhss<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Compressed ISO 8601 date/time (timestamp) with milliseconds<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; and time zone, using . as decimal mark<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISOTS,} YYYYMMDDThhmmss,fff+hhss<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Compressed ISO 8601 date/time (timestamp) with milliseconds<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; and time zone, using , as decimal mark<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISODT}&nbsp; YYYYMMDD<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Compressed ISO 8601 date format<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISOTM}&nbsp; same as {ISOTM.}<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISOTM.} hhmmss.fff<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Compressed ISO 8601 time format with milliseconds,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using . as decimal mark<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISOTM,} hhmmss,fff<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Compressed ISO 8601 time format with milliseconds,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using , as decimal mark<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISOTZ}&nbsp; +hhmm<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Compressed ISO 8601 timezone format<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISOWY}&nbsp; yyyy<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ISO 8601 week numbering year<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Dec 29, 30, or 31 may belong to the next Jan year<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Jan 01, 02, or 03 may belong to the prior Dec year<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISOWK}&nbsp; ww<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ISO 8601 week number<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Week 01 is the week with the year's first Thursday<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISOWD}&nbsp; d<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ISO 8601 day of week: 1=Monday, 7=Sunday<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISODTW} yyyyWwwd<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Compressed ISO 8601 week date format<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISODTO} YYYYDDD<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Compressed ISO 8601 ordinal date format<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISO-TS} same as {ISO-TS.}<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISO-TS.} YYYY-MM-DDThh:mm:ss.fff+hh:ss<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ISO 8601 date/time (timestamp) with milliseconds and time zone<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using . as decimal mark<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISO-TS,} YYYY-MM-DDThh:mm:ss,fff+hh:ss<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ISO 8601 date/time (timestamp) with milliseconds and time zone<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using , as decimal mark<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISO-DT} YYYY-MM-DD<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ISO 8601 date format<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISO-TM} same as {ISO-TM.}<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISO-TM.} hh:mm:ss.fff<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ISO 8601 time format with milliseconds,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using . as decimal mark<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISO-TM,} hh:mm:ss,fff<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ISO 8601 time format with milliseconds,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using , as decimal mark<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISO-TZ} +hh:mm<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ISO 8601 timezone&nbsp; (same as {TZ})<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISO-DTW} yyyy-Www-d<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ISO 8601 week date format<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISO-DTO} YYYY-DDD<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ISO 8601 ordinal date format<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{UMS}&nbsp; &nbsp;Milliseconds since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{U}&nbsp; &nbsp; &nbsp;Same as {US}<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{US}&nbsp; &nbsp; Seconds since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{UM}&nbsp; &nbsp; Minutes since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{UH}&nbsp; &nbsp; Hours since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{UD}&nbsp; &nbsp; Days since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{USD}&nbsp; &nbsp;Decimal seconds since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{UMD}&nbsp; &nbsp;Decimal minutes since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{UHD}&nbsp; &nbsp;Decimal hours since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{UDD}&nbsp; &nbsp;Decimal days since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{{}&nbsp; &nbsp; &nbsp;A { character<br />:::<br />:::&nbsp; &nbsp; -R ReturnVariable<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Save the timestamp in ReturnVariable instead of displaying it.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;ReturnVariable is unchanged if an error occurs.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is empty, meaning print to screen.<br />:::<br />:::&nbsp; &nbsp; -WKD &quot;Abbreviated day of week list&quot;<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Override the default day abbreviations with a space delimited,<br />:::&nbsp; &nbsp; &nbsp; &nbsp;quoted list, starting with Sun.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is mixed case, 3 character English day abbreviations.<br />:::<br />:::&nbsp; &nbsp; -WEEKDAY &quot;Day of week list&quot;<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Override the default day names with a space delimited, quoted list,<br />:::&nbsp; &nbsp; &nbsp; &nbsp;starting with Sunday.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is mixed case English day names.<br />:::<br />:::&nbsp; &nbsp; -MTH &quot;Abbreviated month list&quot;<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Override the default month abbreviations with a space delimited,<br />:::&nbsp; &nbsp; &nbsp; &nbsp;quoted list, starting with Jan.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is mixed case, 3 character English month abbreviations.<br />:::<br />:::&nbsp; &nbsp; -MONTH &quot;Month list&quot;<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Override the default month names with a space delimited, quoted list,<br />:::&nbsp; &nbsp; &nbsp; &nbsp;starting with January.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is mixed case English month names.<br />:::<br />:::<br />:::&nbsp; GetTimestamp.bat was written by Dave Benham and originally posted at<br />:::&nbsp; http://www.dostips.com/forum/viewtopic.php?f=3&amp;t=4847<br />:::<br /><br />============= :Batch portion ===========<br />@echo off<br />setlocal enableDelayedExpansion<br /><br />:: Define options<br />set ^&quot;options=^<br />&nbsp;-?:^<br />&nbsp;-??:^<br />&nbsp;-v:^<br />&nbsp;-u:^<br />&nbsp;-z:&quot;&quot;^<br />&nbsp;-f:&quot;{ISO-TS}&quot;^<br />&nbsp;-d:&quot;&quot;^<br />&nbsp;-oy:&quot;&quot;^<br />&nbsp;-om:&quot;&quot;^<br />&nbsp;-od:&quot;&quot;^<br />&nbsp;-oh:&quot;&quot;^<br />&nbsp;-on:&quot;&quot;^<br />&nbsp;-os:&quot;&quot;^<br />&nbsp;-of:&quot;&quot;^<br />&nbsp;-r:&quot;&quot;^<br />&nbsp;-wkd:&quot;Sun Mon Tue Wed Thu Fri Sat&quot;^<br />&nbsp;-weekday:&quot;Sunday Monday Tuesday Wednesday Thursday Friday Saturday&quot;^<br />&nbsp;-mth:&quot;Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec&quot;^<br />&nbsp;-month:&quot;January February March April May June July August September October November December&quot;^&quot;<br /><br />:: Set default option values<br />for %%O in (%options%) do for /f &quot;tokens=1,* delims=:&quot; %%A in (&quot;%%O&quot;) do (<br />&nbsp; if defined GetTimestamp%%A (set &quot;%%A=!GetTimestamp%%A!&quot;) else set &quot;%%A=%%~B&quot;<br />)<br />set &quot;-?=&quot;<br />set &quot;-??=&quot;<br /><br />:: Get options<br />:loop<br />if not &quot;%~1&quot;==&quot;&quot; (<br />&nbsp; set &quot;arg=%~1&quot;<br />&nbsp; if &quot;!arg:~0,1!&quot; equ &quot;/&quot; set &quot;arg=-!arg:~1!&quot;<br />&nbsp; for /f delims^=^ eol^= %%A in (&quot;!arg!&quot;) do set &quot;test=!options:*%%A:=! &quot;<br />&nbsp; if &quot;!test!&quot;==&quot;!options! &quot; (<br />&nbsp; &nbsp; &nbsp; &gt;&amp;2 echo Error: Invalid option %~1. Use %~nx0 -? to get help.<br />&nbsp; &nbsp; &nbsp; exit /b 1<br />&nbsp; ) else if &quot;!test:~0,1!&quot;==&quot; &quot; (<br />&nbsp; &nbsp; &nbsp; set &quot;!arg!=1&quot;<br />&nbsp; &nbsp; &nbsp; if /i &quot;!arg!&quot; equ &quot;-U&quot; set &quot;-z=&quot;<br />&nbsp; ) else (<br />&nbsp; &nbsp; &nbsp; set &quot;!arg!=%~2&quot;<br />&nbsp; &nbsp; &nbsp; shift /1<br />&nbsp; )<br />&nbsp; shift /1<br />&nbsp; goto :loop<br />)<br />if defined -z set &quot;-u=1&quot;<br />if defined -r set &quot;%-r%=&quot;<br /><br />:: Display paged help<br />if defined -?? (<br />&nbsp; (for /f &quot;delims=: tokens=*&quot; %%A in ('findstr &quot;^:::&quot; &quot;%~f0&quot;') do @echo(%%A)|more /e<br />&nbsp; exit /b 0<br />) 2&gt;nul<br /><br />:: Display help<br />if defined -? (<br />&nbsp; for /f &quot;delims=: tokens=*&quot; %%A in ('findstr &quot;^:::&quot; &quot;%~f0&quot;') do echo(%%A<br />&nbsp; exit /b 0<br />)<br /><br />:: Display version<br />if defined -v (<br />&nbsp; for /f &quot;tokens=* delims=:&quot; %%A in ('findstr &quot;^::getTimestamp\.bat&quot; &quot;%~f0&quot;') do @echo(%%A<br />&nbsp; exit /b 0<br />)<br /><br />:: Execute the JScript script and return the result<br />for /f &quot;delims=&quot; %%A in ('cscript //E:JScript //nologo &quot;%~f0&quot;') do (<br />&nbsp; endlocal<br />&nbsp; if &quot;%-R%&quot; neq &quot;&quot; (set &quot;%-R%=%%A&quot;) else (echo(%%A)<br />&nbsp; exit /b 0<br />)<br />exit /b 1;<br /><br /><br />************ JScript portion ***********/<br />var env&nbsp; = WScript.CreateObject(&quot;WScript.Shell&quot;).Environment(&quot;Process&quot;),<br />&nbsp; &nbsp; utc&nbsp; = env('-U'),<br />&nbsp; &nbsp; wkd&nbsp; &nbsp; &nbsp;= env('-WKD').split(' '),<br />&nbsp; &nbsp; weekday = env('-WEEKDAY').split(' '),<br />&nbsp; &nbsp; mth&nbsp; &nbsp; &nbsp;= env('-MTH').split(' '),<br />&nbsp; &nbsp; month&nbsp; &nbsp;= env('-MONTH').split(' '),<br />&nbsp; &nbsp; stderr&nbsp; = WScript.StdErr,<br />&nbsp; &nbsp; y,m,d,w,h,h12,n,s,f,u,z,zs,za,<br />&nbsp; &nbsp; pc=':', pcm=',', pd='-', pp='.', p2='00', p3='000', p4='0000';<br /><br />if (wkd.length!=7)&nbsp; &nbsp; &nbsp;badOp('-WKD');<br />if (weekday.length!=7) badOp('-WEEKDAY');<br />if (mth.length!=12)&nbsp; &nbsp; badOp('-MTH');<br />if (month.length!=12)&nbsp; badOp('-MONTH');<br /><br />try {<br />&nbsp; var dt = eval('new Date('+env('-D')+')');<br />} catch(e) {<br />} finally {<br />&nbsp; if (isNaN(dt)) badOp('-D');<br />}<br /><br />if (env('-OY')) dt.setUTCFullYear(&nbsp; &nbsp; &nbsp;dt.getUTCFullYear()&nbsp; &nbsp; +getNum('-OY') );<br />if (env('-OM')) dt.setUTCMonth(&nbsp; &nbsp; &nbsp; &nbsp; dt.getUTCMonth()&nbsp; &nbsp; &nbsp; &nbsp;+getNum('-OM') );<br />if (env('-OD')) dt.setUTCDate(&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dt.getUTCDate()&nbsp; &nbsp; &nbsp; &nbsp; +getNum('-OD') );<br />if (env('-OH')) dt.setUTCHours(&nbsp; &nbsp; &nbsp; &nbsp; dt.getUTCHours()&nbsp; &nbsp; &nbsp; &nbsp;+getNum('-OH') );<br />if (env('-ON')) dt.setUTCMinutes(&nbsp; &nbsp; &nbsp; dt.getUTCMinutes()&nbsp; &nbsp; &nbsp;+getNum('-ON') );<br />if (env('-OS')) dt.setUTCSeconds(&nbsp; &nbsp; &nbsp; dt.getUTCSeconds()&nbsp; &nbsp; &nbsp;+getNum('-OS') );<br />if (env('-OF')) dt.setUTCMilliseconds( dt.getUTCMilliseconds()+getNum('-OF') );<br />if (env('-Z'))&nbsp; dt.setUTCMinutes(&nbsp; &nbsp; &nbsp; dt.getUTCMinutes()&nbsp; +(z=getNum('-Z')) );<br /><br />y = utc ? dt.getUTCFullYear(): dt.getFullYear();<br />m = utc ? dt.getUTCMonth()&nbsp; &nbsp;: dt.getMonth();<br />d = utc ? dt.getUTCDate()&nbsp; &nbsp; : dt.getDate();<br />w = utc ? dt.getUTCDay()&nbsp; &nbsp; &nbsp;: dt.getDay();<br />h = utc ? dt.getUTCHours()&nbsp; &nbsp;: dt.getHours();<br />n = utc ? dt.getUTCMinutes() : dt.getMinutes();<br />s = utc ? dt.getUTCSeconds() : dt.getSeconds();<br />f = utc ? dt.getUTCMilliseconds() : dt.getMilliseconds();<br />u = dt.getTime();<br /><br />h12 = h%12;<br />if (!h12) h12=12;<br /><br />if (z==undefined) if (utc) z=0; else z=-dt.getTimezoneOffset();<br />zs = z&lt;0 ? '-' : '+';<br />za = Math.abs(z);<br /><br />WScript.echo( env('-F').replace( /\{(.*?)\}/gi, repl ) );<br />WScript.Quit(0);<br /><br />function lpad( val, pad ) {<br />&nbsp; var rtn=val.toString();<br />&nbsp; return (rtn.length&lt;pad.length) ? (pad+rtn).slice(-pad.length) : val;<br />}<br /><br />function getNum( v ) {<br />&nbsp; var rtn;<br />&nbsp; try {<br />&nbsp; &nbsp; rtn = Number(eval(env(v)));<br />&nbsp; } catch(e) {<br />&nbsp; } finally {<br />&nbsp; &nbsp; if (isNaN(rtn-rtn)) badOp(v);<br />&nbsp; &nbsp; return rtn;<br />&nbsp; }<br />}<br /><br />function badOp(option) {<br />&nbsp; stderr.WriteLine('Error: Invalid '+option+' value');<br />&nbsp; WScript.Quit(1);<br />}<br /><br />function trunc( n ) { return Math&#91;n&gt;0?&quot;floor&quot;:&quot;ceil&quot;&#93;(n); }<br /><br />function weekNum(dt) {<br />&nbsp; &nbsp;var dt2 = new Date(dt.valueOf());<br />&nbsp; &nbsp;var day = (dt.getDay()+6)%7;<br />&nbsp; &nbsp;dt2.setDate(dt2.getDate()-day+3);<br />&nbsp; &nbsp;var now = dt2.valueOf();<br />&nbsp; &nbsp;dt2.setMonth(0, 1);<br />&nbsp; &nbsp;if (dt2.getDay() != 4) {<br />&nbsp; &nbsp;&nbsp; &nbsp;dt2.setMonth( 0, (11-dt2.getDay())%7 + 1 );<br />&nbsp; &nbsp;}<br />&nbsp; &nbsp;return 1 + Math.ceil((now-dt2.valueOf())/604800000);<br />}<br /><br />function weekYr(dt) {<br />&nbsp; &nbsp;var dt2 = new Date(dt.valueOf());<br />&nbsp; &nbsp;dt2.setDate(dt2.getDate()+3-(dt.getDay()+6)%7);<br />&nbsp; &nbsp;return dt2.getFullYear();<br />}<br /><br />function repl($0,$1) {<br />&nbsp; switch ($1.toUpperCase()) {<br />&nbsp; &nbsp; case 'YYYY' : return lpad(y,p4);<br />&nbsp; &nbsp; case 'YY'&nbsp; &nbsp;: return (p2+y.toString()).slice(-2);<br />&nbsp; &nbsp; case 'Y'&nbsp; &nbsp; : return y.toString();<br />&nbsp; &nbsp; case 'MM'&nbsp; &nbsp;: return lpad(m+1,p2);<br />&nbsp; &nbsp; case 'M'&nbsp; &nbsp; : return (m+1).toString();<br />&nbsp; &nbsp; case 'DD'&nbsp; &nbsp;: return lpad(d,p2);<br />&nbsp; &nbsp; case 'D'&nbsp; &nbsp; : return d.toString();<br />&nbsp; &nbsp; case 'W'&nbsp; &nbsp; : return w.toString();<br />&nbsp; &nbsp; case 'DY'&nbsp; &nbsp;: return trunc(((new Date(y,m,d)).getTime()-(new Date(y,0,0)).getTime())/86400000).toString();<br />&nbsp; &nbsp; case 'DDY'&nbsp; : return lpad( trunc(((new Date(y,m,d)).getTime()-(new Date(y,0,0)).getTime())/86400000), p3);<br />&nbsp; &nbsp; case 'HH'&nbsp; &nbsp;: return lpad(h,p2);<br />&nbsp; &nbsp; case 'H'&nbsp; &nbsp; : return h.toString();<br />&nbsp; &nbsp; case 'HH12' : return lpad(h12,p2);<br />&nbsp; &nbsp; case 'H12'&nbsp; : return h12.toString();<br />&nbsp; &nbsp; case 'NN'&nbsp; &nbsp;: return lpad(n,p2);<br />&nbsp; &nbsp; case 'N'&nbsp; &nbsp; : return n.toString();<br />&nbsp; &nbsp; case 'SS'&nbsp; &nbsp;: return lpad(s,p2);<br />&nbsp; &nbsp; case 'S'&nbsp; &nbsp; : return s.toString();<br />&nbsp; &nbsp; case 'FFF'&nbsp; : return lpad(f,p3);<br />&nbsp; &nbsp; case 'F'&nbsp; &nbsp; : return f.toString();<br />&nbsp; &nbsp; case 'AM'&nbsp; &nbsp;: return h&gt;=12 ? 'PM' : 'AM';<br />&nbsp; &nbsp; case 'PM'&nbsp; &nbsp;: return h&gt;=12 ? 'pm' : 'am';<br />&nbsp; &nbsp; case 'UMS'&nbsp; : return u.toString();<br />&nbsp; &nbsp; case 'USD'&nbsp; : return (u/1000).toString();<br />&nbsp; &nbsp; case 'UMD'&nbsp; : return (u/1000/60).toString();<br />&nbsp; &nbsp; case 'UHD'&nbsp; : return (u/1000/60/60).toString();<br />&nbsp; &nbsp; case 'UDD'&nbsp; : return (u/1000/60/60/24).toString();<br />&nbsp; &nbsp; case 'U'&nbsp; &nbsp; :<br />&nbsp; &nbsp; case 'US'&nbsp; &nbsp;: return trunc(u/1000).toString();<br />&nbsp; &nbsp; case 'UM'&nbsp; &nbsp;: return trunc(u/1000/60).toString();<br />&nbsp; &nbsp; case 'UH'&nbsp; &nbsp;: return trunc(u/1000/60/60).toString();<br />&nbsp; &nbsp; case 'UD'&nbsp; &nbsp;: return trunc(u/1000/60/60/24).toString();<br />&nbsp; &nbsp; case 'ZZZZ' : return zs+lpad(za,p3);<br />&nbsp; &nbsp; case 'Z'&nbsp; &nbsp; : return z.toString();<br />&nbsp; &nbsp; case 'ZS'&nbsp; &nbsp;: return zs;<br />&nbsp; &nbsp; case 'ZH'&nbsp; &nbsp;: return lpad(trunc(za/60),p2);<br />&nbsp; &nbsp; case 'ZM'&nbsp; &nbsp;: return lpad(za%60,p2);<br />&nbsp; &nbsp; case 'TZ'&nbsp; &nbsp;:<br />&nbsp; &nbsp; case 'ISO-TZ' : return ''+zs+lpad(trunc(za/60),p2)+pc+lpad(za%60,p2);<br />&nbsp; &nbsp; case 'ISOTS'&nbsp; :<br />&nbsp; &nbsp; case 'ISOTS.' : return ''+lpad(y,p4)+lpad(m+1,p2)+lpad(d,p2)+'T'+lpad(h,p2)+lpad(n,p2)+lpad(s,p2)+pp+lpad(f,p3)+zs+lpad(trunc(za/60),p2)+lpad(za%60,p2);<br />&nbsp; &nbsp; case 'ISOTS,' : return ''+lpad(y,p4)+lpad(m+1,p2)+lpad(d,p2)+'T'+lpad(h,p2)+lpad(n,p2)+lpad(s,p2)+pcm+lpad(f,p3)+zs+lpad(trunc(za/60),p2)+lpad(za%60,p2);<br />&nbsp; &nbsp; case 'ISODT'&nbsp; : return ''+lpad(y,p4)+lpad(m+1,p2)+lpad(d,p2);<br />&nbsp; &nbsp; case 'ISOTM'&nbsp; :<br />&nbsp; &nbsp; case 'ISOTM.' : return ''+lpad(h,p2)+lpad(n,p2)+lpad(s,p2)+pp+lpad(f,p3);<br />&nbsp; &nbsp; case 'ISOTM,' : return ''+lpad(h,p2)+lpad(n,p2)+lpad(s,p2)+pcm+lpad(f,p3);<br />&nbsp; &nbsp; case 'ISOTZ'&nbsp; : return ''+zs+lpad(trunc(za/60),p2)+lpad(za%60,p2);<br />&nbsp; &nbsp; case 'ISO-TS' :<br />&nbsp; &nbsp; case 'ISO-TS.': return ''+lpad(y,p4)+pd+lpad(m+1,p2)+pd+lpad(d,p2)+'T'+lpad(h,p2)+pc+lpad(n,p2)+pc+lpad(s,p2)+pp+lpad(f,p3)+zs+lpad(trunc(za/60),p2)+pc+lpad(za%60,p2);<br />&nbsp; &nbsp; case 'ISO-TS,': return ''+lpad(y,p4)+pd+lpad(m+1,p2)+pd+lpad(d,p2)+'T'+lpad(h,p2)+pc+lpad(n,p2)+pc+lpad(s,p2)+pcm+lpad(f,p3)+zs+lpad(trunc(za/60),p2)+pc+lpad(za%60,p2);<br />&nbsp; &nbsp; case 'ISO-DT' : return ''+lpad(y,p4)+pd+lpad(m+1,p2)+pd+lpad(d,p2);<br />&nbsp; &nbsp; case 'ISO-TM' :<br />&nbsp; &nbsp; case 'ISO-TM.': return ''+lpad(h,p2)+pc+lpad(n,p2)+pc+lpad(s,p2)+pp+lpad(f,p3);<br />&nbsp; &nbsp; case 'ISO-TM,': return ''+lpad(h,p2)+pc+lpad(n,p2)+pc+lpad(s,p2)+pcm+lpad(f,p3);<br />&nbsp; &nbsp; case 'ISOWY'&nbsp; : return ''+lpad(weekYr(dt),p4);<br />&nbsp; &nbsp; case 'ISOWK'&nbsp; : return ''+lpad(weekNum(dt),p2);<br />&nbsp; &nbsp; case 'ISOWD'&nbsp; : return ''+((w+6)%7+1);<br />&nbsp; &nbsp; case 'ISODTW' : return ''+lpad(weekYr(dt),p4)+'W'+lpad(weekNum(dt),p2)+((w+6)%7+1);<br />&nbsp; &nbsp; case 'ISODTO' : return ''+lpad(y,p4)+lpad( trunc(((new Date(y,m,d)).getTime()-(new Date(y,0,0)).getTime())/86400000), p3);<br />&nbsp; &nbsp; case 'ISO-DTW': return ''+lpad(weekYr(dt),p4)+pd+'W'+lpad(weekNum(dt),p2)+pd+((w+6)%7+1);<br />&nbsp; &nbsp; case 'ISO-DTO': return ''+lpad(y,p4)+pd+lpad( trunc(((new Date(y,m,d)).getTime()-(new Date(y,0,0)).getTime())/86400000), p3);<br />&nbsp; &nbsp; case 'WEEKDAY': return weekday&#91;w&#93;;<br />&nbsp; &nbsp; case 'WKD'&nbsp; &nbsp; : return wkd&#91;w&#93;;<br />&nbsp; &nbsp; case 'MONTH'&nbsp; : return month&#91;m&#93;;<br />&nbsp; &nbsp; case 'MTH'&nbsp; &nbsp; : return mth&#91;m&#93;;<br />&nbsp; &nbsp; case '{'&nbsp; &nbsp; &nbsp; : return $1;<br />&nbsp; &nbsp; default&nbsp; &nbsp; &nbsp; &nbsp;: return $0;<br />&nbsp; }<br />}<br /></code></pre></div><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p47664" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile47664">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content47664">

						<h3 ><a href="#p47664">Re: getTimestamp.bat for time and date processing</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting7bcd.html?mode=quote&amp;f=3&amp;p=47664" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopica619.html?p=47664#p47664" onclick="prompt('Message #40',this.href); return false;">#40</a></span> 
									<a class="unread" href="viewtopica619.html?p=47664#p47664" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>09 Jul 2016 14:52
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>foxidrive wrote:</cite>Dave, I have a task to add these times one-by-one and get a cumulative result from each step, but also adding the day in a 2 digit zero padded figure.<br /><br />Can you give me a clue please?<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>00:00:00:000<br />01:25:56.606<br />01:29:11.410<br />01:30:35.314<br />01:28:31.956<br />00:46:53.378<br />01:30:01.046<br />01:30:21.032<br />01:32:05.801<br />01:30:50.729<br />01:30:44.546<br />01:31:11.407<br />01:29:52.438<br />00:47:12.321<br />01:40:47.929<br />01:29:07.127<br />00:47:58.977<br />01:31:00.337<br />01:31:01.505<br />01:29:55.248<br />01:32:21.105</code></pre></div></div></blockquote><br /><br />It is fairly straight forward (once you have my v2.5 release that fixes a bug with offset computations).<br /><br />You need to do the computations as miliseconds past midnight 1/1/1970 UTC.<br /><br />The standard string date parser recognizes dates like 'mm/dd/yyyy HH:MM:SS UTC', but unfortunately it does not recognize fractional seconds. So you need to add the fractional seconds using the -OF option. You also keep a running tally of the total milliseconds, which needs to be added to each value as well. I initialize my total to 0 at the start.<br /><br />So I use a simple FOR loop to iterate the raw strings, and a FOR /F to separate the fractional seconds from the rest of the time.<br /><br />Note that JScript treats 0 prefixed numbers as octal (unless it sees an 8 or 9 digit, in which case it switches to decimal - very screwy). So I use the standard trick of prefixing the string with 1 and then subtracting 1000.<br /><br />So the first JREPL treats the time interval as the number of milliseconds past midnight 1/1/1970 UTC, and also adds the previous total value, and stores the result as the new total.<br /><br />The 2nd JREPL simply formats the time value appropriately. I don't have a built in way to specify the number of digits to display for the {UD} value, so I use the standard trick of prefixing the value with leading zeros, and then use a variable substring op to get the correct value.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />setlocal enableDelayedExpansion<br />set &quot;total=0&quot;&nbsp; cumulative total in msec<br />for %%T in (<br />&nbsp; 00:00:00.000<br />&nbsp; 01:25:56.606<br />&nbsp; 01:29:11.410<br />&nbsp; 01:30:35.314<br />&nbsp; 01:28:31.956<br />&nbsp; 00:46:53.378<br />&nbsp; 01:30:01.046<br />&nbsp; 01:30:21.032<br />&nbsp; 01:32:05.801<br />&nbsp; 01:30:50.729<br />&nbsp; 01:30:44.546<br />&nbsp; 01:31:11.407<br />&nbsp; 01:29:52.438<br />&nbsp; 00:47:12.321<br />&nbsp; 01:40:47.929<br />&nbsp; 01:29:07.127<br />&nbsp; 00:47:58.977<br />&nbsp; 01:31:00.337<br />&nbsp; 01:31:01.505<br />&nbsp; 01:29:55.248<br />&nbsp; 01:32:21.105<br />) do for /f &quot;delims=. tokens=1,2&quot; %%A in (&quot;%%T&quot;) do (<br />&nbsp; call getTimestamp -d &quot;'1/1/1970 %%A UTC'&quot; -of &quot;1%%B-1000+!total!&quot; -f &quot;{ums}&quot; -r total<br />&nbsp; call getTimestamp -d !total! -u -f 0{ud}:{hh}:{nn}:{ss}.{fff} -r result<br />&nbsp; echo !result:~-15!<br />)<br /></code></pre></div>--OUTPUT--<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>00:00:00:00.000<br />00:01:25:56.606<br />00:02:55:08.016<br />00:04:25:43.330<br />00:05:54:15.286<br />00:06:41:08.664<br />00:08:11:09.710<br />00:09:41:30.742<br />00:11:13:36.543<br />00:12:44:27.272<br />00:14:15:11.818<br />00:15:46:23.225<br />00:17:16:15.663<br />00:18:03:27.984<br />00:19:44:15.913<br />00:21:13:23.040<br />00:22:01:22.017<br />00:23:32:22.354<br />01:01:03:23.859<br />01:02:33:19.107<br />01:04:05:40.212<br /></code></pre></div><br /><br />The technique can easily be extended to support day values in your input. I add the days into the computation using the -OD option. Obviously I had to modify my loop parsing a bit. I opted to set my day width to 3 characters, with leading spaces instead of zeros.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />setlocal enableDelayedExpansion<br />set &quot;total=0&quot;&nbsp; cumulative total in msec<br />for %%T in (<br />&nbsp; 0:00:00:00.000<br />&nbsp; 0:01:25:56.606<br />&nbsp; 1:01:29:11.410<br />&nbsp; 0:01:30:35.314<br />&nbsp; 0:01:28:31.956<br />&nbsp;19:00:46:53.378<br />&nbsp; 0:01:30:01.046<br />&nbsp; 0:01:30:21.032<br />&nbsp; 0:01:32:05.801<br />&nbsp;13:01:30:50.729<br />&nbsp; 0:01:30:44.546<br />&nbsp; 9:01:31:11.407<br />&nbsp;27:01:29:52.438<br />&nbsp; 0:00:47:12.321<br />&nbsp;65:01:40:47.929<br />&nbsp; 0:01:29:07.127<br />&nbsp; 0:00:47:58.977<br />&nbsp; 0:01:31:00.337<br />&nbsp; 0:01:31:01.505<br />&nbsp; 0:01:29:55.248<br />&nbsp; 0:01:32:21.105<br />) do for /f &quot;delims=: tokens=1*&quot; %%D in (&quot;%%T&quot;) do for /f &quot;delims=. tokens=1,2&quot; %%A in (&quot;%%E&quot;) do (<br />&nbsp; call getTimestamp -d &quot;'1/1/1970 %%A UTC'&quot; -od %%D -of &quot;1%%B-1000+!total!&quot; -f &quot;{ums}&quot; -r total<br />&nbsp; call getTimestamp -d !total! -u -f &quot;&nbsp; {ud}:{hh}:{nn}:{ss}.{fff}&quot; -r result<br />&nbsp; echo !result:~-16!<br />)<br /></code></pre></div>--OUTPUT--<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&nbsp; 0:00:00:00.000<br />&nbsp; 0:01:25:56.606<br />&nbsp; 1:02:55:08.016<br />&nbsp; 1:04:25:43.330<br />&nbsp; 1:05:54:15.286<br />&nbsp;20:06:41:08.664<br />&nbsp;20:08:11:09.710<br />&nbsp;20:09:41:30.742<br />&nbsp;20:11:13:36.543<br />&nbsp;33:12:44:27.272<br />&nbsp;33:14:15:11.818<br />&nbsp;42:15:46:23.225<br />&nbsp;69:17:16:15.663<br />&nbsp;69:18:03:27.984<br />134:19:44:15.913<br />134:21:13:23.040<br />134:22:01:22.017<br />134:23:32:22.354<br />135:01:03:23.859<br />135:02:33:19.107<br />135:04:05:40.212<br /></code></pre></div><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p47676" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile47676">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf147.html?author_id=3221&amp;sr=posts">6033</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Feb 2012 02:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content47676">

						<h3 ><a href="#p47676">Re: getTimestamp.bat for time and date processing</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingb0b2.html?mode=quote&amp;f=3&amp;p=47676" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicb91a.html?p=47676#p47676" onclick="prompt('Message #41',this.href); return false;">#41</a></span> 
									<a class="unread" href="viewtopicb91a.html?p=47676#p47676" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a></strong> &raquo; </span>10 Jul 2016 06:26
			</p>
			
			
			
			<div class="content">Thank you Dave, you've been very kind.  <br /><br />That's great!  :thumbsup:</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p47680" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile47680">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content47680">

						<h3 ><a href="#p47680">Re: getTimestamp.bat for time and date processing</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingc43c-2.html?mode=quote&amp;f=3&amp;p=47680" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicdf8d.html?p=47680#p47680" onclick="prompt('Message #42',this.href); return false;">#42</a></span> 
									<a class="unread" href="viewtopicdf8d.html?p=47680#p47680" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>10 Jul 2016 12:33
			</p>
			
			
			
			<div class="content">My last version fixed a problem with the date/time offset options, but it also lost the ability to add days or months without changing the local time. Adding days and months results in a change that is an exact multiple of 24 hours, so the local hour may change if the daylight savings conditions changes.<br /><br />For example, if the timestamp were 1AM on 1/10/2016 on the U.S. coast where I live (6:00 UTC), then use of -OM 6 (add 6 months) would result in a local time of 2AM instead of 1AM because of the switch-over from standard time to daylight savings. Note that UTC time would be perfectly fine, since it does not observe daylight savings - the UTC time would remain at 6:00.<br /><br />I've added the -OLM and -OLD options to allow addition of local months and days in a way that preserves the local hour. Thus the change may not be an even multiple of 24 hours. So going back to my example of 1/10/2016 1:00 AM EST, adding -OLM 6 would preserve the local time of 1:00 (but the UTC time will have gone from 6:00 to 5:00).<br /><br /><strong class="text-strong">getTimestamp.bat version 2.6</strong><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@if (@X)==(@Y) @end&nbsp; /* harmless hybrid line that begins a JScript comment<br />@goto :batch<br />::<br />::getTimestamp.bat version 2.6 by Dave Benham<br />::<br />::&nbsp; Release History:<br />::&nbsp; &nbsp; 2.6 2016-07-10 - Added -OLM and -OLD to allow addition of months/years<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;without changing the local hour. In other words, the<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;computation compensates for changes in dayling savings<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;conditions.<br />::&nbsp; &nbsp; 2.5 2016-07-09 - Fixed bug with offset computations when the before and<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;after have different time zones due to daylight savings.<br />::&nbsp; &nbsp; 2.4 2015-11-27 - Added formats to support comma as decimal mark in<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ISO 8601 time and timestamp formats.<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Added formats to support ISO 8601 week dates<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;and ordinal dates.<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Rearranged documentation, and added examples for<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;base date specified as a list of numeric values.<br />::&nbsp; &nbsp; 2.3 2015-07-11 - Added {ISO-xx}, {ISOxx}, {DY} and {DDY} formats<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Added -?? (paged help) option<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Allow user defined default option values by defining<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;variables of the form &quot;GetTimestamp-OPTION=VALUE&quot;<br />::&nbsp; &nbsp; 2.2 2014-12-03 - Doc fix: -R ReturnVariable is unchanged if err occurs<br />::&nbsp; &nbsp; 2.1 2014-12-03 - Added GOTO at top to increase performance (32% faster)<br />::&nbsp; &nbsp; 2.0 2014-12-02 - Major rewrite: most code now in JScript (25% faster)<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Better error handling<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;May now use /Option or -Option<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Added -V option<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Added {{} format value to enable unambiguous { literal<br />::&nbsp; &nbsp; 1.1 ????-??-?? - Added -Z option and obscure bug fixes<br />::&nbsp; &nbsp; 1.0 2013-07-17 - Initial release<br />::<br />::============ Documentation ===========<br />:::<br />:::getTimestamp&nbsp; &#91;-option &#91;value&#93;&#93;...<br />:::<br />:::&nbsp; Displays a formatted timestamp. Defaults to the current local date<br />:::&nbsp; and time using an ISO 8601 format with milliseconds, time zone<br />:::&nbsp; and punctuation, using period as a decimal mark.<br />:::<br />:::&nbsp; Returned ERRORLEVEL is 0 upon success, 1 if failure.<br />:::<br />:::&nbsp; Options may be prefaced with - or /<br />:::<br />:::&nbsp; All options have default values. The default value can be overridden by<br />:::&nbsp; defining an evironment variable of the form &quot;GetTimestamp-OPTION=VALUE&quot;.<br />:::&nbsp; For example, upper case English weekday abbreviations can be specified as<br />:::&nbsp; the default by defining &quot;GetTimestamp-WKD=SUN MON TUE WED THU FRI SAT&quot;.<br />:::<br />:::&nbsp; Command line option values take precedence, followed by environment variable<br />:::&nbsp; defaults, followed by built in defaults.<br />:::<br />:::&nbsp; The following options are all case insensitive:<br />:::<br />:::&nbsp; &nbsp; -?&nbsp; : Prints this documentation for getTimestamp<br />:::<br />:::&nbsp; &nbsp; -?? : Prints this documentation with pagination via MORE<br />:::<br />:::&nbsp; &nbsp; -V&nbsp; : Prints the version of getTimeStamp<br />:::<br />:::&nbsp; &nbsp; -D DateSpec<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the base date and time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default value is current local date and time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;The DateSpec supports many formats:<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;&quot;&nbsp; &nbsp; (no value)<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Current date and time - the default<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;milliseconds<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;A JScript numeric expression that represents the number of<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;milliseconds since 1970-01-01 00:00:00 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Decimal values are truncated.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative values represent dates prior to 1970-01-01.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'Date &#91;Time&#93; &#91;TimeZone&#93;'&quot;<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;A string representation of the date and time. The date information<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;is required, the time and time zone are optional. Missing time info<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;is assumed to be 0 (midnight). Missing time zone info is assumed to<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;be local time zone.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;The Date, Time, and TimeZone information can be represented as any<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;string that is accepted by the JScript Date.Parse() method.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;There are many formatting options. Documentation is available at:<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;http://msdn.microsoft.com/en-us/library/k4w173wk(v=vs.84).aspx<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Examples of equivalent representations of Midnight on January 4,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2013 assuming local time zone is U.S Eastern Standard Time (EST):<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'1-4-2013'&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Defaults to local time zone<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'January 4, 2013 EST'&quot;&nbsp; &nbsp; &nbsp; &nbsp;Explicit Eastern Std Time (US)<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'2013/1/4 -05'&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Explicit Eastern Std Time (US)<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'Jan 3 2013 23: CST'&quot;&nbsp; &nbsp; &nbsp; &nbsp; Central Standard Time (US)<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'2013 3 Jan 9:00 pm -0800'&quot;&nbsp; Pacific Standard Time (US)<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'01/04/2013 05:00:00 UTC'&quot;&nbsp; &nbsp;Universal Coordinated Time<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'1/4/2013 05:30 +0530'&quot;&nbsp; &nbsp; &nbsp; India Standard Time<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;year, month&#91;, day&#91;, hour&#91;, minute&#91;, second&#91;, millisecond&#93;&#93;&#93;&#93;&#93;&quot;<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;A comma delimited list of numeric JScript expressions representing<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;various components of date and time. Year and month are required,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the rest are optional. Missing values are treated as 0.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Decimal values are truncated. A 0 month represents January.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;A 1 day represents the first day of the month. A 0 day represents<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the last day of the prior month. The date/time value is always<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;in local time. There is no mechanism to specify a time zone.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Examples: (all in local time)<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;2012,0,1,12,45,3,121&quot;&nbsp; 12:45:03.121 on Jan 1, 2012<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;2012,0,1,12&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Noon on Jan 1, 2012<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;2012,1,1&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Midnight on Feb 1, 2012<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;2012,2,0&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Midnight on Feb 29, 2012 (last day of Feb)<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;2012,2&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Midnight on Feb 29, 2012 (last day of Feb)<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;The ability to use JScript expressions makes it convenient to do<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;date and time offset computations in a very compact form.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;For example, starting with:<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;2015,8,7,14,5&quot;&nbsp; &nbsp; &nbsp; &nbsp; Sep 7, 2015 at 14:05:00<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;It is simple to subtract 30 days and 30 minutes from the above:<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;2015,8,7-30,14,5-30&quot;&nbsp; Aug 8, 2015 at 13:35:00<br />:::<br />:::&nbsp; &nbsp; -U&nbsp; : Returns a UTC timestamp instead of local timestamp.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Default is a local timestamp.<br />:::<br />:::&nbsp; &nbsp; -Z TimeZoneMinuteOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Returns the timestamp using the specified time zone offset.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;TimeZoneMinuteOffset is a JScript numeric expression that<br />:::&nbsp; &nbsp; &nbsp; &nbsp;represents the number of minutes offset from UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Decimal values are truncated.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is empty, meaning local timezone.<br />:::<br />:::&nbsp; &nbsp; -OY YearOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the number of years to offset the base date/time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;The JScript numeric expression is truncated to an integral number.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is 0<br />:::<br />:::&nbsp; &nbsp; -OM MonthOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the number of months to offset the base date/time, ignoring<br />:::&nbsp; &nbsp; &nbsp; &nbsp;local daylight savings conditions. The change is guaranteed to be a<br />:::&nbsp; &nbsp; &nbsp; &nbsp;multiple of 24 hours. The JScript numeric expression is truncated to<br />:::&nbsp; &nbsp; &nbsp; &nbsp;an integral number. Default is 0<br />:::<br />:::&nbsp; &nbsp; -OLM LocalMonthOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the number of months to offset the base date/time, taking into<br />:::&nbsp; &nbsp; &nbsp; &nbsp;account local daylight savings conditions. The change may not be a<br />:::&nbsp; &nbsp; &nbsp; &nbsp;multiple of 24 hours if the offset results in a change from standard<br />:::&nbsp; &nbsp; &nbsp; &nbsp;to daylight savings, or vice versa. The JScript numeric expression is<br />:::&nbsp; &nbsp; &nbsp; &nbsp;truncated to an integral number. Default is 0<br />:::<br />:::&nbsp; &nbsp; -OD DayOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the number of days to offset the base date/time, ignoring<br />:::&nbsp; &nbsp; &nbsp; &nbsp;local daylight savings conditions. The change is guaranteed to be a<br />:::&nbsp; &nbsp; &nbsp; &nbsp;multiple of 24 hours. The JScript numeric expression is truncated to<br />:::&nbsp; &nbsp; &nbsp; &nbsp;an integral number. Default is 0<br />:::<br />:::&nbsp; &nbsp; -OLD LocalDayOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the number of days to offset the base date/time, taking into<br />:::&nbsp; &nbsp; &nbsp; &nbsp;account local daylight savings conditions. The change may not be a<br />:::&nbsp; &nbsp; &nbsp; &nbsp;multiple of 24 hours if the offset results in a change from standard<br />:::&nbsp; &nbsp; &nbsp; &nbsp;to daylight savings, or vice versa. The JScript numeric expression is<br />:::&nbsp; &nbsp; &nbsp; &nbsp;truncated to an integral number. Default is 0<br />:::<br />:::&nbsp; &nbsp; -OH HourOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the number of hours to offset the base date/time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;The JScript numeric expression is truncated to an integral number.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is 0<br />:::<br />:::&nbsp; &nbsp; -ON MinuteOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the number of minutes to offset the base date/time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;The JScript numeric expression is truncated to an integral number.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is 0<br />:::<br />:::&nbsp; &nbsp; -OS SecondOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the number of seconds to offset the base date/time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;The JScript numeric expression is truncated to an integral number.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is 0<br />:::<br />:::&nbsp; &nbsp; -OF MillisecondOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the number of milliseconds to offset the base date/time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;The JScript numeric expression is truncated to an integral number.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is 0<br />:::<br />:::&nbsp; &nbsp; -F FormatString<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the timestamp format.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is &quot;{ISO-TS.}&quot;<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Strings within braces are dynamic components.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;All other strings are literals.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Available components (case insensitive) are:<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{YYYY}&nbsp; 4 digit year, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{YY}&nbsp; &nbsp; 2 digit year, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{Y}&nbsp; &nbsp; &nbsp;year without zero padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{MONTH} month name, as preferentially specified by:<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1) -MONTH option<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2) GetTimestamp-MONTH environment variable<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3) Mixed case, English month names<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{MTH}&nbsp; &nbsp;month abbreviation, as preferentially specified by:<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1) -MTH option<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2) GetTimestamp-MTH environment variable<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3) Mixed case, English month abbreviations<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{MM}&nbsp; &nbsp; 2 digit month number, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{M}&nbsp; &nbsp; &nbsp;month number without zero padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{WEEKDAY} day of week name, as preferentially specified by:<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1) -WEEKDAY option<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2) GetTimestamp-WEEKDAY environment variable<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3) Mixed case, English day names<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{WKD}&nbsp; &nbsp;day of week abbreviation, as preferentially specified by:<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1) -WKD option<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2) GetTimestamp-WKD environment variable<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3) Mixed case, English day abbreviations<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{W}&nbsp; &nbsp; &nbsp;day of week number: 0=Sunday, 6=Saturday<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{DD}&nbsp; &nbsp; 2 digit day of month number, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{D}&nbsp; &nbsp; &nbsp;day of month number, without zero padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{DDY}&nbsp; &nbsp;3 digit day of year number, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{DY}&nbsp; &nbsp; day of year number, without zero padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{HH}&nbsp; &nbsp; 2 digit hours, 24 hour format, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{H}&nbsp; &nbsp; &nbsp;hours, 24 hour format without zero padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{HH12}&nbsp; 2 digit hours, 12 hour format, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{H12}&nbsp; &nbsp;hours, 12 hour format without zero padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{NN}&nbsp; &nbsp; 2 digit minutes, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{N}&nbsp; &nbsp; &nbsp;minutes without padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{SS}&nbsp; &nbsp; 2 digit seconds, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{S}&nbsp; &nbsp; &nbsp;seconds without padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{FFF}&nbsp; &nbsp;3 digit milliseconds, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{F}&nbsp; &nbsp; &nbsp;milliseconds without padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{AM}&nbsp; &nbsp; AM or PM in upper case<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{PM}&nbsp; &nbsp; am or pm in lower case<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ZZZZ}&nbsp; timezone expressed as minutes offset from UTC,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;zero padded to 3 digits with sign<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{Z}&nbsp; &nbsp; &nbsp;timzone expressed as minutes offset from UTC without padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ZS}&nbsp; &nbsp; ISO 8601 timezone sign<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ZH}&nbsp; &nbsp; ISO 8601 timezone hours (no sign)<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ZM}&nbsp; &nbsp; ISO 8601 timezone minutes (no sign)<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{TZ}&nbsp; &nbsp; ISO 8601 timezone in +/-hh:mm format<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISOTS}&nbsp; same as {ISOTS.}<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISOTS.} YYYYMMDDThhmmss.fff+hhss<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Compressed ISO 8601 date/time (timestamp) with milliseconds<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; and time zone, using . as decimal mark<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISOTS,} YYYYMMDDThhmmss,fff+hhss<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Compressed ISO 8601 date/time (timestamp) with milliseconds<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; and time zone, using , as decimal mark<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISODT}&nbsp; YYYYMMDD<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Compressed ISO 8601 date format<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISOTM}&nbsp; same as {ISOTM.}<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISOTM.} hhmmss.fff<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Compressed ISO 8601 time format with milliseconds,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using . as decimal mark<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISOTM,} hhmmss,fff<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Compressed ISO 8601 time format with milliseconds,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using , as decimal mark<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISOTZ}&nbsp; +hhmm<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Compressed ISO 8601 timezone format<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISOWY}&nbsp; yyyy<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ISO 8601 week numbering year<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Dec 29, 30, or 31 may belong to the next Jan year<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Jan 01, 02, or 03 may belong to the prior Dec year<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISOWK}&nbsp; ww<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ISO 8601 week number<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Week 01 is the week with the year's first Thursday<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISOWD}&nbsp; d<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ISO 8601 day of week: 1=Monday, 7=Sunday<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISODTW} yyyyWwwd<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Compressed ISO 8601 week date format<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISODTO} YYYYDDD<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Compressed ISO 8601 ordinal date format<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISO-TS} same as {ISO-TS.}<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISO-TS.} YYYY-MM-DDThh:mm:ss.fff+hh:ss<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ISO 8601 date/time (timestamp) with milliseconds and time zone<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using . as decimal mark<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISO-TS,} YYYY-MM-DDThh:mm:ss,fff+hh:ss<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ISO 8601 date/time (timestamp) with milliseconds and time zone<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using , as decimal mark<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISO-DT} YYYY-MM-DD<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ISO 8601 date format<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISO-TM} same as {ISO-TM.}<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISO-TM.} hh:mm:ss.fff<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ISO 8601 time format with milliseconds,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using . as decimal mark<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISO-TM,} hh:mm:ss,fff<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ISO 8601 time format with milliseconds,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using , as decimal mark<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISO-TZ} +hh:mm<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ISO 8601 timezone&nbsp; (same as {TZ})<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISO-DTW} yyyy-Www-d<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ISO 8601 week date format<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISO-DTO} YYYY-DDD<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ISO 8601 ordinal date format<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{UMS}&nbsp; &nbsp;Milliseconds since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{U}&nbsp; &nbsp; &nbsp;Same as {US}<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{US}&nbsp; &nbsp; Seconds since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{UM}&nbsp; &nbsp; Minutes since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{UH}&nbsp; &nbsp; Hours since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{UD}&nbsp; &nbsp; Days since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{USD}&nbsp; &nbsp;Decimal seconds since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{UMD}&nbsp; &nbsp;Decimal minutes since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{UHD}&nbsp; &nbsp;Decimal hours since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{UDD}&nbsp; &nbsp;Decimal days since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{{}&nbsp; &nbsp; &nbsp;A { character<br />:::<br />:::&nbsp; &nbsp; -R ReturnVariable<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Save the timestamp in ReturnVariable instead of displaying it.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;ReturnVariable is unchanged if an error occurs.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is empty, meaning print to screen.<br />:::<br />:::&nbsp; &nbsp; -WKD &quot;Abbreviated day of week list&quot;<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Override the default day abbreviations with a space delimited,<br />:::&nbsp; &nbsp; &nbsp; &nbsp;quoted list, starting with Sun.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is mixed case, 3 character English day abbreviations.<br />:::<br />:::&nbsp; &nbsp; -WEEKDAY &quot;Day of week list&quot;<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Override the default day names with a space delimited, quoted list,<br />:::&nbsp; &nbsp; &nbsp; &nbsp;starting with Sunday.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is mixed case English day names.<br />:::<br />:::&nbsp; &nbsp; -MTH &quot;Abbreviated month list&quot;<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Override the default month abbreviations with a space delimited,<br />:::&nbsp; &nbsp; &nbsp; &nbsp;quoted list, starting with Jan.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is mixed case, 3 character English month abbreviations.<br />:::<br />:::&nbsp; &nbsp; -MONTH &quot;Month list&quot;<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Override the default month names with a space delimited, quoted list,<br />:::&nbsp; &nbsp; &nbsp; &nbsp;starting with January.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is mixed case English month names.<br />:::<br />:::<br />:::&nbsp; GetTimestamp.bat was written by Dave Benham and originally posted at<br />:::&nbsp; http://www.dostips.com/forum/viewtopic.php?f=3&amp;t=4847<br />:::<br /><br />============= :Batch portion ===========<br />@echo off<br />setlocal enableDelayedExpansion<br /><br />:: Define options<br />set ^&quot;options=^<br />&nbsp;-?:^<br />&nbsp;-??:^<br />&nbsp;-v:^<br />&nbsp;-u:^<br />&nbsp;-z:&quot;&quot;^<br />&nbsp;-f:&quot;{ISO-TS}&quot;^<br />&nbsp;-d:&quot;&quot;^<br />&nbsp;-oy:&quot;&quot;^<br />&nbsp;-om:&quot;&quot;^<br />&nbsp;-od:&quot;&quot;^<br />&nbsp;-oh:&quot;&quot;^<br />&nbsp;-on:&quot;&quot;^<br />&nbsp;-os:&quot;&quot;^<br />&nbsp;-of:&quot;&quot;^<br />&nbsp;-olm:&quot;&quot;^<br />&nbsp;-old:&quot;&quot;^<br />&nbsp;-r:&quot;&quot;^<br />&nbsp;-wkd:&quot;Sun Mon Tue Wed Thu Fri Sat&quot;^<br />&nbsp;-weekday:&quot;Sunday Monday Tuesday Wednesday Thursday Friday Saturday&quot;^<br />&nbsp;-mth:&quot;Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec&quot;^<br />&nbsp;-month:&quot;January February March April May June July August September October November December&quot;^&quot;<br /><br />:: Set default option values<br />for %%O in (%options%) do for /f &quot;tokens=1,* delims=:&quot; %%A in (&quot;%%O&quot;) do (<br />&nbsp; if defined GetTimestamp%%A (set &quot;%%A=!GetTimestamp%%A!&quot;) else set &quot;%%A=%%~B&quot;<br />)<br />set &quot;-?=&quot;<br />set &quot;-??=&quot;<br /><br />:: Get options<br />:loop<br />if not &quot;%~1&quot;==&quot;&quot; (<br />&nbsp; set &quot;arg=%~1&quot;<br />&nbsp; if &quot;!arg:~0,1!&quot; equ &quot;/&quot; set &quot;arg=-!arg:~1!&quot;<br />&nbsp; for /f delims^=^ eol^= %%A in (&quot;!arg!&quot;) do set &quot;test=!options:*%%A:=! &quot;<br />&nbsp; if &quot;!test!&quot;==&quot;!options! &quot; (<br />&nbsp; &nbsp; &nbsp; &gt;&amp;2 echo Error: Invalid option %~1. Use %~nx0 -? to get help.<br />&nbsp; &nbsp; &nbsp; exit /b 1<br />&nbsp; ) else if &quot;!test:~0,1!&quot;==&quot; &quot; (<br />&nbsp; &nbsp; &nbsp; set &quot;!arg!=1&quot;<br />&nbsp; &nbsp; &nbsp; if /i &quot;!arg!&quot; equ &quot;-U&quot; set &quot;-z=&quot;<br />&nbsp; ) else (<br />&nbsp; &nbsp; &nbsp; set &quot;!arg!=%~2&quot;<br />&nbsp; &nbsp; &nbsp; shift /1<br />&nbsp; )<br />&nbsp; shift /1<br />&nbsp; goto :loop<br />)<br />if defined -z set &quot;-u=1&quot;<br />if defined -r set &quot;%-r%=&quot;<br /><br />:: Display paged help<br />if defined -?? (<br />&nbsp; (for /f &quot;delims=: tokens=*&quot; %%A in ('findstr &quot;^:::&quot; &quot;%~f0&quot;') do @echo(%%A)|more /e<br />&nbsp; exit /b 0<br />) 2&gt;nul<br /><br />:: Display help<br />if defined -? (<br />&nbsp; for /f &quot;delims=: tokens=*&quot; %%A in ('findstr &quot;^:::&quot; &quot;%~f0&quot;') do echo(%%A<br />&nbsp; exit /b 0<br />)<br /><br />:: Display version<br />if defined -v (<br />&nbsp; for /f &quot;tokens=* delims=:&quot; %%A in ('findstr &quot;^::getTimestamp\.bat&quot; &quot;%~f0&quot;') do @echo(%%A<br />&nbsp; exit /b 0<br />)<br /><br />:: Execute the JScript script and return the result<br />for /f &quot;delims=&quot; %%A in ('cscript //E:JScript //nologo &quot;%~f0&quot;') do (<br />&nbsp; endlocal<br />&nbsp; if &quot;%-R%&quot; neq &quot;&quot; (set &quot;%-R%=%%A&quot;) else (echo(%%A)<br />&nbsp; exit /b 0<br />)<br />exit /b 1;<br /><br /><br />************ JScript portion ***********/<br />var env&nbsp; = WScript.CreateObject(&quot;WScript.Shell&quot;).Environment(&quot;Process&quot;),<br />&nbsp; &nbsp; utc&nbsp; = env('-U'),<br />&nbsp; &nbsp; wkd&nbsp; &nbsp; &nbsp;= env('-WKD').split(' '),<br />&nbsp; &nbsp; weekday = env('-WEEKDAY').split(' '),<br />&nbsp; &nbsp; mth&nbsp; &nbsp; &nbsp;= env('-MTH').split(' '),<br />&nbsp; &nbsp; month&nbsp; &nbsp;= env('-MONTH').split(' '),<br />&nbsp; &nbsp; stderr&nbsp; = WScript.StdErr,<br />&nbsp; &nbsp; y,m,d,w,h,h12,n,s,f,u,z,zs,za,<br />&nbsp; &nbsp; pc=':', pcm=',', pd='-', pp='.', p2='00', p3='000', p4='0000';<br /><br />if (wkd.length!=7)&nbsp; &nbsp; &nbsp;badOp('-WKD');<br />if (weekday.length!=7) badOp('-WEEKDAY');<br />if (mth.length!=12)&nbsp; &nbsp; badOp('-MTH');<br />if (month.length!=12)&nbsp; badOp('-MONTH');<br /><br />try {<br />&nbsp; var dt = eval('new Date('+env('-D')+')');<br />} catch(e) {<br />} finally {<br />&nbsp; if (isNaN(dt)) badOp('-D');<br />}<br /><br />if (env('-OY')) dt.setUTCFullYear(&nbsp; &nbsp; &nbsp;dt.getUTCFullYear()&nbsp; &nbsp; +getNum('-OY') );<br />if (env('-OM')) dt.setUTCMonth(&nbsp; &nbsp; &nbsp; &nbsp; dt.getUTCMonth()&nbsp; &nbsp; &nbsp; &nbsp;+getNum('-OM') );<br />if (env('-OD')) dt.setUTCDate(&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dt.getUTCDate()&nbsp; &nbsp; &nbsp; &nbsp; +getNum('-OD') );<br />if (env('-OH')) dt.setUTCHours(&nbsp; &nbsp; &nbsp; &nbsp; dt.getUTCHours()&nbsp; &nbsp; &nbsp; &nbsp;+getNum('-OH') );<br />if (env('-ON')) dt.setUTCMinutes(&nbsp; &nbsp; &nbsp; dt.getUTCMinutes()&nbsp; &nbsp; &nbsp;+getNum('-ON') );<br />if (env('-OS')) dt.setUTCSeconds(&nbsp; &nbsp; &nbsp; dt.getUTCSeconds()&nbsp; &nbsp; &nbsp;+getNum('-OS') );<br />if (env('-OF')) dt.setUTCMilliseconds( dt.getUTCMilliseconds()+getNum('-OF') );<br />if (env('-Z'))&nbsp; dt.setUTCMinutes(&nbsp; &nbsp; &nbsp; dt.getUTCMinutes()&nbsp; +(z=getNum('-Z')) );<br /><br />if (env('-OLM')) dt.setMonth(&nbsp; &nbsp; &nbsp; &nbsp; dt.getMonth()&nbsp; &nbsp; &nbsp; &nbsp;+getNum('-OLM') );<br />if (env('-OLD')) dt.setDate(&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dt.getDate()&nbsp; &nbsp; &nbsp; &nbsp; +getNum('-OLD') );<br /><br />y = utc ? dt.getUTCFullYear(): dt.getFullYear();<br />m = utc ? dt.getUTCMonth()&nbsp; &nbsp;: dt.getMonth();<br />d = utc ? dt.getUTCDate()&nbsp; &nbsp; : dt.getDate();<br />w = utc ? dt.getUTCDay()&nbsp; &nbsp; &nbsp;: dt.getDay();<br />h = utc ? dt.getUTCHours()&nbsp; &nbsp;: dt.getHours();<br />n = utc ? dt.getUTCMinutes() : dt.getMinutes();<br />s = utc ? dt.getUTCSeconds() : dt.getSeconds();<br />f = utc ? dt.getUTCMilliseconds() : dt.getMilliseconds();<br />u = dt.getTime();<br /><br />h12 = h%12;<br />if (!h12) h12=12;<br /><br />if (z==undefined) if (utc) z=0; else z=-dt.getTimezoneOffset();<br />zs = z&lt;0 ? '-' : '+';<br />za = Math.abs(z);<br /><br />WScript.echo( env('-F').replace( /\{(.*?)\}/gi, repl ) );<br />WScript.Quit(0);<br /><br />function lpad( val, pad ) {<br />&nbsp; var rtn=val.toString();<br />&nbsp; return (rtn.length&lt;pad.length) ? (pad+rtn).slice(-pad.length) : val;<br />}<br /><br />function getNum( v ) {<br />&nbsp; var rtn;<br />&nbsp; try {<br />&nbsp; &nbsp; rtn = Number(eval(env(v)));<br />&nbsp; } catch(e) {<br />&nbsp; } finally {<br />&nbsp; &nbsp; if (isNaN(rtn-rtn)) badOp(v);<br />&nbsp; &nbsp; return rtn;<br />&nbsp; }<br />}<br /><br />function badOp(option) {<br />&nbsp; stderr.WriteLine('Error: Invalid '+option+' value');<br />&nbsp; WScript.Quit(1);<br />}<br /><br />function trunc( n ) { return Math&#91;n&gt;0?&quot;floor&quot;:&quot;ceil&quot;&#93;(n); }<br /><br />function weekNum(dt) {<br />&nbsp; &nbsp;var dt2 = new Date(dt.valueOf());<br />&nbsp; &nbsp;var day = (dt.getDay()+6)%7;<br />&nbsp; &nbsp;dt2.setDate(dt2.getDate()-day+3);<br />&nbsp; &nbsp;var now = dt2.valueOf();<br />&nbsp; &nbsp;dt2.setMonth(0, 1);<br />&nbsp; &nbsp;if (dt2.getDay() != 4) {<br />&nbsp; &nbsp;&nbsp; &nbsp;dt2.setMonth( 0, (11-dt2.getDay())%7 + 1 );<br />&nbsp; &nbsp;}<br />&nbsp; &nbsp;return 1 + Math.ceil((now-dt2.valueOf())/604800000);<br />}<br /><br />function weekYr(dt) {<br />&nbsp; &nbsp;var dt2 = new Date(dt.valueOf());<br />&nbsp; &nbsp;dt2.setDate(dt2.getDate()+3-(dt.getDay()+6)%7);<br />&nbsp; &nbsp;return dt2.getFullYear();<br />}<br /><br />function repl($0,$1) {<br />&nbsp; switch ($1.toUpperCase()) {<br />&nbsp; &nbsp; case 'YYYY' : return lpad(y,p4);<br />&nbsp; &nbsp; case 'YY'&nbsp; &nbsp;: return (p2+y.toString()).slice(-2);<br />&nbsp; &nbsp; case 'Y'&nbsp; &nbsp; : return y.toString();<br />&nbsp; &nbsp; case 'MM'&nbsp; &nbsp;: return lpad(m+1,p2);<br />&nbsp; &nbsp; case 'M'&nbsp; &nbsp; : return (m+1).toString();<br />&nbsp; &nbsp; case 'DD'&nbsp; &nbsp;: return lpad(d,p2);<br />&nbsp; &nbsp; case 'D'&nbsp; &nbsp; : return d.toString();<br />&nbsp; &nbsp; case 'W'&nbsp; &nbsp; : return w.toString();<br />&nbsp; &nbsp; case 'DY'&nbsp; &nbsp;: return trunc(((new Date(y,m,d)).getTime()-(new Date(y,0,0)).getTime())/86400000).toString();<br />&nbsp; &nbsp; case 'DDY'&nbsp; : return lpad( trunc(((new Date(y,m,d)).getTime()-(new Date(y,0,0)).getTime())/86400000), p3);<br />&nbsp; &nbsp; case 'HH'&nbsp; &nbsp;: return lpad(h,p2);<br />&nbsp; &nbsp; case 'H'&nbsp; &nbsp; : return h.toString();<br />&nbsp; &nbsp; case 'HH12' : return lpad(h12,p2);<br />&nbsp; &nbsp; case 'H12'&nbsp; : return h12.toString();<br />&nbsp; &nbsp; case 'NN'&nbsp; &nbsp;: return lpad(n,p2);<br />&nbsp; &nbsp; case 'N'&nbsp; &nbsp; : return n.toString();<br />&nbsp; &nbsp; case 'SS'&nbsp; &nbsp;: return lpad(s,p2);<br />&nbsp; &nbsp; case 'S'&nbsp; &nbsp; : return s.toString();<br />&nbsp; &nbsp; case 'FFF'&nbsp; : return lpad(f,p3);<br />&nbsp; &nbsp; case 'F'&nbsp; &nbsp; : return f.toString();<br />&nbsp; &nbsp; case 'AM'&nbsp; &nbsp;: return h&gt;=12 ? 'PM' : 'AM';<br />&nbsp; &nbsp; case 'PM'&nbsp; &nbsp;: return h&gt;=12 ? 'pm' : 'am';<br />&nbsp; &nbsp; case 'UMS'&nbsp; : return u.toString();<br />&nbsp; &nbsp; case 'USD'&nbsp; : return (u/1000).toString();<br />&nbsp; &nbsp; case 'UMD'&nbsp; : return (u/1000/60).toString();<br />&nbsp; &nbsp; case 'UHD'&nbsp; : return (u/1000/60/60).toString();<br />&nbsp; &nbsp; case 'UDD'&nbsp; : return (u/1000/60/60/24).toString();<br />&nbsp; &nbsp; case 'U'&nbsp; &nbsp; :<br />&nbsp; &nbsp; case 'US'&nbsp; &nbsp;: return trunc(u/1000).toString();<br />&nbsp; &nbsp; case 'UM'&nbsp; &nbsp;: return trunc(u/1000/60).toString();<br />&nbsp; &nbsp; case 'UH'&nbsp; &nbsp;: return trunc(u/1000/60/60).toString();<br />&nbsp; &nbsp; case 'UD'&nbsp; &nbsp;: return trunc(u/1000/60/60/24).toString();<br />&nbsp; &nbsp; case 'ZZZZ' : return zs+lpad(za,p3);<br />&nbsp; &nbsp; case 'Z'&nbsp; &nbsp; : return z.toString();<br />&nbsp; &nbsp; case 'ZS'&nbsp; &nbsp;: return zs;<br />&nbsp; &nbsp; case 'ZH'&nbsp; &nbsp;: return lpad(trunc(za/60),p2);<br />&nbsp; &nbsp; case 'ZM'&nbsp; &nbsp;: return lpad(za%60,p2);<br />&nbsp; &nbsp; case 'TZ'&nbsp; &nbsp;:<br />&nbsp; &nbsp; case 'ISO-TZ' : return ''+zs+lpad(trunc(za/60),p2)+pc+lpad(za%60,p2);<br />&nbsp; &nbsp; case 'ISOTS'&nbsp; :<br />&nbsp; &nbsp; case 'ISOTS.' : return ''+lpad(y,p4)+lpad(m+1,p2)+lpad(d,p2)+'T'+lpad(h,p2)+lpad(n,p2)+lpad(s,p2)+pp+lpad(f,p3)+zs+lpad(trunc(za/60),p2)+lpad(za%60,p2);<br />&nbsp; &nbsp; case 'ISOTS,' : return ''+lpad(y,p4)+lpad(m+1,p2)+lpad(d,p2)+'T'+lpad(h,p2)+lpad(n,p2)+lpad(s,p2)+pcm+lpad(f,p3)+zs+lpad(trunc(za/60),p2)+lpad(za%60,p2);<br />&nbsp; &nbsp; case 'ISODT'&nbsp; : return ''+lpad(y,p4)+lpad(m+1,p2)+lpad(d,p2);<br />&nbsp; &nbsp; case 'ISOTM'&nbsp; :<br />&nbsp; &nbsp; case 'ISOTM.' : return ''+lpad(h,p2)+lpad(n,p2)+lpad(s,p2)+pp+lpad(f,p3);<br />&nbsp; &nbsp; case 'ISOTM,' : return ''+lpad(h,p2)+lpad(n,p2)+lpad(s,p2)+pcm+lpad(f,p3);<br />&nbsp; &nbsp; case 'ISOTZ'&nbsp; : return ''+zs+lpad(trunc(za/60),p2)+lpad(za%60,p2);<br />&nbsp; &nbsp; case 'ISO-TS' :<br />&nbsp; &nbsp; case 'ISO-TS.': return ''+lpad(y,p4)+pd+lpad(m+1,p2)+pd+lpad(d,p2)+'T'+lpad(h,p2)+pc+lpad(n,p2)+pc+lpad(s,p2)+pp+lpad(f,p3)+zs+lpad(trunc(za/60),p2)+pc+lpad(za%60,p2);<br />&nbsp; &nbsp; case 'ISO-TS,': return ''+lpad(y,p4)+pd+lpad(m+1,p2)+pd+lpad(d,p2)+'T'+lpad(h,p2)+pc+lpad(n,p2)+pc+lpad(s,p2)+pcm+lpad(f,p3)+zs+lpad(trunc(za/60),p2)+pc+lpad(za%60,p2);<br />&nbsp; &nbsp; case 'ISO-DT' : return ''+lpad(y,p4)+pd+lpad(m+1,p2)+pd+lpad(d,p2);<br />&nbsp; &nbsp; case 'ISO-TM' :<br />&nbsp; &nbsp; case 'ISO-TM.': return ''+lpad(h,p2)+pc+lpad(n,p2)+pc+lpad(s,p2)+pp+lpad(f,p3);<br />&nbsp; &nbsp; case 'ISO-TM,': return ''+lpad(h,p2)+pc+lpad(n,p2)+pc+lpad(s,p2)+pcm+lpad(f,p3);<br />&nbsp; &nbsp; case 'ISOWY'&nbsp; : return ''+lpad(weekYr(dt),p4);<br />&nbsp; &nbsp; case 'ISOWK'&nbsp; : return ''+lpad(weekNum(dt),p2);<br />&nbsp; &nbsp; case 'ISOWD'&nbsp; : return ''+((w+6)%7+1);<br />&nbsp; &nbsp; case 'ISODTW' : return ''+lpad(weekYr(dt),p4)+'W'+lpad(weekNum(dt),p2)+((w+6)%7+1);<br />&nbsp; &nbsp; case 'ISODTO' : return ''+lpad(y,p4)+lpad( trunc(((new Date(y,m,d)).getTime()-(new Date(y,0,0)).getTime())/86400000), p3);<br />&nbsp; &nbsp; case 'ISO-DTW': return ''+lpad(weekYr(dt),p4)+pd+'W'+lpad(weekNum(dt),p2)+pd+((w+6)%7+1);<br />&nbsp; &nbsp; case 'ISO-DTO': return ''+lpad(y,p4)+pd+lpad( trunc(((new Date(y,m,d)).getTime()-(new Date(y,0,0)).getTime())/86400000), p3);<br />&nbsp; &nbsp; case 'WEEKDAY': return weekday&#91;w&#93;;<br />&nbsp; &nbsp; case 'WKD'&nbsp; &nbsp; : return wkd&#91;w&#93;;<br />&nbsp; &nbsp; case 'MONTH'&nbsp; : return month&#91;m&#93;;<br />&nbsp; &nbsp; case 'MTH'&nbsp; &nbsp; : return mth&#91;m&#93;;<br />&nbsp; &nbsp; case '{'&nbsp; &nbsp; &nbsp; : return $1;<br />&nbsp; &nbsp; default&nbsp; &nbsp; &nbsp; &nbsp;: return $0;<br />&nbsp; }<br />}<br /></code></pre></div><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p48337" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile48337">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf147.html?author_id=3221&amp;sr=posts">6033</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Feb 2012 02:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content48337">

						<h3 ><a href="#p48337">Re: getTimestamp.bat for time and date processing</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting9256.html?mode=quote&amp;f=3&amp;p=48337" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopica63c.html?p=48337#p48337" onclick="prompt('Message #43',this.href); return false;">#43</a></span> 
									<a class="unread" href="viewtopica63c.html?p=48337#p48337" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a></strong> &raquo; </span>06 Aug 2016 07:43
			</p>
			
			
			
			<div class="content">Dave, can I ask you to run your eyes over this please?   I think 2 litres of Glenfiddich has detuned my brain. <img class="smilies" src="images/smilies/icon_wink.gif" alt=";)" title="Wink" /><br /><br />I found out that Matroska chapters in MKV files don't support day figures, and instead increment the hour figure when the total is over a day: so 25 hours is one day and one hour.<br /><br />That's what my aim is: to accumulate the hour range instead of what you see here where the hours accumulate to one day and then begin at 01 again.   <br /><br /><br />Do you have some wizardry up your sleeve to handle this?<br /><br /> <br />I noted a strange effect in a few spots where the total is only few minutes different for a 45 odd minute chapter.  Or is that my error?<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>call getTimestamp /d &quot;'1/1/1970 01:25:56 UTC'&quot; /of 5156606 /z 0 /f &quot;{ums} {hh}:{nn}:{ss}.{fff}&quot;<br />call getTimestamp /d &quot;'1/1/1970 01:29:11 UTC'&quot; /of 10508016 /z 0 /f &quot;{ums} {hh}:{nn}:{ss}.{fff}&quot;<br />call getTimestamp /d &quot;'1/1/1970 01:30:35 UTC'&quot; /of 15943330 /z 0 /f &quot;{ums} {hh}:{nn}:{ss}.{fff}&quot;<br />call getTimestamp /d &quot;'1/1/1970 01:28:31 UTC'&quot; /of 21255286 /z 0 /f &quot;{ums} {hh}:{nn}:{ss}.{fff}&quot;<br />call getTimestamp /d &quot;'1/1/1970 00:46:53 UTC'&quot; /of 24068664 /z 0 /f &quot;{ums} {hh}:{nn}:{ss}.{fff}&quot;<br />call getTimestamp /d &quot;'1/1/1970 01:30:01 UTC'&quot; /of 29469710 /z 0 /f &quot;{ums} {hh}:{nn}:{ss}.{fff}&quot;<br />call getTimestamp /d &quot;'1/1/1970 01:30:21 UTC'&quot; /of 34890742 /z 0 /f &quot;{ums} {hh}:{nn}:{ss}.{fff}&quot;<br />call getTimestamp /d &quot;'1/1/1970 01:32:05 UTC'&quot; /of 40416543 /z 0 /f &quot;{ums} {hh}:{nn}:{ss}.{fff}&quot;<br />call getTimestamp /d &quot;'1/1/1970 01:30:50 UTC'&quot; /of 45867272 /z 0 /f &quot;{ums} {hh}:{nn}:{ss}.{fff}&quot;<br />call getTimestamp /d &quot;'1/1/1970 01:30:44 UTC'&quot; /of 51311818 /z 0 /f &quot;{ums} {hh}:{nn}:{ss}.{fff}&quot;<br />call getTimestamp /d &quot;'1/1/1970 01:31:11 UTC'&quot; /of 56783225 /z 0 /f &quot;{ums} {hh}:{nn}:{ss}.{fff}&quot;<br />call getTimestamp /d &quot;'1/1/1970 01:29:52 UTC'&quot; /of 62175663 /z 0 /f &quot;{ums} {hh}:{nn}:{ss}.{fff}&quot;<br />call getTimestamp /d &quot;'1/1/1970 00:47:12 UTC'&quot; /of 65007984 /z 0 /f &quot;{ums} {hh}:{nn}:{ss}.{fff}&quot;<br />call getTimestamp /d &quot;'1/1/1970 01:40:47 UTC'&quot; /of 71055913 /z 0 /f &quot;{ums} {hh}:{nn}:{ss}.{fff}&quot;<br />call getTimestamp /d &quot;'1/1/1970 01:29:07 UTC'&quot; /of 76403040 /z 0 /f &quot;{ums} {hh}:{nn}:{ss}.{fff}&quot;<br />call getTimestamp /d &quot;'1/1/1970 00:47:58 UTC'&quot; /of 79282017 /z 0 /f &quot;{ums} {hh}:{nn}:{ss}.{fff}&quot;<br />call getTimestamp /d &quot;'1/1/1970 01:31:00 UTC'&quot; /of 84742354 /z 0 /f &quot;{ums} {hh}:{nn}:{ss}.{fff}&quot;<br />call getTimestamp /d &quot;'1/1/1970 01:31:01 UTC'&quot; /of 90203859 /z 0 /f &quot;{ums} {hh}:{nn}:{ss}.{fff}&quot;<br />call getTimestamp /d &quot;'1/1/1970 01:29:55 UTC'&quot; /of 95599107 /z 0 /f &quot;{ums} {hh}:{nn}:{ss}.{fff}&quot;<br />call getTimestamp /d &quot;'1/1/1970 01:32:21 UTC'&quot; /of 101140212 /z 0 /f &quot;{ums} {hh}:{nn}:{ss}.{fff}&quot;<br /></code></pre></div></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p48338" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile48338">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content48338">

						<h3 ><a href="#p48338">Re: getTimestamp.bat for time and date processing</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting6b12.html?mode=quote&amp;f=3&amp;p=48338" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic4196.html?p=48338#p48338" onclick="prompt('Message #44',this.href); return false;">#44</a></span> 
									<a class="unread" href="viewtopic4196.html?p=48338#p48338" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>06 Aug 2016 10:22
			</p>
			
			
			
			<div class="content">If you read the documentation, you will see that the /Z option should not be used with any of {UMS}, {US}, {USD}, etc. I believe it actually works if the /Z (timezone offset in minutes) is 0, but a better alternative is to use the /U option.<br /><br />All you need is {UH} to get the number of whole hours (no rollover at 24). Note that it does not pad to a specific width because there is no limit to how many digits might be required.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>call getTimestamp /d &quot;'1/1/1970 01:32:21 UTC'&quot; /of 101140212 /u /f &quot;{ums} {uh}:{nn}:{ss}.{fff}&quot;<br /></code></pre></div><br /><br />I'm not sure what strange effect you are referring to. You will have to give me a specific example, describing what you expect vs. what you see.<br /><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p48340" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile48340">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf147.html?author_id=3221&amp;sr=posts">6033</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Feb 2012 02:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content48340">

						<h3 ><a href="#p48340">Re: getTimestamp.bat for time and date processing</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingd1c0-2.html?mode=quote&amp;f=3&amp;p=48340" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicb953-2.html?p=48340#p48340" onclick="prompt('Message #45',this.href); return false;">#45</a></span> 
									<a class="unread" href="viewtopicb953-2.html?p=48340#p48340" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a></strong> &raquo; </span>06 Aug 2016 15:42
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>dbenham wrote:</cite>If you read the documentation, you will see that the /Z option should not be used with any of {UMS}, {US}, {USD}, etc. I believe it actually works if the /Z (timezone offset in minutes) is 0, but a better alternative is to use the /U option.<br /><br />All you need is {UH} to get the number of whole hours (no rollover at 24). Note that it does not pad to a specific width because there is no limit to how many digits might be required.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>call getTimestamp /d &quot;'1/1/1970 01:32:21 UTC'&quot; /of 101140212 /u /f &quot;{ums} {uh}:{nn}:{ss}.{fff}&quot;<br /></code></pre></div><br /></div></blockquote><br /><br />Thanks Dave, that's spot on and I'm able to remove all the kludgey code I was trying to make work. <br /><br /><br />I'm finding sustained concentration a bit challenging at the moment due to illness.<br /><br />The odd lines are shown below with the code from my question - they disappeared with your fix.<br /><br /><blockquote class="uncited"><div>10312606 02:51:52.606<br />15859016 04:24:19.016<br />21378330 05:56:18.330<br /><span style="color: #800000">26566286 07:22:46.286<br />26881664 07:28:01.664<br /></span>34870710 09:41:10.710<br />40311742 11:11:51.742<br />45941543 12:45:41.543<br />51317272 14:15:17.272<br />56755818 15:45:55.818<br />62254225 17:17:34.225<br /><span style="color: #800000">67567663 18:46:07.663<br />67839984 18:50:39.984</span><br />77102913 21:25:02.913<br /><span style="color: #800000">81750040 22:42:30.040<br />82160017 22:49:20.017</span><br />90202354 01:03:22.354<br />95664859 02:34:24.859<br />100994107 04:03:14.107<br />106681212 05:38:01.212</div></blockquote></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
	

	<div class="action-bar bar-bottom">
	
			<a href="postingfde4.html?mode=reply&amp;f=3&amp;t=4847" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopicbe59.html?f=3&amp;t=4847&amp;start=30&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

			<form method="post" action="https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=4847&amp;start=30">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			46 posts
							<ul>
			<li class="arrow previous"><a class="button button-icon-only" href="viewtopic4c44.html?f=3&amp;t=4847&amp;start=15" rel="prev" role="button"><i class="icon fa-chevron-left fa-fw" aria-hidden="true"></i><span class="sr-only">Previous</span></a></li>
				<li><a class="button" href="viewtopic5ecb.html?f=3&amp;t=4847" role="button">1</a></li>
				<li><a class="button" href="viewtopic4c44.html?f=3&amp;t=4847&amp;start=15" role="button">2</a></li>
			<li class="active"><span>3</span></li>
				<li><a class="button" href="viewtopiccf06.html?f=3&amp;t=4847&amp;start=45" role="button">4</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopiccf06.html?f=3&amp;t=4847&amp;start=45" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="viewforum4d6b.html?f=3" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to “DOS Batch Forum”</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="viewforum31e6.html?f=4" class="jumpbox-cat-link"> <span> DosTips - Dos Batch</span></a></li>
																<li><a href="viewforum4d6b.html?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; DOS Batch Forum</span></a></li>
											</ul>
		</div>
	</div>

	</div>


			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
							<span class="crumb"><a href="../index.html" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>DosTips.com</span></a></span>									<span class="crumb"><a href="index.html" data-navbar-reference="index"><span>Board index</span></a></span>					</li>
		
				<li class="rightside">All times are <span title="UTC-6">UTC-06:00</span></li>
							<li class="rightside">
				<a href="ucp033a.html?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete all board cookies</span>
				</a>
			</li>
												<li class="rightside" data-last-responsive="true">
				<a href="memberlist4bfd.html?mode=team" role="menuitem">
					<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
				</a>
			</li>
									<li class="rightside" data-last-responsive="true">
				<a href="memberlist8733.html?mode=contactadmin" role="menuitem">
					<i class="icon fa-envelope fa-fw" aria-hidden="true"></i><span>Contact us</span>
				</a>
			</li>
			</ul>

	</div>
</div>

	<div class="copyright">
				<!-- WARNING NO DELETE -->Style developer by <a href="http://tricolor.x-tk.ru/">support forum tricolor</a>, <!-- END WARNING NO DELETE -->Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
									</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	<img src="cron68e3.gif?cron_type=cron.task.text_reparser.pm_text" width="1" height="1" alt="cron" /></div>

<script type="text/javascript" src="assets/javascript/jquery.mind772.js?assets_version=34"></script>
<script type="text/javascript" src="assets/javascript/cored772.js?assets_version=34"></script>



<script type="text/javascript" src="styles/prosilver/template/forum_fnd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/prosilver/template/ajaxd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/jquery-uid772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/collapsed772.js?assets_version=34"></script>



</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=4847&start=30 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 07:58:18 GMT -->
</html>
