<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=6044&start=255&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 07:59:54 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>DosTips.com &bull; JREPL.BAT v7.14 - regex text processor now with Unicode and XRegExp support - Page 18</title>

<link href="styles/AllanStyle-SUBSILVER/theme/print.css" rel="stylesheet">
</head>
<body id="phpbb">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>DosTips.com</h1>
		<p>A Forum all about DOS Batch<br /><a href="index-2.html">https://www.dostips.com/forum/</a></p>

		<h2>JREPL.BAT v7.14 - regex text processor now with Unicode and XRegExp support</h2>
		<p><a href="viewtopicb16d.html?f=3&amp;t=6044">https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=6044</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>18</strong> of <strong>27</strong></div>
					<div class="post">
				<h3>Re: JREPL.BAT - regex text processor - successor to REPL.BAT</h3>
				<div class="date">Posted: <strong>01 Nov 2016 19:32</strong></div>
				<div class="author">by <strong>dbenham</strong></div>
				<div class="content">I found my first bug in v6.3 - I forgot to negate the result of the /EXC tests, so it was giving me an inverted result.<br /><br />I fixed the bug and <a href="viewtopica8aa.html?f=3&amp;t=6044&amp;start=240#p49641" class="postlink">updated the prior post to v6.4</a>.<br /><br /><br />Dave Benham</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: JREPL.BAT - regex text processor - successor to REPL.BAT</h3>
				<div class="date">Posted: <strong>08 Nov 2016 16:37</strong></div>
				<div class="author">by <strong>Jon</strong></div>
				<div class="content">Hi Dave,<br />Awesome work,<br /><br />I am able to get the very basics of this working but I am by no means advanced enough to get what I am looking for to work. <br />I am wondering if it is possible to take multiple pieces of data from one xml and repopulate the tags in another xml. The catch is though that there is multiple tags in the same file with the same name. <br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&lt;example id=&quot;&#91;b&#93;aaa&#91;/b&#93;&quot;&gt;<br />&nbsp; &nbsp; &lt;source id=&quot;0&quot;&gt;<br />&nbsp; &nbsp; &nbsp; &nbsp; &lt;name&gt;&#91;b&#93;bbb&#91;/b&#93;&lt;/name&gt;<br />&nbsp; &nbsp; &nbsp; &nbsp; &lt;location&gt;&#91;b&#93;ccc&#91;/b&#93;&lt;/location&gt;<br />&nbsp; &nbsp; &lt;/source&gt;<br />&nbsp; &nbsp; &lt;size value=&quot;&#91;b&#93;ddd&#91;/b&#93;&quot; /&gt;<br />&lt;/example&gt;<br /><br />&lt;example id=&quot;&#91;b&#93;eee&#91;/b&#93;&quot;&gt;<br />&nbsp; &nbsp; &lt;source id=&quot;1&quot;&gt;<br />&nbsp; &nbsp; &nbsp; &nbsp; &lt;name&gt;&#91;b&#93;fff&#91;/b&#93;&lt;/name&gt;<br />&nbsp; &nbsp; &nbsp; &nbsp; &lt;location&gt;&#91;b&#93;ggg&#91;/b&#93;&lt;/location&gt;<br />&nbsp; &nbsp; &lt;/source&gt;<br />&nbsp; &nbsp; &lt;size value=&quot;&#91;b&#93;hhh&#91;/b&#93;&quot; /&gt;<br />&lt;/example&gt;<br /><br />&lt;example id=&quot;&#91;b&#93;iii&#91;/b&#93;&quot;&gt;<br />&nbsp; &nbsp; &lt;source id=&quot;2&quot;&gt;<br />&nbsp; &nbsp; &nbsp; &nbsp; &lt;name&gt;&#91;b&#93;jjj&#91;/b&#93;&lt;/name&gt;<br />&nbsp; &nbsp; &nbsp; &nbsp; &lt;location&gt;&#91;b&#93;kkk&#91;/b&#93;&lt;/location&gt;<br />&nbsp; &nbsp; &lt;/source&gt;<br />&nbsp; &nbsp; &lt;size value=&quot;&#91;b&#93;lll&#91;/b&#93;&quot; /&gt;<br />&lt;/example&gt;<br /></code></pre></div><br /><br />Thank you for any help,<br />Jon.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: JREPL.BAT - regex text processor - successor to REPL.BAT</h3>
				<div class="date">Posted: <strong>09 Nov 2016 05:42</strong></div>
				<div class="author">by <strong>dbenham</strong></div>
				<div class="content">Regardless what your full requirements are, you really should use a tool designed to work with XML. The way you describe your problem, it sounds like a classic transformation problem for XSLT.<br /><br />That being said, it might be possible with JREPL if you make a number of assumptions about the physical layout of your XML files (usually a bad idea). Unless I am misinterpreting your goal, I can almost guarantee it would require a fair amount of user supplied JScript, and I'm thinking you would be driving a nail with a screwdriver.<br /><br />You haven't provided nearly enough information to begin to solve your problem with any tool. When you say &quot;repopulate the tags in another xml&quot;, I can't tell if you are talking about merging two existing XML documents, or if your are building the second one from scratch based on the content of the first. You would have to provide a lot more details about the before and after documents.<br /><br />I strongly encourage you to consider a true XML processing tool.<br /><br /><br />Dave Benham</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: JREPL.BAT - regex text processor - successor to REPL.BAT</h3>
				<div class="date">Posted: <strong>09 Nov 2016 11:00</strong></div>
				<div class="author">by <strong>Jon</strong></div>
				<div class="content">Hi Dave,<br />Thanks for the reply. <br /><br />Sorry for not being very clear. I have two XML files both with information in, in the same structure. <br />What I am looking to do is replace the data in some of the tags on one XML file with data from the other XML file. <br />If it's not easy to do, I'll looking into using a proper XML editing tool as you say. <br /><br />Thanks,<br />Jon.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: JREPL.BAT - regex text processor - successor to REPL.BAT</h3>
				<div class="date">Posted: <strong>09 Nov 2016 11:46</strong></div>
				<div class="author">by <strong>Squashman</strong></div>
				<div class="content"><blockquote><div><cite>Jon wrote:</cite>Hi Dave,<br />Thanks for the reply. <br /><br />Sorry for not being very clear. I have two XML files both with information in, in the same structure. <br />What I am looking to do is replace the data in some of the tags on one XML file with data from the other XML file. <br />If it's not easy to do, I'll looking into using a proper XML editing tool as you say. <br /><br />Thanks,<br />Jon.</div></blockquote><br />Without providing some clear verifiable examples it is hard to code anything at this point.  We can probably give you an XML solution as well because we do have people here who use Vbscript and Jscript and both of those scripting languages have XML capability.  But you need to provide more information before anyone can help you.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: JREPL.BAT - regex text processor - successor to REPL.BAT</h3>
				<div class="date">Posted: <strong>09 Nov 2016 11:53</strong></div>
				<div class="author">by <strong>aGerman</strong></div>
				<div class="content">Jon<br /><br />It's Batch that can't handle XML properly. Even regex as Dave uses in his tool can't handle XML properly. It's not a big deal to write a hybrid script to solve your problem, see ...<br /><!-- l --><a class="postlink-local" href="viewtopicf7da.html?f=3&amp;t=7296">viewtopic.php?f=3&amp;t=7296</a><!-- l --><br />... but we would have to know the the entire structure of these XML files, beginning with the declaration &lt;?XML ... <br /><br />Since that would be pretty off topic in this thread I'd suggest you to create a new topic where you can provide the missing information.<br /><br />Steffen</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: JREPL.BAT - regex text processor - successor to REPL.BAT</h3>
				<div class="date">Posted: <strong>13 Nov 2016 22:10</strong></div>
				<div class="author">by <strong>dbenham</strong></div>
				<div class="content"><div class="inline-attachment">
			
		
		
				<dl class="file">
			<dt><span class="imageset icon_topic_attach"></span> <a class="postlink" href="download/fileb3a3.php?id=110">JREPL6.6.zip</a></dt>
						<dd>(18.97 KiB) Downloaded 114 times</dd>
		</dl>
		
		
			</div><br />JREPL version 6.<span style="color: #0000FF"><strong class="text-strong">6</strong></span> introduces one new feature, refines another, <span style="color: #0000FF"><strong class="text-strong">and corrects a documentation error</strong></span>:<br /><br /><strong class="text-strong">1) New /RTN option</strong> writes the result to an environment variable instead of stdout or a file. The entire result must fit within a single variable, else the command will fail. This option can be used with any combination of options, but it is probably most useful with /MATCH, /JMATCH, or /JMATCHQ if input is stdin or a file. This option is also an excellent way to manipulate the content of an existing variable if combined with /S and /M.<br /><br />Output is first written to a temporary file within %TEMP%, and then it is read back in and stored in the variable, and the temp file is deleted.<br /><br />The /RTN option is nearly useless if JREPL is used with a pipe because piped commands run within a new command shell process, and any variables defined within that process will be undefined as soon as the pipe terminates.<br /><br />Here is the full documentation:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&gt;jrepl /?/rtn<br /><br />&nbsp; &nbsp; &nbsp; /RTN ReturnVar&#91;:&#91;-&#93;LineNumber&#93;<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Write the result to variable ReturnVar.<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If the optional LineNumber is present, then only that specified<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; line within the result set is returned. A LineNumber of 1 is the<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; first line. A negative LineNumber is measured from the end of the<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; result set, so -1 is the last line.<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; All byte codes except NULL (0x00) are preserved, regardless<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; whether delayed expansion is enabled or not. An error is thrown<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; and no value stored if the result contains NULL.<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; An error is thrown and no value stored if the value does not fit<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; within a variable. The maximum returned length varies depending<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; on the variable name and result content. The longest possible<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; returned length is 8179 bytes.<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The line terminator of the last match is suppressed if /MATCH,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /JMATCH, or /JMATCHQ is used.<br /></code></pre></div><br />Example 1: Store the last word of input.txt in variable lastWord.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>call jrepl \S+ &quot;&quot; /match /f input.txt /rtn lastWord:-1<br /></code></pre></div><br />Example 2: Substitute : for all = characters within variable var (very difficult task with pure batch).<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>call jrepl &quot;=&quot; &quot;:&quot; /m /s var /rtn var<br /></code></pre></div><br /><br /><strong class="text-strong">2) Provide consistent support for extended ASCII when /X is used</strong><br /><br />JREPL was designed to primarily work with 7bit ASCII. However, it has always had limited support for high order bytes (extended ASCII). Byte codes &gt;= 128 (0x80) were preserved when they appeared in stdin, input files, and/or output files. However, prior versions of JREPL did not properly read extended ASCII within command line parameters or variables. The only recourse was to use the \xnn string literal escape sequence, and /X was required to get the correct interpretation.<br /><br />Version 6.5 modifies the behavior of /X so that command line arguments and variables are automatically written to temporary files within %TEMP%, where the extended ASCII string literals can be read properly. The temporary files are deleted once the command completes.<br /><br />Now JREPL with /X will work properly with extended ASCII literals no matter where they apper. Note that environment variables actually store strings as UTF-16. It is possible that a variable may have a character that does not map to the current active code page, in which case batch will automatically convert it into a ? character. So care should be taken to make sure that all your content fits within the active code page.<br /><br /><strong class="text-strong">3) Documentation correction</strong><br /><br />Version 6.0 introduced a documentation error regarding return codes. It improperly listed return codes of 0, 1, 3, and 4. The error persisted through version 6.5.<br /><br />This version 6.6 fixes the documentation error and properly lists return codes 0, 1, 2, and 3.<br /><br /><br />Dave Benham</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: JREPL.BAT - regex text processor - successor to REPL.BAT</h3>
				<div class="date">Posted: <strong>24 Dec 2016 11:42</strong></div>
				<div class="author">by <strong>dbenham</strong></div>
				<div class="content">I've replaced version 6.5 with 6.6 in the previous post. The only difference is a correction to the documentation on return codes.<br /><br /><br />Dave Benham</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: JREPL.BAT - regex text processor - successor to REPL.BAT</h3>
				<div class="date">Posted: <strong>27 Dec 2016 18:01</strong></div>
				<div class="author">by <strong>Mike D</strong></div>
				<div class="content"><blockquote><div><cite>dbenham wrote:</cite>Example 1: Store the last word of input.txt in variable lastWord.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>call jrepl \s+ &quot;&quot; /match /f input.txt /rtn lastWord:-1<br /></code></pre></div><br /></div></blockquote><br />'\s' should be '\S' (upper case).</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: JREPL.BAT - regex text processor - successor to REPL.BAT</h3>
				<div class="date">Posted: <strong>27 Dec 2016 21:23</strong></div>
				<div class="author">by <strong>dbenham</strong></div>
				<div class="content">Of course it should  <img class="smilies" src="images/smilies/icon_redface.gif" alt=":oops:" title="Embarassed" /> <br /><br />I've edited the post to fix that mistake. Thanks Mike D.<br /><br /><br />Dave Benham</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: JREPL.BAT - regex text processor - successor to REPL.BAT</h3>
				<div class="date">Posted: <strong>26 Feb 2017 00:05</strong></div>
				<div class="author">by <strong>bluesky088</strong></div>
				<div class="content">I'm new to JREPL.bat.<br /><br />Hoping to replace a particular line in a text file. I'm currently using the following command to replace line 3 with the text abc123<br /><br />jrepl &quot;^.*&quot; &quot;abc123&quot; /inc 3 /f &quot;C:\test.txt&quot; /o -<br /><br />It works at the moment. However, if I wanted to replace line 3 with &quot;abc123&quot;  (i.e. line 3 should also have quotation marks around abc123), any ideas how to do it?</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: JREPL.BAT - regex text processor - successor to REPL.BAT</h3>
				<div class="date">Posted: <strong>26 Feb 2017 00:12</strong></div>
				<div class="author">by <strong>Squashman</strong></div>
				<div class="content">Did you look at the /X option.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: JREPL.BAT - regex text processor - successor to REPL.BAT</h3>
				<div class="date">Posted: <strong>26 Feb 2017 05:36</strong></div>
				<div class="author">by <strong>bluesky088</strong></div>
				<div class="content"><blockquote><div><cite>Squashman wrote:</cite>Did you look at the /X option.</div></blockquote><br /><br />I'm not too sure how does the /X option work?<br /><br />jrepl &quot;^.*&quot; &quot;abc123&quot; /inc 3 /f &quot;C:\test.txt&quot; /o - /X \q<br /><br />Says there are too many arguments</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: JREPL.BAT - regex text processor - successor to REPL.BAT</h3>
				<div class="date">Posted: <strong>26 Feb 2017 05:45</strong></div>
				<div class="author">by <strong>bluesky088</strong></div>
				<div class="content"><blockquote><div><cite>bluesky088 wrote:</cite><blockquote><div><cite>Squashman wrote:</cite>Did you look at the /X option.</div></blockquote><br /><br />I'm not too sure how does the /X option work?<br /><br />jrepl &quot;^.*&quot; &quot;abc123&quot; /inc 3 /f &quot;C:\test.txt&quot; /o - /X \q<br /><br />Says there are too many arguments</div></blockquote><br /><br />Figured it out:<br /><br />jrepl &quot;^.*&quot; &quot;\qabc123\q&quot; /inc 3 /f &quot;C:\test.txt&quot; /o - /X<br /><br />This works now. thanks</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: JREPL.BAT - regex text processor - successor to REPL.BAT</h3>
				<div class="date">Posted: <strong>01 Mar 2017 12:45</strong></div>
				<div class="author">by <strong>catalinnc</strong></div>
				<div class="content">@dbenham<br /><br />i have this text file:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>somerandomblablablaSTARTmorerandomblablablaENDlastrandomblablabla</code></pre></div><br /><br />can i use this tool (in a .bat) to insert a new line (hex sequence 0x0d0a) before START and after END in one ore more steps?<br />_</div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="UTC-6">UTC-06:00</span><br />Page <strong>18</strong> of <strong>27</strong></div>
		<div class="copyright">Powered by phpBB&reg; Forum Software &copy; phpBB Limited<br />https://www.phpbb.com/</div>
	</div>
</div>

</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=6044&start=255&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 07:59:54 GMT -->
</html>
