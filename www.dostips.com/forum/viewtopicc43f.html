<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=7153&start=45&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 06:32:13 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>DosTips.com &bull; Cmdgfx - draw 3d and graphic primitives (polygons,circles etc) in cmd window - Page 4</title>

<link href="styles/AllanStyle-SUBSILVER/theme/print.css" rel="stylesheet">
</head>
<body id="phpbb">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>DosTips.com</h1>
		<p>A Forum all about DOS Batch<br /><a href="index-2.html">https://www.dostips.com/forum/</a></p>

		<h2>Cmdgfx - draw 3d and graphic primitives (polygons,circles etc) in cmd window</h2>
		<p><a href="viewtopic9d55.html?f=3&amp;t=7153">https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=7153</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>4</strong> of <strong>7</strong></div>
					<div class="post">
				<h3>Re: Cmdgfx - draw graphic primitives (polygons,circles etc) in cmd line window</h3>
				<div class="date">Posted: <strong>22 Jul 2016 16:55</strong></div>
				<div class="author">by <strong>misol101</strong></div>
				<div class="content">Archive updated. This thing has been consuming way too much of my time lately, so it may be the last release.<br /><br /><strong class="text-strong">What's new?<br /></strong><br />There is a new executable called cmdgfx_gdi.exe. It appears to work just like the regular cmdgfx.exe but is much bigger, ~190k instead of ~75k. This is because the 10 cmd bitmap fonts are embedded inside it, and all &quot;text&quot; drawing is in fact bitmaps. As discussed in the thread before, this increases speed (though not in all cases).<br /><br /><strong class="text-strong">Usage: cmdgfx_gdi [operations] [flags] [fgpalette] [bgpalette]<br /></strong><br />The main thing about cmdgfx_gdi is you should specify which font you want to use. The program does not care which font you are *actually* using at the moment. You do this with the f flag, as in fn[:x,y,w,h;], where n is the font 0-9, and x,y are where to place the resulting bitmap, and w,h are how big it should be (in characters). Default values are n=6, x=0, y=0, w=current number of columns, h=current number of rows.<br /><br />There is one more thing that is different: you can optionally specify the colors used for foreground and background, i.e. the RGB values of the index 0-15. They should be specified like &quot;RRGGBB,&quot; repeated.<br /><br />The new gfxtest7.bat shows the use of palette and switching font, and shows a nicely gradiented goraud shaded polygon.<br /><br /><strong class="text-strong">So what about speed?</strong><br /><br />It's a bit confusing. On the one hand it really improves it in some cases, and in some it's worse. The following bats now use the gdi version by default, because it increases speed, more or less:<br /><br />3dworld2 (~100%)<br />bob-flag (~2-300%)<br />interference (~1-200%)<br />pixeltest1/2<br />linetest<br />gfxtest3<br />dot-flag<br />pixel-tunnel (not much)<br /><br />In these cases, you can press 'r' while running to switch between running cmdgfx.exe and cmdgfx_gdi.exe to see the difference<br /><br />Generally speaking, the more color changes and the smaller the font, the more speed should increase. However I fail to understand why e.g. interference.bat is so much faster with the gdi version, since it uses just one color?!<br /><br />(Edit: on second thought it does make sense. The XOR'ing in intereference.bat makes the foreground color switch between 0 and 1 over and over)<br /><br />The linking of gdi with the exe causes a longer overhead time for simply starting the program, which is one of the reasons it's not always faster. Also, if there are mostly big blocks of the same color, it may also be slower.<br /><br />Blablabla...  <img class="smilies" src="images/smilies/icon_mrgreen.gif" alt=":mrgreen:" title="Mr. Green" /><br /><br /><img src="https://uc447326439f7fd31841d3824171.dl.dropboxusercontent.com/cd/0/inline/ATY9DWy2Jb2uelHCC7afgYbyiwA7yD5x3BuqO2o1qu44lUbLdV5B1C_vOFUDKLRsrkSZ8bjxif5Vo53XxuFk9yMYeRuFIRmOUoKWhC1xJUX7x082rLg5BPuW6Cmjgl5ZYmZq3joyhk4UlMMOkdLswTSGFY8dJ0ABcMrqnYKqJA9tn3E7oLNGfw5zW9VsKJCldO8/file" class="postimage" alt="Image" /></div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Cmdgfx - draw graphic primitives (polygons,circles etc) in cmd line window</h3>
				<div class="date">Posted: <strong>22 Jul 2016 17:59</strong></div>
				<div class="author">by <strong>penpen</strong></div>
				<div class="content"><blockquote><div><cite>misol101 wrote:</cite>Is there a faster way to create and blit the output to the screen than what I'm doing below?</div></blockquote>I'm unsure if how much speed you would gain, but you could minimize the amount of &quot;malloc&quot; and &quot;free&quot; calls (depending on the implementation of malloc/free these functions could be very slow):<br />Use free and malloc, only malloc on (outdata == null), realloc when the size of the console has changed, and free it on exit.<br /><br />Same for other variables (hBmp1; maybe you don't need to create the compatible device context on every call - maybe only when the hWnd or hDc changes - maybe never; you have to test this;).<br /><br /><br /><blockquote><div><cite>misol101 wrote:</cite>Why not use OpenGL instead godammit</div></blockquote>To be honest: i don't know how to implement this; i only know that it must be possible, because a fellow student once has implemented it to have a background image in console (but i don't know how fast it was; i saw no differences in speed, but he only executed some batches to compile java, so he never touched the limit).<br />He read the complete source of glut: Maybe there you could find the solution - but it is probably much work... .<br /><br /><br />penpen</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Cmdgfx - draw graphic primitives (polygons,circles etc) in cmd line window</h3>
				<div class="date">Posted: <strong>22 Jul 2016 18:37</strong></div>
				<div class="author">by <strong>misol101</strong></div>
				<div class="content"><blockquote><div><cite>penpen wrote:</cite>you could minimize the amount of &quot;malloc&quot; and &quot;free&quot; calls (depending on the implementation of malloc/free these functions could be very slow)<br />Same for other variables (hBmp1; maybe you don't need to create the compatible device context on every call - maybe only when the hWnd or hDc changes - maybe never; you have to test this;).</div></blockquote><br />Thanks, I did some quick tests of this but it made very little impact.<br />According to my stats, it's approximately:<br />for-loop conversion from char to bitmap data: 54% of execution time inside my convertToGdiBitmap function<br />call to CreateBitmap+BitBlt: 36%<br />everything else (free/malloc/createDC/releaseDC etc): 9%<br /><br /><blockquote><div><cite>penpen wrote:</cite><blockquote><div><cite>misol101 wrote:</cite>Why not use OpenGL instead godammit</div></blockquote>To be honest: i don't know how to implement this; i only know that it must be possible, because a fellow student once has implemented it to have a background image in console (but i don't know how fast it was; i saw no differences in speed, but he only executed some batches to compile java, so he never touched the limit).<br />He read the complete source of glut: Maybe there you could find the solution - but it is probably much work... .<br /></div></blockquote><br />Ah, I see. That's interesting, although in this context I actually self-sarcastically meant &quot;why am I doing graphics in text mode at all, why don't I spend my time improving my regular rendering chain (such as OpenGL in a regular window or fullscreen) like a normal person?&quot; <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /></div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Cmdgfx - draw graphic primitives (polygons,circles etc) in cmd line window</h3>
				<div class="date">Posted: <strong>23 Jul 2016 12:25</strong></div>
				<div class="author">by <strong>misol101</strong></div>
				<div class="content"><blockquote><div><cite>aGerman wrote:</cite>Even default fonts are already problematic. Consolas font was the default setting in my Win 10. Mixing bitmap and text may fail more often as you expect.</div></blockquote><br /><br />As a response to this, I decided to be more dictatorial and force font 6 in all the examples where I didn't set the font automatically before. Not very &quot;nice&quot; behavior, but it's a game/demo engine after all... <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br /><br />So the archive was again updated <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /> Also, I added 3dworld3.bat, which shows how to add moving objects into a static 3d world. Unfortunately this means writing to a file every single frame. Not very efficient... Also, the plane should rotate, Doom-style, to always face the viewer, but it seemed like too much work for a test.<br /><br /><img src="https://ucd6c70f46935da5e9bee824339a.dl.dropboxusercontent.com/cd/0/inline/ATbctkYs943t4WiK2nWcaJKeCBPZIl3f-SQgPODi9LqKnPUoT1WHbXsayLkI3WW72OMcBqyYGxb5AosHKXngxeo4fOepG7Jtgxwx9RYCIbSFGfAp0mzjYAhbEZ8mwoV1Mou98vQRaFCvsRMq5fd7_IyfTptdYSVmHPMHyGvHdce83knFJyueLhCucxhBoA-1OIY/file" class="postimage" alt="Image" /></div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Cmdgfx - draw graphic primitives (polygons,circles etc) in cmd line window</h3>
				<div class="date">Posted: <strong>23 Jul 2016 13:42</strong></div>
				<div class="author">by <strong>aGerman</strong></div>
				<div class="content">Neat <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /> <br /><blockquote><div><cite>misol101 wrote:</cite>Not very &quot;nice&quot; behavior</div></blockquote><br />No that's reasonable. Everything has to match in order to get a proper result. I bet you can't adjust the resolution or the font size in any other game, can you? Certainly those are presets. (I'm not a gamer as you may have noticed.)</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Cmdgfx - draw graphic primitives (polygons,circles etc) in cmd line window</h3>
				<div class="date">Posted: <strong>01 Aug 2016 21:39</strong></div>
				<div class="author">by <strong>misol101</strong></div>
				<div class="content">Archive updated.<br /><br /><strong class="text-strong">1. 3d objects can now use gxy textures</strong><br />This allows for more complex textures (not just color change but also character change).<br />See gxy-cube.bat for an example (try pressing SPACE, D/d)<br /><br /><strong class="text-strong">2. 3d objects can now set the colors of faces from within the file</strong><br />This works only for obj files and uses a non-standard extension of the obj file format.<br />Sure it would be nice to support mtl files with specular/diffuse light etc but it doesn't really work in a 16 color world.<br />Spaceship.bat provides a (not very exciting) example.<br /><br /><strong class="text-strong">3. Support reading mouse events, support reading key up/down events</strong><br />This is all done with the M flag, a max wait time can be specified. It returns a 31 bit pattern from which both mouse and key events can be examined. <br />See mouse_palette-test.bat for explanation/example (hold down left or right button and move, try SPACE and mouse wheel).<br />Reading keys this way also means you do not have to wait for key repeat.<br />3world3.bat was changed to show this, as well as some simple &quot;lookaround&quot; with the mouse. Use mouse wheel to turn around.<br /><br /><strong class="text-strong">4. Can now set palette(s) for a color transformation at end of last operation</strong><br />This way it's sometimes possible to make nicer shades of colors.<br />Again, see mouse_palette-test.bat (press SPACE to change palette).<br /><br />Cyberpunky screenshots from mouse_palette-test.bat and gxy-cube.bat:<br /><br /><img src="https://uce7afcbf7f33a0458221f88d879.dl.dropboxusercontent.com/cd/0/inline/ATaOzvjyxBg0o62Ss7MnBFjURsjhYPngZmYnBx_zp1q6AB-koh0kGflWSOJ54XJhb5bwyMMatbIMoPNWTDfC-Xxg3T7hW0vWOGc6GaafR4JIGi_nyb6A5ZXWFBgI-evCHyFcmp2FG8x7cKNewlWkZsr1-pkiNVc_lc-FUZ2V8mvpl9xDBlgqVVEAm-wm6GFBlgU/file" class="postimage" alt="Image" /></div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Cmdgfx - draw graphic primitives (polygons,circles etc) in cmd line window</h3>
				<div class="date">Posted: <strong>02 Aug 2016 18:36</strong></div>
				<div class="author">by <strong>misol101</strong></div>
				<div class="content">One more.<br /><br />Added operation &quot;block&quot; to copy/transform a block. This is a pretty complicated operation, but in the simplest form it just copies or moves a block from one place to another.<br /><br />The idea is to optionally specify a list of indata and outdata, a form of search/replace for every location in the copied block. For example 1020=a0db would look for all SPACE(20) characters with color 0x01, and replace that with char db,color 0x0a. That is the easy one, but also values can be skipped, like 1???=9??? means match all characters with fgcolor 1 and change to color 9. Also, the output can be increased or decreased, like ?0??=-0?? means for all characters with bgcolor 0, decrease fgcolor by 1. Etc.<br /><br />There are two examples: mouse-blocktransform.bat, which looks the same as mouse_palette-test.bat, but is much faster due to skipping the two earlier needed extra exe calls. Second example is fire.bat, an attempt to create the classic fire effect with the &quot;block&quot; operation, with so-so results (try SPACE, ENTER, possibly cursor keys).<br /><br /><img src="https://uc4f20d00a1db7cc4364a1674946.dl.dropboxusercontent.com/cd/0/inline/ATY77UUFJ3EjDgZsbU9P-h1d4tBdtX7aBIYQgPkNTwQE21yhdyHdS2pe3dYneFveHl_llkRXvtuQtrtxg9CLsChwYO4kQ_ptrqWHSMWY8q4OiZvBK_vGHCWdorwEuosT8Hq_MK_NoMYQiyaXEFXDz3GFDNv8-3cfVJpx87T49osR_r7xFiBp5lJKoRV6K5_emF0/file" class="postimage" alt="Image" /><br /><br />Edit: it might be interesting to scroll right in fire.bat example, to see what the block operation does behind the scenes(in two steps) <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br /><br />Edit2: updated archive with fire2.bat, a slightly better-looking fire</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Cmdgfx - draw graphic primitives (polygons,circles etc) in cmd line window</h3>
				<div class="date">Posted: <strong>09 Aug 2016 18:54</strong></div>
				<div class="author">by <strong>misol101</strong></div>
				<div class="content">3dworld3.bat in archive updated:<br /><br />1. a/d can now be used for strafing (and w/s to move, j/k to rotate (in addition to cursor keys))<br />2. Fixed bug when rotating with mouse<br />3. Non-repeating keys such as h,m,r,p now work as expected<br />4. Help text updated</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Cmdgfx - draw graphic primitives (polygons,circles etc) in cmd line window</h3>
				<div class="date">Posted: <strong>10 Aug 2016 08:26</strong></div>
				<div class="author">by <strong>misol101</strong></div>
				<div class="content">Finally put this thing, including all source code, on github:<br /><br /><a href="https://github.com/misol1/cmdgfx" class="postlink">https://github.com/misol1/cmdgfx</a><br /><br />No I certainly don't claim that it's well-written or nicely structured (especially not cmdgfx.c), but there have been a few PM requests for it. It's fairly fast code, but it's quick-n-dirty.<br /><br />To compile, (with gcc/mingw) write &quot;make cmdgfx.exe&quot; (or &quot;make cmdgfx_gdi.exe&quot;). A simple &quot;make&quot; will instead build &quot;testlib.exe&quot;, which uses the rendering in e.g. &quot;gfx.c&quot; in pure C, no batch. You will notice the speed difference (as well as a kind of &quot;antialiasing&quot;), though &quot;testlib.exe&quot; does not use the &quot;bitmap solution&quot; of cmdgfx_gdi, so it may not always be faster. There are lots of keys in &quot;testlib.exe&quot;, you'll have to look in the source code for those. Try e.g. in sequence, 'C', 'n', 'o'<br /><br />Note: At the top of cmdgfx.c is a &quot;to-do&quot; list. Yes, yes, go ahead...  <img class="smilies" src="images/smilies/icon_mrgreen.gif" alt=":mrgreen:" title="Mr. Green" /></div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Cmdgfx - draw graphic primitives (polygons,circles etc) in cmd line window</h3>
				<div class="date">Posted: <strong>14 Aug 2016 11:17</strong></div>
				<div class="author">by <strong>misol101</strong></div>
				<div class="content">I was supposed to stop playing with this... <br /><br />Anyway, I saw a program by carlos called pixelfont.exe and that made me a bit curious how that would look with the 3d world. So I added pixelfonts 1x1, 2x2 and 3x3 to cmdgfx_gdi (to use them, specify a,b, or c as font to the f flag). In these fonts, all characters except 0,32 and 255 show the fgcolor only.<br /><br />Result, 3dworld3_pxlfont.bat (720x500 resolution, pixelfont 1x1):<br /><br /><img src="https://ucf0bbff8ae2366d2185ef73e7ba.dl.dropboxusercontent.com/cd/0/inline/ATbGQsqFBvcn0xFTOy3HYIgAjpa8Wymp_hqJpAAMmBT3GgvP9nuZ_fAx7q-AogAg9Vm6CuT3yYYSVBIK7ae1ZdIhXrvEqKQWR5cR_JaLf76xePBRJLrGGwQKJH-xIqieYM9Vd45hjDG6B9zIMI46ELF8gkrBgXM3J-99Y9C235dw0_enePS_RCm2YMUEL_DA5SI/file" class="postimage" alt="Image" /><br /><br />The downside to this is that the normal 3dworld3.bat looks like crap in comparison <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /> So, again I ask myself what I have been doing with this text stuff for so long...haha<br /><br />Also added a new bat with rotating balls sorted acording to z value, called balls-sorted.bat.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Cmdgfx - draw graphic primitives (polygons,circles etc) in cmd line window</h3>
				<div class="date">Posted: <strong>17 Aug 2016 09:57</strong></div>
				<div class="author">by <strong>foxidrive</strong></div>
				<div class="content">Bro and I used to be heavily into Doom and similar games of the time.   <br /><br />If anyone said there would be such things as you are doing here back then they would have been laughed out of the building. <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br /><br />So many graphic batch files and tools have been shown in DosTips in the last year that just astound me with the thought that it was so limited back then and has come to the point that all these batch scripts are now possible.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Cmdgfx - draw graphic primitives (polygons,circles etc) in cmd line window</h3>
				<div class="date">Posted: <strong>17 Aug 2016 11:20</strong></div>
				<div class="author">by <strong>Aacini</strong></div>
				<div class="content">You may review the original source of the 1x1 pixel size font at <a href="viewtopic6d3a.html?f=3&amp;t=5266" class="postlink">this thread</a>.<br /><br />Antonio</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Cmdgfx - draw graphic primitives (polygons,circles etc) in cmd line window</h3>
				<div class="date">Posted: <strong>18 Aug 2016 16:50</strong></div>
				<div class="author">by <strong>misol101</strong></div>
				<div class="content"><blockquote><div><cite>foxidrive wrote:</cite>Bro and I used to be heavily into Doom and similar games of the time.   <br /><br />If anyone said there would be such things as you are doing here back then they would have been laughed out of the building. <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br /><br />So many graphic batch files and tools have been shown in DosTips in the last year that just astound me with the thought that it was so limited back then and has come to the point that all these batch scripts are now possible.</div></blockquote><br />Yeah, though I guess there is no limit to what a &quot;batch script&quot; can do if it consist of one line only: @runprogram.exe  <img class="smilies" src="images/smilies/icon_mrgreen.gif" alt=":mrgreen:" title="Mr. Green" /> <br /><br />But I think cmdgfx strikes a fair balance between doing the logic with scripting and leaving the rendering to the external program.<br /><br /><blockquote><div><cite>Aacini wrote:</cite>You may review the original source of the 1x1 pixel size font at this thread.</div></blockquote><br />Cool, so it was a joint effort <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /> I cannot actually use pixelfnt.exe for my purposes though, because of the previously discussed slowness of the WriteConsoleOutput API. The FPS for 3dworld3_pxlfont.bat drops from ~30 to ~3 on my computer using pixelfnt instead of directly writing a bitmap to the window.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Cmdgfx - draw graphic primitives (polygons,circles etc) in cmd line window</h3>
				<div class="date">Posted: <strong>04 Sep 2016 15:34</strong></div>
				<div class="author">by <strong>misol101</strong></div>
				<div class="content">Archive and repo update. Cmdwiz (the cmdgfx companion) had a bunch of new operations added:<br /><br />1. <strong class="text-strong">getwindowbounds </strong>to get the console window's x/y position or its width and height. Note that the border is also included in these values.<br /><br />2. <strong class="text-strong">setwindowpos </strong>to set the position of the console window<br /><br />3. <strong class="text-strong">getdisplaydim </strong>to get the resolution of the current display (useful to e.g center the window with setwindowpos)<br /><br />4. <strong class="text-strong">getmousecursorpos </strong>returns the screen coordinates of the mouse pointer<br /><br />5. <strong class="text-strong">setmousecursorpos</strong> to set the mouse pointer position. In addition, it is possible to specify that a click happens after the move, either a left click, a right click, a left button down, or left button up. The last two can be used to e.g. simulate dragging windows around. This makes cmdwiz useful as a simple mouse task automation tool.<br /><br />6. <strong class="text-strong">insertbmp </strong> is used to paste a bmp file in the console window, either as-is or stretched-out either as a percentage or as width/height settings. Full credits to <strong class="text-strong">aGerman</strong> for this function, which is also noted in the source code.<br /><br />7. <strong class="text-strong">setwindowtransparency </strong>is used to set the transparency of the console window between 0 and 100. Again, full credit to <strong class="text-strong">aGerman </strong>for the source code.<br /><br />8. <strong class="text-strong">setfont </strong> was lifted from <strong class="text-strong">carlos</strong> BG tool, full credit to him for this functionality (also noted in the source code). I then extended this operation by adding support for saved fonts, so in addition to the 10 terminal bitmap fonts it is also possible to load any font added to the console which has been saved with the corresponding <strong class="text-strong">savefont </strong>operation. This also makes it possible to restore your original font after a change to another font.<br /><br />9. quickedit operation changed name to <strong class="text-strong">setquickedit </strong>and a corresponding <strong class="text-strong">getquickedit </strong>operation was added<br /><br /><br />See the thread here (<!-- l --><a class="postlink-local" href="viewtopiccd0f.html?f=3&amp;t=7129">viewtopic.php?f=3&amp;t=7129</a><!-- l -->) for an example batch showing how to use these operations. Also, 3dworld_pixelfont.bat uses some of them to center its window on the screen.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Cmdgfx - draw graphic primitives (polygons,circles etc) in cmd line window</h3>
				<div class="date">Posted: <strong>15 Sep 2016 15:46</strong></div>
				<div class="author">by <strong>misol101</strong></div>
				<div class="content">I decided to try cmdgfx with some other scripting languages to investigate the difference in speed.<br /><br />Conclusion: it doesn't look too good for batch <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /> (kind of expected)<br /><br />I made the test script in batch, then Python, and then (since I heard it was supposed to be quite fast) Lua.<br />The script(s) moves 200 stars individually per frame, running 400 frames before printing the FPS.<br /><br />Results:<br />Batch: 9 FPS<br />Python: 72 FPS<br />Lua: 25 FPS<br /><br />So at least in my naive scripts, Python is clearly the fastest, about 8 times as fast as Batch. Python also has the advantage that it's very easy to run the external program (cmdgfx) asynchronously. However, when I ran it synchronously, the FPS was still 66, so that part doesn't make a real big difference (I thought it would).<br /><br />Still I'm pretty sure if there is no heavy processing going on, then batch is faster or equally fast as python, since the overhead time for executing the external seems slightly bigger in Python.<br /><br />Can anybody remake this in Jscript (I don't know it, but heard it's fast)? <br />Also, are there other scripting languages known for high speed?<br /><br />Batch script&#058;<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />setlocal ENABLEDELAYEDEXPANSION<br /><br />for /F &quot;Tokens=1 delims==&quot; %%v in ('set') do if /I not &quot;%%v&quot; == &quot;PATH&quot; set &quot;%%v=&quot;<br />set /a XSIZE=140, YSIZE=50, NOF=200, XDELAY=2, TIMES=400<br />mode %XSIZE%,%YSIZE% &amp; cls<br />set /a XMAX=%XSIZE%*%XDELAY%, YMAX=%YSIZE%*%XDELAY%<br />for /L %%b in (0,1,%NOF%) do call :MAKESTAR %%b<br />cmdwiz gettime&amp;set STARTT=!errorlevel!<br /><br />for /L %%a in (1,1,%TIMES%) do (<br />&nbsp; &nbsp;set FIELD=&quot;&quot;<br />&nbsp; &nbsp;for /L %%b in (0,1,%NOF%) do set /a XTMP=!SX%%b!/%XDELAY%, SX%%b+=!SS%%b!&amp;set FIELD=&quot;!FIELD:~1,-1! &amp; pixel !SC%%b! 0 . !XTMP!,!SY%%b!&quot;&amp;if !SX%%b! geq %XMAX% set /a SX%%b=0<br />&nbsp; &nbsp;cmdgfx !FIELD!<br />)<br /><br />mode 80,50&amp;cls<br />cmdwiz gettime&amp;set /a FPS=(!errorlevel!-%STARTT%)/1000&amp;set /a FPS=%TIMES%/!FPS!&amp;echo !FPS!<br />endlocal<br />goto :eof<br /><br />:MAKESTAR<br />set /a SY%1=%RANDOM% %% %YSIZE%, SX%1=%RANDOM% %% %XMAX%<br />set /a SS%1=%RANDOM% %% 3 + 1<br />if !SS%1! == 1 set SC%1=8<br />if !SS%1! == 2 set SC%1=7<br />if !SS%1! == 3 set SC%1=F<br /></code></pre></div><br /><br />Python (hybrid Batch) script&#058;<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>0&lt;0# : ^<br />''' <br />@echo off<br />setlocal ENABLEDELAYEDEXPANSION<br />cmdwiz setfont 6 &amp; cls &amp; mode 140,50<br />cmdwiz gettime&amp;set STARTT=!errorlevel!<br />python %~f0 %*<br />mode 80,50 &amp; cls<br />cmdwiz gettime&amp;set /a FPS=(!errorlevel!-%STARTT%)/1000&amp;set /a FPS=400/!FPS!&amp;echo !FPS!<br />endlocal<br />exit /b 0<br />'''<br /><br />from subprocess import Popen<br />from random import randint, uniform<br /><br />out, process, nofStars = 0, 0, 200<br />starsX,starsY,starsS,starsC=&#91;&#93;,&#91;&#93;,&#91;&#93;,&#91;&#93;<br /><br />for x in range(0, nofStars):<br />&nbsp; starsX+=&#91;randint(0,140)&#93;<br />&nbsp; starsY+=&#91;randint(0,50)&#93;<br />&nbsp; starsS+=&#91;uniform(0.1,1.3)&#93;<br />&nbsp; if starsS&#91;x&#93; &lt; 0.5:<br />&nbsp; &nbsp; starsC += &#91;8&#93;<br />&nbsp; elif starsS&#91;x&#93; &lt; 1.1:<br />&nbsp; &nbsp; starsC += &#91;7&#93;<br />&nbsp; else:<br />&nbsp; &nbsp; starsC += &#91;15&#93;<br />&nbsp; <br />#while (out != 27):<br />for x in range(0, 400):<br />&nbsp; outString=&quot;&quot;<br />&nbsp; for i in range(0, nofStars):<br />&nbsp; &nbsp; &nbsp;starsX&#91;i&#93; += starsS&#91;i&#93;<br />&nbsp; &nbsp; &nbsp;if starsX&#91;i&#93; &gt; 140:<br />&nbsp; &nbsp; &nbsp; &nbsp; starsX&#91;i&#93; = 0<br />&nbsp; &nbsp; &nbsp;outString = outString + &quot;&amp; pixel &quot; + str(starsC&#91;i&#93;) + &quot; 0 . &quot; + str(int(starsX&#91;i&#93;)) + &quot;,&quot; + str(starsY&#91;i&#93;)<br /><br />&nbsp; if process != 0:<br />&nbsp; &nbsp; &nbsp;out = process.wait()<br />&nbsp; process = Popen(&#91;&quot;cmdgfx.exe&quot;, outString, &quot;k&quot;&#93;)<br /></code></pre></div><br /><br />Lua (hybrid Batch) script&#058;<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>--&#91;=====&#91; &gt;nul 2&gt;nul<br />@echo off<br />setlocal ENABLEDELAYEDEXPANSION<br />cls &amp; cmdwiz setfont 6 &amp; mode 140,50<br />cmdwiz gettime&amp;set STARTT=!errorlevel!<br />lua %~f0 %*<br />mode 80,50 &amp; cls<br />cmdwiz gettime&amp;set /a FPS=(!errorlevel!-%STARTT%)/1000&amp;set /a FPS=400/!FPS!&amp;echo !FPS!<br />endlocal<br />exit /b 0<br />--&#93;=====&#93;<br /><br />nofStars = 200<br />starsX = {}<br />starsY = {}<br />starsS = {}<br />starsC = {}<br /><br />for i=0,nofStars,1 do <br />&nbsp; starsX&#91;i&#93;=math.random() + math.random(1, 139)<br />&nbsp; starsY&#91;i&#93;=math.random(1, 49)<br />&nbsp; starsS&#91;i&#93;=math.random()*1.3<br />&nbsp; if starsS&#91;i&#93; &lt; 0.5 then<br />&nbsp; &nbsp;starsC&#91;i&#93; = 8<br />&nbsp; elseif starsS&#91;i&#93; &lt; 1.1 then<br />&nbsp; &nbsp; starsC&#91;i&#93; = 7<br />&nbsp; else<br />&nbsp; &nbsp; starsC&#91;i&#93; = 15<br />&nbsp; end<br />end<br /><br />for j=0,400,1 do <br />&nbsp; outString=&quot;&quot;<br />&nbsp; for i=0,nofStars,1 do<br />&nbsp; &nbsp; &nbsp;starsX&#91;i&#93; = starsX&#91;i&#93; + starsS&#91;i&#93;<br />&nbsp; &nbsp; &nbsp;if starsX&#91;i&#93; &gt; 140 then<br />&nbsp; &nbsp; &nbsp; &nbsp; starsX&#91;i&#93; = 0<br />&nbsp; &nbsp; &nbsp;end<br />&nbsp; &nbsp; &nbsp;outString = outString .. &quot;&amp; pixel &quot; .. starsC&#91;i&#93; .. &quot; 0 . &quot; .. math.floor(starsX&#91;i&#93;) .. &quot;,&quot; .. starsY&#91;i&#93;<br />&nbsp; end<br /><br />&nbsp; key = os.execute('cmdgfx &quot;' .. outString .. '&quot; k')<br />end<br /></code></pre></div></div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="UTC-6">UTC-06:00</span><br />Page <strong>4</strong> of <strong>7</strong></div>
		<div class="copyright">Powered by phpBB&reg; Forum Software &copy; phpBB Limited<br />https://www.phpbb.com/</div>
	</div>
</div>

</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=7153&start=45&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 06:32:18 GMT -->
</html>
