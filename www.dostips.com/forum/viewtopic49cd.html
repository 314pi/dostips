<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=7347&start=15 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 07:50:24 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>Creating a script to gather PC information - to assist those asking for help - Page 2 - DosTips.com</title>


	<link rel="canonical" href="viewtopic6dc4.html?t=7347&amp;start=15">

<!--
	phpBB style name: Allan Style - SUBSILVER
	Based on style:   prosilver (this is the default phpBB3 style)
	Based on style:   subsilver2 (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:  Allan ( http://x-tk.ru/ )
-->

<link href="assets/css/font-awesome.mind772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/stylesheetd772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/en/stylesheetd772.css?assets_version=34" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="./styles/AllanStyle-SUBSILVER/theme/tweaks.css?assets_version=34" rel="stylesheet">
<![endif]-->




<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','../../www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-280191-1', 'auto');
	ga('send', 'pageview');
</script>

</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">

<div id="header-subsilver">
	<a id="top" class="top-anchor" accesskey="t"></a>
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description" class="site-description">
				<a id="logo" class="logo" href="../index.html" title="DosTips.com"><span class="site_logo"></span></a>
				<h1>DosTips.com</h1>
				<p>A Forum all about DOS Batch</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

									<div id="search-box" class="search-box search-header" role="search">
				<form action="https://www.dostips.com/forum/search.php" method="get" id="search">
				<fieldset>
					<input name="keywords" id="keywords" type="search" maxlength="128" title="Search for keywords" class="inputbox search tiny" size="20" value="" placeholder="Search…" />
					<button class="button button-search" type="submit" title="Search">
						<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
					</button>
					<a href="search.html" class="button button-search-end" title="Advanced search">
						<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
					</a>
					
				</fieldset>
				</form>
			</div>
						
			</div>
					</div>
</div>


<div id="wrap" class="wrap">
	<div id="page-header">
				<div class="navbar-top" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
																									<li>
								<a href="search33a7.html?search_id=unanswered" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="search526f.html?search_id=active_topics" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-blue" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="search.html" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
											<li class="separator"></li>
																			<li>
								<a href="memberlist4bfd.html?mode=team" role="menuitem">
									<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
								</a>
							</li>
																<li class="separator"></li>

									</ul>
			</div>
		</li>

				<li data-skip-responsive="true">
			<a href="app.php/help/faq.html" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
						
			<li class="rightside"  data-skip-responsive="true">
			<a href="ucp26c3.html?mode=login" title="Login" accesskey="x" role="menuitem">
				<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Login</span>
			</a>
		</li>
					<li class="rightside" data-skip-responsive="true">
				<a href="ucp8319.html?mode=register" role="menuitem">
					<i class="icon fa-pencil-square-o  fa-fw" aria-hidden="true"></i><span>Register</span>
				</a>
			</li>
						</ul>

	</div>
</div>

<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
						<li class="breadcrumbs">
							<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="../index.html" itemprop="url" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span itemprop="title">DosTips.com</span></a></span>
										<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="index.html" itemprop="url" accesskey="h" data-navbar-reference="index"><span itemprop="title">Board index</span></a></span>

											<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="4"><a href="viewforum31e6.html?f=4" itemprop="url"><span itemprop="title">DosTips - Dos Batch</span></a></span>
															<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="3"><a href="viewforum4d6b.html?f=3" itemprop="url"><span itemprop="title">DOS Batch Forum</span></a></span>
												</li>
		
					<li class="rightside responsive-search">
				<a href="search.html" title="View the advanced search options" role="menuitem">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</a>
			</li>
			</ul>

	</div>
</div>

<div class="navbar-top-link">
	<div class="inner">
		<ul>
			<li class="navbar-top-link-left"><a href="search33a7.html?search_id=unanswered">Unanswered topics</a></li>
			<li class="navbar-top-link-left"><a href="search526f.html?search_id=active_topics">Active topics</a></li>

											</ul>
	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
		
<h2 class="topic-title"><a href="viewtopic49cd.html?f=3&amp;t=7347&amp;start=15">Creating a script to gather PC information - to assist those asking for help</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">Discussion forum for all Windows batch related topics.<br /></div>
<p>
	<strong>Moderator:</strong> <a href="memberlista6a8.html?mode=viewprofile&amp;u=5" class="username">DosItHelp</a>
</p>


<div class="action-bar bar-top">
	
			<a href="posting0b06.html?mode=reply&amp;f=3&amp;t=7347" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic00db.html?f=3&amp;t=7347&amp;start=15&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="https://www.dostips.com/forum/search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topic…" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="search.html" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="7347" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			158 posts
							<ul>
	<li class="dropdown-container dropdown-button-control dropdown-page-jump page-jump">
		<a class="button button-icon-only dropdown-trigger" href="#" title="Click to jump to page…" role="button"><i class="icon fa-level-down fa-rotate-270" aria-hidden="true"></i><span class="sr-only">Page <strong>2</strong> of <strong>11</strong></span></a>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
				<li>Jump to page:</li>
				<li class="page-jump-form">
					<input type="number" name="page-number" min="1" max="999999" title="Enter the page number you wish to go to" class="inputbox tiny" data-per-page="15" data-base-url=".&#x2F;viewtopic.php&#x3F;f&#x3D;3&amp;amp&#x3B;t&#x3D;7347" data-start-name="start" />
					<input class="button2" value="Go" type="button" />
				</li>
			</ul>
		</div>
	</li>
			<li class="arrow previous"><a class="button button-icon-only" href="viewtopic1343.html?f=3&amp;t=7347" rel="prev" role="button"><i class="icon fa-chevron-left fa-fw" aria-hidden="true"></i><span class="sr-only">Previous</span></a></li>
				<li><a class="button" href="viewtopic1343.html?f=3&amp;t=7347" role="button">1</a></li>
			<li class="active"><span>2</span></li>
				<li><a class="button" href="viewtopic7515.html?f=3&amp;t=7347&amp;start=30" role="button">3</a></li>
				<li><a class="button" href="viewtopic7c37.html?f=3&amp;t=7347&amp;start=45" role="button">4</a></li>
				<li><a class="button" href="viewtopiccda4-2.html?f=3&amp;t=7347&amp;start=60" role="button">5</a></li>
			<li class="ellipsis" role="separator"><span>…</span></li>
				<li><a class="button" href="viewtopic66e3.html?f=3&amp;t=7347&amp;start=150" role="button">11</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopic7515.html?f=3&amp;t=7347&amp;start=30" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
		</div>




<div id="subsilver-nav-topic">
	<div class="inner"><div class="post has-profile">
		<div class="leftsided postbody subsilver-topic-title">Message</div>
		<div class="leftsided postprofile subsilver-topic-author">Author</div>
	</div></div>
</div>

			<div id="p48427" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile48427">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf147.html?author_id=3221&amp;sr=posts">6033</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Feb 2012 02:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content48427">

						<h3 class="first"><a href="#p48427">Re: Creating a script to gather PC information - to assist those asking for help</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting6088.html?mode=quote&amp;f=3&amp;p=48427" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic41e6.html?p=48427#p48427" onclick="prompt('Message #16',this.href); return false;">#16</a></span> 
									<a class="unread" href="viewtopic41e6.html?p=48427#p48427" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a></strong> &raquo; </span>13 Aug 2016 03:29
			</p>
			
			
			
			<div class="content">I've been out herding the kangaroos and only just got back after one escaped... but I do like the idea of reporting details when<br /><br />1) Certain commands are missing or if they have the wrong extension (say a .bat extension) <br />2) and also report if certain essential items on the PATH statement are missing.<br /><br />I've implemented 2) below and added a check for permissions  (Hmmm, it may have a bug in user mode)<br /><br />Just adding here that this script concept as it stands is not an &quot;Official&quot; DosTips script and the people running it will always need to be aware of that.  <br /><br /><span style="color: blue">For those watching around now I've edited numerous times and played with the formatting too.</span><br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>Windows version&nbsp; &nbsp; :&nbsp; Microsoft Windows &#91;Version 6.3.9600&#93;<br />Product name&nbsp; &nbsp; &nbsp; &nbsp;:&nbsp; 32 bit Windows 8.1 Pro with Media Center<br />Processor arch&nbsp; &nbsp; &nbsp;:&nbsp; x86, CPU/Number of cores=8<br /><br />Date/Time format&nbsp; &nbsp;:&nbsp; dd/mm/yy (24 hours)&nbsp; &nbsp;Sat 13/08/2016&nbsp; 20:03:24.57<br />Extensions&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;:&nbsp; system:Enabled&nbsp; &nbsp;user:Enabled <br />Delayed expansion&nbsp; :&nbsp; system:Disabled&nbsp; user:Disabled<br />Locale name&nbsp; &nbsp; &nbsp; &nbsp; :&nbsp; en-AU&nbsp; &nbsp; &nbsp; Code Pages:OEM 850&nbsp; &nbsp; &nbsp;ANSI 1252<br />DIR&nbsp; format&nbsp; &nbsp; &nbsp; &nbsp; :&nbsp; 11/08/2016&nbsp; 02:05&nbsp; &nbsp; &nbsp;3,484,418,048 pagefile.sys<br />Permissions&nbsp; &nbsp; &nbsp; &nbsp; :&nbsp; Elevated Admin=No, Admin access=Yes, User access=No<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Missing from the PATH statement: C:\WINDOWS\system32<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Missing from the PATH statement: C:\WINDOWS\System32\Wbem<br /></code></pre></div><br /><br /><br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off &amp;setlocal EnableExtensions DisableDelayedExpansion<br />&nbsp;:: prepare some variables to shorten lines in the script<br />&nbsp;set &quot;International=HKCU\Control Panel\International&quot;<br />&nbsp;set &quot;CurrentVersion=HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion&quot;<br />&nbsp;set &quot;CodePage=HKLM\SYSTEM\CurrentControlSet\Control\Nls\CodePage&quot;<br />&nbsp;set &quot;CMDproc=Software\Microsoft\Command Processor&quot;<br /><br />:: Checks for user permissions<br />set &quot;Admin=No&quot; &amp; set &quot;A-access=No&quot; &amp; set &quot;user=Yes&quot;<br />cd &quot;%windir%\system32\config&quot; &gt;nul 2&gt;&amp;1 &amp;&amp; (set &quot;A-access=Yes&quot; &amp; set &quot;user=No&quot;)<br />reg query &quot;HKU\S-1-5-19&quot; &gt;NUL 2&gt;&amp;1 &amp;&amp; (set &quot;Admin=Yes&quot; &amp; set &quot;A-access=No&quot; &amp; set &quot;user=No&quot;)<br /><br /><br />:: checks path<br />:: removes random double quotes, adds double quotes, removes trailing slash<br />set &quot;p=%path%&quot;<br />set&nbsp; p=%p:&quot;=%<br />set&nbsp; p=%p:;=&quot; &quot;%<br />set&nbsp; p=%p:\&quot;=&quot;%<br />set&nbsp; p=&quot;%p%&quot;<br />:: echo debug &amp;echo.&amp;echo &quot;%p%&quot; &amp; (for %%a in (&quot;%p%&quot;) do echo %%a) &amp; pause &amp; goto :EOF<br /><br />:: Checks for certain path elements and reports if they are missing<br />set &quot;p-1=%windir%&quot;<br />set &quot;p-2=%windir%\system32&quot;<br />set &quot;p-3=%windir%\System32\Wbem&quot;<br />for %%a in (%p%) do (<br />&nbsp; if /i &quot;%%~a&quot;==&quot;%p-1%&quot; set &quot;p-1=%p-1%.yes&quot;<br />&nbsp; if /i &quot;%%~a&quot;==&quot;%p-2%&quot; set &quot;p-2=%p-2%.yes&quot;<br />&nbsp; if /i &quot;%%~a&quot;==&quot;%p-3%&quot; set &quot;p-3=%p-3%.yes&quot;<br />&nbsp; &nbsp;)<br /><br />&nbsp;set &quot;cores=%NUMBER_OF_PROCESSORS%&quot; &amp; set &quot;arch=%PROCESSOR_ARCHITECTURE%&quot;<br />&nbsp;set &quot;pad=&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;<br />&nbsp;:: Check for 64 bit windows.&nbsp; Defaults to 32 bit<br />&nbsp;set bit=32 bit<br />&nbsp;if exist &quot;%SystemRoot%\SysWOW64\&quot; set bit=64 bit<br />&nbsp;:: create a set of many varibles: checking date and time formats is one use<br />&nbsp;for /f &quot;tokens=1,2,*&quot; %%a in ('reg query &quot;%International%&quot;^|find &quot;REG_&quot;')&nbsp; do set &quot;%%a=%%c&quot;<br />&nbsp;if &quot;%iDate%&quot;==&quot;0&quot; (set format=mm/dd/yy) else if &quot;%iDate%&quot;==&quot;1&quot; (set format=dd/mm/yy) else if &quot;%iDate%&quot;==&quot;2&quot; (set format=yy/mm/dd)<br />&nbsp;if &quot;%iTime%&quot;==&quot;0&quot; (set hours=12) else if &quot;%iTime%&quot;==&quot;1&quot; (set hours=24)<br />&nbsp;:: get the DIR command format to display<br />&nbsp;for /f &quot;delims=&quot; %%a in ('dir &quot;%SystemDrive%\pagefile.sys&quot; /a ^|find &quot;:&quot;') do set DirFormat=%%a<br />&nbsp;:: determines the state of delayed expansion and extensions<br />&nbsp;for %%a in (es eu ds du) do set &quot;%%a=Disabled&quot;<br />&nbsp;reg query &quot;HKLM\%CMDproc%&quot; /v &quot;EnableExtensions&quot; 2&gt;nul|find &quot;0x1&quot;&gt;nul &amp;&amp; set &quot;es=Enabled &quot;<br />&nbsp;reg query &quot;HKCU\%CMDproc%&quot; /v &quot;EnableExtensions&quot; 2&gt;nul|find &quot;0x1&quot;&gt;nul &amp;&amp; set &quot;eu=Enabled &quot;<br />&nbsp;reg query &quot;HKLM\%CMDproc%&quot; /v &quot;DelayedExpansion&quot; 2&gt;nul|find &quot;0x1&quot;&gt;nul &amp;&amp; set &quot;ds=Enabled &quot;<br />&nbsp;reg query &quot;HKCU\%CMDproc%&quot; /v &quot;DelayedExpansion&quot; 2&gt;nul|find &quot;0x1&quot;&gt;nul &amp;&amp; set &quot;du=Enabled &quot;<br />&nbsp;:: create the information file and send the information to the clipboard if clip is available<br />&nbsp;&gt;&quot;%temp%\info.txt&quot; (<br />&nbsp; echo &#91;code^&#93;<br />&nbsp; for /f &quot;delims=&quot; %%a in ('ver') do echo Windows version&nbsp; &nbsp; :&nbsp; %%a<br />&nbsp; for /f &quot;tokens=2*&quot; %%a in ('<br />&nbsp; &nbsp; reg query &quot;%CurrentVersion%&quot;^|find /i &quot;ProductName&quot;') do echo Product name&nbsp; &nbsp; &nbsp; &nbsp;:&nbsp; %Bit% %%b<br />&nbsp; echo Processor arch&nbsp; &nbsp; &nbsp;:&nbsp; %arch%, CPU/Number of cores=%cores%&amp;echo(<br /><br />&nbsp; echo Date/Time format&nbsp; &nbsp;:&nbsp; %format% (%hours% hours^)&nbsp; &nbsp;%date%&nbsp; %time%<br />&nbsp; for /f &quot;tokens=3&quot; %%a in ('reg query &quot;%CodePage%&quot; /v &quot;OEMCP&quot;') do (<br />&nbsp; for /f &quot;tokens=3&quot; %%b in ('reg query &quot;%CodePage%&quot; /v &quot;ACP&quot;')&nbsp; &nbsp;do (<br />&nbsp; echo Extensions&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;:&nbsp; system:%es%&nbsp; user:%eu%<br />&nbsp; echo Delayed expansion&nbsp; :&nbsp; system:%ds%&nbsp; user:%du%<br />&nbsp; echo Locale name&nbsp; &nbsp; &nbsp; &nbsp; :&nbsp; %LocaleName%&nbsp; &nbsp; &nbsp; Code Pages:OEM %%a&nbsp; &nbsp; &nbsp;ANSI %%b))<br />&nbsp; echo DIR&nbsp; format&nbsp; &nbsp; &nbsp; &nbsp; :&nbsp; %DirFormat%<br />&nbsp; echo Permissions&nbsp; &nbsp; &nbsp; &nbsp; :&nbsp; Elevated Admin=%Admin%, Admin access=%A-access%, User access=%user%&amp;echo(<br /><br />&nbsp; rem report if path elements are missing<br />&nbsp; for %%a in (&quot;%p-1%&quot; &quot;%p-2%&quot; &quot;%p-3%&quot;) do (<br />&nbsp; &nbsp;if /i not &quot;%%~xa&quot;==&quot;.yes&quot; echo.%pad%Missing from the PATH statement: %%~a<br />&nbsp; &nbsp;)<br />&nbsp; echo &#91;/code^&#93;<br />)<br />clip &gt;nul 2&gt;&amp;1 &amp;&amp; clip &lt; &quot;%temp%\info.txt&quot;<br />:: load the information into Notepad where it can also be copied to the clipboard<br />start &quot;&quot; notepad.exe &quot;%temp%\info.txt&quot; &amp; ping -n 2 localhost&gt;nul &amp; del &quot;%temp%\info.txt&quot;<br /></code></pre></div></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p48440" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile48440">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistd9a7.html?mode=viewprofile&amp;u=8270" class="username">douglas.swehla</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchb9f9.html?author_id=8270&amp;sr=posts">75</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 01 Jun 2016 09:25</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content48440">

						<h3 ><a href="#p48440">Re: Creating a script to gather PC information - to assist those asking for help</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinge815.html?mode=quote&amp;f=3&amp;p=48440" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic6e39.html?p=48440#p48440" onclick="prompt('Message #17',this.href); return false;">#17</a></span> 
									<a class="unread" href="viewtopic6e39.html?p=48440#p48440" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistd9a7.html?mode=viewprofile&amp;u=8270" class="username">douglas.swehla</a></strong> &raquo; </span>13 Aug 2016 13:33
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>foxidrive wrote:</cite>I've been out herding the kangaroos and only just got back after one escaped... <br /></div></blockquote><br />Is this a metaphor for being busy, or have you actually been chasing down marsupials?<br /><br /><blockquote><div><cite>foxidrive wrote:</cite>but I do like the idea of reporting details when<br /><br />1) Certain commands are missing or if they have the wrong extension (say a .bat extension) <br />2) and also report if certain essential items on the PATH statement are missing.<br /><br />I've implemented 2) below and added a check for permissions  (Hmmm, it may have a bug in user mode)<br /></div></blockquote><br /><br />I see that you're testing specifically for system32 in the PATH check. Do you want to look for SysWOW64 as well? My system has both System32 and SysWOW64 in %windir%, and a lot of commands are duplicated between them. It's not clear to me why that is (32- and 64-bit versions?), or what the impact would be if either of them were missing from %PATH%. <br /><br />Here's a snippet from <a href="http://stackoverflow.com/a/10052222" class="postlink">a StackOverflow answer</a> dealing with admin elevation, that takes SysWOW64 into consideration. It uses %SystemRoot% instead of %windir%, which are the same on my system. Not sure if there's a reason for that, or just the author's habit.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>REM&nbsp; --&gt; Check for permissions<br />&nbsp; &nbsp; IF &quot;%PROCESSOR_ARCHITECTURE%&quot; EQU &quot;amd64&quot; (<br />&gt;nul 2&gt;&amp;1 &quot;%SYSTEMROOT%\SysWOW64\cacls.exe&quot; &quot;%SYSTEMROOT%\SysWOW64\config\system&quot;<br />) ELSE (<br />&gt;nul 2&gt;&amp;1 &quot;%SYSTEMROOT%\system32\cacls.exe&quot; &quot;%SYSTEMROOT%\system32\config\system&quot;<br />)<br /><br />REM --&gt; If error flag set, we do not have admin.<br /></code></pre></div><br /><br />The script above goes on to do an admin check via UAC, using VBS. It's pretty short, and might solve the language-dependency issue that aGerman was running into.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p48443" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile48443">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search661c.html?author_id=1265&amp;sr=posts">3386</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 22 Jan 2010 18:01</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content48443">

						<h3 ><a href="#p48443">Re: Creating a script to gather PC information - to assist those asking for help</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting1bac.html?mode=quote&amp;f=3&amp;p=48443" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicffb2.html?p=48443#p48443" onclick="prompt('Message #18',this.href); return false;">#18</a></span> 
									<a class="unread" href="viewtopicffb2.html?p=48443#p48443" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a></strong> &raquo; </span>13 Aug 2016 15:22
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>douglas.swehla wrote:</cite>The script above goes on to do an admin check via UAC, using VBS. It's pretty short, and might solve the language-dependency issue that aGerman was running into.</div></blockquote><br />I already know that technique. But as I said - I don't want to run the script elevated.<br />Acting on your former suggestion to use WMIC:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off &amp;setlocal<br /><br />set &quot;localadmin=&quot;<br />wmic path Win32_Group WHERE &quot;LocalAccount='TRUE' AND SID='S-1-5-32-544'&quot; assoc /assocclass:Win32_GroupUser|&gt;nul findstr /c:Name^=\&quot;%username%\&quot; &amp;&amp; set &quot;localadmin=1&quot;<br /><br />if defined localadmin (echo Can obtain administrative elevation.) else echo Doesn't belong to the local administrators.<br />pause</code></pre></div><br />But WMIC isn't that downward compatible since XP is still a walking dead.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p48444" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile48444">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf147.html?author_id=3221&amp;sr=posts">6033</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Feb 2012 02:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content48444">

						<h3 ><a href="#p48444">Re: Creating a script to gather PC information - to assist those asking for help</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting68c5.html?mode=quote&amp;f=3&amp;p=48444" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopica234.html?p=48444#p48444" onclick="prompt('Message #19',this.href); return false;">#19</a></span> 
									<a class="unread" href="viewtopica234.html?p=48444#p48444" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a></strong> &raquo; </span>13 Aug 2016 16:43
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>douglas.swehla wrote:</cite><blockquote><div><cite>foxidrive wrote:</cite>I've been out herding the kangaroos and only just got back after one escaped... <br /></div></blockquote><br />Is this a metaphor for being busy, or have you actually been chasing down marsupials?<br /></div></blockquote><br />There are no marsupials anywhere near here, it's just been life getting in the way.<br /><br /><blockquote class="uncited"><div><blockquote><div><cite>foxidrive wrote:</cite>I've implemented 2) below and added a check for permissions  (Hmmm, it may have a bug in user mode)<br /></div></blockquote><br /><br />I see that you're testing specifically for system32 in the PATH check. Do you want to look for SysWOW64 as well? My system has both System32 and SysWOW64 in %windir%, and a lot of commands are duplicated between them. It's not clear to me why that is (32- and 64-bit versions?), or what the impact would be if either of them were missing from %PATH%. <br /><br />Here's a snippet from <a href="http://stackoverflow.com/a/10052222" class="postlink">a StackOverflow answer</a> dealing with admin elevation, that takes SysWOW64 into consideration. It uses %SystemRoot% instead of %windir%, which are the same on my system. Not sure if there's a reason for that, or just the author's habit.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>REM&nbsp; --&gt; Check for permissions<br />&nbsp; &nbsp; IF &quot;%PROCESSOR_ARCHITECTURE%&quot; EQU &quot;amd64&quot; (<br />&gt;nul 2&gt;&amp;1 &quot;%SYSTEMROOT%\SysWOW64\cacls.exe&quot; &quot;%SYSTEMROOT%\SysWOW64\config\system&quot;<br />) ELSE (<br />&gt;nul 2&gt;&amp;1 &quot;%SYSTEMROOT%\system32\cacls.exe&quot; &quot;%SYSTEMROOT%\system32\config\system&quot;<br />)<br /><br />REM --&gt; If error flag set, we do not have admin.<br /></code></pre></div><br /><br />The script above goes on to do an admin check via UAC, using VBS. It's pretty short, and might solve the language-dependency issue that aGerman was running into.</div></blockquote><br /><br />You're absolutely right.  I don't use 64 bit windows at this point so it wasn't on my radar.  <br />I also use an admin account with UAC disabled as a matter of course so don't see anything breaking because of that.  Oops.<br /><br />Thanks for your comments Douglas.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p48447" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile48447">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistd9a7.html?mode=viewprofile&amp;u=8270" class="username">douglas.swehla</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchb9f9.html?author_id=8270&amp;sr=posts">75</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 01 Jun 2016 09:25</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content48447">

						<h3 ><a href="#p48447">Re: Creating a script to gather PC information - to assist those asking for help</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting89c0.html?mode=quote&amp;f=3&amp;p=48447" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic0537.html?p=48447#p48447" onclick="prompt('Message #20',this.href); return false;">#20</a></span> 
									<a class="unread" href="viewtopic0537.html?p=48447#p48447" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistd9a7.html?mode=viewprofile&amp;u=8270" class="username">douglas.swehla</a></strong> &raquo; </span>13 Aug 2016 23:18
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>aGerman wrote:</cite><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>set &quot;localadmin=&quot;<br />wmic path Win32_Group WHERE &quot;LocalAccount='TRUE' AND SID='S-1-5-32-544'&quot; assoc /assocclass:Win32_GroupUser|&gt;nul findstr /c:Name^=\&quot;%username%\&quot; &amp;&amp; set &quot;localadmin=1&quot;<br /><br />if defined localadmin (echo Can obtain administrative elevation.) else echo Doesn't belong to the local administrators.<br />pause</code></pre></div><br /></div></blockquote><br />Nice! How do you figure out what SID to use?<br /><br /><blockquote><div><cite>aGerman wrote:</cite>But WMIC isn't that downward compatible since XP is still a walking dead.<br /></div></blockquote><br />I didn't realize WMIC was that new. What about JScript or VBScript? If we can't find a universal solution, we can resort to version-specific ones. Do you know of anything that would work for XP, even if it doesn't work on later versions?<br /><br /><blockquote><div><cite>aGerman wrote:</cite>I don't want to run the script elevated.<br /></div></blockquote><br />Why not? I'm assuming you want to abide the general principal of &quot;Spend the least possible time as admin so you can't break anything.&quot; If that's the case, then of course it makes sense to not run the whole script as admin. But what about just one command? Is there a security concern or some other danger I'm not seeing?<br /><br />Like a lot of people, I use a non-admin account for most things, and enter the admin credentials of another, different account as needed. So, I see the elevation question as two parts:<br />1. Does the currently running account have admin privileges, even if they're not in use right now?<br />2. Does this user have access to an admin account, even if they're not using it right now?<br /><br />As far as I know, Windows thinks that my ordinary and admin accounts are two completely separate entities, and has no way of mapping a relationship between them, which is as it should be. When I run the code above, it correctly reports that user &quot;Douglas&quot; is not part of the local admin group. When I want to run as admin, I authenticate as user &quot;Admin&quot;, and that's what's stored in %username% for that session. <br /><br />The only way I can think of for a script to learn whether a user has credentials for a different account is to prompt the user to enter them. If there's a way to do that without actually going on to do something as that account, then sure, let's do that. If not, though, would it be so bad to just open a new shell and immediately exit? That's not a rhetorical question; I'm really asking, and if the answer is &quot;Yes, it would be so bad&quot;, I'm prepared to hear it. <br /><br />If we're not willing to enter admin mode at all, then we'd need to tell questioners to be sure to use an admin account when running the script, if they have one, or just ask them to tell us, if it's relevant. Neither of those are terribly difficult, but getting people to follow instructions and answer questions is, apparently, difficult enough that we're resorting to automation to make it happen.<br /><br />All that said, I'm really not super invested in getting question 2 answered in the main script. I think that most solutions provided here don't require admin access, and for the ones that do, it can be addressed then. I just want to be sure we understand the problem the same way. If you and Foxy think it's best to never enter admin mode, it's cool with me.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p48451" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile48451">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search661c.html?author_id=1265&amp;sr=posts">3386</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 22 Jan 2010 18:01</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content48451">

						<h3 ><a href="#p48451">Re: Creating a script to gather PC information - to assist those asking for help</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingd41c.html?mode=quote&amp;f=3&amp;p=48451" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic3ed0.html?p=48451#p48451" onclick="prompt('Message #21',this.href); return false;">#21</a></span> 
									<a class="unread" href="viewtopic3ed0.html?p=48451#p48451" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a></strong> &raquo; </span>14 Aug 2016 05:17
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>douglas.swehla wrote:</cite>How do you figure out what SID to use?</div></blockquote><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>wmic path Win32_Group WHERE &quot;LocalAccount='TRUE'&quot; get /value</code></pre></div><br /><a href="https://support.microsoft.com/en-us/kb/243330" class="postlink">https://support.microsoft.com/en-us/kb/243330</a><br /><br /><br /><blockquote><div><cite>douglas.swehla wrote:</cite>I didn't realize WMIC was that new. What about JScript or VBScript?</div></blockquote><br />Yes the WMI can easily be scripted with these languages.<br /><br /><br /><blockquote><div><cite>douglas.swehla wrote:</cite><blockquote><div><cite>aGerman wrote:</cite>I don't want to run the script elevated.<br /></div></blockquote><br />Why not?</div></blockquote><br />Because the purpose of the script is to collect informations of the opportunities that questioners have.<br /><br /><br /><blockquote><div><cite>douglas.swehla wrote:</cite>Like a lot of people, I use a non-admin account for most things, and enter the admin credentials of another, different account as needed.</div></blockquote><br />That would be for sure our first question if a certain command in the askers script would need elevated rights and we saw that his current account can't obtain them.<br /><br /><br />Regards<br />aGerman</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p48453" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile48453">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content48453">

						<h3 ><a href="#p48453">Re: Creating a script to gather PC information - to assist those asking for help</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting21c0.html?mode=quote&amp;f=3&amp;p=48453" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic630a.html?p=48453#p48453" onclick="prompt('Message #22',this.href); return false;">#22</a></span> 
									<a class="unread" href="viewtopic630a.html?p=48453#p48453" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>14 Aug 2016 07:40
			</p>
			
			
			
			<div class="content">Cool script, but it may run into problems in some environments.<br /><br />The network administrators have locked down all the computers at my job, and we cannot access the registry <img class="smilies" src="images/smilies/icon_exclaim.gif" alt=":!:" title="Exclamation" />  <img class="smilies" src="images/smilies/icon_cry.gif" alt=":cry:" title="Crying or Very sad" /> <br />So the script would pretty much be useless at my workplace.<br /><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p48454" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile48454">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search661c.html?author_id=1265&amp;sr=posts">3386</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 22 Jan 2010 18:01</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content48454">

						<h3 ><a href="#p48454">Re: Creating a script to gather PC information - to assist those asking for help</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting98fd.html?mode=quote&amp;f=3&amp;p=48454" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic76e5.html?p=48454#p48454" onclick="prompt('Message #23',this.href); return false;">#23</a></span> 
									<a class="unread" href="viewtopic76e5.html?p=48454#p48454" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a></strong> &raquo; </span>14 Aug 2016 08:29
			</p>
			
			
			
			<div class="content">Oh that's strange. Our administrators locked quite alot via GPO. But we have full access to HKCU and we can at least query informations from HKLM. I'm wondering why they completely locked you out. I was pretty sure some applications wouldn't even work without querying the registry <img class="smilies" src="images/smilies/icon_confused.gif" alt=":?" title="Confused" /> <br /><br />Regards<br />aGerman</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p48455" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile48455">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content48455">

						<h3 ><a href="#p48455">Re: Creating a script to gather PC information - to assist those asking for help</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingc735.html?mode=quote&amp;f=3&amp;p=48455" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicd45b.html?p=48455#p48455" onclick="prompt('Message #24',this.href); return false;">#24</a></span> 
									<a class="unread" href="viewtopicd45b.html?p=48455#p48455" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>14 Aug 2016 09:00
			</p>
			
			
			
			<div class="content">I'm working from memory at this point - all my past attempts to access the registry had failed. I'll verify on Monday.<br /><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p48468" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile48468">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content48468">

						<h3 ><a href="#p48468">Re: Creating a script to gather PC information - to assist those asking for help</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting5979.html?mode=quote&amp;f=3&amp;p=48468" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic6b09-2.html?p=48468#p48468" onclick="prompt('Message #25',this.href); return false;">#25</a></span> 
									<a class="unread" href="viewtopic6b09-2.html?p=48468#p48468" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>15 Aug 2016 06:24
			</p>
			
			
			
			<div class="content">Confirmed - I cannot run the script at my workplace.<br /><br />I get an error ( <strong class="text-strong">ERROR: Registry editing has been disabled by your administrator.</strong> ) when I attempt to run a command like <strong class="text-strong">reg query &quot;HKLM\%CMDproc%&quot; /v &quot;EnableExtensions&quot;</strong><br /><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p48469" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile48469">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search661c.html?author_id=1265&amp;sr=posts">3386</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 22 Jan 2010 18:01</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content48469">

						<h3 ><a href="#p48469">Re: Creating a script to gather PC information - to assist those asking for help</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting89e1.html?mode=quote&amp;f=3&amp;p=48469" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic7d5a.html?p=48469#p48469" onclick="prompt('Message #26',this.href); return false;">#26</a></span> 
									<a class="unread" href="viewtopic7d5a.html?p=48469#p48469" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a></strong> &raquo; </span>15 Aug 2016 07:21
			</p>
			
			
			
			<div class="content">Haha, you don't even &quot;edit&quot; anything with a query. Nevermind. Do you get the same error if you try to query HKCU?<br /><br />Regards<br />aGerman</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p48470" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile48470">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content48470">

						<h3 ><a href="#p48470">Re: Creating a script to gather PC information - to assist those asking for help</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting8e9a-2.html?mode=quote&amp;f=3&amp;p=48470" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopica9da.html?p=48470#p48470" onclick="prompt('Message #27',this.href); return false;">#27</a></span> 
									<a class="unread" href="viewtopica9da.html?p=48470#p48470" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>15 Aug 2016 07:42
			</p>
			
			
			
			<div class="content">Yes, I get the same error with HKCU<br /><br />I'm not able to use REG or REGEDIT at all.<br /><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p48471" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile48471">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search661c.html?author_id=1265&amp;sr=posts">3386</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 22 Jan 2010 18:01</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content48471">

						<h3 ><a href="#p48471">Re: Creating a script to gather PC information - to assist those asking for help</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting183b.html?mode=quote&amp;f=3&amp;p=48471" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicfecb.html?p=48471#p48471" onclick="prompt('Message #28',this.href); return false;">#28</a></span> 
									<a class="unread" href="viewtopicfecb.html?p=48471#p48471" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a></strong> &raquo; </span>15 Aug 2016 07:53
			</p>
			
			
			
			<div class="content">That makes things more complicated <img class="smilies" src="images/smilies/icon_confused.gif" alt=":?" title="Confused" /> Any suggestions much appreciated.<br /><br />Another thing we have to change is the initial <span style="color: #0000FF">setlocal EnableExtensions</span>. If extensions are disabled SETLOCAL doesn't even accept arguments. I think we should rather restart the script using CMD /E:ON /V:OFF /C.<br /><br />Regards<br />aGerman</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p48473" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile48473">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistfcd5.html?mode=viewprofile&amp;u=4915" style="color: #00AA00;" class="username-coloured">penpen</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1bf7.html?author_id=4915&amp;sr=posts">1612</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 Jun 2013 06:15</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content48473">

						<h3 ><a href="#p48473">Re: Creating a script to gather PC information - to assist those asking for help</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinga00b.html?mode=quote&amp;f=3&amp;p=48473" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicf733.html?p=48473#p48473" onclick="prompt('Message #29',this.href); return false;">#29</a></span> 
									<a class="unread" href="viewtopicf733.html?p=48473#p48473" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistfcd5.html?mode=viewprofile&amp;u=4915" style="color: #00AA00;" class="username-coloured">penpen</a></strong> &raquo; </span>15 Aug 2016 11:41
			</p>
			
			
			
			<div class="content">Depends on how the admins have locked your registry access;<br />maybe one of these two methods are working (if it is allowed to compile this c# source):<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>// // &gt;nul 2&gt; nul &amp; @goto :main<br />/*<br />&nbsp;* Author: Ulf Schneider aka penpen<br />&nbsp;* Free for non profit use only.<br />&nbsp;* For profit use contact me at www.dostips.com via private message (PM).<br />&nbsp;* readReg.cs.bat<br />&nbsp;*/<br /><br />/*<br />:main<br />&nbsp; &nbsp;@echo off<br />&nbsp; &nbsp;setlocal<br />&nbsp; &nbsp;cls<br />&nbsp; &nbsp;set &quot;csc=&quot;<br /><br />&nbsp; &nbsp;pushd &quot;%SystemRoot%\Microsoft.NET\Framework&quot;<br />&nbsp; &nbsp;for /f &quot;tokens=* delims=&quot; %%i in ('dir /b /o:n &quot;v*&quot;') do (<br />&nbsp; &nbsp; &nbsp; dir /a-d /b &quot;%%~fi\csc.exe&quot; &gt;nul 2&gt;&amp;1 &amp;&amp; set &quot;csc=&quot;%%~fi\csc.exe&quot;&quot;<br />&nbsp; &nbsp;)<br />&nbsp; &nbsp;popd<br /><br />&nbsp; &nbsp;if defined csc (<br />&nbsp; &nbsp; &nbsp; echo most recent C#.NET compiler located in:<br />&nbsp; &nbsp; &nbsp; echo %csc%.<br />&nbsp; &nbsp;) else (<br />&nbsp; &nbsp; &nbsp; echo C#.NET compiler not found.<br />&nbsp; &nbsp; &nbsp; goto :eof<br />&nbsp; &nbsp;)<br /><br />&nbsp; &nbsp;for %%a in (&quot;%~dpn0&quot;) do for %%b in (&quot;%%~dpna&quot;) do (<br />rem&nbsp; &nbsp; &nbsp; %csc% /?<br />&nbsp; &nbsp; &nbsp; %csc% /nologo /optimize /warnaserror /nowin32manifest /unsafe /debug- /target:exe /out:&quot;%%~b.exe&quot; &quot;%~f0&quot;<br />&nbsp; &nbsp;)<br />&nbsp; &nbsp;exit /B<br />*/<br /><br /><br />using System;<br />using System.IO;<br />using System.Reflection;<br />using System.Security;<br />using System.Security.AccessControl;<br />using Microsoft.Win32;<br /><br /><br />public class ReadRegistryKey {<br />&nbsp; &nbsp;public static RegistryKey getRoot(string keyName) {<br />&nbsp; &nbsp;&nbsp; &nbsp;if (keyName == null) return null;<br />&nbsp; &nbsp;&nbsp; &nbsp;else switch(replaceRootAbbreviation(keyName).Split(new char&#91;&#93; {'\\'})&#91;0&#93;) {<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;case &quot;HKEY_CURRENT_USER&quot; :&nbsp; &nbsp;return Registry.CurrentUser;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;case &quot;HKEY_LOCAL_MACHINE&quot;:&nbsp; &nbsp;return Registry.LocalMachine;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;case &quot;HKEY_CLASSES_ROOT&quot;:&nbsp; &nbsp;return Registry.ClassesRoot;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;case &quot;HKEY_USERS&quot;:&nbsp; &nbsp;&nbsp; &nbsp;return Registry.Users;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;case &quot;HKEY_PERFORMANCE_DATA&quot;:&nbsp; &nbsp;return Registry.PerformanceData;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;case &quot;HKEY_CURRENT_CONFIG&quot;:&nbsp; &nbsp;return Registry.CurrentConfig;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;case &quot;HKEY_DYN_DATA&quot;:&nbsp; &nbsp;/*<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;// Win 95/98/Me only<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;return Registry.DynData;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;// Win XP++<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;*/<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;return Registry.PerformanceData;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;default:&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;return null;<br />&nbsp; &nbsp;&nbsp; &nbsp;}<br />&nbsp; &nbsp;}<br /><br />&nbsp; &nbsp;public static string replaceRootAbbreviation(string keyName) {<br />&nbsp; &nbsp;&nbsp; &nbsp;if (keyName == null) {<br />&nbsp; &nbsp;&nbsp; &nbsp;} else if (keyName.StartsWith(&quot;HKCU&quot;)) { keyName = &quot;HKEY_CURRENT_USER&quot;&nbsp; &nbsp; &nbsp;+ keyName.Substring(4);<br />&nbsp; &nbsp;&nbsp; &nbsp;} else if (keyName.StartsWith(&quot;HKLM&quot;)) { keyName = &quot;HKEY_LOCAL_MACHINE&quot;&nbsp; &nbsp; + keyName.Substring(4);<br />&nbsp; &nbsp;&nbsp; &nbsp;} else if (keyName.StartsWith(&quot;HKCR&quot;)) { keyName = &quot;HKEY_CLASSES_ROOT&quot;&nbsp; &nbsp; &nbsp;+ keyName.Substring(4);<br />&nbsp; &nbsp;&nbsp; &nbsp;} else if (keyName.StartsWith(&quot;HKU&quot; )) { keyName = &quot;HKEY_USERS&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; + keyName.Substring(3);<br />&nbsp; &nbsp;&nbsp; &nbsp;} else if (keyName.StartsWith(&quot;HKPD&quot;)) { keyName = &quot;HKEY_PERFORMANCE_DATA&quot; + keyName.Substring(4);<br />&nbsp; &nbsp;&nbsp; &nbsp;} else if (keyName.StartsWith(&quot;HKCC&quot;)) { keyName = &quot;HKEY_CURRENT_CONFIG&quot;&nbsp; &nbsp;+ keyName.Substring(4);<br />&nbsp; &nbsp;&nbsp; &nbsp;} else if (keyName.StartsWith(&quot;HKDD&quot;)) { keyName = &quot;HKEY_DYN_DATA&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+ keyName.Substring(4);<br />&nbsp; &nbsp;&nbsp; &nbsp;}<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;return keyName;<br />&nbsp; &nbsp;}<br /><br />&nbsp; &nbsp;public static void ReadKey1(string keyName, string valueName) {<br />&nbsp; &nbsp;&nbsp; &nbsp;Console.WriteLine(&quot;Try reading \&quot;&quot; + valueName + &quot;\&quot; using Registry.GetValue: &quot;);<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;try {<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;Console.WriteLine(&quot;Success: &quot; + Registry.GetValue(replaceRootAbbreviation(keyName), valueName, &quot;Default: \&quot;&quot; + valueName + &quot;\&quot; does not exist.&quot;));<br />&nbsp; &nbsp;&nbsp; &nbsp;} catch (SecurityException securityException) { Console.WriteLine(&quot;Failure: &quot; + securityException.Message);<br />&nbsp; &nbsp;&nbsp; &nbsp;} catch (&nbsp; &nbsp; &nbsp; IOException&nbsp; &nbsp; &nbsp; &nbsp;iOException) { Console.WriteLine(&quot;Failure: &quot; +&nbsp; &nbsp; &nbsp; &nbsp;iOException.Message);<br />&nbsp; &nbsp;&nbsp; &nbsp;} catch (ArgumentException argumentException) { Console.WriteLine(&quot;Failure: &quot; + argumentException.Message);<br />&nbsp; &nbsp;&nbsp; &nbsp;} catch (&nbsp; &nbsp; &nbsp; &nbsp; Exception&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;exception) { Console.WriteLine(&quot;Failure: &quot; +&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;exception.Message);<br />&nbsp; &nbsp;&nbsp; &nbsp;}<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;Console.WriteLine(&quot;&quot;);<br />&nbsp; &nbsp;}<br /><br /><br /><br />&nbsp; &nbsp;public static void ReadKey2(string keyName, string valueName) {<br />&nbsp; &nbsp;&nbsp; &nbsp;string &#91;&#93; keyNames = keyName.Split(new char&#91;&#93; {'\\'});<br />&nbsp; &nbsp;&nbsp; &nbsp;string subKeyName = keyName.Substring(keyNames&#91;0&#93;.Length);<br />&nbsp; &nbsp;&nbsp; &nbsp;RegistryKey root = getRoot(keyName);<br />&nbsp; &nbsp;&nbsp; &nbsp;RegistryKey &#91;&#93; subKeys = new RegistryKey&#91;keyNames.Length&#93;;<br />&nbsp; &nbsp;&nbsp; &nbsp;RegistryKey subKey = root;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;subKeys&#91;0&#93; = subKey;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;Console.WriteLine(&quot;Try reading \&quot;&quot; + valueName + &quot;\&quot; using RegistryKey.OpenSubKey and RegistryKey.GetValue: &quot;);<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;try {<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;for (int i = 1; i &lt; subKeys.Length; ++i) {<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;subKeys&#91;i&#93; = subKey.OpenSubKey(keyNames&#91;i&#93;);<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;subKey = subKeys&#91;i&#93;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;}<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;Console.WriteLine(&quot;Success: &quot; + subKey.GetValue(valueName, &quot;Default: \&quot;&quot; + valueName + &quot;\&quot; does not exist.&quot;));<br />&nbsp; &nbsp;&nbsp; &nbsp;} catch (SecurityException securityException) { Console.WriteLine(&quot;Failure: &quot; + securityException.Message);<br />&nbsp; &nbsp;&nbsp; &nbsp;} catch (&nbsp; &nbsp; &nbsp; IOException&nbsp; &nbsp; &nbsp; &nbsp;iOException) { Console.WriteLine(&quot;Failure: &quot; +&nbsp; &nbsp; &nbsp; &nbsp;iOException.Message);<br />&nbsp; &nbsp;&nbsp; &nbsp;} catch (ArgumentException argumentException) { Console.WriteLine(&quot;Failure: &quot; + argumentException.Message);<br />&nbsp; &nbsp;&nbsp; &nbsp;} catch (&nbsp; &nbsp; &nbsp; &nbsp; Exception&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;exception) { Console.WriteLine(&quot;Failure: &quot; +&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;exception.Message);<br />&nbsp; &nbsp;&nbsp; &nbsp;}<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;Console.WriteLine(&quot;&quot;);<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;for (int i = 1; i &lt; subKeys.Length; ++i) {<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if (subKeys&#91;i&#93; != null) subKeys&#91;i&#93;.Close();<br />&nbsp; &nbsp;&nbsp; &nbsp;}<br />&nbsp; &nbsp;}<br /><br /><br />&nbsp; &nbsp;public static unsafe void Main(string&#91;&#93; args) {<br />&nbsp; &nbsp;&nbsp; &nbsp;string &#91;&#93;&#91;&#93; regValues = new string&#91;&#93;&#91;&#93; {<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;new string&#91;&#93; { &quot;HKCU\\Control Panel\\International&quot;, &quot;iDate&quot; },<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;new string&#91;&#93; { &quot;HKCU\\Control Panel\\International&quot;, &quot;iTime&quot; },<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;new string&#91;&#93; { &quot;HKU\\.DEFAULT\\Control Panel\\International&quot;, &quot;iDate&quot; },<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;new string&#91;&#93; { &quot;HKU\\.DEFAULT\\Control Panel\\International&quot;, &quot;iTime&quot; },<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;new string&#91;&#93; { &quot;HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion&quot;, &quot;ProductName&quot; },<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;new string&#91;&#93; { &quot;HKLM\\SYSTEM\\CurrentControlSet\\Control\\Nls\\CodePage&quot;, &quot;OEMCP&quot; },<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;new string&#91;&#93; { &quot;HKLM\\SYSTEM\\CurrentControlSet\\Control\\Nls\\CodePage&quot;, &quot;ACP&quot; },<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;new string&#91;&#93; { &quot;HKLM\\Software\\Microsoft\\Command Processor&quot;, &quot;EnableExtensions&quot; },<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;new string&#91;&#93; { &quot;HKLM\\Software\\Microsoft\\Command Processor&quot;, &quot;DelayedExpansion&quot; },<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;new string&#91;&#93; { &quot;HKCU\\Software\\Microsoft\\Command Processor&quot;, &quot;EnableExtensions&quot; },<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;new string&#91;&#93; { &quot;HKCU\\Software\\Microsoft\\Command Processor&quot;, &quot;DelayedExpansion&quot; },<br />&nbsp; &nbsp;&nbsp; &nbsp;};<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;if (args.Length &lt; 2) {<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;for (int i = 0; i &lt; regValues.Length; ++i) {<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;ReadKey1(regValues&#91;i&#93;&#91;0&#93;, regValues&#91;i&#93;&#91;1&#93;);<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;ReadKey2(regValues&#91;i&#93;&#91;0&#93;, regValues&#91;i&#93;&#91;1&#93;);<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;}<br />&nbsp; &nbsp;&nbsp; &nbsp;} else {<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;ReadKey1(args&#91;0&#93;, args&#91;1&#93;);<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;ReadKey2(args&#91;0&#93;, args&#91;1&#93;);<br />&nbsp; &nbsp;&nbsp; &nbsp;}<br />&nbsp; &nbsp;}<br />}</code></pre></div><br /><br />penpen</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p48474" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile48474">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search661c.html?author_id=1265&amp;sr=posts">3386</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 22 Jan 2010 18:01</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content48474">

						<h3 ><a href="#p48474">Re: Creating a script to gather PC information - to assist those asking for help</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting3460-2.html?mode=quote&amp;f=3&amp;p=48474" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic3f65.html?p=48474#p48474" onclick="prompt('Message #30',this.href); return false;">#30</a></span> 
									<a class="unread" href="viewtopic3f65.html?p=48474#p48474" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a></strong> &raquo; </span>15 Aug 2016 12:36
			</p>
			
			
			
			<div class="content">I know from former posts that csc was removed from Dave's PC at work <img class="smilies" src="images/smilies/icon_sad.gif" alt=":(" title="Sad" /> <br /><br />I'll try to work around that problems.<br />Alternatives (after trying to query the registry keys):<br />- Clock hours could be left out because it should be visible at least at the output of DIR.<br />- Date order could be read from the date command (even if it would be language dependent).<br />- enabled extensions and delayed expansion could be checked using IF statements. E.g.:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />if &quot;%1&quot;==&quot;restart&quot; goto script<br /><br />cmd /c &quot;if /i &quot;a&quot;==&quot;b&quot; causes a syntax error if extensions are disabled&quot; 2&gt;nul<br />if errorlevel 1 (set ex_noreg=No) else (set ex_noreg=Yes)<br /><br />if &quot;!!&quot;==&quot;&quot; (set de_noreg=Yes) else (set de_noreg=No)<br /><br />cmd /e:on /v:off /c %0 restart<br /><br />pause<br />goto :eof<br /><br /><br />:script<br />cd /d &quot;%~dp0&quot;<br /><br />REM all the other code here<br />echo Extensions&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;:&nbsp; %ex_noreg%<br />echo Delayed expansion&nbsp; :&nbsp; %de_noreg%<br /><br /><br />REM very last line; if extensions are disabled the label :eof doesn't implicitely exist<br />:eof<br /></code></pre></div><br />- I wonder if we could determine the locale name out of MUI folders/files?<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>for /f %%i in ('dir /ad /b &quot;%SystemRoot%\System32\??-??&quot;^|findstr /x &quot;&#91;a-z&#93;&#91;a-z&#93;-&#91;a-z&#93;&#91;a-z&#93;&quot;') do (<br />&nbsp; if exist &quot;%SystemRoot%\System32\%%i\ulib.dll.mui&quot; echo %%i<br />)</code></pre></div><br />- OEMCP can be extracted from CHCP.<br />- ACP ??? No idea yet.<br /><br />Regards<br />aGerman</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
	

	<div class="action-bar bar-bottom">
	
			<a href="posting0b06.html?mode=reply&amp;f=3&amp;t=7347" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic00db.html?f=3&amp;t=7347&amp;start=15&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

			<form method="post" action="https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=7347&amp;start=15">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			158 posts
							<ul>
	<li class="dropdown-container dropdown-button-control dropdown-page-jump page-jump">
		<a class="button button-icon-only dropdown-trigger" href="#" title="Click to jump to page…" role="button"><i class="icon fa-level-down fa-rotate-270" aria-hidden="true"></i><span class="sr-only">Page <strong>2</strong> of <strong>11</strong></span></a>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
				<li>Jump to page:</li>
				<li class="page-jump-form">
					<input type="number" name="page-number" min="1" max="999999" title="Enter the page number you wish to go to" class="inputbox tiny" data-per-page="15" data-base-url=".&#x2F;viewtopic.php&#x3F;f&#x3D;3&amp;amp&#x3B;t&#x3D;7347" data-start-name="start" />
					<input class="button2" value="Go" type="button" />
				</li>
			</ul>
		</div>
	</li>
			<li class="arrow previous"><a class="button button-icon-only" href="viewtopic1343.html?f=3&amp;t=7347" rel="prev" role="button"><i class="icon fa-chevron-left fa-fw" aria-hidden="true"></i><span class="sr-only">Previous</span></a></li>
				<li><a class="button" href="viewtopic1343.html?f=3&amp;t=7347" role="button">1</a></li>
			<li class="active"><span>2</span></li>
				<li><a class="button" href="viewtopic7515.html?f=3&amp;t=7347&amp;start=30" role="button">3</a></li>
				<li><a class="button" href="viewtopic7c37.html?f=3&amp;t=7347&amp;start=45" role="button">4</a></li>
				<li><a class="button" href="viewtopiccda4-2.html?f=3&amp;t=7347&amp;start=60" role="button">5</a></li>
			<li class="ellipsis" role="separator"><span>…</span></li>
				<li><a class="button" href="viewtopic66e3.html?f=3&amp;t=7347&amp;start=150" role="button">11</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopic7515.html?f=3&amp;t=7347&amp;start=30" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="viewforum4d6b.html?f=3" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to “DOS Batch Forum”</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="viewforum31e6.html?f=4" class="jumpbox-cat-link"> <span> DosTips - Dos Batch</span></a></li>
																<li><a href="viewforum4d6b.html?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; DOS Batch Forum</span></a></li>
											</ul>
		</div>
	</div>

	</div>


			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
							<span class="crumb"><a href="../index.html" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>DosTips.com</span></a></span>									<span class="crumb"><a href="index.html" data-navbar-reference="index"><span>Board index</span></a></span>					</li>
		
				<li class="rightside">All times are <span title="UTC-6">UTC-06:00</span></li>
							<li class="rightside">
				<a href="ucp033a.html?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete all board cookies</span>
				</a>
			</li>
												<li class="rightside" data-last-responsive="true">
				<a href="memberlist4bfd.html?mode=team" role="menuitem">
					<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
				</a>
			</li>
									<li class="rightside" data-last-responsive="true">
				<a href="memberlist8733.html?mode=contactadmin" role="menuitem">
					<i class="icon fa-envelope fa-fw" aria-hidden="true"></i><span>Contact us</span>
				</a>
			</li>
			</ul>

	</div>
</div>

	<div class="copyright">
				<!-- WARNING NO DELETE -->Style developer by <a href="http://tricolor.x-tk.ru/">support forum tricolor</a>, <!-- END WARNING NO DELETE -->Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
									</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	<img src="cron5089.gif?cron_type=cron.task.text_reparser.post_text" width="1" height="1" alt="cron" /></div>

<script type="text/javascript" src="assets/javascript/jquery.mind772.js?assets_version=34"></script>
<script type="text/javascript" src="assets/javascript/cored772.js?assets_version=34"></script>



<script type="text/javascript" src="styles/prosilver/template/forum_fnd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/prosilver/template/ajaxd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/jquery-uid772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/collapsed772.js?assets_version=34"></script>



</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=7347&start=15 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 07:50:45 GMT -->
</html>
