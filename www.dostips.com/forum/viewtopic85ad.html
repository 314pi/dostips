<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?p=6212 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 08:56:57 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>string manipulation help - DosTips.com</title>


	<link rel="canonical" href="viewtopic7fb8.html?t=1592">

<!--
	phpBB style name: Allan Style - SUBSILVER
	Based on style:   prosilver (this is the default phpBB3 style)
	Based on style:   subsilver2 (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:  Allan ( http://x-tk.ru/ )
-->

<link href="assets/css/font-awesome.mind772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/stylesheetd772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/en/stylesheetd772.css?assets_version=34" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="./styles/AllanStyle-SUBSILVER/theme/tweaks.css?assets_version=34" rel="stylesheet">
<![endif]-->




<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','../../www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-280191-1', 'auto');
	ga('send', 'pageview');
</script>

</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">

<div id="header-subsilver">
	<a id="top" class="top-anchor" accesskey="t"></a>
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description" class="site-description">
				<a id="logo" class="logo" href="../index.html" title="DosTips.com"><span class="site_logo"></span></a>
				<h1>DosTips.com</h1>
				<p>A Forum all about DOS Batch</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

									<div id="search-box" class="search-box search-header" role="search">
				<form action="https://www.dostips.com/forum/search.php" method="get" id="search">
				<fieldset>
					<input name="keywords" id="keywords" type="search" maxlength="128" title="Search for keywords" class="inputbox search tiny" size="20" value="" placeholder="Search…" />
					<button class="button button-search" type="submit" title="Search">
						<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
					</button>
					<a href="search.html" class="button button-search-end" title="Advanced search">
						<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
					</a>
					
				</fieldset>
				</form>
			</div>
						
			</div>
					</div>
</div>


<div id="wrap" class="wrap">
	<div id="page-header">
				<div class="navbar-top" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
																									<li>
								<a href="search33a7.html?search_id=unanswered" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="search526f.html?search_id=active_topics" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-blue" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="search.html" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
											<li class="separator"></li>
																			<li>
								<a href="memberlist4bfd.html?mode=team" role="menuitem">
									<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
								</a>
							</li>
																<li class="separator"></li>

									</ul>
			</div>
		</li>

				<li data-skip-responsive="true">
			<a href="app.php/help/faq.html" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
						
			<li class="rightside"  data-skip-responsive="true">
			<a href="ucp26c3.html?mode=login" title="Login" accesskey="x" role="menuitem">
				<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Login</span>
			</a>
		</li>
					<li class="rightside" data-skip-responsive="true">
				<a href="ucp8319.html?mode=register" role="menuitem">
					<i class="icon fa-pencil-square-o  fa-fw" aria-hidden="true"></i><span>Register</span>
				</a>
			</li>
						</ul>

	</div>
</div>

<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
						<li class="breadcrumbs">
							<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="../index.html" itemprop="url" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span itemprop="title">DosTips.com</span></a></span>
										<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="index.html" itemprop="url" accesskey="h" data-navbar-reference="index"><span itemprop="title">Board index</span></a></span>

											<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="4"><a href="viewforum31e6.html?f=4" itemprop="url"><span itemprop="title">DosTips - Dos Batch</span></a></span>
															<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="3"><a href="viewforum4d6b.html?f=3" itemprop="url"><span itemprop="title">DOS Batch Forum</span></a></span>
												</li>
		
					<li class="rightside responsive-search">
				<a href="search.html" title="View the advanced search options" role="menuitem">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</a>
			</li>
			</ul>

	</div>
</div>

<div class="navbar-top-link">
	<div class="inner">
		<ul>
			<li class="navbar-top-link-left"><a href="search33a7.html?search_id=unanswered">Unanswered topics</a></li>
			<li class="navbar-top-link-left"><a href="search526f.html?search_id=active_topics">Active topics</a></li>

											</ul>
	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
		
<h2 class="topic-title"><a href="viewtopice264.html?f=3&amp;t=1592">string manipulation help</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">Discussion forum for all Windows batch related topics.<br /></div>
<p>
	<strong>Moderator:</strong> <a href="memberlista6a8.html?mode=viewprofile&amp;u=5" class="username">DosItHelp</a>
</p>


<div class="action-bar bar-top">
	
			<a href="posting7f87.html?mode=reply&amp;f=3&amp;t=1592" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic6b77.html?f=3&amp;t=1592&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="https://www.dostips.com/forum/search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topic…" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="search.html" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="1592" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			31 posts
							<ul>
		<li class="active"><span>1</span></li>
				<li><a class="button" href="viewtopic43ec.html?f=3&amp;t=1592&amp;start=15" role="button">2</a></li>
				<li><a class="button" href="viewtopic5528.html?f=3&amp;t=1592&amp;start=30" role="button">3</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopic43ec.html?f=3&amp;t=1592&amp;start=15" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
		</div>




<div id="subsilver-nav-topic">
	<div class="inner"><div class="post has-profile">
		<div class="leftsided postbody subsilver-topic-title">Message</div>
		<div class="leftsided postprofile subsilver-topic-author">Author</div>
	</div></div>
</div>

			<div id="p6212" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile6212">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist0e41.html?mode=viewprofile&amp;u=1966" class="username">ice_531</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searche4a3.html?author_id=1966&amp;sr=posts">18</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 21 Jan 2011 09:59</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content6212">

						<h3 class="first"><a href="#p6212">string manipulation help</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingaedb.html?mode=quote&amp;f=3&amp;p=6212" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic85ad.html?p=6212#p6212" onclick="prompt('Message #1',this.href); return false;">#1</a></span> 
									<a class="unread" href="viewtopic85ad.html?p=6212#p6212" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist0e41.html?mode=viewprofile&amp;u=1966" class="username">ice_531</a></strong> &raquo; </span>21 Jan 2011 10:10
			</p>
			
			
			
			<div class="content">Hey all.<br /><br />I am currently trying to get a batch file to work correctly, and having mild success.  I'm still waiting for approval at work to have a VS ide installed on my work computer, but until then I need to go ahead and work on this batch file which may suit my needs, and even just incorporate it into my actual program when the time comes.<br /><br />So heres what I'm trying to do. I want to make a batch file that will search through the current folder, and all subfolders for a specific word or phrase in all txt files that are found. The user chooses the search string, and then I need a way to be able to return the path to that txt file that contained the search string.  This is what I have so far.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />:SEARCH<br />set /p choice=Enter the search word or phrase to find the QF:<br /><br />FINDSTR /s /i /L /c:&quot;%choice%&quot; *.txt &gt; temp.txt<br /><br />set /p exit= Do you want to try to search again: 1 for yes, 2 for no.<br />IF %exit%==1 GOTO SEARCH<br />IF %exit%==2 exit</code></pre></div><br /><br />The only problem with this is that it returns the path AND the search phrase that was found in the text file. if multiple txt files were found, it puts them each on separate lines, which is great. However I only really need the path. (so that later on i can give the user a choice to launch one of the text files that were found.)<br /><br />Here is an example of the temp.txt output. This is returned by searching for the word &quot;loyalty&quot; <br /><br />QF Folder Structure\Version 8.02\Service Packs\QF17.txt:Loyalty Interface Issues<br />QF Folder Structure\Version 8.04\Service Packs\QF3.txt:Loyalty Adjustment Issue<br /><br />So, all I really want to do, is get rid of the &quot; : &quot; and anything to the right of it. Just so I have the paths  to the text files, 1 path per line. I've had issues trying to use for /f and I guess I don't understand the tokens and delims parameters. <br /><br />Any help would be appreciated!<br />Thanks.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6215" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile6215">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist8f68.html?mode=viewprofile&amp;u=989" class="username">!k</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchc265.html?author_id=989&amp;sr=posts">378</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 17 Oct 2009 08:30</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Russia</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content6215">

						<h3 ><a href="#p6215">Re: string manipulation help</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting548c.html?mode=quote&amp;f=3&amp;p=6215" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicd6c3.html?p=6215#p6215" onclick="prompt('Message #2',this.href); return false;">#2</a></span> 
									<a class="unread" href="viewtopicd6c3.html?p=6215#p6215" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist8f68.html?mode=viewprofile&amp;u=989" class="username">!k</a></strong> &raquo; </span>21 Jan 2011 11:33
			</p>
			
			
			
			<div class="content">Use findstr <span style="color: #FF0000">/M</span></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6216" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile6216">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist0e41.html?mode=viewprofile&amp;u=1966" class="username">ice_531</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searche4a3.html?author_id=1966&amp;sr=posts">18</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 21 Jan 2011 09:59</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content6216">

						<h3 ><a href="#p6216">Re: string manipulation help</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinga3d8.html?mode=quote&amp;f=3&amp;p=6216" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicf9c8.html?p=6216#p6216" onclick="prompt('Message #3',this.href); return false;">#3</a></span> 
									<a class="unread" href="viewtopicf9c8.html?p=6216#p6216" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist0e41.html?mode=viewprofile&amp;u=1966" class="username">ice_531</a></strong> &raquo; </span>21 Jan 2011 11:47
			</p>
			
			
			
			<div class="content">Doh!<br /><br />I thought I had tried the m switch already, and had problems. Thanks, it worked perfect <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6217" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile6217">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist0e41.html?mode=viewprofile&amp;u=1966" class="username">ice_531</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searche4a3.html?author_id=1966&amp;sr=posts">18</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 21 Jan 2011 09:59</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content6217">

						<h3 ><a href="#p6217">Re: string manipulation help</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting1c0f.html?mode=quote&amp;f=3&amp;p=6217" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic72dd.html?p=6217#p6217" onclick="prompt('Message #4',this.href); return false;">#4</a></span> 
									<a class="unread" href="viewtopic72dd.html?p=6217#p6217" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist0e41.html?mode=viewprofile&amp;u=1966" class="username">ice_531</a></strong> &raquo; </span>21 Jan 2011 11:51
			</p>
			
			
			
			<div class="content">Since that works now, what would be the best function to use to open up the path thats in the temp.txt<br /><br />and if there were 4 paths in the temp file. 1 path per line.<br /><br />i would assume i'd need a for loop to go line by line and shell notepad linefromtempfile(i) <br /><br />i know how i would do this in php, or vb even. not so sure in dos though</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6218" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile6218">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberliste9f9.html?mode=viewprofile&amp;u=1855" class="username">ChickenSoup</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search6656.html?author_id=1855&amp;sr=posts">79</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 13 Dec 2010 10:32</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content6218">

						<h3 ><a href="#p6218">Re: string manipulation help</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting2ba5.html?mode=quote&amp;f=3&amp;p=6218" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicf307-2.html?p=6218#p6218" onclick="prompt('Message #5',this.href); return false;">#5</a></span> 
									<a class="unread" href="viewtopicf307-2.html?p=6218#p6218" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberliste9f9.html?mode=viewprofile&amp;u=1855" class="username">ChickenSoup</a></strong> &raquo; </span>21 Jan 2011 12:53
			</p>
			
			
			
			<div class="content">You wouldn't even need to send it to the temp.txt file.  Just use the following:<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>for /f %%a &quot;tokens=*&quot; in ('FINDSTR /s /i /L /c:&quot;%choice%&quot; *.txt') do notepad.exe %%a</code></pre></div></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6219" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile6219">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist0e41.html?mode=viewprofile&amp;u=1966" class="username">ice_531</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searche4a3.html?author_id=1966&amp;sr=posts">18</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 21 Jan 2011 09:59</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content6219">

						<h3 ><a href="#p6219">Re: string manipulation help</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting91bd.html?mode=quote&amp;f=3&amp;p=6219" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicfc27.html?p=6219#p6219" onclick="prompt('Message #6',this.href); return false;">#6</a></span> 
									<a class="unread" href="viewtopicfc27.html?p=6219#p6219" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist0e41.html?mode=viewprofile&amp;u=1966" class="username">ice_531</a></strong> &raquo; </span>21 Jan 2011 13:04
			</p>
			
			
			
			<div class="content">Well, the reason behind the temp.txt is that im going to end up giving the user a choice whether they want to open 1 of the text files that was found, or 1 at a time. If 3 are found, I don't want all 3 to open, unless they do it 1 at a time. (this will be incorporated later using a listbox in a vb or c++ most likely)<br /><br />Thanks for the example of &quot;for /f&quot; though! <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6222" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile6222">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist0e41.html?mode=viewprofile&amp;u=1966" class="username">ice_531</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searche4a3.html?author_id=1966&amp;sr=posts">18</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 21 Jan 2011 09:59</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content6222">

						<h3 ><a href="#p6222">Re: string manipulation help</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting9e05.html?mode=quote&amp;f=3&amp;p=6222" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic97e9.html?p=6222#p6222" onclick="prompt('Message #7',this.href); return false;">#7</a></span> 
									<a class="unread" href="viewtopic97e9.html?p=6222#p6222" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist0e41.html?mode=viewprofile&amp;u=1966" class="username">ice_531</a></strong> &raquo; </span>21 Jan 2011 18:37
			</p>
			
			
			
			<div class="content">Another question here regarding the same code. Here's what I have so far. This isn't going to be my final result, but it works so far the way i want it to(on my pc at least)<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />:SEARCH<br />set /p choice=Enter the search word or phrase to find the QF:<br /><br /><br />FINDSTR /s /i /L /M /c:&quot;%choice%&quot; *.txt &gt; temp.txt<br /><br />setLocal EnableDelayedExpansion<br />for /f &quot;tokens=* delims= &quot; %%a in (temp.txt) do (<br />set /a n+=1<br />set v!n!=%%a<br />echo %%a<br />notepad.exe %%a<br />)<br /><br />set /p exit= Do you want to try to search again: 1 for yes, 2 for no.<br />IF %exit%==1 GOTO SEARCH<br />IF %exit%==2 exit</code></pre></div><br /><br />Heres my question though. my for loop does the job of getting each line in the temp file into a separate variable: v1, v2, v3, etc. Later on I will need to give the user a choice to launch each of these, or all of them into notepad. Something I've run into though regarding my findstr line is this. <br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>FINDSTR /s /i /L /M /c:&quot;%choice%&quot; *.txt &gt; temp.txt</code></pre></div><br /><br />How can I have it start its search in a different directory than the batch file is located. I tried inserting a path right after /c:   but it creates a blank temp file. doesnt seem to do the search at the path I give it. Also, my batch file that will be running this will just be in a folder on the desktop, and so the temp file is fine being created in the same folder as the batch file. I just need to be able to conduct the whole search of a separate drive and folder path. (Which no users will have write access to, only read access.)   Anyone able to shed some light on either of my issues, with the path to begin the search in, or the way to give the user the choice to launch each of the text files in the variables.<br /><br />Let me know if I need to explain any better. The fun part is yet to come, when I have to inject all the user input needed for the batch file, from an actual application made in vb or c++.<br /><br />Thanks again.  <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6233" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile6233">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist0e41.html?mode=viewprofile&amp;u=1966" class="username">ice_531</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searche4a3.html?author_id=1966&amp;sr=posts">18</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 21 Jan 2011 09:59</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content6233">

						<h3 ><a href="#p6233">Re: string manipulation help</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinga92b-2.html?mode=quote&amp;f=3&amp;p=6233" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic38e6.html?p=6233#p6233" onclick="prompt('Message #8',this.href); return false;">#8</a></span> 
									<a class="unread" href="viewtopic38e6.html?p=6233#p6233" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist0e41.html?mode=viewprofile&amp;u=1966" class="username">ice_531</a></strong> &raquo; </span>22 Jan 2011 19:23
			</p>
			
			
			
			<div class="content">OK. nevermind the last post. It isn't going to be possible to have it search the different directory. as it isn't local on the harddrive, and i didnt have access to it by just doing CD \thepath<br /><br />Sooo. Ill just have to get approval to have my batch file (once complete) placed in that root directory of that path,, so people can just run it from there and wont have the issue. Also did away with the temp file, so that no files have to be written (avoids the read-only access issue).<br /><br />My current dilemma is the following. I need a way to search folder names for partial string. <br /><br />Example:<br /><br />Folders in root directory.<br /><br />Version 4.00<br />Version 3.02<br />Version 6.00<br />Version 8.03<br />Version 8.04<br /><br />Ok, so I need a way to search for the folder that contains partial string that the user can enter. So if a user types in &quot; 3.02 &quot; It will find the folder Version 3.02, and then the rest of my code can be executed from here, by simply issuing the CD Version 3.02 to change to that directory. <br /><br />My only thought so far, is to just hardcode IF statements in for all 20 possible folders (would have to update the program anytime a new version comes out...which wouldn't be that bad i guess) But figured I'd ask to see if perhaps there was a for loop someone knew that would allow to just search.<br /><br />Thanks</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6241" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile6241">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist1d1f.html?mode=viewprofile&amp;u=1996" class="username">subhash chandra</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchcee8.html?author_id=1996&amp;sr=posts">2</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 Jan 2011 16:56</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content6241">

						<h3 ><a href="#p6241">Re: string manipulation help</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingb739.html?mode=quote&amp;f=3&amp;p=6241" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic8769.html?p=6241#p6241" onclick="prompt('Message #9',this.href); return false;">#9</a></span> 
									<a class="unread" href="viewtopic8769.html?p=6241#p6241" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist1d1f.html?mode=viewprofile&amp;u=1996" class="username">subhash chandra</a></strong> &raquo; </span>23 Jan 2011 18:05
			</p>
			
			
			
			<div class="content">If you want to change to a network directory you can use pushD command.<br /><br />Further, For your last question i guess below should work.<br /><br />1 ) Take a dir output of your root directory in temp file. DIR /b &gt;%temp%\_dir.txt<br />2) take the user input using set /p in a varible<br />3) do  a search for user inputed string into tempfile and redirect the output to another temp textfile1.<br />4) assign the value of tempfile1 to a varieble.  use set /p var=&lt;filename<br />5) cd to this newvariable.<br />6) it will change the directory to the correct version folder.<br />It will skip the IF condition,and even the folders are added later the code does not need to be modifed.<br /><br />Let me know your thoughts..</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6242" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile6242">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberliste9f9.html?mode=viewprofile&amp;u=1855" class="username">ChickenSoup</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search6656.html?author_id=1855&amp;sr=posts">79</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 13 Dec 2010 10:32</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content6242">

						<h3 ><a href="#p6242">Re: string manipulation help</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingc680.html?mode=quote&amp;f=3&amp;p=6242" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic1ff8.html?p=6242#p6242" onclick="prompt('Message #10',this.href); return false;">#10</a></span> 
									<a class="unread" href="viewtopic1ff8.html?p=6242#p6242" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberliste9f9.html?mode=viewprofile&amp;u=1855" class="username">ChickenSoup</a></strong> &raquo; </span>24 Jan 2011 09:00
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>ice_531 wrote:</cite>My only thought so far, is to just hardcode IF statements in for all 20 possible folders (would have to update the program anytime a new version comes out...which wouldn't be that bad i guess) But figured I'd ask to see if perhaps there was a for loop someone knew that would allow to just search.</div></blockquote><br /><br />This loop would probably do it for you:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />:start<br />set /p searchversion=Enter the version to use (X to exit): <br />if /i &quot;%searchversion%&quot; == &quot;X&quot; echo.Exited by user &amp;&amp; goto end<br />echo %searchversion% | findstr /r &quot;&#91;0-9&#93;\.&#91;0-9&#93;&#91;0-9&#93;&quot;&gt;nul || echo.Invalid Version (ex: #.##) &amp;&amp; goto start<br />for /f &quot;tokens=*&quot; %%a in ('dir /b /ad ^| findstr /R &quot;\&lt;%searchversion%\&gt;&quot;') do set workingversion=%%a<br />if &quot;%workingversion%&quot; == &quot;&quot; (<br />&nbsp; &nbsp;echo.Version not found.<br />&nbsp; &nbsp;goto start<br />)<br />echo Selected version: %workingversion%<br />CD &quot;%workingversion%&quot;<br />echo.Run rest of code...<br />:end<br />pause<br /></code></pre></div></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6270" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile6270">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist0e41.html?mode=viewprofile&amp;u=1966" class="username">ice_531</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searche4a3.html?author_id=1966&amp;sr=posts">18</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 21 Jan 2011 09:59</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content6270">

						<h3 ><a href="#p6270">Re: string manipulation help</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting3f54.html?mode=quote&amp;f=3&amp;p=6270" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic6fb5.html?p=6270#p6270" onclick="prompt('Message #11',this.href); return false;">#11</a></span> 
									<a class="unread" href="viewtopic6fb5.html?p=6270#p6270" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist0e41.html?mode=viewprofile&amp;u=1966" class="username">ice_531</a></strong> &raquo; </span>26 Jan 2011 19:42
			</p>
			
			
			
			<div class="content">I appreciate the replies all.<br /><br />I have another question, i cant seem to figure this out after reading over the dir , findstr  and for /f functions. So i cant use a temp file due to read only access restrictions all the machines have that this batch file will be run from. just an fyi, for any responses.<br /><br />Im going to show you two pieces of code, the first is what i have that works, and the 2nd is how id like to change it to get it to narrow the search down more, based on a build and patch level added to the search.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>:SEARCH<br /><br />set /p choice=Enter the search word or phrase to find the QF:<br /><br />setLocal EnableDelayedExpansion<br />for /f &quot;tokens=* delims= &quot; %%a in ('FINDSTR /s /i /L /M /c:&quot;%choice%&quot; *.txt') do (<br />set /a n+=1<br />set v!n!=%%a<br />echo %%a<br />)</code></pre></div><br /><br /><br />So here's the piece of code Id like to get it to do.. i know the syntax and form must not be right since it isnt working. So by the time the user gets to the portion of SEARCH code, the batch file has found the main version folder the user wanted, and changed its path to this folder. Then i need to narrow down the next search to any folders that contain a partial string, which will be in format &quot;buildpatch&quot; e.g. 03F , or  01P      (or it may not have a patch level, it may just be   02, 03, etc)<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>:SEARCH<br />&nbsp;<br />set /p buildPatch=Enter the build and patch level:<br />set /p choice=Enter the search word or phrase to find the QF:<br />&nbsp;<br /><br />setLocal EnableDelayedExpansion<br />for /f &quot;tokens=* delims= &quot; %%a in ('dir /ad /b /s | findstr &quot;%buildPatch%&quot; | FINDSTR /s /i /L /M /c:&quot;%choice%&quot; *.txt') do (<br />set /a n+=1<br />set v!n!=%%a<br />echo %%a<br />)</code></pre></div><br /><br />So if the above code worked like i have it written (incorrectly). it would first search for folders containing the build and patch, and then from those folders found, conduct the search for the text file containing the keyword/phrase the user entered. but this search is ONLY conducted on the folders that match the build and patch(partially).. a real folder may read like: 8.03.28.02N  (02N would be the build and patch)<br /><br />If anyone can shed some light on my code above, or perhaps a better way. I want to be able to give the user the choice to launch the folder containing the txt file match at the end of all of this. obviously there might be multiple matches, hence the need for a choice to launch, instead of automatically launching 10 explorer windows if that was the result of the search.<br /><br />Thanks again!</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6272" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile6272">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist1d1f.html?mode=viewprofile&amp;u=1996" class="username">subhash chandra</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchcee8.html?author_id=1996&amp;sr=posts">2</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 Jan 2011 16:56</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content6272">

						<h3 ><a href="#p6272">Re: string manipulation help</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting80e5.html?mode=quote&amp;f=3&amp;p=6272" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic13e4.html?p=6272#p6272" onclick="prompt('Message #12',this.href); return false;">#12</a></span> 
									<a class="unread" href="viewtopic13e4.html?p=6272#p6272" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist1d1f.html?mode=viewprofile&amp;u=1996" class="username">subhash chandra</a></strong> &raquo; </span>26 Jan 2011 21:03
			</p>
			
			
			
			<div class="content">what is the exact errror you are getting with your code?<br />use ^|^ instead of |  (| does not work directly inside loop).<br />Will there possibility of more than 1 folder ?IF so then a temp file needs to be created which will hold the name of folders containg version match,Can you think of any folder where the user will have write permission (May be his home directory or something)?</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6273" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile6273">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist0e41.html?mode=viewprofile&amp;u=1966" class="username">ice_531</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searche4a3.html?author_id=1966&amp;sr=posts">18</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 21 Jan 2011 09:59</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content6273">

						<h3 ><a href="#p6273">Re: string manipulation help</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingd917.html?mode=quote&amp;f=3&amp;p=6273" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicb993.html?p=6273#p6273" onclick="prompt('Message #13',this.href); return false;">#13</a></span> 
									<a class="unread" href="viewtopicb993.html?p=6273#p6273" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist0e41.html?mode=viewprofile&amp;u=1966" class="username">ice_531</a></strong> &raquo; </span>26 Jan 2011 21:36
			</p>
			
			
			
			<div class="content">the drive to be searched is read only. their own harddrive where the folder the batch file is kept has write access though. I guess a temp file could be made there.<br /><br />Also, yes there are many folders. one of the versions alone has 60+ folders in it with different patches, etc.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6274" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile6274">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist0e41.html?mode=viewprofile&amp;u=1966" class="username">ice_531</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searche4a3.html?author_id=1966&amp;sr=posts">18</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 21 Jan 2011 09:59</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content6274">

						<h3 ><a href="#p6274">Re: string manipulation help</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting8b52.html?mode=quote&amp;f=3&amp;p=6274" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopica106.html?p=6274#p6274" onclick="prompt('Message #14',this.href); return false;">#14</a></span> 
									<a class="unread" href="viewtopica106.html?p=6274#p6274" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist0e41.html?mode=viewprofile&amp;u=1966" class="username">ice_531</a></strong> &raquo; </span>26 Jan 2011 21:38
			</p>
			
			
			
			<div class="content">So you are saying the following should work how I was trying to explain it.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>for /f &quot;tokens=* delims= &quot; %%a in ('dir /ad /b /s | findstr &quot;%buildPatch%&quot; ^|^ FINDSTR /s /i /L /M /c:&quot;%choice%&quot; *.txt') do (<br />set /a n+=1<br />set v!n!=%%a<br />echo %%a</code></pre></div><br /><br /><br />and then something like %%a &gt; temp.txt <br />at the end? and then read each line back out and give each line as a choice to the user, and let them pick.. then just explorer %theirchoice% ?</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6283" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile6283">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberliste9f9.html?mode=viewprofile&amp;u=1855" class="username">ChickenSoup</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search6656.html?author_id=1855&amp;sr=posts">79</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 13 Dec 2010 10:32</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content6283">

						<h3 ><a href="#p6283">Re: string manipulation help</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting2571.html?mode=quote&amp;f=3&amp;p=6283" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic6c6a.html?p=6283#p6283" onclick="prompt('Message #15',this.href); return false;">#15</a></span> 
									<a class="unread" href="viewtopic6c6a.html?p=6283#p6283" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberliste9f9.html?mode=viewprofile&amp;u=1855" class="username">ChickenSoup</a></strong> &raquo; </span>27 Jan 2011 07:32
			</p>
			
			
			
			<div class="content">Not Quite.  The carot escapes the pipe in the for loop. also, when you pipe the output from one command to FINDSTR you are only searching the output not files. Try the following (I think). I'm not clear on what you are doing exactly. This seems to have morphed from your original question<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>for /f &quot;tokens=* delims= &quot; %%a in ('dir /ad /b /s ^| findstr /i /c:&quot;%buildPatch%&quot; ^| FINDSTR /i /c:&quot;%choice%&quot;') do (<br />set /a n+=1<br />set v!n!=%%a<br />echo %%a<br />)<br /><br /></code></pre></div></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
	

	<div class="action-bar bar-bottom">
	
			<a href="posting7f87.html?mode=reply&amp;f=3&amp;t=1592" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic6b77.html?f=3&amp;t=1592&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

			<form method="post" action="https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=1592">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			31 posts
							<ul>
		<li class="active"><span>1</span></li>
				<li><a class="button" href="viewtopic43ec.html?f=3&amp;t=1592&amp;start=15" role="button">2</a></li>
				<li><a class="button" href="viewtopic5528.html?f=3&amp;t=1592&amp;start=30" role="button">3</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopic43ec.html?f=3&amp;t=1592&amp;start=15" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="viewforum4d6b.html?f=3" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to “DOS Batch Forum”</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="viewforum31e6.html?f=4" class="jumpbox-cat-link"> <span> DosTips - Dos Batch</span></a></li>
																<li><a href="viewforum4d6b.html?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; DOS Batch Forum</span></a></li>
											</ul>
		</div>
	</div>

	</div>


			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
							<span class="crumb"><a href="../index.html" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>DosTips.com</span></a></span>									<span class="crumb"><a href="index.html" data-navbar-reference="index"><span>Board index</span></a></span>					</li>
		
				<li class="rightside">All times are <span title="UTC-6">UTC-06:00</span></li>
							<li class="rightside">
				<a href="ucp033a.html?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete all board cookies</span>
				</a>
			</li>
												<li class="rightside" data-last-responsive="true">
				<a href="memberlist4bfd.html?mode=team" role="menuitem">
					<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
				</a>
			</li>
									<li class="rightside" data-last-responsive="true">
				<a href="memberlist8733.html?mode=contactadmin" role="menuitem">
					<i class="icon fa-envelope fa-fw" aria-hidden="true"></i><span>Contact us</span>
				</a>
			</li>
			</ul>

	</div>
</div>

	<div class="copyright">
				<!-- WARNING NO DELETE -->Style developer by <a href="http://tricolor.x-tk.ru/">support forum tricolor</a>, <!-- END WARNING NO DELETE -->Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
									</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	<img src="cron5495.gif?cron_type=cron.task.text_reparser.poll_title" width="1" height="1" alt="cron" /></div>

<script type="text/javascript" src="assets/javascript/jquery.mind772.js?assets_version=34"></script>
<script type="text/javascript" src="assets/javascript/cored772.js?assets_version=34"></script>



<script type="text/javascript" src="styles/prosilver/template/forum_fnd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/prosilver/template/ajaxd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/jquery-uid772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/collapsed772.js?assets_version=34"></script>



</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?p=6212 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 08:56:57 GMT -->
</html>
