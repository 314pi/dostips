<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=6044&p=58140 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 08:05:17 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>JREPL.BAT v7.14 - regex text processor now with Unicode and XRegExp support - Page 26 - DosTips.com</title>


	<link rel="canonical" href="viewtopic2938.html?t=6044&amp;start=375">

<!--
	phpBB style name: Allan Style - SUBSILVER
	Based on style:   prosilver (this is the default phpBB3 style)
	Based on style:   subsilver2 (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:  Allan ( http://x-tk.ru/ )
-->

<link href="assets/css/font-awesome.mind772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/stylesheetd772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/en/stylesheetd772.css?assets_version=34" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="./styles/AllanStyle-SUBSILVER/theme/tweaks.css?assets_version=34" rel="stylesheet">
<![endif]-->




<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','../../www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-280191-1', 'auto');
	ga('send', 'pageview');
</script>

</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">

<div id="header-subsilver">
	<a id="top" class="top-anchor" accesskey="t"></a>
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description" class="site-description">
				<a id="logo" class="logo" href="../index.html" title="DosTips.com"><span class="site_logo"></span></a>
				<h1>DosTips.com</h1>
				<p>A Forum all about DOS Batch</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

									<div id="search-box" class="search-box search-header" role="search">
				<form action="https://www.dostips.com/forum/search.php" method="get" id="search">
				<fieldset>
					<input name="keywords" id="keywords" type="search" maxlength="128" title="Search for keywords" class="inputbox search tiny" size="20" value="" placeholder="Search…" />
					<button class="button button-search" type="submit" title="Search">
						<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
					</button>
					<a href="search.html" class="button button-search-end" title="Advanced search">
						<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
					</a>
					
				</fieldset>
				</form>
			</div>
						
			</div>
					</div>
</div>


<div id="wrap" class="wrap">
	<div id="page-header">
				<div class="navbar-top" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
																									<li>
								<a href="search33a7.html?search_id=unanswered" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="search526f.html?search_id=active_topics" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-blue" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="search.html" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
											<li class="separator"></li>
																			<li>
								<a href="memberlist4bfd.html?mode=team" role="menuitem">
									<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
								</a>
							</li>
																<li class="separator"></li>

									</ul>
			</div>
		</li>

				<li data-skip-responsive="true">
			<a href="app.php/help/faq.html" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
						
			<li class="rightside"  data-skip-responsive="true">
			<a href="ucp26c3.html?mode=login" title="Login" accesskey="x" role="menuitem">
				<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Login</span>
			</a>
		</li>
					<li class="rightside" data-skip-responsive="true">
				<a href="ucp8319.html?mode=register" role="menuitem">
					<i class="icon fa-pencil-square-o  fa-fw" aria-hidden="true"></i><span>Register</span>
				</a>
			</li>
						</ul>

	</div>
</div>

<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
						<li class="breadcrumbs">
							<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="../index.html" itemprop="url" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span itemprop="title">DosTips.com</span></a></span>
										<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="index.html" itemprop="url" accesskey="h" data-navbar-reference="index"><span itemprop="title">Board index</span></a></span>

											<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="4"><a href="viewforum31e6.html?f=4" itemprop="url"><span itemprop="title">DosTips - Dos Batch</span></a></span>
															<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="3"><a href="viewforum4d6b.html?f=3" itemprop="url"><span itemprop="title">DOS Batch Forum</span></a></span>
												</li>
		
					<li class="rightside responsive-search">
				<a href="search.html" title="View the advanced search options" role="menuitem">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</a>
			</li>
			</ul>

	</div>
</div>

<div class="navbar-top-link">
	<div class="inner">
		<ul>
			<li class="navbar-top-link-left"><a href="search33a7.html?search_id=unanswered">Unanswered topics</a></li>
			<li class="navbar-top-link-left"><a href="search526f.html?search_id=active_topics">Active topics</a></li>

											</ul>
	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
		
<h2 class="topic-title"><a href="viewtopicc17f.html?f=3&amp;t=6044&amp;start=375">JREPL.BAT v7.14 - regex text processor now with Unicode and XRegExp support</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">Discussion forum for all Windows batch related topics.<br /></div>
<p>
	<strong>Moderator:</strong> <a href="memberlista6a8.html?mode=viewprofile&amp;u=5" class="username">DosItHelp</a>
</p>


<div class="action-bar bar-top">
	
			<a href="postingdfbb.html?mode=reply&amp;f=3&amp;t=6044" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic8ca3.html?f=3&amp;t=6044&amp;start=375&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="https://www.dostips.com/forum/search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topic…" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="search.html" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="6044" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			393 posts
							<ul>
	<li class="dropdown-container dropdown-button-control dropdown-page-jump page-jump">
		<a class="button button-icon-only dropdown-trigger" href="#" title="Click to jump to page…" role="button"><i class="icon fa-level-down fa-rotate-270" aria-hidden="true"></i><span class="sr-only">Page <strong>26</strong> of <strong>27</strong></span></a>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
				<li>Jump to page:</li>
				<li class="page-jump-form">
					<input type="number" name="page-number" min="1" max="999999" title="Enter the page number you wish to go to" class="inputbox tiny" data-per-page="15" data-base-url=".&#x2F;viewtopic.php&#x3F;f&#x3D;3&amp;amp&#x3B;t&#x3D;6044" data-start-name="start" />
					<input class="button2" value="Go" type="button" />
				</li>
			</ul>
		</div>
	</li>
			<li class="arrow previous"><a class="button button-icon-only" href="viewtopic6da9.html?f=3&amp;t=6044&amp;start=360" rel="prev" role="button"><i class="icon fa-chevron-left fa-fw" aria-hidden="true"></i><span class="sr-only">Previous</span></a></li>
				<li><a class="button" href="viewtopicb16d.html?f=3&amp;t=6044" role="button">1</a></li>
			<li class="ellipsis" role="separator"><span>…</span></li>
				<li><a class="button" href="viewtopicd036.html?f=3&amp;t=6044&amp;start=330" role="button">23</a></li>
				<li><a class="button" href="viewtopicf6ad.html?f=3&amp;t=6044&amp;start=345" role="button">24</a></li>
				<li><a class="button" href="viewtopic6da9.html?f=3&amp;t=6044&amp;start=360" role="button">25</a></li>
			<li class="active"><span>26</span></li>
				<li><a class="button" href="viewtopic54c6.html?f=3&amp;t=6044&amp;start=390" role="button">27</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopic54c6.html?f=3&amp;t=6044&amp;start=390" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
		</div>




<div id="subsilver-nav-topic">
	<div class="inner"><div class="post has-profile">
		<div class="leftsided postbody subsilver-topic-title">Message</div>
		<div class="leftsided postprofile subsilver-topic-author">Author</div>
	</div></div>
</div>

			<div id="p57510" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile57510">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search661c.html?author_id=1265&amp;sr=posts">3386</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 22 Jan 2010 18:01</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content57510">

						<h3 class="first"><a href="#p57510">Re: JREPL.BAT v7.13 - regex text processor now with Unicode and XRegExp support</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting67f6.html?mode=quote&amp;f=3&amp;p=57510" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic7af1.html?p=57510#p57510" onclick="prompt('Message #376',this.href); return false;">#376</a></span> 
									<a class="unread" href="viewtopic7af1.html?p=57510#p57510" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a></strong> &raquo; </span>20 Jul 2018 02:39
			</p>
			
			
			
			<div class="content">I see. To be honest I really expected to have ADO by default at least on XP and onwards because it was already introduced in the late 1990's and I never worked on a machine where it wasn't installed. I'll keep my eyes open. If I find something about its availability then I'll get back to you.<br>
<br>
Steffen</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p57512" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile57512">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content57512">

						<h3 ><a href="#p57512">Re: JREPL.BAT v7.13 - regex text processor now with Unicode and XRegExp support</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting43cc.html?mode=quote&amp;f=3&amp;p=57512" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic3b24.html?p=57512#p57512" onclick="prompt('Message #377',this.href); return false;">#377</a></span> 
									<a class="unread" href="viewtopic3b24.html?p=57512#p57512" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>20 Jul 2018 06:04
			</p>
			
			
			
			<div class="content">There may be confusion over ADO vs ADO.NET.<br>
<br>
ADO.NET certainly is not guaranteed to be present, and I may have read something that confused the two, or I may have misinterpreted what I read.<br>
<br>
I can't find anything that indicates ADO is not standard, even for XP Home. I see articles about it not working in some cases, but they seem to be about compatibility issues that are solved by standard updates.<br>
<br>
My StackOverflow tester was on XP SP3 without .NET, and 7.13 worked just fine. But he did not specify Home or Pro.<br>
<br>
I'm almost ready to pull the trigger and drop the CERTUTIL code, but not quite there.<br>
<br>
<br>
Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p57519" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile57519">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search661c.html?author_id=1265&amp;sr=posts">3386</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 22 Jan 2010 18:01</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content57519">

						<h3 ><a href="#p57519">Re: JREPL.BAT v7.13 - regex text processor now with Unicode and XRegExp support</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting7b18.html?mode=quote&amp;f=3&amp;p=57519" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicf6a7.html?p=57519#p57519" onclick="prompt('Message #378',this.href); return false;">#378</a></span> 
									<a class="unread" href="viewtopicf6a7.html?p=57519#p57519" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a></strong> &raquo; </span>20 Jul 2018 13:52
			</p>
			
			
			
			<div class="content"><blockquote><div><cite><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258">dbenham</a> wrote: <a href="viewtopic3b24.html?p=57512#p57512" data-post-id="57512" onclick="if(document.getElementById(hash.substr(1)))href=hash">↑</a><div class="responsive-hide">20 Jul 2018 06:04</div></cite>ADO vs ADO.NET</div></blockquote>
I think you nailed it.<br>
Finally you need to worry about upward compatibility rather than downward compatibility. Microsoft already tries forcing us to use .NET. Powershell is set as default console on Win 10. They want us to use C#.NET rather than C/Win32 API and thus, it's a logical consequence to have ADO.NET as successor of ADO ... <br>
<br>
Steffen</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p58006" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile58006">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist4b4f.html?mode=viewprofile&amp;u=9387" class="username">fdart17</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1ae9.html?author_id=9387&amp;sr=posts">2</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 18 Sep 2018 11:18</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content58006">

						<h3 ><a href="#p58006">Re: JREPL.BAT v7.13 - regex text processor now with Unicode and XRegExp support</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingb8b4.html?mode=quote&amp;f=3&amp;p=58006" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic6e12.html?p=58006#p58006" onclick="prompt('Message #379',this.href); return false;">#379</a></span> 
									<a class="unread" href="viewtopic6e12.html?p=58006#p58006" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist4b4f.html?mode=viewprofile&amp;u=9387" class="username">fdart17</a></strong> &raquo; </span>18 Sep 2018 11:32
			</p>
			
			
			
			<div class="content">Hi dbenham,<br>
<br>
Thank you very much for writing and maintaining this script.<br>
<br>
Within the context of a cmd.exe in Windows 10, I'm calling a batch script which then invokes an exe to do a C++ build.  I want to modify the output to the cmd prompt to color warnings in yellow and errors in red.  This seems like a good application of this script.  Is it possible to invoke jrepl in such a way that it will attach itself to the existing cmd prompt, running continuously to intercept incoming output and modify it before it is displayed to add ansi escape characters, while still allowing the user to interact with the existing cmd prompt to invoke more commands?<br>
<br>
Thanks,<br>
Justin</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p58007" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile58007">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist2675.html?mode=viewprofile&amp;u=2988" style="color: #00AA00;" class="username-coloured">Squashman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1322.html?author_id=2988&amp;sr=posts">3970</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 Dec 2011 13:59</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content58007">

						<h3 ><a href="#p58007">Re: JREPL.BAT v7.13 - regex text processor now with Unicode and XRegExp support</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting9b56.html?mode=quote&amp;f=3&amp;p=58007" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicf601.html?p=58007#p58007" onclick="prompt('Message #380',this.href); return false;">#380</a></span> 
									<a class="unread" href="viewtopicf601.html?p=58007#p58007" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist2675.html?mode=viewprofile&amp;u=2988" style="color: #00AA00;" class="username-coloured">Squashman</a></strong> &raquo; </span>18 Sep 2018 14:21
			</p>
			
			
			
			<div class="content"><blockquote><div><cite><a href="memberlist4b4f.html?mode=viewprofile&amp;u=9387">fdart17</a> wrote: <a href="viewtopic6e12.html?p=58006#p58006" data-post-id="58006" onclick="if(document.getElementById(hash.substr(1)))href=hash">↑</a><div class="responsive-hide">18 Sep 2018 11:32</div></cite>
Hi dbenham,<br>
<br>
Thank you very much for writing and maintaining this script.<br>
<br>
Within the context of a cmd.exe in Windows 10, I'm calling a batch script which then invokes an exe to do a C++ build.  I want to modify the output to the cmd prompt to color warnings in yellow and errors in red.  This seems like a good application of this script.  Is it possible to invoke jrepl in such a way that it will attach itself to the existing cmd prompt, running continuously to intercept incoming output and modify it before it is displayed to add ansi escape characters, while still allowing the user to interact with the existing cmd prompt to invoke more commands?<br>
<br>
Thanks,<br>
Justin
</div></blockquote>
Going to assume this is you: <a href="https://stackoverflow.com/questions/52392242/how-to-intercept-output-to-windows-10-cmd-exe-and-modify-to-add-color" class="postlink">https://stackoverflow.com/questions/523 ... -add-color</a></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p58008" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile58008">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist4b4f.html?mode=viewprofile&amp;u=9387" class="username">fdart17</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1ae9.html?author_id=9387&amp;sr=posts">2</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 18 Sep 2018 11:18</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content58008">

						<h3 ><a href="#p58008">Re: JREPL.BAT v7.13 - regex text processor now with Unicode and XRegExp support</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinga2f0.html?mode=quote&amp;f=3&amp;p=58008" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopiceca6.html?p=58008#p58008" onclick="prompt('Message #381',this.href); return false;">#381</a></span> 
									<a class="unread" href="viewtopiceca6.html?p=58008#p58008" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist4b4f.html?mode=viewprofile&amp;u=9387" class="username">fdart17</a></strong> &raquo; </span>18 Sep 2018 15:12
			</p>
			
			
			
			<div class="content">Yes, that is me.<br>
<br>
I wanted to post an update here to not waste anyone's time.  I've found another solution to the problem which happens to not leverage JREPL.BAT.<br>
<a href="https://stackoverflow.com/questions/52392242/how-to-intercept-output-to-windows-10-cmd-exe-and-modify-to-add-color" class="postlink">https://stackoverflow.com/questions/523 ... -add-color</a><br>
<br>
It's still not as good as I would like, so I will keep searching for a better solution <img class="smilies" src="images/smilies/icon_smile.gif" width="15" height="15" alt=":)" title="Smile"></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p58130" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile58130">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistaa1a.html?mode=viewprofile&amp;u=9422" class="username">Michael.Uray</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search6d2d.html?author_id=9422&amp;sr=posts">5</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Oct 2018 19:02</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content58130">

						<h3 ><a href="#p58130">Re: JREPL.BAT v7.13 - regex text processor now with Unicode and XRegExp support</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingba8e.html?mode=quote&amp;f=3&amp;p=58130" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicd489.html?p=58130#p58130" onclick="prompt('Message #382',this.href); return false;">#382</a></span> 
									<a class="unread" href="viewtopicd489.html?p=58130#p58130" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistaa1a.html?mode=viewprofile&amp;u=9422" class="username">Michael.Uray</a></strong> &raquo; </span>12 Oct 2018 19:10
			</p>
			
			
			
			<div class="content">I got the message
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>JScript runtime error: Nicht genügend Arbeitsspeicher.</code></pre></div> (means not enough RAM / memory)<br>
<br>
when I did run a regex search/replace:
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>JREPL.BAT "^\d+ 0 obj \n(?:(?!endobj $).*\n)*?\/Name \/Paragraph(?:.*\n)*?endobj ?$" "" /F input.pdf /M /O output.pdf</code></pre></div>

It happens when the cscript.exe process memor runs up to 3GB.<br>
<br>
There is actually enough free RAM.<br>
Any ideas?</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p58131" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile58131">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist2675.html?mode=viewprofile&amp;u=2988" style="color: #00AA00;" class="username-coloured">Squashman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1322.html?author_id=2988&amp;sr=posts">3970</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 Dec 2011 13:59</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content58131">

						<h3 ><a href="#p58131">Re: JREPL.BAT v7.13 - regex text processor now with Unicode and XRegExp support</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting3eba.html?mode=quote&amp;f=3&amp;p=58131" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic553f.html?p=58131#p58131" onclick="prompt('Message #383',this.href); return false;">#383</a></span> 
									<a class="unread" href="viewtopic553f.html?p=58131#p58131" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist2675.html?mode=viewprofile&amp;u=2988" style="color: #00AA00;" class="username-coloured">Squashman</a></strong> &raquo; </span>12 Oct 2018 20:03
			</p>
			
			
			
			<div class="content">You are using the /M option.  You are limited to 2GB of ram for 32 bit applications.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p58132" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile58132">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistaa1a.html?mode=viewprofile&amp;u=9422" class="username">Michael.Uray</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search6d2d.html?author_id=9422&amp;sr=posts">5</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Oct 2018 19:02</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content58132">

						<h3 ><a href="#p58132">Re: JREPL.BAT v7.13 - regex text processor now with Unicode and XRegExp support</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting3aac.html?mode=quote&amp;f=3&amp;p=58132" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicd78a.html?p=58132#p58132" onclick="prompt('Message #384',this.href); return false;">#384</a></span> 
									<a class="unread" href="viewtopicd78a.html?p=58132#p58132" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistaa1a.html?mode=viewprofile&amp;u=9422" class="username">Michael.Uray</a></strong> &raquo; </span>13 Oct 2018 03:07
			</p>
			
			
			
			<div class="content"><blockquote><div><cite><a href="memberlist2675.html?mode=viewprofile&amp;u=2988">Squashman</a> wrote: <a href="viewtopic553f.html?p=58131#p58131" data-post-id="58131" onclick="if(document.getElementById(hash.substr(1)))href=hash">↑</a><div class="responsive-hide">12 Oct 2018 20:03</div></cite>
You are using the /M option.  You are limited to 2GB of ram for 32 bit applications.
</div></blockquote>
I need to parse multi line files like this <a href="https://regex101.com/r/fA6wE2/155" class="postlink">https://regex101.com/r/fA6wE2/155</a> to search for objects which contain "Name /Paragraph".<br>
The file has about 1.5 GB.<br>
<br>
Any idea how to get around this issue?</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p58138" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile58138">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content58138">

						<h3 ><a href="#p58138">Re: JREPL.BAT v7.13 - regex text processor now with Unicode and XRegExp support</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingac85.html?mode=quote&amp;f=3&amp;p=58138" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic26d3.html?p=58138#p58138" onclick="prompt('Message #385',this.href); return false;">#385</a></span> 
									<a class="unread" href="viewtopic26d3.html?p=58138#p58138" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>14 Oct 2018 17:36
			</p>
			
			
			
			<div class="content">Unfortunately there is no way to circumvent the file size limit when using the /M option. I'm not sure the exact limit, but it is actually less than 1 GB.<br>
<br>
You may still be able to use JREPL if you ditch the /M option and combine the /T option with /JMATCH and custom JScript. You don't state what your end goal is. The code below simply preserves object entries that contain a "/Name /Paragraph" line, and throws everything else away.
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off
setlocal

set "init=var obj=false, keep=false, eol='\n'"

set "find1=^\d+ 0 obj\s*$"
set "repl1=obj=$0+eol;$txt=false;"

set "find2=^/Name /Paragraph\s*$"
set "repl2=if (obj){obj+=$0+eol;keep=true;}$txt=false;"

set "find3=^endobj\s*$"
set "repl3=$txt=keep?obj+$0:false;obj=keep=false;"

set "find4=^.*$"
set "repl4=if (obj){obj+=$0+eol;}$txt=false;"

set "find=%find1%|%find2%|%find3%|%find4%"
set "repl=%repl1%|%repl2%|%repl3%|%repl4%"

call jrepl find repl /t "|" /jmatchq /jbeg init /v /u /f input.pdf /o output.pdf

exit /b
</code></pre></div>

Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p58139" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile58139">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content58139">

						<h3 ><a href="#p58139">Re: JREPL.BAT v7.13 - regex text processor now with Unicode and XRegExp support</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingdfe0.html?mode=quote&amp;f=3&amp;p=58139" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic349a.html?p=58139#p58139" onclick="prompt('Message #386',this.href); return false;">#386</a></span> 
									<a class="unread" href="viewtopic349a.html?p=58139#p58139" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>15 Oct 2018 05:58
			</p>
			
			
			
			<div class="content">Upon looking closer at your original code, it looks like you are trying to remove all the objects that contain "/Name /Paragraph".
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off
setlocal

set "init=var obj='', keep=true, eol='\n'"

set "find1=^\d+ 0 obj\s*$"
set "repl1=obj=$0+eol;$txt=false;"

set "find2=^/Name /Paragraph\s*$"
set "repl2=if (obj)keep=$txt=false; else $txt=$0;"

set "find3=^endobj\s*$"
set "repl3=$txt=keep?obj+$0:false;obj='';keep=true;"

set "find4=^.*$"
set "repl4=if (obj){$txt=false;if (keep)obj+=$0+eol;}else $txt=$0;"

set "find=%find1%|%find2%|%find3%|%find4%"
set "repl=%repl1%|%repl2%|%repl3%|%repl4%"

call jrepl find repl /t "|" /jmatchq /jbeg init /v /u /f input.pdf /o output.pdf

exit /b
</code></pre></div>

Note - It would probably be just as easy to write a custom JScript script as it is to use JREPL as I have done. And custom JScript would probably be a bit faster.<br>
<br>
<br>
Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p58140" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile58140">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistaa1a.html?mode=viewprofile&amp;u=9422" class="username">Michael.Uray</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search6d2d.html?author_id=9422&amp;sr=posts">5</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Oct 2018 19:02</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content58140">

						<h3 ><a href="#p58140">Re: JREPL.BAT v7.13 - regex text processor now with Unicode and XRegExp support</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting1a05.html?mode=quote&amp;f=3&amp;p=58140" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic678a.html?p=58140#p58140" onclick="prompt('Message #387',this.href); return false;">#387</a></span> 
									<a class="unread" href="viewtopic678a.html?p=58140#p58140" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistaa1a.html?mode=viewprofile&amp;u=9422" class="username">Michael.Uray</a></strong> &raquo; </span>15 Oct 2018 07:05
			</p>
			
			
			
			<div class="content"><blockquote><div><cite><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258">dbenham</a> wrote: <a href="viewtopic349a.html?p=58139#p58139" data-post-id="58139" onclick="if(document.getElementById(hash.substr(1)))href=hash">↑</a><div class="responsive-hide">15 Oct 2018 05:58</div></cite>
Upon looking closer at your original code, it looks like you are trying to remove all the objects that contain "/Name /Paragraph".
</div></blockquote>
This is correct.<br>
<br>
I had to replace the variable assignment to the command to run it, but it does not create the expected output.
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>call jrepl "%find%" "%repl%" /t "|" /jmatchq /jbeg init /v /u /f input.pdf /o output.pdf
</code></pre></div>

The output file (71MB) gets much larger than the input file (7MB) for some reason.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p58141" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile58141">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content58141">

						<h3 ><a href="#p58141">Re: JREPL.BAT v7.13 - regex text processor now with Unicode and XRegExp support</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting8ece.html?mode=quote&amp;f=3&amp;p=58141" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic4b3b.html?p=58141#p58141" onclick="prompt('Message #388',this.href); return false;">#388</a></span> 
									<a class="unread" href="viewtopic4b3b.html?p=58141#p58141" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>15 Oct 2018 08:21
			</p>
			
			
			
			<div class="content"><blockquote><div><cite><a href="memberlistaa1a.html?mode=viewprofile&amp;u=9422">Michael.Uray</a> wrote: <a href="viewtopic678a.html?p=58140#p58140" data-post-id="58140" onclick="if(document.getElementById(hash.substr(1)))href=hash">↑</a><div class="responsive-hide">15 Oct 2018 07:05</div></cite>
I had to replace the variable assignment to the command to run it, but it does not create the expected output.
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>call jrepl "%find%" "%repl%" /t "|" /jmatchq /jbeg init /v /u /f input.pdf /o output.pdf
</code></pre></div>

The output file (71MB) gets much larger than the input file (7MB) for some reason.
</div></blockquote>
No, the find and repl must not be enclosed by percents in the JREPL call.<br>
<br>
I tested the code against the input that you provided in the link, and it worked perfectly for me. But then I added some additional lines at the top of the input that were not contained in an "object", and it began behaving badly. I did some testing, and it appears there is a newly discovered bug - there are internal str and obj objects within the code that interfere with the user supplied JScript if /JBEG defines a variable named str or obj.<br>
<br>
I was able to get the code to work properly if I changed obj to Obj:
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off
setlocal

set "init=var Obj='', keep=true, eol='\n';"

set "find1=^\d+ 0 obj\s*$"
set "repl1=Obj=$0+eol;$txt=false;"

set "find2=^/Name /Paragraph\s*$"
set "repl2=if (Obj)keep=$txt=false; else $txt=$0;"

set "find3=^endobj\s*$"
set "repl3=$txt=keep?Obj+$0:false;Obj='';keep=true;"

set "find4=^.*$"
set "repl4=if (Obj!==''){$txt=false;if (keep)Obj+=$0+eol;}else $txt=$0;"

set "find=%find1%|%find2%|%find3%|%find4%"
set "repl=%repl1%|%repl2%|%repl3%|%repl4%"

call jrepl find repl /t "|" /jmatchq /jbeg init /v /u /f input.pdf /o output.pdf

exit /b
</code></pre></div>

<br>
<strong class="text-strong">Update</strong> - I fixed the bug and released version 7.14. The original code using obj should now work.<br>
<br>
Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p58143" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile58143">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content58143">

						<h3 ><a href="#p58143">Re: JREPL.BAT v7.14 - regex text processor now with Unicode and XRegExp support</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinga8c0.html?mode=quote&amp;f=3&amp;p=58143" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicbb2f.html?p=58143#p58143" onclick="prompt('Message #389',this.href); return false;">#389</a></span> 
									<a class="unread" href="viewtopicbb2f.html?p=58143#p58143" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>15 Oct 2018 13:21
			</p>
			
			
			
			<div class="content"><span style="font-size: 150%; line-height: normal">Here is version 7.14</span>
<div class="inline-attachment">
			
		
		
				<dl class="file">
			<dt><span class="imageset icon_topic_attach"></span> <a class="postlink" href="download/filed08d.php?id=386">JREPL7.14.zip</a></dt>
						<dd>(27.24 KiB) Downloaded 7 times</dd>
		</dl>
		
		
			</div>

<br>
This is simply a bug fix to allow user defined variables named str and/or obj, and to hide the internal xbytes variable from user code.
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>    2018-10-15 v7.14: Bug fix - User defined variables declared in /JBEG named
                      str and/or obj were getting clobbered.
                      Bug fix - Internal variable xbytes was visibile to user
                      supplied JScript.
</code></pre></div>

<br>
Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p58146" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile58146">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistaa1a.html?mode=viewprofile&amp;u=9422" class="username">Michael.Uray</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search6d2d.html?author_id=9422&amp;sr=posts">5</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Oct 2018 19:02</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content58146">

						<h3 ><a href="#p58146">Re: JREPL.BAT v7.13 - regex text processor now with Unicode and XRegExp support</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting98ee.html?mode=quote&amp;f=3&amp;p=58146" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopiceb38.html?p=58146#p58146" onclick="prompt('Message #390',this.href); return false;">#390</a></span> 
									<a class="unread" href="viewtopiceb38.html?p=58146#p58146" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistaa1a.html?mode=viewprofile&amp;u=9422" class="username">Michael.Uray</a></strong> &raquo; </span>15 Oct 2018 14:33
			</p>
			
			
			
			<div class="content"><blockquote><div><cite><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258">dbenham</a> wrote: <a href="viewtopic4b3b.html?p=58141#p58141" data-post-id="58141" onclick="if(document.getElementById(hash.substr(1)))href=hash">↑</a><div class="responsive-hide">15 Oct 2018 08:21</div></cite>
<blockquote><div><cite><a href="memberlistaa1a.html?mode=viewprofile&amp;u=9422">Michael.Uray</a> wrote: <a href="viewtopic678a.html?p=58140#p58140" data-post-id="58140" onclick="if(document.getElementById(hash.substr(1)))href=hash">↑</a><div class="responsive-hide">15 Oct 2018 07:05</div></cite>
I had to replace the variable assignment to the command to run it, but it does not create the expected output.
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>call jrepl "%find%" "%repl%" /t "|" /jmatchq /jbeg init /v /u /f input.pdf /o output.pdf
</code></pre></div>
</div></blockquote>
No, the find and repl must not be enclosed by percents in the JREPL call.
</div></blockquote>
Hmm, I had to add that again in the .cmd file.<br>
"find" and "repl" are envirnment variables so I have to use them with "%" on the beginn and on the end, right?<br>
I have to also put it under quotes because the string (^\d+ 0 obj\s*$|^/Name /Paragraph\s*$|^endobj\s*$|^.*$) contains empty spaces, right?<br>
<br>
The output is still a 70 MB file, maybe I should send you the input file via PM that you are able to recreate the problem.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
	

	<div class="action-bar bar-bottom">
	
			<a href="postingdfbb.html?mode=reply&amp;f=3&amp;t=6044" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic8ca3.html?f=3&amp;t=6044&amp;start=375&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

			<form method="post" action="https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=6044&amp;start=375">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			393 posts
							<ul>
	<li class="dropdown-container dropdown-button-control dropdown-page-jump page-jump">
		<a class="button button-icon-only dropdown-trigger" href="#" title="Click to jump to page…" role="button"><i class="icon fa-level-down fa-rotate-270" aria-hidden="true"></i><span class="sr-only">Page <strong>26</strong> of <strong>27</strong></span></a>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
				<li>Jump to page:</li>
				<li class="page-jump-form">
					<input type="number" name="page-number" min="1" max="999999" title="Enter the page number you wish to go to" class="inputbox tiny" data-per-page="15" data-base-url=".&#x2F;viewtopic.php&#x3F;f&#x3D;3&amp;amp&#x3B;t&#x3D;6044" data-start-name="start" />
					<input class="button2" value="Go" type="button" />
				</li>
			</ul>
		</div>
	</li>
			<li class="arrow previous"><a class="button button-icon-only" href="viewtopic6da9.html?f=3&amp;t=6044&amp;start=360" rel="prev" role="button"><i class="icon fa-chevron-left fa-fw" aria-hidden="true"></i><span class="sr-only">Previous</span></a></li>
				<li><a class="button" href="viewtopicb16d.html?f=3&amp;t=6044" role="button">1</a></li>
			<li class="ellipsis" role="separator"><span>…</span></li>
				<li><a class="button" href="viewtopicd036.html?f=3&amp;t=6044&amp;start=330" role="button">23</a></li>
				<li><a class="button" href="viewtopicf6ad.html?f=3&amp;t=6044&amp;start=345" role="button">24</a></li>
				<li><a class="button" href="viewtopic6da9.html?f=3&amp;t=6044&amp;start=360" role="button">25</a></li>
			<li class="active"><span>26</span></li>
				<li><a class="button" href="viewtopic54c6.html?f=3&amp;t=6044&amp;start=390" role="button">27</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopic54c6.html?f=3&amp;t=6044&amp;start=390" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="viewforum4d6b.html?f=3" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to “DOS Batch Forum”</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="viewforum31e6.html?f=4" class="jumpbox-cat-link"> <span> DosTips - Dos Batch</span></a></li>
																<li><a href="viewforum4d6b.html?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; DOS Batch Forum</span></a></li>
											</ul>
		</div>
	</div>

	</div>


			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
							<span class="crumb"><a href="../index.html" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>DosTips.com</span></a></span>									<span class="crumb"><a href="index.html" data-navbar-reference="index"><span>Board index</span></a></span>					</li>
		
				<li class="rightside">All times are <span title="UTC-6">UTC-06:00</span></li>
							<li class="rightside">
				<a href="ucp033a.html?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete all board cookies</span>
				</a>
			</li>
												<li class="rightside" data-last-responsive="true">
				<a href="memberlist4bfd.html?mode=team" role="menuitem">
					<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
				</a>
			</li>
									<li class="rightside" data-last-responsive="true">
				<a href="memberlist8733.html?mode=contactadmin" role="menuitem">
					<i class="icon fa-envelope fa-fw" aria-hidden="true"></i><span>Contact us</span>
				</a>
			</li>
			</ul>

	</div>
</div>

	<div class="copyright">
				<!-- WARNING NO DELETE -->Style developer by <a href="http://tricolor.x-tk.ru/">support forum tricolor</a>, <!-- END WARNING NO DELETE -->Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
									</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	<img src="cron5495.gif?cron_type=cron.task.text_reparser.poll_title" width="1" height="1" alt="cron" /></div>

<script type="text/javascript" src="assets/javascript/jquery.mind772.js?assets_version=34"></script>
<script type="text/javascript" src="assets/javascript/cored772.js?assets_version=34"></script>



<script type="text/javascript" src="styles/prosilver/template/forum_fnd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/prosilver/template/ajaxd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/jquery-uid772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/collapsed772.js?assets_version=34"></script>



</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=6044&p=58140 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 08:05:17 GMT -->
</html>
