<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=3855&start=30 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 08:03:33 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>regex search and replace for batch - Easily edit files! - Page 3 - DosTips.com</title>


	<link rel="canonical" href="viewtopic8714.html?t=3855&amp;start=30">

<!--
	phpBB style name: Allan Style - SUBSILVER
	Based on style:   prosilver (this is the default phpBB3 style)
	Based on style:   subsilver2 (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:  Allan ( http://x-tk.ru/ )
-->

<link href="assets/css/font-awesome.mind772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/stylesheetd772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/en/stylesheetd772.css?assets_version=34" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="./styles/AllanStyle-SUBSILVER/theme/tweaks.css?assets_version=34" rel="stylesheet">
<![endif]-->




<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','../../www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-280191-1', 'auto');
	ga('send', 'pageview');
</script>

</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">

<div id="header-subsilver">
	<a id="top" class="top-anchor" accesskey="t"></a>
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description" class="site-description">
				<a id="logo" class="logo" href="../index.html" title="DosTips.com"><span class="site_logo"></span></a>
				<h1>DosTips.com</h1>
				<p>A Forum all about DOS Batch</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

									<div id="search-box" class="search-box search-header" role="search">
				<form action="https://www.dostips.com/forum/search.php" method="get" id="search">
				<fieldset>
					<input name="keywords" id="keywords" type="search" maxlength="128" title="Search for keywords" class="inputbox search tiny" size="20" value="" placeholder="Search…" />
					<button class="button button-search" type="submit" title="Search">
						<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
					</button>
					<a href="search.html" class="button button-search-end" title="Advanced search">
						<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
					</a>
					
				</fieldset>
				</form>
			</div>
						
			</div>
					</div>
</div>


<div id="wrap" class="wrap">
	<div id="page-header">
				<div class="navbar-top" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
																									<li>
								<a href="search33a7.html?search_id=unanswered" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="search526f.html?search_id=active_topics" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-blue" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="search.html" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
											<li class="separator"></li>
																			<li>
								<a href="memberlist4bfd.html?mode=team" role="menuitem">
									<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
								</a>
							</li>
																<li class="separator"></li>

									</ul>
			</div>
		</li>

				<li data-skip-responsive="true">
			<a href="app.php/help/faq.html" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
						
			<li class="rightside"  data-skip-responsive="true">
			<a href="ucp26c3.html?mode=login" title="Login" accesskey="x" role="menuitem">
				<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Login</span>
			</a>
		</li>
					<li class="rightside" data-skip-responsive="true">
				<a href="ucp8319.html?mode=register" role="menuitem">
					<i class="icon fa-pencil-square-o  fa-fw" aria-hidden="true"></i><span>Register</span>
				</a>
			</li>
						</ul>

	</div>
</div>

<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
						<li class="breadcrumbs">
							<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="../index.html" itemprop="url" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span itemprop="title">DosTips.com</span></a></span>
										<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="index.html" itemprop="url" accesskey="h" data-navbar-reference="index"><span itemprop="title">Board index</span></a></span>

											<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="4"><a href="viewforum31e6.html?f=4" itemprop="url"><span itemprop="title">DosTips - Dos Batch</span></a></span>
															<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="3"><a href="viewforum4d6b.html?f=3" itemprop="url"><span itemprop="title">DOS Batch Forum</span></a></span>
												</li>
		
					<li class="rightside responsive-search">
				<a href="search.html" title="View the advanced search options" role="menuitem">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</a>
			</li>
			</ul>

	</div>
</div>

<div class="navbar-top-link">
	<div class="inner">
		<ul>
			<li class="navbar-top-link-left"><a href="search33a7.html?search_id=unanswered">Unanswered topics</a></li>
			<li class="navbar-top-link-left"><a href="search526f.html?search_id=active_topics">Active topics</a></li>

											</ul>
	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
		
<h2 class="topic-title"><a href="viewtopic405f.html?f=3&amp;t=3855&amp;start=30">regex search and replace for batch - Easily edit files!</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">Discussion forum for all Windows batch related topics.<br /></div>
<p>
	<strong>Moderator:</strong> <a href="memberlista6a8.html?mode=viewprofile&amp;u=5" class="username">DosItHelp</a>
</p>


<div class="action-bar bar-top">
	
			<a href="posting5ffd.html?mode=reply&amp;f=3&amp;t=3855" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic9c4c.html?f=3&amp;t=3855&amp;start=30&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="https://www.dostips.com/forum/search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topic…" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="search.html" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="3855" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			49 posts
							<ul>
			<li class="arrow previous"><a class="button button-icon-only" href="viewtopic0cd4.html?f=3&amp;t=3855&amp;start=15" rel="prev" role="button"><i class="icon fa-chevron-left fa-fw" aria-hidden="true"></i><span class="sr-only">Previous</span></a></li>
				<li><a class="button" href="viewtopicebb5.html?f=3&amp;t=3855" role="button">1</a></li>
				<li><a class="button" href="viewtopic0cd4.html?f=3&amp;t=3855&amp;start=15" role="button">2</a></li>
			<li class="active"><span>3</span></li>
				<li><a class="button" href="viewtopic74a8.html?f=3&amp;t=3855&amp;start=45" role="button">4</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopic74a8.html?f=3&amp;t=3855&amp;start=45" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
		</div>




<div id="subsilver-nav-topic">
	<div class="inner"><div class="post has-profile">
		<div class="leftsided postbody subsilver-topic-title">Message</div>
		<div class="leftsided postprofile subsilver-topic-author">Author</div>
	</div></div>
</div>

			<div id="p36036" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile36036">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf147.html?author_id=3221&amp;sr=posts">6033</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Feb 2012 02:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content36036">

						<h3 class="first"><a href="#p36036">Re: regex search and replace for batch - Easily edit files!</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting5337.html?mode=quote&amp;f=3&amp;p=36036" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic76c6.html?p=36036#p36036" onclick="prompt('Message #31',this.href); return false;">#31</a></span> 
									<a class="unread" href="viewtopic76c6.html?p=36036#p36036" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a></strong> &raquo; </span>28 Jul 2014 04:25
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>Badchip wrote:</cite>How to change a string with this batch?<br /><br />I always used a similar code: <em class="text-italics"><strong class="text-strong">repl.exe oldstring newstring &quot;old file&quot;&gt;&quot;new file&quot;</strong></em></div></blockquote><br /><br />There is a purpose built solution here, by Dave too.  Read the thread as I recall there was a limitation which you need to be aware of.<br /><br /><!-- l --><a class="postlink-local" href="viewtopicefb5.html?f=3&amp;t=5492&amp;hilit=REPLVAR.BAT+version+1.4">viewtopic.php?f=3&amp;t=5492&amp;hilit=REPLVAR.BAT+version+1.4</a><!-- l --></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p36037" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile36037">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf147.html?author_id=3221&amp;sr=posts">6033</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Feb 2012 02:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content36037">

						<h3 ><a href="#p36037">Re: regex search and replace for batch - Easily edit files!</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting5581.html?mode=quote&amp;f=3&amp;p=36037" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicb441.html?p=36037#p36037" onclick="prompt('Message #32',this.href); return false;">#32</a></span> 
									<a class="unread" href="viewtopicb441.html?p=36037#p36037" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a></strong> &raquo; </span>28 Jul 2014 04:27
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>dbenham wrote:</cite>I've updated the original post on this thread to contain version 4.0. It now supports the N option to enable working with binary files that contain NULL bytes.<br /><br />A big thanks to penpen for <a href="viewtopic78c4.html?p=36033#p36033" class="postlink">diagnosing the problem with NULL bytes, as well as deriving a work-around.</a><br /><br /><br />Dave Benham</div></blockquote><br /><br />Thanks Dave, and a big thanks to penpen.  :thumbsup:</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p36071" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile36071">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content36071">

						<h3 ><a href="#p36071">Re: regex search and replace for batch - Easily edit files!</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinge9d5.html?mode=quote&amp;f=3&amp;p=36071" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic9f75.html?p=36071#p36071" onclick="prompt('Message #33',this.href); return false;">#33</a></span> 
									<a class="unread" href="viewtopic9f75.html?p=36071#p36071" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>30 Jul 2014 18:20
			</p>
			
			
			
			<div class="content">Yet one more change - now version 4.1<br /><br />Reading binary files works properly with any size read as long as Read() is used instead of ReadAll(). So now start reading size 1024, doubling the size each time there is more content to be read. This is a major performance enhancement.<br /><br />The N option is no longer needed so I removed it. The M option always works properly with binary files.<br /><br />Binary files containing NULL bytes should not be processed without the M option.<br /><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p37690" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile37690">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content37690">

						<h3 ><a href="#p37690">Re: regex search and replace for batch - Easily edit files!</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingb46e.html?mode=quote&amp;f=3&amp;p=37690" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopice1e8.html?p=37690#p37690" onclick="prompt('Message #34',this.href); return false;">#34</a></span> 
									<a class="unread" href="viewtopice1e8.html?p=37690#p37690" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>28 Oct 2014 15:24
			</p>
			
			
			
			<div class="content">Updated the initial post with version 5.0 - Return codes have been refined and documented.<br /><br />It is now possible to differentiate between a call that makes a change to the data, vs. a call that does not make a change, vs. a call that results in an error.<br /><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p37853" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile37853">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content37853">

						<h3 ><a href="#p37853">Re: regex search and replace for batch - Easily edit files!</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinga1f4.html?mode=quote&amp;f=3&amp;p=37853" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicc11c.html?p=37853#p37853" onclick="prompt('Message #35',this.href); return false;">#35</a></span> 
									<a class="unread" href="viewtopicc11c.html?p=37853#p37853" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>07 Nov 2014 12:27
			</p>
			
			
			
			<div class="content">I've decided to maintain a history of all versions from this point forward, in addition to keeping the most current version in the first post. So I'm posting version 5 here:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@if (@X)==(@Y) @end /* Harmless hybrid line that begins a JScript comment<br /><br />::************ Documentation ***********<br />::REPL.BAT version 5.0<br />:::<br />:::REPL&nbsp; Search&nbsp; Replace&nbsp; &#91;Options&nbsp; &#91;SourceVar&#93;&#93;<br />:::REPL&nbsp; /?&#91;REGEX|REPLACE&#93;<br />:::REPL&nbsp; /V<br />:::<br />:::&nbsp; Performs a global regular expression search and replace operation on<br />:::&nbsp; each line of input from stdin and prints the result to stdout.<br />:::<br />:::&nbsp; Each parameter may be optionally enclosed by double quotes. The double<br />:::&nbsp; quotes are not considered part of the argument. The quotes are required<br />:::&nbsp; if the parameter contains a batch token delimiter like space, tab, comma,<br />:::&nbsp; semicolon. The quotes should also be used if the argument contains a<br />:::&nbsp; batch special character like &amp;, |, etc. so that the special character<br />:::&nbsp; does not need to be escaped with ^.<br />:::<br />:::&nbsp; If called with a single argument of /?, then prints help documentation<br />:::&nbsp; to stdout. If a single argument of /?REGEX, then opens up Microsoft's<br />:::&nbsp; JScript regular expression documentation within your browser. If a single<br />:::&nbsp; argument of /?REPLACE, then opens up Microsoft's JScript REPLACE<br />:::&nbsp; documentation within your browser.<br />:::<br />:::&nbsp; If called with a single argument of /V, case insensitive, then prints<br />:::&nbsp; the version of REPL.BAT.<br />:::<br />:::&nbsp; Search&nbsp; - By default, this is a case sensitive JScript (ECMA) regular<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; expression expressed as a string.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; JScript regex syntax documentation is available at<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; http://msdn.microsoft.com/en-us/library/ae5bf541(v=vs.80).aspx<br />:::<br />:::&nbsp; Replace - By default, this is the string to be used as a replacement for<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; each found search expression. Full support is provided for<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; substituion patterns available to the JScript replace method.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; For example, $&amp; represents the portion of the source that matched<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the entire search pattern, $1 represents the first captured<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; submatch, $2 the second captured submatch, etc. A $ literal<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; can be escaped as $$.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; An empty replacement string must be represented as &quot;&quot;.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Replace substitution pattern syntax is fully documented at<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; http://msdn.microsoft.com/en-US/library/efy6s3e6(v=vs.80).aspx<br />:::<br />:::&nbsp; Options - An optional string of characters used to alter the behavior<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; of REPL. The option characters are case insensitive, and may<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appear in any order.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; I - Makes the search case-insensitive.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; L - The Search is treated as a string literal instead of a<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; regular expression. Also, all $ found in Replace are<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; treated as $ literals.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; B - The Search must match the beginning of a line.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Mostly used with literal searches.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; E - The Search must match the end of a line.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Mostly used with literal searches.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; V - Search and Replace represent the name of environment<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; variables that contain the respective values. An undefined<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; variable is treated as an empty string.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; A - Only print altered lines. Unaltered lines are discarded.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If both the M and V options are present, then prints the<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; entire result if there was a change anywhere in the string.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The A option is incompatible with the M option unless the S<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; option is also present.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; M - Multi-line mode. The entire contents of stdin is read and<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; processed in one pass instead of line by line, thus enabling<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; search for \n. This also enables preservation of the original<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; line terminators. If the M option is not present, then every<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printed line is termiated with carriage return and line feed.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The M option is incompatible with the A option unless the S<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; option is also present.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Note: If working with binary data containing NULL bytes,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; then the M option must be used.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; X - Enables extended substitution pattern syntax with support<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for the following escape sequences within the Replace string:<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \\&nbsp; &nbsp; &nbsp;-&nbsp; Backslash<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \b&nbsp; &nbsp; &nbsp;-&nbsp; Backspace<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \f&nbsp; &nbsp; &nbsp;-&nbsp; Formfeed<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \n&nbsp; &nbsp; &nbsp;-&nbsp; Newline<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \q&nbsp; &nbsp; &nbsp;-&nbsp; Quote<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \r&nbsp; &nbsp; &nbsp;-&nbsp; Carriage Return<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \t&nbsp; &nbsp; &nbsp;-&nbsp; Horizontal Tab<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \v&nbsp; &nbsp; &nbsp;-&nbsp; Vertical Tab<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \xnn&nbsp; &nbsp;-&nbsp; Extended ASCII byte code expressed as 2 hex digits<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \unnnn -&nbsp; Unicode character expressed as 4 hex digits<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Also enables the \q escape sequence for the Search string.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The other escape sequences are already standard for a regular<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; expression Search string.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Also modifies the behavior of \xnn in the Search string to work<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; properly with extended ASCII byte codes.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Extended escape sequences are supported even when the L option<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; is used. Both Search and Replace support all of the extended<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; escape sequences if both the X and L opions are combined.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; S - The source is read from an environment variable instead of<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; from stdin. The name of the source environment variable is<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; specified in the next argument after the option string. Without<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the M option, ^ anchors the beginning of the string, and $ the<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; end of the string. With the M option, ^ anchors the beginning<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; of a line, and $ the end of a line.<br />:::<br />:::&nbsp; Return Codes:&nbsp; 0 = At least one change was made<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;or the /? or /V option was used<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 = No change was made<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2 = Invalid call syntax or incompatible options<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3 = JScript runtime error, typically due to invalid regex<br />:::<br />::: REPL.BAT was written by Dave Benham, with assistance from DosTips user Aacini<br />::: to get \xnn to work properly with extended ASCII byte codes. Also assistance<br />::: from DosTips user penpen diagnosing issues reading NULL bytes, along with a<br />::: workaround. REPL.BAT was originally posted at:<br />::: http://www.dostips.com/forum/viewtopic.php?f=3&amp;t=3855<br />:::<br /><br />::************ Batch portion ***********<br />@echo off<br />if .%2 equ . (<br />&nbsp; if &quot;%~1&quot; equ &quot;/?&quot; (<br />&nbsp; &nbsp; &lt;&quot;%~f0&quot; cscript //E:JScript //nologo &quot;%~f0&quot; &quot;^:::&quot; &quot;&quot; a<br />&nbsp; &nbsp; exit /b 0<br />&nbsp; ) else if /i &quot;%~1&quot; equ &quot;/?regex&quot; (<br />&nbsp; &nbsp; explorer &quot;http://msdn.microsoft.com/en-us/library/ae5bf541(v=vs.80).aspx&quot;<br />&nbsp; &nbsp; exit /b 0<br />&nbsp; ) else if /i &quot;%~1&quot; equ &quot;/?replace&quot; (<br />&nbsp; &nbsp; explorer &quot;http://msdn.microsoft.com/en-US/library/efy6s3e6(v=vs.80).aspx&quot;<br />&nbsp; &nbsp; exit /b 0<br />&nbsp; ) else if /i &quot;%~1&quot; equ &quot;/V&quot; (<br />&nbsp; &nbsp; &lt;&quot;%~f0&quot; cscript //E:JScript //nologo &quot;%~f0&quot; &quot;^::(REPL\.BAT version)&quot; &quot;$1&quot; a<br />&nbsp; &nbsp; exit /b 0<br />&nbsp; ) else (<br />&nbsp; &nbsp; call :err &quot;Insufficient arguments&quot;<br />&nbsp; &nbsp; exit /b 2<br />&nbsp; )<br />)<br />echo(%~3|findstr /i &quot;&#91;^SMILEBVXA&#93;&quot; &gt;nul &amp;&amp; (<br />&nbsp; call :err &quot;Invalid option(s)&quot;<br />&nbsp; exit /b 2<br />)<br />echo(%~3|findstr /i &quot;M&quot;|findstr /i &quot;A&quot;|findstr /vi &quot;S&quot; &gt;nul &amp;&amp; (<br />&nbsp; call :err &quot;Incompatible options&quot;<br />&nbsp; exit /b 2<br />)<br />cscript //E:JScript //nologo &quot;%~f0&quot; %*<br />exit /b %errorlevel%<br /><br />:err<br />&gt;&amp;2 echo ERROR: %~1. Use REPL /? to get help.<br />exit /b<br /><br />************* JScript portion **********/<br />var rtn=1;<br />try {<br />&nbsp; var env=WScript.CreateObject(&quot;WScript.Shell&quot;).Environment(&quot;Process&quot;);<br />&nbsp; var args=WScript.Arguments;<br />&nbsp; var search=args.Item(0);<br />&nbsp; var replace=args.Item(1);<br />&nbsp; var options=&quot;g&quot;;<br />&nbsp; if (args.length&gt;2) options+=args.Item(2).toLowerCase();<br />&nbsp; var multi=(options.indexOf(&quot;m&quot;)&gt;=0);<br />&nbsp; var alterations=(options.indexOf(&quot;a&quot;)&gt;=0);<br />&nbsp; if (alterations) options=options.replace(/a/g,&quot;&quot;);<br />&nbsp; var srcVar=(options.indexOf(&quot;s&quot;)&gt;=0);<br />&nbsp; if (srcVar) options=options.replace(/s/g,&quot;&quot;);<br />&nbsp; if (options.indexOf(&quot;v&quot;)&gt;=0) {<br />&nbsp; &nbsp; options=options.replace(/v/g,&quot;&quot;);<br />&nbsp; &nbsp; search=env(search);<br />&nbsp; &nbsp; replace=env(replace);<br />&nbsp; }<br />&nbsp; if (options.indexOf(&quot;x&quot;)&gt;=0) {<br />&nbsp; &nbsp; options=options.replace(/x/g,&quot;&quot;);<br />&nbsp; &nbsp; replace=replace.replace(/\\\\/g,&quot;\\B&quot;);<br />&nbsp; &nbsp; replace=replace.replace(/\\q/g,&quot;\&quot;&quot;);<br />&nbsp; &nbsp; replace=replace.replace(/\\x80/g,&quot;\\u20AC&quot;);<br />&nbsp; &nbsp; replace=replace.replace(/\\x82/g,&quot;\\u201A&quot;);<br />&nbsp; &nbsp; replace=replace.replace(/\\x83/g,&quot;\\u0192&quot;);<br />&nbsp; &nbsp; replace=replace.replace(/\\x84/g,&quot;\\u201E&quot;);<br />&nbsp; &nbsp; replace=replace.replace(/\\x85/g,&quot;\\u2026&quot;);<br />&nbsp; &nbsp; replace=replace.replace(/\\x86/g,&quot;\\u2020&quot;);<br />&nbsp; &nbsp; replace=replace.replace(/\\x87/g,&quot;\\u2021&quot;);<br />&nbsp; &nbsp; replace=replace.replace(/\\x88/g,&quot;\\u02C6&quot;);<br />&nbsp; &nbsp; replace=replace.replace(/\\x89/g,&quot;\\u2030&quot;);<br />&nbsp; &nbsp; replace=replace.replace(/\\x8&#91;aA&#93;/g,&quot;\\u0160&quot;);<br />&nbsp; &nbsp; replace=replace.replace(/\\x8&#91;bB&#93;/g,&quot;\\u2039&quot;);<br />&nbsp; &nbsp; replace=replace.replace(/\\x8&#91;cC&#93;/g,&quot;\\u0152&quot;);<br />&nbsp; &nbsp; replace=replace.replace(/\\x8&#91;eE&#93;/g,&quot;\\u017D&quot;);<br />&nbsp; &nbsp; replace=replace.replace(/\\x91/g,&quot;\\u2018&quot;);<br />&nbsp; &nbsp; replace=replace.replace(/\\x92/g,&quot;\\u2019&quot;);<br />&nbsp; &nbsp; replace=replace.replace(/\\x93/g,&quot;\\u201C&quot;);<br />&nbsp; &nbsp; replace=replace.replace(/\\x94/g,&quot;\\u201D&quot;);<br />&nbsp; &nbsp; replace=replace.replace(/\\x95/g,&quot;\\u2022&quot;);<br />&nbsp; &nbsp; replace=replace.replace(/\\x96/g,&quot;\\u2013&quot;);<br />&nbsp; &nbsp; replace=replace.replace(/\\x97/g,&quot;\\u2014&quot;);<br />&nbsp; &nbsp; replace=replace.replace(/\\x98/g,&quot;\\u02DC&quot;);<br />&nbsp; &nbsp; replace=replace.replace(/\\x99/g,&quot;\\u2122&quot;);<br />&nbsp; &nbsp; replace=replace.replace(/\\x9&#91;aA&#93;/g,&quot;\\u0161&quot;);<br />&nbsp; &nbsp; replace=replace.replace(/\\x9&#91;bB&#93;/g,&quot;\\u203A&quot;);<br />&nbsp; &nbsp; replace=replace.replace(/\\x9&#91;cC&#93;/g,&quot;\\u0153&quot;);<br />&nbsp; &nbsp; replace=replace.replace(/\\x9&#91;dD&#93;/g,&quot;\\u009D&quot;);<br />&nbsp; &nbsp; replace=replace.replace(/\\x9&#91;eE&#93;/g,&quot;\\u017E&quot;);<br />&nbsp; &nbsp; replace=replace.replace(/\\x9&#91;fF&#93;/g,&quot;\\u0178&quot;);<br />&nbsp; &nbsp; replace=replace.replace(/\\b/g,&quot;\b&quot;);<br />&nbsp; &nbsp; replace=replace.replace(/\\f/g,&quot;\f&quot;);<br />&nbsp; &nbsp; replace=replace.replace(/\\n/g,&quot;\n&quot;);<br />&nbsp; &nbsp; replace=replace.replace(/\\r/g,&quot;\r&quot;);<br />&nbsp; &nbsp; replace=replace.replace(/\\t/g,&quot;\t&quot;);<br />&nbsp; &nbsp; replace=replace.replace(/\\v/g,&quot;\v&quot;);<br />&nbsp; &nbsp; replace=replace.replace(/\\x&#91;0-9a-fA-F&#93;{2}|\\u&#91;0-9a-fA-F&#93;{4}/g,<br />&nbsp; &nbsp; &nbsp; function($0,$1,$2){<br />&nbsp; &nbsp; &nbsp; &nbsp; return String.fromCharCode(parseInt(&quot;0x&quot;+$0.substring(2)));<br />&nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; );<br />&nbsp; &nbsp; replace=replace.replace(/\\B/g,&quot;\\&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\\\/g,&quot;\\B&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\q/g,&quot;\&quot;&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x80/g,&quot;\\u20AC&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x82/g,&quot;\\u201A&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x83/g,&quot;\\u0192&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x84/g,&quot;\\u201E&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x85/g,&quot;\\u2026&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x86/g,&quot;\\u2020&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x87/g,&quot;\\u2021&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x88/g,&quot;\\u02C6&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x89/g,&quot;\\u2030&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x8&#91;aA&#93;/g,&quot;\\u0160&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x8&#91;bB&#93;/g,&quot;\\u2039&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x8&#91;cC&#93;/g,&quot;\\u0152&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x8&#91;eE&#93;/g,&quot;\\u017D&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x91/g,&quot;\\u2018&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x92/g,&quot;\\u2019&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x93/g,&quot;\\u201C&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x94/g,&quot;\\u201D&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x95/g,&quot;\\u2022&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x96/g,&quot;\\u2013&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x97/g,&quot;\\u2014&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x98/g,&quot;\\u02DC&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x99/g,&quot;\\u2122&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x9&#91;aA&#93;/g,&quot;\\u0161&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x9&#91;bB&#93;/g,&quot;\\u203A&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x9&#91;cC&#93;/g,&quot;\\u0153&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x9&#91;dD&#93;/g,&quot;\\u009D&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x9&#91;eE&#93;/g,&quot;\\u017E&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x9&#91;fF&#93;/g,&quot;\\u0178&quot;);<br />&nbsp; &nbsp; if (options.indexOf(&quot;l&quot;)&gt;=0) {<br />&nbsp; &nbsp; &nbsp; search=search.replace(/\\b/g,&quot;\b&quot;);<br />&nbsp; &nbsp; &nbsp; search=search.replace(/\\f/g,&quot;\f&quot;);<br />&nbsp; &nbsp; &nbsp; search=search.replace(/\\n/g,&quot;\n&quot;);<br />&nbsp; &nbsp; &nbsp; search=search.replace(/\\r/g,&quot;\r&quot;);<br />&nbsp; &nbsp; &nbsp; search=search.replace(/\\t/g,&quot;\t&quot;);<br />&nbsp; &nbsp; &nbsp; search=search.replace(/\\v/g,&quot;\v&quot;);<br />&nbsp; &nbsp; &nbsp; search=search.replace(/\\x&#91;0-9a-fA-F&#93;{2}|\\u&#91;0-9a-fA-F&#93;{4}/g,<br />&nbsp; &nbsp; &nbsp; &nbsp; function($0,$1,$2){<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return String.fromCharCode(parseInt(&quot;0x&quot;+$0.substring(2)));<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; );<br />&nbsp; &nbsp; &nbsp; search=search.replace(/\\B/g,&quot;\\&quot;);<br />&nbsp; &nbsp; } else search=search.replace(/\\B/g,&quot;\\\\&quot;);<br />&nbsp; }<br />&nbsp; if (options.indexOf(&quot;l&quot;)&gt;=0) {<br />&nbsp; &nbsp; options=options.replace(/l/g,&quot;&quot;);<br />&nbsp; &nbsp; search=search.replace(/(&#91;.^$*+?()&#91;{\\|&#93;)/g,&quot;\\$1&quot;);<br />&nbsp; &nbsp; replace=replace.replace(/\$/g,&quot;$$$$&quot;);<br />&nbsp; }<br />&nbsp; if (options.indexOf(&quot;b&quot;)&gt;=0) {<br />&nbsp; &nbsp; options=options.replace(/b/g,&quot;&quot;);<br />&nbsp; &nbsp; search=&quot;^&quot;+search<br />&nbsp; }<br />&nbsp; if (options.indexOf(&quot;e&quot;)&gt;=0) {<br />&nbsp; &nbsp; options=options.replace(/e/g,&quot;&quot;);<br />&nbsp; &nbsp; search=search+&quot;$&quot;<br />&nbsp; }<br />&nbsp; var search=new RegExp(search,options);<br />&nbsp; var str1, str2;<br /><br />&nbsp; if (srcVar) {<br />&nbsp; &nbsp; str1=env(args.Item(3));<br />&nbsp; &nbsp; str2=str1.replace(search,replace);<br />&nbsp; &nbsp; if (!alterations || str1!=str2) if (multi) {<br />&nbsp; &nbsp; &nbsp; WScript.Stdout.Write(str2);<br />&nbsp; &nbsp; } else {<br />&nbsp; &nbsp; &nbsp; WScript.Stdout.WriteLine(str2);<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; if (str1!=str2) rtn=0;<br />&nbsp; } else if (multi){<br />&nbsp; &nbsp; var buf=1024;<br />&nbsp; &nbsp; str1=&quot;&quot;;<br />&nbsp; &nbsp; while (!WScript.StdIn.AtEndOfStream) {<br />&nbsp; &nbsp; &nbsp; str1+=WScript.StdIn.Read(buf);<br />&nbsp; &nbsp; &nbsp; buf*=2<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; str2=str1.replace(search,replace);<br />&nbsp; &nbsp; WScript.Stdout.Write(str2);<br />&nbsp; &nbsp; if (str1!=str2) rtn=0;<br />&nbsp; } else {<br />&nbsp; &nbsp; while (!WScript.StdIn.AtEndOfStream) {<br />&nbsp; &nbsp; &nbsp; str1=WScript.StdIn.ReadLine();<br />&nbsp; &nbsp; &nbsp; str2=str1.replace(search,replace);<br />&nbsp; &nbsp; &nbsp; if (!alterations || str1!=str2) WScript.Stdout.WriteLine(str2);<br />&nbsp; &nbsp; &nbsp; if (str1!=str2) rtn=0;<br />&nbsp; &nbsp; }<br />&nbsp; }<br />} catch(e) {<br />&nbsp; WScript.Stderr.WriteLine(&quot;JScript runtime error: &quot;+e.message);<br />&nbsp; rtn=3;<br />}<br />WScript.Quit(rtn);<br /></code></pre></div><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p37855" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile37855">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content37855">

						<h3 ><a href="#p37855">Re: regex search and replace for batch - Easily edit files!</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting5247.html?mode=quote&amp;f=3&amp;p=37855" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic482b.html?p=37855#p37855" onclick="prompt('Message #36',this.href); return false;">#36</a></span> 
									<a class="unread" href="viewtopic482b.html?p=37855#p37855" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>07 Nov 2014 13:27
			</p>
			
			
			
			<div class="content">Version 6 - Major new functionality <img class="smilies" src="images/smilies/icon_exclaim.gif" alt=":!:" title="Exclamation" /> <br /><br />A StackOverflow user asked if REPL.BAT could be modified to apply a function like toUpperCase() to the replacement string. See the OP's comment to my answer at <!-- m --><a class="postlink" href="http://stackoverflow.com/questions/26746983/batch-how-to-store-values-encountered-during-a-regular-expression-search-repl">http://stackoverflow.com/questions/2674 ... earch-repl</a><!-- m -->.<br /><br />I thought it should be possible given that the JScript replace method allows the replacement argument to be a function call. Then Aacini realized it could be quite easy to implement using eval(). I refined his technique to use the function's arguments object (renamed as $) to allow for variable number of captured strings.<br /><br />So version 6 adds the J option that treats the replacement argument as a JScript expression. The expression can reference the following:<br /><br />$[0] - the string that matched the full regex<br />$[1] - the first captured submatch<br />...<br />$[n] - the final captured submatch<br />$[n+1] - the offset of the match relative to the beginning of the original string<br />$[n+2] - the original string<br /><br />This new feature is really cool  <img class="smilies" src="images/smilies/icon_cool.gif" alt="8)" title="Cool" /> <br /><br />Convert text to upper case:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>echo this IS cool|repl &quot;.+&quot; &quot;$&#91;0&#93;.toUpperCase()&quot; j<br /></code></pre></div>--output--<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>THIS IS COOL<br /></code></pre></div><br />Convert all words to mixed case (init caps):<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>echo this IS cool|repl &quot;(\b.)|(.)&quot; &quot;$&#91;1&#93;?$&#91;1&#93;.toUpperCase():$&#91;2&#93;.toLowerCase()&quot; j<br /></code></pre></div>--output--<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>This Is Cool<br /></code></pre></div><br />Multiply the 3rd column in a csv by 2 if it is an integer:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>echo 5,6,9,4|repl &quot;^((?:.*?,){2})(\d+)(?=,|$)&quot; &quot;$&#91;1&#93;+$&#91;2&#93;*2&quot; j<br /></code></pre></div>--output--<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>5,6,18,4<br /></code></pre></div><br /><br />Here is version 6:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@if (@X)==(@Y) @end /* Harmless hybrid line that begins a JScript comment<br /><br />::************ Documentation ***********<br />::REPL.BAT version 6.0<br />:::<br />:::REPL&nbsp; Search&nbsp; Replace&nbsp; &#91;Options&nbsp; &#91;SourceVar&#93;&#93;<br />:::REPL&nbsp; /?&#91;REGEX|REPLACE&#93;<br />:::REPL&nbsp; /V<br />:::<br />:::&nbsp; Performs a global regular expression search and replace operation on<br />:::&nbsp; each line of input from stdin and prints the result to stdout.<br />:::<br />:::&nbsp; Each parameter may be optionally enclosed by double quotes. The double<br />:::&nbsp; quotes are not considered part of the argument. The quotes are required<br />:::&nbsp; if the parameter contains a batch token delimiter like space, tab, comma,<br />:::&nbsp; semicolon. The quotes should also be used if the argument contains a<br />:::&nbsp; batch special character like &amp;, |, etc. so that the special character<br />:::&nbsp; does not need to be escaped with ^.<br />:::<br />:::&nbsp; If called with a single argument of /?, then prints help documentation<br />:::&nbsp; to stdout. If a single argument of /?REGEX, then opens up Microsoft's<br />:::&nbsp; JScript regular expression documentation within your browser. If a single<br />:::&nbsp; argument of /?REPLACE, then opens up Microsoft's JScript REPLACE<br />:::&nbsp; documentation within your browser.<br />:::<br />:::&nbsp; If called with a single argument of /V, case insensitive, then prints<br />:::&nbsp; the version of REPL.BAT.<br />:::<br />:::&nbsp; Search&nbsp; - By default, this is a case sensitive JScript (ECMA) regular<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; expression expressed as a string.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; JScript regex syntax documentation is available at<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; http://msdn.microsoft.com/en-us/library/ae5bf541(v=vs.80).aspx<br />:::<br />:::&nbsp; Replace - By default, this is the string to be used as a replacement for<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; each found search expression. Full support is provided for<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; substituion patterns available to the JScript replace method.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; For example, $&amp; represents the portion of the source that matched<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the entire search pattern, $1 represents the first captured<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; submatch, $2 the second captured submatch, etc. A $ literal<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; can be escaped as $$.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; An empty replacement string must be represented as &quot;&quot;.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Replace substitution pattern syntax is fully documented at<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; http://msdn.microsoft.com/en-US/library/efy6s3e6(v=vs.80).aspx<br />:::<br />:::&nbsp; Options - An optional string of characters used to alter the behavior<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; of REPL. The option characters are case insensitive, and may<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appear in any order.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; A - Only print altered lines. Unaltered lines are discarded.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If both the M and S options are present, then prints the<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; entire result if there was a change anywhere in the string.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The A option is incompatible with the M option unless the S<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; option is also present.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; B - The Search must match the beginning of a line.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Mostly used with literal searches.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; E - The Search must match the end of a line.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Mostly used with literal searches.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; I - Makes the search case-insensitive.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; J - The Replace argument represents a JScript expression.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The expression may access an array like arguments object<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; named $. However, $ is not a true array object.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The $.length property contains the total number of arguments<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; available. The $.length value is equal to n+3, where n is the<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; number of capturing left parentheses within the Search string.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $&#91;0&#93; is the substring that matched the Search,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $&#91;1&#93; through $&#91;n&#93; are the captured submatch strings,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $&#91;n+1&#93; is the offset where the match occurred, and<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $&#91;n+2&#93; is the original source string.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; L - The Search is treated as a string literal instead of a<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; regular expression. Also, all $ found in the Replace string<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; are treated as $ literals.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; M - Multi-line mode. The entire contents of stdin is read and<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; processed in one pass instead of line by line, thus enabling<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; search for \n. This also enables preservation of the original<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; line terminators. If the M option is not present, then every<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printed line is terminated with carriage return and line feed.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The M option is incompatible with the A option unless the S<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; option is also present.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Note: If working with binary data containing NULL bytes,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; then the M option must be used.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; S - The source is read from an environment variable instead of<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; from stdin. The name of the source environment variable is<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; specified in the next argument after the option string. Without<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the M option, ^ anchors the beginning of the string, and $ the<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; end of the string. With the M option, ^ anchors the beginning<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; of a line, and $ the end of a line.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; V - Search and Replace represent the name of environment<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; variables that contain the respective values. An undefined<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; variable is treated as an empty string.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; X - Enables extended substitution pattern syntax with support<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for the following escape sequences within the Replace string:<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \\&nbsp; &nbsp; &nbsp;-&nbsp; Backslash<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \b&nbsp; &nbsp; &nbsp;-&nbsp; Backspace<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \f&nbsp; &nbsp; &nbsp;-&nbsp; Formfeed<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \n&nbsp; &nbsp; &nbsp;-&nbsp; Newline<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \q&nbsp; &nbsp; &nbsp;-&nbsp; Quote<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \r&nbsp; &nbsp; &nbsp;-&nbsp; Carriage Return<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \t&nbsp; &nbsp; &nbsp;-&nbsp; Horizontal Tab<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \v&nbsp; &nbsp; &nbsp;-&nbsp; Vertical Tab<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \xnn&nbsp; &nbsp;-&nbsp; Extended ASCII byte code expressed as 2 hex digits<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \unnnn -&nbsp; Unicode character expressed as 4 hex digits<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Also enables the \q escape sequence for the Search string.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The other escape sequences are already standard for a regular<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; expression Search string.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Also modifies the behavior of \xnn in the Search string to work<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; properly with extended ASCII byte codes.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Extended escape sequences are supported even when the L option<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; is used. Both Search and Replace support all of the extended<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; escape sequences if both the X and L opions are combined.<br />:::<br />:::&nbsp; Return Codes:&nbsp; 0 = At least one change was made<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;or the /? or /V option was used<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 = No change was made<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2 = Invalid call syntax or incompatible options<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3 = JScript runtime error, typically due to invalid regex<br />:::<br />::: REPL.BAT was written by Dave Benham, with assistance from DosTips user Aacini<br />::: to get \xnn to work properly with extended ASCII byte codes. Also assistance<br />::: from DosTips user penpen diagnosing issues reading NULL bytes, along with a<br />::: workaround. REPL.BAT was originally posted at:<br />::: http://www.dostips.com/forum/viewtopic.php?f=3&amp;t=3855<br />:::<br /><br />::************ Batch portion ***********<br />@echo off<br />if .%2 equ . (<br />&nbsp; if &quot;%~1&quot; equ &quot;/?&quot; (<br />&nbsp; &nbsp; &lt;&quot;%~f0&quot; cscript //E:JScript //nologo &quot;%~f0&quot; &quot;^:::&quot; &quot;&quot; a<br />&nbsp; &nbsp; exit /b 0<br />&nbsp; ) else if /i &quot;%~1&quot; equ &quot;/?regex&quot; (<br />&nbsp; &nbsp; explorer &quot;http://msdn.microsoft.com/en-us/library/ae5bf541(v=vs.80).aspx&quot;<br />&nbsp; &nbsp; exit /b 0<br />&nbsp; ) else if /i &quot;%~1&quot; equ &quot;/?replace&quot; (<br />&nbsp; &nbsp; explorer &quot;http://msdn.microsoft.com/en-US/library/efy6s3e6(v=vs.80).aspx&quot;<br />&nbsp; &nbsp; exit /b 0<br />&nbsp; ) else if /i &quot;%~1&quot; equ &quot;/V&quot; (<br />&nbsp; &nbsp; &lt;&quot;%~f0&quot; cscript //E:JScript //nologo &quot;%~f0&quot; &quot;^::(REPL\.BAT version)&quot; &quot;$1&quot; a<br />&nbsp; &nbsp; exit /b 0<br />&nbsp; ) else (<br />&nbsp; &nbsp; call :err &quot;Insufficient arguments&quot;<br />&nbsp; &nbsp; exit /b 2<br />&nbsp; )<br />)<br />echo(%~3|findstr /i &quot;&#91;^SMILEBVXAJ&#93;&quot; &gt;nul &amp;&amp; (<br />&nbsp; call :err &quot;Invalid option(s)&quot;<br />&nbsp; exit /b 2<br />)<br />echo(%~3|findstr /i &quot;M&quot;|findstr /i &quot;A&quot;|findstr /vi &quot;S&quot; &gt;nul &amp;&amp; (<br />&nbsp; call :err &quot;Incompatible options&quot;<br />&nbsp; exit /b 2<br />)<br />cscript //E:JScript //nologo &quot;%~f0&quot; %*<br />exit /b %errorlevel%<br /><br />:err<br />&gt;&amp;2 echo ERROR: %~1. Use REPL /? to get help.<br />exit /b<br /><br />************* JScript portion **********/<br />var rtn=1;<br />try {<br />&nbsp; var env=WScript.CreateObject(&quot;WScript.Shell&quot;).Environment(&quot;Process&quot;);<br />&nbsp; var args=WScript.Arguments;<br />&nbsp; var search=args.Item(0);<br />&nbsp; var replace=args.Item(1);<br />&nbsp; var options=&quot;g&quot;;<br />&nbsp; if (args.length&gt;2) options+=args.Item(2).toLowerCase();<br />&nbsp; var multi=(options.indexOf(&quot;m&quot;)&gt;=0);<br />&nbsp; var alterations=(options.indexOf(&quot;a&quot;)&gt;=0);<br />&nbsp; if (alterations) options=options.replace(/a/g,&quot;&quot;);<br />&nbsp; var srcVar=(options.indexOf(&quot;s&quot;)&gt;=0);<br />&nbsp; if (srcVar) options=options.replace(/s/g,&quot;&quot;);<br />&nbsp; var jexpr=(options.indexOf(&quot;j&quot;)&gt;=0);<br />&nbsp; if (jexpr) options=options.replace(/j/g,&quot;&quot;);<br />&nbsp; if (options.indexOf(&quot;v&quot;)&gt;=0) {<br />&nbsp; &nbsp; options=options.replace(/v/g,&quot;&quot;);<br />&nbsp; &nbsp; search=env(search);<br />&nbsp; &nbsp; replace=env(replace);<br />&nbsp; }<br />&nbsp; if (options.indexOf(&quot;x&quot;)&gt;=0) {<br />&nbsp; &nbsp; options=options.replace(/x/g,&quot;&quot;);<br />&nbsp; &nbsp; if (!jexpr) {<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\\\/g,&quot;\\B&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\q/g,&quot;\&quot;&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x80/g,&quot;\\u20AC&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x82/g,&quot;\\u201A&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x83/g,&quot;\\u0192&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x84/g,&quot;\\u201E&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x85/g,&quot;\\u2026&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x86/g,&quot;\\u2020&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x87/g,&quot;\\u2021&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x88/g,&quot;\\u02C6&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x89/g,&quot;\\u2030&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x8&#91;aA&#93;/g,&quot;\\u0160&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x8&#91;bB&#93;/g,&quot;\\u2039&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x8&#91;cC&#93;/g,&quot;\\u0152&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x8&#91;eE&#93;/g,&quot;\\u017D&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x91/g,&quot;\\u2018&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x92/g,&quot;\\u2019&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x93/g,&quot;\\u201C&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x94/g,&quot;\\u201D&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x95/g,&quot;\\u2022&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x96/g,&quot;\\u2013&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x97/g,&quot;\\u2014&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x98/g,&quot;\\u02DC&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x99/g,&quot;\\u2122&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x9&#91;aA&#93;/g,&quot;\\u0161&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x9&#91;bB&#93;/g,&quot;\\u203A&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x9&#91;cC&#93;/g,&quot;\\u0153&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x9&#91;dD&#93;/g,&quot;\\u009D&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x9&#91;eE&#93;/g,&quot;\\u017E&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x9&#91;fF&#93;/g,&quot;\\u0178&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\b/g,&quot;\b&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\f/g,&quot;\f&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\n/g,&quot;\n&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\r/g,&quot;\r&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\t/g,&quot;\t&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\v/g,&quot;\v&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x&#91;0-9a-fA-F&#93;{2}|\\u&#91;0-9a-fA-F&#93;{4}/g,<br />&nbsp; &nbsp; &nbsp; &nbsp; function($0,$1,$2){<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return String.fromCharCode(parseInt(&quot;0x&quot;+$0.substring(2)));<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; );<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\B/g,&quot;\\&quot;);<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; search=search.replace(/\\\\/g,&quot;\\B&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\q/g,&quot;\&quot;&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x80/g,&quot;\\u20AC&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x82/g,&quot;\\u201A&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x83/g,&quot;\\u0192&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x84/g,&quot;\\u201E&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x85/g,&quot;\\u2026&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x86/g,&quot;\\u2020&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x87/g,&quot;\\u2021&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x88/g,&quot;\\u02C6&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x89/g,&quot;\\u2030&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x8&#91;aA&#93;/g,&quot;\\u0160&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x8&#91;bB&#93;/g,&quot;\\u2039&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x8&#91;cC&#93;/g,&quot;\\u0152&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x8&#91;eE&#93;/g,&quot;\\u017D&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x91/g,&quot;\\u2018&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x92/g,&quot;\\u2019&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x93/g,&quot;\\u201C&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x94/g,&quot;\\u201D&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x95/g,&quot;\\u2022&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x96/g,&quot;\\u2013&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x97/g,&quot;\\u2014&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x98/g,&quot;\\u02DC&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x99/g,&quot;\\u2122&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x9&#91;aA&#93;/g,&quot;\\u0161&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x9&#91;bB&#93;/g,&quot;\\u203A&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x9&#91;cC&#93;/g,&quot;\\u0153&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x9&#91;dD&#93;/g,&quot;\\u009D&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x9&#91;eE&#93;/g,&quot;\\u017E&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x9&#91;fF&#93;/g,&quot;\\u0178&quot;);<br />&nbsp; &nbsp; if (options.indexOf(&quot;l&quot;)&gt;=0) {<br />&nbsp; &nbsp; &nbsp; search=search.replace(/\\b/g,&quot;\b&quot;);<br />&nbsp; &nbsp; &nbsp; search=search.replace(/\\f/g,&quot;\f&quot;);<br />&nbsp; &nbsp; &nbsp; search=search.replace(/\\n/g,&quot;\n&quot;);<br />&nbsp; &nbsp; &nbsp; search=search.replace(/\\r/g,&quot;\r&quot;);<br />&nbsp; &nbsp; &nbsp; search=search.replace(/\\t/g,&quot;\t&quot;);<br />&nbsp; &nbsp; &nbsp; search=search.replace(/\\v/g,&quot;\v&quot;);<br />&nbsp; &nbsp; &nbsp; search=search.replace(/\\x&#91;0-9a-fA-F&#93;{2}|\\u&#91;0-9a-fA-F&#93;{4}/g,<br />&nbsp; &nbsp; &nbsp; &nbsp; function($0,$1,$2){<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return String.fromCharCode(parseInt(&quot;0x&quot;+$0.substring(2)));<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; );<br />&nbsp; &nbsp; &nbsp; search=search.replace(/\\B/g,&quot;\\&quot;);<br />&nbsp; &nbsp; } else search=search.replace(/\\B/g,&quot;\\\\&quot;);<br />&nbsp; }<br />&nbsp; if (options.indexOf(&quot;l&quot;)&gt;=0) {<br />&nbsp; &nbsp; options=options.replace(/l/g,&quot;&quot;);<br />&nbsp; &nbsp; search=search.replace(/(&#91;.^$*+?()&#91;{\\|&#93;)/g,&quot;\\$1&quot;);<br />&nbsp; &nbsp; replace=replace.replace(/\$/g,&quot;$$$$&quot;);<br />&nbsp; }<br />&nbsp; if (options.indexOf(&quot;b&quot;)&gt;=0) {<br />&nbsp; &nbsp; options=options.replace(/b/g,&quot;&quot;);<br />&nbsp; &nbsp; search=&quot;^&quot;+search<br />&nbsp; }<br />&nbsp; if (options.indexOf(&quot;e&quot;)&gt;=0) {<br />&nbsp; &nbsp; options=options.replace(/e/g,&quot;&quot;);<br />&nbsp; &nbsp; search=search+&quot;$&quot;<br />&nbsp; }<br />&nbsp; var search=new RegExp(search,options);<br />&nbsp; var str1, str2;<br /><br />&nbsp; if (srcVar) {<br />&nbsp; &nbsp; str1=env(args.Item(3));<br />&nbsp; &nbsp; str2=str1.replace(search,jexpr?replFunc:replace);<br />&nbsp; &nbsp; if (!alterations || str1!=str2) if (multi) {<br />&nbsp; &nbsp; &nbsp; WScript.Stdout.Write(str2);<br />&nbsp; &nbsp; } else {<br />&nbsp; &nbsp; &nbsp; WScript.Stdout.WriteLine(str2);<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; if (str1!=str2) rtn=0;<br />&nbsp; } else if (multi){<br />&nbsp; &nbsp; var buf=1024;<br />&nbsp; &nbsp; str1=&quot;&quot;;<br />&nbsp; &nbsp; while (!WScript.StdIn.AtEndOfStream) {<br />&nbsp; &nbsp; &nbsp; str1+=WScript.StdIn.Read(buf);<br />&nbsp; &nbsp; &nbsp; buf*=2<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; str2=str1.replace(search,jexpr?replFunc:replace);<br />&nbsp; &nbsp; WScript.Stdout.Write(str2);<br />&nbsp; &nbsp; if (str1!=str2) rtn=0;<br />&nbsp; } else {<br />&nbsp; &nbsp; while (!WScript.StdIn.AtEndOfStream) {<br />&nbsp; &nbsp; &nbsp; str1=WScript.StdIn.ReadLine();<br />&nbsp; &nbsp; &nbsp; str2=str1.replace(search,jexpr?replFunc:replace);<br />&nbsp; &nbsp; &nbsp; if (!alterations || str1!=str2) WScript.Stdout.WriteLine(str2);<br />&nbsp; &nbsp; &nbsp; if (str1!=str2) rtn=0;<br />&nbsp; &nbsp; }<br />&nbsp; }<br />} catch(e) {<br />&nbsp; WScript.Stderr.WriteLine(&quot;JScript runtime error: &quot;+e.message);<br />&nbsp; rtn=3;<br />}<br />WScript.Quit(rtn);<br /><br />function replFunc() {<br />&nbsp; var $=arguments;<br />&nbsp; return(eval(replace));<br />}<br /></code></pre></div><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p37856" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile37856">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchdc63.html?author_id=2923&amp;sr=posts">1540</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 06 Dec 2011 22:15</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> México City, México</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content37856">

						<h3 ><a href="#p37856">Re: regex search and replace for batch - Easily edit files!</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting21a4.html?mode=quote&amp;f=3&amp;p=37856" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic0d26.html?p=37856#p37856" onclick="prompt('Message #37',this.href); return false;">#37</a></span> 
									<a class="unread" href="viewtopic0d26.html?p=37856#p37856" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a></strong> &raquo; </span>07 Nov 2014 14:11
			</p>
			
			
			
			<div class="content">Pretty cool! <img class="smilies" src="images/smilies/icon_cool.gif" alt="8)" title="Cool" /> <br /><br />Why did you converted function's arguments into an array? You may directly use function arguments as in <a href="http://stackoverflow.com/questions/26746983/batch-how-to-store-values-encountered-during-a-regular-expression-search-repl/26748632#26748632" class="postlink">my original code</a>. The only drawback is to declare enough number of parameters in order to accomodate the maximum number of subexpressions used. For example:<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>fileContents.replace(search,JSexpr?function($0,$1,$2,$3,$4,$5,$6,$7){return(eval(replace))}:replace));<br /></code></pre></div><br />This point allows to write a cleaner replacement expression without all those square braquets. I like the next example! <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /> <br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>C:\&gt; echo this IS cool| &quot;FindRepl Modified.bat&quot; &quot;(\b.)|(.)&quot; &quot;$1?$1.toUpperCase():$2.toLowerCase()&quot; /J<br />This Is Cool<br /></code></pre></div><br />Antonio</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p37857" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile37857">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content37857">

						<h3 ><a href="#p37857">Re: regex search and replace for batch - Easily edit files!</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting9ea7.html?mode=quote&amp;f=3&amp;p=37857" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic3164.html?p=37857#p37857" onclick="prompt('Message #38',this.href); return false;">#38</a></span> 
									<a class="unread" href="viewtopic3164.html?p=37857#p37857" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>07 Nov 2014 16:08
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>Aacini wrote:</cite>Pretty cool! <img class="smilies" src="images/smilies/icon_cool.gif" alt="8)" title="Cool" /> <br /><br />Why did you converted function's arguments into an array? You may directly use function arguments as in <a href="http://stackoverflow.com/questions/26746983/batch-how-to-store-values-encountered-during-a-regular-expression-search-repl/26748632#26748632" class="postlink">my original code</a>. <strong class="text-strong">The only drawback is to declare enough number of parameters in order to accomodate the maximum number of subexpressions used.</strong></div></blockquote><br />The bolded quote is exactly why - I don't want to guess how many captured submatches I should allow.<br /><br />I find it humorous that when dealing with batch environment variable &quot;arrays&quot;, I use var1 or var.1 without any brackets, precisely because they are &quot;pesky&quot;, and they are not needed. Yet you seem to always use var[1]. You don't seem to mind the &quot;pesky&quot; square brackets in that context. <img class="smilies" src="images/smilies/icon_lol.gif" alt=":lol:" title="Laughing" /><br /><br />But in this JScript context our perspectives are reversed, except I think there is a very good reason for sticking with the square brackets - to guarantee I can access all of the arguments.<br /><br />I suppose I could define arguments $1 through $N, and the user could use them, and revert to $[M] for M values greater than N.<br /><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p37858" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile37858">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content37858">

						<h3 ><a href="#p37858">Re: regex search and replace for batch - Easily edit files!</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting32ba.html?mode=quote&amp;f=3&amp;p=37858" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic000f-2.html?p=37858#p37858" onclick="prompt('Message #39',this.href); return false;">#39</a></span> 
									<a class="unread" href="viewtopic000f-2.html?p=37858#p37858" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>07 Nov 2014 16:27
			</p>
			
			
			
			<div class="content">Here is version 6.1 that gives the best of both worlds. You can use $0 - $10 for arguments $[0] - $[10]. Square brackets must be used for arguments above 10.<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@if (@X)==(@Y) @end /* Harmless hybrid line that begins a JScript comment<br /><br />::************ Documentation ***********<br />::REPL.BAT version 6.1<br />:::<br />:::REPL&nbsp; Search&nbsp; Replace&nbsp; &#91;Options&nbsp; &#91;SourceVar&#93;&#93;<br />:::REPL&nbsp; /?&#91;REGEX|REPLACE&#93;<br />:::REPL&nbsp; /V<br />:::<br />:::&nbsp; Performs a global regular expression search and replace operation on<br />:::&nbsp; each line of input from stdin and prints the result to stdout.<br />:::<br />:::&nbsp; Each parameter may be optionally enclosed by double quotes. The double<br />:::&nbsp; quotes are not considered part of the argument. The quotes are required<br />:::&nbsp; if the parameter contains a batch token delimiter like space, tab, comma,<br />:::&nbsp; semicolon. The quotes should also be used if the argument contains a<br />:::&nbsp; batch special character like &amp;, |, etc. so that the special character<br />:::&nbsp; does not need to be escaped with ^.<br />:::<br />:::&nbsp; If called with a single argument of /?, then prints help documentation<br />:::&nbsp; to stdout. If a single argument of /?REGEX, then opens up Microsoft's<br />:::&nbsp; JScript regular expression documentation within your browser. If a single<br />:::&nbsp; argument of /?REPLACE, then opens up Microsoft's JScript REPLACE<br />:::&nbsp; documentation within your browser.<br />:::<br />:::&nbsp; If called with a single argument of /V, case insensitive, then prints<br />:::&nbsp; the version of REPL.BAT.<br />:::<br />:::&nbsp; Search&nbsp; - By default, this is a case sensitive JScript (ECMA) regular<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; expression expressed as a string.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; JScript regex syntax documentation is available at<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; http://msdn.microsoft.com/en-us/library/ae5bf541(v=vs.80).aspx<br />:::<br />:::&nbsp; Replace - By default, this is the string to be used as a replacement for<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; each found search expression. Full support is provided for<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; substituion patterns available to the JScript replace method.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; For example, $&amp; represents the portion of the source that matched<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the entire search pattern, $1 represents the first captured<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; submatch, $2 the second captured submatch, etc. A $ literal<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; can be escaped as $$.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; An empty replacement string must be represented as &quot;&quot;.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Replace substitution pattern syntax is fully documented at<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; http://msdn.microsoft.com/en-US/library/efy6s3e6(v=vs.80).aspx<br />:::<br />:::&nbsp; Options - An optional string of characters used to alter the behavior<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; of REPL. The option characters are case insensitive, and may<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appear in any order.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; A - Only print altered lines. Unaltered lines are discarded.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If both the M and S options are present, then prints the<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; entire result if there was a change anywhere in the string.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The A option is incompatible with the M option unless the S<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; option is also present.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; B - The Search must match the beginning of a line.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Mostly used with literal searches.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; E - The Search must match the end of a line.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Mostly used with literal searches.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; I - Makes the search case-insensitive.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; J - The Replace argument represents a JScript expression.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The expression may access an array like arguments object<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; named $. However, $ is not a true array object.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The $.length property contains the total number of arguments<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; available. The $.length value is equal to n+3, where n is the<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; number of capturing left parentheses within the Search string.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $&#91;0&#93; is the substring that matched the Search,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $&#91;1&#93; through $&#91;n&#93; are the captured submatch strings,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $&#91;n+1&#93; is the offset where the match occurred, and<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $&#91;n+2&#93; is the original source string.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Arguments $&#91;0&#93; through $&#91;10&#93; may be abbreviated as<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $1 through $10. Argument $&#91;11&#93; and above must use the square<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bracket notation.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; L - The Search is treated as a string literal instead of a<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; regular expression. Also, all $ found in the Replace string<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; are treated as $ literals.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; M - Multi-line mode. The entire contents of stdin is read and<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; processed in one pass instead of line by line, thus enabling<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; search for \n. This also enables preservation of the original<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; line terminators. If the M option is not present, then every<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printed line is terminated with carriage return and line feed.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The M option is incompatible with the A option unless the S<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; option is also present.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Note: If working with binary data containing NULL bytes,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; then the M option must be used.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; S - The source is read from an environment variable instead of<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; from stdin. The name of the source environment variable is<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; specified in the next argument after the option string. Without<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the M option, ^ anchors the beginning of the string, and $ the<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; end of the string. With the M option, ^ anchors the beginning<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; of a line, and $ the end of a line.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; V - Search and Replace represent the name of environment<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; variables that contain the respective values. An undefined<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; variable is treated as an empty string.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; X - Enables extended substitution pattern syntax with support<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for the following escape sequences within the Replace string:<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \\&nbsp; &nbsp; &nbsp;-&nbsp; Backslash<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \b&nbsp; &nbsp; &nbsp;-&nbsp; Backspace<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \f&nbsp; &nbsp; &nbsp;-&nbsp; Formfeed<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \n&nbsp; &nbsp; &nbsp;-&nbsp; Newline<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \q&nbsp; &nbsp; &nbsp;-&nbsp; Quote<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \r&nbsp; &nbsp; &nbsp;-&nbsp; Carriage Return<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \t&nbsp; &nbsp; &nbsp;-&nbsp; Horizontal Tab<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \v&nbsp; &nbsp; &nbsp;-&nbsp; Vertical Tab<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \xnn&nbsp; &nbsp;-&nbsp; Extended ASCII byte code expressed as 2 hex digits<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \unnnn -&nbsp; Unicode character expressed as 4 hex digits<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Also enables the \q escape sequence for the Search string.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The other escape sequences are already standard for a regular<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; expression Search string.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Also modifies the behavior of \xnn in the Search string to work<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; properly with extended ASCII byte codes.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Extended escape sequences are supported even when the L option<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; is used. Both Search and Replace support all of the extended<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; escape sequences if both the X and L opions are combined.<br />:::<br />:::&nbsp; Return Codes:&nbsp; 0 = At least one change was made<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;or the /? or /V option was used<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 = No change was made<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2 = Invalid call syntax or incompatible options<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3 = JScript runtime error, typically due to invalid regex<br />:::<br />::: REPL.BAT was written by Dave Benham, with assistance from DosTips user Aacini<br />::: to get \xnn to work properly with extended ASCII byte codes. Also assistance<br />::: from DosTips user penpen diagnosing issues reading NULL bytes, along with a<br />::: workaround. REPL.BAT was originally posted at:<br />::: http://www.dostips.com/forum/viewtopic.php?f=3&amp;t=3855<br />:::<br /><br />::************ Batch portion ***********<br />@echo off<br />if .%2 equ . (<br />&nbsp; if &quot;%~1&quot; equ &quot;/?&quot; (<br />&nbsp; &nbsp; &lt;&quot;%~f0&quot; cscript //E:JScript //nologo &quot;%~f0&quot; &quot;^:::&quot; &quot;&quot; a<br />&nbsp; &nbsp; exit /b 0<br />&nbsp; ) else if /i &quot;%~1&quot; equ &quot;/?regex&quot; (<br />&nbsp; &nbsp; explorer &quot;http://msdn.microsoft.com/en-us/library/ae5bf541(v=vs.80).aspx&quot;<br />&nbsp; &nbsp; exit /b 0<br />&nbsp; ) else if /i &quot;%~1&quot; equ &quot;/?replace&quot; (<br />&nbsp; &nbsp; explorer &quot;http://msdn.microsoft.com/en-US/library/efy6s3e6(v=vs.80).aspx&quot;<br />&nbsp; &nbsp; exit /b 0<br />&nbsp; ) else if /i &quot;%~1&quot; equ &quot;/V&quot; (<br />&nbsp; &nbsp; &lt;&quot;%~f0&quot; cscript //E:JScript //nologo &quot;%~f0&quot; &quot;^::(REPL\.BAT version)&quot; &quot;$1&quot; a<br />&nbsp; &nbsp; exit /b 0<br />&nbsp; ) else (<br />&nbsp; &nbsp; call :err &quot;Insufficient arguments&quot;<br />&nbsp; &nbsp; exit /b 2<br />&nbsp; )<br />)<br />echo(%~3|findstr /i &quot;&#91;^SMILEBVXAJ&#93;&quot; &gt;nul &amp;&amp; (<br />&nbsp; call :err &quot;Invalid option(s)&quot;<br />&nbsp; exit /b 2<br />)<br />echo(%~3|findstr /i &quot;M&quot;|findstr /i &quot;A&quot;|findstr /vi &quot;S&quot; &gt;nul &amp;&amp; (<br />&nbsp; call :err &quot;Incompatible options&quot;<br />&nbsp; exit /b 2<br />)<br />cscript //E:JScript //nologo &quot;%~f0&quot; %*<br />exit /b %errorlevel%<br /><br />:err<br />&gt;&amp;2 echo ERROR: %~1. Use REPL /? to get help.<br />exit /b<br /><br />************* JScript portion **********/<br />var rtn=1;<br />try {<br />&nbsp; var env=WScript.CreateObject(&quot;WScript.Shell&quot;).Environment(&quot;Process&quot;);<br />&nbsp; var args=WScript.Arguments;<br />&nbsp; var search=args.Item(0);<br />&nbsp; var replace=args.Item(1);<br />&nbsp; var options=&quot;g&quot;;<br />&nbsp; if (args.length&gt;2) options+=args.Item(2).toLowerCase();<br />&nbsp; var multi=(options.indexOf(&quot;m&quot;)&gt;=0);<br />&nbsp; var alterations=(options.indexOf(&quot;a&quot;)&gt;=0);<br />&nbsp; if (alterations) options=options.replace(/a/g,&quot;&quot;);<br />&nbsp; var srcVar=(options.indexOf(&quot;s&quot;)&gt;=0);<br />&nbsp; if (srcVar) options=options.replace(/s/g,&quot;&quot;);<br />&nbsp; var jexpr=(options.indexOf(&quot;j&quot;)&gt;=0);<br />&nbsp; if (jexpr) options=options.replace(/j/g,&quot;&quot;);<br />&nbsp; if (options.indexOf(&quot;v&quot;)&gt;=0) {<br />&nbsp; &nbsp; options=options.replace(/v/g,&quot;&quot;);<br />&nbsp; &nbsp; search=env(search);<br />&nbsp; &nbsp; replace=env(replace);<br />&nbsp; }<br />&nbsp; if (options.indexOf(&quot;x&quot;)&gt;=0) {<br />&nbsp; &nbsp; options=options.replace(/x/g,&quot;&quot;);<br />&nbsp; &nbsp; if (!jexpr) {<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\\\/g,&quot;\\B&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\q/g,&quot;\&quot;&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x80/g,&quot;\\u20AC&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x82/g,&quot;\\u201A&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x83/g,&quot;\\u0192&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x84/g,&quot;\\u201E&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x85/g,&quot;\\u2026&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x86/g,&quot;\\u2020&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x87/g,&quot;\\u2021&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x88/g,&quot;\\u02C6&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x89/g,&quot;\\u2030&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x8&#91;aA&#93;/g,&quot;\\u0160&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x8&#91;bB&#93;/g,&quot;\\u2039&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x8&#91;cC&#93;/g,&quot;\\u0152&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x8&#91;eE&#93;/g,&quot;\\u017D&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x91/g,&quot;\\u2018&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x92/g,&quot;\\u2019&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x93/g,&quot;\\u201C&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x94/g,&quot;\\u201D&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x95/g,&quot;\\u2022&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x96/g,&quot;\\u2013&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x97/g,&quot;\\u2014&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x98/g,&quot;\\u02DC&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x99/g,&quot;\\u2122&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x9&#91;aA&#93;/g,&quot;\\u0161&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x9&#91;bB&#93;/g,&quot;\\u203A&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x9&#91;cC&#93;/g,&quot;\\u0153&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x9&#91;dD&#93;/g,&quot;\\u009D&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x9&#91;eE&#93;/g,&quot;\\u017E&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x9&#91;fF&#93;/g,&quot;\\u0178&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\b/g,&quot;\b&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\f/g,&quot;\f&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\n/g,&quot;\n&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\r/g,&quot;\r&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\t/g,&quot;\t&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\v/g,&quot;\v&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x&#91;0-9a-fA-F&#93;{2}|\\u&#91;0-9a-fA-F&#93;{4}/g,<br />&nbsp; &nbsp; &nbsp; &nbsp; function($0,$1,$2){<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return String.fromCharCode(parseInt(&quot;0x&quot;+$0.substring(2)));<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; );<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\B/g,&quot;\\&quot;);<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; search=search.replace(/\\\\/g,&quot;\\B&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\q/g,&quot;\&quot;&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x80/g,&quot;\\u20AC&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x82/g,&quot;\\u201A&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x83/g,&quot;\\u0192&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x84/g,&quot;\\u201E&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x85/g,&quot;\\u2026&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x86/g,&quot;\\u2020&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x87/g,&quot;\\u2021&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x88/g,&quot;\\u02C6&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x89/g,&quot;\\u2030&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x8&#91;aA&#93;/g,&quot;\\u0160&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x8&#91;bB&#93;/g,&quot;\\u2039&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x8&#91;cC&#93;/g,&quot;\\u0152&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x8&#91;eE&#93;/g,&quot;\\u017D&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x91/g,&quot;\\u2018&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x92/g,&quot;\\u2019&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x93/g,&quot;\\u201C&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x94/g,&quot;\\u201D&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x95/g,&quot;\\u2022&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x96/g,&quot;\\u2013&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x97/g,&quot;\\u2014&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x98/g,&quot;\\u02DC&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x99/g,&quot;\\u2122&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x9&#91;aA&#93;/g,&quot;\\u0161&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x9&#91;bB&#93;/g,&quot;\\u203A&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x9&#91;cC&#93;/g,&quot;\\u0153&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x9&#91;dD&#93;/g,&quot;\\u009D&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x9&#91;eE&#93;/g,&quot;\\u017E&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x9&#91;fF&#93;/g,&quot;\\u0178&quot;);<br />&nbsp; &nbsp; if (options.indexOf(&quot;l&quot;)&gt;=0) {<br />&nbsp; &nbsp; &nbsp; search=search.replace(/\\b/g,&quot;\b&quot;);<br />&nbsp; &nbsp; &nbsp; search=search.replace(/\\f/g,&quot;\f&quot;);<br />&nbsp; &nbsp; &nbsp; search=search.replace(/\\n/g,&quot;\n&quot;);<br />&nbsp; &nbsp; &nbsp; search=search.replace(/\\r/g,&quot;\r&quot;);<br />&nbsp; &nbsp; &nbsp; search=search.replace(/\\t/g,&quot;\t&quot;);<br />&nbsp; &nbsp; &nbsp; search=search.replace(/\\v/g,&quot;\v&quot;);<br />&nbsp; &nbsp; &nbsp; search=search.replace(/\\x&#91;0-9a-fA-F&#93;{2}|\\u&#91;0-9a-fA-F&#93;{4}/g,<br />&nbsp; &nbsp; &nbsp; &nbsp; function($0,$1,$2){<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return String.fromCharCode(parseInt(&quot;0x&quot;+$0.substring(2)));<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; );<br />&nbsp; &nbsp; &nbsp; search=search.replace(/\\B/g,&quot;\\&quot;);<br />&nbsp; &nbsp; } else search=search.replace(/\\B/g,&quot;\\\\&quot;);<br />&nbsp; }<br />&nbsp; if (options.indexOf(&quot;l&quot;)&gt;=0) {<br />&nbsp; &nbsp; options=options.replace(/l/g,&quot;&quot;);<br />&nbsp; &nbsp; search=search.replace(/(&#91;.^$*+?()&#91;{\\|&#93;)/g,&quot;\\$1&quot;);<br />&nbsp; &nbsp; replace=replace.replace(/\$/g,&quot;$$$$&quot;);<br />&nbsp; }<br />&nbsp; if (options.indexOf(&quot;b&quot;)&gt;=0) {<br />&nbsp; &nbsp; options=options.replace(/b/g,&quot;&quot;);<br />&nbsp; &nbsp; search=&quot;^&quot;+search<br />&nbsp; }<br />&nbsp; if (options.indexOf(&quot;e&quot;)&gt;=0) {<br />&nbsp; &nbsp; options=options.replace(/e/g,&quot;&quot;);<br />&nbsp; &nbsp; search=search+&quot;$&quot;<br />&nbsp; }<br />&nbsp; var search=new RegExp(search,options);<br />&nbsp; var str1, str2;<br /><br />&nbsp; if (srcVar) {<br />&nbsp; &nbsp; str1=env(args.Item(3));<br />&nbsp; &nbsp; str2=str1.replace(search,jexpr?replFunc:replace);<br />&nbsp; &nbsp; if (!alterations || str1!=str2) if (multi) {<br />&nbsp; &nbsp; &nbsp; WScript.Stdout.Write(str2);<br />&nbsp; &nbsp; } else {<br />&nbsp; &nbsp; &nbsp; WScript.Stdout.WriteLine(str2);<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; if (str1!=str2) rtn=0;<br />&nbsp; } else if (multi){<br />&nbsp; &nbsp; var buf=1024;<br />&nbsp; &nbsp; str1=&quot;&quot;;<br />&nbsp; &nbsp; while (!WScript.StdIn.AtEndOfStream) {<br />&nbsp; &nbsp; &nbsp; str1+=WScript.StdIn.Read(buf);<br />&nbsp; &nbsp; &nbsp; buf*=2<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; str2=str1.replace(search,jexpr?replFunc:replace);<br />&nbsp; &nbsp; WScript.Stdout.Write(str2);<br />&nbsp; &nbsp; if (str1!=str2) rtn=0;<br />&nbsp; } else {<br />&nbsp; &nbsp; while (!WScript.StdIn.AtEndOfStream) {<br />&nbsp; &nbsp; &nbsp; str1=WScript.StdIn.ReadLine();<br />&nbsp; &nbsp; &nbsp; str2=str1.replace(search,jexpr?replFunc:replace);<br />&nbsp; &nbsp; &nbsp; if (!alterations || str1!=str2) WScript.Stdout.WriteLine(str2);<br />&nbsp; &nbsp; &nbsp; if (str1!=str2) rtn=0;<br />&nbsp; &nbsp; }<br />&nbsp; }<br />} catch(e) {<br />&nbsp; WScript.Stderr.WriteLine(&quot;JScript runtime error: &quot;+e.message);<br />&nbsp; rtn=3;<br />}<br />WScript.Quit(rtn);<br /><br />function replFunc($0, $1, $2, $3, $4, $5, $6, $7, $8, $9, $10) {<br />&nbsp; var $=arguments;<br />&nbsp; return(eval(replace));<br />}<br /></code></pre></div><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p37862" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile37862">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchdc63.html?author_id=2923&amp;sr=posts">1540</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 06 Dec 2011 22:15</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> México City, México</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content37862">

						<h3 ><a href="#p37862">Re: regex search and replace for batch - Easily edit files!</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting0a5a.html?mode=quote&amp;f=3&amp;p=37862" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic96ef.html?p=37862#p37862" onclick="prompt('Message #40',this.href); return false;">#40</a></span> 
									<a class="unread" href="viewtopic96ef.html?p=37862#p37862" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a></strong> &raquo; </span>08 Nov 2014 01:10
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>dbenham wrote:</cite>I find it humorous that when dealing with batch environment variable &quot;arrays&quot;, I use var1 or var.1 without any brackets, precisely because they are &quot;pesky&quot;, and they are not needed. Yet you seem to always use var[1]. You don't seem to mind the &quot;pesky&quot; square brackets in that context. <img class="smilies" src="images/smilies/icon_lol.gif" alt=":lol:" title="Laughing" /><br /><br />But in this JScript context our perspectives are reversed, except I think there is a very good reason for sticking with the square brackets - to guarantee I can access all of the arguments.<br /><br /><br />Dave Benham<br /></div></blockquote><br />My reasons are exactly the same in both cases!<br /><br />When an &quot;array&quot; is used in a Batch file, no matter how the array element is written (var1 or var.1 or var[1]) the result is exactly the same. However, the three forms may make a huge difference from programmers point of view, especially if they have not enough experience. If a beginner see &quot;var[1]&quot; form and don't understand it, he/she may easily find information about this form as an &quot;array&quot; that include all required details, but the other forms are harder to understand and frequently require additional explanations. If we can write arrays in several forms, why don't write they in the clearer form in the benefit of unexperienced programmers? Anyway, you have to write array elements with square braquets in most other programming languages, so I don't see any reason to not do the same thing in Batch files.<br /><br />(I have the same opinion about using special characters as replaceable parameters in FOR commands; I don't see any reason to not use a letter and insert a strange character instead, that just made the FOR more difficult to read. If your code is clear/standard/common, it will have less problems when it will be used by other people).<br /><br />Accordingly to <a href="http://msdn.microsoft.com/en-us/library/t0kbytzc(v=vs.84).aspx" class="postlink">JScript documentation</a>, the <em class="text-italics">replaceText</em> string may access the captured submatched substrings via a dollar-sign and a digit: $1, $2, $3, etc. The <em class="text-italics">replaceText</em> may also be a function, but in this case the parameters of the function could be named in any way, for example: &quot;function(A,B,C,D)&quot;, in such a case the submatched substrings could be accessed via B, C, D, etc. parameters in the function body. However, the writers of the JScript documentation choose to name they in the same way of the original feature: &quot;function($0,$1,$2,$3)&quot;; this way, $1 always refers to the first submatched substring no matter if these characters appears in the replacement text as a string or in the body of the replacement function, and hence, in the JScript expression provided by the user of the program (for example, REPL.BAT or FindRepl.bat). I don't see any reason to not follow this standard.<br /><br />I think that regular expressions is a topic difficult to comprehend, especially to beginners, so introducing a different way to access submatched substrings via array elements, that are not documented at any other place excepting in your program, is a bad idea. If this change was dictated by a technicall requirement, I think that is preferable to set a restriction instead (&quot;You may define a maximum of N subexpressions&quot;). Anyway, you may set this limit as high as you want; you just need to write a long &quot;function($0,$1,...,$9,$10,...)&quot; line; the documentation specifies that the maximum captured submatched subexpression is $99. Remember that these nuisances are in the benefit of unexperienced programmers.<br /><br />Antonio</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p37892" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile37892">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content37892">

						<h3 ><a href="#p37892">Re: regex search and replace for batch - Easily edit files!</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting90ac.html?mode=quote&amp;f=3&amp;p=37892" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic6815-2.html?p=37892#p37892" onclick="prompt('Message #41',this.href); return false;">#41</a></span> 
									<a class="unread" href="viewtopic6815-2.html?p=37892#p37892" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>11 Nov 2014 12:04
			</p>
			
			
			
			<div class="content">I am ceasing development of REPL.BAT, other than possible bug fixes. All new enhancements will be in a new utility called JREPL.BAT. I am changing the name because the syntax has changed, so it is not backward compatible with REPL.BAT. The new utility is available here: <!-- l --><a class="postlink-local" href="viewtopicb16d.html?f=3&amp;t=6044">viewtopic.php?f=3&amp;t=6044</a><!-- l --><br /><br />@Aacini<br /><br />I do agree $1 is much more convenient than $[1]. But, I don't want to blindly define the maximum number of arguments ($0 - $101) because there is significant overhead in declaring function arguments that are not used.<br /><br />I realize now that a test replace can be performed to derive the number of capturing left parentheses, and then the function can be dynamically built using eval(). I will not bother making a change to REPL.BAT. That feature will go into the new JREPL.BAT utility.<br /><br /><br />Dave Benham</div>

			
													<div class="notice">
					Last edited by <a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a> on 14 Nov 2014 15:52, edited 1 time in total.
									</div>
			
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p37893" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile37893">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content37893">

						<h3 ><a href="#p37893">Re: regex search and replace for batch - Easily edit files!</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingd346.html?mode=quote&amp;f=3&amp;p=37893" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic3dd8.html?p=37893#p37893" onclick="prompt('Message #42',this.href); return false;">#42</a></span> 
									<a class="unread" href="viewtopic3dd8.html?p=37893#p37893" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>11 Nov 2014 12:08
			</p>
			
			
			
			<div class="content">Here is version 6.2 (perhaps the last ever version). It fixes a bug - the replacement JScript expression should not escape $ if L is used. It also corrects documentation of the A option.<br /><br />REPL.BAT version 6.2<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@if (@X)==(@Y) @end /* Harmless hybrid line that begins a JScript comment<br /><br />::************ Documentation ***********<br />::REPL.BAT version 6.2<br />:::<br />:::REPL&nbsp; Search&nbsp; Replace&nbsp; &#91;Options&nbsp; &#91;SourceVar&#93;&#93;<br />:::REPL&nbsp; /?&#91;REGEX|REPLACE&#93;<br />:::REPL&nbsp; /V<br />:::<br />:::&nbsp; Performs a global regular expression search and replace operation on<br />:::&nbsp; each line of input from stdin and prints the result to stdout.<br />:::<br />:::&nbsp; Each parameter may be optionally enclosed by double quotes. The double<br />:::&nbsp; quotes are not considered part of the argument. The quotes are required<br />:::&nbsp; if the parameter contains a batch token delimiter like space, tab, comma,<br />:::&nbsp; semicolon. The quotes should also be used if the argument contains a<br />:::&nbsp; batch special character like &amp;, |, etc. so that the special character<br />:::&nbsp; does not need to be escaped with ^.<br />:::<br />:::&nbsp; If called with a single argument of /?, then prints help documentation<br />:::&nbsp; to stdout. If a single argument of /?REGEX, then opens up Microsoft's<br />:::&nbsp; JScript regular expression documentation within your browser. If a single<br />:::&nbsp; argument of /?REPLACE, then opens up Microsoft's JScript REPLACE<br />:::&nbsp; documentation within your browser.<br />:::<br />:::&nbsp; If called with a single argument of /V, case insensitive, then prints<br />:::&nbsp; the version of REPL.BAT.<br />:::<br />:::&nbsp; Search&nbsp; - By default, this is a case sensitive JScript (ECMA) regular<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; expression expressed as a string.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; JScript regex syntax documentation is available at<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; http://msdn.microsoft.com/en-us/library/ae5bf541(v=vs.80).aspx<br />:::<br />:::&nbsp; Replace - By default, this is the string to be used as a replacement for<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; each found search expression. Full support is provided for<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; substituion patterns available to the JScript replace method.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; For example, $&amp; represents the portion of the source that matched<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the entire search pattern, $1 represents the first captured<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; submatch, $2 the second captured submatch, etc. A $ literal<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; can be escaped as $$.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; An empty replacement string must be represented as &quot;&quot;.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Replace substitution pattern syntax is fully documented at<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; http://msdn.microsoft.com/en-US/library/efy6s3e6(v=vs.80).aspx<br />:::<br />:::&nbsp; Options - An optional string of characters used to alter the behavior<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; of REPL. The option characters are case insensitive, and may<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appear in any order.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; A - Only print altered lines. Unaltered lines are discarded.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If the S options is present, then prints the result only if<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; there was a change anywhere in the string. The A option is<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; incompatible with the M option unless the S option is present.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; B - The Search must match the beginning of a line.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Mostly used with literal searches.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; E - The Search must match the end of a line.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Mostly used with literal searches.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; I - Makes the search case-insensitive.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; J - The Replace argument represents a JScript expression.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The expression may access an array like arguments object<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; named $. However, $ is not a true array object.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The $.length property contains the total number of arguments<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; available. The $.length value is equal to n+3, where n is the<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; number of capturing left parentheses within the Search string.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $&#91;0&#93; is the substring that matched the Search,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $&#91;1&#93; through $&#91;n&#93; are the captured submatch strings,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $&#91;n+1&#93; is the offset where the match occurred, and<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $&#91;n+2&#93; is the original source string.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Arguments $&#91;0&#93; through $&#91;10&#93; may be abbreviated as<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $1 through $10. Argument $&#91;11&#93; and above must use the square<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bracket notation.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; L - The Search is treated as a string literal instead of a<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; regular expression. Also, all $ found in the Replace string<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; are treated as $ literals.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; M - Multi-line mode. The entire contents of stdin is read and<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; processed in one pass instead of line by line, thus enabling<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; search for \n. This also enables preservation of the original<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; line terminators. If the M option is not present, then every<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printed line is terminated with carriage return and line feed.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The M option is incompatible with the A option unless the S<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; option is also present.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Note: If working with binary data containing NULL bytes,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; then the M option must be used.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; S - The source is read from an environment variable instead of<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; from stdin. The name of the source environment variable is<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; specified in the next argument after the option string. Without<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the M option, ^ anchors the beginning of the string, and $ the<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; end of the string. With the M option, ^ anchors the beginning<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; of a line, and $ the end of a line.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; V - Search and Replace represent the name of environment<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; variables that contain the respective values. An undefined<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; variable is treated as an empty string.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; X - Enables extended substitution pattern syntax with support<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for the following escape sequences within the Replace string:<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \\&nbsp; &nbsp; &nbsp;-&nbsp; Backslash<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \b&nbsp; &nbsp; &nbsp;-&nbsp; Backspace<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \f&nbsp; &nbsp; &nbsp;-&nbsp; Formfeed<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \n&nbsp; &nbsp; &nbsp;-&nbsp; Newline<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \q&nbsp; &nbsp; &nbsp;-&nbsp; Quote<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \r&nbsp; &nbsp; &nbsp;-&nbsp; Carriage Return<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \t&nbsp; &nbsp; &nbsp;-&nbsp; Horizontal Tab<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \v&nbsp; &nbsp; &nbsp;-&nbsp; Vertical Tab<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \xnn&nbsp; &nbsp;-&nbsp; Extended ASCII byte code expressed as 2 hex digits<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \unnnn -&nbsp; Unicode character expressed as 4 hex digits<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Also enables the \q escape sequence for the Search string.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The other escape sequences are already standard for a regular<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; expression Search string.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Also modifies the behavior of \xnn in the Search string to work<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; properly with extended ASCII byte codes.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Extended escape sequences are supported even when the L option<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; is used. Both Search and Replace support all of the extended<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; escape sequences if both the X and L opions are combined.<br />:::<br />:::&nbsp; Return Codes:&nbsp; 0 = At least one change was made<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;or the /? or /V option was used<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 = No change was made<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2 = Invalid call syntax or incompatible options<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3 = JScript runtime error, typically due to invalid regex<br />:::<br />::: REPL.BAT was written by Dave Benham, with assistance from DosTips user Aacini<br />::: to get \xnn to work properly with extended ASCII byte codes. Also assistance<br />::: from DosTips user penpen diagnosing issues reading NULL bytes, along with a<br />::: workaround. REPL.BAT was originally posted at:<br />::: http://www.dostips.com/forum/viewtopic.php?f=3&amp;t=3855<br />:::<br /><br />::************ Batch portion ***********<br />@echo off<br />if .%2 equ . (<br />&nbsp; if &quot;%~1&quot; equ &quot;/?&quot; (<br />&nbsp; &nbsp; &lt;&quot;%~f0&quot; cscript //E:JScript //nologo &quot;%~f0&quot; &quot;^:::&quot; &quot;&quot; a<br />&nbsp; &nbsp; exit /b 0<br />&nbsp; ) else if /i &quot;%~1&quot; equ &quot;/?regex&quot; (<br />&nbsp; &nbsp; explorer &quot;http://msdn.microsoft.com/en-us/library/ae5bf541(v=vs.80).aspx&quot;<br />&nbsp; &nbsp; exit /b 0<br />&nbsp; ) else if /i &quot;%~1&quot; equ &quot;/?replace&quot; (<br />&nbsp; &nbsp; explorer &quot;http://msdn.microsoft.com/en-US/library/efy6s3e6(v=vs.80).aspx&quot;<br />&nbsp; &nbsp; exit /b 0<br />&nbsp; ) else if /i &quot;%~1&quot; equ &quot;/V&quot; (<br />&nbsp; &nbsp; &lt;&quot;%~f0&quot; cscript //E:JScript //nologo &quot;%~f0&quot; &quot;^::(REPL\.BAT version)&quot; &quot;$1&quot; a<br />&nbsp; &nbsp; exit /b 0<br />&nbsp; ) else (<br />&nbsp; &nbsp; call :err &quot;Insufficient arguments&quot;<br />&nbsp; &nbsp; exit /b 2<br />&nbsp; )<br />)<br />echo(%~3|findstr /i &quot;&#91;^SMILEBVXAJ&#93;&quot; &gt;nul &amp;&amp; (<br />&nbsp; call :err &quot;Invalid option(s)&quot;<br />&nbsp; exit /b 2<br />)<br />echo(%~3|findstr /i &quot;M&quot;|findstr /i &quot;A&quot;|findstr /vi &quot;S&quot; &gt;nul &amp;&amp; (<br />&nbsp; call :err &quot;Incompatible options&quot;<br />&nbsp; exit /b 2<br />)<br />cscript //E:JScript //nologo &quot;%~f0&quot; %*<br />exit /b %errorlevel%<br /><br />:err<br />&gt;&amp;2 echo ERROR: %~1. Use REPL /? to get help.<br />exit /b<br /><br />************* JScript portion **********/<br />var rtn=1;<br />try {<br />&nbsp; var env=WScript.CreateObject(&quot;WScript.Shell&quot;).Environment(&quot;Process&quot;);<br />&nbsp; var args=WScript.Arguments;<br />&nbsp; var search=args.Item(0);<br />&nbsp; var replace=args.Item(1);<br />&nbsp; var options=&quot;g&quot;;<br />&nbsp; if (args.length&gt;2) options+=args.Item(2).toLowerCase();<br />&nbsp; var multi=(options.indexOf(&quot;m&quot;)&gt;=0);<br />&nbsp; var alterations=(options.indexOf(&quot;a&quot;)&gt;=0);<br />&nbsp; if (alterations) options=options.replace(/a/g,&quot;&quot;);<br />&nbsp; var srcVar=(options.indexOf(&quot;s&quot;)&gt;=0);<br />&nbsp; if (srcVar) options=options.replace(/s/g,&quot;&quot;);<br />&nbsp; var jexpr=(options.indexOf(&quot;j&quot;)&gt;=0);<br />&nbsp; if (jexpr) options=options.replace(/j/g,&quot;&quot;);<br />&nbsp; if (options.indexOf(&quot;v&quot;)&gt;=0) {<br />&nbsp; &nbsp; options=options.replace(/v/g,&quot;&quot;);<br />&nbsp; &nbsp; search=env(search);<br />&nbsp; &nbsp; replace=env(replace);<br />&nbsp; }<br />&nbsp; if (options.indexOf(&quot;x&quot;)&gt;=0) {<br />&nbsp; &nbsp; options=options.replace(/x/g,&quot;&quot;);<br />&nbsp; &nbsp; if (!jexpr) {<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\\\/g,&quot;\\B&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\q/g,&quot;\&quot;&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x80/g,&quot;\\u20AC&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x82/g,&quot;\\u201A&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x83/g,&quot;\\u0192&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x84/g,&quot;\\u201E&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x85/g,&quot;\\u2026&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x86/g,&quot;\\u2020&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x87/g,&quot;\\u2021&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x88/g,&quot;\\u02C6&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x89/g,&quot;\\u2030&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x8&#91;aA&#93;/g,&quot;\\u0160&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x8&#91;bB&#93;/g,&quot;\\u2039&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x8&#91;cC&#93;/g,&quot;\\u0152&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x8&#91;eE&#93;/g,&quot;\\u017D&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x91/g,&quot;\\u2018&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x92/g,&quot;\\u2019&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x93/g,&quot;\\u201C&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x94/g,&quot;\\u201D&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x95/g,&quot;\\u2022&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x96/g,&quot;\\u2013&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x97/g,&quot;\\u2014&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x98/g,&quot;\\u02DC&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x99/g,&quot;\\u2122&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x9&#91;aA&#93;/g,&quot;\\u0161&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x9&#91;bB&#93;/g,&quot;\\u203A&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x9&#91;cC&#93;/g,&quot;\\u0153&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x9&#91;dD&#93;/g,&quot;\\u009D&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x9&#91;eE&#93;/g,&quot;\\u017E&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x9&#91;fF&#93;/g,&quot;\\u0178&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\b/g,&quot;\b&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\f/g,&quot;\f&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\n/g,&quot;\n&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\r/g,&quot;\r&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\t/g,&quot;\t&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\v/g,&quot;\v&quot;);<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\x&#91;0-9a-fA-F&#93;{2}|\\u&#91;0-9a-fA-F&#93;{4}/g,<br />&nbsp; &nbsp; &nbsp; &nbsp; function($0,$1,$2){<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return String.fromCharCode(parseInt(&quot;0x&quot;+$0.substring(2)));<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; );<br />&nbsp; &nbsp; &nbsp; replace=replace.replace(/\\B/g,&quot;\\&quot;);<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; search=search.replace(/\\\\/g,&quot;\\B&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\q/g,&quot;\&quot;&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x80/g,&quot;\\u20AC&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x82/g,&quot;\\u201A&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x83/g,&quot;\\u0192&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x84/g,&quot;\\u201E&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x85/g,&quot;\\u2026&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x86/g,&quot;\\u2020&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x87/g,&quot;\\u2021&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x88/g,&quot;\\u02C6&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x89/g,&quot;\\u2030&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x8&#91;aA&#93;/g,&quot;\\u0160&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x8&#91;bB&#93;/g,&quot;\\u2039&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x8&#91;cC&#93;/g,&quot;\\u0152&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x8&#91;eE&#93;/g,&quot;\\u017D&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x91/g,&quot;\\u2018&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x92/g,&quot;\\u2019&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x93/g,&quot;\\u201C&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x94/g,&quot;\\u201D&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x95/g,&quot;\\u2022&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x96/g,&quot;\\u2013&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x97/g,&quot;\\u2014&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x98/g,&quot;\\u02DC&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x99/g,&quot;\\u2122&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x9&#91;aA&#93;/g,&quot;\\u0161&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x9&#91;bB&#93;/g,&quot;\\u203A&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x9&#91;cC&#93;/g,&quot;\\u0153&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x9&#91;dD&#93;/g,&quot;\\u009D&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x9&#91;eE&#93;/g,&quot;\\u017E&quot;);<br />&nbsp; &nbsp; search=search.replace(/\\x9&#91;fF&#93;/g,&quot;\\u0178&quot;);<br />&nbsp; &nbsp; if (options.indexOf(&quot;l&quot;)&gt;=0) {<br />&nbsp; &nbsp; &nbsp; search=search.replace(/\\b/g,&quot;\b&quot;);<br />&nbsp; &nbsp; &nbsp; search=search.replace(/\\f/g,&quot;\f&quot;);<br />&nbsp; &nbsp; &nbsp; search=search.replace(/\\n/g,&quot;\n&quot;);<br />&nbsp; &nbsp; &nbsp; search=search.replace(/\\r/g,&quot;\r&quot;);<br />&nbsp; &nbsp; &nbsp; search=search.replace(/\\t/g,&quot;\t&quot;);<br />&nbsp; &nbsp; &nbsp; search=search.replace(/\\v/g,&quot;\v&quot;);<br />&nbsp; &nbsp; &nbsp; search=search.replace(/\\x&#91;0-9a-fA-F&#93;{2}|\\u&#91;0-9a-fA-F&#93;{4}/g,<br />&nbsp; &nbsp; &nbsp; &nbsp; function($0,$1,$2){<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return String.fromCharCode(parseInt(&quot;0x&quot;+$0.substring(2)));<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; );<br />&nbsp; &nbsp; &nbsp; search=search.replace(/\\B/g,&quot;\\&quot;);<br />&nbsp; &nbsp; } else search=search.replace(/\\B/g,&quot;\\\\&quot;);<br />&nbsp; }<br />&nbsp; if (options.indexOf(&quot;l&quot;)&gt;=0) {<br />&nbsp; &nbsp; options=options.replace(/l/g,&quot;&quot;);<br />&nbsp; &nbsp; search=search.replace(/(&#91;.^$*+?()&#91;{\\|&#93;)/g,&quot;\\$1&quot;);<br />&nbsp; &nbsp; if (!jexpr) replace=replace.replace(/\$/g,&quot;$$$$&quot;);<br />&nbsp; }<br />&nbsp; if (options.indexOf(&quot;b&quot;)&gt;=0) {<br />&nbsp; &nbsp; options=options.replace(/b/g,&quot;&quot;);<br />&nbsp; &nbsp; search=&quot;^&quot;+search<br />&nbsp; }<br />&nbsp; if (options.indexOf(&quot;e&quot;)&gt;=0) {<br />&nbsp; &nbsp; options=options.replace(/e/g,&quot;&quot;);<br />&nbsp; &nbsp; search=search+&quot;$&quot;<br />&nbsp; }<br />&nbsp; var search=new RegExp(search,options);<br />&nbsp; var str1, str2;<br /><br />&nbsp; if (srcVar) {<br />&nbsp; &nbsp; str1=env(args.Item(3));<br />&nbsp; &nbsp; str2=str1.replace(search,jexpr?replFunc:replace);<br />&nbsp; &nbsp; if (!alterations || str1!=str2) if (multi) {<br />&nbsp; &nbsp; &nbsp; WScript.Stdout.Write(str2);<br />&nbsp; &nbsp; } else {<br />&nbsp; &nbsp; &nbsp; WScript.Stdout.WriteLine(str2);<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; if (str1!=str2) rtn=0;<br />&nbsp; } else if (multi){<br />&nbsp; &nbsp; var buf=1024;<br />&nbsp; &nbsp; str1=&quot;&quot;;<br />&nbsp; &nbsp; while (!WScript.StdIn.AtEndOfStream) {<br />&nbsp; &nbsp; &nbsp; str1+=WScript.StdIn.Read(buf);<br />&nbsp; &nbsp; &nbsp; buf*=2<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; str2=str1.replace(search,jexpr?replFunc:replace);<br />&nbsp; &nbsp; WScript.Stdout.Write(str2);<br />&nbsp; &nbsp; if (str1!=str2) rtn=0;<br />&nbsp; } else {<br />&nbsp; &nbsp; while (!WScript.StdIn.AtEndOfStream) {<br />&nbsp; &nbsp; &nbsp; str1=WScript.StdIn.ReadLine();<br />&nbsp; &nbsp; &nbsp; str2=str1.replace(search,jexpr?replFunc:replace);<br />&nbsp; &nbsp; &nbsp; if (!alterations || str1!=str2) WScript.Stdout.WriteLine(str2);<br />&nbsp; &nbsp; &nbsp; if (str1!=str2) rtn=0;<br />&nbsp; &nbsp; }<br />&nbsp; }<br />} catch(e) {<br />&nbsp; WScript.Stderr.WriteLine(&quot;JScript runtime error: &quot;+e.message);<br />&nbsp; rtn=3;<br />}<br />WScript.Quit(rtn);<br /><br />function replFunc($0, $1, $2, $3, $4, $5, $6, $7, $8, $9, $10) {<br />&nbsp; var $=arguments;<br />&nbsp; return(eval(replace));<br />}<br /></code></pre></div><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p37913" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile37913">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlista734.html?mode=viewprofile&amp;u=6044" class="username">bsrini</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search8b61.html?author_id=6044&amp;sr=posts">1</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Nov 2014 20:47</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content37913">

						<h3 ><a href="#p37913">Re: regex search and replace for batch - Easily edit files!</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingcac0.html?mode=quote&amp;f=3&amp;p=37913" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic001f.html?p=37913#p37913" onclick="prompt('Message #43',this.href); return false;">#43</a></span> 
									<a class="unread" href="viewtopic001f.html?p=37913#p37913" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlista734.html?mode=viewprofile&amp;u=6044" class="username">bsrini</a></strong> &raquo; </span>12 Nov 2014 21:19
			</p>
			
			
			
			<div class="content">Hello Dave, <br /><br />I am using the latest 6.2 version of repl.bat to search and replace a string using regular expressions....I am running into an issue with a particular use case. Below is the code:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />set allGroups=Requirements Contributors<br />set groupMembers=Smith, John (MIT) (SmithJ), BomarD, Ronald, Karl (non-empl) (RonaldK), Doe, Jane (DoeJ), ZimA<br />SET group=<br />SET mbrStr=<br />echo.<br /><br />setlocal enabledelayedexpansion<br />:nextVariable<br />for /F &quot;tokens=1* delims=;&quot; %%a in (&quot;%allGroups%&quot;) do (<br />&nbsp; &nbsp;&nbsp; &nbsp;set allGroups=%%b<br />&nbsp; &nbsp;set group=%%~a<br /><br />&nbsp; &nbsp;for /f &quot;tokens=*&quot; %%a in (&quot;%groupMembers%&quot;) do (<br />&nbsp; &nbsp;&nbsp; &nbsp;set input1=%%a<br />&nbsp; &nbsp;&nbsp; &nbsp;set input2=%%a<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;for /f &quot;delims=&quot; %%a in ('echo &quot;!input1!,&quot; ^|repl &quot;\(non-empl\)&quot; &quot;&quot; ^|repl &quot;\(MIT\)&quot; &quot;&quot; ^|repl &quot;.*?\((.*?)\),(.*?)&quot; &quot;$1,&quot; ^|repl &quot; &quot; &quot;&quot; ^|repl &quot;..$&quot; &quot;&quot; ') do set output1=%%a<br />&nbsp; &nbsp;&nbsp; &nbsp;set mbrStr=!mbrStr!!output1!<br />&nbsp; &nbsp;&nbsp; &nbsp;echo !group!=!mbrStr!<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;set mbrStr=<br />&nbsp; &nbsp;&nbsp; &nbsp;REM repeat for $2<br />&nbsp; &nbsp;&nbsp; &nbsp;for /f &quot;delims=&quot; %%a in ('echo &quot;!input2!,&quot; ^|repl &quot;\(non-empl\)&quot; &quot;&quot; ^|repl &quot;\(MIT\)&quot; &quot;&quot; ^|repl &quot;.*?\((.*?)\),(.*?)&quot; &quot;$2,&quot; ^|repl &quot; &quot; &quot;&quot; ^|repl &quot;..$&quot; &quot;&quot; ') do set output2=%%a<br />&nbsp; &nbsp;&nbsp; &nbsp;set mbrStr=!mbrStr!!output2!<br />&nbsp; &nbsp;&nbsp; &nbsp;echo !group!=!mbrStr!<br />&nbsp; &nbsp;)<br />)<br />if defined allGroups goto nextVariable<br /><br />goto :EOF<br /></code></pre></div><br /><br />Input in the above script is Smith, John (MIT) (SmithJ), BomarD, Ronald, Karl (non-empl) (RonaldK), Doe, Jane (DoeJ), ZimA<br />Those userIDs that are in parenthesis ONLY should be output as a  comma separated string, excluding anything else in parenthesis like MIT or non-empl. <br /><br />So, expected string would be:  <br /><br />Requirements Contributors=SmithJ,RonaldK,DoeJ<br /><br />However, output is:<br /><br />Requirements Contributors=SmithJ,RonaldK,DoeJ,<span style="color: #FF00FF">ZimA</span><br />Requirements Contributors=,,,ZimA<br /><br />I am separating $1 and $2 just to show that ZimA gets included no matter what. Is there any way to tweak the regular expression to show my expected result? I have tried various combinations without success. <br /><br />Any help would be greatly appreciated.<br /><br />Thank you,<br /><br />Balu</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p37918" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile37918">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf147.html?author_id=3221&amp;sr=posts">6033</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Feb 2012 02:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content37918">

						<h3 ><a href="#p37918">Re: regex search and replace for batch - Easily edit files!</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting9a02.html?mode=quote&amp;f=3&amp;p=37918" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicc838.html?p=37918#p37918" onclick="prompt('Message #44',this.href); return false;">#44</a></span> 
									<a class="unread" href="viewtopicc838.html?p=37918#p37918" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a></strong> &raquo; </span>13 Nov 2014 03:31
			</p>
			
			
			
			<div class="content">Does this work for you?<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />set &quot;var=Smith, John (MIT) (SmithJ), BomarD, Ronald, Karl (non-empl) (RonaldK), Doe, Jane (DoeJ), ZimA&quot;<br />echo %var%|repl &quot;\(.*?\) \((.*?)\),&quot; &quot;($1),&quot; |repl &quot;.*?\((.*?)\),.*?&quot; &quot;$1,&quot; |repl &quot;(.*), .*&quot; &quot;$1&quot;<br />pause<br /></code></pre></div>]</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p37926" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile37926">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content37926">

						<h3 ><a href="#p37926">Re: regex search and replace for batch - Easily edit files!</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinge6e6.html?mode=quote&amp;f=3&amp;p=37926" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicbc9c.html?p=37926#p37926" onclick="prompt('Message #45',this.href); return false;">#45</a></span> 
									<a class="unread" href="viewtopicbc9c.html?p=37926#p37926" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>13 Nov 2014 07:53
			</p>
			
			
			
			<div class="content">The J option is cool  <img class="smilies" src="images/smilies/icon_cool.gif" alt="8)" title="Cool" /> <br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />set groupMembers=Smith, John (MIT) (SmithJ), BomarD, Ronald, Karl (non-empl) (RonaldK), Doe, Jane (DoeJ), ZimA<br />for /f &quot;delims=, tokens=*&quot; %%A in (<br />&nbsp; 'repl &quot;&#91;^,&#93;*\((.*?)\)(?:,|$)|.*?(?:,|$)&quot; &quot;$1?','+$1:''&quot; js groupMembers'<br />) do echo Requirements Contributors=%%A<br /></code></pre></div><br />--Output--<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>Requirements Contributors=SmithJ,RonaldK,DoeJ<br /></code></pre></div><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
	

	<div class="action-bar bar-bottom">
	
			<a href="posting5ffd.html?mode=reply&amp;f=3&amp;t=3855" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic9c4c.html?f=3&amp;t=3855&amp;start=30&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

			<form method="post" action="https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=3855&amp;start=30">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			49 posts
							<ul>
			<li class="arrow previous"><a class="button button-icon-only" href="viewtopic0cd4.html?f=3&amp;t=3855&amp;start=15" rel="prev" role="button"><i class="icon fa-chevron-left fa-fw" aria-hidden="true"></i><span class="sr-only">Previous</span></a></li>
				<li><a class="button" href="viewtopicebb5.html?f=3&amp;t=3855" role="button">1</a></li>
				<li><a class="button" href="viewtopic0cd4.html?f=3&amp;t=3855&amp;start=15" role="button">2</a></li>
			<li class="active"><span>3</span></li>
				<li><a class="button" href="viewtopic74a8.html?f=3&amp;t=3855&amp;start=45" role="button">4</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopic74a8.html?f=3&amp;t=3855&amp;start=45" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="viewforum4d6b.html?f=3" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to “DOS Batch Forum”</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="viewforum31e6.html?f=4" class="jumpbox-cat-link"> <span> DosTips - Dos Batch</span></a></li>
																<li><a href="viewforum4d6b.html?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; DOS Batch Forum</span></a></li>
											</ul>
		</div>
	</div>

	</div>


			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
							<span class="crumb"><a href="../index.html" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>DosTips.com</span></a></span>									<span class="crumb"><a href="index.html" data-navbar-reference="index"><span>Board index</span></a></span>					</li>
		
				<li class="rightside">All times are <span title="UTC-6">UTC-06:00</span></li>
							<li class="rightside">
				<a href="ucp033a.html?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete all board cookies</span>
				</a>
			</li>
												<li class="rightside" data-last-responsive="true">
				<a href="memberlist4bfd.html?mode=team" role="menuitem">
					<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
				</a>
			</li>
									<li class="rightside" data-last-responsive="true">
				<a href="memberlist8733.html?mode=contactadmin" role="menuitem">
					<i class="icon fa-envelope fa-fw" aria-hidden="true"></i><span>Contact us</span>
				</a>
			</li>
			</ul>

	</div>
</div>

	<div class="copyright">
				<!-- WARNING NO DELETE -->Style developer by <a href="http://tricolor.x-tk.ru/">support forum tricolor</a>, <!-- END WARNING NO DELETE -->Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
									</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	<img src="cron5897.gif?cron_type=cron.task.text_reparser.poll_option" width="1" height="1" alt="cron" /></div>

<script type="text/javascript" src="assets/javascript/jquery.mind772.js?assets_version=34"></script>
<script type="text/javascript" src="assets/javascript/cored772.js?assets_version=34"></script>



<script type="text/javascript" src="styles/prosilver/template/forum_fnd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/prosilver/template/ajaxd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/jquery-uid772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/collapsed772.js?assets_version=34"></script>



</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=3855&start=30 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 08:03:56 GMT -->
</html>
