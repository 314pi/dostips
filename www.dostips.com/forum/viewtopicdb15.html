<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=4968 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 09:22:44 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>My UAC function - DosTips.com</title>


	<link rel="canonical" href="viewtopic6625.html?t=4968">

<!--
	phpBB style name: Allan Style - SUBSILVER
	Based on style:   prosilver (this is the default phpBB3 style)
	Based on style:   subsilver2 (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:  Allan ( http://x-tk.ru/ )
-->

<link href="assets/css/font-awesome.mind772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/stylesheetd772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/en/stylesheetd772.css?assets_version=34" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="./styles/AllanStyle-SUBSILVER/theme/tweaks.css?assets_version=34" rel="stylesheet">
<![endif]-->




<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','../../www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-280191-1', 'auto');
	ga('send', 'pageview');
</script>

</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">

<div id="header-subsilver">
	<a id="top" class="top-anchor" accesskey="t"></a>
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description" class="site-description">
				<a id="logo" class="logo" href="../index.html" title="DosTips.com"><span class="site_logo"></span></a>
				<h1>DosTips.com</h1>
				<p>A Forum all about DOS Batch</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

									<div id="search-box" class="search-box search-header" role="search">
				<form action="https://www.dostips.com/forum/search.php" method="get" id="search">
				<fieldset>
					<input name="keywords" id="keywords" type="search" maxlength="128" title="Search for keywords" class="inputbox search tiny" size="20" value="" placeholder="Search…" />
					<button class="button button-search" type="submit" title="Search">
						<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
					</button>
					<a href="search.html" class="button button-search-end" title="Advanced search">
						<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
					</a>
					
				</fieldset>
				</form>
			</div>
						
			</div>
					</div>
</div>


<div id="wrap" class="wrap">
	<div id="page-header">
				<div class="navbar-top" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
																									<li>
								<a href="search33a7.html?search_id=unanswered" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="search526f.html?search_id=active_topics" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-blue" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="search.html" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
											<li class="separator"></li>
																			<li>
								<a href="memberlist4bfd.html?mode=team" role="menuitem">
									<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
								</a>
							</li>
																<li class="separator"></li>

									</ul>
			</div>
		</li>

				<li data-skip-responsive="true">
			<a href="app.php/help/faq.html" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
						
			<li class="rightside"  data-skip-responsive="true">
			<a href="ucp26c3.html?mode=login" title="Login" accesskey="x" role="menuitem">
				<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Login</span>
			</a>
		</li>
					<li class="rightside" data-skip-responsive="true">
				<a href="ucp8319.html?mode=register" role="menuitem">
					<i class="icon fa-pencil-square-o  fa-fw" aria-hidden="true"></i><span>Register</span>
				</a>
			</li>
						</ul>

	</div>
</div>

<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
						<li class="breadcrumbs">
							<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="../index.html" itemprop="url" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span itemprop="title">DosTips.com</span></a></span>
										<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="index.html" itemprop="url" accesskey="h" data-navbar-reference="index"><span itemprop="title">Board index</span></a></span>

											<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="4"><a href="viewforum31e6.html?f=4" itemprop="url"><span itemprop="title">DosTips - Dos Batch</span></a></span>
															<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="3"><a href="viewforum4d6b.html?f=3" itemprop="url"><span itemprop="title">DOS Batch Forum</span></a></span>
												</li>
		
					<li class="rightside responsive-search">
				<a href="search.html" title="View the advanced search options" role="menuitem">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</a>
			</li>
			</ul>

	</div>
</div>

<div class="navbar-top-link">
	<div class="inner">
		<ul>
			<li class="navbar-top-link-left"><a href="search33a7.html?search_id=unanswered">Unanswered topics</a></li>
			<li class="navbar-top-link-left"><a href="search526f.html?search_id=active_topics">Active topics</a></li>

											</ul>
	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
		
<h2 class="topic-title"><a href="viewtopicdb15.html?f=3&amp;t=4968">My UAC function</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">Discussion forum for all Windows batch related topics.<br /></div>
<p>
	<strong>Moderator:</strong> <a href="memberlista6a8.html?mode=viewprofile&amp;u=5" class="username">DosItHelp</a>
</p>


<div class="action-bar bar-top">
	
			<a href="posting7b45.html?mode=reply&amp;f=3&amp;t=4968" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopicb1e7.html?f=3&amp;t=4968&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="https://www.dostips.com/forum/search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topic…" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="search.html" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="4968" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			29 posts
							<ul>
		<li class="active"><span>1</span></li>
				<li><a class="button" href="viewtopicb0ba.html?f=3&amp;t=4968&amp;start=15" role="button">2</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopicb0ba.html?f=3&amp;t=4968&amp;start=15" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
		</div>




<div id="subsilver-nav-topic">
	<div class="inner"><div class="post has-profile">
		<div class="leftsided postbody subsilver-topic-title">Message</div>
		<div class="leftsided postprofile subsilver-topic-author">Author</div>
	</div></div>
</div>

			<div id="p29027" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile29027">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist378d.html?mode=viewprofile&amp;u=4816" class="username">Adrianvdh</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchfffb.html?author_id=4816&amp;sr=posts">177</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 16 May 2013 13:00</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content29027">

						<h3 class="first"><a href="#p29027">My UAC function</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting929e.html?mode=quote&amp;f=3&amp;p=29027" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicac39.html?p=29027#p29027" onclick="prompt('Message #1',this.href); return false;">#1</a></span> 
									<a class="unread" href="viewtopicac39.html?p=29027#p29027" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist378d.html?mode=viewprofile&amp;u=4816" class="username">Adrianvdh</a></strong> &raquo; </span>05 Oct 2013 08:37
			</p>
			
			
			
			<div class="content">Hi everyone.<br /><br />I am having an issue with my UAC check function:<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>:checkfileUAC<br />pause<br />set &quot;/h=&quot;&amp;set &quot;/l=&quot;&amp;set &quot;/dl=&quot;&amp;set &quot;/ui=&quot;&amp;set &quot;/du=&quot;<br />for %%a in (%*) do (<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; if &quot;%%~a&quot;==&quot;/h&quot; ( set &quot;/h=true&quot;<br />&nbsp; &nbsp;) else if &quot;%%~a&quot;==&quot;/l&quot; ( set &quot;/l=true&quot;<br />&nbsp; &nbsp;) else if &quot;%%~a&quot;==&quot;/dl&quot; ( set &quot;/dl=true&quot;<br />&nbsp; &nbsp;) else if &quot;%%~a&quot;==&quot;/ui&quot; ( set &quot;/ui=true&quot;<br />&nbsp; &nbsp;) else if &quot;%%~a&quot;==&quot;/du&quot; set &quot;/du=true&quot;<br />)<br />if defined /h set &quot;UACcheckfile=%HostFileName%&quot; &amp;&amp; set &quot;writeError=Writing hosts to file&quot;<br />if defined /l set &quot;UACcheckfile=%logdir%&quot; &amp;&amp; set &quot;writeError=Writing log to file&quot;<br />if defined /dl set &quot;UACcheckfile=%logdir%&quot; &amp;&amp; set &quot;writeError=Deleting log file&quot;<br />if defined /ui set &quot;UACcheckfile=%updateinfofile%&quot; &amp;&amp; set &quot;writeError=Storing update information to file&quot;<br />if defined /du set &quot;UACcheckfile=%newversionupdatefile%&quot; &amp;&amp; set &quot;writeError=Downloading new update file&quot;<br />if exist &quot;%UACcheckfile%&quot; attrib -r &quot;%UACcheckfile%&quot;<br />for /F %%a in ('^(^(set &quot;X=&quot; ^&lt; nul^)^&gt;^&gt;&quot;%UACcheckfile%&quot;^)2^&gt;^&amp;1') do (<br />goto Errorwritefiles )<br />exit /b<br /></code></pre></div><br /><br />I call it when I write a log sting line to a file like this:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>call :checkfileUAC &quot;/l&quot; &amp;&amp; if &quot;%logmode%&quot;==&quot;Enabled&quot; if &quot;%logtype%&quot;==&quot;Detailed&quot; echo &#91;%time%&#93; &#91;Msg&#93;&gt;&gt;&quot;%logdir%&quot;<br /></code></pre></div><br /><br />What am I doing wrong?<br /><br />I use it in my script like so as well an nothing, just jumps to the first label:<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>choice /C 12r /N /M &quot;Make your selection: &quot;<br />if errorlevel 3 cls &amp; goto restart<br />if errorlevel 2 ( set mainmenuvar=Text1<br />goto mainmenuloginput )<br />if errorlevel 1 ( set mainmenuvar=Text2<br />goto mainmenuloginput )<br /><br />:mainmenuloginput<br />if &quot;%logmode%&quot;==&quot;Enabled&quot; call :checkfileUAC &quot;/l&quot; &amp;&amp; if &quot;%logtype%&quot;==&quot;Detailed&quot; echo &#91;%time%&#93; &#91;Msg: %mainmenuvar%&#93;&gt;&gt;&quot;%logdir%&quot;<br />if errorlevel 2 goto 222<br />if errorlevel 1 goto 111<br /><br />:333<br />echo No redirection label here<br />pause<br /><br />:111<br />echo 111<br />pause<br /><br />:222<br />echo 222<br />pause<br /><br />exit<br /></code></pre></div><br /><br />ANy idea?<br /><br />Thanks<br />Adrianvdh</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p29044" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile29044">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist378d.html?mode=viewprofile&amp;u=4816" class="username">Adrianvdh</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchfffb.html?author_id=4816&amp;sr=posts">177</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 16 May 2013 13:00</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content29044">

						<h3 ><a href="#p29044">Re: My UAC function</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingbfac.html?mode=quote&amp;f=3&amp;p=29044" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicece8.html?p=29044#p29044" onclick="prompt('Message #2',this.href); return false;">#2</a></span> 
									<a class="unread" href="viewtopicece8.html?p=29044#p29044" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist378d.html?mode=viewprofile&amp;u=4816" class="username">Adrianvdh</a></strong> &raquo; </span>06 Oct 2013 03:35
			</p>
			
			
			
			<div class="content">Any one?</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p29045" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile29045">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search661c.html?author_id=1265&amp;sr=posts">3386</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 22 Jan 2010 18:01</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content29045">

						<h3 ><a href="#p29045">Re: My UAC function</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinge727.html?mode=quote&amp;f=3&amp;p=29045" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic7e6f-2.html?p=29045#p29045" onclick="prompt('Message #3',this.href); return false;">#3</a></span> 
									<a class="unread" href="viewtopic7e6f-2.html?p=29045#p29045" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a></strong> &raquo; </span>06 Oct 2013 05:11
			</p>
			
			
			
			<div class="content">What's the purpose of that function? Do you try to figure out whether or not you are allowed to write into a certain file or directory?<br />&quot;I am having an issue&quot; is not an adequate error description btw. What figured you out if ECHO is ON?<br /><br />Regards<br />aGerman</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p29046" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile29046">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist378d.html?mode=viewprofile&amp;u=4816" class="username">Adrianvdh</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchfffb.html?author_id=4816&amp;sr=posts">177</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 16 May 2013 13:00</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content29046">

						<h3 ><a href="#p29046">Re: My UAC function</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinge18c-2.html?mode=quote&amp;f=3&amp;p=29046" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopice6d1.html?p=29046#p29046" onclick="prompt('Message #4',this.href); return false;">#4</a></span> 
									<a class="unread" href="viewtopice6d1.html?p=29046#p29046" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist378d.html?mode=viewprofile&amp;u=4816" class="username">Adrianvdh</a></strong> &raquo; </span>06 Oct 2013 06:19
			</p>
			
			
			
			<div class="content">I am confused with what you are telling me?<br /><br />That function there is because if the program need to write to a file and Access is denied,  it would echo Done!. When it actually didn't write to that file and complete the task.<br /><br />So? Could you help me with the function? It seems to error out when I call it.<br /><br />Any advice?</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p29047" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile29047">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf147.html?author_id=3221&amp;sr=posts">6033</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Feb 2012 02:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content29047">

						<h3 ><a href="#p29047">Re: My UAC function</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingf800.html?mode=quote&amp;f=3&amp;p=29047" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic6d34.html?p=29047#p29047" onclick="prompt('Message #5',this.href); return false;">#5</a></span> 
									<a class="unread" href="viewtopic6d34.html?p=29047#p29047" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a></strong> &raquo; </span>06 Oct 2013 06:29
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>Adrianvdh wrote:</cite>I am having an issue with my UAC check function:<br /></div></blockquote><br /><br />aGerman obliquely asked the question &quot;what exactly is the issue?&quot;</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p29048" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile29048">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search661c.html?author_id=1265&amp;sr=posts">3386</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 22 Jan 2010 18:01</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content29048">

						<h3 ><a href="#p29048">Re: My UAC function</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingc380.html?mode=quote&amp;f=3&amp;p=29048" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicf3ab-2.html?p=29048#p29048" onclick="prompt('Message #6',this.href); return false;">#6</a></span> 
									<a class="unread" href="viewtopicf3ab-2.html?p=29048#p29048" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a></strong> &raquo; </span>06 Oct 2013 06:45
			</p>
			
			
			
			<div class="content">Why so complicated?<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off &amp;setlocal<br /><br />echo(<br />echo &quot;%~f0&quot;<br />call :checkAccess &quot;%~f0&quot;<br />if errorlevel 1 (echo Access denied) else echo OK<br /><br />echo(<br />echo &quot;%SystemDrive%\pagefile.sys&quot;<br />call :checkAccess &quot;%SystemDrive%\pagefile.sys&quot;<br />if errorlevel 1 (echo Access denied) else echo OK<br /><br />echo(<br />pause<br />goto :eof<br /><br />:checkAccess<br />&gt;nul 2&gt;&amp;1 (&gt;&gt;&quot;%~1&quot; type nul) &amp;&amp; (exit /b 0) || exit /b 1<br /></code></pre></div><br />Regards<br />aGerman</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p29049" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile29049">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist378d.html?mode=viewprofile&amp;u=4816" class="username">Adrianvdh</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchfffb.html?author_id=4816&amp;sr=posts">177</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 16 May 2013 13:00</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content29049">

						<h3 ><a href="#p29049">Re: My UAC function</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinge625-2.html?mode=quote&amp;f=3&amp;p=29049" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic11df-2.html?p=29049#p29049" onclick="prompt('Message #7',this.href); return false;">#7</a></span> 
									<a class="unread" href="viewtopic11df-2.html?p=29049#p29049" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist378d.html?mode=viewprofile&amp;u=4816" class="username">Adrianvdh</a></strong> &raquo; </span>06 Oct 2013 12:27
			</p>
			
			
			
			<div class="content">Sorry, I meant I wanted you the obviously test the code and see where my problem is, but I didn't say that. Sorry <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br /><br />But, your code does work nicely. Only it does not suite the way I need to function like mine. How can i change this.<br /><br />I need it kinda like mine. So it uses switches and if the error level is 0 it will goto ErrorWritefile and if not exit /b<br /><br />Any idea?<br /><br />Thanks</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p29050" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile29050">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search661c.html?author_id=1265&amp;sr=posts">3386</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 22 Jan 2010 18:01</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content29050">

						<h3 ><a href="#p29050">Re: My UAC function</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingc446.html?mode=quote&amp;f=3&amp;p=29050" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopica6d2.html?p=29050#p29050" onclick="prompt('Message #8',this.href); return false;">#8</a></span> 
									<a class="unread" href="viewtopica6d2.html?p=29050#p29050" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a></strong> &raquo; </span>06 Oct 2013 13:39
			</p>
			
			
			
			<div class="content"><blockquote class="uncited"><div>if the error level is 0 it will goto ErrorWritefile and if not exit /b<br /></div></blockquote><br /><br /><em class="text-italics">GOTO &lt;AnyLabel&gt;</em> in a called function? What's next? How do you return to the point where the function was called?<br />Sorry but I don't get it.<br /><br />Regards<br />aGerman</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p29065" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile29065">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist378d.html?mode=viewprofile&amp;u=4816" class="username">Adrianvdh</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchfffb.html?author_id=4816&amp;sr=posts">177</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 16 May 2013 13:00</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content29065">

						<h3 ><a href="#p29065">Re: My UAC function</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingc7c8.html?mode=quote&amp;f=3&amp;p=29065" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic49fd.html?p=29065#p29065" onclick="prompt('Message #9',this.href); return false;">#9</a></span> 
									<a class="unread" href="viewtopic49fd.html?p=29065#p29065" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist378d.html?mode=viewprofile&amp;u=4816" class="username">Adrianvdh</a></strong> &raquo; </span>07 Oct 2013 07:51
			</p>
			
			
			
			<div class="content">I need the technique to be like mine, the if errorlevel statement must be in the function.<br /><br />And I need the use switches.<br /><br />The main reason is my batch file writes to a log and there of over 500 entries. So I can't have an errorlevel statement under every line.<br />Basic how it works:<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>if %log%==Yes call :Function /l &amp;&amp; echo Log msg &gt; log.txt<br /></code></pre></div><br /><br />Do you understand now? <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /> (not being sarcastic <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" />)</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p29070" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile29070">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search661c.html?author_id=1265&amp;sr=posts">3386</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 22 Jan 2010 18:01</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content29070">

						<h3 ><a href="#p29070">Re: My UAC function</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingd7a1.html?mode=quote&amp;f=3&amp;p=29070" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic4f7a.html?p=29070#p29070" onclick="prompt('Message #10',this.href); return false;">#10</a></span> 
									<a class="unread" href="viewtopic4f7a.html?p=29070#p29070" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a></strong> &raquo; </span>07 Oct 2013 15:11
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>Adrianvdh wrote:</cite>Do you understand now?</div></blockquote><br />No sorry.<br />Is your problem the handling of the switches?<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off &amp;setlocal<br />call :checkfileUAC /l<br />echo(<br />call :checkfileUAC /ui /du<br />echo(<br />call :checkfileUAC /h /dl<br />echo(<br />pause<br />goto :eof<br /><br />:checkfileUAC<br />for %%i in (/h /l /dl /ui /du) do (<br />&nbsp; set &quot;%%i=&quot;<br />&nbsp; for %%j in (%*) do (<br />&nbsp; &nbsp; if /i &quot;%%i&quot;==&quot;%%~j&quot; set &quot;%%i=1&quot;<br />&nbsp; )<br />)<br />if defined /h echo /h defined<br />if defined /l echo /l defined<br />if defined /dl echo /dl defined<br />if defined /ui echo /ui defined<br />if defined /du echo /du defined<br />goto :eof<br /></code></pre></div><br /><br />Try to write a simplified example (whole batch code) that shows the problem.<br /><br />Regards<br />aGerman</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p29090" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile29090">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist378d.html?mode=viewprofile&amp;u=4816" class="username">Adrianvdh</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchfffb.html?author_id=4816&amp;sr=posts">177</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 16 May 2013 13:00</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content29090">

						<h3 ><a href="#p29090">Re: My UAC function</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingac5c-2.html?mode=quote&amp;f=3&amp;p=29090" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicd77b.html?p=29090#p29090" onclick="prompt('Message #11',this.href); return false;">#11</a></span> 
									<a class="unread" href="viewtopicd77b.html?p=29090#p29090" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist378d.html?mode=viewprofile&amp;u=4816" class="username">Adrianvdh</a></strong> &raquo; </span>08 Oct 2013 10:35
			</p>
			
			
			
			<div class="content">Maybe it is the switches, I don't know. That switch work code is penpen's<br /><br />But I will give it a shot and report back</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p29091" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile29091">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist378d.html?mode=viewprofile&amp;u=4816" class="username">Adrianvdh</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchfffb.html?author_id=4816&amp;sr=posts">177</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 16 May 2013 13:00</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content29091">

						<h3 ><a href="#p29091">Re: My UAC function</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinge759.html?mode=quote&amp;f=3&amp;p=29091" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicdae6.html?p=29091#p29091" onclick="prompt('Message #12',this.href); return false;">#12</a></span> 
									<a class="unread" href="viewtopicdae6.html?p=29091#p29091" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist378d.html?mode=viewprofile&amp;u=4816" class="username">Adrianvdh</a></strong> &raquo; </span>08 Oct 2013 10:40
			</p>
			
			
			
			<div class="content">Ok, just realised it is the choice.exe errorlevel handling.<br /><br />I have a baisc setup here:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>:checkfileUAC<br />if &quot;%~1&quot;==&quot;/h&quot; set &quot;UACcheckfile=%MainFileName%&quot; &amp; set &quot;writeError=msg&quot;<br />if &quot;%~1&quot;==&quot;/l&quot; set &quot;UACcheckfile=%logdir%&quot; &amp; set &quot;writeError=msg&quot;<br />if &quot;%~1&quot;==&quot;/dl&quot; set &quot;UACcheckfile=%logdir%&quot; &amp; set &quot;writeError=msg&quot;<br />if &quot;%~1&quot;==&quot;/ui&quot; set &quot;UACcheckfile=%updateinfofile%&quot; &amp; set &quot;writeError=msg&quot;<br />if &quot;%~1&quot;==&quot;/du&quot; set &quot;UACcheckfile=%newversionupdatefile%&quot; &amp; set &quot;writeError=msg&quot;<br />call :UACselectedfile<br />exit /b<br /><br />:UACselectedfile<br />for /F %%a in ('^(^(set &quot;X=&quot; ^&lt; nul^)^&gt;^&gt;&quot;!UACcheckfile!&quot;^)2^&gt;^&amp;1') do (<br />goto Errorwrite<br /></code></pre></div><br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>choice /C 12 /N /M &quot;Make your selection: &quot;<br />if errorlevel 2 ( set mainmenuvar=msg<br />goto mainmenuloginput )<br />if errorlevel 1 ( set mainmenuvar=msg<br />goto mainmenuloginput )<br />:mainmenuloginput<br />if &quot;%logmode%&quot;==&quot;Enabled&quot; call :checkfileUAC &quot;/l&quot; if &quot;%logtype%&quot;==&quot;Detailed&quot; echo &#91;%time%&#93; &#91;Main menu user input status: %mainmenuvar%&#93;&gt;&gt;&quot;%logdir%&quot;<br />if errorlevel 2 goto test2<br />if errorlevel 1 goto test1<br /></code></pre></div><br /><br />The:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>if errorlevel 1 goto test1<br /></code></pre></div><br />is what is causing the problem I think. So if take the echo statement to logfile it would work, unless no.<br /><br />Any idea?</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p29092" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile29092">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistfcd5.html?mode=viewprofile&amp;u=4915" style="color: #00AA00;" class="username-coloured">penpen</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1bf7.html?author_id=4915&amp;sr=posts">1612</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 Jun 2013 06:15</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content29092">

						<h3 ><a href="#p29092">Re: My UAC function</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting040c.html?mode=quote&amp;f=3&amp;p=29092" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic08f2.html?p=29092#p29092" onclick="prompt('Message #13',this.href); return false;">#13</a></span> 
									<a class="unread" href="viewtopic08f2.html?p=29092#p29092" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistfcd5.html?mode=viewprofile&amp;u=4915" style="color: #00AA00;" class="username-coloured">penpen</a></strong> &raquo; </span>08 Oct 2013 17:39
			</p>
			
			
			
			<div class="content">I understand the problems aGernman has, as i assume, that i have the same problems:<br />Your problem is (still) unclear.<br />Basing on the code and the description you've given it is nearly impossible to guess the problem (all we can do is to check the syntax and guess what might happen, if we assume this or that).<br />Our problem in understanding your problem is we don't know the algorithm you have implemented.<br /><br />If you have a problem, then you should always post:<br />1) a detailed description of the error; not to meet your semantical target may be insufficient, even if you give the semantical target: This is such a case.<br />So you should give the full algorithm (idea behind your (problematic) code (part)).<br />2) the (full) problematic code: That means all code lines from a verified error free state to an error state. So :Errorwrite part is missing as it is between your assumed error and the call of the problematic function.<br /><br />If you assume that the problem is caused by errorlevel handling, then you should also post:<br />- what type of batch script you are using *.bat, *.cmd (-&gt;1), and<br />- the (idea behind the) algorithm: For example (i know it is not the full description):<br />Create a writing file handle to a file A and write nothing to it, supressing all errormessage by using &quot;((set /p &quot;=&quot; &lt;nul) &gt;&gt; A) 2&gt;1&quot;  by to check if A is accessible.<br />To avoid exceptional exits this code is placed within a for loop.<br />(I'm sure you would have described it in another way, but without saying anything about that line(s), we only can assume it is code that works as expected if the syntax is correct.)<br />To make it clear you should not describe all lines in detail, it suffices if you say this block of lines should do this (the same for the complete for loop):<br />If it is not possible to write to file A then jump to label :Errorwrite, else do nothing.<br /><br />If you assume the error handling part is the problem, then the optimal error description should contain this:<br />- which script type you are using (*.cmd, *.bat) (-&gt; 1), and<br />- how and when you initialize/set the errorlevel (-&gt; 1), and<br />- on important lines (this means, lines where the errorlevel may be changed by design): what case you are watching, and what errorlevel do you expect to be set in such a case, <br />- what happens in the :Errorwrite part (we cannot see it) (-&gt; 2). I assume that's why aGerman has wrote this:<br /><blockquote><div><cite>aGerman wrote:</cite>GOTO &lt;AnyLabel&gt; in a called function? What's next? How do you return to the point where the function was called?<br /></div></blockquote>(And the other comments for other parts that may be problematic, as we do not know what they do:<br />In which cases you are using the parameters; are they independent, or do they similar things: Maybe the order of those operations may be important, or if they interact in a special way.<br />But noone can say this, if noone knows for what they are good for.)<br /><br />Maybe it is good if i give an example, to move you to our point of view:<br />What is the problem in this code:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>:computeSum<br />:: %%~1 result<br />:: %%~2 maximum (has to be &gt;0)<br />set /A &quot;%~1=(%~2*(%~2-(%~2/%~2)))/((%~2+%~2)/%~2)&quot;<br />exit /B<br /></code></pre></div>This is (nearly) a very famous (alienated) function, so you might guess the problem, but if you don't see or know it, it is very hard to find the problem.<br /><br />penpen</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p29096" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile29096">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist378d.html?mode=viewprofile&amp;u=4816" class="username">Adrianvdh</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchfffb.html?author_id=4816&amp;sr=posts">177</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 16 May 2013 13:00</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content29096">

						<h3 ><a href="#p29096">Re: My UAC function</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinga697.html?mode=quote&amp;f=3&amp;p=29096" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic46fd-2.html?p=29096#p29096" onclick="prompt('Message #14',this.href); return false;">#14</a></span> 
									<a class="unread" href="viewtopic46fd-2.html?p=29096#p29096" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist378d.html?mode=viewprofile&amp;u=4816" class="username">Adrianvdh</a></strong> &raquo; </span>09 Oct 2013 09:09
			</p>
			
			
			
			<div class="content">Ok I am sorry, I thought I said the problem in the first post but I forgot to <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /> but <img class="smilies" src="images/smilies/icon_sad.gif" alt=":(" title="Sad" /> I wasted your time as well.<br /><br />So...<br /><br />How it work is I have a few variable file directories set...<br />Example a log dir ok<br /><br />The log directory is set:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>set &quot;logdir=%~d0%~p0Log.txt&quot;<br /></code></pre></div><br /><br />Ok so the UAC function would use switches. Ok<br />So... Quick I would echo to a log file:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>if &quot;%logmode%&quot;==&quot;Enabled&quot; call :checkfileUAC &quot;/l&quot; &amp;&amp; if &quot;%logtype%&quot;==&quot;Detailed&quot; echo &#91;%time%&#93; &#91;Msg&#93;&gt;&gt;&quot;%logdir%&quot;<br /></code></pre></div><br /><br />The &quot;/L&quot; in the calling of the function is to let the function know it is working with the logdir variable or the log file<br />Hence /L for log<br /><br />So I have changed to function to make it more simple:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>if &quot;%~1&quot;==&quot;/l&quot; set &quot;UACcheckfile=%logdir%&quot; &amp; set &quot;writeError=Writing log to file&quot;<br /></code></pre></div><br /><br />The UACcheckfile variable is the functions only variable to set the file it is working with. OK<br />And the writeError variable is the Msg the user would see if the selected file is access denied. OK<br /><br />So if the file is access denied it would goto Errorwritefiles<br />which would tell the user to problem<br /><br /><br />Now I found that the switch feature in the UAC function is the problem, but I will get to that in a second:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>:checklogUAC<br />for /F %%a in ('^(^(set &quot;X=&quot; ^&lt; nul^)^&gt;^&gt;&quot;%logdir%&quot;^)2^&gt;^&amp;1') do (<br />set &quot;writeError=Writing log to file&quot;<br />goto Errorwritefiles )<br />exit /b<br /><br />:checkupdateinfoUAC<br />if exist &quot;%updateinfofile%&quot; attrib -r &quot;%updateinfofile%&quot;<br />for /F %%a in ('^(^(set &quot;X=&quot; ^&lt; nul^)^&gt;^&gt;&quot;%updateinfofile%&quot;^)2^&gt;^&amp;1') do (<br />set &quot;writeError=Storing update information to file&quot;<br />goto Errorwritefiles )<br />exit /b<br /><br />etc<br /></code></pre></div><br /><br />This was the old way of me using the function<br /><br />That, (above) I had to have a set function's for every file I needed to check the UAC, but that was taking space in my batch file. So I wanted to shorten it and make<br />it more smarter. So I just had one function thing and for every file it need to work with it would use switches to do that. Ok<br /><br /><br />Now the switch problem:<br /><br />So when the main batch file is starting the UAC function using the switch &quot;/L&quot; (for log file) has no problem, but when it is done loading it has to goto the main menu<br />for user input. That uses the choice.exe<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>if &quot;%logmode%&quot;==&quot;Enabled&quot; call :checkfileUAC &quot;/l&quot; &amp;&amp; if &quot;%logtype%&quot;==&quot;Detailed&quot; echo &#91;%time%&#93; &#91;Main menu status: Loaded menu&#93;&gt;&gt;&quot;%logdir%&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (WORKS FINE)<br />choice /C 12 /N /M &quot;Make your selection: &quot;<br />if errorlevel 2 ( set mainmenuvar=Msg<br />goto mainmenuloginput )<br />if errorlevel 1 ( set mainmenuvar=Msg<br />goto mainmenuloginput )<br />:mainmenuloginput<br />if &quot;%logmode%&quot;==&quot;Enabled&quot; call :checkfileUAC &quot;/l&quot; if &quot;%logtype%&quot;==&quot;Detailed&quot; echo &#91;%time%&#93; &#91;Main menu user input status: %mainmenuvar%&#93;&gt;&gt;&quot;%logdir%&quot;<br />if errorlevel 2 goto Test2<br />if errorlevel 1 goto Test1<br /></code></pre></div><br /><br />Now the choice.exe's errorlevel interferes with the UAC function and the switch.<br /><br />That is the problem. When it calls the UAC function the errorlevel statements are completely ignored and the goes to the first lable following<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>:Test1<br />echo First<br />echo The label it come to because errorlevel does not work now<br /></code></pre></div><br /><br />So that raps it up I guess <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br /><br />Sorry again penpen and aGerman for wasting your time with my stupidity and not posting the problem.<br />Now do you understand?<br /><br />P.S. penpen: I think that is a calculator, the first switch is the first number and the second is the second?<br />but that is just me guessing<br /><br />EDITED: I forgot to say, it is a .bat file, my program with the problem</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p29097" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile29097">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistfcd5.html?mode=viewprofile&amp;u=4915" style="color: #00AA00;" class="username-coloured">penpen</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1bf7.html?author_id=4915&amp;sr=posts">1612</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 Jun 2013 06:15</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content29097">

						<h3 ><a href="#p29097">Re: My UAC function</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingdf52.html?mode=quote&amp;f=3&amp;p=29097" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopice176.html?p=29097#p29097" onclick="prompt('Message #15',this.href); return false;">#15</a></span> 
									<a class="unread" href="viewtopice176.html?p=29097#p29097" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistfcd5.html?mode=viewprofile&amp;u=4915" style="color: #00AA00;" class="username-coloured">penpen</a></strong> &raquo; </span>09 Oct 2013 11:32
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>Adrianvdh wrote:</cite>Now the choice.exe's errorlevel interferes with the UAC function and the switch.<br /><br />That is the problem. When it calls the UAC function the errorlevel statements are completely ignored and the goes to the first lable following<br /></div></blockquote>If that is the problem, just store the result into a variable, right after the choice and use this variable with the if's.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>choice /C 12 /N /M &quot;Make your selection: &quot;<br />set &quot;errno=%errorlevel%&quot;<br />:: ...<br /><br />::replace: if errorlevel 2 goto Test2<br />if %errno% GEQ 2 goto Test2<br />::replace: if errorlevel 1 goto Test1<br />if %errno% GEQ 1 goto Test1<br /></code></pre></div>This should fix this Problem.<br /><br />Beside: The Problem in the small codeblock i've given above can better be seen, if you replace %~2 by n and shorten the expression:<br />(%~2*(%~2-(%~2/%~2)))/((%~2+%~2)/%~2)=(n*(n-(n/n)))/((n+n)/n)=(n*(n-1))/2<br />This formula computes the sum of all positive numbers up to (n-1).<br />As i defined %~2 to be the maximum value, the correct sum should have been computed by:(n*(n+1))/2.<br />So the '-' was wrong and has to be a '+' instead.<br /><br />penpen</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
	

	<div class="action-bar bar-bottom">
	
			<a href="posting7b45.html?mode=reply&amp;f=3&amp;t=4968" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopicb1e7.html?f=3&amp;t=4968&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

			<form method="post" action="https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=4968">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			29 posts
							<ul>
		<li class="active"><span>1</span></li>
				<li><a class="button" href="viewtopicb0ba.html?f=3&amp;t=4968&amp;start=15" role="button">2</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopicb0ba.html?f=3&amp;t=4968&amp;start=15" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="viewforum4d6b.html?f=3" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to “DOS Batch Forum”</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="viewforum31e6.html?f=4" class="jumpbox-cat-link"> <span> DosTips - Dos Batch</span></a></li>
																<li><a href="viewforum4d6b.html?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; DOS Batch Forum</span></a></li>
											</ul>
		</div>
	</div>

	</div>


			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
							<span class="crumb"><a href="../index.html" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>DosTips.com</span></a></span>									<span class="crumb"><a href="index.html" data-navbar-reference="index"><span>Board index</span></a></span>					</li>
		
				<li class="rightside">All times are <span title="UTC-6">UTC-06:00</span></li>
							<li class="rightside">
				<a href="ucp033a.html?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete all board cookies</span>
				</a>
			</li>
												<li class="rightside" data-last-responsive="true">
				<a href="memberlist4bfd.html?mode=team" role="menuitem">
					<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
				</a>
			</li>
									<li class="rightside" data-last-responsive="true">
				<a href="memberlist8733.html?mode=contactadmin" role="menuitem">
					<i class="icon fa-envelope fa-fw" aria-hidden="true"></i><span>Contact us</span>
				</a>
			</li>
			</ul>

	</div>
</div>

	<div class="copyright">
				<!-- WARNING NO DELETE -->Style developer by <a href="http://tricolor.x-tk.ru/">support forum tricolor</a>, <!-- END WARNING NO DELETE -->Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
									</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	<img src="cronc6bf.gif?cron_type=cron.task.text_reparser.user_signature" width="1" height="1" alt="cron" /></div>

<script type="text/javascript" src="assets/javascript/jquery.mind772.js?assets_version=34"></script>
<script type="text/javascript" src="assets/javascript/cored772.js?assets_version=34"></script>



<script type="text/javascript" src="styles/prosilver/template/forum_fnd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/prosilver/template/ajaxd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/jquery-uid772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/collapsed772.js?assets_version=34"></script>



</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=4968 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 09:23:05 GMT -->
</html>
