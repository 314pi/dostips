<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=8326&p=55685 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 08:17:02 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>removing dates from filenames - DosTips.com</title>


	<link rel="canonical" href="viewtopic6e17.html?t=8326">

<!--
	phpBB style name: Allan Style - SUBSILVER
	Based on style:   prosilver (this is the default phpBB3 style)
	Based on style:   subsilver2 (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:  Allan ( http://x-tk.ru/ )
-->

<link href="assets/css/font-awesome.mind772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/stylesheetd772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/en/stylesheetd772.css?assets_version=34" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="./styles/AllanStyle-SUBSILVER/theme/tweaks.css?assets_version=34" rel="stylesheet">
<![endif]-->




<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','../../www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-280191-1', 'auto');
	ga('send', 'pageview');
</script>

</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">

<div id="header-subsilver">
	<a id="top" class="top-anchor" accesskey="t"></a>
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description" class="site-description">
				<a id="logo" class="logo" href="../index.html" title="DosTips.com"><span class="site_logo"></span></a>
				<h1>DosTips.com</h1>
				<p>A Forum all about DOS Batch</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

									<div id="search-box" class="search-box search-header" role="search">
				<form action="https://www.dostips.com/forum/search.php" method="get" id="search">
				<fieldset>
					<input name="keywords" id="keywords" type="search" maxlength="128" title="Search for keywords" class="inputbox search tiny" size="20" value="" placeholder="Search…" />
					<button class="button button-search" type="submit" title="Search">
						<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
					</button>
					<a href="search.html" class="button button-search-end" title="Advanced search">
						<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
					</a>
					
				</fieldset>
				</form>
			</div>
						
			</div>
					</div>
</div>


<div id="wrap" class="wrap">
	<div id="page-header">
				<div class="navbar-top" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
																									<li>
								<a href="search33a7.html?search_id=unanswered" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="search526f.html?search_id=active_topics" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-blue" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="search.html" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
											<li class="separator"></li>
																			<li>
								<a href="memberlist4bfd.html?mode=team" role="menuitem">
									<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
								</a>
							</li>
																<li class="separator"></li>

									</ul>
			</div>
		</li>

				<li data-skip-responsive="true">
			<a href="app.php/help/faq.html" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
						
			<li class="rightside"  data-skip-responsive="true">
			<a href="ucp26c3.html?mode=login" title="Login" accesskey="x" role="menuitem">
				<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Login</span>
			</a>
		</li>
					<li class="rightside" data-skip-responsive="true">
				<a href="ucp8319.html?mode=register" role="menuitem">
					<i class="icon fa-pencil-square-o  fa-fw" aria-hidden="true"></i><span>Register</span>
				</a>
			</li>
						</ul>

	</div>
</div>

<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
						<li class="breadcrumbs">
							<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="../index.html" itemprop="url" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span itemprop="title">DosTips.com</span></a></span>
										<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="index.html" itemprop="url" accesskey="h" data-navbar-reference="index"><span itemprop="title">Board index</span></a></span>

											<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="4"><a href="viewforum31e6.html?f=4" itemprop="url"><span itemprop="title">DosTips - Dos Batch</span></a></span>
															<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="3"><a href="viewforum4d6b.html?f=3" itemprop="url"><span itemprop="title">DOS Batch Forum</span></a></span>
												</li>
		
					<li class="rightside responsive-search">
				<a href="search.html" title="View the advanced search options" role="menuitem">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</a>
			</li>
			</ul>

	</div>
</div>

<div class="navbar-top-link">
	<div class="inner">
		<ul>
			<li class="navbar-top-link-left"><a href="search33a7.html?search_id=unanswered">Unanswered topics</a></li>
			<li class="navbar-top-link-left"><a href="search526f.html?search_id=active_topics">Active topics</a></li>

											</ul>
	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
		
<h2 class="topic-title"><a href="viewtopic5597.html?f=3&amp;t=8326">removing dates from filenames</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">Discussion forum for all Windows batch related topics.<br /></div>
<p>
	<strong>Moderator:</strong> <a href="memberlista6a8.html?mode=viewprofile&amp;u=5" class="username">DosItHelp</a>
</p>


<div class="action-bar bar-top">
	
			<a href="posting8906.html?mode=reply&amp;f=3&amp;t=8326" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic5cc9.html?f=3&amp;t=8326&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="https://www.dostips.com/forum/search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topic…" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="search.html" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="8326" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			9 posts
							&bull; Page <strong>1</strong> of <strong>1</strong>
					</div>
		</div>




<div id="subsilver-nav-topic">
	<div class="inner"><div class="post has-profile">
		<div class="leftsided postbody subsilver-topic-title">Message</div>
		<div class="leftsided postprofile subsilver-topic-author">Author</div>
	</div></div>
</div>

			<div id="p55312" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile55312">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistcd44.html?mode=viewprofile&amp;u=9049" class="username">lalat06bag</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf757.html?author_id=9049&amp;sr=posts">36</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Jan 2018 15:21</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content55312">

						<h3 class="first"><a href="#p55312">removing dates from filenames</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinge8a7.html?mode=quote&amp;f=3&amp;p=55312" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic8efc.html?p=55312#p55312" onclick="prompt('Message #1',this.href); return false;">#1</a></span> 
									<a class="unread" href="viewtopic8efc.html?p=55312#p55312" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistcd44.html?mode=viewprofile&amp;u=9049" class="username">lalat06bag</a></strong> &raquo; </span>10 Jan 2018 15:35
			</p>
			
			
			
			<div class="content">Hi,<br>
<br>
I have below set of files. How to remove the dates from the file name?<br>
WTIN_PEG_FX_Wires-en-us_2017-12-20T024722674Z.pdf<br>
WTIN_PEG_BX_2017-12-20T024722674Z.pdf<br>
W_P_B_2017-12-20T024722674Z.pdf<br>
<br>
Output should be<br>
WTIN_PEG_FX_Wires-en-us.pdf<br>
WTIN_PEG_BX.pdf<br>
W_P_B.pdf</div>

			
													<div class="notice">
					Last edited by <a href="memberlistcd44.html?mode=viewprofile&amp;u=9049" class="username">lalat06bag</a> on 10 Feb 2018 18:46, edited 3 times in total.
									</div>
			
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p55316" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile55316">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist7131.html?mode=viewprofile&amp;u=8258" class="username">elzooilogico</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search6be6.html?author_id=8258&amp;sr=posts">101</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 May 2016 15:39</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Spain</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content55316">

						<h3 ><a href="#p55316">Re: removing dates from filenames</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting8dd8.html?mode=quote&amp;f=3&amp;p=55316" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicd6cd.html?p=55316#p55316" onclick="prompt('Message #2',this.href); return false;">#2</a></span> 
									<a class="unread" href="viewtopicd6cd.html?p=55316#p55316" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist7131.html?mode=viewprofile&amp;u=8258" class="username">elzooilogico</a></strong> &raquo; </span>11 Jan 2018 03:27
			</p>
			
			
			
			<div class="content">if date is always 21 characters long (as in your example) smply remove the last 22 (date length + hyphen) characters from filename<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off
setlocal enableDelayedExpansion
set /a dateLen=22
for /f %%v in ('dir /b') do (
  set "file=%%~nv" &amp; rem fetch filename only
  set "file=!file:~0,-%dateLen%!%%~xv" &amp; rem remove last n chars from filename and add extension
  echo !file!
)
endlocal
exit/B</code></pre></div>
This will not rename files, only echo the new file name. change <div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>echo !file!</code></pre></div> to <div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>ren "%%v" "!file!"</code></pre></div></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p55341" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile55341">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistcd44.html?mode=viewprofile&amp;u=9049" class="username">lalat06bag</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf757.html?author_id=9049&amp;sr=posts">36</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Jan 2018 15:21</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content55341">

						<h3 ><a href="#p55341">Re: removing dates from filenames</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting550b-2.html?mode=quote&amp;f=3&amp;p=55341" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicfce3.html?p=55341#p55341" onclick="prompt('Message #3',this.href); return false;">#3</a></span> 
									<a class="unread" href="viewtopicfce3.html?p=55341#p55341" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistcd44.html?mode=viewprofile&amp;u=9049" class="username">lalat06bag</a></strong> &raquo; </span>12 Jan 2018 12:16
			</p>
			
			
			
			<div class="content">Thank you. This worked perfectly fine.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p55342" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile55342">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistcd44.html?mode=viewprofile&amp;u=9049" class="username">lalat06bag</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf757.html?author_id=9049&amp;sr=posts">36</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Jan 2018 15:21</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content55342">

						<h3 ><a href="#p55342">Re: removing dates from filenames</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting9885-2.html?mode=quote&amp;f=3&amp;p=55342" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic0327.html?p=55342#p55342" onclick="prompt('Message #4',this.href); return false;">#4</a></span> 
									<a class="unread" href="viewtopic0327.html?p=55342#p55342" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistcd44.html?mode=viewprofile&amp;u=9049" class="username">lalat06bag</a></strong> &raquo; </span>12 Jan 2018 14:04
			</p>
			
			
			
			<div class="content">Hi,<br>
<br>
In response to above, I want to convert these pdfs to text. I have the pdftotext.exe in say xpdf folder which can convert by pdftotext abc.pdf abc.txt and it would convert it to txt.<br>
<br>
How can I go to xpdf folder to use pdftotext.exe and convert the files in "alltextfiles" folder?<br>
<br>
folder allpdffiles had all the pdfs<br>
folder alltextfiles should be having all the text files after conversion.<br>
the pdftotext exe is xpdf folder. so to execute pdftotext, I have to go to xpdf folder to execute this.<br>
<br>
Thanks,</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p55347" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile55347">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist7131.html?mode=viewprofile&amp;u=8258" class="username">elzooilogico</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search6be6.html?author_id=8258&amp;sr=posts">101</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 May 2016 15:39</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Spain</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content55347">

						<h3 ><a href="#p55347">Re: removing dates from filenames</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting7b43.html?mode=quote&amp;f=3&amp;p=55347" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic147f.html?p=55347#p55347" onclick="prompt('Message #5',this.href); return false;">#5</a></span> 
									<a class="unread" href="viewtopic147f.html?p=55347#p55347" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist7131.html?mode=viewprofile&amp;u=8258" class="username">elzooilogico</a></strong> &raquo; </span>13 Jan 2018 05:05
			</p>
			
			
			
			<div class="content">Simply add full paths to exe, source and destination files. give this a try (NOT TESTED)<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off

:: %~dp0 is the directory this script is run from, so change
:: set "pdftotext=%~dp0pdftotext.exe" to whatever the actual location is (i.e)
:: set "pdftotext=C:\Program Files (x86)\xpdf\pdftotext.exe"
set "pdfToText=%~dp0pdftotext.exe"
:: do the same iwth source and destination folders
set "allPdfFiles=%~dp0allpdffiles"
set "allTxtFiles=%~dp0alltextfiles"
:: create the destination directory if it doesn't exist 
if not exist "%allTxtFiles%" mkdir "%allTxtFiles%"

for /f %%v in ('dir /b %allPdfFiles%\*.pdf') do (
  "%pdfToText%" "%allPdfFiles%\%%v" "%allTxtFiles%\%%~nv.txt" &gt;NUL 2&gt;&amp;1 || echo Error converting %%v
)

EndLocal
exit/B</code></pre></div></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p55348" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile55348">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistcd44.html?mode=viewprofile&amp;u=9049" class="username">lalat06bag</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf757.html?author_id=9049&amp;sr=posts">36</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Jan 2018 15:21</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content55348">

						<h3 ><a href="#p55348">Re: removing dates from filenames</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting60fe.html?mode=quote&amp;f=3&amp;p=55348" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic9458.html?p=55348#p55348" onclick="prompt('Message #6',this.href); return false;">#6</a></span> 
									<a class="unread" href="viewtopic9458.html?p=55348#p55348" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistcd44.html?mode=viewprofile&amp;u=9049" class="username">lalat06bag</a></strong> &raquo; </span>13 Jan 2018 14:16
			</p>
			
			
			
			<div class="content">so super. Thank you a bunch. It worked so well. have a nice one.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p55663" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile55663">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistcd44.html?mode=viewprofile&amp;u=9049" class="username">lalat06bag</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf757.html?author_id=9049&amp;sr=posts">36</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Jan 2018 15:21</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content55663">

						<h3 ><a href="#p55663">Re: removing dates from filenames</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting10d1.html?mode=quote&amp;f=3&amp;p=55663" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopiced46.html?p=55663#p55663" onclick="prompt('Message #7',this.href); return false;">#7</a></span> 
									<a class="unread" href="viewtopiced46.html?p=55663#p55663" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistcd44.html?mode=viewprofile&amp;u=9049" class="username">lalat06bag</a></strong> &raquo; </span>09 Feb 2018 12:25
			</p>
			
			
			
			<div class="content">In response to the above, need help in converting the files reading the content from a flat file. Please see. <br>
<br>
Source folder would be having all the reports. <br>
xpdf would be containing pdftotxt.exe which would convert pdf to text file.<br>
Dest folder would be having the converted content.<br>
daily_report.txt would contain  the pdf files which need to be converted.<br>
<br>
While source would be searched, it would pick all the files mentioned in the daily_report.txt with today's date, convert it and move it to the destination folder. So in the destination folder, there would not be the date part. It would be same in the flat file.txt. <br>
<br>
The files would be looked upon for 2 hours in every 5 mins till all the files are found or the time is reached. If not found, it would be written to the error log. <br>
Please note: there are few spaces in the file name.<br>
Source:<br>
<br>
XXXX_QRRPS Tran book - 0utgoing-en-in_2018-02-09T024757245Z.pdf<br>
XXXX_QRRPS Tran book - Incoming-en-in_2018-02-09T024757245Z.pdf<br>
XXXX_CB Vol By rce-en-in_2018-02-09T024757245Z.xlsx<br>
XXXX_ABC_Rec_Eng-en-eu_2018-02-09T024757245Z.pdf<br>
XXXX_ABC_Rec_Eng-en-eu_2018-02-09T024757245Z.xlsx<br>
XXXX_QRRPS Tran book - Incoming-en-in_2018-02-08T024757245Z.pdf<br>
XXXX_QRRPS Tran book - Incoming-en-in_2018-02-08T024757245Z.pdf<br>
XXXX_CB Vol By rce-en-in_2018-02-08T024757245Z.xlsx<br>
XXXX_ABC_Rec_Eng-en-eu_2018-02-08T024757245Z.pdf<br>
XXXX_ABC_Rec_Eng-en-eu_2018-02-08T024757245Z.xlsx<br>
<br>
daily_report.txt would be having<br>
XXXX_QRRPS Tran book - 0utgoing-en-in.pdf<br>
XXXX_ABC_Rec_Eng-en-eu.pdf<br>
<br>
dest folder would be having <br>
XXXX_QRRPS Tran book - 0utgoing-en-in.txt<br>
XXXX_ABC_Rec_Eng-en-eu.txt</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p55682" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile55682">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistcd44.html?mode=viewprofile&amp;u=9049" class="username">lalat06bag</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf757.html?author_id=9049&amp;sr=posts">36</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Jan 2018 15:21</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content55682">

						<h3 ><a href="#p55682">removing dates from filenames</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingbea5.html?mode=quote&amp;f=3&amp;p=55682" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic3363.html?p=55682#p55682" onclick="prompt('Message #8',this.href); return false;">#8</a></span> 
									<a class="unread" href="viewtopic3363.html?p=55682#p55682" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistcd44.html?mode=viewprofile&amp;u=9049" class="username">lalat06bag</a></strong> &raquo; </span>10 Feb 2018 16:09
			</p>
			
			
			
			<div class="content"><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off &amp;setlocal

setlocal enableDelayedExpansion
set /a dateLen=22

set "pdfToText=C:\Users\u595142\Desktop\xpdf32\pdftotext.exe" &amp; rem source for the pdftotext exe
set "src=C:\Users\U595142\Desktop\allPdfFiles"
set "dest=C:\Users\U595142\Desktop\Today_Files"
set "allTxtFiles=C:\Users\u595142\Desktop\allTxtFiles" &amp; rem source txt folder
set "list=C:\Users\U595142\Desktop\catalog\daily_report.txt"
set "finalTxt=C:\Users\U595142\Desktop\final"
IF not EXIST "C:\Users\U595142\Desktop\catalog\error.log" type nul&gt;"C:\Users\U595142\Desktop\catalog\error.log"
IF not EXIST "C:\Users\U595142\Desktop\Today_Files" mkdir "C:\Users\U595142\Desktop\Today_Files"
IF not EXIST "C:\Users\U595142\Desktop\allTxtFiles" mkdir "C:\Users\U595142\Desktop\allTxtFiles"

for /f "delims=." %%i in ('wmic os get LocalDateTime /value') do for /f %%j in ("%%i") do set "%%j"
set "today=_%LocalDateTime:~,4%-%LocalDateTime:~4,2%-%LocalDateTime:~6,2%T*"

set "n=0"
:loop
set /a "n+=1"
set "flag="
&gt;"C:\Users\U595142\Desktop\catalog\error.log" (for /f "usebackq delims=" %%i in ("%list%") do if exist "%src%\%%~ni%today%%%~xi" (copy "%src%\%%~ni%today%%%~xi" 

"%dest%\") else (set "flag=1" &amp;echo "%%~ni%today%%%~xi" not found))

if defined flag if %n% lss 2 (timeout /t 2 /nobreak &amp;goto loop)


for /f "delims=" %%v in ('dir /b %dest%\*.pdf') do (
  "%pdfToText%" "%dest%\%%v" "%allTxtFiles%\%%~nv.txt" &gt;NUL 2&gt;&amp;1 || echo Error converting %%v
)


@RD /S /Q "C:\Users\U595142\Desktop\Today_Files"


for /f "delims=" %%v in ('dir /b /s %allTxtFiles%\*.txt') do (
  set "file=%%~nv" &amp; rem fetch filename only
  set "file=!file:~0,-%dateLen%!%%~xv" &amp; rem remove last n chars from filename and add extension
ren "%%v" "!file!" 
)



for /f "delims=" %%v in ('dir /b /s %allTxtFiles%\*.txt') do (
copy "%allTxtFiles%\*.*" "%finalTxt%\"
)

@RD /S /Q "C:\Users\U595142\Desktop\allTxtFiles"

EndLocal
exit/B</code></pre></div>

<br>
This is the code for the above requirement.</div>

			
													<div class="notice">
					Last edited by <a href="memberlistcd44.html?mode=viewprofile&amp;u=9049" class="username">lalat06bag</a> on 10 Feb 2018 17:31, edited 3 times in total.
									</div>
			
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p55685" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile55685">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistcd44.html?mode=viewprofile&amp;u=9049" class="username">lalat06bag</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf757.html?author_id=9049&amp;sr=posts">36</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Jan 2018 15:21</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content55685">

						<h3 ><a href="#p55685">Re: Help Me- removing dates from filenames</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingc2bc.html?mode=quote&amp;f=3&amp;p=55685" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic85c4.html?p=55685#p55685" onclick="prompt('Message #9',this.href); return false;">#9</a></span> 
									<a class="unread" href="viewtopic85c4.html?p=55685#p55685" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistcd44.html?mode=viewprofile&amp;u=9049" class="username">lalat06bag</a></strong> &raquo; </span>10 Feb 2018 16:55
			</p>
			
			
			
			<div class="content">Another few queries on this code. <br>
<br>
Here while converting the pdf to txt, i am keeping the required pdfs in a separate folder temporarily "Today_Files" , converting the text to AllTextFiles and finally moving all the text to final folder. <br>
In the final folder, there would be the same files with different dates as well. Need expert opinion here, if we can eliminate creating the above 2 folders and move directly the converted files to the final folder from allPdfFiles?</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
	

	<div class="action-bar bar-bottom">
	
			<a href="posting8906.html?mode=reply&amp;f=3&amp;t=8326" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic5cc9.html?f=3&amp;t=8326&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

			<form method="post" action="https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=8326">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			9 posts
							&bull; Page <strong>1</strong> of <strong>1</strong>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="viewforum4d6b.html?f=3" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to “DOS Batch Forum”</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="viewforum31e6.html?f=4" class="jumpbox-cat-link"> <span> DosTips - Dos Batch</span></a></li>
																<li><a href="viewforum4d6b.html?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; DOS Batch Forum</span></a></li>
											</ul>
		</div>
	</div>

	</div>


			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
							<span class="crumb"><a href="../index.html" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>DosTips.com</span></a></span>									<span class="crumb"><a href="index.html" data-navbar-reference="index"><span>Board index</span></a></span>					</li>
		
				<li class="rightside">All times are <span title="UTC-6">UTC-06:00</span></li>
							<li class="rightside">
				<a href="ucp033a.html?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete all board cookies</span>
				</a>
			</li>
												<li class="rightside" data-last-responsive="true">
				<a href="memberlist4bfd.html?mode=team" role="menuitem">
					<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
				</a>
			</li>
									<li class="rightside" data-last-responsive="true">
				<a href="memberlist8733.html?mode=contactadmin" role="menuitem">
					<i class="icon fa-envelope fa-fw" aria-hidden="true"></i><span>Contact us</span>
				</a>
			</li>
			</ul>

	</div>
</div>

	<div class="copyright">
				<!-- WARNING NO DELETE -->Style developer by <a href="http://tricolor.x-tk.ru/">support forum tricolor</a>, <!-- END WARNING NO DELETE -->Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
									</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	<img src="cronc6bf.gif?cron_type=cron.task.text_reparser.user_signature" width="1" height="1" alt="cron" /></div>

<script type="text/javascript" src="assets/javascript/jquery.mind772.js?assets_version=34"></script>
<script type="text/javascript" src="assets/javascript/cored772.js?assets_version=34"></script>



<script type="text/javascript" src="styles/prosilver/template/forum_fnd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/prosilver/template/ajaxd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/jquery-uid772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/collapsed772.js?assets_version=34"></script>



</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=8326&p=55685 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 08:17:02 GMT -->
</html>
