<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=4876&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 08:08:30 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>DosTips.com &bull; Colossal Cave Adventure in batch</title>

<link href="styles/AllanStyle-SUBSILVER/theme/print.css" rel="stylesheet">
</head>
<body id="phpbb">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>DosTips.com</h1>
		<p>A Forum all about DOS Batch<br /><a href="index-2.html">https://www.dostips.com/forum/</a></p>

		<h2>Colossal Cave Adventure in batch</h2>
		<p><a href="viewtopicbd95-2.html?f=3&amp;t=4876">https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=4876</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>1</strong> of <strong>2</strong></div>
					<div class="post">
				<h3>Colossal Cave Adventure in batch</h3>
				<div class="date">Posted: <strong>25 Aug 2013 16:49</strong></div>
				<div class="author">by <strong>dbenham</strong></div>
				<div class="content">Well, since I've already demonstrated how pure batch can be used to develop a classic arcade style game: SNAKE.BAT, I thought it was time to show how batch could be used to develop a text based interactive fiction game.<br /><br />Developing my own game would take a ridiculous amount of time, so I opted to port an existing game to batch.<br /><br />What better game than the grand-daddy of them all: Colossal Cave Adventure - the 350 point version by Crowther and Woods. It is the forebear of all interactive fiction games that followed.<br /><br />The batch implementation is too large to post to this forum. It can be downloaded from my DropBox: <!-- m --><a class="postlink" href="http://goo.gl/2ohAxB">http://goo.gl/2ohAxB</a><!-- m --> <span style="color: #0000FF">Current version = 1.6  2015/03/27.</span> Download the file, adventure.bat.txt, and then rename it to adventure.bat. <span style="color: #0000FF">EDIT - I've used the Google URL shortener in my link so that I can crudely track how many people have downloaded the game.</span><br /><br />The FORTRAN source code I used as a basis for my implementation is available at <!-- m --><a class="postlink" href="http://rickadams.org/adventure/e_downloads.html">http://rickadams.org/adventure/e_downloads.html</a><!-- m --><br /><br />There are only a few technical hurdles to overcome to make an effective batch IF game. The biggest issue stems from the fact that batch is an interpreted language. All of the code and data is in plain sight within the script. We don't want a player to cheat by looking at the script to figure out how to beat the game.<br /><br />The solution I used is to selectively encrypt all text messages, variable names, and labels using a simple rotation cipher. The game is first written without encryption. Text that is to be encrypted is enclosed within curly braces {}. Encrypted text can span multiple lines. Sometimes I need to be able to enable or disable encryption in a way that is invisible to the batch parser. That is easily accomplished using undefined variables %{% and %}%.<br /><br />I then include a command in the game that makes a copy of the script, with selective encryption. The command is symetric - if the running version is encrypted, then it creates the un-encrypted version, and vice-versa.<br /><br />The encrypted version of the game is ADVENTURE.BAT.  The decoded &quot;source&quot; is called ADVENTURE_SRC.BAT. During game play, the encrypted version dynamically encodes all user input so that commands may be properly parsed, and decodes all screen messages so the player can read them.<br /><br />Both versions play identically. The encrypted version is simply a little slower because it must decode any text that is displayed.<br /><br />The other hurdle I faced was how to deal with exclamation points in the database of text messages. They cause problems when delayed expansion is enabled and a FOR loop is used. I could have modified the data, but I wanted to use the original game database with minimal changes. I opted to include a routine that performs search and replace on text input, dynamically replacing each ! with an escaped form: ^!<br /><br />The rest was simply brute force design and programming (and learning how to read FORTRAN) It took about 2.5 weeks of development during nights and weekends.<br /><br />My version of this classic is intended to be a mostly faithful replica of the original. Here are a list of known differences from the Plotkin version that I used as my source:<br /><br />- Command words have been restored to the first 5 characters of the word, instead of 4. This is in keeping with the original Crowther version.<br /><br />- Command parsing and error messages have been reworked, especially the message for a verb with a missing object. But it should not impact game play.<br /><br />- Bridges may be crossed using compass points. The restriction on using a special crossing verb seemed silly.<br /><br />- The &quot;BACK&quot; command is implemented in a simpler way. Its behavior is very similar to, but not exactly the same as the original.<br /><br />- A few choice synonyms have been added.<br /><br />- The &quot;GRATE&quot; serves only as a noun, never a movement word.<br /><br />- A hint for the elusive last point has been incorporated into the game.<br /><br />- Completing the game required a random event. Sometimes the random event never occurred in the original, making it impossible for the player to complete the game, even though the player made all the right moves. I made a slight change to the end game mechanics to nearly guarantee that a well played game can always be completed.<br /><br />- There is one aspect of the end game code that I did not understand. I had to comment out one instruction to get the game to work. I think I got it correct, but I'm not sure. <span style="color: #0000BF">This issue was fixed in version 1.4</span><br /><br />I've done a fair amount of play testing, but certainly not exhaustive testing. Please let me know if you find any bugs, or incorrect behavior.<br /><br />The link near the top is to the encrypted version of the game. Instructions for getting the un-encrypted version are below. But I suggest you avoid looking at the un-encrypted code if you have never played the game before.<br /><br />I fully expect there to be bug fixes over time. I will post changes to my Google site, and post notifiation to this thread.<br /><br />---------------------------------------------------------------------------------------<br /><br />Below are the instructions on how to decode the script, in case you want to see how the program works. I've embedded the key word below in a way that you won't accidentally see it.<br /><br />One by one, you get the letters. Be sure you do this correctly. Follow the instructions carefully. Use the first uppercase letter of each sentence in this paragraph. Since the source and walkthrus are readily available on the web, it's not a big deal to publish the un-encrypted form. Caution: don't do this if you don't want to see any spoilers. After you collect all the letters, put them together to get the command word. The command to decode/encode the script takes about 15 minutes to run. Enter the command immediately after answering the instructions question - it will not work at any other point in the game.<br /><br />Enjoy<br /><br />Dave Benham</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Colossal Cave Adventure in batch</h3>
				<div class="date">Posted: <strong>25 Aug 2013 22:27</strong></div>
				<div class="author">by <strong>brinda</strong></div>
				<div class="content">dave thanks. still playing...<br /><br /> <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /> great flute music as well on your google site. listening to flute as background music while playing the game.<br /><br />thanks.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Colossal Cave Adventure in batch</h3>
				<div class="date">Posted: <strong>25 Aug 2013 22:36</strong></div>
				<div class="author">by <strong>dbenham</strong></div>
				<div class="content">Cool  <img class="smilies" src="images/smilies/icon_cool.gif" alt="8)" title="Cool" /> <br /><br />Totally off topic, but if you like the music, I have about 2 hours worth posted at SoundCloud - <!-- m --><a class="postlink" href="https://soundcloud.com/dave-benham">https://soundcloud.com/dave-benham</a><!-- m --><br /><br /><br />Dave Benham</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Colossal Cave Adventure in batch</h3>
				<div class="date">Posted: <strong>25 Aug 2013 23:28</strong></div>
				<div class="author">by <strong>foxidrive</strong></div>
				<div class="content">A brief play here - amazing to think that you've done all this work Dave.  Good fun!<br /><br />I did notice two things - you have a typo in 'infromation'<br /><br />and when I quit, the console printed my score and something else and then exited without letting me read it.<br /><br />Cheers</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Colossal Cave Adventure in batch</h3>
				<div class="date">Posted: <strong>26 Aug 2013 10:39</strong></div>
				<div class="author">by <strong>dbenham</strong></div>
				<div class="content">Thanks foxidrive<br /><br />I fixed the spelling, and added a PAUSE to the end of the game.<br /><br /><br />Dave Benham</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Colossal Cave Adventure in batch</h3>
				<div class="date">Posted: <strong>26 Aug 2013 19:36</strong></div>
				<div class="author">by <strong>brinda</strong></div>
				<div class="content">dave,<br /><br />the game is saved. on loading back there is an error<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&gt;load<br /><br />Game restored.<br /><br />Load failed - Incorrect save version</code></pre></div><br /><br />it loads back where i was. just wondering if the error is a wrong thing on my part</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Colossal Cave Adventure in batch</h3>
				<div class="date">Posted: <strong>26 Aug 2013 22:52</strong></div>
				<div class="author">by <strong>dbenham</strong></div>
				<div class="content">That isn't right  <img class="smilies" src="images/smilies/icon_sad.gif" alt=":(" title="Sad" /> <br /><br />Either message is valid, but not both   <img class="smilies" src="images/smilies/icon_confused.gif" alt=":?" title="Confused" /> <br /><br />I've tried every way I can think of, but I can't reproduce that behavior.<br /><br />What version of Windows are you using? Are you running adventure.bat? or adventure_src.bat?<br /><br /><br />Dave Benham</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Colossal Cave Adventure in batch</h3>
				<div class="date">Posted: <strong>27 Aug 2013 06:15</strong></div>
				<div class="author">by <strong>brinda</strong></div>
				<div class="content">sorry dave,<br />was not descriptive <img class="smilies" src="images/smilies/icon_sad.gif" alt=":(" title="Sad" /> . <br /><br />This will be long<br /><br />1. have download the new version from google site. Using WINXP SP3(not virtual) + win2000 SP4<br /><br />it took around 30mins to get adventure_src.bat.  <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /> No error on this [winxp SP3]<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&gt;down<br /><br />You don't fit through a two-inch slit!<br /><br />You're at slit in streambed.<br /><br />&gt;save<br /><br />Game saved.<br /><br />&gt;load<br /><br />Game restored.<br /><br />&gt;</code></pre></div><br /><br /><br />Below is from winxp sp3 using adventure.bat<br /><br />Below is saved on adventure.bat, quit and reload on open<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>Welcome to Adventure!!<br /><br />Instructions are available at a cost of five points deducted from your<br />final score. If you decline the instructions, then I will assume you are<br />experienced and you will have less time to complete your adventure.<br /><br />Would you like instructions?<br /><br />&gt;no<br /><br />You are standing at the end of a road before a small brick building.<br />Around you is a forest.&nbsp; A small stream flows out of the building and<br />down a gully.<br /><br />&gt;load<br /><br />Game restored.<br /><br />Load failed - Incorrect save version<br /><br />&gt;</code></pre></div><br /><br /><br />Below is the full walkthrough - reloading within after save [winxp sp3 using adventure.bat]<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>Welcome to Adventure!!<br /><br />Instructions are available at a cost of five points deducted from your<br />final score. If you decline the instructions, then I will assume you are<br />experienced and you will have less time to complete your adventure.<br /><br />Would you like instructions?<br /><br />&gt;yes<br /><br />Somewhere nearby is Colossal Cave, where others have found fortunes in<br />treasure and gold, though it is rumored that some who enter are never<br />seen again.&nbsp; Magic is said to work in the cave.&nbsp; I will be your eyes<br />and hands.&nbsp; Direct me with commands of 1 or 2 words.&nbsp; I should warn<br />you that I look at only the first five letters of each word, so you'll<br />have to enter &quot;NORTHEAST&quot; as &quot;NE&quot; to distinguish it from &quot;NORTH&quot;.<br /><br />Should you get stuck, type &quot;HELP&quot; for some general hints.&nbsp; For infor-<br />mation on how to end your adventure, etc., type &quot;INFO&quot;.&nbsp; For information<br />about this version of the game, as well as its history, type &quot;VERSION&quot;.<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - - -<br /><br />You are standing at the end of a road before a small brick building.<br />Around you is a forest.&nbsp; A small stream flows out of the building and<br />down a gully.<br /><br />&gt;n<br /><br />You are in open forest, with a deep valley to one side.<br /><br />&gt;n<br /><br />You're in forest.<br /><br />&gt;down<br /><br />You are in a valley in the forest beside a stream tumbling along a<br />rocky bed.<br /><br />&gt;down<br /><br />At your feet all the water of the stream splashes into a 2-inch slit<br />in the rock.&nbsp; Downstream the streambed is bare rock.<br /><br />&gt;save<br /><br />Game saved.<br /><br />&gt;load<br /><br />Game restored.<br /><br />Load failed - Incorrect save version<br /><br />&gt;</code></pre></div><br /><br />below is from adventure.sav<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>#{abgSbhaqPag}=15<br />#{arjybp}=7<br />#{bowCebc}.1=0<br />#{bowCebc}.10=0<br />#{bowCebc}.11=0<br />#{bowCebc}.12=0<br />#{bowCebc}.13=0<br />#{bowCebc}.14=0<br />#{bowCebc}.15=0<br />#{bowCebc}.16=0<br />#{bowCebc}.19=0<br />#{bowCebc}.2=0<br />#{bowCebc}.20=0<br />#{bowCebc}.21=0<br />#{bowCebc}.22=0<br />#{bowCebc}.23=0<br />#{bowCebc}.24=0<br />#{bowCebc}.25=0<br />#{bowCebc}.26=0<br />#{bowCebc}.27=0<br />#{bowCebc}.28=0<br />#{bowCebc}.29=0<br />#{bowCebc}.3=0<br />#{bowCebc}.30=0<br />#{bowCebc}.31=0<br />#{bowCebc}.32=0<br />#{bowCebc}.33=0<br />#{bowCebc}.34=0<br />#{bowCebc}.35=0<br />#{bowCebc}.36=0<br />#{bowCebc}.37=0<br />#{bowCebc}.38=0<br />#{bowCebc}.39=0<br />#{bowCebc}.4=0<br />#{bowCebc}.40=0<br />#{bowCebc}.5=0<br />#{bowCebc}.50=-1<br />#{bowCebc}.51=-1<br />#{bowCebc}.52=-1<br />#{bowCebc}.53=-1<br />#{bowCebc}.54=-1<br />#{bowCebc}.55=-1<br />#{bowCebc}.56=-1<br />#{bowCebc}.57=-1<br />#{bowCebc}.58=-1<br />#{bowCebc}.59=-1<br />#{bowCebc}.6=0<br />#{bowCebc}.60=-1<br />#{bowCebc}.61=-1<br />#{bowCebc}.62=-1<br />#{bowCebc}.63=-1<br />#{bowCebc}.64=-1<br />#{bowCebc}.7=0<br />#{bowCebc}.8=0<br />#{bowCebc}.9=0<br />#{bowCynpr}.1=3<br />#{bowCynpr}.10=96<br />#{bowCynpr}.11=19<br />#{bowCynpr}.12=17<br />#{bowCynpr}.13=101<br />#{bowCynpr}.14=103<br />#{bowCynpr}.15=0<br />#{bowCynpr}.16=106<br />#{bowCynpr}.17=0<br />#{bowCynpr}.18=0<br />#{bowCynpr}.19=3<br />#{bowCynpr}.2=3<br />#{bowCynpr}.20=3<br />#{bowCynpr}.21=0<br />#{bowCynpr}.22=0<br />#{bowCynpr}.23=109<br />#{bowCynpr}.24=25<br />#{bowCynpr}.25=23<br />#{bowCynpr}.26=111<br />#{bowCynpr}.27=35<br />#{bowCynpr}.28=0<br />#{bowCynpr}.29=97<br />#{bowCynpr}.3=8<br />#{bowCynpr}.30=0<br />#{bowCynpr}.31=119<br />#{bowCynpr}.32=117<br />#{bowCynpr}.33=117<br />#{bowCynpr}.34=0<br />#{bowCynpr}.35=130<br />#{bowCynpr}.36=0<br />#{bowCynpr}.37=126<br />#{bowCynpr}.38=140<br />#{bowCynpr}.39=0<br />#{bowCynpr}.4=10<br />#{bowCynpr}.40=96<br />#{bowCynpr}.5=11<br />#{bowCynpr}.50=18<br />#{bowCynpr}.51=27<br />#{bowCynpr}.52=28<br />#{bowCynpr}.53=29<br />#{bowCynpr}.54=30<br />#{bowCynpr}.55=0<br />#{bowCynpr}.56=92<br />#{bowCynpr}.57=95<br />#{bowCynpr}.58=97<br />#{bowCynpr}.59=100<br />#{bowCynpr}.6=0<br />#{bowCynpr}.60=101<br />#{bowCynpr}.61=0<br />#{bowCynpr}.62=119<br />#{bowCynpr}.63=127<br />#{bowCynpr}.64=130<br />#{bowCynpr}.7=14<br />#{bowCynpr}.8=13<br />#{bowCynpr}.9=94<br />#{bowSvkrq}.1=0<br />#{bowSvkrq}.10=0<br />#{bowSvkrq}.11=-1<br />#{bowSvkrq}.12=27<br />#{bowSvkrq}.13=-1<br />#{bowSvkrq}.14=0<br />#{bowSvkrq}.15=0<br />#{bowSvkrq}.16=0<br />#{bowSvkrq}.17=-1<br />#{bowSvkrq}.18=0<br />#{bowSvkrq}.19=0<br />#{bowSvkrq}.2=0<br />#{bowSvkrq}.20=0<br />#{bowSvkrq}.21=0<br />#{bowSvkrq}.22=0<br />#{bowSvkrq}.23=-1<br />#{bowSvkrq}.24=-1<br />#{bowSvkrq}.25=67<br />#{bowSvkrq}.26=-1<br />#{bowSvkrq}.27=110<br />#{bowSvkrq}.28=0<br />#{bowSvkrq}.29=-1<br />#{bowSvkrq}.3=9<br />#{bowSvkrq}.30=-1<br />#{bowSvkrq}.31=121<br />#{bowSvkrq}.32=122<br />#{bowSvkrq}.33=122<br />#{bowSvkrq}.34=0<br />#{bowSvkrq}.35=-1<br />#{bowSvkrq}.36=-1<br />#{bowSvkrq}.37=-1<br />#{bowSvkrq}.38=-1<br />#{bowSvkrq}.39=0<br />#{bowSvkrq}.4=0<br />#{bowSvkrq}.40=-1<br />#{bowSvkrq}.5=0<br />#{bowSvkrq}.50=0<br />#{bowSvkrq}.51=0<br />#{bowSvkrq}.52=0<br />#{bowSvkrq}.53=0<br />#{bowSvkrq}.54=0<br />#{bowSvkrq}.55=0<br />#{bowSvkrq}.56=0<br />#{bowSvkrq}.57=0<br />#{bowSvkrq}.58=0<br />#{bowSvkrq}.59=0<br />#{bowSvkrq}.6=0<br />#{bowSvkrq}.60=0<br />#{bowSvkrq}.61=0<br />#{bowSvkrq}.62=121<br />#{bowSvkrq}.63=0<br />#{bowSvkrq}.64=-1<br />#{bowSvkrq}.7=15<br />#{bowSvkrq}.8=0<br />#{bowSvkrq}.9=-1<br />#{byqYbp2}=5<br />#{byqYbp}=4<br />#{cnavp}=0<br />#{cynprBowf}.-1= <br />#{cynprBowf}.0= 6 15 18 21 22 28 34 39 55 61 17 30 36<br />#{cynprBowf}.1= <br />#{cynprBowf}.10= 4 <br />#{cynprBowf}.100= 59 <br />#{cynprBowf}.101= 60 13 <br />#{cynprBowf}.102= <br />#{cynprBowf}.103= 14 <br />#{cynprBowf}.104= <br />#{cynprBowf}.105= <br />#{cynprBowf}.106= 16 <br />#{cynprBowf}.107= <br />#{cynprBowf}.108= <br />#{cynprBowf}.109= 23 <br />#{cynprBowf}.11= 5 <br />#{cynprBowf}.110= 127 <br />#{cynprBowf}.111= 26 <br />#{cynprBowf}.112= <br />#{cynprBowf}.113= <br />#{cynprBowf}.114= <br />#{cynprBowf}.115= <br />#{cynprBowf}.116= <br />#{cynprBowf}.117= 32 33 <br />#{cynprBowf}.118= <br />#{cynprBowf}.119= 31 62 <br />#{cynprBowf}.12= <br />#{cynprBowf}.120= <br />#{cynprBowf}.121= 131 162 <br />#{cynprBowf}.122= 132 133 <br />#{cynprBowf}.123= <br />#{cynprBowf}.124= <br />#{cynprBowf}.125= <br />#{cynprBowf}.126= 37 <br />#{cynprBowf}.127= 63 <br />#{cynprBowf}.128= <br />#{cynprBowf}.129= <br />#{cynprBowf}.13= 8 <br />#{cynprBowf}.130= 35 64 <br />#{cynprBowf}.131= <br />#{cynprBowf}.132= <br />#{cynprBowf}.133= <br />#{cynprBowf}.134= <br />#{cynprBowf}.135= <br />#{cynprBowf}.136= <br />#{cynprBowf}.137= <br />#{cynprBowf}.138= <br />#{cynprBowf}.139= <br />#{cynprBowf}.14= 7 <br />#{cynprBowf}.140= 38 <br />#{cynprBowf}.15= 107 <br />#{cynprBowf}.16= <br />#{cynprBowf}.17= 12 <br />#{cynprBowf}.18= 50 <br />#{cynprBowf}.19= 11 <br />#{cynprBowf}.2= <br />#{cynprBowf}.20= <br />#{cynprBowf}.21= <br />#{cynprBowf}.22= <br />#{cynprBowf}.23= 25 <br />#{cynprBowf}.24= <br />#{cynprBowf}.25= 24 <br />#{cynprBowf}.26= <br />#{cynprBowf}.27= 51 112 <br />#{cynprBowf}.28= 52 <br />#{cynprBowf}.29= 53 <br />#{cynprBowf}.3= 1 2 19 20 <br />#{cynprBowf}.30= 54 <br />#{cynprBowf}.31= <br />#{cynprBowf}.32= <br />#{cynprBowf}.33= <br />#{cynprBowf}.34= <br />#{cynprBowf}.35= 27 <br />#{cynprBowf}.36= <br />#{cynprBowf}.37= <br />#{cynprBowf}.38= <br />#{cynprBowf}.39= <br />#{cynprBowf}.4= <br />#{cynprBowf}.40= <br />#{cynprBowf}.41= <br />#{cynprBowf}.42= <br />#{cynprBowf}.43= <br />#{cynprBowf}.44= <br />#{cynprBowf}.45= <br />#{cynprBowf}.46= <br />#{cynprBowf}.47= <br />#{cynprBowf}.48= <br />#{cynprBowf}.49= <br />#{cynprBowf}.5= <br />#{cynprBowf}.50= <br />#{cynprBowf}.51= <br />#{cynprBowf}.52= <br />#{cynprBowf}.53= <br />#{cynprBowf}.54= <br />#{cynprBowf}.55= <br />#{cynprBowf}.56= <br />#{cynprBowf}.57= <br />#{cynprBowf}.58= <br />#{cynprBowf}.59= <br />#{cynprBowf}.6= <br />#{cynprBowf}.60= <br />#{cynprBowf}.61= <br />#{cynprBowf}.62= <br />#{cynprBowf}.63= <br />#{cynprBowf}.64= <br />#{cynprBowf}.65= <br />#{cynprBowf}.66= <br />#{cynprBowf}.67= 125 <br />#{cynprBowf}.68= <br />#{cynprBowf}.69= <br />#{cynprBowf}.7= <br />#{cynprBowf}.70= <br />#{cynprBowf}.71= <br />#{cynprBowf}.72= <br />#{cynprBowf}.73= <br />#{cynprBowf}.74= <br />#{cynprBowf}.75= <br />#{cynprBowf}.76= <br />#{cynprBowf}.77= <br />#{cynprBowf}.78= <br />#{cynprBowf}.79= <br />#{cynprBowf}.8= 3 <br />#{cynprBowf}.80= <br />#{cynprBowf}.81= <br />#{cynprBowf}.82= <br />#{cynprBowf}.83= <br />#{cynprBowf}.84= <br />#{cynprBowf}.85= <br />#{cynprBowf}.86= <br />#{cynprBowf}.87= <br />#{cynprBowf}.88= <br />#{cynprBowf}.89= <br />#{cynprBowf}.9= 103 <br />#{cynprBowf}.90= <br />#{cynprBowf}.91= <br />#{cynprBowf}.92= 56 <br />#{cynprBowf}.93= <br />#{cynprBowf}.94= 9 <br />#{cynprBowf}.95= 57 <br />#{cynprBowf}.96= 10 40 <br />#{cynprBowf}.97= 58 29 <br />#{cynprBowf}.98= <br />#{cynprBowf}.99= <br />#{cynprNooe}.1=1<br />#{cynprNooe}.10=0<br />#{cynprNooe}.100=0<br />#{cynprNooe}.101=0<br />#{cynprNooe}.102=0<br />#{cynprNooe}.103=0<br />#{cynprNooe}.104=0<br />#{cynprNooe}.105=0<br />#{cynprNooe}.106=0<br />#{cynprNooe}.107=0<br />#{cynprNooe}.108=0<br />#{cynprNooe}.109=0<br />#{cynprNooe}.11=0<br />#{cynprNooe}.110=0<br />#{cynprNooe}.111=0<br />#{cynprNooe}.112=0<br />#{cynprNooe}.113=0<br />#{cynprNooe}.114=0<br />#{cynprNooe}.115=0<br />#{cynprNooe}.116=0<br />#{cynprNooe}.117=0<br />#{cynprNooe}.118=0<br />#{cynprNooe}.119=0<br />#{cynprNooe}.12=0<br />#{cynprNooe}.120=0<br />#{cynprNooe}.121=0<br />#{cynprNooe}.122=0<br />#{cynprNooe}.123=0<br />#{cynprNooe}.124=0<br />#{cynprNooe}.125=0<br />#{cynprNooe}.126=0<br />#{cynprNooe}.127=0<br />#{cynprNooe}.128=0<br />#{cynprNooe}.129=0<br />#{cynprNooe}.13=0<br />#{cynprNooe}.130=0<br />#{cynprNooe}.131=0<br />#{cynprNooe}.132=0<br />#{cynprNooe}.133=0<br />#{cynprNooe}.134=0<br />#{cynprNooe}.135=0<br />#{cynprNooe}.136=0<br />#{cynprNooe}.137=0<br />#{cynprNooe}.138=0<br />#{cynprNooe}.139=0<br />#{cynprNooe}.14=0<br />#{cynprNooe}.140=0<br />#{cynprNooe}.15=0<br />#{cynprNooe}.16=0<br />#{cynprNooe}.17=0<br />#{cynprNooe}.18=0<br />#{cynprNooe}.19=0<br />#{cynprNooe}.2=0<br />#{cynprNooe}.20=0<br />#{cynprNooe}.21=0<br />#{cynprNooe}.22=0<br />#{cynprNooe}.23=0<br />#{cynprNooe}.24=0<br />#{cynprNooe}.25=0<br />#{cynprNooe}.26=0<br />#{cynprNooe}.27=0<br />#{cynprNooe}.28=0<br />#{cynprNooe}.29=0<br />#{cynprNooe}.3=0<br />#{cynprNooe}.30=0<br />#{cynprNooe}.31=0<br />#{cynprNooe}.32=0<br />#{cynprNooe}.33=0<br />#{cynprNooe}.34=0<br />#{cynprNooe}.35=0<br />#{cynprNooe}.36=0<br />#{cynprNooe}.37=0<br />#{cynprNooe}.38=0<br />#{cynprNooe}.39=0<br />#{cynprNooe}.4=1<br />#{cynprNooe}.40=0<br />#{cynprNooe}.41=0<br />#{cynprNooe}.42=0<br />#{cynprNooe}.43=0<br />#{cynprNooe}.44=0<br />#{cynprNooe}.45=0<br />#{cynprNooe}.46=0<br />#{cynprNooe}.47=0<br />#{cynprNooe}.48=0<br />#{cynprNooe}.49=0<br />#{cynprNooe}.5=2<br />#{cynprNooe}.50=0<br />#{cynprNooe}.51=0<br />#{cynprNooe}.52=0<br />#{cynprNooe}.53=0<br />#{cynprNooe}.54=0<br />#{cynprNooe}.55=0<br />#{cynprNooe}.56=0<br />#{cynprNooe}.57=0<br />#{cynprNooe}.58=0<br />#{cynprNooe}.59=0<br />#{cynprNooe}.6=0<br />#{cynprNooe}.60=0<br />#{cynprNooe}.61=0<br />#{cynprNooe}.62=0<br />#{cynprNooe}.63=0<br />#{cynprNooe}.64=0<br />#{cynprNooe}.65=0<br />#{cynprNooe}.66=0<br />#{cynprNooe}.67=0<br />#{cynprNooe}.68=0<br />#{cynprNooe}.69=0<br />#{cynprNooe}.7=1<br />#{cynprNooe}.70=0<br />#{cynprNooe}.71=0<br />#{cynprNooe}.72=0<br />#{cynprNooe}.73=0<br />#{cynprNooe}.74=0<br />#{cynprNooe}.75=0<br />#{cynprNooe}.76=0<br />#{cynprNooe}.77=0<br />#{cynprNooe}.78=0<br />#{cynprNooe}.79=0<br />#{cynprNooe}.8=0<br />#{cynprNooe}.80=0<br />#{cynprNooe}.81=0<br />#{cynprNooe}.82=0<br />#{cynprNooe}.83=0<br />#{cynprNooe}.84=0<br />#{cynprNooe}.85=0<br />#{cynprNooe}.86=0<br />#{cynprNooe}.87=0<br />#{cynprNooe}.88=0<br />#{cynprNooe}.89=0<br />#{cynprNooe}.9=0<br />#{cynprNooe}.90=0<br />#{cynprNooe}.91=0<br />#{cynprNooe}.92=0<br />#{cynprNooe}.93=0<br />#{cynprNooe}.94=0<br />#{cynprNooe}.95=0<br />#{cynprNooe}.96=0<br />#{cynprNooe}.97=0<br />#{cynprNooe}.98=0<br />#{cynprNooe}.99=0<br />#{fnirIrefvba}=1<br />#{fpbevat}=0<br />#{gheaf}=5<br />#{jnfQnex}=0<br />#{nooAhz}=5<br />#{obahf}=0<br />#{pybfrq}=0<br />#{pybfvat}=0<br />#{pybpx1}=30<br />#{pybpx2}=50<br />#{qjnesByqYbp}.1=19<br />#{qjnesByqYbp}.2=27<br />#{qjnesByqYbp}.3=33<br />#{qjnesByqYbp}.4=44<br />#{qjnesByqYbp}.5=64<br />#{qjnesByqYbp}.6=114<br />#{qjnesFgngr}=0<br />#{qjnesFrra}.1=0<br />#{qjnesFrra}.2=0<br />#{qjnesFrra}.3=0<br />#{qjnesFrra}.4=0<br />#{qjnesFrra}.5=0<br />#{qjnesFrra}.6=0<br />#{qjnesYbp}.1=19<br />#{qjnesYbp}.2=27<br />#{qjnesYbp}.3=33<br />#{qjnesYbp}.4=44<br />#{qjnesYbp}.5=64<br />#{qjnesYbp}.6=114<br />#{qrgnvyPag}=0<br />#{qrnqQjnesPag}=0<br />#{qvrPag}=0<br />#{sbbPag}=0<br />#{tnirhc}=0<br />#{ubyqPag}=0<br />#{uvagGheaf}.2=0<br />#{uvagGheaf}.3=0<br />#{uvagGheaf}.4=0<br />#{uvagGheaf}.5=0<br />#{uvagGheaf}.6=0<br />#{uvagGheaf}.7=0<br />#{uvagGheaf}.8=0<br />#{uvagGheaf}.9=0<br />#{uvagrq}.2=0<br />#{uvagrq}.3=1<br />#{uvagrq}.4=0<br />#{uvagrq}.5=0<br />#{uvagrq}.6=0<br />#{uvagrq}.7=0<br />#{uvagrq}.8=0<br />#{uvagrq}.9=0<br />#{xavsrYbp}=0<br />#{ybfgPag}=0<br />#{ybp}=7<br />#{ynzcJnea}=0<br />#{ynzcYbj}=0<br />#{ynzcYvsr}=1000<br /></code></pre></div></div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Colossal Cave Adventure in batch</h3>
				<div class="date">Posted: <strong>27 Aug 2013 07:22</strong></div>
				<div class="author">by <strong>dbenham</strong></div>
				<div class="content">Great description of the problem brinda, thanks.<br /><br />I'll see if I can reproduce the behavior on my XP virtual machine, and (hopefully) fix the problem. It may take a while though, because I have a lot of other things going on right now.<br /><br /><br />Dave Benham</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Colossal Cave Adventure in batch</h3>
				<div class="date">Posted: <strong>27 Aug 2013 22:23</strong></div>
				<div class="author">by <strong>dbenham</strong></div>
				<div class="content">OK - I diagnosed the problem  <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /> <br /><br />The problem was from a seemingly innocuous statement like: SET &quot;VAR=&quot;<br /><br />It turns out that XP silently sets ERRORLEVEL to 1 when undefining a variable <span style="color: #0000FF">that does not exist (thanks penpen for the clarification)</span>. But more modern Windows systems do not set the ERRORLEVEL to 1. The unexpected error was causing a problem with my conditional logic in the LOAD routine.<br /><br />I had tested the LOAD function on XP before, but since then I restructured some unrelated logic that inadvertently brought the error into play.<br /><br />I've fixed the immediate problem, and uploaded version 1.2 to my Google site. I think it is good to go, but there is the potential for more unintended side effects on XP.<br /><br />When I get some more time I will do some play throughs on XP to make sure everything is working as it should.<br /><br /><br />Dave Benham</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Colossal Cave Adventure in batch</h3>
				<div class="date">Posted: <strong>28 Aug 2013 09:18</strong></div>
				<div class="author">by <strong>carlos</strong></div>
				<div class="content">Dave, I read that using the .bat extension in filename errorlevel change only on failure, and using .cmd errorlevel change on error and success.<br /><br />test.bat<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />cmd /c exit /b 20<br />set &quot;var=foo&quot;<br />echo(%errorlevel%<br />pause<br /></code></pre></div><br />prints 20.<br /><br />test.cmd<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />cmd /c exit /b 20<br />set &quot;var=foo&quot;<br />echo(%errorlevel%<br />pause<br /></code></pre></div><br />prints 0.<br /><br />maybe this info should be useful for your implentation.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Colossal Cave Adventure in batch</h3>
				<div class="date">Posted: <strong>28 Aug 2013 09:49</strong></div>
				<div class="author">by <strong>dbenham</strong></div>
				<div class="content">Thanks carlos. Funny you should say that. I just wrote the same thing in a private message to penpen, and then realized I could have probably solved the ADVENTURE XP problem by switching to the .CMD extension.<br /><br />But I have already solved the problem by explicitly exiting routines with EXIT /B 0 instead of just EXIT /B. (Except a few where I intentionally want to return the current ERRORLEVEL).<br /><br />I don't think I ever test %ERRORLEVEL% in my code. That is susceptible to detecting errors from commands executed long ago.<br /><br />My code exclusively uses &amp;&amp; and ||, which only look at the return status of the most recently executed command. Where I ran into a problem is that in the LOAD routine, the last command prior to || was a CALL to a subroutine. The routine was setting ERRORLEVEL to 1 early in the routine, and nothing cleared it. So the routine's EXIT /B was passing back an error to CALL, which then in turn fired the || logic. Simply exiting with EXIT /B 0 solved the problem.<br /><br />Here is the logic that was causing the problem:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>comand1 &amp;&amp; (<br />&nbsp; successCommand1<br />&nbsp; successCommand2<br />&nbsp; call&nbsp; :subroutine<br />) || (<br />&nbsp; failureCommand<br />)<br /></code></pre></div><br />The :subroutine was returning error status 1 because of SET &quot;VAR=&quot; early in the routine, even though the routine was executing perfectly.<br /><br /><br />Dave Benham</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Colossal Cave Adventure in batch</h3>
				<div class="date">Posted: <strong>28 Aug 2013 20:46</strong></div>
				<div class="author">by <strong>dbenham</strong></div>
				<div class="content">I've posted version 1.3 to my Google site. The only difference is it disables some debugging commands that were accidentally left in place in the prior versions.<br /><br />Dave Benham</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Colossal Cave Adventure in batch</h3>
				<div class="date">Posted: <strong>29 Aug 2013 04:46</strong></div>
				<div class="author">by <strong>brinda</strong></div>
				<div class="content">dave,<br />thanks all good <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /></div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Colossal Cave Adventure in batch</h3>
				<div class="date">Posted: <strong>27 Oct 2013 10:02</strong></div>
				<div class="author">by <strong>dbenham</strong></div>
				<div class="content">I've posted version 1.4 to my Google site. It has significant bug fixes to the end game.<br /><br />I had posted info about my batch port to <a href="http://forums.delphiforums.com/n/main.asp?webtag=xyzzy&amp;msg=444.1" class="postlink">Rick Adams' Colossal Cave Adventure Forum</a>, and forum user Quuxplusone sent me a private message with invaluable info on how to fix some end game problems. The prior version worked somewhat, but the new version is much better.<br /><br /><br />Dave Benham</div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="UTC-6">UTC-06:00</span><br />Page <strong>1</strong> of <strong>2</strong></div>
		<div class="copyright">Powered by phpBB&reg; Forum Software &copy; phpBB Limited<br />https://www.phpbb.com/</div>
	</div>
</div>

</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=4876&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 08:08:30 GMT -->
</html>
