<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?p=49523 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 06:46:50 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>self-compiled .net hybrids - Page 2 - DosTips.com</title>


	<link rel="canonical" href="viewtopic8d30.html?t=5260&amp;start=15">

<!--
	phpBB style name: Allan Style - SUBSILVER
	Based on style:   prosilver (this is the default phpBB3 style)
	Based on style:   subsilver2 (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:  Allan ( http://x-tk.ru/ )
-->

<link href="assets/css/font-awesome.mind772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/stylesheetd772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/en/stylesheetd772.css?assets_version=34" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="./styles/AllanStyle-SUBSILVER/theme/tweaks.css?assets_version=34" rel="stylesheet">
<![endif]-->




<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','../../www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-280191-1', 'auto');
	ga('send', 'pageview');
</script>

</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">

<div id="header-subsilver">
	<a id="top" class="top-anchor" accesskey="t"></a>
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description" class="site-description">
				<a id="logo" class="logo" href="../index.html" title="DosTips.com"><span class="site_logo"></span></a>
				<h1>DosTips.com</h1>
				<p>A Forum all about DOS Batch</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

									<div id="search-box" class="search-box search-header" role="search">
				<form action="https://www.dostips.com/forum/search.php" method="get" id="search">
				<fieldset>
					<input name="keywords" id="keywords" type="search" maxlength="128" title="Search for keywords" class="inputbox search tiny" size="20" value="" placeholder="Search…" />
					<button class="button button-search" type="submit" title="Search">
						<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
					</button>
					<a href="search.html" class="button button-search-end" title="Advanced search">
						<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
					</a>
					
				</fieldset>
				</form>
			</div>
						
			</div>
					</div>
</div>


<div id="wrap" class="wrap">
	<div id="page-header">
				<div class="navbar-top" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
																									<li>
								<a href="search33a7.html?search_id=unanswered" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="search526f.html?search_id=active_topics" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-blue" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="search.html" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
											<li class="separator"></li>
																			<li>
								<a href="memberlist4bfd.html?mode=team" role="menuitem">
									<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
								</a>
							</li>
																<li class="separator"></li>

									</ul>
			</div>
		</li>

				<li data-skip-responsive="true">
			<a href="app.php/help/faq.html" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
						
			<li class="rightside"  data-skip-responsive="true">
			<a href="ucp26c3.html?mode=login" title="Login" accesskey="x" role="menuitem">
				<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Login</span>
			</a>
		</li>
					<li class="rightside" data-skip-responsive="true">
				<a href="ucp8319.html?mode=register" role="menuitem">
					<i class="icon fa-pencil-square-o  fa-fw" aria-hidden="true"></i><span>Register</span>
				</a>
			</li>
						</ul>

	</div>
</div>

<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
						<li class="breadcrumbs">
							<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="../index.html" itemprop="url" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span itemprop="title">DosTips.com</span></a></span>
										<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="index.html" itemprop="url" accesskey="h" data-navbar-reference="index"><span itemprop="title">Board index</span></a></span>

											<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="4"><a href="viewforum31e6.html?f=4" itemprop="url"><span itemprop="title">DosTips - Dos Batch</span></a></span>
															<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="3"><a href="viewforum4d6b.html?f=3" itemprop="url"><span itemprop="title">DOS Batch Forum</span></a></span>
												</li>
		
					<li class="rightside responsive-search">
				<a href="search.html" title="View the advanced search options" role="menuitem">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</a>
			</li>
			</ul>

	</div>
</div>

<div class="navbar-top-link">
	<div class="inner">
		<ul>
			<li class="navbar-top-link-left"><a href="search33a7.html?search_id=unanswered">Unanswered topics</a></li>
			<li class="navbar-top-link-left"><a href="search526f.html?search_id=active_topics">Active topics</a></li>

											</ul>
	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
		
<h2 class="topic-title"><a href="viewtopicda59.html?f=3&amp;t=5260&amp;start=15">self-compiled .net hybrids</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">Discussion forum for all Windows batch related topics.<br /></div>
<p>
	<strong>Moderator:</strong> <a href="memberlista6a8.html?mode=viewprofile&amp;u=5" class="username">DosItHelp</a>
</p>


<div class="action-bar bar-top">
	
			<a href="postingd64b.html?mode=reply&amp;f=3&amp;t=5260" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic1392.html?f=3&amp;t=5260&amp;start=15&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="https://www.dostips.com/forum/search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topic…" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="search.html" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="5260" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			23 posts
							<ul>
			<li class="arrow previous"><a class="button button-icon-only" href="viewtopicdcbd.html?f=3&amp;t=5260" rel="prev" role="button"><i class="icon fa-chevron-left fa-fw" aria-hidden="true"></i><span class="sr-only">Previous</span></a></li>
				<li><a class="button" href="viewtopicdcbd.html?f=3&amp;t=5260" role="button">1</a></li>
			<li class="active"><span>2</span></li>
	</ul>
					</div>
		</div>




<div id="subsilver-nav-topic">
	<div class="inner"><div class="post has-profile">
		<div class="leftsided postbody subsilver-topic-title">Message</div>
		<div class="leftsided postprofile subsilver-topic-author">Author</div>
	</div></div>
</div>

			<div id="p41794" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile41794">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistfcd9.html?mode=viewprofile&amp;u=4919" class="username">npocmaka_</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha36f.php?author_id=4919&amp;sr=posts">473</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 24 Jun 2013 17:10</dd>		
		
																<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Bulgaria</dd>
							
							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact npocmaka_">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact npocmaka_</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="http://stackoverflow.com/questions/28043589/how-can-i-compres-zip-and-uncopress-unzip-files-and-folders-with-batch-f" title="Website" class="last-cell">
										<span class="contact-icon phpbb_website-icon">Website</span>
									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content41794">

						<h3 class="first"><a href="#p41794">Re: self-compiled .net hybrids</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting45e6.html?mode=quote&amp;f=3&amp;p=41794" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic7752.html?p=41794#p41794" onclick="prompt('Message #16',this.href); return false;">#16</a></span> 
									<a class="unread" href="viewtopic7752.html?p=41794#p41794" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistfcd9.html?mode=viewprofile&amp;u=4919" class="username">npocmaka_</a></strong> &raquo; </span>24 Jun 2015 08:03
			</p>
			
			
			
			<div class="content"><a href="http://stackoverflow.com/questions/30948239/get-the-console-buffer-without-the-last-line-with-c" class="postlink">Without redundant output</a>:<br /><br /><br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>// 2&gt;nul||@goto :batch<br />/*<br />:batch<br />@echo off<br /><br />setlocal<br />:: find csc.exe<br />set &quot;frm=%SystemRoot%\Microsoft.NET\Framework\&quot;<br />for /f &quot;tokens=* delims=&quot; %%v in ('dir /b /a:d&nbsp; /o:-n &quot;%SystemRoot%\Microsoft.NET\Framework\v*.*&quot;') do (<br />&nbsp; &nbsp;set netver=%%v<br />&nbsp; &nbsp;goto :break_loop<br />)<br />:break_loop<br />set csc=%frm%%netver%\csc.exe<br />:: csc.exe found<br />if not exist %~n0.exe (<br />&nbsp; &nbsp;%csc% /nologo /out:&quot;%~n0.exe&quot; &quot;%~dpsfnx0&quot; &gt;nul<br />)<br />%~n0.exe<br />echo -- redundant output has been cleared --<br /><br />endlocal<br />exit /b 0<br />*/<br />public class Hello<br />{<br />&nbsp; &nbsp;public static void Main() {<br />&nbsp; &nbsp; &nbsp; ClearC();<br />&nbsp; &nbsp; &nbsp; System.Console.WriteLine(&quot;Hello, C# World!&quot;);<br />&nbsp; &nbsp;}<br /><br />&nbsp; &nbsp;public static void ClearC() {<br />&nbsp; &nbsp;&nbsp; &nbsp;try {<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;System.Console.CursorTop = System.Console.CursorTop - 1;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;System.Console.Write(new string(' ', System.Console.BufferWidth));<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;System.Console.CursorTop = System.Console.CursorTop - 1;<br />&nbsp; &nbsp;&nbsp; &nbsp;} catch (System.IO.IOException e) {<br />&nbsp; &nbsp;&nbsp; &nbsp;}<br />&nbsp; &nbsp;}<br />}</code></pre></div><br /><br />though if there are `echo`-es before the c# part you'll need to change the cursor position.And wont work if the file is redirected to a file.Also I'm not sure if <span style="color: #000040">Console.CursorTop</span> is available in .net 2 and 3</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p41799" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile41799">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistbc5f.html?mode=viewprofile&amp;u=6706" class="username">Ben Mar</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search4840.html?author_id=6706&amp;sr=posts">22</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 03 May 2015 10:51</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content41799">

						<h3 ><a href="#p41799">Re: self-compiled .net hybrids</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting901b.html?mode=quote&amp;f=3&amp;p=41799" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic43b0.html?p=41799#p41799" onclick="prompt('Message #17',this.href); return false;">#17</a></span> 
									<a class="unread" href="viewtopic43b0.html?p=41799#p41799" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistbc5f.html?mode=viewprofile&amp;u=6706" class="username">Ben Mar</a></strong> &raquo; </span>24 Jun 2015 14:37
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>npocmaka_ wrote:</cite><a href="http://stackoverflow.com/questions/30948239/get-the-console-buffer-without-the-last-line-with-c" class="postlink">Without redundant output</a>:</div></blockquote><br />You can do that trick with &quot;cls&quot; too <img class="smilies" src="images/smilies/icon_smile.gif" alt=":-)" title="Smile" /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>//&gt;nul 2&gt;nul||@goto :batch<br />/*<br />:batch<br />@echo off<br />setlocal<br />cls<br />:: find csc.exe<br />set &quot;frm=%SystemRoot%\Microsoft.NET\Framework\&quot;<br />for /f &quot;tokens=* delims=&quot; %%v in ('dir /b /a:d&nbsp; /o:-n &quot;%SystemRoot%\Microsoft.NET\Framework\v*&quot;') do (<br />&nbsp; &nbsp;set netver=%%v<br />&nbsp; &nbsp;goto :break_loop<br />)<br />:break_loop<br />set csc=%frm%%netver%\csc.exe<br />:: csc.exe found<br /><br />call %csc% /nologo /out:&quot;%~n0.exe&quot; &quot;%~dpsfnx0&quot;<br />%~n0.exe<br />endlocal<br />exit /b 0<br />*/<br />public class Hello<br />{<br />&nbsp; &nbsp;public static void Main()<br />&nbsp; &nbsp;{<br />&nbsp; &nbsp; &nbsp; System.Console.WriteLine(&quot;Hello, C# World!&quot;);<br />&nbsp; &nbsp;}<br />}</code></pre></div></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p45859" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile45859">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistfcd9.html?mode=viewprofile&amp;u=4919" class="username">npocmaka_</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha36f.php?author_id=4919&amp;sr=posts">473</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 24 Jun 2013 17:10</dd>		
		
																<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Bulgaria</dd>
							
							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact npocmaka_">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact npocmaka_</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="http://stackoverflow.com/questions/28043589/how-can-i-compres-zip-and-uncopress-unzip-files-and-folders-with-batch-f" title="Website" class="last-cell">
										<span class="contact-icon phpbb_website-icon">Website</span>
									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content45859">

						<h3 ><a href="#p45859">Re: self-compiled .net hybrids</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingdbc1.html?mode=quote&amp;f=3&amp;p=45859" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic094c.html?p=45859#p45859" onclick="prompt('Message #18',this.href); return false;">#18</a></span> 
									<a class="unread" href="viewtopic094c.html?p=45859#p45859" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistfcd9.html?mode=viewprofile&amp;u=4919" class="username">npocmaka_</a></strong> &raquo; </span>21 Mar 2016 10:56
			</p>
			
			
			
			<div class="content">I've just found this:<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>https://gist.github.com/subTee/28b7439d3dfa07053b61</code></pre></div><br /><br />Looks like something that will allow platform invoke from JScript.net.<br />Not tested yet.<br />It will be good it works because in some cases will be a good replacement of C# and its redundant output.<br />Though it will be not so powerful as jscript does not allow passing by reference.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p49523" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile49523">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistfcd9.html?mode=viewprofile&amp;u=4919" class="username">npocmaka_</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha36f.php?author_id=4919&amp;sr=posts">473</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 24 Jun 2013 17:10</dd>		
		
																<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Bulgaria</dd>
							
							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact npocmaka_">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact npocmaka_</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="http://stackoverflow.com/questions/28043589/how-can-i-compres-zip-and-uncopress-unzip-files-and-folders-with-batch-f" title="Website" class="last-cell">
										<span class="contact-icon phpbb_website-icon">Website</span>
									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content49523">

						<h3 ><a href="#p49523">Re: self-compiled .net hybrids</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingcb4a.html?mode=quote&amp;f=3&amp;p=49523" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic916f-2.html?p=49523#p49523" onclick="prompt('Message #19',this.href); return false;">#19</a></span> 
									<a class="unread" href="viewtopic916f-2.html?p=49523#p49523" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistfcd9.html?mode=viewprofile&amp;u=4919" class="username">npocmaka_</a></strong> &raquo; </span>07 Oct 2016 06:15
			</p>
			
			
			
			<div class="content">using msbuild (without redundant output and without temp files ! ) :<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&lt;!-- :<br />&nbsp; &nbsp; @echo off<br /><br /><br />&nbsp; &nbsp; &nbsp; &nbsp; echo -^- FROM BATCH<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; set &quot;CMD_ARGS=%*&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; ::::::&nbsp; Starting C# code :::::::<br />&nbsp; &nbsp; &nbsp; &nbsp; :: searching for msbuild location<br />&nbsp; &nbsp; &nbsp; &nbsp; for /r &quot;%SystemRoot%\Microsoft.NET\Framework\&quot; %%# in (&quot;*msbuild.exe&quot;) do&nbsp; set &quot;msb=%%#&quot;<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; if not defined&nbsp; msb (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;echo no .net framework installed<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;exit /b 10<br />&nbsp; &nbsp; &nbsp; &nbsp; )<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; rem ::::::::::&nbsp; calling msbuid :::::::::<br />&nbsp; &nbsp; &nbsp; &nbsp; call %msb% /nologo&nbsp; /noconsolelogger &quot;%~dpsfnx0&quot;&nbsp; /property:&quot;H=From C#&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; rem ::::::::::::::::::::::::::::::::::::<br />&nbsp; &nbsp; &nbsp; &nbsp; exit /b %errorlevel%<br />--&gt; <br /><br /><br />&lt;Project ToolsVersion=&quot;$(MSBuildToolsVersion)&quot; xmlns=&quot;http://schemas.microsoft.com/developer/msbuild/2003&quot;&gt;<br />&nbsp; &lt;Target Name=&quot;_&quot;&gt;<br />&nbsp; &nbsp; &lt;_/&gt;<br />&nbsp; &lt;/Target&gt;<br />&nbsp; &lt;UsingTask<br />&nbsp; &nbsp; TaskName=&quot;_&quot;<br />&nbsp; &nbsp; TaskFactory=&quot;CodeTaskFactory&quot;<br />&nbsp; &nbsp; AssemblyFile=&quot;$(MSBuildToolsPath)\Microsoft.Build.Tasks.v$(MSBuildToolsVersion).dll&quot; &gt; <br /><br />&nbsp; &nbsp; &lt;ParameterGroup&nbsp; &gt;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;Z ParameterType=&quot;System.String&quot;&gt;$(H)&lt;/Z&gt;<br />&nbsp; &nbsp; &lt;/ParameterGroup&gt;<br /><br />&nbsp; &nbsp; &lt;Task&gt;<br />&nbsp; &nbsp; &nbsp; &lt;Using Namespace=&quot;System&quot; /&gt;<br />&nbsp; &nbsp; &nbsp; &lt;Code Type=&quot;Fragment&quot; Language=&quot;cs&quot;&gt;<br />&nbsp; &nbsp; &nbsp; &nbsp; &lt;!&#91;CDATA&#91;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; String CMD_ARGS=Environment.GetEnvironmentVariable(&quot;CMD_ARGS&quot;);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; System.Console.WriteLine(&quot;-- &quot;+&quot;$(H)&quot;);&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &#93;&#93;&gt;<br />&nbsp; &nbsp; &nbsp; &lt;/Code&gt;<br />&nbsp; &nbsp; &lt;/Task&gt;<br />&nbsp; &lt;/UsingTask&gt;<br />&lt;/Project&gt;<br /></code></pre></div><br /><br /><br />Will have to experiment more with this to see how P/Invoke can be used (something I can't do neat with jscript.net)<br /><br /><!-- m --><a class="postlink" href="https://msdn.microsoft.com/en-us/library/dd722601.aspx">https://msdn.microsoft.com/en-us/library/dd722601.aspx</a><!-- m --></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50787" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile50787">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistfcd9.html?mode=viewprofile&amp;u=4919" class="username">npocmaka_</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha36f.php?author_id=4919&amp;sr=posts">473</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 24 Jun 2013 17:10</dd>		
		
																<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Bulgaria</dd>
							
							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact npocmaka_">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact npocmaka_</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="http://stackoverflow.com/questions/28043589/how-can-i-compres-zip-and-uncopress-unzip-files-and-folders-with-batch-f" title="Website" class="last-cell">
										<span class="contact-icon phpbb_website-icon">Website</span>
									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content50787">

						<h3 ><a href="#p50787">Re: self-compiled .net hybrids</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinga93a.html?mode=quote&amp;f=3&amp;p=50787" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic5301.html?p=50787#p50787" onclick="prompt('Message #20',this.href); return false;">#20</a></span> 
									<a class="unread" href="viewtopic5301.html?p=50787#p50787" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistfcd9.html?mode=viewprofile&amp;u=4919" class="username">npocmaka_</a></strong> &raquo; </span>06 Jan 2017 16:02
			</p>
			
			
			
			<div class="content">More notes on the msbuild technique.<br />If you need a reference to a dll you'll need to include it in the task node in the xml (alike the simple /r:some.dll in csc compiler)<br /><br />you cant use the &quot;--&quot; directly in batch part because it will broke the xml parsing (I'll have to think how the batch part can be put in CDATA section...  may be will be not possible)<br /><br />The type can be fragment (as in the previous example) or class or method <br /><br />Using a class needs more effort than a fragment - you need to implement ITask interface . Though it will be easier to inherit Task class which has some pipe work done. These are in Microsoft.Build.Framework and Microsoft.Build.Utilities namespaces. Doing so you'll have to override Execute method.<br /><br />The class must be public (though you can have more non public classes) and it should have the same name as the task you want to execute.<br /><br />Here's an example:<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&lt;!-- :<br />&nbsp; &nbsp; @echo off<br /><br /><br />&nbsp; &nbsp; &nbsp; &nbsp; echo -^- FROM BATCH<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; set &quot;CMD_ARGS=%*&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; ::::::&nbsp; Starting C# code :::::::<br />&nbsp; &nbsp; &nbsp; &nbsp; :: searching for msbuild location<br />&nbsp; &nbsp; &nbsp; &nbsp; for /r &quot;%SystemRoot%\Microsoft.NET\Framework\&quot; %%# in (&quot;*msbuild.exe&quot;) do&nbsp; set &quot;msb=%%#&quot;<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; if not defined&nbsp; msb (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;echo no .net framework installed<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;exit /b 10<br />&nbsp; &nbsp; &nbsp; &nbsp; )<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; rem ::::::::::&nbsp; calling msbuid :::::::::<br />&nbsp; &nbsp; &nbsp; &nbsp; call %msb% /nologo&nbsp; /noconsolelogger &quot;%~dpsfnx0&quot;&nbsp; /property:&quot;H=From C#&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; rem ::::::::::::::::::::::::::::::::::::<br />&nbsp; &nbsp; &nbsp; &nbsp; exit /b %errorlevel%<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />--&gt; <br /><br /><br />&lt;Project ToolsVersion=&quot;$(MSBuildToolsVersion)&quot; xmlns=&quot;http://schemas.microsoft.com/developer/msbuild/2003&quot;&gt;<br />&nbsp; &lt;Target Name=&quot;Program&quot;&gt;<br />&nbsp; &nbsp; &lt;Program/&gt;<br />&nbsp; &lt;/Target&gt;<br />&nbsp; &lt;UsingTask<br />&nbsp; &nbsp; TaskName=&quot;Program&quot;<br />&nbsp; &nbsp; TaskFactory=&quot;CodeTaskFactory&quot;<br />&nbsp; &nbsp; AssemblyFile=&quot;$(MSBuildToolsPath)\Microsoft.Build.Tasks.v$(MSBuildToolsVersion).dll&quot; &gt; <br /><br />&nbsp; &nbsp; &lt;ParameterGroup&nbsp; &gt;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;Z ParameterType=&quot;System.String&quot;&gt;$(H)&lt;/Z&gt;<br />&nbsp; &nbsp; &lt;/ParameterGroup&gt;<br /><br />&nbsp; &nbsp; &lt;Task&gt;<br />&nbsp; &nbsp;&nbsp; &lt;Reference Include=&quot;$(MSBuildToolsPath)\System.Windows.Forms.dll&quot;/&gt;<br />&nbsp; &nbsp; &nbsp; &lt;Using Namespace=&quot;System&quot; /&gt;<br />&nbsp;<br />&nbsp; &nbsp; &nbsp; &lt;Code Type=&quot;Class&quot; Language=&quot;cs&quot;&gt;<br />&nbsp; &nbsp; &nbsp; &nbsp; &lt;!&#91;CDATA&#91;<br />&nbsp; &nbsp;using Microsoft.Build.Framework;<br />&nbsp; &nbsp;using Microsoft.Build.Utilities;<br />&nbsp; &nbsp;using System;<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;public class Program:Task, ITask<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp;&nbsp; &nbsp;public override bool Execute(){<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;Console.WriteLine(&quot;Whoa&quot;);<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;String CMD_ARGS=Environment.GetEnvironmentVariable(&quot;CMD_ARGS&quot;);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; System.Console.WriteLine(&quot;-- &quot;+&quot;$(MSBuildToolsVersion)&quot;); <br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;return true;<br />&nbsp; &nbsp;&nbsp; &nbsp;}<br />&nbsp; &nbsp;}<br />&nbsp; &nbsp; &nbsp; &nbsp; &#93;&#93;&gt;<br />&nbsp; &nbsp; &nbsp; &lt;/Code&gt;<br />&nbsp; &nbsp; &lt;/Task&gt;<br />&nbsp; &lt;/UsingTask&gt;<br />&lt;/Project&gt;<br /></code></pre></div><br /><br />Also the MSBuildToolsVersion and MSBuildToolsPath are no more hard coded in the xml.<br /><br />As a reference I've used this - <!-- m --><a class="postlink" href="https://gist.github.com/subTee/6fa2b0cc82559ee6ea54070e6d93f31a">https://gist.github.com/subTee/6fa2b0cc ... 0e6d93f31a</a><!-- m -->   (in the subtee's gists there are pretty interesting things)<br /><br />Still not tried to implement a method The <a href="https://msdn.microsoft.com/en-us/library/dd722601.aspx?f=255&amp;MSPPError=-2147217396" class="postlink">msdn</a> does not tell much - <br /><strong class="text-strong">If the value of Type is Method, then the code defines an override of the Execute method of the ITask interface.</strong><br /><br /><br />I feel a little lonely in my excitement about this - but for sure will try and share the method type task too.<br /><br /><br /><strong class="text-strong">EDIT</strong>. Example with method (the msdn explanation  was more than enough):<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&lt;!-- :<br />&nbsp; &nbsp; @echo off<br /><br /><br />&nbsp; &nbsp; &nbsp; &nbsp; echo -^- FROM BATCH<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; set &quot;CMD_ARGS=%*&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; ::::::&nbsp; Starting C# code :::::::<br />&nbsp; &nbsp; &nbsp; &nbsp; :: searching for msbuild location<br />&nbsp; &nbsp; &nbsp; &nbsp; for /r &quot;%SystemRoot%\Microsoft.NET\Framework\&quot; %%# in (&quot;*msbuild.exe&quot;) do&nbsp; set &quot;msb=%%#&quot;<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; if not defined&nbsp; msb (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;echo no .net framework installed<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;exit /b 10<br />&nbsp; &nbsp; &nbsp; &nbsp; )<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; rem ::::::::::&nbsp; calling msbuid :::::::::<br />&nbsp; &nbsp; &nbsp; &nbsp; call %msb% /nologo&nbsp; /noconsolelogger &quot;%~dpsfnx0&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; rem ::::::::::::::::::::::::::::::::::::<br />&nbsp; &nbsp; &nbsp; &nbsp; exit /b %errorlevel%<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />--&gt; <br /><br /><br />&lt;Project ToolsVersion=&quot;$(MSBuildToolsVersion)&quot; xmlns=&quot;http://schemas.microsoft.com/developer/msbuild/2003&quot;&gt;<br />&nbsp; &lt;Target Name=&quot;_&quot;&gt;<br />&nbsp; &nbsp; &lt;_/&gt;<br />&nbsp; &lt;/Target&gt;<br />&nbsp; &lt;UsingTask<br />&nbsp; &nbsp; TaskName=&quot;_&quot;<br />&nbsp; &nbsp; TaskFactory=&quot;CodeTaskFactory&quot;<br />&nbsp; &nbsp; AssemblyFile=&quot;$(MSBuildToolsPath)\Microsoft.Build.Tasks.v$(MSBuildToolsVersion).dll&quot; &gt; <br /><br />&nbsp; &nbsp; &lt;Task&gt;<br />&nbsp; &nbsp;&nbsp; &lt;Reference Include=&quot;$(MSBuildToolsPath)\System.Windows.Forms.dll&quot;/&gt;<br />&nbsp; &nbsp; &nbsp; &lt;Using Namespace=&quot;System&quot; /&gt;<br />&nbsp;<br />&nbsp; &nbsp; &nbsp; &lt;Code Type=&quot;Method&quot; Language=&quot;cs&quot;&gt;<br />&nbsp; &nbsp; &nbsp; &nbsp; &lt;!&#91;CDATA&#91;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;public override bool Execute(){<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;MyMethod();<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;return true;<br />&nbsp; &nbsp;&nbsp; &nbsp;}<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;void MyMethod(){<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;Console.WriteLine(&quot;Whoa&quot;);<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;String CMD_ARGS=Environment.GetEnvironmentVariable(&quot;CMD_ARGS&quot;);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; System.Console.WriteLine(&quot;-- &quot;+&quot;$(MSBuildToolsVersion)&quot;); <br />&nbsp; &nbsp;&nbsp; &nbsp;}<br />&nbsp; &nbsp; &nbsp; &nbsp; &#93;&#93;&gt;<br />&nbsp; &nbsp; &nbsp; &lt;/Code&gt;<br />&nbsp; &nbsp; &lt;/Task&gt;<br />&nbsp; &lt;/UsingTask&gt;<br />&lt;/Project&gt;</code></pre></div></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50788" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile50788">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistfc7d.html?mode=viewprofile&amp;u=8487" class="username">LotPings</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchde04.html?author_id=8487&amp;sr=posts">10</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 26 Oct 2016 22:45</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content50788">

						<h3 ><a href="#p50788">Re: self-compiled .net hybrids</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting3963.html?mode=quote&amp;f=3&amp;p=50788" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicc929.html?p=50788#p50788" onclick="prompt('Message #21',this.href); return false;">#21</a></span> 
									<a class="unread" href="viewtopicc929.html?p=50788#p50788" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistfc7d.html?mode=viewprofile&amp;u=8487" class="username">LotPings</a></strong> &raquo; </span>07 Jan 2017 08:58
			</p>
			
			
			
			<div class="content">Nice one npocmaka,<br /><br />two questions<br />1. why do you call msbuild.exe?<br />2. are there remnant files from the build, if yes where are they located?<br /><br />Wish you a happy new year.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50789" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile50789">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistfcd9.html?mode=viewprofile&amp;u=4919" class="username">npocmaka_</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha36f.php?author_id=4919&amp;sr=posts">473</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 24 Jun 2013 17:10</dd>		
		
																<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Bulgaria</dd>
							
							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact npocmaka_">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact npocmaka_</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="http://stackoverflow.com/questions/28043589/how-can-i-compres-zip-and-uncopress-unzip-files-and-folders-with-batch-f" title="Website" class="last-cell">
										<span class="contact-icon phpbb_website-icon">Website</span>
									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content50789">

						<h3 ><a href="#p50789">Re: self-compiled .net hybrids</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting0688.html?mode=quote&amp;f=3&amp;p=50789" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic1905.html?p=50789#p50789" onclick="prompt('Message #22',this.href); return false;">#22</a></span> 
									<a class="unread" href="viewtopic1905.html?p=50789#p50789" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistfcd9.html?mode=viewprofile&amp;u=4919" class="username">npocmaka_</a></strong> &raquo; </span>07 Jan 2017 09:13
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>LotPings wrote:</cite>Nice one npocmaka,<br /><br />two questions<br />1. why do you call msbuild.exe?<br />2. are there remnant files from the build, if yes where are they located?<br /><br />Wish you a happy new year.</div></blockquote><br /><br />1.MSBuild works with xml files which can be used in batch files for comment lines without redundant output. the &quot;&lt;!-- :&quot; will be executed as &quot;:&lt;!--&quot; i.e. label and there will be nothing displayed in the console.<br /><br />2.This is even more beautiful - there are no build files , no temp files - everything is loaded in the memory (may be this mean that it will be faster but I'n not sure). Except there's a compilation error - there will be some source files in the %temp% where you can see in more details what msbuild is doing.<br /><br /><br /><strong class="text-strong"><span style="color: #FF0000">WRONG</span></strong>:<span style="color: #FFFF00">The only impediment is that you can't exit with custom error codes if the build is successful it returns 0  otherwise 1 , depending on what is returned from Execute() method.</span></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p57627" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile57627">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistfcd9.html?mode=viewprofile&amp;u=4919" class="username">npocmaka_</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha36f.php?author_id=4919&amp;sr=posts">473</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 24 Jun 2013 17:10</dd>		
		
																<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Bulgaria</dd>
							
							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact npocmaka_">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact npocmaka_</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="http://stackoverflow.com/questions/28043589/how-can-i-compres-zip-and-uncopress-unzip-files-and-folders-with-batch-f" title="Website" class="last-cell">
										<span class="contact-icon phpbb_website-icon">Website</span>
									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content57627">

						<h3 ><a href="#p57627">Re: self-compiled .net hybrids</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting8500.html?mode=quote&amp;f=3&amp;p=57627" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic7470.html?p=57627#p57627" onclick="prompt('Message #23',this.href); return false;">#23</a></span> 
									<a class="unread" href="viewtopic7470.html?p=57627#p57627" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistfcd9.html?mode=viewprofile&amp;u=4919" class="username">npocmaka_</a></strong> &raquo; </span>01 Aug 2018 05:39
			</p>
			
			
			
			<div class="content">Probably the inline tasks for msbuild will remain the best method for .net hybridization. But this will require .net framework 4.6 (can it be installed on something different than windows 10?) so it is not so portable.<br>
<br>
Using c# without msbuild will produce redundant output because of the '// 2&gt;nul||@goto :batch'  line (vb.net also will produce something similar). JScript.net does not support syntax sugaring for platform invokes but it is still possible  (<a href="http://cx20.main.jp/blog/hello/2013/03/07/hello-win32-api-jscript-net-world/" class="postlink">http://cx20.main.jp/blog/hello/2013/03/ ... net-world/</a>):<br>

<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@if (@X)==(@Y) @end /* JScript comment
@echo off
setlocal

set "jsc="
for /r "%SystemRoot%\Microsoft.NET\Framework\" %%# in ("*jsc.exe") do  set "jsc=%%#"

if not exist "%jsc%" (
   echo no .net framework installed
   exit /b 10
)


::if not exist "%~n0.exe" (
	call "%jsc%"  /r:"System.Windows.Forms.dll" /nologo /out:"%~n0.exe" "%~dpsfnx0"||(
		exit /b %errorlevel%
	)
::)

"%~n0.exe"

endlocal &amp; exit /b %errorlevel%

*/

import System;
import System.Reflection;
import System.Reflection.Emit;
import System.Runtime;
import System.Text;
 
// Invoke a Win32 P/Invoke call.
// http://www.leeholmes.com/blog/2006/07/21/get-the-owner-of-a-process-in-powershell-%e2%80%93-pinvoke-and-refout-parameters
function InvokeWin32(dllName:String, returnType:Type,
  methodName:String, parameterTypes:Type[], parameters:Object[])
{
  // Begin to build the dynamic assembly
  var domain = AppDomain.CurrentDomain;
  var name = new System.Reflection.AssemblyName('PInvokeAssembly');
  var assembly = domain.DefineDynamicAssembly(name, AssemblyBuilderAccess.Run);
  var module = assembly.DefineDynamicModule('PInvokeModule');
  var type = module.DefineType('PInvokeType',TypeAttributes.Public + TypeAttributes.BeforeFieldInit);
 
  // Define the actual P/Invoke method
  var method = type.DefineMethod(methodName, MethodAttributes.Public + MethodAttributes.HideBySig + MethodAttributes.Static + MethodAttributes.PinvokeImpl, returnType, parameterTypes);
 
  // Apply the P/Invoke constructor
  var ctor = System.Runtime.InteropServices.DllImportAttribute.GetConstructor([Type.GetType("System.String")]);
  var attr = new System.Reflection.Emit.CustomAttributeBuilder(ctor, [dllName]);
  method.SetCustomAttribute(attr);
 
  // Create the temporary type, and invoke the method.
  var realType = type.CreateType();
  return realType.InvokeMember(methodName, BindingFlags.Public + BindingFlags.Static + BindingFlags.InvokeMethod, null, null, parameters);
}
 
function MessageBox(hWnd:Int32, lpText:String, lpCaption:String, uType:Int32) 
{ 
   var parameterTypes:Type[] = [Type.GetType("System.Int32"),Type.GetType("System.String"),Type.GetType("System.String"),Type.GetType("System.Int32")];
   var parameters:Object[] = [hWnd, lpText, lpCaption, uType];
 
   return InvokeWin32("user32.dll", Type.GetType("System.Int32"), "MessageBoxA", parameterTypes,  parameters );
} 
 
MessageBox( 0, "Hello, Win32 API World!", "Hello, World!", 0 );</code></pre></div>

the interesting part is in the InvokeWin32 function (nothing so complicated and can't be used directly without knowing too much about reflection ).<br>
<br>
Despite it is no more supported by MS jscript.net is the most backward compatible .net tool installed by default on Windows machines (it is not installed on win XP by default though it is highly probable ,but it is time to let XP die anyway).<br>
<br>
With pure batch scripts and with WSH/jscript/vbscript there are limits that can't be overcome without accessing windows system libraries - so jscript.net is a worthy thing to dig in.<br>
<br>
 Probably I'll try to 'translate' the tools I've wrote with C# to jscript.net and if possible to update the examples in <a href="http://pinvoke.net/" class="postlink">http://pinvoke.net/</a></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
	

	<div class="action-bar bar-bottom">
	
			<a href="postingd64b.html?mode=reply&amp;f=3&amp;t=5260" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic1392.html?f=3&amp;t=5260&amp;start=15&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

			<form method="post" action="https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=5260&amp;start=15">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			23 posts
							<ul>
			<li class="arrow previous"><a class="button button-icon-only" href="viewtopicdcbd.html?f=3&amp;t=5260" rel="prev" role="button"><i class="icon fa-chevron-left fa-fw" aria-hidden="true"></i><span class="sr-only">Previous</span></a></li>
				<li><a class="button" href="viewtopicdcbd.html?f=3&amp;t=5260" role="button">1</a></li>
			<li class="active"><span>2</span></li>
	</ul>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="viewforum4d6b.html?f=3" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to “DOS Batch Forum”</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="viewforum31e6.html?f=4" class="jumpbox-cat-link"> <span> DosTips - Dos Batch</span></a></li>
																<li><a href="viewforum4d6b.html?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; DOS Batch Forum</span></a></li>
											</ul>
		</div>
	</div>

	</div>


			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
							<span class="crumb"><a href="../index.html" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>DosTips.com</span></a></span>									<span class="crumb"><a href="index.html" data-navbar-reference="index"><span>Board index</span></a></span>					</li>
		
				<li class="rightside">All times are <span title="UTC-6">UTC-06:00</span></li>
							<li class="rightside">
				<a href="ucp033a.html?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete all board cookies</span>
				</a>
			</li>
												<li class="rightside" data-last-responsive="true">
				<a href="memberlist4bfd.html?mode=team" role="menuitem">
					<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
				</a>
			</li>
									<li class="rightside" data-last-responsive="true">
				<a href="memberlist8733.html?mode=contactadmin" role="menuitem">
					<i class="icon fa-envelope fa-fw" aria-hidden="true"></i><span>Contact us</span>
				</a>
			</li>
			</ul>

	</div>
</div>

	<div class="copyright">
				<!-- WARNING NO DELETE -->Style developer by <a href="http://tricolor.x-tk.ru/">support forum tricolor</a>, <!-- END WARNING NO DELETE -->Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
									</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	<img src="cron5495.gif?cron_type=cron.task.text_reparser.poll_title" width="1" height="1" alt="cron" /></div>

<script type="text/javascript" src="assets/javascript/jquery.mind772.js?assets_version=34"></script>
<script type="text/javascript" src="assets/javascript/cored772.js?assets_version=34"></script>



<script type="text/javascript" src="styles/prosilver/template/forum_fnd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/prosilver/template/ajaxd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/jquery-uid772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/collapsed772.js?assets_version=34"></script>



</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?p=49523 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 06:46:50 GMT -->
</html>
