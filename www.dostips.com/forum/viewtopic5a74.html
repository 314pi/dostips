<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?p=37623 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 06:45:43 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>JSORT.BAT v4.2 - Case sensitive sort with option for numeric sort - DosTips.com</title>


	<link rel="canonical" href="viewtopic96d4.html?t=5595">

<!--
	phpBB style name: Allan Style - SUBSILVER
	Based on style:   prosilver (this is the default phpBB3 style)
	Based on style:   subsilver2 (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:  Allan ( http://x-tk.ru/ )
-->

<link href="assets/css/font-awesome.mind772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/stylesheetd772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/en/stylesheetd772.css?assets_version=34" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="./styles/AllanStyle-SUBSILVER/theme/tweaks.css?assets_version=34" rel="stylesheet">
<![endif]-->




<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','../../www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-280191-1', 'auto');
	ga('send', 'pageview');
</script>

</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">

<div id="header-subsilver">
	<a id="top" class="top-anchor" accesskey="t"></a>
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description" class="site-description">
				<a id="logo" class="logo" href="../index.html" title="DosTips.com"><span class="site_logo"></span></a>
				<h1>DosTips.com</h1>
				<p>A Forum all about DOS Batch</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

									<div id="search-box" class="search-box search-header" role="search">
				<form action="https://www.dostips.com/forum/search.php" method="get" id="search">
				<fieldset>
					<input name="keywords" id="keywords" type="search" maxlength="128" title="Search for keywords" class="inputbox search tiny" size="20" value="" placeholder="Search…" />
					<button class="button button-search" type="submit" title="Search">
						<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
					</button>
					<a href="search.html" class="button button-search-end" title="Advanced search">
						<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
					</a>
					
				</fieldset>
				</form>
			</div>
						
			</div>
					</div>
</div>


<div id="wrap" class="wrap">
	<div id="page-header">
				<div class="navbar-top" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
																									<li>
								<a href="search33a7.html?search_id=unanswered" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="search526f.html?search_id=active_topics" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-blue" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="search.html" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
											<li class="separator"></li>
																			<li>
								<a href="memberlist4bfd.html?mode=team" role="menuitem">
									<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
								</a>
							</li>
																<li class="separator"></li>

									</ul>
			</div>
		</li>

				<li data-skip-responsive="true">
			<a href="app.php/help/faq.html" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
						
			<li class="rightside"  data-skip-responsive="true">
			<a href="ucp26c3.html?mode=login" title="Login" accesskey="x" role="menuitem">
				<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Login</span>
			</a>
		</li>
					<li class="rightside" data-skip-responsive="true">
				<a href="ucp8319.html?mode=register" role="menuitem">
					<i class="icon fa-pencil-square-o  fa-fw" aria-hidden="true"></i><span>Register</span>
				</a>
			</li>
						</ul>

	</div>
</div>

<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
						<li class="breadcrumbs">
							<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="../index.html" itemprop="url" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span itemprop="title">DosTips.com</span></a></span>
										<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="index.html" itemprop="url" accesskey="h" data-navbar-reference="index"><span itemprop="title">Board index</span></a></span>

											<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="4"><a href="viewforum31e6.html?f=4" itemprop="url"><span itemprop="title">DosTips - Dos Batch</span></a></span>
															<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="3"><a href="viewforum4d6b.html?f=3" itemprop="url"><span itemprop="title">DOS Batch Forum</span></a></span>
												</li>
		
					<li class="rightside responsive-search">
				<a href="search.html" title="View the advanced search options" role="menuitem">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</a>
			</li>
			</ul>

	</div>
</div>

<div class="navbar-top-link">
	<div class="inner">
		<ul>
			<li class="navbar-top-link-left"><a href="search33a7.html?search_id=unanswered">Unanswered topics</a></li>
			<li class="navbar-top-link-left"><a href="search526f.html?search_id=active_topics">Active topics</a></li>

											</ul>
	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
		
<h2 class="topic-title"><a href="viewtopicf1eb.html?f=3&amp;t=5595">JSORT.BAT v4.2 - Case sensitive sort with option for numeric sort</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">Discussion forum for all Windows batch related topics.<br /></div>
<p>
	<strong>Moderator:</strong> <a href="memberlista6a8.html?mode=viewprofile&amp;u=5" class="username">DosItHelp</a>
</p>


<div class="action-bar bar-top">
	
			<a href="posting5cc0.html?mode=reply&amp;f=3&amp;t=5595" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic5f4e.html?f=3&amp;t=5595&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="https://www.dostips.com/forum/search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topic…" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="search.html" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="5595" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			47 posts
							<ul>
		<li class="active"><span>1</span></li>
				<li><a class="button" href="viewtopic4ecd.html?f=3&amp;t=5595&amp;start=15" role="button">2</a></li>
				<li><a class="button" href="viewtopicd770.html?f=3&amp;t=5595&amp;start=30" role="button">3</a></li>
				<li><a class="button" href="viewtopic89dc.html?f=3&amp;t=5595&amp;start=45" role="button">4</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopic4ecd.html?f=3&amp;t=5595&amp;start=15" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
		</div>




<div id="subsilver-nav-topic">
	<div class="inner"><div class="post has-profile">
		<div class="leftsided postbody subsilver-topic-title">Message</div>
		<div class="leftsided postprofile subsilver-topic-author">Author</div>
	</div></div>
</div>

			<div id="p34422" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile34422">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content34422">

						<h3 class="first"><a href="#p34422">JSORT.BAT v4.2 - Case sensitive sort with option for numeric sort</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting03c6.html?mode=quote&amp;f=3&amp;p=34422" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic25ed.html?p=34422#p34422" onclick="prompt('Message #1',this.href); return false;">#1</a></span> 
									<a class="unread" href="viewtopic25ed.html?p=34422#p34422" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>13 May 2014 22:10
			</p>
			
			
			
			<div class="content"><span style="color: #0000BF"><strong class="text-strong">Here at the top is the current version. The original post follows the current code.</strong></span>
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@if (@X)==(@Y) @end /* Harmless hybrid line that begins a JScript comment
@goto :Batch
 
::************ Documentation ***********
::JSORT.BAT version 4.2
:::
:::JSORT [File] [/Option [Value]]...
:::
:::  Sort lines of text from stdin and write the result to stdout.
:::  JSORT uses an ascending, case sensitive text sort by default.
:::
:::    File - If the optional File argument is specified, then JSORT reads lines
:::           from the file instead of from stdin. If specified, the File must
:::           be the very first argument.
:::
:::  Options:
:::
:::    /C n - Number of sorted lines to print. Skipped lines are always printed
:::           and do not contribute to the count. Default is -1 (all lines).
:::
:::    /D String - Specifies the string used to delimit tokens. The delimiter
:::           string is always case sensitive. A quote literal " must be escaped
:::           as \q, and a backslash literal \ must be escaped as \\.
:::           The default value is an empty string, meaning treat the entire
:::           line as a single token.
:::
:::    /I   - Ignore case when sorting (or when checking for uniqueness)
:::
:::    /N   - Sort consecutive digits as numbers instead of text. The numbers
:::           may be embedded within alpha text. JSort supports numbers up to
:::           20 digits long.
:::
:::    /O File - Writes the output to File instead of stdout.
:::
:::    /P n - Begin sorting at character position n relative to the beginning
:::           of the selected token. Lines that do not extend that far are
:::           treated as equivalent values, and collate before all other lines.
:::           The default value is 1 (first character).
:::
:::    /R   - Sort the lines in Reverse (descending) order.
:::
:::    /S n - Number of lines to skip - default is 0.
:::           Skipped lines are not sorted (remain in place)
:::
:::    /T n - Specify the token at which to begin sorting. The sort is not
:::           restricted to the selected token, it just helps to identify where
:::           to begin sorting. The default value is 1 (first token). A value of
:::           -1 represents the last token, -2 the penultimate token, etc.
:::           A value of 0 is invalid. Note that negative values only recognize
:::           tokens that occur after a delimiter. If the requested token cannot
:::           be found, then the line will collate before all other lines.
:::
:::    /U   - Only write unique lines (discard duplicates)
:::
:::    /V   - Display the version of JSORT.BAT.
:::
:::    /?   - Display this help
:::
:::JSORT.BAT was written by Dave Benham and originally posted at
:::http://www.dostips.com/forum/viewtopic.php?f=3&amp;t=5595
:::

============== :Batch portion =============
@echo off
setlocal disableDelayedExpansion

:: Get optional input file
set "infile="
set "test=%~1"
if defined test (
  setlocal enableDelayedExpansion
  if "!test:~0,1!" neq "/" (
    endlocal
    set ^"infile=^&lt;"%~1""
    shift /1
  ) else endlocal
)

:: Define options
set "options= /?: /c:-1 /d:"" /i: /n: /o:"" /p:1 /r: /s:0 /t:1 /u: /v: "

:: Set default option values
for %%O in (%options%) do for /f "tokens=1,* delims=:" %%A in ("%%O") do set "%%A=%%~B"

:: Get options
:loop
if not "%~1"=="" (
  setlocal enableDelayedExpansion
  set "test=!options:* %~1:=! "
  if "!test!"=="!options! " (
      &gt;&amp;2 echo Error: Invalid option %~1
      exit /b 1
  ) else if "!test:~0,1!"==" " (
      endlocal
      set "%~1=1"
  ) else (
      endlocal
      set "%~1=%~2"
      shift /1
  )
  shift /1
  goto :loop
)

:: Display help
if defined /? (
  for /f "delims=: tokens=*" %%A in ('findstr "^:::" "%~f0"') do echo(%%A
  exit /b 0
)

:: Display version
if defined /v (
  for /f "delims=: tokens=*" %%A in ('findstr /bc:"::JSORT.BAT version" "%~f0"') do echo %%A
  exit /b 0
)

:: Transform and validate options
set /a "case=0%/i%, num=0%/n%, pos=%/p%-1, tok=%/t%, unique=0%/u%, order=1-2*0%/r%, 1/!(0x80000000&amp;pos), 1/tok" 2&gt;nul || (
  &gt;&amp;2 echo Error: Invalid option value.
  exit /b 1
)
if %tok% gtr 0 set /a tok-=1
set "outfile="
if defined /o set ^"outfile=^&gt;"%/o%""

:: Perform the sort
%infile% %outfile% cscript //E:JScript //nologo "%~f0" %case% %num% %pos% %order% %/s% %/c% %tok% "%/d%" %unique%

exit /b 0

************* JScript portion **********/
var array=new Array(),
    nocase =WScript.Arguments.Item(0),
    numeric=WScript.Arguments.Item(1),
    pos    =parseInt(WScript.Arguments.Item(2)),
    order  =WScript.Arguments.Item(3),
    skip   =WScript.Arguments.Item(4),
    count  =WScript.Arguments.Item(5),
    token  =WScript.Arguments.Item(6),
    delim  =WScript.Arguments.Item(7).replace(/\\(?!q|\\)/g,'').replace(/\\\\/g,'\\s').replace(/\\q/g,'"').replace(/\\s/g,'\\'),
    unique =WScript.Arguments.Item(8);
while (!WScript.StdIn.AtEndOfStream) {
  if (skip &gt; 0) {
    WScript.Echo(WScript.StdIn.ReadLine());
    skip-=1
  } else {
    var expanded="", num="", raw=WScript.StdIn.ReadLine(), upper=((nocase==1)?raw.toUpperCase():raw);
    for( var i=pos+FindToken(raw,delim,token); i&lt;raw.length; i++ ) {
      var c=upper.substr(i,1);
      if (numeric==1 &amp;&amp; c&gt;="0" &amp;&amp; c&lt;="9") {
        num+=c;
      } else {
        if (num != "") {
          num="00000000000000000000" + num;
          expanded+=num.substr(num.length-20);
          num="";
        }
        expanded+=c;
      }
    }
    if (num != "") {
      num="00000000000000000000" + num;
      expanded+=num.substr(num.length-20);
    }
    var obj={expanded:expanded, raw:raw};
    array.push(obj);
  }
}
if (count&lt;0) count=array.length;
if (count&gt;array.length) count=array.length;
if (unique==1) {
  array.sort( function(a,b){
                var rtn = (a.expanded&gt;b.expanded)-(a.expanded&lt;b.expanded);
                if (rtn==0) {
                  var a2=(nocase==1)?a.raw.toUpperCase():a.raw;
                  var b2=(nocase==1)?b.raw.toUpperCase():b.raw;
                  rtn = (a2&gt;b2)-(a2&lt;b2);
                }
                return order*rtn;
              });
  if (count&gt;=1) WScript.Echo(array[0].raw);
  for (var i=1; i&lt;count; i++) {
    if (nocase==1 &amp;&amp; array[i].raw.toUpperCase() == array[i-1].raw.toUpperCase()) continue;
    if (nocase==0 &amp;&amp; array[i].raw == array[i-1].raw) continue;
    WScript.Echo(array[i].raw);
  }
} else {
  array.sort(function(a,b){return order*((a.expanded&gt;b.expanded)-(a.expanded&lt;b.expanded));});
  for (var i=0; i&lt;count; i++) WScript.Echo(array[i].raw);
}

function FindToken(str, str2, n) {
  if (n!=0 &amp;&amp; str2=="") return str.length;
  if (n&gt;=0) {
    var rtn = 0;
    for( var i=n; i&gt;0; i-- ) {
      rtn = str.indexOf(str2,rtn);
      if (rtn&lt;0) return str.length;
      rtn+=str2.length;
    }
  } else {
    var rtn = str.length;
    for (var i=n; i&lt;0; i++ ) {
      rtn-=1;
      rtn = str.lastIndexOf(str2,rtn);
      if (rtn&lt;0) return str.length;
    }
    rtn+=str2.length;
  }
  return rtn;
}
</code></pre></div>

------------------------------------------------------------------------------------------<br>
<span style="color: #0000BF"><strong class="text-strong">Original post:</strong></span><br>
<br>
I've often been disappointed that SORT did not have a case sensitive option, but never thought much about doing anything about it.<br>
<br>
It's also not uncommon to want to sort strings with embedded numbers, and I've always parsed and reformatted the strings with 0 padded numbers so that I could use SORT. It works, but it's a pain.<br>
<br>
But then at <a href="viewtopic8ace.html?f=3&amp;t=5583" class="postlink">How can i order the results consecutively in a batch?</a> rootx asked how to sort numeric strings. Squashman linked to the <a href="../index9d9b.html?t=Batch.SortTextWithNumbers" class="postlink">DosTips SortN.bat solution</a>, which I had never noticed before. It works well, but it can be slow with moderate sized input.<br>
<br>
Then I thought, why not write a hybrid JScript/batch SORT utility that can solve both problems efficiently and conveniently <img class="smilies" src="images/smilies/icon_question.gif" width="15" height="15" alt=":?:" title="Question">  <img class="smilies" src="images/smilies/icon_idea.gif" width="15" height="15" alt=":idea:" title="Idea">  - so I did  <img class="smilies" src="images/smilies/icon_smile.gif" width="15" height="15" alt=":)" title="Smile"> I'm no JScript expert, and I did not spend much time optimizing the code. But it seems to work well in my limited testing. But be aware that the utility will load the entire input data set into memory, using more than twice the original space.<br>
<br>
Full documentation is embedded within the script. Use JSORT /? to display the help.<br>

<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@if (@X)==(@Y) @end /* Harmless hybrid line that begins a JScript comment

::************ Documentation ***********
::JSORT.BAT version 1.0
:::
:::JSORT [/Option [Value]]...
:::
:::  Sort lines of text from stdin and write the result to stdout.
:::  JSORT uses an ascending, case sensitive text sort by default.
:::
:::  Options:
:::
:::    /I - Ignore case
:::
:::    /N - Sort consecutive digits as numbers instead of text. The numbers
:::         may be embedded within alpha text.
:::
:::    /P n - Begin sorting at character position n. Lines that have fewer than
:::           n characters are treated as equivalent values, and collate before
:::           all other lines. The default value is 1 (first character).
:::
:::    /R - Sort the lines in reverse (descending) order.
:::
:::    /V - Display the version of JSORT.BAT.
:::
:::    /? - Display this help
:::
:::JSORT.BAT was written by Dave Benham and originally posted at
:::http://www.dostips.com/forum/viewtopic.php?f=3&amp;t=5595
:::

::************ Batch portion ***********
@echo off
setlocal enableDelayedExpansion

:: Define options
set "options= /?: /i: /n: /p:1 /r: /v:"

:: Set default option values
for %%O in (%options%) do for /f "tokens=1,* delims=:" %%A in ("%%O") do set "%%A=%%~B"

:: Get options
:loop
if not "%~1"=="" (
  set "test=!options:* %~1:=! "
  if "!test!"=="!options! " (
      &gt;&amp;2 echo Error: Invalid option %~1
      exit /b 1
  ) else if "!test:~0,1!"==" " (
      set "%~1=1"
  ) else (
      set "%~1=%~2"
      shift /1
  )
  shift /1
  goto :loop
)

:: Display help
if defined /? (
  for /f "delims=: tokens=*" %%A in ('findstr "^:::" "%~f0"') do echo(%%A
  exit /b 0
)

:: Display version
if defined /v (
  for /f "delims=: tokens=*" %%A in ('findstr /bc:"::JSORT.BAT version" "%~f0"') do echo %%A
  exit /b 0
)

:: Transform and validate options
set /a "case=0%/i%, num=0%/n%, pos=%/p%-1, order=1-2*0%/r%, val=1/^!(0x80000000&amp;pos)" 2&gt;nul || (
  &gt;&amp;2 echo Error: Invalid /P value.
  exit /b 1
)

:: Perform the sort
cscript //E:JScript //nologo "%~f0" %case% %num% %pos% %order%
exit /b 0


************* JScript portion **********/
var array=new Array(),
    nocase =WScript.Arguments.Item(0),
    numeric=WScript.Arguments.Item(1),
    pos    =WScript.Arguments.Item(2),
    order  =WScript.Arguments.Item(3);
while (!WScript.StdIn.AtEndOfStream) {
  var expanded="", num="", raw=WScript.StdIn.ReadLine(), upper=((nocase==1)?raw.toUpperCase():raw);
  for( var i=pos; i&lt;raw.length; i++ ) {
    var c=upper.substr(i,1);
    if (numeric==1 &amp;&amp; c&gt;="0" &amp;&amp; c&lt;="9") {
      num+=c;
    } else {
      if (num != "") {
        num="00000000000000000000" + num;
        expanded+=num.substr(num.length-20);
        num="";
      }
      expanded+=c;
    }
  }
  if (num != "") {
    num="00000000000000000000" + num;
    expanded+=num.substr(num.length-20);
  }
  var obj={expanded:expanded, raw:raw};
  array.push(obj);
}
array.sort(function(a,b){return order*((a.expanded&gt;b.expanded)-(a.expanded&lt;b.expanded));})
for (var i=0; i&lt;array.length; i++) WScript.Echo(array[i].raw);
</code></pre></div>

Dave Benham</div>

			
													<div class="notice">
					Last edited by <a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a> on 24 Mar 2015 21:55, edited 8 times in total.
									</div>
			
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p37599" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile37599">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content37599">

						<h3 ><a href="#p37599">Re: JSORT.BAT - Case sensitive sort with option for numeric</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinge9ab.html?mode=quote&amp;f=3&amp;p=37599" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic4a5f.html?p=37599#p37599" onclick="prompt('Message #2',this.href); return false;">#2</a></span> 
									<a class="unread" href="viewtopic4a5f.html?p=37599#p37599" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>21 Oct 2014 13:50
			</p>
			
			
			
			<div class="content">There was an interesting StackOverflow question at <a href="http://stackoverflow.com/q/26487895/1012053" class="postlink">Find top 10 processes with wmic command</a>. JSORT.BAT could already sort numercally at a given line position, but it couldn't preserve the header, and it couldn't list just the top 10.<br /><br />So I modified JSORT.BAT to include the /S n (skip n lines), and /C n (print top n sorted lines) options.<br /><br />The solution becomes quite simple, and efficient. The only tricky bit is the position of the WorkingSetSize column varies depending on the longest listed file name. So extra code had to be included to compute the line position at which to start sorting.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />setlocal<br /><br />:: Get full proc list in unicode<br />wmic process list brief &gt;procList.tmp<br /><br />:: Convert unicode to ANSII<br />type procList.tmp &gt;procList.tmp2<br /><br />:: Read the header line<br />&lt;procList.tmp2 set /p &quot;header=&quot;<br /><br />:: Identify position of WorkingSetSize column<br />for /f &quot;delims=W&quot; %%A in (&quot;%header%&quot;) do echo %%A&gt;skipSize.tmp<br />for %%A in (skipSize.tmp) do set /a pos=%%~zA-1<br /><br />:: Print the header, followed by the top 10 sorted by WorkingSetSize<br />type procList.tmp2 | jsort2 /n /r /p %pos% /s 1 /c 10<br /><br />:: Delete the temp files<br />del procList.tmp procList.tmp2 skipSize.tmp<br /></code></pre></div><br /><br />Here is version 2 with the new options <strong class="text-strong"><em class="text-italics"><span style="color: #0000BF">(With 2.1 bug fix for /C option default)</span></em></strong>:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@if (@X)==(@Y) @end /* Harmless hybrid line that begins a JScript comment<br /><br />::************ Documentation ***********<br />::JSORT.BAT version 2.1<br />:::<br />:::JSORT &#91;/Option &#91;Value&#93;&#93;...<br />:::<br />:::&nbsp; Sort lines of text from stdin and write the result to stdout.<br />:::&nbsp; JSORT uses an ascending, case sensitive text sort by default.<br />:::<br />:::&nbsp; Options:<br />:::<br />:::&nbsp; &nbsp; /I&nbsp; &nbsp;- Ignore case<br />:::<br />:::&nbsp; &nbsp; /C n - Number of sorted lines to print. Skipped lines are always printed<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;and do not contribute to the count. Default is -1 (all lines).<br />:::<br />:::&nbsp; &nbsp; /N&nbsp; &nbsp;- Sort consecutive digits as numbers instead of text. The numbers<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;may be embedded within alpha text. JSort supports numbers up to<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;20 digits long.<br />:::<br />:::&nbsp; &nbsp; /P n - Begin sorting at character position n. Lines that have fewer than<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n characters are treated as equivalent values, and collate before<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;all other lines. The default value is 1 (first character).<br />:::<br />:::&nbsp; &nbsp; /R&nbsp; &nbsp;- Sort the lines in Reverse (descending) order.<br />:::<br />:::&nbsp; &nbsp; /S n - Number of lines to skip - default is 0.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Skipped lines are not sorted (remain in place)<br />:::<br />:::&nbsp; &nbsp; /V&nbsp; &nbsp;- Display the version of JSORT.BAT.<br />:::<br />:::&nbsp; &nbsp; /?&nbsp; &nbsp;- Display this help<br />:::<br />:::JSORT.BAT was written by Dave Benham and originally posted at<br />:::http://www.dostips.com/forum/viewtopic.php?f=3&amp;t=5595<br />:::<br /><br />::************ Batch portion ***********<br />@echo off<br />setlocal enableDelayedExpansion<br /><br />:: Define options<br />set &quot;options= /?: /i: /c:-1 /n: /p:1 /r: /s:0 /v:&quot;<br /><br />:: Set default option values<br />for %%O in (%options%) do for /f &quot;tokens=1,* delims=:&quot; %%A in (&quot;%%O&quot;) do set &quot;%%A=%%~B&quot;<br /><br />:: Get options<br />:loop<br />if not &quot;%~1&quot;==&quot;&quot; (<br />&nbsp; set &quot;test=!options:* %~1:=! &quot;<br />&nbsp; if &quot;!test!&quot;==&quot;!options! &quot; (<br />&nbsp; &nbsp; &nbsp; &gt;&amp;2 echo Error: Invalid option %~1<br />&nbsp; &nbsp; &nbsp; exit /b 1<br />&nbsp; ) else if &quot;!test:~0,1!&quot;==&quot; &quot; (<br />&nbsp; &nbsp; &nbsp; set &quot;%~1=1&quot;<br />&nbsp; ) else (<br />&nbsp; &nbsp; &nbsp; set &quot;%~1=%~2&quot;<br />&nbsp; &nbsp; &nbsp; shift /1<br />&nbsp; )<br />&nbsp; shift /1<br />&nbsp; goto :loop<br />)<br /><br />:: Display help<br />if defined /? (<br />&nbsp; for /f &quot;delims=: tokens=*&quot; %%A in ('findstr &quot;^:::&quot; &quot;%~f0&quot;') do echo(%%A<br />&nbsp; exit /b 0<br />)<br /><br />:: Display version<br />if defined /v (<br />&nbsp; for /f &quot;delims=: tokens=*&quot; %%A in ('findstr /bc:&quot;::JSORT.BAT version&quot; &quot;%~f0&quot;') do echo %%A<br />&nbsp; exit /b 0<br />)<br /><br />:: Transform and validate options<br />set /a &quot;case=0%/i%, num=0%/n%, pos=%/p%-1, order=1-2*0%/r%, 1/^!(0x80000000&amp;pos)&quot; 2&gt;nul || (<br />&nbsp; &gt;&amp;2 echo Error: Invalid /P value.<br />&nbsp; exit /b 1<br />)<br /><br />:: Perform the sort<br />cscript //E:JScript //nologo &quot;%~f0&quot; %case% %num% %pos% %order% %/s% %/c%<br />exit /b 0<br /><br /><br />************* JScript portion **********/<br />var array=new Array(),<br />&nbsp; &nbsp; nocase =WScript.Arguments.Item(0),<br />&nbsp; &nbsp; numeric=WScript.Arguments.Item(1),<br />&nbsp; &nbsp; pos&nbsp; &nbsp; =WScript.Arguments.Item(2),<br />&nbsp; &nbsp; order&nbsp; =WScript.Arguments.Item(3),<br />&nbsp; &nbsp;&nbsp; &nbsp;skip&nbsp; &nbsp;=WScript.Arguments.Item(4),<br />&nbsp; &nbsp;&nbsp; &nbsp;count&nbsp; =WScript.Arguments.Item(5);<br />while (!WScript.StdIn.AtEndOfStream) {<br />&nbsp; if (skip &gt; 0) {<br />&nbsp; &nbsp; WScript.Echo(WScript.StdIn.ReadLine());<br />&nbsp; &nbsp; skip-=1<br />&nbsp; } else {<br />&nbsp; &nbsp; var expanded=&quot;&quot;, num=&quot;&quot;, raw=WScript.StdIn.ReadLine(), upper=((nocase==1)?raw.toUpperCase():raw);<br />&nbsp; &nbsp; for( var i=pos; i&lt;raw.length; i++ ) {<br />&nbsp; &nbsp; &nbsp; var c=upper.substr(i,1);<br />&nbsp; &nbsp; &nbsp; if (numeric==1 &amp;&amp; c&gt;=&quot;0&quot; &amp;&amp; c&lt;=&quot;9&quot;) {<br />&nbsp; &nbsp; &nbsp; &nbsp; num+=c;<br />&nbsp; &nbsp; &nbsp; } else {<br />&nbsp; &nbsp; &nbsp; &nbsp; if (num != &quot;&quot;) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; num=&quot;00000000000000000000&quot; + num;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; expanded+=num.substr(num.length-20);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; num=&quot;&quot;;<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; expanded+=c;<br />&nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; if (num != &quot;&quot;) {<br />&nbsp; &nbsp; &nbsp; num=&quot;00000000000000000000&quot; + num;<br />&nbsp; &nbsp; &nbsp; expanded+=num.substr(num.length-20);<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; var obj={expanded:expanded, raw:raw};<br />&nbsp; &nbsp; array.push(obj);<br />&nbsp; }<br />}<br />if (count&lt;0) count=array.length;<br />if (count&gt;array.length) count=array.length;<br />array.sort(function(a,b){return order*((a.expanded&gt;b.expanded)-(a.expanded&lt;b.expanded));});<br />for (var i=0; i&lt;count; i++) WScript.Echo(array&#91;i&#93;.raw);<br /></code></pre></div><br /><br />Dave Benham</div>

			
													<div class="notice">
					Last edited by <a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a> on 22 Oct 2014 09:49, edited 1 time in total.
									</div>
			
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p37605" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile37605">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf147.html?author_id=3221&amp;sr=posts">6033</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Feb 2012 02:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content37605">

						<h3 ><a href="#p37605">Re: JSORT.BAT - Case sensitive sort with option for numeric</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting943d.html?mode=quote&amp;f=3&amp;p=37605" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicd0d8.html?p=37605#p37605" onclick="prompt('Message #3',this.href); return false;">#3</a></span> 
									<a class="unread" href="viewtopicd0d8.html?p=37605#p37605" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a></strong> &raquo; </span>21 Oct 2014 22:29
			</p>
			
			
			
			<div class="content">Thank Dave, as always for your useful tools.<br /><br />Just thinking that you might like to change the batch to provide help when no options are given.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p37613" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile37613">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content37613">

						<h3 ><a href="#p37613">Re: JSORT.BAT - Case sensitive sort with option for numeric </a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting10c4.html?mode=quote&amp;f=3&amp;p=37613" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic56b0.html?p=37613#p37613" onclick="prompt('Message #4',this.href); return false;">#4</a></span> 
									<a class="unread" href="viewtopic56b0.html?p=37613#p37613" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>22 Oct 2014 06:14
			</p>
			
			
			
			<div class="content">No, JSORT is much like MORE or SORT - it is perfectly reasonable to run the command without any arguments or options, and it will wait silently for input, gathering everything that is entered, and then print out the sorted lines after &lt;Ctrl-Z&gt; is pressed.<br /><br />Running it without any options performs a case sensitive sort.<br /><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p37614" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile37614">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content37614">

						<h3 ><a href="#p37614">Re: JSORT.BAT - Case sensitive sort with option for numeric </a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting965b.html?mode=quote&amp;f=3&amp;p=37614" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic3ece.html?p=37614#p37614" onclick="prompt('Message #5',this.href); return false;">#5</a></span> 
									<a class="unread" href="viewtopic3ece.html?p=37614#p37614" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>22 Oct 2014 09:52
			</p>
			
			
			
			<div class="content">Updated to version 2.1 - fixed /C option default. Was 0, corrected to -1. Eariler post has been edited.<br /><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p37623" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile37623">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf147.html?author_id=3221&amp;sr=posts">6033</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Feb 2012 02:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content37623">

						<h3 ><a href="#p37623">Re: JSORT.BAT - Case sensitive sort with option for numeric</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting7334.html?mode=quote&amp;f=3&amp;p=37623" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic5a74.html?p=37623#p37623" onclick="prompt('Message #6',this.href); return false;">#6</a></span> 
									<a class="unread" href="viewtopic5a74.html?p=37623#p37623" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a></strong> &raquo; </span>22 Oct 2014 17:17
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>dbenham wrote:</cite>JSORT is much like MORE or SORT - it is perfectly reasonable to run the command without any arguments or options</div></blockquote><br /><br />Okelidokily.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p37806" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile37806">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content37806">

						<h3 ><a href="#p37806">Re: JSORT.BAT - Case sensitive sort with option for numeric </a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingb9a9.html?mode=quote&amp;f=3&amp;p=37806" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic567d.html?p=37806#p37806" onclick="prompt('Message #7',this.href); return false;">#7</a></span> 
									<a class="unread" href="viewtopic567d.html?p=37806#p37806" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>05 Nov 2014 17:02
			</p>
			
			
			
			<div class="content">I saw another <a href="http://stackoverflow.com/q/26750360/1012053" class="postlink">StackOverflow question</a> that led me to add yet another feature to JSort.<br /><br />JSort now allows you to sort beginning at a given token position, rather than an absolute character position. The /T option specifies the token, and the /D option specifies the delimiter string (note - the delimiter can have length &gt; 1). The /P option now specifies the position relative to the start of the selected token, rather than from the beginning of the string. The default token is 1, so it does not change the behavior when /T is not specified.<br /><br />I also provide the option to specify the file to sort as the first argument, so you are no longer forced to use redirection or a pipe.<br /><br />So, if given file <strong class="text-strong">test.txt</strong>:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>goodbye,Z570<br />Hello world,A100<br />Ivanhoe,Z36<br />tiddleywinks,B36<br />Variable length text,A9<br /></code></pre></div><br />Then the following command:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>jsort test.txt /t 2 /d &quot;,&quot; /n<br /></code></pre></div><br />produces this output:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>Variable length text,A9<br />Hello world,A100<br />tiddleywinks,B36<br />Ivanhoe,Z36<br />goodbye,Z570<br /></code></pre></div><br /><br />Here is version 3.0<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@if (@X)==(@Y) @end /* Harmless hybrid line that begins a JScript comment<br /><br />::************ Documentation ***********<br />::JSORT.BAT version 3.0<br />:::<br />:::JSORT &#91;File&#93; &#91;/Option &#91;Value&#93;&#93;...<br />:::<br />:::&nbsp; Sort lines of text from stdin and write the result to stdout.<br />:::&nbsp; JSORT uses an ascending, case sensitive text sort by default.<br />:::<br />:::&nbsp; &nbsp; File - If the optional File argument is specified, then JSORT reads lines<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;from the file instead of from stdin. If specified, the File must<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;be the very first argument.<br />:::<br />:::&nbsp; Options:<br />:::<br />:::&nbsp; &nbsp; /C n - Number of sorted lines to print. Skipped lines are always printed<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;and do not contribute to the count. Default is -1 (all lines).<br />:::<br />:::&nbsp; &nbsp; /D string - Specifies the string used to delimit tokens. The delimiter<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;string is always case sensitive. A quote literal &quot; must be escaped<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;as \q, and a backslash literal \ must be escaped as \\.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;The default value is an empty string, meaning treat the entire<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;line as a single token.<br />:::<br />:::&nbsp; &nbsp; /I&nbsp; &nbsp;- Ignore case when sorting<br />:::<br />:::&nbsp; &nbsp; /N&nbsp; &nbsp;- Sort consecutive digits as numbers instead of text. The numbers<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;may be embedded within alpha text. JSort supports numbers up to<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;20 digits long.<br />:::<br />:::&nbsp; &nbsp; /P n - Begin sorting at character position n relative to the beginning<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;of the selected token. Lines that do not extend that far are<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;treated as equivalent values, and collate before all other lines.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;The default value is 1 (first character).<br />:::<br />:::&nbsp; &nbsp; /R&nbsp; &nbsp;- Sort the lines in Reverse (descending) order.<br />:::<br />:::&nbsp; &nbsp; /S n - Number of lines to skip - default is 0.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Skipped lines are not sorted (remain in place)<br />:::<br />:::&nbsp; &nbsp; /T n - Specify the token at which to begin sorting. The default value<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;is 1 (first token).<br />:::<br />:::&nbsp; &nbsp; /V&nbsp; &nbsp;- Display the version of JSORT.BAT.<br />:::<br />:::&nbsp; &nbsp; /?&nbsp; &nbsp;- Display this help<br />:::<br />:::JSORT.BAT was written by Dave Benham and originally posted at<br />:::http://www.dostips.com/forum/viewtopic.php?f=3&amp;t=5595<br />:::<br /><br />::************ Batch portion ***********<br />@echo off<br />setlocal disableDelayedExpansion<br /><br />:: Get optional input file<br />set &quot;redirect=&quot;<br />set &quot;file=%~1&quot;<br />setlocal enableDelayedExpansion<br />if defined file if &quot;!file:~0,1!&quot; neq &quot;/&quot; (<br />&nbsp; set &quot;redirect=&lt;&quot;!file!&quot;&quot;<br />&nbsp; shift /1<br />)<br /><br />:: Define options<br />set &quot;options= /?: /i: /c:-1 /n: /p:1 /r: /s:0 /v: /d:&quot;&quot; /t:1 &quot;<br /><br />:: Set default option values<br />for %%O in (%options%) do for /f &quot;tokens=1,* delims=:&quot; %%A in (&quot;%%O&quot;) do set &quot;%%A=%%~B&quot;<br /><br />:: Get options<br />:loop<br />if not &quot;%~1&quot;==&quot;&quot; (<br />&nbsp; set &quot;test=!options:* %~1:=! &quot;<br />&nbsp; if &quot;!test!&quot;==&quot;!options! &quot; (<br />&nbsp; &nbsp; &nbsp; &gt;&amp;2 echo Error: Invalid option %~1<br />&nbsp; &nbsp; &nbsp; exit /b 1<br />&nbsp; ) else if &quot;!test:~0,1!&quot;==&quot; &quot; (<br />&nbsp; &nbsp; &nbsp; set &quot;%~1=1&quot;<br />&nbsp; ) else (<br />&nbsp; &nbsp; &nbsp; set &quot;%~1=%~2&quot;<br />&nbsp; &nbsp; &nbsp; shift /1<br />&nbsp; )<br />&nbsp; shift /1<br />&nbsp; goto :loop<br />)<br /><br />:: Display help<br />if defined /? (<br />&nbsp; for /f &quot;delims=: tokens=*&quot; %%A in ('findstr &quot;^:::&quot; &quot;%~f0&quot;') do echo(%%A<br />&nbsp; exit /b 0<br />)<br /><br />:: Display version<br />if defined /v (<br />&nbsp; for /f &quot;delims=: tokens=*&quot; %%A in ('findstr /bc:&quot;::JSORT.BAT version&quot; &quot;%~f0&quot;') do echo %%A<br />&nbsp; exit /b 0<br />)<br /><br />:: Transform and validate options<br />set /a &quot;case=0%/i%, num=0%/n%, pos=%/p%-1, tok=%/t%-1, order=1-2*0%/r%, 1/^!(0x80000000&amp;pos), 1/^!(0x80000000&amp;tok)&quot; 2&gt;nul || (<br />&nbsp; &gt;&amp;2 echo Error: Invalid option value.<br />&nbsp; exit /b 1<br />)<br /><br />:: Perform the sort<br />%redirect% cscript //E:JScript //nologo &quot;%~f0&quot; %case% %num% %pos% %order% %/s% %/c% %tok% &quot;%/d%&quot;<br /><br />exit /b 0<br />************* JScript portion **********/<br />var array=new Array(),<br />&nbsp; &nbsp; nocase =WScript.Arguments.Item(0),<br />&nbsp; &nbsp; numeric=WScript.Arguments.Item(1),<br />&nbsp; &nbsp; pos&nbsp; &nbsp; =WScript.Arguments.Item(2),<br />&nbsp; &nbsp; order&nbsp; =WScript.Arguments.Item(3),<br />&nbsp; &nbsp; skip&nbsp; &nbsp;=WScript.Arguments.Item(4),<br />&nbsp; &nbsp; count&nbsp; =WScript.Arguments.Item(5),<br />&nbsp; &nbsp; token&nbsp; =WScript.Arguments.Item(6),<br />&nbsp; &nbsp; delim&nbsp; =WScript.Arguments.Item(7).replace(/\\(?!q|\\)/g,'').replace(/\\\\/g,'\\s').replace(/\\q/g,'&quot;').replace(/\\s/g,'\\');<br />while (!WScript.StdIn.AtEndOfStream) {<br />&nbsp; if (skip &gt; 0) {<br />&nbsp; &nbsp; WScript.Echo(WScript.StdIn.ReadLine());<br />&nbsp; &nbsp; skip-=1<br />&nbsp; } else {<br />&nbsp; &nbsp; var expanded=&quot;&quot;, num=&quot;&quot;, raw=WScript.StdIn.ReadLine(), upper=((nocase==1)?raw.toUpperCase():raw);<br />&nbsp; &nbsp; for( var i=pos+FindToken(raw,delim,token); i&lt;raw.length; i++ ) {<br />&nbsp; &nbsp; &nbsp; var c=upper.substr(i,1);<br />&nbsp; &nbsp; &nbsp; if (numeric==1 &amp;&amp; c&gt;=&quot;0&quot; &amp;&amp; c&lt;=&quot;9&quot;) {<br />&nbsp; &nbsp; &nbsp; &nbsp; num+=c;<br />&nbsp; &nbsp; &nbsp; } else {<br />&nbsp; &nbsp; &nbsp; &nbsp; if (num != &quot;&quot;) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; num=&quot;00000000000000000000&quot; + num;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; expanded+=num.substr(num.length-20);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; num=&quot;&quot;;<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; expanded+=c;<br />&nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; if (num != &quot;&quot;) {<br />&nbsp; &nbsp; &nbsp; num=&quot;00000000000000000000&quot; + num;<br />&nbsp; &nbsp; &nbsp; expanded+=num.substr(num.length-20);<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; var obj={expanded:expanded, raw:raw};<br />&nbsp; &nbsp; array.push(obj);<br />&nbsp; }<br />}<br />if (count&lt;0) count=array.length;<br />if (count&gt;array.length) count=array.length;<br />array.sort(function(a,b){return order*((a.expanded&gt;b.expanded)-(a.expanded&lt;b.expanded));});<br />for (var i=0; i&lt;count; i++) WScript.Echo(array&#91;i&#93;.raw);<br /><br />function FindToken(str, str2, n) {<br />&nbsp; if (n&gt;0 &amp;&amp; str2==&quot;&quot;) return str.length;<br />&nbsp; var rtn = 0;<br />&nbsp; for( var i=n; i&gt;0; i-- ) {<br />&nbsp; &nbsp; rtn = str.indexOf(str2,rtn);<br />&nbsp; &nbsp; if (rtn&lt;0) return str.length;<br />&nbsp; &nbsp; rtn+=str2.length;<br />&nbsp; }<br />&nbsp; return rtn;<br />}<br /></code></pre></div><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p37807" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile37807">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist2675.html?mode=viewprofile&amp;u=2988" style="color: #00AA00;" class="username-coloured">Squashman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1322.html?author_id=2988&amp;sr=posts">3970</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 Dec 2011 13:59</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content37807">

						<h3 ><a href="#p37807">Re: JSORT.BAT - Case sensitive sort with option for numeric </a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingaf8f.html?mode=quote&amp;f=3&amp;p=37807" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic2e36.html?p=37807#p37807" onclick="prompt('Message #8',this.href); return false;">#8</a></span> 
									<a class="unread" href="viewtopic2e36.html?p=37807#p37807" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist2675.html?mode=viewprofile&amp;u=2988" style="color: #00AA00;" class="username-coloured">Squashman</a></strong> &raquo; </span>05 Nov 2014 19:49
			</p>
			
			
			
			<div class="content">Sweet! I am definitely going to use that option. <br />Just wondering if jsort would run faster if you could specify the output filename instead of redirecting stdout? Similar to the built in sort utility.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p37823" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile37823">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content37823">

						<h3 ><a href="#p37823">Re: JSORT.BAT - Case sensitive sort with option for numeric</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingce84.html?mode=quote&amp;f=3&amp;p=37823" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic1d0d.html?p=37823#p37823" onclick="prompt('Message #9',this.href); return false;">#9</a></span> 
									<a class="unread" href="viewtopic1d0d.html?p=37823#p37823" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>06 Nov 2014 11:02
			</p>
			
			
			
			<div class="content">Perhaps there is a small performance gain to be had, but I'm lazy  <img class="smilies" src="images/smilies/icon_mrgreen.gif" alt=":mrgreen:" title="Mr. Green" /> <br /><br />As I said earlier, I've done very little to optimize the JScript code. It works fine for the small tasks that I've used it for, but it may not perform well with very large files. Given that the JScript loads the entire file in memory (twice over!), I suspect that the utility will completely fail at some size threshold.<br /><br />I've implemented an /O option to specify the output file in lieu of using redirection. However, I took the easy way out and perform redirection within the batch code, so there is no performance benefit to using /O.<br /><br />Version 3.2 also fixes a bug with the File argument implementation. Version 3.0 failed if the file path included an exclamation point (!). (Version 3.1 had major argument parsing bugs)<br /><br /><strong class="text-strong">Version 3.2</strong><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@if (@X)==(@Y) @end /* Harmless hybrid line that begins a JScript comment<br /><br />::************ Documentation ***********<br />::JSORT.BAT version 3.2<br />:::<br />:::JSORT &#91;File&#93; &#91;/Option &#91;Value&#93;&#93;...<br />:::<br />:::&nbsp; Sort lines of text from stdin and write the result to stdout.<br />:::&nbsp; JSORT uses an ascending, case sensitive text sort by default.<br />:::<br />:::&nbsp; &nbsp; File - If the optional File argument is specified, then JSORT reads lines<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;from the file instead of from stdin. If specified, the File must<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;be the very first argument.<br />:::<br />:::&nbsp; Options:<br />:::<br />:::&nbsp; &nbsp; /C n - Number of sorted lines to print. Skipped lines are always printed<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;and do not contribute to the count. Default is -1 (all lines).<br />:::<br />:::&nbsp; &nbsp; /D String - Specifies the string used to delimit tokens. The delimiter<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;string is always case sensitive. A quote literal &quot; must be escaped<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;as \q, and a backslash literal \ must be escaped as \\.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;The default value is an empty string, meaning treat the entire<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;line as a single token.<br />:::<br />:::&nbsp; &nbsp; /I&nbsp; &nbsp;- Ignore case when sorting<br />:::<br />:::&nbsp; &nbsp; /N&nbsp; &nbsp;- Sort consecutive digits as numbers instead of text. The numbers<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;may be embedded within alpha text. JSort supports numbers up to<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;20 digits long.<br />:::<br />:::&nbsp; &nbsp; /O File - Writes the output to File instead of stdout.<br />:::<br />:::&nbsp; &nbsp; /P n - Begin sorting at character position n relative to the beginning<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;of the selected token. Lines that do not extend that far are<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;treated as equivalent values, and collate before all other lines.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;The default value is 1 (first character).<br />:::<br />:::&nbsp; &nbsp; /R&nbsp; &nbsp;- Sort the lines in Reverse (descending) order.<br />:::<br />:::&nbsp; &nbsp; /S n - Number of lines to skip - default is 0.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Skipped lines are not sorted (remain in place)<br />:::<br />:::&nbsp; &nbsp; /T n - Specify the token at which to begin sorting. The default value<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;is 1 (first token).<br />:::<br />:::&nbsp; &nbsp; /V&nbsp; &nbsp;- Display the version of JSORT.BAT.<br />:::<br />:::&nbsp; &nbsp; /?&nbsp; &nbsp;- Display this help<br />:::<br />:::JSORT.BAT was written by Dave Benham and originally posted at<br />:::http://www.dostips.com/forum/viewtopic.php?f=3&amp;t=5595<br />:::<br /><br />::************ Batch portion ***********<br />@echo off<br />setlocal disableDelayedExpansion<br /><br />:: Get optional input file<br />set &quot;infile=&quot;<br />set &quot;test=%~1&quot;<br />setlocal enableDelayedExpansion<br />if defined test if &quot;!test:~0,1!&quot; neq &quot;/&quot; (<br />&nbsp; endlocal<br />&nbsp; set ^&quot;infile=^&lt;&quot;%~1&quot;&quot;<br />&nbsp; shift /1<br />) else endlocal<br /><br />:: Define options<br />set &quot;options= /?: /i: /c:-1 /n: /p:1 /r: /s:0 /v: /d:&quot;&quot; /t:1 /o:&quot;&quot; &quot;<br /><br />:: Set default option values<br />for %%O in (%options%) do for /f &quot;tokens=1,* delims=:&quot; %%A in (&quot;%%O&quot;) do set &quot;%%A=%%~B&quot;<br /><br />:: Get options<br />:loop<br />if not &quot;%~1&quot;==&quot;&quot; (<br />&nbsp; setlocal enableDelayedExpansion<br />&nbsp; set &quot;test=!options:* %~1:=! &quot;<br />&nbsp; if &quot;!test!&quot;==&quot;!options! &quot; (<br />&nbsp; &nbsp; &nbsp; &gt;&amp;2 echo Error: Invalid option %~1<br />&nbsp; &nbsp; &nbsp; exit /b 1<br />&nbsp; ) else if &quot;!test:~0,1!&quot;==&quot; &quot; (<br />&nbsp; &nbsp; &nbsp; endlocal<br />&nbsp; &nbsp; &nbsp; set &quot;%~1=1&quot;<br />&nbsp; ) else (<br />&nbsp; &nbsp; &nbsp; endlocal<br />&nbsp; &nbsp; &nbsp; set &quot;%~1=%~2&quot;<br />&nbsp; &nbsp; &nbsp; shift /1<br />&nbsp; )<br />&nbsp; shift /1<br />&nbsp; goto :loop<br />)<br /><br />:: Display help<br />if defined /? (<br />&nbsp; for /f &quot;delims=: tokens=*&quot; %%A in ('findstr &quot;^:::&quot; &quot;%~f0&quot;') do echo(%%A<br />&nbsp; exit /b 0<br />)<br /><br />:: Display version<br />if defined /v (<br />&nbsp; for /f &quot;delims=: tokens=*&quot; %%A in ('findstr /bc:&quot;::JSORT.BAT version&quot; &quot;%~f0&quot;') do echo %%A<br />&nbsp; exit /b 0<br />)<br /><br />:: Transform and validate options<br />set /a &quot;case=0%/i%, num=0%/n%, pos=%/p%-1, tok=%/t%-1, order=1-2*0%/r%, 1/!(0x80000000&amp;pos), 1/!(0x80000000&amp;tok)&quot; 2&gt;nul || (<br />&nbsp; &gt;&amp;2 echo Error: Invalid option value.<br />&nbsp; exit /b 1<br />)<br />set &quot;outfile=&quot;<br />if defined /o set ^&quot;outfile=^&gt;&quot;%/o%&quot;&quot;<br /><br />:: Perform the sort<br />%infile% %outfile% cscript //E:JScript //nologo &quot;%~f0&quot; %case% %num% %pos% %order% %/s% %/c% %tok% &quot;%/d%&quot;<br /><br />exit /b 0<br />************* JScript portion **********/<br />var array=new Array(),<br />&nbsp; &nbsp; nocase =WScript.Arguments.Item(0),<br />&nbsp; &nbsp; numeric=WScript.Arguments.Item(1),<br />&nbsp; &nbsp; pos&nbsp; &nbsp; =WScript.Arguments.Item(2),<br />&nbsp; &nbsp; order&nbsp; =WScript.Arguments.Item(3),<br />&nbsp; &nbsp; skip&nbsp; &nbsp;=WScript.Arguments.Item(4),<br />&nbsp; &nbsp; count&nbsp; =WScript.Arguments.Item(5),<br />&nbsp; &nbsp; token&nbsp; =WScript.Arguments.Item(6),<br />&nbsp; &nbsp; delim&nbsp; =WScript.Arguments.Item(7).replace(/\\(?!q|\\)/g,'').replace(/\\\\/g,'\\s').replace(/\\q/g,'&quot;').replace(/\\s/g,'\\');<br />while (!WScript.StdIn.AtEndOfStream) {<br />&nbsp; if (skip &gt; 0) {<br />&nbsp; &nbsp; WScript.Echo(WScript.StdIn.ReadLine());<br />&nbsp; &nbsp; skip-=1<br />&nbsp; } else {<br />&nbsp; &nbsp; var expanded=&quot;&quot;, num=&quot;&quot;, raw=WScript.StdIn.ReadLine(), upper=((nocase==1)?raw.toUpperCase():raw);<br />&nbsp; &nbsp; for( var i=pos+FindToken(raw,delim,token); i&lt;raw.length; i++ ) {<br />&nbsp; &nbsp; &nbsp; var c=upper.substr(i,1);<br />&nbsp; &nbsp; &nbsp; if (numeric==1 &amp;&amp; c&gt;=&quot;0&quot; &amp;&amp; c&lt;=&quot;9&quot;) {<br />&nbsp; &nbsp; &nbsp; &nbsp; num+=c;<br />&nbsp; &nbsp; &nbsp; } else {<br />&nbsp; &nbsp; &nbsp; &nbsp; if (num != &quot;&quot;) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; num=&quot;00000000000000000000&quot; + num;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; expanded+=num.substr(num.length-20);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; num=&quot;&quot;;<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; expanded+=c;<br />&nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; if (num != &quot;&quot;) {<br />&nbsp; &nbsp; &nbsp; num=&quot;00000000000000000000&quot; + num;<br />&nbsp; &nbsp; &nbsp; expanded+=num.substr(num.length-20);<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; var obj={expanded:expanded, raw:raw};<br />&nbsp; &nbsp; array.push(obj);<br />&nbsp; }<br />}<br />if (count&lt;0) count=array.length;<br />if (count&gt;array.length) count=array.length;<br />array.sort(function(a,b){return order*((a.expanded&gt;b.expanded)-(a.expanded&lt;b.expanded));});<br />for (var i=0; i&lt;count; i++) WScript.Echo(array&#91;i&#93;.raw);<br /><br />function FindToken(str, str2, n) {<br />&nbsp; if (n&gt;0 &amp;&amp; str2==&quot;&quot;) return str.length;<br />&nbsp; var rtn = 0;<br />&nbsp; for( var i=n; i&gt;0; i-- ) {<br />&nbsp; &nbsp; rtn = str.indexOf(str2,rtn);<br />&nbsp; &nbsp; if (rtn&lt;0) return str.length;<br />&nbsp; &nbsp; rtn+=str2.length;<br />&nbsp; }<br />&nbsp; return rtn;<br />}<br /></code></pre></div><br /><br />Dave Benham</div>

			
													<div class="notice">
					Last edited by <a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a> on 06 Nov 2014 13:34, edited 1 time in total.
									</div>
			
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p37824" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile37824">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist2675.html?mode=viewprofile&amp;u=2988" style="color: #00AA00;" class="username-coloured">Squashman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1322.html?author_id=2988&amp;sr=posts">3970</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 Dec 2011 13:59</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content37824">

						<h3 ><a href="#p37824">Re: JSORT.BAT - Case sensitive sort with option for numeric </a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingf9f8.html?mode=quote&amp;f=3&amp;p=37824" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic9f25.html?p=37824#p37824" onclick="prompt('Message #10',this.href); return false;">#10</a></span> 
									<a class="unread" href="viewtopic9f25.html?p=37824#p37824" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist2675.html?mode=viewprofile&amp;u=2988" style="color: #00AA00;" class="username-coloured">Squashman</a></strong> &raquo; </span>06 Nov 2014 11:39
			</p>
			
			
			
			<div class="content">Well then maybe that won't work for me then.  I mostly work with very large files.  Hundreds of megabytes and sometimes a gigabyte or two.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p37827" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile37827">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content37827">

						<h3 ><a href="#p37827">Re: JSORT.BAT - Case sensitive sort with option for numeric </a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingf166.html?mode=quote&amp;f=3&amp;p=37827" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic0264.html?p=37827#p37827" onclick="prompt('Message #11',this.href); return false;">#11</a></span> 
									<a class="unread" href="viewtopic0264.html?p=37827#p37827" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>06 Nov 2014 12:40
			</p>
			
			
			
			<div class="content">Can you give a large file a try and report back <img class="smilies" src="images/smilies/icon_question.gif" alt=":?:" title="Question" /> I'm curious.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p37828" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile37828">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist2675.html?mode=viewprofile&amp;u=2988" style="color: #00AA00;" class="username-coloured">Squashman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1322.html?author_id=2988&amp;sr=posts">3970</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 Dec 2011 13:59</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content37828">

						<h3 ><a href="#p37828">Re: JSORT.BAT - Case sensitive sort with option for numeric</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting0032.html?mode=quote&amp;f=3&amp;p=37828" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic0975.html?p=37828#p37828" onclick="prompt('Message #12',this.href); return false;">#12</a></span> 
									<a class="unread" href="viewtopic0975.html?p=37828#p37828" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist2675.html?mode=viewprofile&amp;u=2988" style="color: #00AA00;" class="username-coloured">Squashman</a></strong> &raquo; </span>06 Nov 2014 12:44
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>dbenham wrote:</cite>Can you give a large file a try and report back <img class="smilies" src="images/smilies/icon_question.gif" alt=":?:" title="Question" /> I'm curious.</div></blockquote><br />I will put it on my todo list.  Been putting out fires every day this week.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p37829" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile37829">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content37829">

						<h3 ><a href="#p37829">Re: JSORT.BAT - Case sensitive sort with option for numeric </a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting63ad.html?mode=quote&amp;f=3&amp;p=37829" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic9781.html?p=37829#p37829" onclick="prompt('Message #13',this.href); return false;">#13</a></span> 
									<a class="unread" href="viewtopic9781.html?p=37829#p37829" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>06 Nov 2014 13:35
			</p>
			
			
			
			<div class="content">Updated prior post to version 3.2.<br /><br />Version 3.1 had major argument parsing bugs <img class="smilies" src="images/smilies/icon_redface.gif" alt=":oops:" title="Embarassed" /></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p37830" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile37830">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content37830">

						<h3 ><a href="#p37830">Re: JSORT.BAT - Case sensitive sort with option for numeric </a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingd3f2.html?mode=quote&amp;f=3&amp;p=37830" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic7ae2.html?p=37830#p37830" onclick="prompt('Message #14',this.href); return false;">#14</a></span> 
									<a class="unread" href="viewtopic7ae2.html?p=37830#p37830" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>06 Nov 2014 14:09
			</p>
			
			
			
			<div class="content">I successfully sorted a ~15 mb file in 64 seconds.<br /><br />I attempted to sort a ~30 mb file and it failed with an &quot;Out of memory&quot; error.  <img class="smilies" src="images/smilies/icon_evil.gif" alt=":evil:" title="Evil or Very Mad" /> <br /><br />So it looks like this utility is no good for large files - Sorry Squashman  <img class="smilies" src="images/smilies/icon_sad.gif" alt=":(" title="Sad" /></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p37831" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile37831">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist2675.html?mode=viewprofile&amp;u=2988" style="color: #00AA00;" class="username-coloured">Squashman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1322.html?author_id=2988&amp;sr=posts">3970</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 Dec 2011 13:59</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content37831">

						<h3 ><a href="#p37831">Re: JSORT.BAT - Case sensitive sort with option for numeric</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingecfb.html?mode=quote&amp;f=3&amp;p=37831" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicf996.html?p=37831#p37831" onclick="prompt('Message #15',this.href); return false;">#15</a></span> 
									<a class="unread" href="viewtopicf996.html?p=37831#p37831" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist2675.html?mode=viewprofile&amp;u=2988" style="color: #00AA00;" class="username-coloured">Squashman</a></strong> &raquo; </span>06 Nov 2014 14:24
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>dbenham wrote:</cite>I successfully sorted a ~15 mb file in 64 seconds.<br /><br />I attempted to sort a ~30 mb file and it failed with an &quot;Out of memory&quot; error.  <img class="smilies" src="images/smilies/icon_evil.gif" alt=":evil:" title="Evil or Very Mad" /> <br /><br />So it looks like this utility is no good for large files - Sorry Squashman  <img class="smilies" src="images/smilies/icon_sad.gif" alt=":(" title="Sad" /></div></blockquote><br /><br />How much ram do you have?<br /><br />I know when I only had 1GB of ram on my computer I had issues reading large files with FOR /F because it also loads the whole file into memory first.  I could usually process about a 600 MB file.  Now I have a 4GB and can run larger files but is still pretty slow.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
	

	<div class="action-bar bar-bottom">
	
			<a href="posting5cc0.html?mode=reply&amp;f=3&amp;t=5595" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic5f4e.html?f=3&amp;t=5595&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

			<form method="post" action="https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=5595">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			47 posts
							<ul>
		<li class="active"><span>1</span></li>
				<li><a class="button" href="viewtopic4ecd.html?f=3&amp;t=5595&amp;start=15" role="button">2</a></li>
				<li><a class="button" href="viewtopicd770.html?f=3&amp;t=5595&amp;start=30" role="button">3</a></li>
				<li><a class="button" href="viewtopic89dc.html?f=3&amp;t=5595&amp;start=45" role="button">4</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopic4ecd.html?f=3&amp;t=5595&amp;start=15" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="viewforum4d6b.html?f=3" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to “DOS Batch Forum”</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="viewforum31e6.html?f=4" class="jumpbox-cat-link"> <span> DosTips - Dos Batch</span></a></li>
																<li><a href="viewforum4d6b.html?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; DOS Batch Forum</span></a></li>
											</ul>
		</div>
	</div>

	</div>


			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
							<span class="crumb"><a href="../index.html" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>DosTips.com</span></a></span>									<span class="crumb"><a href="index.html" data-navbar-reference="index"><span>Board index</span></a></span>					</li>
		
				<li class="rightside">All times are <span title="UTC-6">UTC-06:00</span></li>
							<li class="rightside">
				<a href="ucp033a.html?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete all board cookies</span>
				</a>
			</li>
												<li class="rightside" data-last-responsive="true">
				<a href="memberlist4bfd.html?mode=team" role="menuitem">
					<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
				</a>
			</li>
									<li class="rightside" data-last-responsive="true">
				<a href="memberlist8733.html?mode=contactadmin" role="menuitem">
					<i class="icon fa-envelope fa-fw" aria-hidden="true"></i><span>Contact us</span>
				</a>
			</li>
			</ul>

	</div>
</div>

	<div class="copyright">
				<!-- WARNING NO DELETE -->Style developer by <a href="http://tricolor.x-tk.ru/">support forum tricolor</a>, <!-- END WARNING NO DELETE -->Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
									</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	<img src="cron68e3.gif?cron_type=cron.task.text_reparser.pm_text" width="1" height="1" alt="cron" /></div>

<script type="text/javascript" src="assets/javascript/jquery.mind772.js?assets_version=34"></script>
<script type="text/javascript" src="assets/javascript/cored772.js?assets_version=34"></script>



<script type="text/javascript" src="styles/prosilver/template/forum_fnd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/prosilver/template/ajaxd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/jquery-uid772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/collapsed772.js?assets_version=34"></script>



</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?p=37623 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 06:45:43 GMT -->
</html>
