<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?p=11365 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 06:43:37 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>Macros with parameters appended - DosTips.com</title>


	<link rel="canonical" href="viewtopic0344.html?t=2518">

<!--
	phpBB style name: Allan Style - SUBSILVER
	Based on style:   prosilver (this is the default phpBB3 style)
	Based on style:   subsilver2 (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:  Allan ( http://x-tk.ru/ )
-->

<link href="assets/css/font-awesome.mind772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/stylesheetd772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/en/stylesheetd772.css?assets_version=34" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="./styles/AllanStyle-SUBSILVER/theme/tweaks.css?assets_version=34" rel="stylesheet">
<![endif]-->




<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','../../www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-280191-1', 'auto');
	ga('send', 'pageview');
</script>

</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">

<div id="header-subsilver">
	<a id="top" class="top-anchor" accesskey="t"></a>
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description" class="site-description">
				<a id="logo" class="logo" href="../index.html" title="DosTips.com"><span class="site_logo"></span></a>
				<h1>DosTips.com</h1>
				<p>A Forum all about DOS Batch</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

									<div id="search-box" class="search-box search-header" role="search">
				<form action="https://www.dostips.com/forum/search.php" method="get" id="search">
				<fieldset>
					<input name="keywords" id="keywords" type="search" maxlength="128" title="Search for keywords" class="inputbox search tiny" size="20" value="" placeholder="Search…" />
					<button class="button button-search" type="submit" title="Search">
						<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
					</button>
					<a href="search.html" class="button button-search-end" title="Advanced search">
						<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
					</a>
					
				</fieldset>
				</form>
			</div>
						
			</div>
					</div>
</div>


<div id="wrap" class="wrap">
	<div id="page-header">
				<div class="navbar-top" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
																									<li>
								<a href="search33a7.html?search_id=unanswered" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="search526f.html?search_id=active_topics" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-blue" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="search.html" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
											<li class="separator"></li>
																			<li>
								<a href="memberlist4bfd.html?mode=team" role="menuitem">
									<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
								</a>
							</li>
																<li class="separator"></li>

									</ul>
			</div>
		</li>

				<li data-skip-responsive="true">
			<a href="app.php/help/faq.html" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
						
			<li class="rightside"  data-skip-responsive="true">
			<a href="ucp26c3.html?mode=login" title="Login" accesskey="x" role="menuitem">
				<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Login</span>
			</a>
		</li>
					<li class="rightside" data-skip-responsive="true">
				<a href="ucp8319.html?mode=register" role="menuitem">
					<i class="icon fa-pencil-square-o  fa-fw" aria-hidden="true"></i><span>Register</span>
				</a>
			</li>
						</ul>

	</div>
</div>

<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
						<li class="breadcrumbs">
							<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="../index.html" itemprop="url" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span itemprop="title">DosTips.com</span></a></span>
										<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="index.html" itemprop="url" accesskey="h" data-navbar-reference="index"><span itemprop="title">Board index</span></a></span>

											<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="4"><a href="viewforum31e6.html?f=4" itemprop="url"><span itemprop="title">DosTips - Dos Batch</span></a></span>
															<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="3"><a href="viewforum4d6b.html?f=3" itemprop="url"><span itemprop="title">DOS Batch Forum</span></a></span>
												</li>
		
					<li class="rightside responsive-search">
				<a href="search.html" title="View the advanced search options" role="menuitem">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</a>
			</li>
			</ul>

	</div>
</div>

<div class="navbar-top-link">
	<div class="inner">
		<ul>
			<li class="navbar-top-link-left"><a href="search33a7.html?search_id=unanswered">Unanswered topics</a></li>
			<li class="navbar-top-link-left"><a href="search526f.html?search_id=active_topics">Active topics</a></li>

											</ul>
	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
		
<h2 class="topic-title"><a href="viewtopic1ca9.html?f=3&amp;t=2518">Macros with parameters appended</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">Discussion forum for all Windows batch related topics.<br /></div>
<p>
	<strong>Moderator:</strong> <a href="memberlista6a8.html?mode=viewprofile&amp;u=5" class="username">DosItHelp</a>
</p>


<div class="action-bar bar-top">
	
			<a href="posting5376.html?mode=reply&amp;f=3&amp;t=2518" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic62ed.html?f=3&amp;t=2518&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="https://www.dostips.com/forum/search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topic…" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="search.html" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="2518" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			29 posts
							<ul>
		<li class="active"><span>1</span></li>
				<li><a class="button" href="viewtopic667d.html?f=3&amp;t=2518&amp;start=15" role="button">2</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopic667d.html?f=3&amp;t=2518&amp;start=15" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
		</div>




<div id="subsilver-nav-topic">
	<div class="inner"><div class="post has-profile">
		<div class="leftsided postbody subsilver-topic-title">Message</div>
		<div class="leftsided postprofile subsilver-topic-author">Author</div>
	</div></div>
</div>

			<div id="p11344" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile11344">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist7125.html?mode=viewprofile&amp;u=417" class="username">jeb</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search73f1.html?author_id=417&amp;sr=posts">880</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 30 Aug 2007 08:05</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany, Bochum</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content11344">

						<h3 class="first"><a href="#p11344">Macros with parameters appended</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinga4b2.html?mode=quote&amp;f=3&amp;p=11344" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic5195.html?p=11344#p11344" onclick="prompt('Message #1',this.href); return false;">#1</a></span> 
									<a class="unread" href="viewtopic5195.html?p=11344#p11344" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist7125.html?mode=viewprofile&amp;u=417" class="username">jeb</a></strong> &raquo; </span>21 Nov 2011 05:35
			</p>
			
			
			
			<div class="content">Hi all, (especially dbenham and tooComplex/Ed)  <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /> <br /><br />sometimes someone asks for a better solution for macros with parameters.<br /><br />Currently the standard technic (from Ed) is to invoke a batch macro with parameters seems to be<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>%_forU% ( 'params' ) %@macro%</code></pre></div><br />So you need a construct with two expansions, and the parameters are in the middle.<br /><br />I would prefere something like (even I didn't use macros at all)<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>%myMacro% param1,param2<br />OR<br />%myMacro% (param1,param2)</code></pre></div><br />How to solve this might not be obviously, but it can be done.  <img class="smilies" src="images/smilies/icon_wink.gif" alt=":wink:" title="Wink" /> <br /><br />And the result isn't very complex, it's only a bit slower as it uses one extra FOR/L-Loop.<br />The main idea is this:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>FOR/L %%n in (1,1,2) DO (<br />&nbsp; if %%n==2 ( // Now we can access the parameters<br />&nbsp; &nbsp; &nbsp;// get the parameters<br />&nbsp; &nbsp; &nbsp;// run the macro<br />&nbsp; )<br />) &amp; set parameters=<br /></code></pre></div><br /><br />And here is a working sample with <span style="color: #408000">strlen</span><br />Calling it via<br /><span style="color: #408000">%$strlen% resultVar,stringVar</span><br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />cls<br />setlocal DisableDelayedExpansion<br />set LF=^<br /><br /><br />::Above 2 blank lines are required - do not remove<br />set ^&quot;\n=^^^%LF%%LF%^%LF%%LF%^^&quot;<br /><br />set argv=Empty<br />set $strLen=for /L %%n in (1 1 2) do ( %\n%<br />&nbsp; &nbsp;if %%n==2 (%\n%<br />&nbsp; &nbsp;&nbsp; &nbsp; setlocal enableDelayedExpansion%\n%<br />&nbsp; &nbsp;&nbsp; &nbsp;for /F &quot;tokens=1,2 delims=, &quot; %%1 in (&quot;!argv!&quot;) do (%\n%<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;echo par1=%%1 %\n%<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;echo par2=%%2 %\n%<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;set &quot;str=A!%%~2!&quot;%\n%<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; set &quot;len=0&quot;%\n%<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; for /l %%A in (12,-1,0) do (%\n%<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; set /a &quot;len|=1&lt;&lt;%%A&quot;%\n%<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; for %%B in (!len!) do if &quot;!str:~%%B,1!&quot;==&quot;&quot; set /a &quot;len&amp;=~1&lt;&lt;%%A&quot;%\n%<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; )%\n%<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; for %%v in (!len!) do endlocal^&amp;if &quot;%%~b&quot; neq &quot;&quot; (set &quot;%%~1=%%v&quot;) else echo %%v%\n%<br />&nbsp; &nbsp;&nbsp; &nbsp;) %\n%<br />&nbsp; &nbsp;) %\n%<br />) ^&amp; set argv=,<br /><br />set &quot;testString=this has a length of 23&quot;<br />%$strlen% result,testString<br />echo Length of testString (&quot;%testString%&quot;) is %result%</code></pre></div><br /><br />jeb</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p11357" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile11357">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content11357">

						<h3 ><a href="#p11357">Re: Macros with parameters appended</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingd081.html?mode=quote&amp;f=3&amp;p=11357" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicc941.html?p=11357#p11357" onclick="prompt('Message #2',this.href); return false;">#2</a></span> 
									<a class="unread" href="viewtopicc941.html?p=11357#p11357" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>21 Nov 2011 07:19
			</p>
			
			
			
			<div class="content"><img class="smilies" src="images/smilies/icon_eek.gif" alt=":shock:" title="Shocked" /> Awesome and Revolutionary <img class="smilies" src="images/smilies/icon_exclaim.gif" alt=":!:" title="Exclamation" /> <br /><br />Two minor inconveniences:<br /><br />1) The parameter value of argV persists after the macro completes. I don't think there is anything we can do about that.<br /><br />2) Any command added on the same line after the macro call will be executed twice<br /><br />This code with your strlen macro<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>set &quot;testString=this has a length of 23&quot;<br />%$strlen% result,testString &amp; echo Hello World %%n<br />echo Length of testString (&quot;%testString%&quot;) is %result%<br />set argv<br /></code></pre></div><br />produces:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>Hello world 1<br />par1=!argv!<br />par2=<br />Hello world 2<br />Length of testString (&quot;this has a length of 23&quot;) is<br />argv=, result,testString<br /></code></pre></div><br />Great work jeb <img class="smilies" src="images/smilies/icon_exclaim.gif" alt=":!:" title="Exclamation" /><br />I think I will be adopting this macro style.<br /><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p11359" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile11359">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberliste2cd.html?mode=viewprofile&amp;u=2453" class="username">Ed Dyreen</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search0d5e.html?author_id=2453&amp;sr=posts">1497</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 16 May 2011 08:21</dd>		
		
																<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Flanders(Belgium)</dd>
							
							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact Ed Dyreen">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact Ed Dyreen</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="http://ed-dyreen.ddns.net/" title="Website" class="last-cell">
										<span class="contact-icon phpbb_website-icon">Website</span>
									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content11359">

						<h3 ><a href="#p11359">Re: Macros with parameters appended</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingdcda.html?mode=quote&amp;f=3&amp;p=11359" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic337c.html?p=11359#p11359" onclick="prompt('Message #3',this.href); return false;">#3</a></span> 
									<a class="unread" href="viewtopic337c.html?p=11359#p11359" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberliste2cd.html?mode=viewprofile&amp;u=2453" class="username">Ed Dyreen</a></strong> &raquo; </span>21 Nov 2011 07:42
			</p>
			
			
			
			<div class="content">'<br />My god, this may prove to work pretty well actually ( you definately made dave happy ).<br /><br /> <img class="smilies" src="images/smilies/icon_mad.gif" alt=":x" title="Mad" /> <br />How am I ever going to get my library stable if things keep changing at this rate ? <strong class="text-strong">impressive !</strong><br />You know jeb, you are a freaking clever guy, luckily for clever people, there is always someone more clever than you.<br /><br />And while you're at it, how about&#058;<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>set /a $var=%StrLen% ( &quot;I wish this worked&quot; ) + %random%<br /></code></pre></div> Now that would be really impressive. <img class="smilies" src="images/smilies/icon_lol.gif" alt=":lol:" title="Laughing" /><br /><br />I have a feeling this topic is going to grow...</div>

			
													<div class="notice">
					Last edited by <a href="memberliste2cd.html?mode=viewprofile&amp;u=2453" class="username">Ed Dyreen</a> on 21 Nov 2011 08:43, edited 6 times in total.
									</div>
			
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p11362" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile11362">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist7125.html?mode=viewprofile&amp;u=417" class="username">jeb</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search73f1.html?author_id=417&amp;sr=posts">880</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 30 Aug 2007 08:05</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany, Bochum</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content11362">

						<h3 ><a href="#p11362">Re: Macros with parameters appended</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingb983.html?mode=quote&amp;f=3&amp;p=11362" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic0fff.html?p=11362#p11362" onclick="prompt('Message #4',this.href); return false;">#4</a></span> 
									<a class="unread" href="viewtopic0fff.html?p=11362#p11362" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist7125.html?mode=viewprofile&amp;u=417" class="username">jeb</a></strong> &raquo; </span>21 Nov 2011 08:13
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>dbenham wrote:</cite> <img class="smilies" src="images/smilies/icon_eek.gif" alt=":shock:" title="Shocked" /> Awesome and Revolutionary <img class="smilies" src="images/smilies/icon_exclaim.gif" alt=":!:" title="Exclamation" /> </div></blockquote><br />Thanks  <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /> <br /><br /><br /><blockquote><div><cite>dbenham wrote:</cite>Two minor inconveniences:<br /><br />1) The parameter value of argV persists after the macro completes. I don't think there is anything we can do about that.<br /><br />2) Any command added on the same line after the macro call will be executed twice</div></blockquote><br /><br />The solution for these two points is obviously  <img class="smilies" src="images/smilies/icon_wink.gif" alt=":wink:" title="Wink" /> <br /><br />- Use setlocal direct before set argv<br />- Do the set argv and the rest only if %%n==1<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />cls<br />setlocal DisableDelayedExpansion<br />set LF=^<br /><br /><br />::Above 2 blank lines are required - do not remove<br />set ^&quot;\n=^^^%LF%%LF%^%LF%%LF%^^&quot;<br /><br />set argv=original<br />set $strLen=for /L %%n in (1 1 2) do if %%n==2 (%\n%<br />&nbsp; &nbsp;&nbsp; &nbsp;for /F &quot;tokens=1,2 delims=, &quot; %%1 in (&quot;!argv!&quot;) do (%\n%<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;echo par1=%%1 %\n%<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;echo par2=%%2 %\n%<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;set &quot;str=A!%%~2!&quot;%\n%<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; set &quot;len=0&quot;%\n%<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; for /l %%A in (12,-1,0) do (%\n%<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; set /a &quot;len|=1&lt;&lt;%%A&quot;%\n%<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; for %%B in (!len!) do if &quot;!str:~%%B,1!&quot;==&quot;&quot; set /a &quot;len&amp;=~1&lt;&lt;%%A&quot;%\n%<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; )%\n%<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; for %%v in (!len!) do endlocal^&amp;if &quot;%%~b&quot; neq &quot;&quot; (set &quot;%%~1=%%v&quot;) else echo %%v%\n%<br />&nbsp; &nbsp;&nbsp; &nbsp;) %\n%<br />) ELSE setlocal enableDelayedExpansion ^&amp; set argv=,<br /><br />set &quot;testString=this has a length of 23&quot;<br />%$strlen% result,testString &amp; echo hello<br />set argv</code></pre></div><br /><br />Output<br /><blockquote class="uncited"><div>hello<br />par1=result<br />par2=testString<br />Length of testString (&quot;this has a length of 23&quot;) is 23<br />argv=original</div></blockquote><br /><br />jeb</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p11365" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile11365">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content11365">

						<h3 ><a href="#p11365">Re: Macros with parameters appended</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting3a60.html?mode=quote&amp;f=3&amp;p=11365" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic7976.html?p=11365#p11365" onclick="prompt('Message #5',this.href); return false;">#5</a></span> 
									<a class="unread" href="viewtopic7976.html?p=11365#p11365" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>21 Nov 2011 09:09
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>jeb wrote:</cite>The solution for these two points is obviously  <img class="smilies" src="images/smilies/icon_wink.gif" alt=":wink:" title="Wink" /> <br /><br />- Use setlocal direct before set argv<br />- Do the set argv and the rest only if %%n==1<br /></div></blockquote><br />Ding Ding Ding Ding Ding Ding Ding<br />WoooHooooo - Jackpot <img class="smilies" src="images/smilies/icon_exclaim.gif" alt=":!:" title="Exclamation" /> <br /><br />I am definitely adopting jeb's new macro style now <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /> <br /><br />I will probably define a few helper macros:<br /><br /><strong class="text-strong">macro_begin </strong>to encapsulate the 1st two lines<br /><br /><strong class="text-strong">macro_end</strong> to define the final ELSE construct under normal circumstances<br /><br /><strong class="text-strong">macro_endSafe</strong> to define the final ELSE construct with some additional stuff to prepare for the safe return technique<br /><br />Thanks again jeb<br /><br />Addendum - I just realized the solution is not quite perfect  <img class="smilies" src="images/smilies/icon_neutral.gif" alt=":|" title="Neutral" /> <br /><br />Any command appended to the end of the line actually executes before the macro. This might throw off some people . . .<br />. . . but the technique is still awesome  <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /> <br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p11366" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile11366">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberliste2cd.html?mode=viewprofile&amp;u=2453" class="username">Ed Dyreen</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search0d5e.html?author_id=2453&amp;sr=posts">1497</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 16 May 2011 08:21</dd>		
		
																<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Flanders(Belgium)</dd>
							
							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact Ed Dyreen">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact Ed Dyreen</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="http://ed-dyreen.ddns.net/" title="Website" class="last-cell">
										<span class="contact-icon phpbb_website-icon">Website</span>
									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content11366">

						<h3 ><a href="#p11366">Re: Macros with parameters appended</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting72c3.html?mode=quote&amp;f=3&amp;p=11366" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicf3e5.html?p=11366#p11366" onclick="prompt('Message #6',this.href); return false;">#6</a></span> 
									<a class="unread" href="viewtopicf3e5.html?p=11366#p11366" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberliste2cd.html?mode=viewprofile&amp;u=2453" class="username">Ed Dyreen</a></strong> &raquo; </span>21 Nov 2011 09:31
			</p>
			
			
			
			<div class="content">'<br /><blockquote><div><cite>dbenham wrote:</cite>Any command appended to the end of the line actually executes before the macro. This might throw off some people . . .<br /></div></blockquote>but Dave, doesn't this solves that <img class="smilies" src="images/smilies/icon_confused.gif" alt=":?" title="Confused" /> <br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>set $strLen=for /L %%n in (1 1 2) do if %%n==2 (%\n%<br />&nbsp; &nbsp; &nbsp; endlocal ^&amp;cmd /c exit 0 %\n%<br />) ELSE setlocal enableDelayedExpansion ^&amp; set argv=,<br /></code></pre></div><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>( %$strlen% result,testString ) &amp;&amp;echo.succes ||echo.failed</code></pre></div>Ok guys, I'm in <em class="text-italics">jeb rocks</em> <img class="smilies" src="images/smilies/icon_cool.gif" alt="8)" title="Cool" /></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p11367" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile11367">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content11367">

						<h3 ><a href="#p11367">Re: Macros with parameters appended</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingb448.html?mode=quote&amp;f=3&amp;p=11367" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic96ca.html?p=11367#p11367" onclick="prompt('Message #7',this.href); return false;">#7</a></span> 
									<a class="unread" href="viewtopic96ca.html?p=11367#p11367" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>21 Nov 2011 10:01
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>Ed Dyreen wrote:</cite><blockquote><div><cite>dbenham wrote:</cite>Any command appended to the end of the line actually executes before the macro. This might throw off some people . . .<br /></div></blockquote>but Dave, doesn't this solves that <img class="smilies" src="images/smilies/icon_confused.gif" alt=":?" title="Confused" /> <br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>set $strLen=for /L %%n in (1 1 2) do if %%n==2 (%\n%<br />&nbsp; &nbsp; &nbsp; endlocal ^&amp;cmd /c exit 0 %\n%<br />) ELSE setlocal enableDelayedExpansion ^&amp; set argv=,<br /></code></pre></div></div></blockquote><br />I don't understand your logic, or where you are going with this.<br /><br />Please provide a complete but small working example that demonstrates that when executing<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>%strlen% &quot;my string&quot; &amp; echo hello<br /></code></pre></div>ECHO HELLO executes after the strlen is computed. I don't see how this can be done.<br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p11368" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile11368">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberliste2cd.html?mode=viewprofile&amp;u=2453" class="username">Ed Dyreen</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search0d5e.html?author_id=2453&amp;sr=posts">1497</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 16 May 2011 08:21</dd>		
		
																<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Flanders(Belgium)</dd>
							
							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact Ed Dyreen">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact Ed Dyreen</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="http://ed-dyreen.ddns.net/" title="Website" class="last-cell">
										<span class="contact-icon phpbb_website-icon">Website</span>
									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content11368">

						<h3 ><a href="#p11368">Re: Macros with parameters appended</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinge8f1.html?mode=quote&amp;f=3&amp;p=11368" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic6ab8.html?p=11368#p11368" onclick="prompt('Message #8',this.href); return false;">#8</a></span> 
									<a class="unread" href="viewtopic6ab8.html?p=11368#p11368" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberliste2cd.html?mode=viewprofile&amp;u=2453" class="username">Ed Dyreen</a></strong> &raquo; </span>21 Nov 2011 10:10
			</p>
			
			
			
			<div class="content">'<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br /><br />set $strLen=for /L %%n in (1 1 2) do if %%n==2 ( echo.instrlen ^!argv^! ^&amp;endlocal ^&amp;cmd /c exit 0 ) ELSE setlocal enableDelayedExpansion ^&amp; set argv=,<br /><br />( %$strlen% result,testString ) &amp;&amp;echo.succes ||echo.failed<br /><br />pause<br />exit<br /></code></pre></div><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>instrlen , result,testString<br />succes<br />Druk op een toets om door te gaan. . .<br /></code></pre></div>You'll have to enclose in brackets <img class="smilies" src="images/smilies/icon_neutral.gif" alt=":|" title="Neutral" /></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p11369" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile11369">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content11369">

						<h3 ><a href="#p11369">Re: Macros with parameters appended</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting5546.html?mode=quote&amp;f=3&amp;p=11369" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic6d3c.html?p=11369#p11369" onclick="prompt('Message #9',this.href); return false;">#9</a></span> 
									<a class="unread" href="viewtopic6d3c.html?p=11369#p11369" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>21 Nov 2011 10:23
			</p>
			
			
			
			<div class="content">Of course - I see how it works now. Thanks.<br /><br />But some one could still do it without brackets and be confused with the results. It's not a big deal, just something to look out for.<br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p11374" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile11374">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search661c.html?author_id=1265&amp;sr=posts">3386</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 22 Jan 2010 18:01</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content11374">

						<h3 ><a href="#p11374">Re: Macros with parameters appended</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinge962.html?mode=quote&amp;f=3&amp;p=11374" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic447f.html?p=11374#p11374" onclick="prompt('Message #10',this.href); return false;">#10</a></span> 
									<a class="unread" href="viewtopic447f.html?p=11374#p11374" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a></strong> &raquo; </span>21 Nov 2011 16:03
			</p>
			
			
			
			<div class="content">That's amazing!<br />I don't understand the behaviour that <em class="text-italics">^&amp; set argv=,</em> is able to catch the argument but, however, it works just fine.<br />That's indeed a trigger to commence working with macros. Thanks to each of you three.<br /><br />Regards<br />aGerman (still impressed ...)</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p11377" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile11377">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content11377">

						<h3 ><a href="#p11377">Re: Macros with parameters appended</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting218e.html?mode=quote&amp;f=3&amp;p=11377" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic724b.html?p=11377#p11377" onclick="prompt('Message #11',this.href); return false;">#11</a></span> 
									<a class="unread" href="viewtopic724b.html?p=11377#p11377" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>21 Nov 2011 16:25
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>aGerman wrote:</cite>I don't understand the behaviour that <em class="text-italics">^&amp; set argv=,</em> is able to catch the argument</div></blockquote><br />At first I was confused as well. But it is really quite simple, once you see it. It helps to see everything on one line:<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>set macro=for /l %%n in (1 1 2) do if %%n==2 (MACRO BUSINESS) else setlocal enableDelayedExpansion ^&amp; set argv=,<br /><br />%macro% arg1 arg2<br /><br />:: the call expands to <br />:: for /l %%n in (1 1 2) do if %%n==2 (MACRO BUSINESS) else setlocal enableDelayedExpansion &amp; set argv=, arg1 arg2<br /></code></pre></div><br />Really simple, yet clever  <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /><br /><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p11378" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile11378">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search661c.html?author_id=1265&amp;sr=posts">3386</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 22 Jan 2010 18:01</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content11378">

						<h3 ><a href="#p11378">Re: Macros with parameters appended</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting94db.html?mode=quote&amp;f=3&amp;p=11378" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicd571.html?p=11378#p11378" onclick="prompt('Message #12',this.href); return false;">#12</a></span> 
									<a class="unread" href="viewtopicd571.html?p=11378#p11378" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a></strong> &raquo; </span>21 Nov 2011 16:37
			</p>
			
			
			
			<div class="content">Now it dawns me <img class="smilies" src="images/smilies/icon_idea.gif" alt=":idea:" title="Idea" /> <br />Thanks Dave <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /> <br /><br />Regards<br />aGerman</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p12045" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile12045">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchdc63.html?author_id=2923&amp;sr=posts">1540</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 06 Dec 2011 22:15</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> México City, México</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content12045">

						<h3 ><a href="#p12045">Re: Macros with parameters appended</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting9372.html?mode=quote&amp;f=3&amp;p=12045" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic7110.html?p=12045#p12045" onclick="prompt('Message #13',this.href); return false;">#13</a></span> 
									<a class="unread" href="viewtopic7110.html?p=12045#p12045" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a></strong> &raquo; </span>12 Dec 2011 05:19
			</p>
			
			
			
			<div class="content">jeb: First of all, I want to offer you a <strong class="text-strong">VERY BIG CONGRATULATION</strong> <img class="smilies" src="images/smilies/icon_exclaim.gif" alt=":!:" title="Exclamation" />  for all of your ideas, specially this one.  <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" />  <img class="smilies" src="images/smilies/icon_razz.gif" alt=":P" title="Razz" /> <br /><br />That said, this is a small observation:<br /><br />WHY YOU DIDN'T EXPLAIN YOUR METHODS? I worked for over 25 years explaining computer themes to other people. I used to write larger and clearer explanations as the themes becomes harder. I hate the <strong class="text-strong">&quot;use this as it is, but don't try to understand it&quot;</strong> approach in new methods, because it prevents the new method be understood by other people and hence be modified and used for other purposes.<br /><br />Below is my own explanation on this topic and a small additional contribution.<br /><br />Suppose you have a macro-function that is usually executed this way:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>for /F &quot;tokens=1-26&quot; %%a in (&quot;param1 param2 resultvar&quot;) do %macroFunc%</code></pre></div><br />How we may execute the macro in the following way?<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>%macroFuncWithParams% param1 param2 resultvar</code></pre></div><br />Parameters placed after the macro needs to be taken and moved inside the FOR parentheses; this may be achieved by a two-step process:<br /><br />1- Get the parameters<br />2- Execute the macro with them<br /><br />That is, the macro must be executed two times: in the first step the parameters will be stored in an (argv) variable, and in the second step the macro will be really executed:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>for %%s in (get_params exec_macro) do (<br />&nbsp; &nbsp;if %%s == get_params (<br />&nbsp; &nbsp; &nbsp; set argv=&lt;rest of the line placed after the macro&gt;<br />&nbsp; &nbsp;) else ( rem %%s == exec_macro<br />&nbsp; &nbsp; &nbsp; for /F &quot;tokens=1-26&quot; %%a in (!argv!) do %macroFunc%<br />&nbsp; &nbsp;)<br />)<br /></code></pre></div><br />However, the &lt;rest of the line&gt; is <em class="text-italics">physically</em> placed after the macro. This means that <strong class="text-strong">set argv=</strong> command must be the <em class="text-italics">last</em> part of the macro definition:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>for %%s in (1 2) do (<br />&nbsp; &nbsp;if %%s == 2 (<br />&nbsp; &nbsp; &nbsp; for /f &quot;tokens=1-26&quot; %%a in (!argv!) do %macroFunc%<br />&nbsp; &nbsp;) else (<br />&nbsp; &nbsp; &nbsp; set argv=&lt;rest of the line...&gt;<br />&nbsp; &nbsp;)<br />)<br /></code></pre></div><br />There are still two parentheses after <strong class="text-strong">set argv=</strong>, but we can simply eliminate they because the FOR and ELSE part parentheses are placed here just for legibility:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>for %%n in (1 2) do if %%n == 2 (<br />&nbsp; &nbsp; &nbsp; for /f &quot;tokens=1-26&quot; %%a in (!argv!) do %macroFunc%<br />&nbsp; &nbsp;) else set argv=<br /></code></pre></div><br />This way, although the parts seems to be upside down, they execute in the right order. Note that we could place another command after ELSE separated by &amp; and it also would belong to ELSE part, although there are not parentheses here. This point makes possible to include a SETLOCAL before the <strong class="text-strong">set argv=</strong> to avoid undesired modification of a variable with same name in the caller program, and to assure that delayed expansion is enabled when !argv! is processed:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>for %%n in (1 2) do if %%n == 2 (<br />&nbsp; &nbsp; &nbsp; for /f &quot;tokens=1-26&quot; %%a in (!argv!) do %macroFunc%<br />&nbsp; &nbsp; &nbsp; endlocal<br />&nbsp; &nbsp;) else setlocal EnableDelayedExpansion &amp; set argv=<br /></code></pre></div><br />However, because this method use textual substitution of whichever text placed after the macro, if another &amp; COMMAND is placed after macro params, then that command also belongs to ELSE part and will also be executed <em class="text-italics">before</em> the macro, that is an unexpected behavior. The only way to avoid this effect is isolating the macro and parameters from the rest of the line by enclosing they in parentheses.<br /><br /><br /><br /><strong class="text-strong">Second part:</strong> An additional contribution.<br /><br />When we define a macroFuncWithParams variable with this format, we may duplicate the original macroFunc code in the macro execution part, taking the parameters from argv variable (as in jeb example above); or we may use the original macroFunc code over argv variable in a nested macro invocation:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>for /F &quot;tokens=1-26&quot; %%a in (&quot;!argv!&quot;) do %nestedMacroFunc%</code></pre></div><br />This last case would be useful if we want to define a <strong class="text-strong">generic</strong> macro that could call any other macro-function in a standard way. For example, suppose now that we want to execute our original macro this way:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>%let% resultVar=macroFunc(param1,param2)</code></pre></div><br />How we can do that? Via a slightly different rearrangment of the macro parameters:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>for %%n in (1 2) do if %%n == 2 (<br />&nbsp; &nbsp; &nbsp; for /F &quot;tokens=1-4 delims==(,) &quot; %%1 in (&quot;!argv!&quot;) do (<br />&nbsp; &nbsp; &nbsp; set macroFunc=%%1<br />&nbsp; &nbsp; &nbsp; set param1=%%2<br />&nbsp; &nbsp; &nbsp; set param2=%%3<br />&nbsp; &nbsp; &nbsp; set resultVar=%%4<br />&nbsp; &nbsp; &nbsp; for /F &quot;tokens=1-26&quot; %%a in (&quot;!param1! !param2! resultValue&quot;) do %%macroFunc%%<br />&nbsp; &nbsp; &nbsp; for %%v in (!resultValue!) do endlocal &amp; set &quot;!resultVar!=%%v&quot;<br />&nbsp; &nbsp;) else setlocal EnableDelayedExpansion &amp; set argv=<br /></code></pre></div><br />We have, however, a big problem at this point. <em class="text-italics">There is no way to directly execute a nested macro inside another one</em>. We may left this problem apart for a while and test now that the method above is correct by executing a subroutine instead of a macro:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />cls<br />setlocal DisableDelayedExpansion<br />set LF=^<br /><br /><br /><br />::Above 2 blank lines are required - do not remove<br />set ^&quot;\n=^^^%LF%%LF%^%LF%%LF%^^&quot;<br /><br /><br />set strLen=(%\n%<br />&nbsp; &nbsp;setlocal enableDelayedExpansion%\n%<br />&nbsp; &nbsp;set &quot;str=A!%%~b!&quot;%\n%<br />&nbsp; &nbsp;set &quot;len=0&quot;%\n%<br />&nbsp; &nbsp;for /l %%A in (12,-1,0) do (%\n%<br />&nbsp; &nbsp; &nbsp; set /a &quot;len|=1&lt;&lt;%%A&quot;%\n%<br />&nbsp; &nbsp; &nbsp; for %%B in (!len!) do if &quot;!str:~%%B,1!&quot;==&quot;&quot; set /a &quot;len&amp;=~1&lt;&lt;%%A&quot;%\n%<br />&nbsp; &nbsp;)%\n%<br />&nbsp; &nbsp;for %%v in (!len!) do endlocal^&amp;if &quot;%%~a&quot; neq &quot;&quot; (set &quot;%%~a=%%v&quot;) else echo %%v%\n%<br />)<br /><br /><br />set let=for %%n in (1 2) do if %%n==2 (%\n%<br />&nbsp; &nbsp; &nbsp; for /F &quot;tokens=1-4 delims==(,) &quot; %%1 in (&quot;!argv!&quot;) do (%\n%<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;echo -------------------------- %\n%<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set macroFunc=%%1%\n%<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;echo macroFunc=!macroFunc! %\n%<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set param1=%%2%\n%<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;echo param1=!param1! %\n%<br />REM&nbsp; &nbsp; &nbsp; set param2=%%3%\n%<br />REM&nbsp; &nbsp; &nbsp; echo param2=!param2! %\n%<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set resultVar=%%3%\n%<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;echo resultVar=!resultvar! %\n%<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;call !macroFunc! !param1! !param2! resultValue%\n%<br />REM&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for /F &quot;tokens=1-26&quot; %%a in (&quot;!param1! !param2! resultValue&quot;) do (%\n%<br />REM&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;nested call %%%%macroFunc%%%% %\n%<br />REM&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;)%\n%<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for %%v in (!resultValue!) do endlocal^&amp;set &quot;%%1=%%v&quot;%\n%<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;echo -------------------------- %\n%<br />&nbsp; &nbsp; &nbsp; )%\n%<br />&nbsp; &nbsp;) else setlocal enableDelayedExpansion ^&amp; set argv=<br /><br /><br />set &quot;testString=this has a length of 23&quot;<br />echo Test string is (&quot;%testString%&quot;)<br />echo/<br /><br />echo Original (FOR /F ...) strLen macro invocation:<br />for /F &quot;tokens=1-26&quot; %%a in (&quot;testString forResult&quot;) do %strLen%<br />echo Original FOR macro invocation result is %forResult%<br />echo/<br /><br />echo Original &quot;CALL :strLen testString subResult&quot; subroutine invocation:<br />call :strLen testString subResult=<br />echo Original CALL subroutine invocation result is %subResult%<br />echo/<br /><br />echo %%Let%% letResult=:strLen(testString) invocation:<br />%let% letResult=:strLen(testString)<br />echo LET letResult=strLen(testString) result is %letResult%<br /><br />goto :EOF<br /><br /><br />:strLen string resultVar=<br />setlocal enableDelayedExpansion<br />set &quot;str=0!%~1!&quot;<br />set &quot;len=0&quot;<br />for /l %%A in (12,-1,0) do (<br />&nbsp; &nbsp;set /a &quot;len|=1&lt;&lt;%%A&quot;<br />&nbsp; &nbsp;for %%B in (!len!) do if &quot;!str:~%%B,1!&quot;==&quot;&quot; set /a &quot;len&amp;=~1&lt;&lt;%%A&quot;<br />)<br />for %%v in (!len!) do endlocal&amp;if &quot;%~2&quot; neq &quot;&quot; (set &quot;%~2=%%v&quot;) else echo %%v<br />exit /B<br /></code></pre></div><br />The result:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>Test string is (&quot;this has a length of 23&quot;)<br /><br />Original (FOR /F ...) strLen macro invocation:<br />Original FOR macro invocation result is 23<br /><br />Original &quot;CALL :strLen testString subResult&quot; subroutine invocation:<br />Original CALL subroutine invocation result is 23<br /><br />%Let% letResult=:strLen(testString) invocation:<br />--------------------------<br />macroFunc=:strLen<br />param1=testString<br />resultVar=letResult<br />--------------------------<br />LET letResult=strLen(testString) result is 23<br /></code></pre></div><br />In previous example we achieved to get a macro that allows to execute any function in a very standard way at expense of a somewhat slower execution because the additional CALL. But we will not stop at this point, right? So we try to solve now the nested macro problem. The only way to execute a nested macro is by embeding it inside the caller one so when the original macro is expanded for execution, it already contains the code of the nested one. This may be achieved by splitting the original macro in two parts: a Head, from the beginning up to the invocation of the nested macro, and a Tail, from the return of the nested invocation up to the end. This way, we can assemble the final macro by joining the Head, the nested macro, and the Tail this way:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>set completeLet=!letHead!!macroFunc!!letTail!</code></pre></div><br />After that, the execution of both the LET macro and the nested macro-function is immediate:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>%completeLet%</code></pre></div><br /><br /><strong class="text-strong">EDIT: Continue at this matter.</strong><br /><br />However, there is no way to include/embed a macro into another one <em class="text-italics">at execution time</em>, so previous method imply to create a different macro for each combination of LET plus the particular macro-function, that is not the desired solution. This method may still be used to execute any subroutine-function in a clearer way and there is another instance where this solution may be useful: to get the value of an array element when the subscript vary inside a FOR loop (and it is not the FOR variable). This task may be achieved via a macro called ASET (array set) with this format: <strong class="text-strong">%aset% element=array[subscript]</strong><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>set aset=for %%n in (1 2) do if %%n==2 (%\n%<br />&nbsp; &nbsp; &nbsp; for /F &quot;tokens=1-3 delims==&#91;&#93; &quot; %%1 in (&quot;!argv!&quot;) do (%\n%<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;endlocal^&amp;set &quot;%%1=!%%2&#91;%%3&#93;!&quot;%\n%<br />&nbsp; &nbsp; &nbsp; )%\n%<br />&nbsp; &nbsp;) else setlocal enableDelayedExpansion^&amp;set argv=<br /></code></pre></div><br />For example, in <a href="http://stackoverflow.com/questions/8520313/dos-batch-script-to-parse-csv-file-and-output-a-text-file" class="postlink">this SO question</a> I posted this program segment:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>set i=0<br />set j=1<br />for %%e in (%line%) do (<br />&nbsp; &nbsp;set /A i+=1<br />&nbsp; &nbsp;for %%j in (!j!) do set target=!target&#91;%%j&#93;!<br />&nbsp; &nbsp;if !i! == !target! (<br />&nbsp; &nbsp; &nbsp; for %%i in (!i!) do set heading=!heading&#91;%%i&#93;!<br />&nbsp; &nbsp; &nbsp; echo !heading!%%~e<br />&nbsp; &nbsp; &nbsp; set /A j+=1<br />&nbsp; &nbsp;)<br />)<br /></code></pre></div><br />Using ASET macro, the segment may be rewritten in this clearer way:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>set i=0<br />set j=1<br />for %%e in (%line%) do (<br />&nbsp; &nbsp;set /A i+=1<br />&nbsp; &nbsp;%aset% target=target&#91;!j!&#93;<br />&nbsp; &nbsp;if !i! == !target! (<br />&nbsp; &nbsp; &nbsp; %aset% heading=heading&#91;!i!&#93;<br />&nbsp; &nbsp; &nbsp; echo !heading!%%~e<br />&nbsp; &nbsp; &nbsp; set /A j+=1<br />&nbsp; &nbsp;)<br />)<br /></code></pre></div><br />Antonio<br /><br />PS - I modified previous description to include a missing detail that jeb noted in a posterior post.<br /><br />Note: <strong class="text-strong">for %%n in (1 2)</strong> execute faster than <strong class="text-strong">for /L %%n in (1,1,2)</strong>.<br /><br />Note: In my opinion, there must be a standard in macro names that allows to know if a macro is used in the conventional <strong class="text-strong">for /F ...</strong> way instead of with parameters (to avoid confusions).<br /><br />Note: I strongly encourage all of you, people, to adopt the standard of using %%1 %%2...%%9 to take macro parameters in macro definitions (and FOR /F &quot;tokens=1-9 delims=,;= &quot; %%1 invocation) instead of using %%a %%b...%%z (and FOR /F &quot;tokens=1-26&quot; %%a invocation) for several practical reasons, some of which are explained in my second post at<br /><a href="viewtopic2df5.html?t=1827&amp;start=60" class="postlink">this topic</a>.</div>

			
													<div class="notice">
					Last edited by <a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a> on 27 Dec 2011 00:43, edited 3 times in total.
									</div>
			
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p12048" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile12048">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist7125.html?mode=viewprofile&amp;u=417" class="username">jeb</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search73f1.html?author_id=417&amp;sr=posts">880</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 30 Aug 2007 08:05</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany, Bochum</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content12048">

						<h3 ><a href="#p12048">Re: Macros with parameters appended</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting16e8.html?mode=quote&amp;f=3&amp;p=12048" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicfa17.html?p=12048#p12048" onclick="prompt('Message #14',this.href); return false;">#14</a></span> 
									<a class="unread" href="viewtopicfa17.html?p=12048#p12048" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist7125.html?mode=viewprofile&amp;u=417" class="username">jeb</a></strong> &raquo; </span>12 Dec 2011 06:26
			</p>
			
			
			
			<div class="content">Welcome Aacini to the expert discussions <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /> <br /><br /><blockquote><div><cite>Aacini wrote:</cite>jeb: First of all, I want to offer you a VERY BIG CONGRATULATION <img class="smilies" src="images/smilies/icon_exclaim.gif" alt=":!:" title="Exclamation" /> for all of your ideas, specially this one. <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /> <img class="smilies" src="images/smilies/icon_razz.gif" alt=":P" title="Razz" /> </div></blockquote>Thanks <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" />  <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /> <br /><br /><blockquote><div><cite>Aacini wrote:</cite>WHY YOU DIDN'T EXPLAIN YOUR METHODS?</div></blockquote>They are obvious and self-explanatory <img class="smilies" src="images/smilies/icon_exclaim.gif" alt=":!:" title="Exclamation" /> <br /><br />Ok, perhaps not complete obvious <img class="smilies" src="images/smilies/icon_wink.gif" alt=":wink:" title="Wink" /> , but I wrote this especially for Dave and Ed, as only expert should/could build these types of macros.<br /><br /><blockquote><div><cite>Aacini wrote:</cite>I hate the &quot;use this as it is, but don't try to understand it&quot; approach in new methods, because it prevents the new method be understood by other people and hence be modified and used for other purposes.</div></blockquote>I love good questions, and thanks for your explanation, so I don't have to do it.<br /><br /><blockquote><div><cite>Aacini wrote:</cite>Because this trick use textual substitution of whichever text placed after the macro, if another &amp; COMMAND is placed after macro params, that command will also be carried into the for body and hence also executed 2 times:<br />[...]<br />The only way to avoid this effect is isolating the macro and parameters from the rest of the line by enclosing they in parentheses, as Ed indicated.</div></blockquote>Did I said that I love to disprove such declarations <img class="smilies" src="images/smilies/icon_question.gif" alt=":?:" title="Question" />  <img class="smilies" src="images/smilies/icon_cool.gif" alt="8)" title="Cool" /> <br /><br />I simply forgot to post the solution for this<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>set $SomeMacro=for /L %%n in (1 1 2) do if %%n==2 (%\n%<br />&nbsp; &nbsp;&nbsp; &nbsp;rem *** MACRO Content<br />&nbsp; &nbsp;&nbsp; &nbsp;for /f &quot;delims=&quot; %%r in (&quot;!result!&quot;) do endlocal^&amp; set &quot;%%~3=%%~r&quot; %\n%<br />&nbsp; &nbsp;) %\n%<br />) ELSE setlocal enableDelayedExpansion ^&amp; echo ProofOfconcept is showed only once %%n ^&amp; set argv=,<br /></code></pre></div><br />In this case it is really obvious, isn't it?<br /><br />jeb</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p12050" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile12050">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberliste2cd.html?mode=viewprofile&amp;u=2453" class="username">Ed Dyreen</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search0d5e.html?author_id=2453&amp;sr=posts">1497</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 16 May 2011 08:21</dd>		
		
																<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Flanders(Belgium)</dd>
							
							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact Ed Dyreen">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact Ed Dyreen</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="http://ed-dyreen.ddns.net/" title="Website" class="last-cell">
										<span class="contact-icon phpbb_website-icon">Website</span>
									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content12050">

						<h3 ><a href="#p12050">Re: Macros with parameters appended</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingfbf6.html?mode=quote&amp;f=3&amp;p=12050" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicf9eb.html?p=12050#p12050" onclick="prompt('Message #15',this.href); return false;">#15</a></span> 
									<a class="unread" href="viewtopicf9eb.html?p=12050#p12050" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberliste2cd.html?mode=viewprofile&amp;u=2453" class="username">Ed Dyreen</a></strong> &raquo; </span>12 Dec 2011 07:37
			</p>
			
			
			
			<div class="content">'<br />Very obvious as usual <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /> , I see , <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /> . <br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br /><br />set $lf=^<br /><br /><br />::<br /><br />set ^&quot;\n=^^^%$lf%%$lf%^%$lf%%$lf%^^&quot;<br /><br />set $SomeMacro=for /L %%n in (1 1 2) do if %%n==2 (%\n%<br />&nbsp; &nbsp; &nbsp; set argv%\n%<br />&nbsp; &nbsp; &nbsp; for /f &quot;delims=&quot; %%r in (&quot;!argv!&quot;) do endlocal^&amp; echo.set &quot;%%~3=%%~r&quot; %\n%<br />&nbsp; &nbsp;) %\n%<br />) ELSE setlocal enableDelayedExpansion ^&amp; echo ProofOfconcept is showed only once %%n ^&amp; set argv=,<br /><br /><br />%$SomeMacro% yesyes<br /><br />pause<br />exit<br /></code></pre></div><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>Omgevingsvariabele argv is niet gedefinieerd<br />set &quot;%~3=!argv!&quot;<br />Druk op een toets om door te gaan. . .<br /></code></pre></div></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
	

	<div class="action-bar bar-bottom">
	
			<a href="posting5376.html?mode=reply&amp;f=3&amp;t=2518" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic62ed.html?f=3&amp;t=2518&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

			<form method="post" action="https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=2518">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			29 posts
							<ul>
		<li class="active"><span>1</span></li>
				<li><a class="button" href="viewtopic667d.html?f=3&amp;t=2518&amp;start=15" role="button">2</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopic667d.html?f=3&amp;t=2518&amp;start=15" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="viewforum4d6b.html?f=3" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to “DOS Batch Forum”</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="viewforum31e6.html?f=4" class="jumpbox-cat-link"> <span> DosTips - Dos Batch</span></a></li>
																<li><a href="viewforum4d6b.html?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; DOS Batch Forum</span></a></li>
											</ul>
		</div>
	</div>

	</div>


			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
							<span class="crumb"><a href="../index.html" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>DosTips.com</span></a></span>									<span class="crumb"><a href="index.html" data-navbar-reference="index"><span>Board index</span></a></span>					</li>
		
				<li class="rightside">All times are <span title="UTC-6">UTC-06:00</span></li>
							<li class="rightside">
				<a href="ucp033a.html?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete all board cookies</span>
				</a>
			</li>
												<li class="rightside" data-last-responsive="true">
				<a href="memberlist4bfd.html?mode=team" role="menuitem">
					<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
				</a>
			</li>
									<li class="rightside" data-last-responsive="true">
				<a href="memberlist8733.html?mode=contactadmin" role="menuitem">
					<i class="icon fa-envelope fa-fw" aria-hidden="true"></i><span>Contact us</span>
				</a>
			</li>
			</ul>

	</div>
</div>

	<div class="copyright">
				<!-- WARNING NO DELETE -->Style developer by <a href="http://tricolor.x-tk.ru/">support forum tricolor</a>, <!-- END WARNING NO DELETE -->Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
									</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	<img src="cron5897.gif?cron_type=cron.task.text_reparser.poll_option" width="1" height="1" alt="cron" /></div>

<script type="text/javascript" src="assets/javascript/jquery.mind772.js?assets_version=34"></script>
<script type="text/javascript" src="assets/javascript/cored772.js?assets_version=34"></script>



<script type="text/javascript" src="styles/prosilver/template/forum_fnd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/prosilver/template/ajaxd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/jquery-uid772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/collapsed772.js?assets_version=34"></script>



</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?p=11365 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 06:43:37 GMT -->
</html>
