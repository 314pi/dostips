<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=5566 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 07:20:34 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>MD5 Message-Digest Algorithm - DosTips.com</title>


	<link rel="canonical" href="viewtopicbd81.html?t=5566">

<!--
	phpBB style name: Allan Style - SUBSILVER
	Based on style:   prosilver (this is the default phpBB3 style)
	Based on style:   subsilver2 (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:  Allan ( http://x-tk.ru/ )
-->

<link href="assets/css/font-awesome.mind772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/stylesheetd772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/en/stylesheetd772.css?assets_version=34" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="./styles/AllanStyle-SUBSILVER/theme/tweaks.css?assets_version=34" rel="stylesheet">
<![endif]-->




<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','../../www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-280191-1', 'auto');
	ga('send', 'pageview');
</script>

</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">

<div id="header-subsilver">
	<a id="top" class="top-anchor" accesskey="t"></a>
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description" class="site-description">
				<a id="logo" class="logo" href="../index.html" title="DosTips.com"><span class="site_logo"></span></a>
				<h1>DosTips.com</h1>
				<p>A Forum all about DOS Batch</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

									<div id="search-box" class="search-box search-header" role="search">
				<form action="https://www.dostips.com/forum/search.php" method="get" id="search">
				<fieldset>
					<input name="keywords" id="keywords" type="search" maxlength="128" title="Search for keywords" class="inputbox search tiny" size="20" value="" placeholder="Search…" />
					<button class="button button-search" type="submit" title="Search">
						<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
					</button>
					<a href="search.html" class="button button-search-end" title="Advanced search">
						<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
					</a>
					
				</fieldset>
				</form>
			</div>
						
			</div>
					</div>
</div>


<div id="wrap" class="wrap">
	<div id="page-header">
				<div class="navbar-top" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
																									<li>
								<a href="search33a7.html?search_id=unanswered" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="search526f.html?search_id=active_topics" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-blue" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="search.html" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
											<li class="separator"></li>
																			<li>
								<a href="memberlist4bfd.html?mode=team" role="menuitem">
									<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
								</a>
							</li>
																<li class="separator"></li>

									</ul>
			</div>
		</li>

				<li data-skip-responsive="true">
			<a href="app.php/help/faq.html" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
						
			<li class="rightside"  data-skip-responsive="true">
			<a href="ucp26c3.html?mode=login" title="Login" accesskey="x" role="menuitem">
				<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Login</span>
			</a>
		</li>
					<li class="rightside" data-skip-responsive="true">
				<a href="ucp8319.html?mode=register" role="menuitem">
					<i class="icon fa-pencil-square-o  fa-fw" aria-hidden="true"></i><span>Register</span>
				</a>
			</li>
						</ul>

	</div>
</div>

<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
						<li class="breadcrumbs">
							<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="../index.html" itemprop="url" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span itemprop="title">DosTips.com</span></a></span>
										<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="index.html" itemprop="url" accesskey="h" data-navbar-reference="index"><span itemprop="title">Board index</span></a></span>

											<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="4"><a href="viewforum31e6.html?f=4" itemprop="url"><span itemprop="title">DosTips - Dos Batch</span></a></span>
															<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="3"><a href="viewforum4d6b.html?f=3" itemprop="url"><span itemprop="title">DOS Batch Forum</span></a></span>
												</li>
		
					<li class="rightside responsive-search">
				<a href="search.html" title="View the advanced search options" role="menuitem">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</a>
			</li>
			</ul>

	</div>
</div>

<div class="navbar-top-link">
	<div class="inner">
		<ul>
			<li class="navbar-top-link-left"><a href="search33a7.html?search_id=unanswered">Unanswered topics</a></li>
			<li class="navbar-top-link-left"><a href="search526f.html?search_id=active_topics">Active topics</a></li>

											</ul>
	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
		
<h2 class="topic-title"><a href="viewtopicdc2e.html?f=3&amp;t=5566">MD5 Message-Digest Algorithm</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">Discussion forum for all Windows batch related topics.<br /></div>
<p>
	<strong>Moderator:</strong> <a href="memberlista6a8.html?mode=viewprofile&amp;u=5" class="username">DosItHelp</a>
</p>


<div class="action-bar bar-top">
	
			<a href="postinge619.html?mode=reply&amp;f=3&amp;t=5566" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopicb285.html?f=3&amp;t=5566&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="https://www.dostips.com/forum/search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topic…" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="search.html" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="5566" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			22 posts
							<ul>
		<li class="active"><span>1</span></li>
				<li><a class="button" href="viewtopic932f.html?f=3&amp;t=5566&amp;start=15" role="button">2</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopic932f.html?f=3&amp;t=5566&amp;start=15" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
		</div>




<div id="subsilver-nav-topic">
	<div class="inner"><div class="post has-profile">
		<div class="leftsided postbody subsilver-topic-title">Message</div>
		<div class="leftsided postprofile subsilver-topic-author">Author</div>
	</div></div>
</div>

			<div id="p34174" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile34174">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistc2fd.html?mode=viewprofile&amp;u=4985" class="username">Magialisk</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search6f26.html?author_id=4985&amp;sr=posts">104</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 25 Jul 2013 19:00</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content34174">

						<h3 class="first"><a href="#p34174">MD5 Message-Digest Algorithm</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting771e.html?mode=quote&amp;f=3&amp;p=34174" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicfdde.html?p=34174#p34174" onclick="prompt('Message #1',this.href); return false;">#1</a></span> 
									<a class="unread" href="viewtopicfdde.html?p=34174#p34174" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistc2fd.html?mode=viewprofile&amp;u=4985" class="username">Magialisk</a></strong> &raquo; </span>02 May 2014 22:58
			</p>
			
			
			
			<div class="content">Good evening all.  Since I got some great feedback last time on my implementation of AES encryption in batch, I thought I'd post here my latest crypto-related development.  This one implements the common MD5 hashing algorithm, also known as RFC 1321:  <!-- m --><a class="postlink" href="http://www.ietf.org/rfc/rfc1321.txt">http://www.ietf.org/rfc/rfc1321.txt</a><!-- m -->.  This is a cryptographically secure* one-way hashing algorithm (* - see notes at the end) still in wide use all over the world.  You can read more about it [wikipedia.org/wiki/MD5]<br /><br />The script takes a single parameter which can be either the name of a file or a string.  The hash/digest is written to the console and optionally stored in a variable, passed as the second parameter.  First is the source code:<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>:: This script implements the MD5 Message-Digest Algorithm in accordance with<br />:: RFC 1321, which can be found at http://www.ietf.org/rfc/rfc1321.txt.<br />:: The only known limitation is that files to be hashed by this script must<br />:: be less than 256 MB in size.<br />@echo off<br />SETLOCAL ENABLEDELAYEDEXPANSION<br />IF &quot;%~1&quot;==&quot;&quot; (<br />&nbsp; &nbsp;echo md5 ^&lt;string/filename^&gt; &#91;^&lt;variable^&gt;&#93;<br />&nbsp; &nbsp;echo&nbsp; &nbsp; Calculates the MD5 message-digest of the input string or file.<br />&nbsp; &nbsp;echo&nbsp; &nbsp; Prints the result to stdout and optionally stores it in 'variable'.<br />&nbsp; &nbsp;exit /b<br />)<br />set &quot;inFile=%~1&quot;<br /><br />:: Binary integer parts of the sines of integers (in Radians)<br />set i=0<br />FOR %%a IN (d76aa478 e8c7b756 242070db c1bdceee f57c0faf 4787c62a a8304613 fd469501<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 698098d8 8b44f7af ffff5bb1 895cd7be 6b901122 fd987193 a679438e 49b40821<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; f61e2562 c040b340 265e5a51 e9b6c7aa d62f105d 02441453 d8a1e681 e7d3fbc8<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 21e1cde6 c33707d6 f4d50d87 455a14ed a9e3e905 fcefa3f8 676f02d9 8d2a4c8a<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fffa3942 8771f681 6d9d6122 fde5380c a4beea44 4bdecfa9 f6bb4b60 bebfbc70<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 289b7ec6 eaa127fa d4ef3085 04881d05 d9d4d039 e6db99e5 1fa27cf8 c4ac5665<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; f4292244 432aff97 ab9423a7 fc93a039 655b59c3 8f0ccc92 ffeff47d 85845dd1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 6fa87e4f fe2ce6e0 a3014314 4e0811a1 f7537e82 bd3af235 2ad7d2bb eb86d391<br />) DO set /a &quot;Radians&#91;!i!&#93;=0x%%a, i+=1&quot;<br /><br />:: Per-round rotation amounts<br />set i=0<br />FOR %%a IN (7 12 17 22 7 12 17 22 7 12 17 22 7 12 17 22<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 5&nbsp; 9 14 20 5&nbsp; 9 14 20 5&nbsp; 9 14 20 5&nbsp; 9 14 20<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4 11 16 23 4 11 16 23 4 11 16 23 4 11 16 23<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 6 10 15 21 6 10 15 21 6 10 15 21 6 10 15 21<br />) DO set /a &quot;Shift&#91;!i!&#93;=%%a, i+=1&quot;<br /><br />:: Powers of 2 lookup table for custom right shift operation<br />:: Only includes the values we could possibly need, to keep ENV size down.<br />set /a Powers2&#91;3&#93;=8, Powers2&#91;4&#93;=16, Powers2&#91;5&#93;=32, Powers2&#91;6&#93;=64, Powers2&#91;8&#93;=256<br />set /a Powers2&#91;9&#93;=512, Powers2&#91;10&#93;=1024, Powers2&#91;11&#93;=2048, Powers2&#91;13&#93;=8192<br />set /a Powers2&#91;14&#93;=16384, Powers2&#91;15&#93;=32768, Powers2&#91;16&#93;=65536, Powers2&#91;19&#93;=524288<br />set /a Powers2&#91;20&#93;=1048576, Powers2&#91;21&#93;=2097152, Powers2&#91;22&#93;=4194304<br /><br />:: Output digest initialization<br />set /a digA0=0x67452301, digB0=0xefcdab89, digC0=0x98badcfe, digD0=0x10325476<br /><br />:: Map for dec-&gt;hex conversion<br />set &quot;hexMap=0123456789ABCDEF&quot;<br /><br />:: If the input is not a valid filename, it is treated as a string to be hashed. The string is first written to a<br />:: temp file (without appending a carriage return), then the script recursively calls itself to hash that file.<br />IF NOT EXIST !inFile! (<br />&nbsp; &nbsp;set recursed=true<br />&nbsp; &nbsp;echo|set /p ans=&quot;%inFile%&quot;&gt;&quot;%temp%\_md5.tmp&quot;<br />&nbsp; &nbsp;CALL %~f0 &quot;%temp%\_md5.tmp&quot; %~2<br />&nbsp; &nbsp;del &quot;%temp%\_md5.tmp&quot;<br />&nbsp; &nbsp;:: Pass the result back over the second ENDLOCAL barrier<br />&nbsp; &nbsp;IF NOT &quot;%~2&quot;==&quot;&quot; FOR %%a IN (!md5Digest!) DO ENDLOCAL&amp; set %~2=%%a<br />&nbsp; &nbsp;exit /b<br />)<br />:: Abort with an error if the input file is larger than 268,435,455 bytes (see block padding description below)<br />IF %~Z1 GTR 268435455 (<br />&nbsp; &nbsp;echo ERROR: File size must be ^&lt;= 268,435,455 bytes ^(256 MB^)<br />&nbsp; &nbsp;exit /b<br />)<br />:: Convert the input file into a hexadecimal representation and split it into 512-bit little endian blocks.<br />set &quot;tempFile=%temp%\#.tmp&quot;<br />del &quot;%tempFile%&quot; 2&gt;NUL<br />fsutil file createnew &quot;%tempFile%&quot; %~Z1 &gt;NUL<br />set /A i=0, d=0<br />set block=<br />set emptyfile=false<br />for /F &quot;skip=1 tokens=1,2 delims=: &quot; %%b in ('fc /B &quot;%inFile%&quot; &quot;%tempFile%&quot;') do (<br />&nbsp; &nbsp;IF NOT %%c==no (<br />&nbsp; &nbsp; &nbsp; set /A b=0x%%b<br />&nbsp; &nbsp; &nbsp; if !i! neq !b! (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set /A c=b-i<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for /L %%i in (!c!,-1,1) do (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; set &quot;block=00!block!&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; set /A d+=1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if !d! geq 64 (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set /a d=0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;CALL:do_md5 !block!<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set block=<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;) <br />&nbsp; &nbsp; &nbsp; )<br />&nbsp; &nbsp; &nbsp; set &quot;block=%%c!block!&quot;<br />&nbsp; &nbsp; &nbsp; set /A i=b+1, d+=1<br />&nbsp; &nbsp; &nbsp; if !d! geq 64 (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set /a d=0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;CALL:do_md5 !block!<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set block=<br />&nbsp; &nbsp; &nbsp; )<br />&nbsp; &nbsp;) ELSE set emptyfile=true<br />)<br />IF NOT !emptyfile!==true (<br />&nbsp; &nbsp;if !i! neq %~Z1 (<br />&nbsp; &nbsp; &nbsp; set /A c=%~Z1-i<br />&nbsp; &nbsp; &nbsp; for /L %%i in (!c!,-1,1) do (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set &quot;block=00!block!&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set /A d+=1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if !d! geq 64 (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; set /a d=0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CALL:do_md5 !block!<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; set block=<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;)<br />&nbsp; &nbsp; &nbsp; )<br />&nbsp; &nbsp;)<br />)<br />:: Some portion of a 512-bit block will be leftover and needs to be padded before processing.<br />:: First pad the block with a '1' bit and seven '0' bits (0x80)<br />set &quot;block=80!block!&quot;<br />set /a d+=1<br />if !d! geq 64 (<br />&nbsp; &nbsp;set /a d=0<br />&nbsp; &nbsp;CALL:do_md5 !block!<br />&nbsp; &nbsp;set block=<br />)<br />:: If the block is now larger than 448 bits, it needs to be zero-padded to 512, hashed, and<br />:: a second empty block created to hold the length field.<br />IF !d! GTR 56 (<br />&nbsp; &nbsp;FOR /L %%a IN (!d!,1,63) DO set &quot;block=00!block!&quot;<br />&nbsp; &nbsp;set /a d=0<br />&nbsp; &nbsp;CALL:do_md5 !block!<br />&nbsp; &nbsp;set block=<br />)<br />:: Zero-pad the remaining block 4 bits at a time until the total length is 448 bits (512-64)<br />set /a lenBits=!d!*8<br />FOR /L %%a IN (!lenBits!,4,444) DO set &quot;block=0!block!&quot;<br /><br />:: The final 64 bits of padding are set equal to the original size in bits of the input.<br />:: Since cmd only handles 32-bit numbers, we assume the upper 32-bits are zero and the size<br />:: is stored in the lower 32 bits only. This supports files up to ~256 MB, much larger than<br />:: anyone with any sense would ever use this script on.<br />set /a dec=%~Z1*8<br />set &quot;hex=&quot;<br />FOR /L %%N IN (1,1,8) do (<br />&nbsp; &nbsp; set /a &quot;d=dec&amp;15,dec&gt;&gt;=4&quot;<br />&nbsp; &nbsp; FOR %%D in (!d!) do set &quot;hex=!hexmap:~%%D,1!!hex!&quot;<br />)<br />:: Hash the final block<br />CALL:do_md5 00000000!hex!!block!<br /><br />:: Convert the MD5 digest chunks to hex<br />FOR %%a IN (digA0 digB0 digC0 digD0) DO (<br />&nbsp; &nbsp;set /a dec=!%%a!<br />&nbsp; &nbsp;set &quot;hex=&quot;<br />&nbsp; &nbsp;FOR /L %%N IN (1,1,8) do (<br />&nbsp; &nbsp; &nbsp; &nbsp;set /a &quot;d=dec&amp;15,dec&gt;&gt;=4&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp;FOR %%D in (!d!) do set &quot;%%ahex=!hexmap:~%%D,1!!%%ahex!&quot;<br />&nbsp; &nbsp;)<br />)<br />:: Rearrange the hex to create the little endian output value<br />set md5Digest=<br />FOR %%a IN (digA0hex digB0hex digC0hex digD0hex) DO (<br />&nbsp; &nbsp;FOR /L %%b IN (6,-2,0) DO (<br />&nbsp; &nbsp; &nbsp; set thisByte=!%%a:~%%b,2!<br />&nbsp; &nbsp; &nbsp; set &quot;md5Digest=!md5Digest!!thisByte!&quot;<br />&nbsp; &nbsp;)<br />)<br />echo !md5Digest!<br />del &quot;%temp%\#.tmp&quot;<br />IF NOT &quot;%~2&quot;==&quot;&quot; IF NOT !recursed!==true (ENDLOCAL&amp; set %~2=%md5Digest%) ELSE (ENDLOCAL&amp; set md5Digest=%md5Digest%)<br />exit /b<br /><br />:do_md5<br />set data=%~1<br />:: Break the input block into sixteen 32-bit words<br />FOR /L %%a IN (0,1,15) DO (<br />&nbsp; &nbsp;set /a &quot;startPos=(15-%%a)*8&quot;<br />&nbsp; &nbsp;FOR %%b IN (!startPos!) DO set M&#91;%%a&#93;=!data:~%%b,8!<br />)<br />:: Initialize this chunk's digest to the running digest value<br />set /a digA'=!digA0!, digB'=!digB0!, digC'=!digC0!, digD'=!digD0!<br /><br />:: Main md5 loop<br />FOR /L %%i IN (0,1,63) DO (<br />&nbsp; &nbsp;IF %%i LEQ 15 (<br />&nbsp; &nbsp; &nbsp; set /a &quot;F=!digD'! ^^ (!digB'! &amp; (!digC'! ^^ !digD'!))&quot;<br />&nbsp; &nbsp; &nbsp; set /a g=%%i<br />&nbsp; &nbsp;) ELSE IF %%i LEQ 31 (<br />&nbsp; &nbsp; &nbsp; set /a &quot;F=!digC'! ^^ (!digD'! &amp; (!digB'! ^^ !digC'!))&quot;<br />&nbsp; &nbsp; &nbsp; set /a &quot;g=(5*%%i+1)%%16&quot;<br />&nbsp; &nbsp;) ELSE IF %%i LEQ 47 (<br />&nbsp; &nbsp; &nbsp; set /a &quot;F=!digB'! ^^ !digC'! ^^ !digD'!&quot;<br />&nbsp; &nbsp; &nbsp; set /a &quot;g=(3*%%i+5)%%16&quot;<br />&nbsp; &nbsp;) ELSE IF %%i LEQ 63 (<br />&nbsp; &nbsp; &nbsp; set /a &quot;F=!digC'! ^^ (!digB'! | (!digD'! ^^ 0xFFFFFFFF))&quot;<br />&nbsp; &nbsp; &nbsp; set /a &quot;g=(7*%%i)%%16&quot;<br />&nbsp; &nbsp;)<br />&nbsp; &nbsp;set /a tempD=!digD'!<br />&nbsp; &nbsp;set /a digD'=!digC'!, digC'=!digB'!<br />&nbsp; &nbsp;FOR %%g IN (!g!) DO set /a &quot;msg=0x!M&#91;%%g&#93;!&quot;<br />&nbsp; &nbsp;set /a X=!digA'!+!F!+!Radians&#91;%%i&#93;!+!msg!<br />&nbsp; &nbsp;:: Because cmd does an arithmetic (sign-aware) right shift instead of a logical right shift^<br />&nbsp; &nbsp;:: 'Negative' numbers will cause incorrect shift results. This implementation performs a proper^<br />&nbsp; &nbsp;:: logical right shift on negative numbers by removing the negative sign bit and putting it back^<br />&nbsp; &nbsp;:: in the proper position after the shift is completed.<br />&nbsp; &nbsp;IF !X! LSS 0 (<br />&nbsp; &nbsp; &nbsp; set /a &quot;tempX=!X! &amp; 0x7FFFFFFF&quot;<br />&nbsp; &nbsp; &nbsp; set /a rShiftAmt=32-!Shift&#91;%%i&#93;!<br />&nbsp; &nbsp; &nbsp; set /a &quot;tempB=!tempX! &gt;&gt; !rShiftAmt!&quot;<br />&nbsp; &nbsp; &nbsp; FOR %%j IN (!rShiftAmt!) DO set /a power=31-%%j<br />&nbsp; &nbsp; &nbsp; FOR %%k IN (!power!) DO set /a tempB+=!Powers2&#91;%%k&#93;!<br />&nbsp; &nbsp; &nbsp; set /a &quot;digB'+=((!X! &lt;&lt; !Shift&#91;%%i&#93;!) | !tempB!)&quot;<br />&nbsp; &nbsp;) ELSE set /a &quot;digB'+=((!X! &lt;&lt; !Shift&#91;%%i&#93;!) | (!X! &gt;&gt; (32-!Shift&#91;%%i&#93;!)))&quot;<br />&nbsp; &nbsp;set /a digA'=!tempD!<br />)<br />:: Add this chunk's result to the running digest value<br />set /a digA0+=!digA'!, digB0+=!digB'!, digC0+=!digC'!, digD0+=!digD'!<br />exit /b</code></pre></div> And the results of a test program, which tests all 7 cases specified in the RFC document:<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>c:\Users\Marc\Desktop\md5&gt;md5test<br />*** Test 1: MD5('emptystring')<br />D41D8CD98F00B204E9800998ECF8427E - result<br />d41d8cd98f00b204e9800998ecf8427e - expected<br />Time: 00:00:00.17<br />*** Test 2: MD5(a)<br />0CC175B9C0F1B6A831C399E269772661 - result<br />0cc175b9c0f1b6a831c399e269772661 - expected<br />Time: 00:00:00.22<br />*** Test 3: MD5(abc)<br />900150983CD24FB0D6963F7D28E17F72 - result<br />900150983cd24fb0d6963f7d28e17f72 - expected<br />Time: 00:00:00.20<br />*** Test 4: MD5(message digest)<br />F96B697D7CB7938D525A2F31AAF161D0 - result<br />f96b697d7cb7938d525a2f31aaf161d0 - expected<br />Time: 00:00:00.22<br />*** Test 5: MD5(abcdefghijklmnopqrstuvwxyz)<br />C3FCD3D76192E4007DFB496CCA67E13B - result<br />c3fcd3d76192e4007dfb496cca67e13b - expected<br />Time: 00:00:00.20<br />*** Test 6: MD5(ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789)<br />D174AB98D277D9F5A5611C2C9F419D9F - result<br />d174ab98d277d9f5a5611c2c9f419d9f - expected<br />Time: 00:00:00.29<br />*** Test 7: MD5(12345678901234567890123456789012345678901234567890123456789012345678901234567890)<br />57EDF4A22BE3C955AC49DA2E2107B67A - result<br />57edf4a22be3c955ac49da2e2107b67a - expected<br />Time: 00:00:00.31<br />c:\Users\Marc\Desktop\md5&gt;</code></pre></div> A generic use case for this would be storage of user passwords, similar to the goal of the original string encoding thread here: <!-- l --><a class="postlink-local" href="viewtopic635b.html?f=3&amp;t=4579">viewtopic.php?f=3&amp;t=4579</a><!-- l -->.<br /><br />A user would enter their password, let's say it's &quot;password&quot; and you'd run it through md5 (preferably after salting, but that's a different topic) to obtain a hash like &quot;5F4DCC3B5AA765D61D8327DEB882CF99&quot;.  That hash can be stored in the clear, in a text file, etc. and there is no conceivable way to reverse it to obtain the original &quot;password&quot;.  Then when a user tries to log in to your system, you hash the password they provide, compare that hash to the original value you saved, and if they match the password must have been correct.  It is nearly impossible* for someone to come up with another string, such as &quot;DONUT&quot; that will produce the same hash as the string &quot;password&quot;.  (* - again, see the notes below) <br /><br />Another common use is for file validation, where before running itself a batch could hash either its own code, or the content of a configuration file, etc. and compare the resulting hash to a &quot;known good&quot; value.  If the hashes don't match, the file in question has clearly been tampered with.  I'm sure you've all seen the md5 checksums next to files you're downloading online which are intended to verify no corruption occurred during the download.<br /><br />NOTES: You might have heard that MD5 is cryptographically &quot;broken&quot;, which is absolutely true, but this simply means there are attacks against the algorithm that can provide a hash collision (ie: choosing &quot;DONUT&quot; to provide the same hash as &quot;password&quot;) in less than brute-force time.  Nowadays it's actually broken pretty thoroughly and shouldn't be used for real security-critical situations.  However, that doesn't mean it's completely useless, and it's certainly plenty of security for something as trivial as a batch file.  Certainly better than the simple substitution codes first suggested in the string encoding thread  <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /> <br /><br />Anyway if anyone would like to take a look through the code and suggest any efficiency improvements they'd be most welcome.  Unfortunately the algorithm is strictly serial so cannot be sped up by multithreading like my AES implementation.  Currently it's able to process a 1KB file in about 1.3 seconds, and a 100KB file in about 3 minutes (not sure why it scales so poorly...).  You really don't want to use this on large files; for anything more than just &quot;batch tinkering because it's fun&quot; you should get a Jscript or C implementation.  But where's the fun in that?!  <img class="smilies" src="images/smilies/icon_lol.gif" alt=":lol:" title="Laughing" /> <br /><br />Thanks all!</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p34180" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile34180">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistcb12.html?mode=viewprofile&amp;u=1621" class="username">carlos</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchda66.html?author_id=1621&amp;sr=posts">472</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 20 Aug 2010 13:57</dd>		
		
																<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Chile</dd>
							
							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact carlos">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact carlos</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="https://web.archive.org/web/20180902091521/http://consolesoft.com/" title="Website" class="last-cell">
										<span class="contact-icon phpbb_website-icon">Website</span>
									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content34180">

						<h3 ><a href="#p34180">Re: MD5 Message-Digest Algorithm</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting4513-2.html?mode=quote&amp;f=3&amp;p=34180" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicba1c.html?p=34180#p34180" onclick="prompt('Message #2',this.href); return false;">#2</a></span> 
									<a class="unread" href="viewtopicba1c.html?p=34180#p34180" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistcb12.html?mode=viewprofile&amp;u=1621" class="username">carlos</a></strong> &raquo; </span>03 May 2014 12:38
			</p>
			
			
			
			<div class="content">Very nice code.<br />I test only one string and works ok.<br /><br />I only change a little thing, because I run the script from desktop (this folder have space inside the full path):<br /><br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>IF NOT EXIST !inFile!</code></pre></div><br />to:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>IF NOT EXIST &quot;!inFile!&quot;</code></pre></div><br /><br />and:<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>CALL %~f0</code></pre></div><br />to<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>CALL &quot;%~f0&quot;</code></pre></div></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p34182" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile34182">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlista071.html?mode=viewprofile&amp;u=3864" class="username">einstein1969</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searche2bd.html?author_id=3864&amp;sr=posts">762</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 15 Jun 2012 13:16</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Italy, Rome</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content34182">

						<h3 ><a href="#p34182">Re: MD5 Message-Digest Algorithm</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting1f88.html?mode=quote&amp;f=3&amp;p=34182" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic92c5.html?p=34182#p34182" onclick="prompt('Message #3',this.href); return false;">#3</a></span> 
									<a class="unread" href="viewtopic92c5.html?p=34182#p34182" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlista071.html?mode=viewprofile&amp;u=3864" class="username">einstein1969</a></strong> &raquo; </span>03 May 2014 13:58
			</p>
			
			
			
			<div class="content">Hi Magialisk!<br /><br />Interesting reading. I don't know very well this algos of cript. I have approccied time ago a crc32 for check data from two pipe in dos batch but I don't <a href="viewtopic4295-2.html?p=30336#p30336" class="postlink">have finished</a>.<br /><br />I reading that MD5 i better than crc32 for security reason than this is very good for the examples of password and for check file again accidental change or made by some viruses etc. (even if ... &quot; In 2012, the Flame malware exploited the weaknesses in MD5 to fake a Microsoft digital signature. &quot; cit. wikipedia)<br /><br />For crc32 there are various methos of implement. For examples, using hash table or directly.<br /><br />There 's the same opportunity to do so with Md5? (I thinks that could be faster...)<br /><br />EDIT: changed test a little...<br /><br />einstein1969</div>

			
													<div class="notice">
					Last edited by <a href="memberlista071.html?mode=viewprofile&amp;u=3864" class="username">einstein1969</a> on 03 May 2014 15:15, edited 3 times in total.
									</div>
			
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p34183" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile34183">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlista071.html?mode=viewprofile&amp;u=3864" class="username">einstein1969</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searche2bd.html?author_id=3864&amp;sr=posts">762</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 15 Jun 2012 13:16</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Italy, Rome</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content34183">

						<h3 ><a href="#p34183">Re: MD5 Message-Digest Algorithm</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingf13c.html?mode=quote&amp;f=3&amp;p=34183" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicc89f.html?p=34183#p34183" onclick="prompt('Message #4',this.href); return false;">#4</a></span> 
									<a class="unread" href="viewtopicc89f.html?p=34183#p34183" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlista071.html?mode=viewprofile&amp;u=3864" class="username">einstein1969</a></strong> &raquo; </span>03 May 2014 14:21
			</p>
			
			
			
			<div class="content"><blockquote class="uncited"><div>Currently it's able to process a 1KB file in about 1.3 seconds, and a 100KB file in about 3 minutes (not sure why it scales so poorly...).<br /></div></blockquote><br /><br />For the time scale i think that has same behavior of <a href="viewtopic9649.html?p=32065#p32065" class="postlink">this code</a> (I have not verified). I will do!<br /><br />Than... use macro? i thinks will speed up.<br /><br /><br />EDIT: I have verified. Change the code will do the time scale near linear with size.<br /><br />change this line of code:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>for /F &quot;skip=1 tokens=1,2 delims=: &quot; %%b in ('fc /B &quot;%inFile%&quot; &quot;%tempFile%&quot;') do (<br /></code></pre></div><br />to:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>set &quot;tempFile2=%temp%\#2.tmp&quot;<br />&gt;&quot;%tempFile2%&quot; fc /B &quot;%inFile%&quot; &quot;%tempFile%&quot;<br />for /F &quot;usebackq skip=1 tokens=1,2 delims=: &quot; %%b in (&quot;%tempFile2%&quot;) do (<br /></code></pre></div><br /><br />einstein1969</div>

			
													<div class="notice">
					Last edited by <a href="memberlista071.html?mode=viewprofile&amp;u=3864" class="username">einstein1969</a> on 03 May 2014 15:57, edited 1 time in total.
									</div>
			
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p34184" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile34184">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchdc63.html?author_id=2923&amp;sr=posts">1540</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 06 Dec 2011 22:15</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> México City, México</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content34184">

						<h3 ><a href="#p34184">Re: MD5 Message-Digest Algorithm</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingca5a.html?mode=quote&amp;f=3&amp;p=34184" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic4f8b.html?p=34184#p34184" onclick="prompt('Message #5',this.href); return false;">#5</a></span> 
									<a class="unread" href="viewtopic4f8b.html?p=34184#p34184" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a></strong> &raquo; </span>03 May 2014 15:19
			</p>
			
			
			
			<div class="content">There is not much chance to optimize this code excepting the arithmetic operations at end of the main md5 loop, that also allows to eliminate the powers of 2 lookup table:<br /><br /><strong class="text-strong">EDIT</strong>: I added several small modifications; I think that the simpler code in the main md5 loop may allows the program run slightly faster.<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>:: This script implements the MD5 Message-Digest Algorithm in accordance with<br />:: RFC 1321, which can be found at http://www.ietf.org/rfc/rfc1321.txt.<br />:: The only known limitation is that files to be hashed by this script must<br />:: be less than 256 MB in size.<br /><br />@echo off<br />SETLOCAL ENABLEDELAYEDEXPANSION<br />IF &quot;%~1&quot;==&quot;&quot; (<br />&nbsp; &nbsp;echo md5 ^&lt;string/filename^&gt; &#91;^&lt;variable^&gt;&#93;<br />&nbsp; &nbsp;echo&nbsp; &nbsp; Calculates the MD5 message-digest of the input string or file.<br />&nbsp; &nbsp;echo&nbsp; &nbsp; Prints the result to stdout and optionally stores it in 'variable'.<br />&nbsp; &nbsp;exit /b<br />)<br />set &quot;inFile=%~1&quot;<br /><br />:: Binary integer parts of the sines of integers (in Radians)<br />set i=0<br />FOR %%a IN (d76aa478 e8c7b756 242070db c1bdceee f57c0faf 4787c62a a8304613 fd469501<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 698098d8 8b44f7af ffff5bb1 895cd7be 6b901122 fd987193 a679438e 49b40821<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; f61e2562 c040b340 265e5a51 e9b6c7aa d62f105d 02441453 d8a1e681 e7d3fbc8<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 21e1cde6 c33707d6 f4d50d87 455a14ed a9e3e905 fcefa3f8 676f02d9 8d2a4c8a<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fffa3942 8771f681 6d9d6122 fde5380c a4beea44 4bdecfa9 f6bb4b60 bebfbc70<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 289b7ec6 eaa127fa d4ef3085 04881d05 d9d4d039 e6db99e5 1fa27cf8 c4ac5665<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; f4292244 432aff97 ab9423a7 fc93a039 655b59c3 8f0ccc92 ffeff47d 85845dd1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 6fa87e4f fe2ce6e0 a3014314 4e0811a1 f7537e82 bd3af235 2ad7d2bb eb86d391<br />) DO set /a &quot;Radians&#91;!i!&#93;=0x%%a, i+=1&quot;<br /><br />:: Per-round rotation amounts<br />set i=0<br />FOR %%a IN (7 12 17 22 7 12 17 22 7 12 17 22 7 12 17 22<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 5&nbsp; 9 14 20 5&nbsp; 9 14 20 5&nbsp; 9 14 20 5&nbsp; 9 14 20<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4 11 16 23 4 11 16 23 4 11 16 23 4 11 16 23<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 6 10 15 21 6 10 15 21 6 10 15 21 6 10 15 21<br />) DO set /a &quot;Shift&#91;!i!&#93;=%%a, i+=1&quot;<br /><br />:: Output digest initialization<br />set /a digA0=0x67452301, digB0=0xefcdab89, digC0=0x98badcfe, digD0=0x10325476<br /><br />:: Map for dec-&gt;hex conversion<br />set &quot;hexMap=0123456789ABCDEF&quot;<br /><br />:: If the input is not a valid filename, it is treated as a string to be hashed. The string is first written to a<br />:: temp file (without appending a carriage return), then the script recursively calls itself to hash that file.<br />IF NOT EXIST &quot;%inFile%&quot; (<br />&nbsp; &nbsp;set recursed=true<br />&nbsp; &nbsp;set /p ans=&quot;%inFile%&quot; &gt;&quot;%temp%\_md5.tmp&quot; &lt; NUL<br />&nbsp; &nbsp;CALL &quot;%~f0&quot; &quot;%temp%\_md5.tmp&quot; %~2<br />&nbsp; &nbsp;del &quot;%temp%\_md5.tmp&quot;<br />&nbsp; &nbsp;:: Pass the result back over the second ENDLOCAL barrier<br />&nbsp; &nbsp;IF NOT &quot;%~2&quot;==&quot;&quot; FOR %%a IN (!md5Digest!) DO ENDLOCAL&amp; set %~2=%%a<br />&nbsp; &nbsp;exit /b<br />)<br />:: Abort with an error if the input file is larger than 268,435,455 bytes (see block padding description below)<br />IF %~Z1 GTR 268435455 (<br />&nbsp; &nbsp;echo ERROR: File size must be ^&lt;= 268,435,455 bytes ^(256 MB^)<br />&nbsp; &nbsp;exit /b<br />)<br />:: Convert the input file into a hexadecimal representation and split it into 512-bit little endian blocks.<br />set &quot;tempFile=%temp%\#.tmp&quot;<br />del &quot;%tempFile%&quot; 2&gt;NUL<br />fsutil file createnew &quot;%tempFile%&quot; %~Z1 &gt;NUL<br />set /A i=0, d=0<br />set block=<br />set emptyfile=false<br />for /F &quot;skip=1 tokens=1,2 delims=: &quot; %%b in ('fc /B &quot;%inFile%&quot; &quot;%tempFile%&quot;') do (<br />&nbsp; &nbsp;IF NOT %%c==no (<br />&nbsp; &nbsp; &nbsp; set /A b=0x%%b<br />&nbsp; &nbsp; &nbsp; if !i! neq !b! (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set /A c=b-i<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for /L %%i in (!c!,-1,1) do (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; set &quot;block=00!block!&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; set /A d+=1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if !d! geq 64 (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set /a d=0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;CALL:do_md5 !block!<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set block=<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;) <br />&nbsp; &nbsp; &nbsp; )<br />&nbsp; &nbsp; &nbsp; set &quot;block=%%c!block!&quot;<br />&nbsp; &nbsp; &nbsp; set /A i=b+1, d+=1<br />&nbsp; &nbsp; &nbsp; if !d! geq 64 (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set /a d=0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;CALL:do_md5 !block!<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set block=<br />&nbsp; &nbsp; &nbsp; )<br />&nbsp; &nbsp;) ELSE (<br />&nbsp; &nbsp; &nbsp; set emptyfile=true<br />&nbsp; &nbsp;)<br />)<br />IF NOT %emptyfile%==true (<br />&nbsp; &nbsp;if %i% neq %~Z1 (<br />&nbsp; &nbsp; &nbsp; set /A c=%~Z1-i<br />&nbsp; &nbsp; &nbsp; for /L %%i in (!c!,-1,1) do (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set &quot;block=00!block!&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set /A d+=1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if !d! geq 64 (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; set /a d=0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CALL:do_md5 !block!<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; set block=<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;)<br />&nbsp; &nbsp; &nbsp; )<br />&nbsp; &nbsp;)<br />)<br />:: Some portion of a 512-bit block will be leftover and needs to be padded before processing.<br />:: First pad the block with a '1' bit and seven '0' bits (0x80)<br />set &quot;block=80%block%&quot;<br />set /a d+=1<br />if %d% geq 64 (<br />&nbsp; &nbsp;set /a d=0<br />&nbsp; &nbsp;CALL:do_md5 !block!<br />&nbsp; &nbsp;set block=<br />)<br />:: If the block is now larger than 448 bits, it needs to be zero-padded to 512, hashed, and<br />:: a second empty block created to hold the length field.<br />IF %d% GTR 56 (<br />&nbsp; &nbsp;FOR /L %%a IN (%d%,1,63) DO set &quot;block=00!block!&quot;<br />&nbsp; &nbsp;set /a d=0<br />&nbsp; &nbsp;CALL:do_md5 !block!<br />&nbsp; &nbsp;set block=<br />)<br />:: Zero-pad the remaining block 4 bits at a time until the total length is 448 bits (512-64)<br />set /a lenBits=d*8<br />FOR /L %%a IN (%lenBits%,4,444) DO set &quot;block=0!block!&quot;<br /><br />:: The final 64 bits of padding are set equal to the original size in bits of the input.<br />:: Since cmd only handles 32-bit numbers, we assume the upper 32-bits are zero and the size<br />:: is stored in the lower 32 bits only. This supports files up to ~256 MB, much larger than<br />:: anyone with any sense would ever use this script on.<br />set /a dec=%~Z1*8<br />set &quot;hex=&quot;<br />FOR /L %%N IN (1,1,8) do (<br />&nbsp; &nbsp; set /a &quot;d=dec&amp;15, dec&gt;&gt;=4&quot;<br />&nbsp; &nbsp; FOR %%D in (!d!) do set &quot;hex=!hexmap:~%%D,1!!hex!&quot;<br />)<br />:: Hash the final block<br />CALL:do_md5 00000000%hex%%block%<br /><br />:: Convert the MD5 digest chunks to hex<br />FOR %%a IN (digA0 digB0 digC0 digD0) DO (<br />&nbsp; &nbsp;set /a dec=!%%a!<br />&nbsp; &nbsp;set &quot;hex=&quot;<br />&nbsp; &nbsp;FOR /L %%N IN (1,1,8) do (<br />&nbsp; &nbsp; &nbsp; &nbsp;set /a &quot;d=dec&amp;15, dec&gt;&gt;=4&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp;FOR %%D in (!d!) do set &quot;%%ahex=!hexmap:~%%D,1!!%%ahex!&quot;<br />&nbsp; &nbsp;)<br />)<br />:: Rearrange the hex to create the little endian output value<br />set md5Digest=<br />FOR %%a IN (digA0hex digB0hex digC0hex digD0hex) DO (<br />&nbsp; &nbsp;FOR /L %%b IN (6,-2,0) DO (<br />&nbsp; &nbsp; &nbsp; set &quot;md5Digest=!md5Digest!!%%a:~%%b,2!&quot;<br />&nbsp; &nbsp;)<br />)<br />echo %md5Digest%<br />del &quot;%temp%\#.tmp&quot;<br />IF NOT &quot;%~2&quot;==&quot;&quot; IF NOT %recursed%==true (ENDLOCAL&amp; set %~2=%md5Digest%) ELSE (ENDLOCAL&amp; set md5Digest=%md5Digest%)<br />exit /b<br /><br />:do_md5<br />set data=%~1<br />:: Break the input block into sixteen 32-bit words<br />FOR /L %%a IN (0,1,15) DO (<br />&nbsp; &nbsp;set /a &quot;startPos=(15-%%a)*8&quot;<br />&nbsp; &nbsp;FOR %%b IN (!startPos!) DO set M&#91;%%a&#93;=!data:~%%b,8!<br />)<br />:: Initialize this chunk's digest to the running digest value<br />set /a digA'=digA0, digB'=digB0, digC'=digC0, digD'=digD0<br />:: Main md5 loop<br />FOR /L %%i IN (0,1,63) DO (<br />&nbsp; &nbsp;IF %%i LEQ 15 (<br />&nbsp; &nbsp; &nbsp; set /a &quot;F=digD' ^ (digB' &amp; (digC' ^ digD')),&nbsp; &nbsp; &nbsp; g=%%i&quot;<br />&nbsp; &nbsp;) ELSE IF %%i LEQ 31 (<br />&nbsp; &nbsp; &nbsp; set /a &quot;F=digC' ^ (digD' &amp; (digB' ^ digC')),&nbsp; &nbsp; &nbsp; g=(5*%%i+1)%%16&quot;<br />&nbsp; &nbsp;) ELSE IF %%i LEQ 47 (<br />&nbsp; &nbsp; &nbsp; set /a &quot;F=digB' ^ digC' ^ digD',&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; g=(3*%%i+5)%%16&quot;<br />&nbsp; &nbsp;) ELSE (<br />&nbsp; &nbsp; &nbsp; set /a &quot;F=digC' ^ (digB' | (digD' ^ 0xFFFFFFFF)), g=(7*%%i)%%16&quot;<br />&nbsp; &nbsp;)<br />&nbsp; &nbsp;set /a tempD=digD', digD'=digC', digC'=digB'<br />&nbsp; &nbsp;FOR %%g IN (!g!) DO set /a &quot;X=digA'+F+Radians&#91;%%i&#93;+0x!M&#91;%%g&#93;!&quot;<br />&nbsp; &nbsp;:: Because cmd does an arithmetic (sign-aware) right shift instead of a logical right shift^<br />&nbsp; &nbsp;:: 'Negative' numbers will cause incorrect shift results. This implementation performs a proper^<br />&nbsp; &nbsp;:: logical right shift on negative numbers by removing the negative sign bit and putting it back^<br />&nbsp; &nbsp;:: in the proper position after the shift is completed.<br />&nbsp; &nbsp;IF !X! LSS 0 (<br />&nbsp; &nbsp; &nbsp; set /a &quot;rShiftAmt=32-Shift&#91;%%i&#93;, tempB=((X &amp; 0x7FFFFFFF)&gt;&gt;rShiftAmt) + (1&lt;&lt;(31-rShiftAmt))&quot;<br />&nbsp; &nbsp;) ELSE (<br />&nbsp; &nbsp; &nbsp; set /a &quot;tempB=X &gt;&gt; (32-Shift&#91;%%i&#93;)&quot;<br />&nbsp; &nbsp;)<br />&nbsp; &nbsp;set /a &quot;digB'+=(X &lt;&lt; Shift&#91;%%i&#93;) | tempB, digA'=tempD&quot;<br />)<br />:: Add this chunk's result to the running digest value<br />set /a digA0+=digA', digB0+=digB', digC0+=digC', digD0+=digD'<br />exit /b<br /></code></pre></div><br /><br />Antonio</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p34189" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile34189">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistc2fd.html?mode=viewprofile&amp;u=4985" class="username">Magialisk</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search6f26.html?author_id=4985&amp;sr=posts">104</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 25 Jul 2013 19:00</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content34189">

						<h3 ><a href="#p34189">Re: MD5 Message-Digest Algorithm</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting7608.html?mode=quote&amp;f=3&amp;p=34189" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicb698.html?p=34189#p34189" onclick="prompt('Message #6',this.href); return false;">#6</a></span> 
									<a class="unread" href="viewtopicb698.html?p=34189#p34189" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistc2fd.html?mode=viewprofile&amp;u=4985" class="username">Magialisk</a></strong> &raquo; </span>03 May 2014 22:57
			</p>
			
			
			
			<div class="content">Wow!  Imagine my surprise to come back here after only one night and see such enthusiastic responses to my post.  Thank you all for the suggestions so far!  I will give them all a try in the next couple of days and report back where any performance improvements were realized.  <br /><br />einstein I'm intrigued by your finding that saving the 'fc' output to a file and then FOR'ing the file is faster than FOR'ing the 'fc' command output directly.  Intuition would lead me to believe the opposite, since my way removes the need for extra file I/Os, but we've all written enough batch to know intuition is seldom useful <img class="smilies" src="images/smilies/icon_wink.gif" alt=":wink:" title="Wink" />  Do you think it might have something to do with filling up the ENV size since my way processes the output in memory?  I will absolutely time test your approach and it'd be great if it does make the timing more linear for large files.<br /><br />Also Aacini, I'm glad to see you back again.  The help you gave me on my AES script was unbelievable, and I see a couple things you've done below that remind me of those previous contributions.  Maybe I'll remember all these tips for whatever 3rd algorithm I tackle  <img class="smilies" src="images/smilies/icon_lol.gif" alt=":lol:" title="Laughing" /> <br /><br />Not to forget carlos, thank you for pointing out my sloppiness with the quotes.  Not that it's an excuse, but my first cut at this script processed files only, and then before posting it to the forum I quickly tacked on the ability to process strings by writing a file and calling it recursively.  I clearly didn't re-check the script with a spaced filename after that change, good catch!</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p34192" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile34192">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistc2fd.html?mode=viewprofile&amp;u=4985" class="username">Magialisk</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search6f26.html?author_id=4985&amp;sr=posts">104</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 25 Jul 2013 19:00</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content34192">

						<h3 ><a href="#p34192">Re: MD5 Message-Digest Algorithm</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingb9f7.html?mode=quote&amp;f=3&amp;p=34192" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic5687.html?p=34192#p34192" onclick="prompt('Message #7',this.href); return false;">#7</a></span> 
									<a class="unread" href="viewtopic5687.html?p=34192#p34192" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistc2fd.html?mode=viewprofile&amp;u=4985" class="username">Magialisk</a></strong> &raquo; </span>04 May 2014 00:10
			</p>
			
			
			
			<div class="content">Well I hate to double post but I couldn't stand the wait before testing out the suggestions and posting back.<br /><br />First I looked over Aacini's code and when I hit this one line I just about fell off my chair:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>set /a &quot;rShiftAmt=32-Shift&#91;%%i&#93;, tempB=((X &amp; 0x7FFFFFFF)&gt;&gt;rShiftAmt) + (1&lt;&lt;(31-rShiftAmt))&quot;</code></pre></div> The elegance of that one line in place of 4-5 of mine was jarring, I really wish I'd thought of that instead of the clunky &quot;powers of 2&quot; lookup table.  This forum needs the emoticon for bowing <img class="smilies" src="images/smilies/icon_lol.gif" alt=":lol:" title="Laughing" /><br /><br />In any case I cut/paste Aacini's code as is and ran it, but got a syntax error. This line needs to have the 'recursed' in !!'s instead of %%'s, after that it ran great:<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>IF NOT &quot;%~2&quot;==&quot;&quot; IF NOT %recursed%==true (ENDLOCAL&amp; set %~2=%md5Digest%) ELSE (ENDLOCAL&amp; set md5Digest=%md5Digest%)</code></pre></div>  With Aacini's code, tests 1-5 in the test suite run in 15-19 ms, compared to my original code's 17-22 ms.  Tests 6 and 7 run in 27-28 ms instead of 31-32 ms.  The test of a 1K file came down from 1.73s to 1.48s.  So all around it's a 12-15% improvement in speed.  Can't thank you enough Aacini!<br /><br />Unfortunately the scaling with large files was still not great, with the 100k file taking 4m8s, down from 4m30s.  That's only an 8% improvement over my own code, still appreciated but clearly not as good as with the small messages.  <br /><br />Alas this is where einstein's code came to the rescue.  After changing the FOR loop to process a 2nd temp file as he suggested, the test of a 100k file completed in only 2m15s!  That's exactly 50% off the time it took my original code, and technically slightly better than linear scaling (1.47s / 1k = 2m27s / 100k, and he beat that!) <br /><br />You guys are really fantastic.  I don't expect there's much more to squeeze out of such a simplistic algorithm, but I really appreciate these inputs.  I'll look over the code a bit more and sometime in the next couple days update the first post with the newer faster source in case anyone wants to use it.  <br /><br />Speaking of &quot;using it&quot;, both einstein and I did point out that md5 is seriously cryptographically weakened, so I can't with good conscience tell you to go protect your passwords with it.  However it's still orders of magnitude better than the silly obfuscation techniques thrown around in the &quot;string encoding&quot; thread linked above.  And of course, while they're intended for completely different purposes, if you'd like something seriously strong cryptographically, there's always the AES script <img class="smilies" src="images/smilies/icon_wink.gif" alt=":wink:" title="Wink" /></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p34197" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile34197">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlista071.html?mode=viewprofile&amp;u=3864" class="username">einstein1969</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searche2bd.html?author_id=3864&amp;sr=posts">762</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 15 Jun 2012 13:16</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Italy, Rome</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content34197">

						<h3 ><a href="#p34197">Re: MD5 Message-Digest Algorithm</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting05db.html?mode=quote&amp;f=3&amp;p=34197" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopiccf44.html?p=34197#p34197" onclick="prompt('Message #8',this.href); return false;">#8</a></span> 
									<a class="unread" href="viewtopiccf44.html?p=34197#p34197" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlista071.html?mode=viewprofile&amp;u=3864" class="username">einstein1969</a></strong> &raquo; </span>04 May 2014 06:14
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>Magailisk wrote:</cite> I don't expect there's much more to squeeze out of such a simplistic algorithm, but I really appreciate these inputs. I'll look over the code a bit more and sometime in the next couple days update the first post with the newer faster source in case anyone wants to use it.<br /><br />Speaking of &quot;using it&quot;, both einstein and I did point out that md5 is seriously cryptographically weakened, so I can't with good conscience tell you to go protect your passwords with it. However it's still orders of magnitude better than the silly obfuscation techniques thrown around in the &quot;string encoding&quot; thread linked above. And of course, while they're intended for completely different purposes, if you'd like something seriously strong cryptographically, there's always the AES script.<br /></div></blockquote><br /><br />I think that you could instead get a lot!! And with the experience here could also further optimize the AES algorithm in terms of performance.<br />There are some parts that you can put code a bit more complex and use other tricks to push the limits of the batch. Otherwise we can say that is not the batch to be slow but we are a bit lazy in discovering its hidden spots.<br /><br />For example: how much it costs to run this operation?<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>set /a&nbsp; a = 1 + 1<br /></code></pre></div><br /><br />at best about 68 micro seconds on my system.<br /><br />with the trick of the depletion of the environment costs only 26 micro seconds. About 2,6-2,8X faster.<br /><br />Moreover, even if some things do not parallelizable can be put in the pipeline. In addition, the For / F is not always the fastest way to read a file, etc. ...<br /><br />Also you did not answer my first question: is it possible to avoid the lookup tables as the CRC32?<br /><br />einstein1969</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p34200" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile34200">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistc2fd.html?mode=viewprofile&amp;u=4985" class="username">Magialisk</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search6f26.html?author_id=4985&amp;sr=posts">104</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 25 Jul 2013 19:00</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content34200">

						<h3 ><a href="#p34200">Re: MD5 Message-Digest Algorithm</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting5fb8.html?mode=quote&amp;f=3&amp;p=34200" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic9416.html?p=34200#p34200" onclick="prompt('Message #9',this.href); return false;">#9</a></span> 
									<a class="unread" href="viewtopic9416.html?p=34200#p34200" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistc2fd.html?mode=viewprofile&amp;u=4985" class="username">Magialisk</a></strong> &raquo; </span>04 May 2014 09:22
			</p>
			
			
			
			<div class="content">Sorry I overlooked your question einstein.  I didn't quite understand it the first time I guess, but I do now.  In fact this same discussion came up after posting my AES code.  With just about any algorithm there is going to be a way to calculate numbers directly instead of using a lookup table, and the situation this creates is called a time-memory tradeoff.<br /><br />Using the lookup table is trading off large memory consumption in order to save time, since the program does not have to calculate the values at runtime.  Granted with cmd, unlike most normal languages, the increased ENV size slows the program down, but still not enough to be worse than calculating directly.  The lookup table should always be faster executing than a real-time calculation of the same constants.  The real-time calculation on the other hand is trading off slower execution in order to save memory.  A couple lines of code (a few dozen bytes?) can replace a whole lookup table containing hundreds of entries of a dozen bytes each.  You might get a memory savings of 2 orders of magnitude if you're working on a such a constrained system where that would be a major advantage.  Unfortunately the code will run much slower for it.<br /><br />On the AES algorithm we went through a couple iterations of this tradeoff with both the S-Box definitions and the Rijndael-Galois Field constants.  Check out this post and the two that follow it regarding my change from a macro to calculate Galois constants, to a lookup table, which reduced execution time by 90%:  <!-- l --><a class="postlink-local" href="viewtopicdac9.html?p=28045#p28045">viewtopic.php?p=28045#p28045</a><!-- l -->.  While the lookup tables were always faster, several people suggested different ways to define the lookup tables that were themselves faster than my initial naive approaches.  jeb for example suggested a long string map, similar in concept to the '01-Jan;02-Feb;03-Mar' maps seen elsewhere on this site, and I believe it was Aacini? that suggested the FOR loop to build an array.  Previously I'd been using an array, but building it manually with a set statement for each element.  That FOR loop turned out to be the best tradeoff in my opinion of code size and code speed for building loookup tables in AES, so I used it again here.<br /><br />To address your question directly though, if you look at the wikipedia page they do provide the psuedocode formula you'd use to calculate the integer parts of the sines of integers:<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>//Use binary integer part of the sines of integers (Radians) as constants:<br />for i from 0 to 63<br />&nbsp; &nbsp; K&#91;i&#93; := floor(abs(sin(i + 1)) × (2 pow 32))<br />end for<br />//(Or just use the following table):<br />K&#91; 0.. 3&#93; := { 0xd76aa478, 0xe8c7b756, 0x242070db, 0xc1bdceee }<br />K&#91; 4.. 7&#93; := { 0xf57c0faf, 0x4787c62a, 0xa8304613, 0xfd469501 }<br />K&#91; 8..11&#93; := { 0x698098d8, 0x8b44f7af, 0xffff5bb1, 0x895cd7be }<br />K&#91;12..15&#93; := { 0x6b901122, 0xfd987193, 0xa679438e, 0x49b40821 }<br />K&#91;16..19&#93; := { 0xf61e2562, 0xc040b340, 0x265e5a51, 0xe9b6c7aa }<br />K&#91;20..23&#93; := { 0xd62f105d, 0x02441453, 0xd8a1e681, 0xe7d3fbc8 }<br />K&#91;24..27&#93; := { 0x21e1cde6, 0xc33707d6, 0xf4d50d87, 0x455a14ed }<br />K&#91;28..31&#93; := { 0xa9e3e905, 0xfcefa3f8, 0x676f02d9, 0x8d2a4c8a }<br />K&#91;32..35&#93; := { 0xfffa3942, 0x8771f681, 0x6d9d6122, 0xfde5380c }<br />K&#91;36..39&#93; := { 0xa4beea44, 0x4bdecfa9, 0xf6bb4b60, 0xbebfbc70 }<br />K&#91;40..43&#93; := { 0x289b7ec6, 0xeaa127fa, 0xd4ef3085, 0x04881d05 }<br />K&#91;44..47&#93; := { 0xd9d4d039, 0xe6db99e5, 0x1fa27cf8, 0xc4ac5665 }<br />K&#91;48..51&#93; := { 0xf4292244, 0x432aff97, 0xab9423a7, 0xfc93a039 }<br />K&#91;52..55&#93; := { 0x655b59c3, 0x8f0ccc92, 0xffeff47d, 0x85845dd1 }<br />K&#91;56..59&#93; := { 0x6fa87e4f, 0xfe2ce6e0, 0xa3014314, 0x4e0811a1 }<br />K&#91;60..63&#93; := { 0xf7537e82, 0xbd3af235, 0x2ad7d2bb, 0xeb86d391 }</code></pre></div> So instead of creating the lookup tables what you'd have to do is change this line of code <div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>set /a X=!digA'!+!F!+!Radians&#91;%%i&#93;!+!msg!</code></pre></div> and replace the !Radians[%%i]! lookup with a real-time calculation of 'floor(abs(sin(%%i + 1)) × (2^32))'.<br />There is another thread on this forum regarding fast methods of calculating sine in a batch, that would be a good place to start.  There's another thread or two on implementing floating point arithmetic in batch that might help get past the multiplication by 2^32 which would otherwise be too large for cmd's 32-bit variables.  However, as I'm sure is coming into focus by now, it's always going to be much faster to dereference a pre-created variable like !Radians[%%i]! than to calculate the sin of a number, absolute value it, round it down, and then perform floating point math on it <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /><br /><br />Thank you again though for your suggestions, especially that neat trick parsing a temp file instead of a command output.  I can't believe how much of a speed difference that made on large hashes!</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p34210" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile34210">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlista071.html?mode=viewprofile&amp;u=3864" class="username">einstein1969</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searche2bd.html?author_id=3864&amp;sr=posts">762</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 15 Jun 2012 13:16</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Italy, Rome</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content34210">

						<h3 ><a href="#p34210">Re: MD5 Message-Digest Algorithm</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting711c.html?mode=quote&amp;f=3&amp;p=34210" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopica1e0.html?p=34210#p34210" onclick="prompt('Message #10',this.href); return false;">#10</a></span> 
									<a class="unread" href="viewtopica1e0.html?p=34210#p34210" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlista071.html?mode=viewprofile&amp;u=3864" class="username">einstein1969</a></strong> &raquo; </span>05 May 2014 03:42
			</p>
			
			
			
			<div class="content">I have reading. The lookup table in most cases are good, in other cases no. You have to do some testing. <br /><br />For example the lookup table for floor(abs(sin(%%i)*2^32)) is good if the implementation in dos batch is poor.<br /><br />How implement in dos Batch?  <img class="smilies" src="images/smilies/icon_cry.gif" alt=":cry:" title="Crying or Very sad" />  There are many method. I have developed various sin functions with mclaurin series expansion and cordic but the precision is not enoght for this cases.<br /><br />So it would be better to abandon this path...<br /><br />But... we need to calculate:<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>sin(1)<br />sin(2)<br />...<br />sin(64)<br /></code></pre></div><br /><br />and sin(n+1) = sin(n) * cos(1) + cos(n) * sin(1)<br /><br />namely using the first element of lookup table we can calculate the next with 2 mul and 1 add.<br /><br />Then &quot; * 2^32 &quot; is shift left 32 . This is no complex operation! this is copy from 4Byte to another 4Byte (is not quite so ... but ...)<br /><br />The number to multiply are near bigger for dos math. But if necessary is possible use the <strong class="text-strong">karatsuba </strong> method... I have worked for the first time in this <a href="http://ss64.org/viewtopic.php?id=1838" class="postlink">Problems with decimal point in my calculator program</a>.<br /><br />But I think this path is still too tortuous...<br /><br />I have make some optimizations and for now i passed from 530Byte/s to 560Byte/s but I think you could double the speed without lookup tables!<br /><br />EDIT:passed to 630Byte/s<br /><br />einstein1969</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p34264" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile34264">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlista071.html?mode=viewprofile&amp;u=3864" class="username">einstein1969</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searche2bd.html?author_id=3864&amp;sr=posts">762</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 15 Jun 2012 13:16</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Italy, Rome</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content34264">

						<h3 ><a href="#p34264">Re: MD5 Message-Digest Algorithm</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingb657-2.html?mode=quote&amp;f=3&amp;p=34264" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicafbc.html?p=34264#p34264" onclick="prompt('Message #11',this.href); return false;">#11</a></span> 
									<a class="unread" href="viewtopicafbc.html?p=34264#p34264" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlista071.html?mode=viewprofile&amp;u=3864" class="username">einstein1969</a></strong> &raquo; </span>07 May 2014 13:12
			</p>
			
			
			
			<div class="content">Hi Magialisk!<br /><br />I'm working on the subroutine that processes the md5. I tweaked the code and there is a significant increase in performance. (I have doubled!)<br /><br />In order to reach high performance I had, however, use of different variable names (but looks like the RFC document) and I had to rewrite the code, which is less elegant and redundant but it was necessary.<br /><br />This is the part that calculate the round 1 and round 2 (function G). Round 3 and 4 have minimal trick but work more speed and is compact code. I have to finish the rest....<br /><br />This can be optimized further but i think that should first finish this step.<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>:: Rif: http://en.wikipedia.org/wiki/MD5<br />::&nbsp; &nbsp; &nbsp; http://www.ietf.org/rfc/rfc1321.txt<br />(<br />:do_md5_fast<br />setlocal<br /><br />set block=%~1<br /><br />:: Break the input block into sixteen 32-bit words<br />set &quot;a=0&quot; &amp; For /L %%a in (120,-8,0) DO set /a M_!a!=0x!block:~%%a,8!, a+=1<br /><br />:: Initialize this chunk's digest to the running digest value<br />set /a A=!digA0!, B=!digB0!, C=!digC0!, D=!digD0!<br /><br />:: Round 1<br /><br />:: F = (b &amp; c) | ((~b) &amp; d)<br />:: 7 12 17 22<br /><br />:: Rotate-Shift = 7<br />:: X = A + %_F_% + Radians_0 + M_0, A = B + ( X &lt;&lt; 7 | ( (X &amp; 0x7FFFFFFF) &gt;&gt; 32-7 ) + ( X &gt;&gt; 31 &amp; 1 &lt;&lt; 7-1 ) )&quot;<br /><br />:: Merge two line of SET /A into one to increase performance.<br />(<br />set /a &quot;? = A + ( B &amp; C | ~B &amp; D ) + 0xd76aa478 + M_0 , A = B + ( (? &lt;&lt;&nbsp; 7) | ((? &amp; 0x7FFFFFFF) &gt;&gt; 25) ) + ( ?&gt;&gt;31 &amp; 0x40 )&quot;<br />set /a &quot;? = D + ( A &amp; B | ~A &amp; C ) + 0xe8c7b756 + M_1 , D = A + ( (? &lt;&lt; 12) | ((? &amp; 0x7FFFFFFF) &gt;&gt; 20) ) + ( ?&gt;&gt;31 &amp; 0x800 )&quot;<br />set /a &quot;? = C + ( D &amp; A | ~D &amp; B ) + 0x242070db + M_2 , C = D + ( (? &lt;&lt; 17) | ((? &amp; 0x7FFFFFFF) &gt;&gt; 15) ) + ( ?&gt;&gt;31 &amp; 0x10000 )&quot;<br />set /a &quot;? = B + ( C &amp; D | ~C &amp; A ) + 0xc1bdceee + M_3 , B = C + ( (? &lt;&lt; 22) | ((? &amp; 0x7FFFFFFF) &gt;&gt; 10) ) + ( ?&gt;&gt;31 &amp; 0x200000 )&quot;<br />set /a &quot;? = A + ( B &amp; C | ~B &amp; D ) + 0xf57c0faf + M_4 , A = B + ( (? &lt;&lt;&nbsp; 7) | ((? &amp; 0x7FFFFFFF) &gt;&gt; 25) ) + ( ?&gt;&gt;31 &amp; 0x40 )&quot;<br />set /a &quot;? = D + ( A &amp; B | ~A &amp; C ) + 0x4787c62a + M_5 , D = A + ( (? &lt;&lt; 12) | ((? &amp; 0x7FFFFFFF) &gt;&gt; 20) ) + ( ?&gt;&gt;31 &amp; 0x800 )&quot;<br />set /a &quot;? = C + ( D &amp; A | ~D &amp; B ) + 0xa8304613 + M_6 , C = D + ( (? &lt;&lt; 17) | ((? &amp; 0x7FFFFFFF) &gt;&gt; 15) ) + ( ?&gt;&gt;31 &amp; 0x10000 )&quot;<br />set /a &quot;? = B + ( C &amp; D | ~C &amp; A ) + 0xfd469501 + M_7 , B = C + ( (? &lt;&lt; 22) | ((? &amp; 0x7FFFFFFF) &gt;&gt; 10) ) + ( ?&gt;&gt;31 &amp; 0x200000 )&quot;<br />set /a &quot;? = A + ( B &amp; C | ~B &amp; D ) + 0x698098d8 + M_8 , A = B + ( (? &lt;&lt;&nbsp; 7) | ((? &amp; 0x7FFFFFFF) &gt;&gt; 25) ) + ( ?&gt;&gt;31 &amp; 0x40 )&quot;<br />set /a &quot;? = D + ( A &amp; B | ~A &amp; C ) + 0x8b44f7af + M_9 , D = A + ( (? &lt;&lt; 12) | ((? &amp; 0x7FFFFFFF) &gt;&gt; 20) ) + ( ?&gt;&gt;31 &amp; 0x800 )&quot;<br />set /a &quot;? = C + ( D &amp; A | ~D &amp; B ) + 0xffff5bb1 + M_10, C = D + ( (? &lt;&lt; 17) | ((? &amp; 0x7FFFFFFF) &gt;&gt; 15) ) + ( ?&gt;&gt;31 &amp; 0x10000 )&quot;<br />set /a &quot;? = B + ( C &amp; D | ~C &amp; A ) + 0x895cd7be + M_11, B = C + ( (? &lt;&lt; 22) | ((? &amp; 0x7FFFFFFF) &gt;&gt; 10) ) + ( ?&gt;&gt;31 &amp; 0x200000 )&quot;<br />set /a &quot;? = A + ( B &amp; C | ~B &amp; D ) + 0x6b901122 + M_12, A = B + ( (? &lt;&lt;&nbsp; 7) | ((? &amp; 0x7FFFFFFF) &gt;&gt; 25) ) + ( ?&gt;&gt;31 &amp; 0x40 )&quot;<br />set /a &quot;? = D + ( A &amp; B | ~A &amp; C ) + 0xfd987193 + M_13, D = A + ( (? &lt;&lt; 12) | ((? &amp; 0x7FFFFFFF) &gt;&gt; 20) ) + ( ?&gt;&gt;31 &amp; 0x800 )&quot;<br />set /a &quot;? = C + ( D &amp; A | ~D &amp; B ) + 0xa679438e + M_14, C = D + ( (? &lt;&lt; 17) | ((? &amp; 0x7FFFFFFF) &gt;&gt; 15) ) + ( ?&gt;&gt;31 &amp; 0x10000 )&quot;<br />set /a &quot;? = B + ( C &amp; D | ~C &amp; A ) + 0x49b40821 + M_15, B = C + ( (? &lt;&lt; 22) | ((? &amp; 0x7FFFFFFF) &gt;&gt; 10) ) + ( ?&gt;&gt;31 &amp; 0x200000 )&quot;<br />)<br /><br />:: Round 2<br /><br />:: 5&nbsp; 9 14 20<br />:: G = (B &amp; D) | (C &amp; (~D) )<br /><br />(<br />set /a &quot;? = A + ( B &amp; D | C &amp; ~D ) + 0xf61e2562 + M_1 , A = B + ( (? &lt;&lt;&nbsp; 5) | ((? &amp; 0x7FFFFFFF) &gt;&gt; 27) ) + ( ?&gt;&gt;31 &amp; 0x10 )&quot;<br />set /a &quot;? = D + ( A &amp; C | B &amp; ~C ) + 0xc040b340 + M_6 , D = A + ( (? &lt;&lt;&nbsp; 9) | ((? &amp; 0x7FFFFFFF) &gt;&gt; 23) ) + ( ?&gt;&gt;31 &amp; 0x100 )&quot;<br />set /a &quot;? = C + ( D &amp; B | A &amp; ~B ) + 0x265e5a51 + M_11, C = D + ( (? &lt;&lt; 14) | ((? &amp; 0x7FFFFFFF) &gt;&gt; 18) ) + ( ?&gt;&gt;31 &amp; 0x2000 )&quot;<br />set /a &quot;? = B + ( C &amp; A | D &amp; ~A ) + 0xe9b6c7aa + M_0 , B = C + ( (? &lt;&lt; 20) | ((? &amp; 0x7FFFFFFF) &gt;&gt; 12) ) + ( ?&gt;&gt;31 &amp; 0x80000 )&quot;<br />set /a &quot;? = A + ( B &amp; D | C &amp; ~D ) + 0xd62f105d + M_5 , A = B + ( (? &lt;&lt;&nbsp; 5) | ((? &amp; 0x7FFFFFFF) &gt;&gt; 27) ) + ( ?&gt;&gt;31 &amp; 0x10 )&quot;<br />set /a &quot;? = D + ( A &amp; C | B &amp; ~C ) + 0x02441453 + M_10, D = A + ( (? &lt;&lt;&nbsp; 9) | ((? &amp; 0x7FFFFFFF) &gt;&gt; 23) ) + ( ?&gt;&gt;31 &amp; 0x100 )&quot;<br />set /a &quot;? = C + ( D &amp; B | A &amp; ~B ) + 0xd8a1e681 + M_15, C = D + ( (? &lt;&lt; 14) | ((? &amp; 0x7FFFFFFF) &gt;&gt; 18) ) + ( ?&gt;&gt;31 &amp; 0x2000 )&quot;<br />set /a &quot;? = B + ( C &amp; A | D &amp; ~A ) + 0xe7d3fbc8 + M_4 , B = C + ( (? &lt;&lt; 20) | ((? &amp; 0x7FFFFFFF) &gt;&gt; 12) ) + ( ?&gt;&gt;31 &amp; 0x80000 )&quot;<br />set /a &quot;? = A + ( B &amp; D | C &amp; ~D ) + 0x21e1cde6 + M_9 , A = B + ( (? &lt;&lt;&nbsp; 5) | ((? &amp; 0x7FFFFFFF) &gt;&gt; 27) ) + ( ?&gt;&gt;31 &amp; 0x10 )&quot;<br />set /a &quot;? = D + ( A &amp; C | B &amp; ~C ) + 0xc33707d6 + M_14, D = A + ( (? &lt;&lt;&nbsp; 9) | ((? &amp; 0x7FFFFFFF) &gt;&gt; 23) ) + ( ?&gt;&gt;31 &amp; 0x100 )&quot;<br />set /a &quot;? = C + ( D &amp; B | A &amp; ~B ) + 0xf4d50d87 + M_3 , C = D + ( (? &lt;&lt; 14) | ((? &amp; 0x7FFFFFFF) &gt;&gt; 18) ) + ( ?&gt;&gt;31 &amp; 0x2000 )&quot;<br />set /a &quot;? = B + ( C &amp; A | D &amp; ~A ) + 0x455a14ed + M_8 , B = C + ( (? &lt;&lt; 20) | ((? &amp; 0x7FFFFFFF) &gt;&gt; 12) ) + ( ?&gt;&gt;31 &amp; 0x80000 )&quot;<br />set /a &quot;? = A + ( B &amp; D | C &amp; ~D ) + 0xa9e3e905 + M_13, A = B + ( (? &lt;&lt;&nbsp; 5) | ((? &amp; 0x7FFFFFFF) &gt;&gt; 27) ) + ( ?&gt;&gt;31 &amp; 0x10 )&quot;<br />set /a &quot;? = D + ( A &amp; C | B &amp; ~C ) + 0xfcefa3f8 + M_2 , D = A + ( (? &lt;&lt;&nbsp; 9) | ((? &amp; 0x7FFFFFFF) &gt;&gt; 23) ) + ( ?&gt;&gt;31 &amp; 0x100 )&quot;<br />set /a &quot;? = C + ( D &amp; B | A &amp; ~B ) + 0x676f02d9 + M_7 , C = D + ( (? &lt;&lt; 14) | ((? &amp; 0x7FFFFFFF) &gt;&gt; 18) ) + ( ?&gt;&gt;31 &amp; 0x2000 )&quot;<br />set /a &quot;? = B + ( C &amp; A | D &amp; ~A ) + 0x8d2a4c8a + M_12, B = C + ( (? &lt;&lt; 20) | ((? &amp; 0x7FFFFFFF) &gt;&gt; 12) ) + ( ?&gt;&gt;31 &amp; 0x80000 )&quot;<br />)<br /><br />set /a digA'=!A!, digB'=!B!, digC'=!C!, digD'=!D!<br /><br />:: Round 3<br />:: 4, 11, 16, 23<br />:: H = b ^ c ^ d<br /><br />FOR /L %%i IN (32,1,47) DO (<br /><br />&nbsp; &nbsp;set /a &quot;S=4+%%i %% 2*7+12*(%%i&gt;&gt;1&amp;1), F=!digB'! ^^ !digC'! ^^ !digD'!, g=(3*%%i+5)%%16, tempD=!digD'!, digD'=!digC'!, digC'=!digB'!&quot;<br /><br />&nbsp; &nbsp;set /a &quot;X=digA'+F+!Radians&#91;%%i&#93;!+M_!g!, digB'+=((X &lt;&lt; S) | ((X &amp; 0x7FFFFFFF) &gt;&gt; (32-S)))+( (X&gt;&gt;31) &amp; (1&lt;&lt; (S-1)) ), digA'=tempD&quot;<br /><br />)<br /><br />:: Round 4<br />:: 6, 10, 15, 21<br />:: I = c ^ (b | (~d))<br /><br />FOR /L %%i IN (48,1,63) DO (<br /><br />&nbsp; &nbsp;set /a &quot;S=(%%i %% 4+2)*(%%i %% 4+5)/2+1, F=!digC'! ^^ (!digB'! | ~!digD'!), g=(7*%%i)%%16, tempD=!digD'!, digD'=!digC'!, digC'=!digB'!&quot;<br /><br />&nbsp; &nbsp;set /a &quot;X=digA'+F+!Radians&#91;%%i&#93;!+M_!g!, digB'+=((X &lt;&lt; S) | ((X &amp; 0x7FFFFFFF) &gt;&gt; (32-S)))+( (X&gt;&gt;31) &amp; (1&lt;&lt; (S-1)) ), digA'=tempD&quot;<br /><br />)<br /><br />)<br /><br />:: Add this chunk's result to the running digest value<br />rem set /a digA0+=!digA'!, digB0+=!digB'!, digC0+=!digC'!, digD0+=!digD'!<br />(endlocal &amp; set /a digA0+=%digA'%, digB0+=%digB'%, digC0+=%digC'%, digD0+=%digD'%)<br /><br />exit /b<br /></code></pre></div><br /><br />You can add this subroutine in the main and it should work. Even if it is to be finished the performance tuning...<br /><br />EDIT : Add complete subroutine code<br /><br />einstein1969</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p34293" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile34293">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistc2fd.html?mode=viewprofile&amp;u=4985" class="username">Magialisk</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search6f26.html?author_id=4985&amp;sr=posts">104</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 25 Jul 2013 19:00</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content34293">

						<h3 ><a href="#p34293">Re: MD5 Message-Digest Algorithm</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting36b7.html?mode=quote&amp;f=3&amp;p=34293" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicee15-2.html?p=34293#p34293" onclick="prompt('Message #12',this.href); return false;">#12</a></span> 
									<a class="unread" href="viewtopicee15-2.html?p=34293#p34293" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistc2fd.html?mode=viewprofile&amp;u=4985" class="username">Magialisk</a></strong> &raquo; </span>09 May 2014 00:32
			</p>
			
			
			
			<div class="content">Einstein that code is insane! I can't even understand what it does anymore <img class="smilies" src="images/smilies/icon_lol.gif" alt=":lol:" title="Laughing" /> <br /><br />As you stated, the timing improvement is quite large so far.  Tests 1-5 in the test suite run in 11-16ms, down from Aacini's 15-19 ms. Tests 6 and 7 run in 18-21 ms instead of 27-28 ms. The test of a 1K file came down from 1.48s to 0.92s. And the test of a 100k file came down from 2m15s to 1m24s!<br /><br />I will definitely have to study your code to learn how you've done this.  It seems like you were smart to break the 4 individual rounds into their own segments rather than handling the whole 0-63 operations loop in one pass.  Within a given round the operations are identically defined, so there was lots of extraneous logic you were able to cut out that way.<br /><br />Thank you again for all the time you've put into improving this.  I can't wait to see the finished product!</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p34294" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile34294">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistcb12.html?mode=viewprofile&amp;u=1621" class="username">carlos</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchda66.html?author_id=1621&amp;sr=posts">472</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 20 Aug 2010 13:57</dd>		
		
																<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Chile</dd>
							
							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact carlos">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact carlos</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="https://web.archive.org/web/20180902091521/http://consolesoft.com/" title="Website" class="last-cell">
										<span class="contact-icon phpbb_website-icon">Website</span>
									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content34294">

						<h3 ><a href="#p34294">Re: MD5 Message-Digest Algorithm</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting6f03-2.html?mode=quote&amp;f=3&amp;p=34294" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopica43f.html?p=34294#p34294" onclick="prompt('Message #13',this.href); return false;">#13</a></span> 
									<a class="unread" href="viewtopica43f.html?p=34294#p34294" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistcb12.html?mode=viewprofile&amp;u=1621" class="username">carlos</a></strong> &raquo; </span>09 May 2014 01:49
			</p>
			
			
			
			<div class="content">@einstein1969: your code works ok?. I not read all, but I suspect that something may wrong because the c code in the rfc use unsigned int, and cmd use signed int.<br /><br />For example: this:<br />0xd76aa478<br />is<br />3614090360<br />but for cmd is:<br />-680876936<br /><br />Also, I always get code from netbsd and adapt it. Is very portable and easy of adapt (I get a rot13 and sha1 function from the netbsd code adapted to a program that run over windows). I never look wikipedia for implementations, I look these sources, because the license is really good (bsd or even beerware) and are really stables. <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br />Here you can get a c implementation but it also use unsigned int.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>http://cvsweb.netbsd.org/bsdweb.cgi/src/external/bsd/bind/dist/lib/isc/md5.c?only_with_tag=MAIN</code></pre></div><br />also, openbsd implementation:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>http://www.openbsd.org/cgi-bin/cvsweb/src/sys/crypto/md5.c</code></pre></div><br />look the latest revisions.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p34323" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile34323">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlista071.html?mode=viewprofile&amp;u=3864" class="username">einstein1969</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searche2bd.html?author_id=3864&amp;sr=posts">762</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 15 Jun 2012 13:16</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Italy, Rome</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content34323">

						<h3 ><a href="#p34323">Re: MD5 Message-Digest Algorithm</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingcdbe.html?mode=quote&amp;f=3&amp;p=34323" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic09c7.html?p=34323#p34323" onclick="prompt('Message #14',this.href); return false;">#14</a></span> 
									<a class="unread" href="viewtopic09c7.html?p=34323#p34323" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlista071.html?mode=viewprofile&amp;u=3864" class="username">einstein1969</a></strong> &raquo; </span>09 May 2014 20:36
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>carlos wrote:</cite>@einstein1969: your code works ok?. I not read all, but I suspect that something may wrong because the c code in the rfc use unsigned int, and cmd use signed int.<br /><br />For example: this:<br />0xd76aa478<br />is<br />3614090360<br />but for cmd is:<br />-680876936<br /><br />Also, I always get code from netbsd and adapt it. Is very portable and easy of adapt (I get a rot13 and sha1 function from the netbsd code adapted to a program that run over windows). I never look wikipedia for implementations, I look these sources, because the license is really good (bsd or even beerware) and are really stables. <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br />Here you can get a c implementation but it also use unsigned int.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>http://cvsweb.netbsd.org/bsdweb.cgi/src/external/bsd/bind/dist/lib/isc/md5.c?only_with_tag=MAIN</code></pre></div><br />also, openbsd implementation:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>http://www.openbsd.org/cgi-bin/cvsweb/src/sys/crypto/md5.c</code></pre></div><br />look the latest revisions.</div></blockquote><br /><br />Thanks Carlos for the info.  <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" />  I have see the code and seem ok with this version. For the future i look in this repo!<br /><br />For the signed integer i study for possible problem...<br /><br />Seem that the information is intact<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&gt;cmd /c exit -680876936 &amp; call echo %^=exitCode%<br />D76AA478<br /><br />&gt;set /a -680876936+1<br />-680876935<br /><br />&gt;cmd /c exit -680876935 &amp; call echo %^=exitCode%<br />D76AA479<br /></code></pre></div> <br /><br />The operation on this type of info is sum(+), And (&amp;), Xor, or, not, shift (&lt;&lt;, &gt;&gt;) <br />The only prolematic is &gt;&gt; but there is a patch in the code<br /><br />i thinking about this value  <img class="smilies" src="images/smilies/icon_confused.gif" alt=":?" title="Confused" /> :<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&gt;cmd /c exit -2147483648 &amp; call echo %^=exitCode%<br />80000000<br /><br />&gt;cmd /c exit 2147483648 &amp; call echo %^=exitCode%<br />80000000<br /></code></pre></div><br /><br />but there is not in the initial data...  is sufficient ?  <img class="smilies" src="images/smilies/icon_question.gif" alt=":?:" title="Question" /> <br /><br /><br />einstein1969</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p34336" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile34336">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistc2fd.html?mode=viewprofile&amp;u=4985" class="username">Magialisk</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search6f26.html?author_id=4985&amp;sr=posts">104</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 25 Jul 2013 19:00</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content34336">

						<h3 ><a href="#p34336">Re: MD5 Message-Digest Algorithm</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingb080.html?mode=quote&amp;f=3&amp;p=34336" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic7b5b.html?p=34336#p34336" onclick="prompt('Message #15',this.href); return false;">#15</a></span> 
									<a class="unread" href="viewtopic7b5b.html?p=34336#p34336" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistc2fd.html?mode=viewprofile&amp;u=4985" class="username">Magialisk</a></strong> &raquo; </span>10 May 2014 09:05
			</p>
			
			
			
			<div class="content">I myself was quite confused about whether the limitation of cmd's signed ints was going to cause a problem since all of the addition in MD5 (anything written as '+' in the algorithm) is actually defined as addition modulo 2^32 on an unsigned integer.  At first I didn't think that this would work properly on a signed integer, and I was chasing a bug I couldn't catch so I thought maybe this was the reason...<br /><br />I hate to say it, but I ended up writing a whole subroutine called &quot;AddMod2_32&quot; to &quot;fix&quot; this problem I'd created in my head.  Only after doing that did I realize that no matter what data I sent through my batch, the result was coming out the same whether I used a normal 'set /a result = !DigA'! + !DigB'! + !Radians[%%i]!' etc. or used my fancy subroutine 'AddMod2_32 result DigA' DigB' Radians[%%i]'.<br /><br />I can't swear that I exhaustively tested every possibility, but I tested the case of adding a negative and a positive number, two negative numbers, and rolling over the 31-bit maximum value in both directions (pos to neg and neg to pos).  I didn't see any issues, so I dejectedly threw away my AddMod2_32 subroutine and looked harder elsewhere for the bug.  If you think about it though, it makes sense that it should work because other than in the right shift, which I wrote a custom operation for we don't care what the decimal number equivalent to the value is.  If you add two binary numbers it doesn't matter whether the MSB &quot;represents&quot; a sign bit or not, the operation will carry out the same and any carry will be thrown away, hence the mod2^32 result.  At least that's what I convinced myself after running my subroutine tests and eventually finding my bug elsewhere <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
	

	<div class="action-bar bar-bottom">
	
			<a href="postinge619.html?mode=reply&amp;f=3&amp;t=5566" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopicb285.html?f=3&amp;t=5566&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

			<form method="post" action="https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=5566">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			22 posts
							<ul>
		<li class="active"><span>1</span></li>
				<li><a class="button" href="viewtopic932f.html?f=3&amp;t=5566&amp;start=15" role="button">2</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopic932f.html?f=3&amp;t=5566&amp;start=15" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="viewforum4d6b.html?f=3" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to “DOS Batch Forum”</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="viewforum31e6.html?f=4" class="jumpbox-cat-link"> <span> DosTips - Dos Batch</span></a></li>
																<li><a href="viewforum4d6b.html?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; DOS Batch Forum</span></a></li>
											</ul>
		</div>
	</div>

	</div>


			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
							<span class="crumb"><a href="../index.html" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>DosTips.com</span></a></span>									<span class="crumb"><a href="index.html" data-navbar-reference="index"><span>Board index</span></a></span>					</li>
		
				<li class="rightside">All times are <span title="UTC-6">UTC-06:00</span></li>
							<li class="rightside">
				<a href="ucp033a.html?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete all board cookies</span>
				</a>
			</li>
												<li class="rightside" data-last-responsive="true">
				<a href="memberlist4bfd.html?mode=team" role="menuitem">
					<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
				</a>
			</li>
									<li class="rightside" data-last-responsive="true">
				<a href="memberlist8733.html?mode=contactadmin" role="menuitem">
					<i class="icon fa-envelope fa-fw" aria-hidden="true"></i><span>Contact us</span>
				</a>
			</li>
			</ul>

	</div>
</div>

	<div class="copyright">
				<!-- WARNING NO DELETE -->Style developer by <a href="http://tricolor.x-tk.ru/">support forum tricolor</a>, <!-- END WARNING NO DELETE -->Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
									</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	<img src="cron5495.gif?cron_type=cron.task.text_reparser.poll_title" width="1" height="1" alt="cron" /></div>

<script type="text/javascript" src="assets/javascript/jquery.mind772.js?assets_version=34"></script>
<script type="text/javascript" src="assets/javascript/cored772.js?assets_version=34"></script>



<script type="text/javascript" src="styles/prosilver/template/forum_fnd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/prosilver/template/ajaxd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/jquery-uid772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/collapsed772.js?assets_version=34"></script>



</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=5566 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 07:20:57 GMT -->
</html>
