<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=8567&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 07:16:55 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>DosTips.com &bull; Length of a string - my first contribution</title>

<link href="styles/AllanStyle-SUBSILVER/theme/print.css" rel="stylesheet">
</head>
<body id="phpbb">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>DosTips.com</h1>
		<p>A Forum all about DOS Batch<br /><a href="index-2.html">https://www.dostips.com/forum/</a></p>

		<h2>Length of a string - my first contribution</h2>
		<p><a href="viewtopicbad8.html?f=3&amp;t=8567">https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=8567</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>1</strong> of <strong>1</strong></div>
					<div class="post">
				<h3>Length of a string - my first contribution</h3>
				<div class="date">Posted: <strong>20 May 2018 16:10</strong></div>
				<div class="author">by <strong>Jan Antonin</strong></div>
				<div class="content">Hi guys!<br>
First I would like to say big Thank You! Thank you dbenham, jeb, Aacini, aGerman and others.<br>
Although I dont use your amazing results at my work nor for making any profit I really appreciate them. It is not only about your results but it is rather about your attitude.<br>
It may sound a little bit theatrically: Thank you for your existence! <img class="smilies" src="images/smilies/icon_smile.gif" width="15" height="15" alt=":-)" title="Smile"> Our world is full of idiots which we have to deal with and it is much easier trying to live my life knowing that somewhere on a planet somebody is thinking the very similar way as myself.<br>
<br>
Many years ago I tried to write my first cmd script and I needed to measure a lenght of a string. Because this forum didnt exist at that time I had to type my own.<br>
At the very same moment I tried to find out what big boys from Microsoft might mean when they talked about "Unicode". I worked with Excel at that time.<br>
<br>
My whole idea was this:<br>
<br>
@set "myVar=qwertyuiop"<br>
@cmd /U /S /D /c set myVar|find /V /N ""<br>
<br>
It is not necessary to write more details at this forum I am sure.<br>
Another obvious option is a switch /C instead of /N<br>
(Btw My biggest problem during those old days was to accept using an empty string with the switch /V. I had no idea that this sort of cripled thinking might exist in IT business at all. It is so obvious to me only by pure logic that empty string is a substring of every string - apparently not obvious for MS. My script without /V worked well and with shorter and shorter string-to search argument the number of found lines went up and up and at he very last step the script stopped working totally - no results at all. I had no idea why, it was very frustrating.<br>
<br>
@cmd /U /S /D /c set myVar|find /V /C ""<br>
<br>
I am almost sure that this method is totally "toxic-character-proof". According to some scripts I have seen at this board I dont dare to say my usual and humble estimate of my own certainty - I mean 100% <img class="smilies" src="images/smilies/icon_smile.gif" width="15" height="15" alt=":-)" title="Smile"><br>
<br>
My second contribution in a few next days will be a small one. How to avoid disaster if any toxic character is in a path of your data and scripts. How to safely call them using CMD command. Yes, I was so naive that I have created my own system of naming backups and incremental backups of all my files and in this system the most frequent character is a ^ carret <img class="smilies" src="images/smilies/icon_smile.gif" width="15" height="15" alt=":-)" title="Smile">. Lucky guy I am. I simply read MS documents and it was written that it is possible and no problem was meant - so I did it. I was young, naive and happy.<br>
<br>
My biggest (not from the pragmatic point of view of course) contribution which I am really proud of will be an ultimate method of obtainig all command line arguments of a sript inside from the script of course. With no compromise, without any temp file. And storing these arguments inside a normal named variable like %myVar%, not %1.<br>
I dont care about the speed (I care but there is no principal difference in a speed - the upper bound of time is polynomial depending on a lenght of an input <img class="smilies" src="images/smilies/icon_smile.gif" width="15" height="15" alt=":-)" title="Smile"> )<br>
I took this goal as my personal chalenge. I have to addmit I almost gave up but finally it is done.<br>
I can say I would have absolutely no chance to create such a script without a knowledge from this forum especially of Jeb, dbenham and Aacini.<br>
<br>
To be honest I dont believe that such a script has not been written till this time. The same feeling I have with the idea of this post - measuring the lenght of a given string. But I tried really hard to search the Web and no success.<br>
If anybody thinks that it would be better to move this post to somewhere where it belongs more I will be pleased.<br>
<br>
Jan Antonin</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Length of a string - my first contribution</h3>
				<div class="date">Posted: <strong>21 May 2018 18:54</strong></div>
				<div class="author">by <strong>penpen</strong></div>
				<div class="content"><blockquote><div><cite><a href="memberlist39bc.html?mode=viewprofile&amp;u=9220">Jan Antonin</a> wrote: <a href="viewtopic9a97.html?p=56828#p56828" data-post-id="56828" onclick="if(document.getElementById(hash.substr(1)))href=hash">↑</a><div class="responsive-hide">20 May 2018 16:10</div></cite>
My whole idea was this:<br>
<br>
@set "myVar=qwertyuiop"<br>
@cmd /U /S /D /c set myVar|find /V /N ""<br>
<br>
(...)<br>
<br>
I am almost sure that this method is totally "toxic-character-proof".</div></blockquote>Hello Jan Antonin and welcome to this forum.<br>
<br>
This approach is not bad, and i used (and still use) a similar script for a long time and it is indeed bullet proof against the usual toxic characters ("()!&amp;|...").<br>
But sad to say you can't use it in any situation: It totally fails for most possible characters.<br>
<br>
The command shell internally encodes characters with UCS-2 (pretty similar to the default unicode UTF-16 le - the difference doesn't matter here).<br>
When you are using the unicode characters U+0000 to U+00FF, then they are encoded as (in hex) "00 00" to "FF 00".<br>
Your approach splits any single 2-byte long characters into 2 1-byte long characters.<br>
The appplication "find.exe" interprets a NUL byte ("00") as a string terminator (which is in use since ansi-c was developed, and is still in use nowadays), and interprets this as a line terminator.<br>
<br>
So your approach will only work with series of characters that have "00" in it (and also these NUL bytes must be at the same position in all characters that shall be counted.)<br>
But unfortunately UCS-2 also supports characters without any partial NUL byte, for example '∑' (U+2211 == "◄), and '∫' (U+222b == "+):
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>D:\&gt;@set "myVar=abc∑∫xyz"

D:\&gt;@cmd /U /S /D /c set myVar|find /V /N ""
[1]m
[2]y
[3]V
[4]a
[5]r
[6]=
[7]a
[8]b
[9]c
[10]◄"+"x
[11]y
[12]z
[13]
[14]
[15]
</code></pre></div>

penpen</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Length of a string - my first contribution</h3>
				<div class="date">Posted: <strong>21 May 2018 21:30</strong></div>
				<div class="author">by <strong>sst</strong></div>
				<div class="content">Besides of problems that may arise as a result of assumptions about unicode encoding which has been addressed by penpen, I can think of some other problems which will prevent the usage of this method as a general purpose string length routine.<br>
This method will fail if<br>
1. LineFeed character is present in string.<br>
2.  There is another environment variable which the first characters of it's name is the same as the target variable name. ex: <strong class="text-strong">myVar</strong> and <strong class="text-strong">myVar1</strong><br>
     Of course It can be resolved using echo in conjunction with delayedExpansion which I think you were trying to avoid by using set in the first place.<br>
<br>
Another problem is, one has know the length of the environment variable name in order to able to obtain length of the string it contains. So it can not be used as is for arbitrary variable names, extra steps are required.<br>
<br>
But I liked the idea, even if it can not be used for this particular purpose.<br>
<br>
About obtaining all command line argument which you said:
<blockquote><div><cite><a href="memberlist39bc.html?mode=viewprofile&amp;u=9220">Jan Antonin</a> wrote: <a href="viewtopic9a97.html?p=56828#p56828" data-post-id="56828" onclick="if(document.getElementById(hash.substr(1)))href=hash">↑</a><div class="responsive-hide">20 May 2018 16:10</div></cite>
My biggest (not from the pragmatic point of view of course) contribution which I am really proud of will be an ultimate method of obtainig all command line arguments of a sript inside from the script of course. With no compromise, without any temp file. And storing these arguments inside a normal named variable like %myVar%, not %1.
</div></blockquote> <br>
Is this something different that if offered by <strong class="text-strong">%*</strong> ? Maybe its too soon and I to wait to see your method.<br>
<br>
Anyway welcome to dostips Jan</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Length of a string - my first contribution</h3>
				<div class="date">Posted: <strong>22 May 2018 03:16</strong></div>
				<div class="author">by <strong>jeb</strong></div>
				<div class="content">Hi Jan,<br>
<br>
like sst I'm interessted in this part.
<blockquote><div><cite><a href="memberlist39bc.html?mode=viewprofile&amp;u=9220">Jan Antonin</a> wrote: <a href="viewtopic9a97.html?p=56828#p56828" data-post-id="56828" onclick="if(document.getElementById(hash.substr(1)))href=hash">↑</a><div class="responsive-hide">20 May 2018 16:10</div></cite>
My biggest (not from the pragmatic point of view of course) contribution which I am really proud of will be an ultimate method of obtainig all command line arguments of a sript inside from the script of course. With no compromise, without any temp file. And storing these arguments inside a normal named variable like %myVar%, not %1.
</div></blockquote>
I thought very often about this and made many tries, but I'm not able to find a solution to avoid the temporary file nor to fetch arguments with embedded line feeds.<br>
And I'm still sure that it's impossible to fetch carriage returns at all, as they are removed directly after the expansion of %1.<br>
<br>
I'm waiting impatiently for your solution  <img class="smilies" src="images/smilies/icon_biggrin.gif" width="15" height="15" alt=":D" title="Very Happy"> <br>
<br>
jeb</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Length of a string - my first contribution</h3>
				<div class="date">Posted: <strong>22 May 2018 03:42</strong></div>
				<div class="author">by <strong>Jan Antonin</strong></div>
				<div class="content">yeah, sure, I always used it only for pure ASCII, it means<br>
00100000 to 01111110 (BTW I always wonder what the hell the purpose for 01111111 was ...)<br>
<br>
I am definitely not a developer, I am only interested.<br>
<br>
about arguments:<br>
Maybe I am totally dumb (it has already happened to me that I couldnt see something evident and spent huge time to make a very complex and totally useless solution, it happens sometimes).<br>
<br>
But how can I obtain arguments in case they contain toxic-characters?<br>
<br>
I remember I have read somewhere a post from jeb, something like "advanced REM technique".<br>
If I rememer well jeb used a temp file.<br>
I didnt and still dont like using a temp file at all.<br>
Not because of a performance but because of beauty <img class="smilies" src="images/smilies/icon_smile.gif" width="15" height="15" alt=":-)" title="Smile"><br>
<br>
And I dont like and I dont wanna know "the iron" below.<br>
For example the trick with a definition of LF is something what I can do inside the script but not output nor input.<br>
[ I cannot ... I am not interested <img class="smilies" src="images/smilies/icon_smile.gif" width="15" height="15" alt=":-)" title="Smile"> ]<br>
<br>
Thats why I love so much a thread here named "parsing rules".<br>
It is totally ok to make a theory where objects like &lt;LF&gt; or &lt;CR&gt; exist. But the theory can be tested only by experiments with ASCII input and output.<br>
I wonder in a connection of this attitude how difficult whould be to take CMD.exe, make a reverse ingeneering and extract THE THEORY directly from materia.<br>
Or to investigate who was the author, then go and kidnap him, waterboard him and finally the result post here <img class="smilies" src="images/smilies/icon_smile.gif" width="15" height="15" alt=":-)" title="Smile"><br>
<br>
I have formulated a theoretical problem for me :<br>
Let's assume that a concatenation of all arguments (= %*) may contain chars of ASCII table in a range 00100000 to 01111110 (I am using this form only to be short, I could simply type a list of all these printable characters).<br>
<br>
The thing is some of them play a role of metachars at CMD syntax.<br>
<br>
The goal is to define a variable myVar for which outputs to a screen of following two commands are equal:<br>
REM %*<br>
REM %myVar%<br>
<br>
without using a temp file.<br>
<br>
It is almost done, only some last details remain ... <img class="smilies" src="images/smilies/icon_smile.gif" width="15" height="15" alt=":-)" title="Smile"></div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="UTC-6">UTC-06:00</span><br />Page <strong>1</strong> of <strong>1</strong></div>
		<div class="copyright">Powered by phpBB&reg; Forum Software &copy; phpBB Limited<br />https://www.phpbb.com/</div>
	</div>
</div>

</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=8567&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 07:16:55 GMT -->
</html>
