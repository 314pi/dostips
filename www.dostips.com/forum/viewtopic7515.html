<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=7347&start=30 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 07:50:45 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>Creating a script to gather PC information - to assist those asking for help - Page 3 - DosTips.com</title>


	<link rel="canonical" href="viewtopic189b.html?t=7347&amp;start=30">

<!--
	phpBB style name: Allan Style - SUBSILVER
	Based on style:   prosilver (this is the default phpBB3 style)
	Based on style:   subsilver2 (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:  Allan ( http://x-tk.ru/ )
-->

<link href="assets/css/font-awesome.mind772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/stylesheetd772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/en/stylesheetd772.css?assets_version=34" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="./styles/AllanStyle-SUBSILVER/theme/tweaks.css?assets_version=34" rel="stylesheet">
<![endif]-->




<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','../../www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-280191-1', 'auto');
	ga('send', 'pageview');
</script>

</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">

<div id="header-subsilver">
	<a id="top" class="top-anchor" accesskey="t"></a>
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description" class="site-description">
				<a id="logo" class="logo" href="../index.html" title="DosTips.com"><span class="site_logo"></span></a>
				<h1>DosTips.com</h1>
				<p>A Forum all about DOS Batch</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

									<div id="search-box" class="search-box search-header" role="search">
				<form action="https://www.dostips.com/forum/search.php" method="get" id="search">
				<fieldset>
					<input name="keywords" id="keywords" type="search" maxlength="128" title="Search for keywords" class="inputbox search tiny" size="20" value="" placeholder="Search…" />
					<button class="button button-search" type="submit" title="Search">
						<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
					</button>
					<a href="search.html" class="button button-search-end" title="Advanced search">
						<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
					</a>
					
				</fieldset>
				</form>
			</div>
						
			</div>
					</div>
</div>


<div id="wrap" class="wrap">
	<div id="page-header">
				<div class="navbar-top" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
																									<li>
								<a href="search33a7.html?search_id=unanswered" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="search526f.html?search_id=active_topics" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-blue" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="search.html" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
											<li class="separator"></li>
																			<li>
								<a href="memberlist4bfd.html?mode=team" role="menuitem">
									<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
								</a>
							</li>
																<li class="separator"></li>

									</ul>
			</div>
		</li>

				<li data-skip-responsive="true">
			<a href="app.php/help/faq.html" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
						
			<li class="rightside"  data-skip-responsive="true">
			<a href="ucp26c3.html?mode=login" title="Login" accesskey="x" role="menuitem">
				<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Login</span>
			</a>
		</li>
					<li class="rightside" data-skip-responsive="true">
				<a href="ucp8319.html?mode=register" role="menuitem">
					<i class="icon fa-pencil-square-o  fa-fw" aria-hidden="true"></i><span>Register</span>
				</a>
			</li>
						</ul>

	</div>
</div>

<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
						<li class="breadcrumbs">
							<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="../index.html" itemprop="url" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span itemprop="title">DosTips.com</span></a></span>
										<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="index.html" itemprop="url" accesskey="h" data-navbar-reference="index"><span itemprop="title">Board index</span></a></span>

											<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="4"><a href="viewforum31e6.html?f=4" itemprop="url"><span itemprop="title">DosTips - Dos Batch</span></a></span>
															<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="3"><a href="viewforum4d6b.html?f=3" itemprop="url"><span itemprop="title">DOS Batch Forum</span></a></span>
												</li>
		
					<li class="rightside responsive-search">
				<a href="search.html" title="View the advanced search options" role="menuitem">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</a>
			</li>
			</ul>

	</div>
</div>

<div class="navbar-top-link">
	<div class="inner">
		<ul>
			<li class="navbar-top-link-left"><a href="search33a7.html?search_id=unanswered">Unanswered topics</a></li>
			<li class="navbar-top-link-left"><a href="search526f.html?search_id=active_topics">Active topics</a></li>

											</ul>
	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
		
<h2 class="topic-title"><a href="viewtopic7515.html?f=3&amp;t=7347&amp;start=30">Creating a script to gather PC information - to assist those asking for help</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">Discussion forum for all Windows batch related topics.<br /></div>
<p>
	<strong>Moderator:</strong> <a href="memberlista6a8.html?mode=viewprofile&amp;u=5" class="username">DosItHelp</a>
</p>


<div class="action-bar bar-top">
	
			<a href="posting0b06.html?mode=reply&amp;f=3&amp;t=7347" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic133a.html?f=3&amp;t=7347&amp;start=30&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="https://www.dostips.com/forum/search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topic…" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="search.html" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="7347" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			158 posts
							<ul>
	<li class="dropdown-container dropdown-button-control dropdown-page-jump page-jump">
		<a class="button button-icon-only dropdown-trigger" href="#" title="Click to jump to page…" role="button"><i class="icon fa-level-down fa-rotate-270" aria-hidden="true"></i><span class="sr-only">Page <strong>3</strong> of <strong>11</strong></span></a>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
				<li>Jump to page:</li>
				<li class="page-jump-form">
					<input type="number" name="page-number" min="1" max="999999" title="Enter the page number you wish to go to" class="inputbox tiny" data-per-page="15" data-base-url=".&#x2F;viewtopic.php&#x3F;f&#x3D;3&amp;amp&#x3B;t&#x3D;7347" data-start-name="start" />
					<input class="button2" value="Go" type="button" />
				</li>
			</ul>
		</div>
	</li>
			<li class="arrow previous"><a class="button button-icon-only" href="viewtopic49cd.html?f=3&amp;t=7347&amp;start=15" rel="prev" role="button"><i class="icon fa-chevron-left fa-fw" aria-hidden="true"></i><span class="sr-only">Previous</span></a></li>
				<li><a class="button" href="viewtopic1343.html?f=3&amp;t=7347" role="button">1</a></li>
				<li><a class="button" href="viewtopic49cd.html?f=3&amp;t=7347&amp;start=15" role="button">2</a></li>
			<li class="active"><span>3</span></li>
				<li><a class="button" href="viewtopic7c37.html?f=3&amp;t=7347&amp;start=45" role="button">4</a></li>
				<li><a class="button" href="viewtopiccda4-2.html?f=3&amp;t=7347&amp;start=60" role="button">5</a></li>
			<li class="ellipsis" role="separator"><span>…</span></li>
				<li><a class="button" href="viewtopic66e3.html?f=3&amp;t=7347&amp;start=150" role="button">11</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopic7c37.html?f=3&amp;t=7347&amp;start=45" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
		</div>




<div id="subsilver-nav-topic">
	<div class="inner"><div class="post has-profile">
		<div class="leftsided postbody subsilver-topic-title">Message</div>
		<div class="leftsided postprofile subsilver-topic-author">Author</div>
	</div></div>
</div>

			<div id="p48475" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile48475">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search661c.html?author_id=1265&amp;sr=posts">3386</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 22 Jan 2010 18:01</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content48475">

						<h3 class="first"><a href="#p48475">Re: Creating a script to gather PC information - to assist those asking for help</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinge4d4.html?mode=quote&amp;f=3&amp;p=48475" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicc0c0.html?p=48475#p48475" onclick="prompt('Message #31',this.href); return false;">#31</a></span> 
									<a class="unread" href="viewtopicc0c0.html?p=48475#p48475" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a></strong> &raquo; </span>15 Aug 2016 14:23
			</p>
			
			
			
			<div class="content">@Dave<br />I remembered that the WMI provides the StdRegProv class. You may try it at work.<br /><br />JScript (that we may include into a hybrid script later on):<br />registry.js<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>/*<br />http://msdn.microsoft.com/en-us/library/aa393664(v=vs.85).aspx<br />*/<br /><br />/* Hives */<br />var HKCR = HKEY_CLASSES_ROOT&nbsp; &nbsp;= 0x80000000;<br />var HKCU = HKEY_CURRENT_USER&nbsp; &nbsp;= 0x80000001;<br />var HKLM = HKEY_LOCAL_MACHINE&nbsp; = 0x80000002;<br />var HKU&nbsp; = HKEY_USERS&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0x80000003;<br />var HKCC = HKEY_CURRENT_CONFIG = 0x80000005;<br />/* Data Types */<br />var REG_NONE&nbsp; &nbsp; &nbsp; =&nbsp; 0;<br />var REG_SZ&nbsp; &nbsp; &nbsp; &nbsp; =&nbsp; 1;<br />var REG_EXPAND_SZ =&nbsp; 2;<br />var REG_BINARY&nbsp; &nbsp; =&nbsp; 3;<br />var REG_DWORD&nbsp; &nbsp; &nbsp;=&nbsp; 4;<br />var REG_MULTI_SZ&nbsp; =&nbsp; 7;<br />var REG_QWORD&nbsp; &nbsp; &nbsp;= 11;<br />/* Access Rights (can be combined with the | operator) */<br />var KEY_QUERY_VALUE&nbsp; &nbsp; &nbsp; &nbsp; = 0x00000001; //Required to query the values of a registry key.<br />var KEY_SET_VALUE&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0x00000002; //Required to create, delete, or set a registry value.<br />var KEY_CREATE_SUB_KEY&nbsp; &nbsp; &nbsp;= 0x00000004; //Required to create a subkey of a registry key.<br />var KEY_ENUMERATE_SUB_KEYS = 0x00000008; //Required to enumerate the subkeys of a registry key.<br />var KEY_NOTIFY&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 0x00000010; //Required to request change notifications for a registry key or for subkeys of a registry key.<br />var KEY_CREATE&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 0x00000020; //Required to create a registry key.<br />var DELETE&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 0x00010000; //Required to delete a registry key.<br />var READ_CONTROL&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 0x00020000; //Combines the STANDARD_RIGHTS_READ, KEY_QUERY_VALUE, KEY_ENUMERATE_SUB_KEYS, and KEY_NOTIFY values.<br />var WRITE_DAC&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0x00040000; //Required to modify the DACL in the object's security descriptor.<br />var WRITE_OWNER&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0x00080000; //Required to change the owner in the object's security descriptor.<br /><br />function regCheckAccess(strComputer, uHive, strRegPath, uRequiredAccess) {<br />&nbsp; try {<br />&nbsp; &nbsp; var objLocator = new ActiveXObject(&quot;WbemScripting.SWbemLocator&quot;);<br />&nbsp; &nbsp; var objService = objLocator.ConnectServer(strComputer, &quot;root\\default&quot;);<br />&nbsp; &nbsp; objService.Security_.ImpersonationLevel = 3; //wbemImpersonationLevelImpersonate<br />&nbsp; &nbsp; var objReg = objService.Get(&quot;StdRegProv&quot;);<br />&nbsp; &nbsp; var objAccessMethod = objReg.Methods_.Item(&quot;CheckAccess&quot;);<br />&nbsp; &nbsp; var objAccessInParam = objAccessMethod.InParameters.SpawnInstance_();<br />&nbsp; &nbsp; objAccessInParam.hDefKey = uHive;<br />&nbsp; &nbsp; objAccessInParam.sSubKeyName = strRegPath;<br />&nbsp; &nbsp; objAccessInParam.uRequired = uRequiredAccess;<br />&nbsp; &nbsp; var objAccessOutParam = objReg.ExecMethod_(objAccessMethod.Name, objAccessInParam);<br />&nbsp; &nbsp; if (objAccessOutParam.ReturnValue == 0) {<br />&nbsp; &nbsp; &nbsp; if (objAccessOutParam.bGranted) {return true;}<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; return false;<br />&nbsp; }<br />&nbsp; catch(e) {return false;}<br />}<br /><br />function regCreateKey(strComputer, uHive, strRegPath) {<br />&nbsp; try {<br />&nbsp; &nbsp; var objLocator = new ActiveXObject(&quot;WbemScripting.SWbemLocator&quot;);<br />&nbsp; &nbsp; var objService = objLocator.ConnectServer(strComputer, &quot;root\\default&quot;);<br />&nbsp; &nbsp; objService.Security_.ImpersonationLevel = 3; //wbemImpersonationLevelImpersonate<br />&nbsp; &nbsp; var objReg = objService.Get(&quot;StdRegProv&quot;);<br />&nbsp; &nbsp; var objCreateMethod = objReg.Methods_.Item(&quot;CreateKey&quot;);<br />&nbsp; &nbsp; var objCreateInParam = objCreateMethod.InParameters.SpawnInstance_();<br />&nbsp; &nbsp; objCreateInParam.hDefKey = uHive;<br />&nbsp; &nbsp; objCreateInParam.sSubKeyName = strRegPath;<br />&nbsp; &nbsp; var objCreateOutParam = objReg.ExecMethod_(objCreateMethod.Name, objCreateInParam);<br />&nbsp; &nbsp; if (objCreateOutParam.ReturnValue == 0) {return true;}<br />&nbsp; &nbsp; return false;<br />&nbsp; }<br />&nbsp; catch(e) {return false;}<br />}<br /><br />function regWriteVal(strComputer, uHive, strRegPath, strValName, iType, vData) {<br />&nbsp; try {<br />&nbsp; &nbsp; var bRet = false;<br />&nbsp; &nbsp; var objLocator = new ActiveXObject(&quot;WbemScripting.SWbemLocator&quot;);<br />&nbsp; &nbsp; var objService = objLocator.ConnectServer(strComputer, &quot;root\\default&quot;);<br />&nbsp; &nbsp; objService.Security_.ImpersonationLevel = 3; //wbemImpersonationLevelImpersonate<br />&nbsp; &nbsp; var objReg = objService.Get(&quot;StdRegProv&quot;);<br />&nbsp; &nbsp; var objCreateMethod = objReg.Methods_.Item(&quot;CreateKey&quot;);<br />&nbsp; &nbsp; var objCreateInParam = objCreateMethod.InParameters.SpawnInstance_();<br />&nbsp; &nbsp; objCreateInParam.hDefKey = uHive;<br />&nbsp; &nbsp; objCreateInParam.sSubKeyName = strRegPath;<br />&nbsp; &nbsp; var objCreateOutParam = objReg.ExecMethod_(objCreateMethod.Name, objCreateInParam);<br />&nbsp; &nbsp; if (objCreateOutParam.ReturnValue != 0) {return false;}<br />&nbsp; &nbsp; switch (iType) {<br />&nbsp; &nbsp; &nbsp; case REG_SZ:<br />&nbsp; &nbsp; &nbsp; &nbsp; var objSetMethod = objReg.Methods_.Item(&quot;SetStringValue&quot;);<br />&nbsp; &nbsp; &nbsp; &nbsp; var objSetInParam = objSetMethod.InParameters.SpawnInstance_();<br />&nbsp; &nbsp; &nbsp; &nbsp; objSetInParam.hDefKey = uHive;<br />&nbsp; &nbsp; &nbsp; &nbsp; objSetInParam.sSubKeyName = strRegPath;<br />&nbsp; &nbsp; &nbsp; &nbsp; objSetInParam.sValueName = strValName;<br />&nbsp; &nbsp; &nbsp; &nbsp; objSetInParam.sValue = vData;<br />&nbsp; &nbsp; &nbsp; &nbsp; var objSetOutParam = objReg.ExecMethod_(objSetMethod.Name, objSetInParam);<br />&nbsp; &nbsp; &nbsp; &nbsp; if (objSetOutParam.ReturnValue == 0) {bRet = true;}<br />&nbsp; &nbsp; &nbsp; &nbsp; break;<br />&nbsp; &nbsp; &nbsp; case REG_EXPAND_SZ:<br />&nbsp; &nbsp; &nbsp; &nbsp; var objSetMethod = objReg.Methods_.Item(&quot;SetExpandedStringValue&quot;);<br />&nbsp; &nbsp; &nbsp; &nbsp; var objSetInParam = objSetMethod.InParameters.SpawnInstance_();<br />&nbsp; &nbsp; &nbsp; &nbsp; objSetInParam.hDefKey = uHive;<br />&nbsp; &nbsp; &nbsp; &nbsp; objSetInParam.sSubKeyName = strRegPath;<br />&nbsp; &nbsp; &nbsp; &nbsp; objSetInParam.sValueName = strValName;<br />&nbsp; &nbsp; &nbsp; &nbsp; objSetInParam.sValue = vData;<br />&nbsp; &nbsp; &nbsp; &nbsp; var objSetOutParam = objReg.ExecMethod_(objSetMethod.Name, objSetInParam);<br />&nbsp; &nbsp; &nbsp; &nbsp; if (objSetOutParam.ReturnValue == 0) {bRet = true;}<br />&nbsp; &nbsp; &nbsp; &nbsp; break;<br />&nbsp; &nbsp; &nbsp; case REG_BINARY:<br />&nbsp; &nbsp; &nbsp; &nbsp; var objSetMethod = objReg.Methods_.Item(&quot;SetBinaryValue&quot;);<br />&nbsp; &nbsp; &nbsp; &nbsp; var objSetInParam = objSetMethod.InParameters.SpawnInstance_();<br />&nbsp; &nbsp; &nbsp; &nbsp; objSetInParam.hDefKey = uHive;<br />&nbsp; &nbsp; &nbsp; &nbsp; objSetInParam.sSubKeyName = strRegPath;<br />&nbsp; &nbsp; &nbsp; &nbsp; objSetInParam.sValueName = strValName;<br />&nbsp; &nbsp; &nbsp; &nbsp; objSetInParam.uValue = vData;<br />&nbsp; &nbsp; &nbsp; &nbsp; var objSetOutParam = objReg.ExecMethod_(objSetMethod.Name, objSetInParam);<br />&nbsp; &nbsp; &nbsp; &nbsp; if (objSetOutParam.ReturnValue == 0) {bRet = true;}<br />&nbsp; &nbsp; &nbsp; &nbsp; break;<br />&nbsp; &nbsp; &nbsp; case REG_DWORD:<br />&nbsp; &nbsp; &nbsp; &nbsp; var objSetMethod = objReg.Methods_.Item(&quot;SetDWORDValue&quot;);<br />&nbsp; &nbsp; &nbsp; &nbsp; var objSetInParam = objSetMethod.InParameters.SpawnInstance_();<br />&nbsp; &nbsp; &nbsp; &nbsp; objSetInParam.hDefKey = uHive;<br />&nbsp; &nbsp; &nbsp; &nbsp; objSetInParam.sSubKeyName = strRegPath;<br />&nbsp; &nbsp; &nbsp; &nbsp; objSetInParam.sValueName = strValName;<br />&nbsp; &nbsp; &nbsp; &nbsp; objSetInParam.uValue = vData;<br />&nbsp; &nbsp; &nbsp; &nbsp; var objSetOutParam = objReg.ExecMethod_(objSetMethod.Name, objSetInParam);<br />&nbsp; &nbsp; &nbsp; &nbsp; if (objSetOutParam.ReturnValue == 0) {bRet = true;}<br />&nbsp; &nbsp; &nbsp; &nbsp; break;<br />&nbsp; &nbsp; &nbsp; case REG_MULTI_SZ:<br />&nbsp; &nbsp; &nbsp; &nbsp; var objSetMethod = objReg.Methods_.Item(&quot;SetMultiStringValue&quot;);<br />&nbsp; &nbsp; &nbsp; &nbsp; var objSetInParam = objSetMethod.InParameters.SpawnInstance_();<br />&nbsp; &nbsp; &nbsp; &nbsp; objSetInParam.hDefKey = uHive;<br />&nbsp; &nbsp; &nbsp; &nbsp; objSetInParam.sSubKeyName = strRegPath;<br />&nbsp; &nbsp; &nbsp; &nbsp; objSetInParam.sValueName = strValName;<br />&nbsp; &nbsp; &nbsp; &nbsp; objSetInParam.sValue = vData;<br />&nbsp; &nbsp; &nbsp; &nbsp; var objSetOutParam = objReg.ExecMethod_(objSetMethod.Name, objSetInParam);<br />&nbsp; &nbsp; &nbsp; &nbsp; if (objSetOutParam.ReturnValue == 0) {bRet = true;}<br />&nbsp; &nbsp; &nbsp; &nbsp; break;<br />&nbsp; &nbsp; &nbsp; case REG_QWORD:<br />&nbsp; &nbsp; &nbsp; &nbsp; var objSetMethod = objReg.Methods_.Item(&quot;SetQWORDValue&quot;);<br />&nbsp; &nbsp; &nbsp; &nbsp; var objSetInParam = objSetMethod.InParameters.SpawnInstance_();<br />&nbsp; &nbsp; &nbsp; &nbsp; objSetInParam.hDefKey = uHive;<br />&nbsp; &nbsp; &nbsp; &nbsp; objSetInParam.sSubKeyName = strRegPath;<br />&nbsp; &nbsp; &nbsp; &nbsp; objSetInParam.sValueName = strValName;<br />&nbsp; &nbsp; &nbsp; &nbsp; objSetInParam.uValue = vData;<br />&nbsp; &nbsp; &nbsp; &nbsp; var objSetOutParam = objReg.ExecMethod_(objSetMethod.Name, objSetInParam);<br />&nbsp; &nbsp; &nbsp; &nbsp; if (objSetOutParam.ReturnValue == 0) {bRet = true;}<br />&nbsp; &nbsp; &nbsp; &nbsp; break;<br />&nbsp; &nbsp; &nbsp; default:<br />&nbsp; &nbsp; &nbsp; &nbsp; return false;<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; return bRet;<br />&nbsp; }<br />&nbsp; catch(e) {return false;}<br />}<br /><br />function regReadVal(strComputer, uHive, strRegPath, strValName) {<br />&nbsp; try {<br />&nbsp; &nbsp; var vRet = null, iType = -1;<br />&nbsp; &nbsp; var objLocator = new ActiveXObject(&quot;WbemScripting.SWbemLocator&quot;);<br />&nbsp; &nbsp; var objService = objLocator.ConnectServer(strComputer, &quot;root\\default&quot;);<br />&nbsp; &nbsp; objService.Security_.ImpersonationLevel = 3; //wbemImpersonationLevelImpersonate<br />&nbsp; &nbsp; var objReg = objService.Get(&quot;StdRegProv&quot;);<br />&nbsp; &nbsp; var objEnumMethod = objReg.Methods_.Item(&quot;EnumValues&quot;);<br />&nbsp; &nbsp; var objEnumInParam = objEnumMethod.InParameters.SpawnInstance_();<br />&nbsp; &nbsp; objEnumInParam.hDefKey = uHive;<br />&nbsp; &nbsp; objEnumInParam.sSubKeyName = strRegPath;<br />&nbsp; &nbsp; var objEnumOutParam = objReg.ExecMethod_(objEnumMethod.Name, objEnumInParam);<br />&nbsp; &nbsp; if (objEnumOutParam.ReturnValue == 0) {<br />&nbsp; &nbsp; &nbsp; if (objEnumOutParam.sNames != null) {<br />&nbsp; &nbsp; &nbsp; &nbsp; for (var i = 0; i &lt;= objEnumOutParam.sNames.ubound(); i++) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (objEnumOutParam.sNames.getItem(i).toLowerCase() == strValName.toLowerCase()) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; iType = objEnumOutParam.Types.getItem(i);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; else {if (strValName == &quot;&quot;) {iType = REG_NONE;}}<br />&nbsp; &nbsp; &nbsp; if (iType == -1) {return null;}<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; else {return null;}<br />&nbsp; &nbsp; switch (iType) {<br />&nbsp; &nbsp; &nbsp; case REG_SZ:<br />&nbsp; &nbsp; &nbsp; &nbsp; var objGetMethod = objReg.Methods_.Item(&quot;GetStringValue&quot;);<br />&nbsp; &nbsp; &nbsp; &nbsp; var objGetInParam = objGetMethod.InParameters.SpawnInstance_();<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.hDefKey = uHive;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sSubKeyName = strRegPath;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sValueName = strValName;<br />&nbsp; &nbsp; &nbsp; &nbsp; var objGetOutParam = objReg.ExecMethod_(objGetMethod.Name, objGetInParam);<br />&nbsp; &nbsp; &nbsp; &nbsp; if (objGetOutParam.ReturnValue == 0) {vRet = objGetOutParam.sValue;}<br />&nbsp; &nbsp; &nbsp; &nbsp; break;<br />&nbsp; &nbsp; &nbsp; case REG_EXPAND_SZ:<br />&nbsp; &nbsp; &nbsp; &nbsp; var objGetMethod = objReg.Methods_.Item(&quot;GetExpandedStringValue&quot;);<br />&nbsp; &nbsp; &nbsp; &nbsp; var objGetInParam = objGetMethod.InParameters.SpawnInstance_();<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.hDefKey = uHive;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sSubKeyName = strRegPath;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sValueName = strValName;<br />&nbsp; &nbsp; &nbsp; &nbsp; var objGetOutParam = objReg.ExecMethod_(objGetMethod.Name, objGetInParam);<br />&nbsp; &nbsp; &nbsp; &nbsp; if (objGetOutParam.ReturnValue == 0) {vRet = objGetOutParam.sValue;}<br />&nbsp; &nbsp; &nbsp; &nbsp; break;<br />&nbsp; &nbsp; &nbsp; case REG_BINARY:<br />&nbsp; &nbsp; &nbsp; &nbsp; var objGetMethod = objReg.Methods_.Item(&quot;GetBinaryValue&quot;);<br />&nbsp; &nbsp; &nbsp; &nbsp; var objGetInParam = objGetMethod.InParameters.SpawnInstance_();<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.hDefKey = uHive;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sSubKeyName = strRegPath;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sValueName = strValName;<br />&nbsp; &nbsp; &nbsp; &nbsp; var objGetOutParam = objReg.ExecMethod_(objGetMethod.Name, objGetInParam);<br />&nbsp; &nbsp; &nbsp; &nbsp; if (objGetOutParam.ReturnValue == 0) {if (objGetOutParam.uValue != null) {vRet = objGetOutParam.uValue.toArray();}}<br />&nbsp; &nbsp; &nbsp; &nbsp; break;<br />&nbsp; &nbsp; &nbsp; case REG_DWORD:<br />&nbsp; &nbsp; &nbsp; &nbsp; var objGetMethod = objReg.Methods_.Item(&quot;GetDWORDValue&quot;);<br />&nbsp; &nbsp; &nbsp; &nbsp; var objGetInParam = objGetMethod.InParameters.SpawnInstance_();<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.hDefKey = uHive;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sSubKeyName = strRegPath;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sValueName = strValName;<br />&nbsp; &nbsp; &nbsp; &nbsp; var objGetOutParam = objReg.ExecMethod_(objGetMethod.Name, objGetInParam);<br />&nbsp; &nbsp; &nbsp; &nbsp; if (objGetOutParam.ReturnValue == 0) {vRet = objGetOutParam.uValue;}<br />&nbsp; &nbsp; &nbsp; &nbsp; break;<br />&nbsp; &nbsp; &nbsp; case REG_MULTI_SZ:<br />&nbsp; &nbsp; &nbsp; &nbsp; var objGetMethod = objReg.Methods_.Item(&quot;GetMultiStringValue&quot;);<br />&nbsp; &nbsp; &nbsp; &nbsp; var objGetInParam = objGetMethod.InParameters.SpawnInstance_();<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.hDefKey = uHive;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sSubKeyName = strRegPath;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sValueName = strValName;<br />&nbsp; &nbsp; &nbsp; &nbsp; var objGetOutParam = objReg.ExecMethod_(objGetMethod.Name, objGetInParam);<br />&nbsp; &nbsp; &nbsp; &nbsp; if (objGetOutParam.ReturnValue == 0) {if (objGetOutParam.sValue != null) {vRet = objGetOutParam.sValue.toArray();}}<br />&nbsp; &nbsp; &nbsp; &nbsp; break;<br />&nbsp; &nbsp; &nbsp; case REG_QWORD:<br />&nbsp; &nbsp; &nbsp; &nbsp; var objGetMethod = objReg.Methods_.Item(&quot;GetQWORDValue&quot;);<br />&nbsp; &nbsp; &nbsp; &nbsp; var objGetInParam = objGetMethod.InParameters.SpawnInstance_();<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.hDefKey = uHive;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sSubKeyName = strRegPath;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sValueName = strValName;<br />&nbsp; &nbsp; &nbsp; &nbsp; var objGetOutParam = objReg.ExecMethod_(objGetMethod.Name, objGetInParam);<br />&nbsp; &nbsp; &nbsp; &nbsp; if (objGetOutParam.ReturnValue == 0) {vRet = objGetOutParam.uValue;}<br />&nbsp; &nbsp; &nbsp; &nbsp; break;<br />&nbsp; &nbsp; &nbsp; case REG_NONE:<br />&nbsp; &nbsp; &nbsp; &nbsp; var objGetMethod = objReg.Methods_.Item(&quot;GetStringValue&quot;);<br />&nbsp; &nbsp; &nbsp; &nbsp; var objGetInParam = objGetMethod.InParameters.SpawnInstance_();<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.hDefKey = uHive;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sSubKeyName = strRegPath;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sValueName = strValName;<br />&nbsp; &nbsp; &nbsp; &nbsp; var objGetOutParam = objReg.ExecMethod_(objGetMethod.Name, objGetInParam);<br />&nbsp; &nbsp; &nbsp; &nbsp; if (objGetOutParam.ReturnValue == 0) {if (objGetOutParam.sValue != null) {vRet = objGetOutParam.sValue; break;}}<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetMethod = objReg.Methods_.Item(&quot;GetExpandedStringValue&quot;);<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam = objGetMethod.InParameters.SpawnInstance_();<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.hDefKey = uHive;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sSubKeyName = strRegPath;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sValueName = strValName;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetOutParam = objReg.ExecMethod_(objGetMethod.Name, objGetInParam);<br />&nbsp; &nbsp; &nbsp; &nbsp; if (objGetOutParam.ReturnValue == 0) {if (objGetOutParam.sValue != null) {vRet = objGetOutParam.sValue; break;}}<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetMethod = objReg.Methods_.Item(&quot;GetBinaryValue&quot;);<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam = objGetMethod.InParameters.SpawnInstance_();<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.hDefKey = uHive;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sSubKeyName = strRegPath;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sValueName = strValName;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetOutParam = objReg.ExecMethod_(objGetMethod.Name, objGetInParam);<br />&nbsp; &nbsp; &nbsp; &nbsp; if (objGetOutParam.ReturnValue == 0) {if (objGetOutParam.uValue != null) {vRet = objGetOutParam.uValue.toArray(); break;}}<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetMethod = objReg.Methods_.Item(&quot;GetDWORDValue&quot;);<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam = objGetMethod.InParameters.SpawnInstance_();<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.hDefKey = uHive;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sSubKeyName = strRegPath;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sValueName = strValName;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetOutParam = objReg.ExecMethod_(objGetMethod.Name, objGetInParam);<br />&nbsp; &nbsp; &nbsp; &nbsp; if (objGetOutParam.ReturnValue == 0) {if (objGetOutParam.uValue != null) {vRet = objGetOutParam.uValue; break;}}<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetMethod = objReg.Methods_.Item(&quot;GetMultiStringValue&quot;);<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam = objGetMethod.InParameters.SpawnInstance_();<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.hDefKey = uHive;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sSubKeyName = strRegPath;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sValueName = strValName;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetOutParam = objReg.ExecMethod_(objGetMethod.Name, objGetInParam);<br />&nbsp; &nbsp; &nbsp; &nbsp; if (objGetOutParam.ReturnValue == 0) {if (objGetOutParam.sValue != null) {vRet = objGetOutParam.sValue.toArray(); break;}}<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetMethod = objReg.Methods_.Item(&quot;GetQWORDValue&quot;);<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam = objGetMethod.InParameters.SpawnInstance_();<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.hDefKey = uHive;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sSubKeyName = strRegPath;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sValueName = strValName;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetOutParam = objReg.ExecMethod_(objGetMethod.Name, objGetInParam);<br />&nbsp; &nbsp; &nbsp; &nbsp; if (objGetOutParam.ReturnValue == 0) {if (objGetOutParam.uValue != null) {vRet = objGetOutParam.uValue; break;}}<br />&nbsp; &nbsp; &nbsp; default:<br />&nbsp; &nbsp; &nbsp; &nbsp; return null;<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; return vRet;<br />&nbsp; }<br />&nbsp; catch(e) {return null;}<br />}<br /><br />function regDelKey(strComputer, uHive, strRegPath) {<br />&nbsp; try {<br />&nbsp; &nbsp; var iRet = 0;<br />&nbsp; &nbsp; var objLocator = new ActiveXObject(&quot;WbemScripting.SWbemLocator&quot;);<br />&nbsp; &nbsp; var objService = objLocator.ConnectServer(strComputer, &quot;root\\default&quot;);<br />&nbsp; &nbsp; objService.Security_.ImpersonationLevel = 3; //wbemImpersonationLevelImpersonate<br />&nbsp; &nbsp; var objReg = objService.Get(&quot;StdRegProv&quot;);<br />&nbsp; &nbsp; var objEnumMethod = objReg.Methods_.Item(&quot;EnumKey&quot;);<br />&nbsp; &nbsp; var objEnumInParam = objEnumMethod.InParameters.SpawnInstance_();<br />&nbsp; &nbsp; objEnumInParam.hDefKey = uHive;<br />&nbsp; &nbsp; objEnumInParam.sSubKeyName = strRegPath;<br />&nbsp; &nbsp; var objEnumOutParam = objReg.ExecMethod_(objEnumMethod.Name, objEnumInParam);<br />&nbsp; &nbsp; if (objEnumOutParam.ReturnValue == 0) {<br />&nbsp; &nbsp; &nbsp; if (objEnumOutParam.sNames != null) {<br />&nbsp; &nbsp; &nbsp; &nbsp; for (var i = 0; i &lt;= objEnumOutParam.sNames.ubound(); i++) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var strNewPath = strRegPath + &quot;\\&quot; + objEnumOutParam.sNames.getItem(i);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; iRet += regDelKey(strComputer, uHive, strNewPath);<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; var objDelMethod = objReg.Methods_.Item(&quot;DeleteKey&quot;);<br />&nbsp; &nbsp; &nbsp; var objDelInParam = objDelMethod.InParameters.SpawnInstance_();<br />&nbsp; &nbsp; &nbsp; objDelInParam.hDefKey = uHive;<br />&nbsp; &nbsp; &nbsp; objDelInParam.sSubKeyName = strRegPath;<br />&nbsp; &nbsp; &nbsp; var objDelOutParam = objReg.ExecMethod_(objDelMethod.Name, objDelInParam);<br />&nbsp; &nbsp; &nbsp; iRet = (objDelOutParam.ReturnValue == 0) ? ++iRet : -1;<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; return iRet;<br />&nbsp; }<br />&nbsp; catch(e) {return -1;}<br />}<br /><br />function regDelVal(strComputer, uHive, strRegPath, strValName) {<br />&nbsp; try {<br />&nbsp; &nbsp; var objLocator = new ActiveXObject(&quot;WbemScripting.SWbemLocator&quot;);<br />&nbsp; &nbsp; var objService = objLocator.ConnectServer(strComputer, &quot;root\\default&quot;);<br />&nbsp; &nbsp; objService.Security_.ImpersonationLevel = 3; //wbemImpersonationLevelImpersonate<br />&nbsp; &nbsp; var objReg = objService.Get(&quot;StdRegProv&quot;);<br />&nbsp; &nbsp; var objDelMethod = objReg.Methods_.Item(&quot;DeleteValue&quot;);<br />&nbsp; &nbsp; var objDelInParam = objDelMethod.InParameters.SpawnInstance_();<br />&nbsp; &nbsp; objDelInParam.hDefKey = uHive;<br />&nbsp; &nbsp; objDelInParam.sSubKeyName = strRegPath;<br />&nbsp; &nbsp; objDelInParam.sValueName = strValName;<br />&nbsp; &nbsp; var objDelOutParam = objReg.ExecMethod_(objDelMethod.Name, objDelInParam);<br />&nbsp; &nbsp; if (objDelOutParam.ReturnValue == 0) {return true;}<br />&nbsp; &nbsp; return false;<br />&nbsp; }<br />&nbsp; catch(e) {return false;}<br />}<br /><br />//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////<br />var sCompName = &quot;.&quot;;<br /><br />if (regCheckAccess(sCompName, HKCU, &quot;Software\\Microsoft\\Command Processor&quot;, KEY_QUERY_VALUE)) {<br />&nbsp; WScript.Echo(&quot;Extensions (User)\n&quot; + regReadVal(sCompName, HKCU, &quot;Software\\Microsoft\\Command Processor&quot;, &quot;EnableExtensions&quot;));<br />} else {<br />&nbsp; WScript.Echo(&quot;HKCU Access Denied&quot;);<br />}<br /><br />if (regCheckAccess(sCompName, HKLM, &quot;Software\\Microsoft\\Command Processor&quot;, KEY_QUERY_VALUE)) {<br />&nbsp; WScript.Echo(&quot;Extensions (System)\n&quot; + regReadVal(sCompName, HKLM, &quot;Software\\Microsoft\\Command Processor&quot;, &quot;EnableExtensions&quot;));<br />} else {<br />&nbsp; WScript.Echo(&quot;HKLM Access Denied&quot;);<br />}<br /></code></pre></div><br />Regards<br />aGerman</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p48476" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile48476">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistfcd5.html?mode=viewprofile&amp;u=4915" style="color: #00AA00;" class="username-coloured">penpen</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1bf7.html?author_id=4915&amp;sr=posts">1612</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 Jun 2013 06:15</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content48476">

						<h3 ><a href="#p48476">Re: Creating a script to gather PC information - to assist those asking for help</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingd78c.html?mode=quote&amp;f=3&amp;p=48476" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicd0d6.html?p=48476#p48476" onclick="prompt('Message #32',this.href); return false;">#32</a></span> 
									<a class="unread" href="viewtopicd0d6.html?p=48476#p48476" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistfcd5.html?mode=viewprofile&amp;u=4915" style="color: #00AA00;" class="username-coloured">penpen</a></strong> &raquo; </span>15 Aug 2016 18:25
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>aGerman wrote:</cite>I know from former posts that csc was removed from Dave's PC at work <img class="smilies" src="images/smilies/icon_sad.gif" alt=":(" title="Sad" /> </div></blockquote>Is it really removed, or is its execution blocked?<br />In the second case it might be possible to create a powershell script using c#,<br />and therefore executing csc indirectly (here is a <a href="viewtopic50a1-2.html?p=45829#p45829" class="postlink">howto</a>).<br /><br /><blockquote><div><cite>aGerman wrote:</cite>- enabled extensions and delayed expansion could be checked using IF statements. E.g.:</div></blockquote>You don't need to execute cmd, just use the set command:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>set extensions=disabled<br />2&gt;nul set &quot;extensions=enabled&quot;<br />set delayedExpansion=disabled<br />if &quot;!delayedExpansion!&quot; == &quot;%delayedExpansion%&quot; set delayedExpansion=enabled<br /><br />echo extensions: %extensions%&nbsp; &nbsp;delayedExpansion: %delayedExpansion%</code></pre></div><br /><blockquote><div><cite>aGerman wrote:</cite>- OEMCP can be extracted from CHCP.<br />- ACP ??? No idea yet.<br /></div></blockquote>This seems to work under windows 10 (actually can't test it for other win versions):<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>wmic os get codeset<br /></code></pre></div>I don't know if this would work on dave's work pc:<br />I could imagine wmic.exe may also be disabled.<br />(Maybe within jscript - but copuld also be disabled... else see &quot;wmic /locale:ms_409 os get * /format:list&quot;.)<br /><br /><br />penpen</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p48477" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile48477">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search661c.html?author_id=1265&amp;sr=posts">3386</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 22 Jan 2010 18:01</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content48477">

						<h3 ><a href="#p48477">Re: Creating a script to gather PC information - to assist those asking for help</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingde1b.html?mode=quote&amp;f=3&amp;p=48477" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic62d2.html?p=48477#p48477" onclick="prompt('Message #33',this.href); return false;">#33</a></span> 
									<a class="unread" href="viewtopic62d2.html?p=48477#p48477" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a></strong> &raquo; </span>16 Aug 2016 02:39
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>penpen wrote:</cite>Is it really removed, or is its execution blocked?</div></blockquote><br />Actually Dave should answer that. This information is quite old:<br /><a href="viewtopic1461.html?f=3&amp;p=27584#p27584" class="postlink">http://www.dostips.com/forum/viewtopic.php?f=3&amp;p=27584#p27584</a><br /><br /><blockquote><div><cite>penpen wrote:</cite>You don't need to execute cmd, just use the set command:</div></blockquote><br />Good idea!<br /><br /><blockquote><div><cite>penpen wrote:</cite>This seems to work under windows 10 (actually can't test it for other win versions):</div></blockquote><br />Right now tested on Win7. Works great.<br /><br /><br />Tested at work too:<br />Not surprizingly the Locale Name and MUI Languages can differ. Indeed half of the commands are in German and half in English <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /> But both searching for &quot;ulib.dll.mui&quot; and wmic report the the same languages.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off &amp;setlocal<br />for /f &quot;tokens=1,2,*&quot; %%a in ('reg query &quot;HKCU\Control Panel\International&quot; /v &quot;LocaleName&quot;^|find &quot;REG_&quot;') do echo %%a=%%c<br /><br />echo ~~~~~~~~~~~~~~~~~~~~~~<br />for /f %%i in ('dir /ad /b &quot;%SystemRoot%\System32\??-??&quot;^|findstr /x &quot;&#91;a-z&#93;&#91;a-z&#93;-&#91;a-z&#93;&#91;a-z&#93;&quot;') do (<br />&nbsp; if exist &quot;%SystemRoot%\System32\%%i\ulib.dll.mui&quot; echo %%i<br />)<br /><br />echo ~~~~~~~~~~~~~~~~~~~~~~<br />wmic os get MUILanguages /value<br /><br />pause</code></pre></div><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>LocaleName=de-DE<br />~~~~~~~~~~~~~~~~~~~~~~<br />de-DE<br />en-US<br />~~~~~~~~~~~~~~~~~~~~~~<br /><br /><br />MUILanguages={&quot;en-US&quot;,&quot;de-DE&quot;}<br /><br /><br /><br />Drücken Sie eine beliebige Taste . . .</code></pre></div><br />Regards<br />aGerman</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p48481" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile48481">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content48481">

						<h3 ><a href="#p48481">Re: Creating a script to gather PC information - to assist those asking for help</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting2f40-2.html?mode=quote&amp;f=3&amp;p=48481" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic7fa0-2.html?p=48481#p48481" onclick="prompt('Message #34',this.href); return false;">#34</a></span> 
									<a class="unread" href="viewtopic7fa0-2.html?p=48481#p48481" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>16 Aug 2016 10:30
			</p>
			
			
			
			<div class="content">The WMI access via JScript worked  <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /> <br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>D:\test&gt;cscript //nologo test.js<br />Extensions (User)<br />1<br />Extensions (System)<br />1<br /></code></pre></div><br />WMIC works perfectly fine in my work environment, and has worked for as long as I have been here.<br /><br />I'm not 100% sure, but I believe csc is removed.<br /><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p48482" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile48482">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search661c.html?author_id=1265&amp;sr=posts">3386</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 22 Jan 2010 18:01</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content48482">

						<h3 ><a href="#p48482">Re: Creating a script to gather PC information - to assist those asking for help</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting74d9.html?mode=quote&amp;f=3&amp;p=48482" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicc3f6.html?p=48482#p48482" onclick="prompt('Message #35',this.href); return false;">#35</a></span> 
									<a class="unread" href="viewtopicc3f6.html?p=48482#p48482" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a></strong> &raquo; </span>16 Aug 2016 11:17
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>dbenham wrote:</cite>The WMI access via JScript worked  <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /> </div></blockquote><br />That's great news. Thanks Dave!<br /><br />Now it's time to assemble the script new before I lose track of all the improvements ...<br /><br />FWIW Is there a way to check if the WSH (JScript in this case) is administrative disabled?<br /><br />Regards<br />aGerman</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p48484" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile48484">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistfcd5.html?mode=viewprofile&amp;u=4915" style="color: #00AA00;" class="username-coloured">penpen</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1bf7.html?author_id=4915&amp;sr=posts">1612</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 Jun 2013 06:15</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content48484">

						<h3 ><a href="#p48484">Re: Creating a script to gather PC information - to assist those asking for help</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinga0d5.html?mode=quote&amp;f=3&amp;p=48484" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic3f4d.html?p=48484#p48484" onclick="prompt('Message #36',this.href); return false;">#36</a></span> 
									<a class="unread" href="viewtopic3f4d.html?p=48484#p48484" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistfcd5.html?mode=viewprofile&amp;u=4915" style="color: #00AA00;" class="username-coloured">penpen</a></strong> &raquo; </span>16 Aug 2016 15:23
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>aGerman wrote:</cite>FWIW Is there a way to check if the WSH (JScript in this case) is administrative disabled?</div></blockquote>This works on Windows 10:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&gt;nul 2&gt;nul cscript /?<br />if errorlevel 1 echo WSH is disabled.<br /></code></pre></div><br /><br />The only way to retrieve the Locale Name (if reg access is disabled) that i could see is <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/dd318693(v=vs.85).aspx" class="postlink">to build it ourselves</a> from the Locale Language Code:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>wmic os get locale</code></pre></div><br /><br />penpen</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p48485" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile48485">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search661c.html?author_id=1265&amp;sr=posts">3386</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 22 Jan 2010 18:01</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content48485">

						<h3 ><a href="#p48485">Re: Creating a script to gather PC information - to assist those asking for help</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting912e.html?mode=quote&amp;f=3&amp;p=48485" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicf1d6-2.html?p=48485#p48485" onclick="prompt('Message #37',this.href); return false;">#37</a></span> 
									<a class="unread" href="viewtopicf1d6-2.html?p=48485#p48485" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a></strong> &raquo; </span>16 Aug 2016 16:32
			</p>
			
			
			
			<div class="content">Thanks penpen!<br /><br /><blockquote><div><cite>penpen wrote:</cite>The only way to retrieve the Locale Name (if reg access is disabled) that i could see is <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/dd318693(v=vs.85).aspx" class="postlink">to build it ourselves</a> from the Locale Language Code:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>wmic os get locale</code></pre></div></div></blockquote><br />I think &quot;MUILanguages&quot; is sufficient in that case. It's already quite a lot of code for just a few informations. Currently more than 350 rows and I'm still working on it <img class="smilies" src="images/smilies/icon_lol.gif" alt=":lol:" title="Laughing" /> <br /><br />Regards<br />aGerman</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p48486" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile48486">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search661c.html?author_id=1265&amp;sr=posts">3386</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 22 Jan 2010 18:01</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content48486">

						<h3 ><a href="#p48486">Re: Creating a script to gather PC information - to assist those asking for help</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingb874.html?mode=quote&amp;f=3&amp;p=48486" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic5e9d-2.html?p=48486#p48486" onclick="prompt('Message #38',this.href); return false;">#38</a></span> 
									<a class="unread" href="viewtopic5e9d-2.html?p=48486#p48486" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a></strong> &raquo; </span>16 Aug 2016 18:30
			</p>
			
			
			
			<div class="content">I know it's not perfect yet. At least I hope there are not too many mistakes...<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@if (@a)==(@b) @end /* :: ~~~~~~~~~ Batch Part ~~~~~~~~~<br />@echo off<br /><br />set ex_noreg=Disabled<br />2&gt;nul set &quot;ex_noreg=Enabled &quot;<br />set de_noreg=Disabled<br />if &quot;!!&quot;==&quot;&quot; (set de_noreg=Enabled )<br /><br />setlocal EnableExtensions DisableDelayedExpansion<br />cd /d &quot;%~dp0&quot;<br />&gt;&quot;%temp%\info.txt&quot; echo &#91;code^&#93;<br /><br />:: prepare some variables to shorten lines in the script<br />set &quot;International=Control Panel\International&quot;<br />set &quot;CurrentVersion=SOFTWARE\Microsoft\Windows NT\CurrentVersion&quot;<br />set &quot;CodePage=SYSTEM\CurrentControlSet\Control\Nls\CodePage&quot;<br />set &quot;CMDproc=Software\Microsoft\Command Processor&quot;<br />set /a &quot;HKCU=80000001, HKLM=80000002, HKU=80000003&quot;<br />set &quot;sys32=%SystemRoot%\System32&quot;<br /><br />:: try to assign variables for used tools in order to make the script run even if the path or pathext variables are corrupted<br />if exist &quot;%sys32%\clip.exe&quot; (set &quot;clip=%sys32%\clip.exe&quot;) else (set &quot;clip=&quot; &amp;&gt;&gt;&quot;%temp%\info.txt&quot; echo clip.exe not found.)<br />if exist &quot;%sys32%\cscript.exe&quot; (set &quot;cscript=%sys32%\cscript.exe&quot;) else set &quot;cscript=cscript.exe&quot;<br />&gt;nul 2&gt;nul %cscript% /? || (set &quot;cscript=&quot; &amp;&gt;&gt;&quot;%temp%\info.txt&quot; echo cscript.exe not accessible.)<br />if exist &quot;%sys32%\find.exe&quot; (set &quot;find=%sys32%\find.exe&quot;) else (set &quot;find=echo&quot; &amp;&gt;&gt;&quot;%temp%\info.txt&quot; echo find.exe not found.)<br />if exist &quot;%sys32%\findstr.exe&quot; (set &quot;findstr=%sys32%\findstr.exe&quot;) else (set &quot;findstr=echo&quot; &amp;&gt;&gt;&quot;%temp%\info.txt&quot; echo findstr.exe not found.)<br />if exist &quot;%sys32%\gpresult.exe&quot; (set &quot;gpresult=%sys32%\gpresult.exe&quot;) else (set &quot;gpresult=&quot; &amp;&gt;&gt;&quot;%temp%\info.txt&quot; echo gpresult.exe not found.)<br />if defined gpresult &gt;nul 2&gt;nul %gpresult% /? || (set &quot;gpresult=&quot; &amp;&gt;&gt;&quot;%temp%\info.txt&quot; echo gpresult.exe not accessible.)<br />if exist &quot;%sys32%\net.exe&quot; (set &quot;net=%sys32%\net.exe&quot;) else (set &quot;net=echo&quot; &amp;&gt;&gt;&quot;%temp%\info.txt&quot; echo net.exe not found.)<br />if exist &quot;%SystemRoot%\notepad.exe&quot; (set &quot;notepad=%SystemRoot%\notepad.exe&quot;) else if exist &quot;%sys32%\notepad.exe&quot; (<br />&nbsp; set &quot;notepad=%sys32%\notepad.exe&quot;<br />) else (set &quot;notepad=%sys32%\cmd.exe /k type&quot; &amp;&gt;&gt;&quot;%temp%\info.txt&quot; echo notepad.exe not found.)<br />if exist &quot;%sys32%\ping.exe&quot; (set &quot;ping=%sys32%\ping.exe&quot;) else (set &quot;ping=(for /l %%i in (0 1 10000) do echo %%i&gt;nul)&amp;echo&quot; &amp;&gt;&gt;&quot;%temp%\info.txt&quot; echo ping.exe not found.)<br />if exist &quot;%sys32%\reg.exe&quot; (set &quot;reg=%sys32%\reg.exe&quot;) else (set &quot;reg=foo?.exe&quot; &amp;&gt;&gt;&quot;%temp%\info.txt&quot; echo reg.exe not found.)<br />if exist &quot;%sys32%\whoami.exe&quot; (set &quot;whoami=%sys32%\whoami.exe&quot;) else (set &quot;whoami=&quot; &amp;&gt;&gt;&quot;%temp%\info.txt&quot; echo whoami.exe not found.)<br />if defined whoami &gt;nul 2&gt;nul %whoami% /? || (set &quot;whoami=&quot; &amp;&gt;&gt;&quot;%temp%\info.txt&quot; echo whoami.exe not acessible.)<br />if exist &quot;%sys32%\wbem\WMIC.exe&quot; (set &quot;wmic=%sys32%\wbem\WMIC.exe&quot;) else (set &quot;wmic=&quot; &amp;&gt;&gt;&quot;%temp%\info.txt&quot; echo wmic.exe not found.)<br />if defined wmic &gt;nul 2&gt;nul %wmic% /? || (set &quot;wmic=&quot; &amp;&gt;&gt;&quot;%temp%\info.txt&quot; echo wmic.exe not accessible.)<br />&gt;&gt;&quot;%temp%\info.txt&quot; echo ----------------------------------------------------------------------------<br /><br /><br />:: list of directories to check if missing in the path variable<br />set dirs=&quot;%SystemRoot%&quot;,&quot;%sys32%&quot;,&quot;%sys32%\wbem&quot;,&quot;%sys32%\WindowsPowerShell\v1.0&quot;<br /><br />:: list ofextensions to check if missing in the pathext variable<br />set ext=.bat,.cmd,.com,.exe,.js,.jse,.msc,.vbe,.vbs,.wsf,.wsh<br /><br />:: list of tools to check if missing in the path environment<br />set tools=certutil,choice,clip,debug,forfiles,gpresult,icacls,openfiles,powershell,robocopy,timeout,whoami,wmic<br /><br />:: check reg access<br />%reg% query &quot;HKCU\%International%&quot; &gt;nul 2&gt;&amp;1 &amp;&amp; (set &quot;RegUserInternational=1&quot;) || (set &quot;RegUserInternational=0&quot;)<br />%reg% query &quot;HKU\.DEFAULT\%International%&quot; &gt;nul 2&gt;&amp;1 &amp;&amp; (set &quot;RegDefInternational=1&quot;) || (set &quot;RegDefInternational=0&quot;)<br />%reg% query &quot;HKLM\%CurrentVersion%&quot; &gt;nul 2&gt;&amp;1 &amp;&amp; (set &quot;RegSysCurrentVersion=1&quot;) || (set &quot;RegSysCurrentVersion=0&quot;)<br />%reg% query &quot;HKLM\%CodePage%&quot; &gt;nul 2&gt;&amp;1 &amp;&amp; (set &quot;RegSysCodePage=1&quot;) || (set &quot;RegSysCodePage=0&quot;)<br />%reg% query &quot;HKCU\%CMDproc%&quot; &gt;nul 2&gt;&amp;1 &amp;&amp; (set &quot;RegUserCMDproc=1&quot;) || (set &quot;RegUserCMDproc=0&quot;)<br />%reg% query &quot;HKLM\%CMDproc%&quot; &gt;nul 2&gt;&amp;1 &amp;&amp; (set &quot;RegSysCMDproc=1&quot;) || (set &quot;RegSysCMDproc=0&quot;)<br /><br />:: check elevation and Admin membership<br />set &quot;RunAs=&quot;<br />%net% session &gt;nul 2&gt;&amp;1 &amp;&amp; (set &quot;RunAs=Yes&quot;)<br />if not defined RunAs if defined cscript (<br />&nbsp; for /f &quot;delims=&quot; %%i in ('%cscript% //nologo //e:jscript &quot;%~fs0&quot; &quot;%HCU%&quot; &quot;HKU\S-1-5-19&quot; &quot;&quot;') do set &quot;RunAs=%%i&quot;<br />)<br />if defined RunAs (if &quot;%RunAs%&quot;==&quot;#AccessDenied&quot; (set &quot;RunAs=No&quot;) else set &quot;RunAs=Yes&quot;) else set &quot;RunAs=No&quot;<br />set &quot;LocalAdmin=&quot;<br />if defined whoami 2&gt;nul %whoami% /groups|&gt;nul %findstr% /i &quot;\&lt;S-1-5-32-544\&gt;&quot; &amp;&amp; set &quot;LocalAdmin=Yes&quot; || set &quot;LocalAdmin=Yes&quot;<br />if not defined LocalAdmin if defined wmic (<br />&nbsp; for /f &quot;tokens=1* delims==&quot; %%i in (<br />&nbsp; &nbsp; '%wmic% path Win32_Group WHERE &quot;LocalAccount='TRUE' AND SID='S-1-5-32-544'&quot; GET Name /value'<br />&nbsp; ) do for /f &quot;delims=&quot; %%k in (&quot;%%j&quot;) do (<br />&nbsp; &nbsp; for /f &quot;tokens=1* delims=:&quot; %%l in ('2^&gt;nul %gpresult% /r /scope user ^| %findstr% /n /c:&quot;--------&quot; /c:&quot;%%k&quot;') do (<br />&nbsp; &nbsp; &nbsp; set &quot;check=&quot;<br />&nbsp; &nbsp; &nbsp; for /f &quot;delims=- &quot; %%n in (&quot;%%m&quot;) do set &quot;check=1&quot;<br />&nbsp; &nbsp; &nbsp; if not defined check (<br />&nbsp; &nbsp; &nbsp; &nbsp; set &quot;n=%%l&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; set &quot;LocalAdmin=No&quot;<br />&nbsp; &nbsp; &nbsp; ) else for /f %%n in ('set /a n') do if %%n lss %%l set &quot;LocalAdmin=Yes&quot;<br />&nbsp; &nbsp; )<br />&nbsp; )<br />) else set &quot;LocalAdmin=Not found&quot;<br /><br />:: International<br />for %%a in (&quot;iDate&quot; &quot;iTime&quot; &quot;LocaleName&quot;) do set &quot;%%~a=&quot;<br />if %RegUserInternational%==1 (call :RegInternational) else if defined cscript call :JsInternational<br />if not defined iDate set &quot;iDate=0&quot;<br />if not defined iTime set &quot;iTime=1&quot;<br />if not defined LocaleName call :MUI<br />if &quot;%iDate%&quot;==&quot;0&quot; (set &quot;format=mm/dd/yy&quot;) else if &quot;%iDate%&quot;==&quot;1&quot; (set &quot;format=dd/mm/yy&quot;) else if &quot;%iDate%&quot;==&quot;2&quot; (set &quot;format=yy/mm/dd&quot;)<br />if &quot;%iTime%&quot;==&quot;0&quot; (set &quot;hours=12&quot;) else set &quot;hours=24&quot;<br /><br />:: ProductName<br />set &quot;ProductName=&quot;<br />if %RegSysCurrentVersion%==1 (call :RegProductName) else if defined cscript call :JsProductName<br />if not defined ProductName for /f &quot;tokens=1* delims==&quot; %%i in ('2^&gt;nul %wmic% os get Caption /value') do set &quot;ProductName=%%j&quot;<br /><br />:: Extensions and DelayedExpansion<br />for %%a in (es eu ds du) do set &quot;%%a=Disabled&quot;<br />if %RegUserCMDproc%==1 (call :RegUserProc) else if defined cscript call :JsUserProc<br />if %RegSysCMDproc%==1 (call :RegSysProc) else if defined cscript call :JsSysProc<br />if not defined eu set &quot;eu=%ex_noreg%&quot;<br />if not defined du set &quot;du=%de_noreg%&quot;<br /><br />:: Code Pages<br />set &quot;OEMCP=&quot; &amp;set &quot;ACP=&quot;<br />if %RegSysCodePage%==1 (call :RegCodePage) else if defined cscript call :JsCodePage<br />if not defined OEMCP for /f &quot;tokens=2 delims=:&quot; %%i in ('CHCP') do set /a &quot;OEMCP=%%~ni&quot;<br />if not defined ACP (<br />&nbsp; if defined wmic (<br />&nbsp; &nbsp; for /f &quot;tokens=2 delims==&quot; %%i in ('%wmic% os get CodeSet /value') do set /a &quot;ACP=%%i&quot;<br />&nbsp; ) else set &quot;ACP=Not found&quot;<br />)<br /><br />:: checks path<br />:: removes random double quotes, adds double quotes, removes trailing slash<br />:: http://stackoverflow.com/questions/5471556/pretty-print-windows-path-variable-how-to-split-on-in-cmd-shell/5472168#5472168<br />set &quot;p=%path:&quot;=&quot;&quot;%&quot;<br />set &quot;p=%p:^=^^%&quot;<br />set &quot;p=%p:&amp;=^&amp;%&quot;<br />set &quot;p=%p:|=^|%&quot;<br />set &quot;p=%p:&lt;=^&lt;%&quot;<br />set &quot;p=%p:&gt;=^&gt;%&quot;<br />set &quot;p=%p:;=^;^;%&quot;<br />set p=%p:&quot;&quot;=&quot;%<br />set &quot;p=%p:&quot;=&quot;&quot;%&quot;<br />set &quot;p=%p:;;=&quot;&quot;;&quot;&quot;%&quot;<br />set &quot;p=%p:^;^;=;%&quot;<br />set &quot;p=%p:&quot;&quot;=&quot;%&quot;<br />set &quot;p=%p:&quot;=&quot;&quot;%&quot;<br />set &quot;p=%p:&quot;&quot;;&quot;&quot;=&quot;;&quot;%&quot;<br />set &quot;p=%p:&quot;&quot;&quot;=&quot;%&quot;<br />set &quot;p=%p:\&quot;=&quot;%&quot;<br /><br />:: Check for 64 bit windows.<br />set &quot;bit=&quot;<br />if defined wmic (<br />&nbsp; for /f &quot;tokens=1* delims==&quot; %%i in ('2^&gt;nul %wmic% os GET OSArchitecture /value') do for /f &quot;delims=&quot; %%k in (&quot;%%j&quot;) do set &quot;bit=%%k&quot;<br />)<br />if defined bit (echo &quot;%bit%&quot;|%find% &quot;64&quot; &gt;nul &amp;&amp; set &quot;bit=64&quot; || set &quot;bit=32&quot;) else (<br />&nbsp; echo &quot;%PROCESSOR_ARCHITECTURE%&quot;|%find% &quot;86&quot; &gt;nul &amp;&amp; set &quot;bit=32&quot; || (<br />&nbsp; &nbsp; if exist &quot;%SystemRoot%\SysWOW64\&quot; (set &quot;bit=64&quot;) else set &quot;bit=32&quot;<br />&nbsp; )<br />)<br /><br />:: RAM space<br />set &quot;ram=&quot;<br />if defined wmic (<br />&nbsp; for /f &quot;tokens=1* delims==&quot; %%i in ('2^&gt;nul %wmic% os GET TotalVisibleMemorySize /value') do for /f &quot;delims=&quot; %%k in (&quot;%%j&quot;) do set &quot;ram=%%k&quot;<br />)<br /><br />:: get the DIR command format to display<br />for /f &quot;delims=&quot; %%a in ('dir &quot;%SystemDrive%\pagefile.sys&quot; /a ^|%find% &quot;:&quot;') do set &quot;DirFormat=%%a&quot;<br /><br />set &quot;pad=&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;<br />:: create the information file and send the information to the clipboard if clip is available<br />&gt;&gt;&quot;%temp%\info.txt&quot; (<br />&nbsp; for /f &quot;delims=&quot; %%a in ('ver') do echo Windows version&nbsp; &nbsp; &nbsp; &nbsp; :&nbsp; %%a<br />&nbsp; echo Product name&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;:&nbsp; %ProductName%, %bit% bit<br />&nbsp; echo Performance indicators :&nbsp; Processor Cores: %NUMBER_OF_PROCESSORS%&nbsp; &nbsp; &nbsp; Visible RAM: %ram% Bytes&amp;echo(<br /><br />&nbsp; echo Date/Time format&nbsp; &nbsp; &nbsp; &nbsp;:&nbsp; %format% (%hours% hours^)&nbsp; &nbsp; &nbsp;%date%&nbsp; %time%<br />&nbsp; echo Extensions&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;:&nbsp; system: %es%&nbsp; user: %eu%<br />&nbsp; echo Delayed expansion&nbsp; &nbsp; &nbsp; :&nbsp; system: %ds%&nbsp; user: %du%<br />&nbsp; echo Locale name&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :&nbsp; %LocaleName%&nbsp; &nbsp; &nbsp; &nbsp;Code Pages: OEM&nbsp; %OEMCP%&nbsp; &nbsp; ANSI %ACP%<br />&nbsp; echo DIR&nbsp; format&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :&nbsp; %DirFormat%<br />&nbsp; echo Permissions&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :&nbsp; Elevated Admin=%RunAs%, Admin group=%LocalAdmin%&amp;echo(<br /><br />&nbsp; rem report if path elements are missing<br />&nbsp; for %%i in (%dirs%) do (<br />&nbsp; &nbsp; set &quot;found=&quot;<br />&nbsp; &nbsp; setlocal EnableDelayedExpansion<br />&nbsp; &nbsp; for %%j in (&quot;!p!&quot;) do (<br />&nbsp; &nbsp; &nbsp; endlocal<br />&nbsp; &nbsp; &nbsp; if /i &quot;%%~i&quot;==%%j set &quot;found=1&quot;<br />&nbsp; &nbsp; &nbsp; setlocal EnableDelayedExpansion<br />&nbsp; &nbsp; )<br />&nbsp; &nbsp; endlocal<br />&nbsp; &nbsp; if not defined found echo(%pad%Missing from the PATH environment: %%~i<br />&nbsp; )<br /><br />&nbsp; rem report if pathext elements are missing<br />&nbsp; for %%i in (%ext%) do (<br />&nbsp; &nbsp; set &quot;found=&quot;<br />&nbsp; &nbsp; for %%j in (%PATHEXT%) do (<br />&nbsp; &nbsp; &nbsp; if /i &quot;%%i&quot;==&quot;%%j&quot; set &quot;found=1&quot;<br />&nbsp; &nbsp; )<br />&nbsp; &nbsp; if not defined found echo(%pad%Missing from the PATHEXT environment: %%~i<br />&nbsp; )<br /><br />&nbsp; rem report if tools are missing<br />&nbsp; for %%i in (%tools%) do for /f &quot;tokens=1,2 delims=?&quot; %%j in (&quot;%%~i.exe?%%~i.com&quot;) do if &quot;%%~$PATH:j%%~$PATH:k&quot;==&quot;&quot; (<br />&nbsp; &nbsp; echo(%pad%Missing from the tool collection:&nbsp; %%i<br />&nbsp; )<br />&nbsp; echo &#91;/code^&#93;<br />)<br />if defined clip (%clip% &lt; &quot;%temp%\info.txt&quot;)<br />:: load the information into Notepad where it can also be copied to the clipboard<br />start &quot;&quot; %notepad% &quot;%temp%\info.txt&quot; &amp; %ping% -n 2 127.0.0.1 &gt;nul &amp; del &quot;%temp%\info.txt&quot;<br /><br />goto :eof<br /><br />:: ~~~~~~~~~ Sub Routines ~~~~~~~~~<br />:RegInternational<br />for /f &quot;tokens=1,2*&quot; %%a in ('%reg% query &quot;HKCU\%International%&quot; /v &quot;i???e&quot; 2^&gt;nul ^| %find% &quot;REG_&quot;') do set &quot;%%~a=%%~c&quot;<br />if %RegDefInternational%==1 for /f &quot;tokens=1,2*&quot; %%a in ('%reg% query &quot;HKU\.DEFAULT\%International%&quot; /v &quot;i???e&quot; 2^&gt;nul ^| %find% &quot;REG_&quot;') do if not defined %%~a set &quot;%%~a=%%~c&quot;<br />for /f &quot;tokens=1,2*&quot; %%a in ('%reg% query &quot;HKCU\%International%&quot; /v &quot;LocaleName&quot; 2^&gt;nul ^| %find% &quot;REG_&quot;') do set &quot;%%~a=%%~c&quot;<br />goto :eof<br /><br />:JsInternational<br />for /f &quot;delims=&quot; %%i in ('%cscript% //nologo //e:jscript &quot;%~fs0&quot; &quot;%HKCU%&quot; &quot;%international%&quot; &quot;iDate&quot;') do set &quot;iDate=%%i&quot;<br />if defined iDate if &quot;%iDate%&quot;==&quot;#NotFound&quot; for /f &quot;delims=&quot; %%i in ('%cscript% //nologo //e:jscript &quot;%~fs0&quot; &quot;%HKU%&quot; &quot;.DEFAULT\%international%&quot; &quot;iDate&quot;') do set &quot;iDate=%%i&quot;<br />if defined iDate if &quot;%iDate:~,1%&quot;==&quot;#&quot; set &quot;iDate=0&quot;<br />for /f &quot;delims=&quot; %%i in ('%cscript% //nologo //e:jscript &quot;%~fs0&quot; &quot;%HKCU%&quot; &quot;%international%&quot; &quot;iTime&quot;') do set &quot;iTime=%%i&quot;<br />if defined iTime if &quot;%iTime%&quot;==&quot;#NotFound&quot; for /f &quot;delims=&quot; %%i in ('%cscript% //nologo //e:jscript &quot;%~fs0&quot; &quot;%HKU%&quot; &quot;.DEFAULT\%international%&quot; &quot;iTime&quot;') do set &quot;iTime=%%i&quot;<br />if defined iTime if &quot;%iTime:~,1%&quot;==&quot;#&quot; set &quot;iTime=1&quot;<br />for /f &quot;delims=&quot; %%i in ('%cscript% //nologo //e:jscript &quot;%~fs0&quot; &quot;%HKCU%&quot; &quot;%international%&quot; &quot;LocaleName&quot;') do set &quot;LocaleName=%%i&quot;<br />if defined LocaleName if &quot;%LocaleName:~,1%&quot;==&quot;#&quot; set &quot;LocaleName=&quot;<br />goto :eof<br /><br />:MUI<br />for /f &quot;tokens=2 delims=={}&quot; %%i in ('2^&gt;nul %wmic% os get MUILanguages /value') do set &quot;LocaleName=%%i&quot;<br />if defined LocaleName (<br />&nbsp; set &quot;LocaleName=%LocaleName:&quot;=%&quot;<br />) else (<br />&nbsp; setlocal EnableDelayedExpansion<br />&nbsp; for /f %%i in ('dir /ad /b &quot;%sys32%\??-??&quot;^|%findstr% /x &quot;&#91;a-z&#93;&#91;a-z&#93;-&#91;a-z&#93;&#91;a-z&#93;&quot;') do (<br />&nbsp; &nbsp; if exist &quot;%sys32%\%%i\ulib.dll.mui&quot; set &quot;LocaleName=!LocaleName!,%%i&quot;<br />&nbsp; )<br />&nbsp; if defined LocaleName (for /f %%j in (&quot;!LocaleName:~1!&quot;) do (endlocal &amp;set &quot;LocaleName=%%j&quot;)) else endlocal<br />)<br />goto :eof<br /><br />:RegProductName<br />for /f &quot;tokens=2*&quot; %%a in ('%reg% query &quot;HKLM\%CurrentVersion%&quot;^|%find% /i &quot;ProductName&quot;') do set &quot;ProductName=%%b&quot;<br />goto :eof<br /><br />:JsProductName<br />for /f &quot;delims=&quot; %%i in ('%cscript% //nologo //e:jscript &quot;%~fs0&quot; &quot;%HKLM%&quot; &quot;%CurrentVersion%&quot; &quot;ProductName&quot;') do set &quot;ProductName=%%i&quot;<br />if defined ProductName if &quot;%ProductName:~,1%&quot;==&quot;#&quot; set &quot;ProductName=&quot;<br />goto :eof<br /><br />:RegUserProc<br />%reg% query &quot;HKCU\%CMDproc%&quot; /v &quot;EnableExtensions&quot; 2&gt;nul|%find% &quot;0x1&quot;&gt;nul &amp;&amp; set &quot;eu=Enabled &quot;<br />%reg% query &quot;HKCU\%CMDproc%&quot; /v &quot;DelayedExpansion&quot; 2&gt;nul|%find% &quot;0x1&quot;&gt;nul &amp;&amp; set &quot;du=Enabled &quot;<br />goto :eof<br /><br />:JsUserProc<br />set &quot;v=&quot;&amp;for /f &quot;delims=&quot; %%i in ('%cscript% //nologo //e:jscript &quot;%~fs0&quot; &quot;%HKCU%&quot; &quot;%CMDproc%&quot; &quot;EnableExtensions&quot;') do set &quot;v=%%i&quot;<br />if defined v if &quot;%v:~,1%&quot;==&quot;#&quot; (set &quot;eu=&quot;) else set &quot;eu=Enabled &quot;<br />set &quot;v=&quot;&amp;for /f &quot;delims=&quot; %%i in ('%cscript% //nologo //e:jscript &quot;%~fs0&quot; &quot;%HKCU%&quot; &quot;%CMDproc%&quot; &quot;DelayedExpansion&quot;') do set &quot;v=%%i&quot;<br />if defined v if &quot;%v:~,1%&quot;==&quot;#&quot; (set &quot;du=&quot;) else set &quot;du=Enabled &quot;<br />goto :eof<br /><br />:RegSysProc<br />%reg% query &quot;HKLM\%CMDproc%&quot; /v &quot;EnableExtensions&quot; 2&gt;nul|%find% &quot;0x1&quot;&gt;nul &amp;&amp; set &quot;es=Enabled &quot;<br />%reg% query &quot;HKLM\%CMDproc%&quot; /v &quot;DelayedExpansion&quot; 2&gt;nul|%find% &quot;0x1&quot;&gt;nul &amp;&amp; set &quot;ds=Enabled &quot;<br />goto :eof<br /><br />:JsSysProc<br />set &quot;v=&quot;&amp;for /f &quot;delims=&quot; %%i in ('%cscript% //nologo //e:jscript &quot;%~fs0&quot; &quot;%HKLM%&quot; &quot;%CMDproc%&quot; &quot;EnableExtensions&quot;') do set &quot;v=%%i&quot;<br />if defined v if &quot;%v:~,1%&quot;==&quot;#&quot; (set &quot;es=&quot;) else set &quot;es=Enabled &quot;<br />set &quot;v=&quot;&amp;for /f &quot;delims=&quot; %%i in ('%cscript% //nologo //e:jscript &quot;%~fs0&quot; &quot;%HKLM%&quot; &quot;%CMDproc%&quot; &quot;DelayedExpansion&quot;') do set &quot;v=%%i&quot;<br />if defined v if &quot;%v:~,1%&quot;==&quot;#&quot; (set &quot;ds=&quot;) else set &quot;ds=Enabled &quot;<br />goto :eof<br /><br />:RegCodePage<br />for /f &quot;tokens=3&quot; %%a in ('%reg% query &quot;HKLM\%CodePage%&quot; /v &quot;OEMCP&quot;') do set /a &quot;OEMCP=%%a&quot;<br />for /f &quot;tokens=3&quot; %%a in ('%reg% query &quot;HKLM\%CodePage%&quot; /v &quot;ACP&quot;') do set /a &quot;ACP=%%a&quot;<br />goto :eof<br /><br />:JsCodePage<br />for /f &quot;delims=&quot; %%i in ('%cscript% //nologo //e:jscript &quot;%~fs0&quot; &quot;%HKLM%&quot; &quot;%CodePage%&quot; &quot;OEMCP&quot;') do set &quot;OEMCP=%%i&quot;<br />if defined OEMCP if &quot;%OEMCP:~,1%&quot;==&quot;#&quot; set &quot;OEMCP=&quot;<br />for /f &quot;delims=&quot; %%i in ('%cscript% //nologo //e:jscript &quot;%~fs0&quot; &quot;%HKLM%&quot; &quot;%CodePage%&quot; &quot;ACP&quot;') do set &quot;ACP=%%i&quot;<br />if defined ACP if &quot;%ACP:~,1%&quot;==&quot;#&quot; set &quot;ACP=&quot;<br />goto :eof<br /><br />:: ~~~~~~~~~ JScript Part ~~~~~~~~~ */<br />var REG_NONE=0, REG_SZ=1, REG_EXPAND_SZ=2, REG_BINARY=3, REG_DWORD=4, REG_MULTI_SZ=7, REG_QWORD=11;<br />var KEY_QUERY_VALUE=0x00000001;<br /><br />function regCheckAccess(strComputer, uHive, strRegPath, uRequiredAccess) {<br />&nbsp; try {<br />&nbsp; &nbsp; var objLocator = new ActiveXObject(&quot;WbemScripting.SWbemLocator&quot;);<br />&nbsp; &nbsp; var objService = objLocator.ConnectServer(strComputer, &quot;root\\default&quot;);<br />&nbsp; &nbsp; objService.Security_.ImpersonationLevel = 3; //wbemImpersonationLevelImpersonate<br />&nbsp; &nbsp; var objReg = objService.Get(&quot;StdRegProv&quot;);<br />&nbsp; &nbsp; var objAccessMethod = objReg.Methods_.Item(&quot;CheckAccess&quot;);<br />&nbsp; &nbsp; var objAccessInParam = objAccessMethod.InParameters.SpawnInstance_();<br />&nbsp; &nbsp; objAccessInParam.hDefKey = uHive;<br />&nbsp; &nbsp; objAccessInParam.sSubKeyName = strRegPath;<br />&nbsp; &nbsp; objAccessInParam.uRequired = uRequiredAccess;<br />&nbsp; &nbsp; var objAccessOutParam = objReg.ExecMethod_(objAccessMethod.Name, objAccessInParam);<br />&nbsp; &nbsp; if (objAccessOutParam.ReturnValue == 0) {<br />&nbsp; &nbsp; &nbsp; if (objAccessOutParam.bGranted) {return true;}<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; return false;<br />&nbsp; }<br />&nbsp; catch(e) {return false;}<br />}<br /><br />function regReadVal(strComputer, uHive, strRegPath, strValName) {<br />&nbsp; try {<br />&nbsp; &nbsp; var vRet = null, iType = -1;<br />&nbsp; &nbsp; var objLocator = new ActiveXObject(&quot;WbemScripting.SWbemLocator&quot;);<br />&nbsp; &nbsp; var objService = objLocator.ConnectServer(strComputer, &quot;root\\default&quot;);<br />&nbsp; &nbsp; objService.Security_.ImpersonationLevel = 3; //wbemImpersonationLevelImpersonate<br />&nbsp; &nbsp; var objReg = objService.Get(&quot;StdRegProv&quot;);<br />&nbsp; &nbsp; var objEnumMethod = objReg.Methods_.Item(&quot;EnumValues&quot;);<br />&nbsp; &nbsp; var objEnumInParam = objEnumMethod.InParameters.SpawnInstance_();<br />&nbsp; &nbsp; objEnumInParam.hDefKey = uHive;<br />&nbsp; &nbsp; objEnumInParam.sSubKeyName = strRegPath;<br />&nbsp; &nbsp; var objEnumOutParam = objReg.ExecMethod_(objEnumMethod.Name, objEnumInParam);<br />&nbsp; &nbsp; if (objEnumOutParam.ReturnValue == 0) {<br />&nbsp; &nbsp; &nbsp; if (objEnumOutParam.sNames != null) {<br />&nbsp; &nbsp; &nbsp; &nbsp; for (var i = 0; i &lt;= objEnumOutParam.sNames.ubound(); i++) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (objEnumOutParam.sNames.getItem(i).toLowerCase() == strValName.toLowerCase()) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; iType = objEnumOutParam.Types.getItem(i);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; else {if (strValName == &quot;&quot;) {iType = REG_NONE;}}<br />&nbsp; &nbsp; &nbsp; if (iType == -1) {return null;}<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; else {return null;}<br />&nbsp; &nbsp; switch (iType) {<br />&nbsp; &nbsp; &nbsp; case REG_SZ:<br />&nbsp; &nbsp; &nbsp; &nbsp; var objGetMethod = objReg.Methods_.Item(&quot;GetStringValue&quot;);<br />&nbsp; &nbsp; &nbsp; &nbsp; var objGetInParam = objGetMethod.InParameters.SpawnInstance_();<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.hDefKey = uHive;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sSubKeyName = strRegPath;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sValueName = strValName;<br />&nbsp; &nbsp; &nbsp; &nbsp; var objGetOutParam = objReg.ExecMethod_(objGetMethod.Name, objGetInParam);<br />&nbsp; &nbsp; &nbsp; &nbsp; if (objGetOutParam.ReturnValue == 0) {vRet = objGetOutParam.sValue;}<br />&nbsp; &nbsp; &nbsp; &nbsp; break;<br />&nbsp; &nbsp; &nbsp; case REG_EXPAND_SZ:<br />&nbsp; &nbsp; &nbsp; &nbsp; var objGetMethod = objReg.Methods_.Item(&quot;GetExpandedStringValue&quot;);<br />&nbsp; &nbsp; &nbsp; &nbsp; var objGetInParam = objGetMethod.InParameters.SpawnInstance_();<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.hDefKey = uHive;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sSubKeyName = strRegPath;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sValueName = strValName;<br />&nbsp; &nbsp; &nbsp; &nbsp; var objGetOutParam = objReg.ExecMethod_(objGetMethod.Name, objGetInParam);<br />&nbsp; &nbsp; &nbsp; &nbsp; if (objGetOutParam.ReturnValue == 0) {vRet = objGetOutParam.sValue;}<br />&nbsp; &nbsp; &nbsp; &nbsp; break;<br />&nbsp; &nbsp; &nbsp; case REG_BINARY:<br />&nbsp; &nbsp; &nbsp; &nbsp; var objGetMethod = objReg.Methods_.Item(&quot;GetBinaryValue&quot;);<br />&nbsp; &nbsp; &nbsp; &nbsp; var objGetInParam = objGetMethod.InParameters.SpawnInstance_();<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.hDefKey = uHive;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sSubKeyName = strRegPath;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sValueName = strValName;<br />&nbsp; &nbsp; &nbsp; &nbsp; var objGetOutParam = objReg.ExecMethod_(objGetMethod.Name, objGetInParam);<br />&nbsp; &nbsp; &nbsp; &nbsp; if (objGetOutParam.ReturnValue == 0) {if (objGetOutParam.uValue != null) {vRet = objGetOutParam.uValue.toArray();}}<br />&nbsp; &nbsp; &nbsp; &nbsp; break;<br />&nbsp; &nbsp; &nbsp; case REG_DWORD:<br />&nbsp; &nbsp; &nbsp; &nbsp; var objGetMethod = objReg.Methods_.Item(&quot;GetDWORDValue&quot;);<br />&nbsp; &nbsp; &nbsp; &nbsp; var objGetInParam = objGetMethod.InParameters.SpawnInstance_();<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.hDefKey = uHive;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sSubKeyName = strRegPath;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sValueName = strValName;<br />&nbsp; &nbsp; &nbsp; &nbsp; var objGetOutParam = objReg.ExecMethod_(objGetMethod.Name, objGetInParam);<br />&nbsp; &nbsp; &nbsp; &nbsp; if (objGetOutParam.ReturnValue == 0) {vRet = objGetOutParam.uValue;}<br />&nbsp; &nbsp; &nbsp; &nbsp; break;<br />&nbsp; &nbsp; &nbsp; case REG_MULTI_SZ:<br />&nbsp; &nbsp; &nbsp; &nbsp; var objGetMethod = objReg.Methods_.Item(&quot;GetMultiStringValue&quot;);<br />&nbsp; &nbsp; &nbsp; &nbsp; var objGetInParam = objGetMethod.InParameters.SpawnInstance_();<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.hDefKey = uHive;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sSubKeyName = strRegPath;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sValueName = strValName;<br />&nbsp; &nbsp; &nbsp; &nbsp; var objGetOutParam = objReg.ExecMethod_(objGetMethod.Name, objGetInParam);<br />&nbsp; &nbsp; &nbsp; &nbsp; if (objGetOutParam.ReturnValue == 0) {if (objGetOutParam.sValue != null) {vRet = objGetOutParam.sValue.toArray();}}<br />&nbsp; &nbsp; &nbsp; &nbsp; break;<br />&nbsp; &nbsp; &nbsp; case REG_QWORD:<br />&nbsp; &nbsp; &nbsp; &nbsp; var objGetMethod = objReg.Methods_.Item(&quot;GetQWORDValue&quot;);<br />&nbsp; &nbsp; &nbsp; &nbsp; var objGetInParam = objGetMethod.InParameters.SpawnInstance_();<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.hDefKey = uHive;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sSubKeyName = strRegPath;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sValueName = strValName;<br />&nbsp; &nbsp; &nbsp; &nbsp; var objGetOutParam = objReg.ExecMethod_(objGetMethod.Name, objGetInParam);<br />&nbsp; &nbsp; &nbsp; &nbsp; if (objGetOutParam.ReturnValue == 0) {vRet = objGetOutParam.uValue;}<br />&nbsp; &nbsp; &nbsp; &nbsp; break;<br />&nbsp; &nbsp; &nbsp; case REG_NONE:<br />&nbsp; &nbsp; &nbsp; &nbsp; var objGetMethod = objReg.Methods_.Item(&quot;GetStringValue&quot;);<br />&nbsp; &nbsp; &nbsp; &nbsp; var objGetInParam = objGetMethod.InParameters.SpawnInstance_();<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.hDefKey = uHive;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sSubKeyName = strRegPath;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sValueName = strValName;<br />&nbsp; &nbsp; &nbsp; &nbsp; var objGetOutParam = objReg.ExecMethod_(objGetMethod.Name, objGetInParam);<br />&nbsp; &nbsp; &nbsp; &nbsp; if (objGetOutParam.ReturnValue == 0) {if (objGetOutParam.sValue != null) {vRet = objGetOutParam.sValue; break;}}<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetMethod = objReg.Methods_.Item(&quot;GetExpandedStringValue&quot;);<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam = objGetMethod.InParameters.SpawnInstance_();<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.hDefKey = uHive;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sSubKeyName = strRegPath;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sValueName = strValName;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetOutParam = objReg.ExecMethod_(objGetMethod.Name, objGetInParam);<br />&nbsp; &nbsp; &nbsp; &nbsp; if (objGetOutParam.ReturnValue == 0) {if (objGetOutParam.sValue != null) {vRet = objGetOutParam.sValue; break;}}<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetMethod = objReg.Methods_.Item(&quot;GetBinaryValue&quot;);<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam = objGetMethod.InParameters.SpawnInstance_();<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.hDefKey = uHive;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sSubKeyName = strRegPath;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sValueName = strValName;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetOutParam = objReg.ExecMethod_(objGetMethod.Name, objGetInParam);<br />&nbsp; &nbsp; &nbsp; &nbsp; if (objGetOutParam.ReturnValue == 0) {if (objGetOutParam.uValue != null) {vRet = objGetOutParam.uValue.toArray(); break;}}<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetMethod = objReg.Methods_.Item(&quot;GetDWORDValue&quot;);<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam = objGetMethod.InParameters.SpawnInstance_();<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.hDefKey = uHive;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sSubKeyName = strRegPath;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sValueName = strValName;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetOutParam = objReg.ExecMethod_(objGetMethod.Name, objGetInParam);<br />&nbsp; &nbsp; &nbsp; &nbsp; if (objGetOutParam.ReturnValue == 0) {if (objGetOutParam.uValue != null) {vRet = objGetOutParam.uValue; break;}}<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetMethod = objReg.Methods_.Item(&quot;GetMultiStringValue&quot;);<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam = objGetMethod.InParameters.SpawnInstance_();<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.hDefKey = uHive;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sSubKeyName = strRegPath;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sValueName = strValName;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetOutParam = objReg.ExecMethod_(objGetMethod.Name, objGetInParam);<br />&nbsp; &nbsp; &nbsp; &nbsp; if (objGetOutParam.ReturnValue == 0) {if (objGetOutParam.sValue != null) {vRet = objGetOutParam.sValue.toArray(); break;}}<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetMethod = objReg.Methods_.Item(&quot;GetQWORDValue&quot;);<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam = objGetMethod.InParameters.SpawnInstance_();<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.hDefKey = uHive;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sSubKeyName = strRegPath;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetInParam.sValueName = strValName;<br />&nbsp; &nbsp; &nbsp; &nbsp; objGetOutParam = objReg.ExecMethod_(objGetMethod.Name, objGetInParam);<br />&nbsp; &nbsp; &nbsp; &nbsp; if (objGetOutParam.ReturnValue == 0) {if (objGetOutParam.uValue != null) {vRet = objGetOutParam.uValue; break;}}<br />&nbsp; &nbsp; &nbsp; default:<br />&nbsp; &nbsp; &nbsp; &nbsp; return null;<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; return vRet;<br />&nbsp; }<br />&nbsp; catch(e) {return null;}<br />}<br /><br />if (regCheckAccess(&quot;.&quot;, parseInt(WScript.Arguments(0), 16), WScript.Arguments(1), KEY_QUERY_VALUE) === false) {<br />&nbsp; WScript.Echo(&quot;#AccessDenied&quot;);<br />} else {<br />&nbsp; var v = regReadVal(&quot;.&quot;, parseInt(WScript.Arguments(0), 16), WScript.Arguments(1), WScript.Arguments(2));<br />&nbsp; if (v === null)<br />&nbsp; {<br />&nbsp; &nbsp; WScript.Echo(&quot;#NotFound&quot;);<br />&nbsp; } else {<br />&nbsp; &nbsp; WScript.Echo(v);<br />&nbsp; }<br />}<br /><br />/*<br />:eof<br />:: */</code></pre></div><br />Possible output<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>----------------------------------------------------------------------------<br />Windows version&nbsp; &nbsp; &nbsp; &nbsp; :&nbsp; Microsoft Windows &#91;Version 10.0.10586&#93;<br />Product name&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;:&nbsp; Windows 10 Home, 32 bit<br />Performance indicators :&nbsp; Processor Cores: 4&nbsp; &nbsp; &nbsp; Visible RAM: 2023612 Bytes<br /><br />Date/Time format&nbsp; &nbsp; &nbsp; &nbsp;:&nbsp; dd/mm/yy (24 hours)&nbsp; &nbsp; &nbsp;21.08.2016&nbsp; 16:18:26,28<br />Extensions&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;:&nbsp; system: Enabled&nbsp; &nbsp;user: Enabled <br />Delayed expansion&nbsp; &nbsp; &nbsp; :&nbsp; system: Disabled&nbsp; user: Disabled<br />Locale name&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :&nbsp; de-DE&nbsp; &nbsp; &nbsp; &nbsp;Code Pages: OEM&nbsp; 850&nbsp; &nbsp; ANSI 1252<br />DIR&nbsp; format&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :&nbsp; 21.08.2016&nbsp; 12:30&nbsp; &nbsp; &nbsp; &nbsp;738.197.504 pagefile.sys<br />Permissions&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :&nbsp; Elevated Admin=No, Admin group=Yes<br /><br /></code></pre></div><br /><br />Regards<br />aGerman<br /><br />//EDIT<br />08/21/2016 changed behavior if tools were not found, removed restart, added SETLOCAL ENABLEEXTENSIONS DISABLEDELAYEDEXPANSION<br />08/19/2016 use GPRESULT for local admin check, minor changes<br />08/18/2016 %NUMBER_OF_PROCESSORS% added again as well as RAM space; elevation check changed, minor corrections<br />08/17/2016 %NUMBER_OF_PROCESSORS% removed; detection of bitness and local admin improved</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p48488" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile48488">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist1ec2.html?mode=viewprofile&amp;u=5449" class="username">Compo</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf4cb.html?author_id=5449&amp;sr=posts">485</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 21 Mar 2014 08:50</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content48488">

						<h3 ><a href="#p48488">Re: Creating a script to gather PC information - to assist those asking for help</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingda94.html?mode=quote&amp;f=3&amp;p=48488" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic650f.html?p=48488#p48488" onclick="prompt('Message #39',this.href); return false;">#39</a></span> 
									<a class="unread" href="viewtopic650f.html?p=48488#p48488" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist1ec2.html?mode=viewprofile&amp;u=5449" class="username">Compo</a></strong> &raquo; </span>17 Aug 2016 00:39
			</p>
			
			
			
			<div class="content">Could someone please explain the purpose of including %PROCESSOR_ARCHITECTURE% and %NUMBER_OF_PROCESSORS%. What information does it give which may affect the writing of a script solution? Surely an indication only of %Bit% is needed.<br /><br />This is the only use I can see for %PROCESSOR_ARCHITECTURE%<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>Set bit=32 bit<br />If %PROCESSOR_ARCHITECTURE:~-2% Equ 64 (If Exist &quot;%SYSTEMROOT%\SysWOW64\&quot; Set bit=64 bit)</code></pre></div></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p48489" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile48489">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search661c.html?author_id=1265&amp;sr=posts">3386</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 22 Jan 2010 18:01</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content48489">

						<h3 ><a href="#p48489">Re: Creating a script to gather PC information - to assist those asking for help</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingdaff.html?mode=quote&amp;f=3&amp;p=48489" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicba9f.html?p=48489#p48489" onclick="prompt('Message #40',this.href); return false;">#40</a></span> 
									<a class="unread" href="viewtopicba9f.html?p=48489#p48489" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a></strong> &raquo; </span>17 Aug 2016 02:29
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>Compo wrote:</cite>Could someone please explain the purpose of including %PROCESSOR_ARCHITECTURE% and %NUMBER_OF_PROCESSORS%.</div></blockquote><br />%NUMBER_OF_PROCESSORS% did foxidrive include. I don't know the purpose but I remember that we had some discussions about speed and number of parallel threads. But generally I agree with you that this information is not necessarily needed.<br /><br />The existence of &quot;%SystemRoot%\SysWOW64&quot; is actually sufficient to detect a 64 bit system. However this directory could be  created by hand on a 32 bit system too. That could be detected if you know the value of %PROCESSOR_ARCHITECTURE% with the following rules:<br />- if both processor and existence of SysWOW64 fit together we have only little uncertainties<br />- x86 processor does always mean that the OS is 32 bit even if SysWOW64 exists for whatever reason<br />- x64 processor together with the absence of SysWOW64 would most likely mean that the OS is 32 bit<br /><br />I'll try to merge these informations and perhaps include an additional check using WMIC ...<br /><br />Regards<br />aGerman</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p48495" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile48495">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search661c.html?author_id=1265&amp;sr=posts">3386</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 22 Jan 2010 18:01</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content48495">

						<h3 ><a href="#p48495">Re: Creating a script to gather PC information - to assist those asking for help</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting1cea.html?mode=quote&amp;f=3&amp;p=48495" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic1008.html?p=48495#p48495" onclick="prompt('Message #41',this.href); return false;">#41</a></span> 
									<a class="unread" href="viewtopic1008.html?p=48495#p48495" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a></strong> &raquo; </span>17 Aug 2016 07:41
			</p>
			
			
			
			<div class="content">This line<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>%wmic% path Win32_Group WHERE &quot;LocalAccount='TRUE' AND SID='S-1-5-32-544'&quot; assoc /assocclass:Win32_GroupUser|&gt;nul %findstr% /c:Name^=\&quot;%username%\&quot; &amp;&amp; set &quot;LocalAdmin=Yes&quot;</code></pre></div><br />took more than half an hour on my PC at work. Probably because of thousands of users in the domain the associated Win32_GroupUser is terribly slow.<br />Does anybody know of a better way?<br /><br />Regards<br />aGerman</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p48496" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile48496">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist2675.html?mode=viewprofile&amp;u=2988" style="color: #00AA00;" class="username-coloured">Squashman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1322.html?author_id=2988&amp;sr=posts">3970</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 Dec 2011 13:59</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content48496">

						<h3 ><a href="#p48496">Re: Creating a script to gather PC information - to assist those asking for help</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting9f5c.html?mode=quote&amp;f=3&amp;p=48496" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic0ae4.html?p=48496#p48496" onclick="prompt('Message #42',this.href); return false;">#42</a></span> 
									<a class="unread" href="viewtopic0ae4.html?p=48496#p48496" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist2675.html?mode=viewprofile&amp;u=2988" style="color: #00AA00;" class="username-coloured">Squashman</a></strong> &raquo; </span>17 Aug 2016 08:03
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>aGerman wrote:</cite>@Squashman<br />SYSTEMIINFO is one of the damn commands that is completely language dependent  <img class="smilies" src="images/smilies/icon_sad.gif" alt=":(" title="Sad" /> <br /></div></blockquote><br />Darn!  Why didn't Bill just write everything in Klingon and call it good.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p48500" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile48500">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search661c.html?author_id=1265&amp;sr=posts">3386</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 22 Jan 2010 18:01</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content48500">

						<h3 ><a href="#p48500">Re: Creating a script to gather PC information - to assist those asking for help</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinge5b5.html?mode=quote&amp;f=3&amp;p=48500" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic6776-2.html?p=48500#p48500" onclick="prompt('Message #43',this.href); return false;">#43</a></span> 
									<a class="unread" href="viewtopic6776-2.html?p=48500#p48500" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a></strong> &raquo; </span>17 Aug 2016 11:19
			</p>
			
			
			
			<div class="content">@Compo<br />I changed the code above accordingly.<br /><br />@Squashman<br />I would be fine with Klingon if that was something we could rely on <img class="smilies" src="images/smilies/icon_lol.gif" alt=":lol:" title="Laughing" /> The MUI concept is poison for scripters  <img class="smilies" src="images/smilies/icon_rolleyes.gif" alt=":roll:" title="Rolling Eyes" /> <br /><br />Regards<br />aGerman</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p48504" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile48504">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf147.html?author_id=3221&amp;sr=posts">6033</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Feb 2012 02:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content48504">

						<h3 ><a href="#p48504">Re: Creating a script to gather PC information - to assist those asking for help</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingf3fa.html?mode=quote&amp;f=3&amp;p=48504" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic8056.html?p=48504#p48504" onclick="prompt('Message #44',this.href); return false;">#44</a></span> 
									<a class="unread" href="viewtopic8056.html?p=48504#p48504" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a></strong> &raquo; </span>17 Aug 2016 20:47
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>Compo wrote:</cite>Could someone please explain the purpose of including %PROCESSOR_ARCHITECTURE% and %NUMBER_OF_PROCESSORS%. What information does it give which may affect the writing of a script solution? Surely an indication only of %Bit% is needed.<br /></div></blockquote><br /><br />You included this aspect in your question and then showed it was actually good information.  I commented on it anyway.<br /><br />64 bit Windows isn't the same as 32 bit Windows when accessing different parts of Windows.<br /><br /><br />The number of cores only gives an indication of the machine capability.  <br />This example is unlikely but it shows that there are situations that you can't readily think of:  If a user comes back and says &quot;This script took 8 hours to run here, how come?&quot; and we can see he's running a single core CPU then appropriate questions can be asked.<br /><br />I'm only answering your question and it doesn't bother me at all if cpu cores isn't included.  This script was designed to provide a good range of general information and that data was already in an environment variable so I just shoved it in.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p48510" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile48510">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search661c.html?author_id=1265&amp;sr=posts">3386</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 22 Jan 2010 18:01</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content48510">

						<h3 ><a href="#p48510">Re: Creating a script to gather PC information - to assist those asking for help</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingd12c.html?mode=quote&amp;f=3&amp;p=48510" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicd779.html?p=48510#p48510" onclick="prompt('Message #45',this.href); return false;">#45</a></span> 
									<a class="unread" href="viewtopicd779.html?p=48510#p48510" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a></strong> &raquo; </span>18 Aug 2016 05:06
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>foxidrive wrote:</cite>The number of cores only gives an indication of the machine capability.</div></blockquote><br />Hmm. The number of cores is rather only one of many indicators. Installed memory, frequency of the CPU, current usage of CPU and RAM, etc. are further indicators (but still an incomplete list). Thus, I think Compo's objection is valid. That's the reason why I already left it out.<br /><br />Steffen</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
	

	<div class="action-bar bar-bottom">
	
			<a href="posting0b06.html?mode=reply&amp;f=3&amp;t=7347" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic133a.html?f=3&amp;t=7347&amp;start=30&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

			<form method="post" action="https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=7347&amp;start=30">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			158 posts
							<ul>
	<li class="dropdown-container dropdown-button-control dropdown-page-jump page-jump">
		<a class="button button-icon-only dropdown-trigger" href="#" title="Click to jump to page…" role="button"><i class="icon fa-level-down fa-rotate-270" aria-hidden="true"></i><span class="sr-only">Page <strong>3</strong> of <strong>11</strong></span></a>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
				<li>Jump to page:</li>
				<li class="page-jump-form">
					<input type="number" name="page-number" min="1" max="999999" title="Enter the page number you wish to go to" class="inputbox tiny" data-per-page="15" data-base-url=".&#x2F;viewtopic.php&#x3F;f&#x3D;3&amp;amp&#x3B;t&#x3D;7347" data-start-name="start" />
					<input class="button2" value="Go" type="button" />
				</li>
			</ul>
		</div>
	</li>
			<li class="arrow previous"><a class="button button-icon-only" href="viewtopic49cd.html?f=3&amp;t=7347&amp;start=15" rel="prev" role="button"><i class="icon fa-chevron-left fa-fw" aria-hidden="true"></i><span class="sr-only">Previous</span></a></li>
				<li><a class="button" href="viewtopic1343.html?f=3&amp;t=7347" role="button">1</a></li>
				<li><a class="button" href="viewtopic49cd.html?f=3&amp;t=7347&amp;start=15" role="button">2</a></li>
			<li class="active"><span>3</span></li>
				<li><a class="button" href="viewtopic7c37.html?f=3&amp;t=7347&amp;start=45" role="button">4</a></li>
				<li><a class="button" href="viewtopiccda4-2.html?f=3&amp;t=7347&amp;start=60" role="button">5</a></li>
			<li class="ellipsis" role="separator"><span>…</span></li>
				<li><a class="button" href="viewtopic66e3.html?f=3&amp;t=7347&amp;start=150" role="button">11</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopic7c37.html?f=3&amp;t=7347&amp;start=45" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="viewforum4d6b.html?f=3" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to “DOS Batch Forum”</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="viewforum31e6.html?f=4" class="jumpbox-cat-link"> <span> DosTips - Dos Batch</span></a></li>
																<li><a href="viewforum4d6b.html?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; DOS Batch Forum</span></a></li>
											</ul>
		</div>
	</div>

	</div>


			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
							<span class="crumb"><a href="../index.html" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>DosTips.com</span></a></span>									<span class="crumb"><a href="index.html" data-navbar-reference="index"><span>Board index</span></a></span>					</li>
		
				<li class="rightside">All times are <span title="UTC-6">UTC-06:00</span></li>
							<li class="rightside">
				<a href="ucp033a.html?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete all board cookies</span>
				</a>
			</li>
												<li class="rightside" data-last-responsive="true">
				<a href="memberlist4bfd.html?mode=team" role="menuitem">
					<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
				</a>
			</li>
									<li class="rightside" data-last-responsive="true">
				<a href="memberlist8733.html?mode=contactadmin" role="menuitem">
					<i class="icon fa-envelope fa-fw" aria-hidden="true"></i><span>Contact us</span>
				</a>
			</li>
			</ul>

	</div>
</div>

	<div class="copyright">
				<!-- WARNING NO DELETE -->Style developer by <a href="http://tricolor.x-tk.ru/">support forum tricolor</a>, <!-- END WARNING NO DELETE -->Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
									</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	<img src="cron5495.gif?cron_type=cron.task.text_reparser.poll_title" width="1" height="1" alt="cron" /></div>

<script type="text/javascript" src="assets/javascript/jquery.mind772.js?assets_version=34"></script>
<script type="text/javascript" src="assets/javascript/cored772.js?assets_version=34"></script>



<script type="text/javascript" src="styles/prosilver/template/forum_fnd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/prosilver/template/ajaxd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/jquery-uid772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/collapsed772.js?assets_version=34"></script>



</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=7347&start=30 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 07:51:05 GMT -->
</html>
