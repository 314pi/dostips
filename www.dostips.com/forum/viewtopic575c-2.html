<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=5217 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 08:46:13 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>Pure DOS valid Date checker - DosTips.com</title>


	<link rel="canonical" href="viewtopicd29a.html?t=5217">

<!--
	phpBB style name: Allan Style - SUBSILVER
	Based on style:   prosilver (this is the default phpBB3 style)
	Based on style:   subsilver2 (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:  Allan ( http://x-tk.ru/ )
-->

<link href="assets/css/font-awesome.mind772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/stylesheetd772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/en/stylesheetd772.css?assets_version=34" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="./styles/AllanStyle-SUBSILVER/theme/tweaks.css?assets_version=34" rel="stylesheet">
<![endif]-->




<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','../../www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-280191-1', 'auto');
	ga('send', 'pageview');
</script>

</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">

<div id="header-subsilver">
	<a id="top" class="top-anchor" accesskey="t"></a>
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description" class="site-description">
				<a id="logo" class="logo" href="../index.html" title="DosTips.com"><span class="site_logo"></span></a>
				<h1>DosTips.com</h1>
				<p>A Forum all about DOS Batch</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

									<div id="search-box" class="search-box search-header" role="search">
				<form action="https://www.dostips.com/forum/search.php" method="get" id="search">
				<fieldset>
					<input name="keywords" id="keywords" type="search" maxlength="128" title="Search for keywords" class="inputbox search tiny" size="20" value="" placeholder="Search…" />
					<button class="button button-search" type="submit" title="Search">
						<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
					</button>
					<a href="search.html" class="button button-search-end" title="Advanced search">
						<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
					</a>
					
				</fieldset>
				</form>
			</div>
						
			</div>
					</div>
</div>


<div id="wrap" class="wrap">
	<div id="page-header">
				<div class="navbar-top" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
																									<li>
								<a href="search33a7.html?search_id=unanswered" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="search526f.html?search_id=active_topics" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-blue" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="search.html" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
											<li class="separator"></li>
																			<li>
								<a href="memberlist4bfd.html?mode=team" role="menuitem">
									<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
								</a>
							</li>
																<li class="separator"></li>

									</ul>
			</div>
		</li>

				<li data-skip-responsive="true">
			<a href="app.php/help/faq.html" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
						
			<li class="rightside"  data-skip-responsive="true">
			<a href="ucp26c3.html?mode=login" title="Login" accesskey="x" role="menuitem">
				<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Login</span>
			</a>
		</li>
					<li class="rightside" data-skip-responsive="true">
				<a href="ucp8319.html?mode=register" role="menuitem">
					<i class="icon fa-pencil-square-o  fa-fw" aria-hidden="true"></i><span>Register</span>
				</a>
			</li>
						</ul>

	</div>
</div>

<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
						<li class="breadcrumbs">
							<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="../index.html" itemprop="url" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span itemprop="title">DosTips.com</span></a></span>
										<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="index.html" itemprop="url" accesskey="h" data-navbar-reference="index"><span itemprop="title">Board index</span></a></span>

											<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="4"><a href="viewforum31e6.html?f=4" itemprop="url"><span itemprop="title">DosTips - Dos Batch</span></a></span>
															<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="3"><a href="viewforum4d6b.html?f=3" itemprop="url"><span itemprop="title">DOS Batch Forum</span></a></span>
												</li>
		
					<li class="rightside responsive-search">
				<a href="search.html" title="View the advanced search options" role="menuitem">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</a>
			</li>
			</ul>

	</div>
</div>

<div class="navbar-top-link">
	<div class="inner">
		<ul>
			<li class="navbar-top-link-left"><a href="search33a7.html?search_id=unanswered">Unanswered topics</a></li>
			<li class="navbar-top-link-left"><a href="search526f.html?search_id=active_topics">Active topics</a></li>

											</ul>
	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
		
<h2 class="topic-title"><a href="viewtopic575c-2.html?f=3&amp;t=5217">Pure DOS valid Date checker</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">Discussion forum for all Windows batch related topics.<br /></div>
<p>
	<strong>Moderator:</strong> <a href="memberlista6a8.html?mode=viewprofile&amp;u=5" class="username">DosItHelp</a>
</p>


<div class="action-bar bar-top">
	
			<a href="posting6e70.html?mode=reply&amp;f=3&amp;t=5217" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopicd080-2.html?f=3&amp;t=5217&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="https://www.dostips.com/forum/search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topic…" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="search.html" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="5217" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			6 posts
							&bull; Page <strong>1</strong> of <strong>1</strong>
					</div>
		</div>




<div id="subsilver-nav-topic">
	<div class="inner"><div class="post has-profile">
		<div class="leftsided postbody subsilver-topic-title">Message</div>
		<div class="leftsided postprofile subsilver-topic-author">Author</div>
	</div></div>
</div>

			<div id="p31117" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile31117">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist7557.html?mode=viewprofile&amp;u=4243" class="username">carlsomo</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search15dd.html?author_id=4243&amp;sr=posts">91</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 02 Oct 2012 17:21</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content31117">

						<h3 class="first"><a href="#p31117">Pure DOS valid Date checker</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting7ec7.html?mode=quote&amp;f=3&amp;p=31117" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic3730.html?p=31117#p31117" onclick="prompt('Message #1',this.href); return false;">#1</a></span> 
									<a class="unread" href="viewtopic3730.html?p=31117#p31117" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist7557.html?mode=viewprofile&amp;u=4243" class="username">carlsomo</a></strong> &raquo; </span>30 Dec 2013 00:49
			</p>
			
			
			
			<div class="content"><span style="color: #0000BF">**EDIT: See my post on Sun, Jan 26, 2014 for latest update / correction for older dates **</span><br /><br />I often write routines that allow a user to input a date. This is very often very problematic to say the least.<br />Users often do not care about which format is expected and routines that may call this routine may have<br />been programmed with a specific date format peculiar to the country or machine in use. This routine<br />chooses to ignore the 'Tue 12/24/2013' and '24-Dec-13' formats since users never input that way. These<br />formats are typically generated by accessing %date% in these peculiar formats and thus are correct dates.<br />This flexible routine determines if a date passed is a valid date (AD) and accepts multiple date formats.<br />It does not rely on any outside programs such as xcopy, WMIC, etc.  Nor does it access the registry.<br />Leap years are processed appropriately, including years divisible by 100 with no leap year unless<br />divisible by 400, like the year 2000, which had a leap year.  Please report any bugs if found.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off&amp;goto :start<br />:Valid_Date Date<br />echo.:::----------------------------------------------------------:::<br />echo.::: Syntax: Valid_Date 'Date'&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :::<br />echo.:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :::<br />echo.::: Date may be passed as a value or as a reference variable :::<br />echo.::: Checks for validity of the Date value, which may be in&nbsp; &nbsp;:::<br />echo.::: M-D-Y, MM-DD-YYYY, YYYYMMDD or Julian (7 digit) format&nbsp; &nbsp;:::<br />echo.::: Non English YYYY.MM.DD is valid if year is gtr 2 digits&nbsp; :::<br />echo.::: Year must be at least year 0 AD to be considered valid&nbsp; &nbsp;:::<br />echo.::: 1 or 2 digit years in M-D-Y format are considered 2000+&nbsp; :::<br />echo.::: For example the year 11 A.D. should be passed as 0011&nbsp; &nbsp; :::<br />echo.::: The Valid date parameter separators are: '/' '-' and '.' ::: <br />echo.::: Returns 0 in errorlevel if date is valid, else non zero&nbsp; :::<br />echo.:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :::<br />echo.:::----------------------------------------------------------:::<br />exit /b 1<br /><br />:start<br />if &quot;%~1&quot;==&quot;&quot; goto :Valid_Date Syntax<br />if &quot;%~1&quot;==&quot;/?&quot; goto :Valid_Date Syntax<br />SetLocal EnableDelayedExpansion<br />if defined %~1 (set &quot;dte=!%~1!&quot;) else (set &quot;dte=%~1&quot;)<br />set &quot;invalid=&quot;<br />set &quot;sep=&quot;<br />set/a err=1<br />for /f &quot;tokens=1* delims=0123456789-/.&quot; %%a in (&quot;!dte!&quot;) do set &quot;err=%%a&quot;<br />if /i !err! neq 1 set/a err=1&amp;goto :end<br />for /f &quot;tokens=1-2* delims=0123456789&quot; %%a in (&quot;!dte!&quot;) do (<br />&nbsp; set &quot;err=%%a&quot;&amp;set &quot;sep=%%b&quot;&amp;set &quot;invalid=%%c&quot;<br />)<br />call :strln dte len<br />if /i !err! equ 1 ( REM string is numeric only<br />&nbsp; if /i !len! lss 7 goto :end<br />&nbsp; if /i !len! gtr 8 goto :end<br />) else ( REM valid separators found in string<br />&nbsp; set/a err=2<br />&nbsp; if defined invalid goto :end<br />&nbsp; if not defined sep goto :end<br />&nbsp; if /i !len! lss 5 goto :end<br />&nbsp; if /i !len! gtr 10 goto :end<br />)<br />set &quot;dte=%dte:/=-%&quot;<br />set &quot;dte=%dte:.=-%&quot;<br />echo !dte!|Find &quot;--&quot;&gt;nul<br />if !errorlevel! equ 0 goto :end<br />set &quot;ymd=%dte:-=%&quot;<br />if /i !err! equ 1 ( REM process numeric only string<br />&nbsp; if /i !len! equ 7 (call :gdate ymd &amp;set/a err=0)<br />&nbsp; set &quot;dte=!ymd:~4,2!-!ymd:~6,2!-!ymd:~0,4!&quot;<br />)<br />if !err! neq 0 ( REM process separated string<br />&nbsp; for /f &quot;tokens=1-3 delims=-&quot; %%A in (&quot;!dte!&quot;) do (<br />&nbsp; &nbsp; set mm=%%A&amp;set dd=%%B&amp; set &quot;yy=%%C&quot;<br />&nbsp; &nbsp; call :strln mm mlen<br />&nbsp; &nbsp; if /i !mlen! gtr 2 if /i &quot;!sep!&quot; equ &quot;.&quot; (<br />&nbsp; &nbsp; &nbsp; set yy=%%A&amp;set mm=%%B&amp;set &quot;dd=%%C&quot;<br />&nbsp; &nbsp; &nbsp; if not defined dd goto :end<br />&nbsp; &nbsp; )<br />&nbsp; )<br />&nbsp; if not defined yy goto :end<br />&nbsp; call :strln yy ylen<br />&nbsp; if /i !dd! gtr 31 goto :end<br />&nbsp; if /i !mm! gtr 12 goto :end<br />&nbsp; set/a yy=10000!yy! %% 10000,mm=100!mm! %% 100,dd=100!dd! %% 100<br />&nbsp; if !yy! LSS 100 if /i !ylen! lss 3 set /a yy+=2000<br />&nbsp; call :jdate JD yy mm dd<br />&nbsp; if /i 1!mm! lss 20 set &quot;mm=0!mm!&quot;<br />&nbsp; if /i 1!dd! lss 20 set &quot;dd=0!dd!&quot;<br />&nbsp; set &quot;ymd=!yy!!mm!!dd!&quot;<br />&nbsp; call :Gdate JD<br />&nbsp; if /i !JD! equ !ymd! set/a err=0<br />)<br />:end<br />EndLocal&amp;exit /b %err%<br /><br />:gdate<br />setlocal enabledelayedexpansion<br />set &quot;p=!%~1!&quot;<br />set /a p&nbsp; &nbsp; &nbsp; = p + 68569<br />set /a q&nbsp; &nbsp; &nbsp; = 4 * %p% / 146097<br />set /a r&nbsp; &nbsp; &nbsp; = %p% - ( 146097 * %q% +3 ) / 4<br />set /a s&nbsp; &nbsp; &nbsp; = 4000 * ( %r% + 1 ) / 1461001<br />set /a t&nbsp; &nbsp; &nbsp; = %r% - 1461 * %s% / 4 + 31<br />set /a u&nbsp; &nbsp; &nbsp; = 80 * %t% / 2447<br />set /a v&nbsp; &nbsp; &nbsp; = %u% / 11<br />set /a GYear&nbsp; = 100 * ( %q% - 49 ) + %s% + %v%<br />set /a GMonth = %u% + 2 - 12 * %v%<br />set /a GDay&nbsp; &nbsp;= %t% - 2447 * %u% / 80<br />if /i 1%GMonth% lss 20 set &quot;GMonth=0%GMonth%&quot;<br />if /i 1%GDay%&nbsp; &nbsp;lss 20 set &quot;GDay=0%GDay%&quot;<br />endlocal&amp;(<br />&nbsp; set &quot;%~1=%GYear%%GMonth%%GDay%&quot;<br />)&amp;exit/b %GYear%%GMonth%%GDay%<br /><br />:jdate<br />setlocal enabledelayedexpansion<br />set/a yy=!%~2!,mm=!%~3!,dd=!%~4!<br />set /a JD=dd-32075+1461*(yy+4800+(mm-14)/12)/4+367*(mm-2-(mm-14)/12*12)/12-3*((yy+4900+(mm-14)/12)/100)/4<br />endlocal&amp;set/a %~1=%JD%&amp;exit/b<br /><br />:Strln<br />( SetLocal<br />&nbsp; set &quot;str=A!%~1!&quot;<br />&nbsp; set &quot;len=0&quot;<br />&nbsp; for /L %%A in (12,-1,0) do (<br />&nbsp; &nbsp; set /a &quot;len|=1&lt;&lt;%%A&quot;<br />&nbsp; &nbsp; for %%B in (!len!) do if &quot;!str:~%%B,1!&quot;==&quot;&quot; set /a &quot;len&amp;=~1&lt;&lt;%%A&quot;<br />&nbsp; )<br />)<br />EndLocal&amp;(<br />&nbsp; if &quot;%~2&quot; NEQ &quot;&quot; set/a %~2=%len%<br />)&amp;exit /b %len%<br /></code></pre></div></div>

			
													<div class="notice">
					Last edited by <a href="memberlist7557.html?mode=viewprofile&amp;u=4243" class="username">carlsomo</a> on 26 Jan 2014 16:27, edited 1 time in total.
									</div>
			
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p31118" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile31118">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist6005.html?mode=viewprofile&amp;u=5253" class="username">berserker</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search2ffb.html?author_id=5253&amp;sr=posts">95</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 18 Dec 2013 00:51</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content31118">

						<h3 ><a href="#p31118">Re: Pure DOS valid Date checker</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting854f.html?mode=quote&amp;f=3&amp;p=31118" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicc3a9.html?p=31118#p31118" onclick="prompt('Message #2',this.href); return false;">#2</a></span> 
									<a class="unread" href="viewtopicc3a9.html?p=31118#p31118" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist6005.html?mode=viewprofile&amp;u=5253" class="username">berserker</a></strong> &raquo; </span>30 Dec 2013 01:40
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>carlsomo wrote:</cite>This routine<br />chooses to ignore the 'Tue 12/24/2013' and '24-Dec-13' formats since users never input that way. These<br />formats are typically generated by accessing %date% in these peculiar formats and thus are correct dates.</div></blockquote><br />if you look regional and language settings in control panel you can see various date/time settings for various countries. South africa has got this YYYY/MM/DD.<br />The slash &quot;/&quot; format is quite common. you might want to consider including all possible formats if this routine is going to be super &quot;flexible&quot;</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p31121" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile31121">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist7557.html?mode=viewprofile&amp;u=4243" class="username">carlsomo</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search15dd.html?author_id=4243&amp;sr=posts">91</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 02 Oct 2012 17:21</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content31121">

						<h3 ><a href="#p31121">Re: Pure DOS valid Date checker</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting47e5.html?mode=quote&amp;f=3&amp;p=31121" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic9b9a.html?p=31121#p31121" onclick="prompt('Message #3',this.href); return false;">#3</a></span> 
									<a class="unread" href="viewtopic9b9a.html?p=31121#p31121" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist7557.html?mode=viewprofile&amp;u=4243" class="username">carlsomo</a></strong> &raquo; </span>30 Dec 2013 02:15
			</p>
			
			
			
			<div class="content">OK, good point.  <br />I suggest you may modify the routine to accept South African convention and then post it for the South Africans who may be disprivileged. As I see it, one must make compromises for the more numerous Germans who use the '.' separator with the Year first<br />as well as Americans who always use m/d/y and abbreviate the year to two digits. I suppose the Somalians and Ethiopians may use another convention that may not fit. In any case the Syntax section at the top of the routine outlines the parameters that work for this routine. Please feel free to make modifications that work for other formats and post it here.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p31123" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile31123">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist6005.html?mode=viewprofile&amp;u=5253" class="username">berserker</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search2ffb.html?author_id=5253&amp;sr=posts">95</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 18 Dec 2013 00:51</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content31123">

						<h3 ><a href="#p31123">Re: Pure DOS valid Date checker</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinga387-2.html?mode=quote&amp;f=3&amp;p=31123" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicf5a3.html?p=31123#p31123" onclick="prompt('Message #4',this.href); return false;">#4</a></span> 
									<a class="unread" href="viewtopicf5a3.html?p=31123#p31123" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist6005.html?mode=viewprofile&amp;u=5253" class="username">berserker</a></strong> &raquo; </span>30 Dec 2013 02:23
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>carlsomo wrote:</cite>OK, good point.  <br />I suggest you may modify the routine to accept South African convention and then post it for the South Africans who may be disprivileged. As I see it, one must make compromises for the more numerous Germans who use the '.' separator with the Year first<br />as well as Americans who always use m/d/y and abbreviate the year to two digits. I suppose the Somalians and Ethiopians may use another convention that may not fit. In any case the Syntax section at the top of the routine outlines the parameters that work for this routine. Please feel free to make modifications that work for other formats and post it here.</div></blockquote><br /><br />you are the one who writes this<br /><blockquote><div><cite>carlsomo wrote:</cite>This flexible routine determines ......<br />....<br />Please report any bugs if found<br /></div></blockquote><br /><br />now I am reporting  to you some things you can consider if you want it to be more flexible. why should I write the code for you? I am not going to use it. Its the people whom you are going to distribute this code to who are going to use it. Its not even my concern whether you want to follow my suggestion or not. I merely just did what you asked, report bugs. that's all.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p31125" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile31125">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist7557.html?mode=viewprofile&amp;u=4243" class="username">carlsomo</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search15dd.html?author_id=4243&amp;sr=posts">91</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 02 Oct 2012 17:21</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content31125">

						<h3 ><a href="#p31125">Re: Pure DOS valid Date checker</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinga10e.html?mode=quote&amp;f=3&amp;p=31125" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic513b-2.html?p=31125#p31125" onclick="prompt('Message #5',this.href); return false;">#5</a></span> 
									<a class="unread" href="viewtopic513b-2.html?p=31125#p31125" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist7557.html?mode=viewprofile&amp;u=4243" class="username">carlsomo</a></strong> &raquo; </span>30 Dec 2013 02:39
			</p>
			
			
			
			<div class="content">OK, here is the solution to all the ills of South African date checkers and thanks for the input BTW<br />I just hope this solution doesn't screw up the Somalians:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off&amp;goto :start<br />:Valid_Date Date<br />echo.:::----------------------------------------------------------:::<br />echo.::: Syntax: Valid_Date 'Date'&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :::<br />echo.:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :::<br />echo.::: Date may be passed as a value or as a reference variable :::<br />echo.::: Checks for validity of the Date value, which may be in&nbsp; &nbsp;:::<br />echo.::: M-D-Y, MM-DD-YYYY, YYYYMMDD or Julian (7 digit) format&nbsp; &nbsp;:::<br />echo.::: Non English YYYY.MM.DD is valid if year is gtr 2 digits&nbsp; :::<br />echo.::: Year must be at least year 0 AD to be considered valid&nbsp; &nbsp;:::<br />echo.::: 1 or 2 digit years in M-D-Y format are considered 2000+&nbsp; :::<br />echo.::: For example the year 11 A.D. should be passed as 0011&nbsp; &nbsp; :::<br />echo.::: The Valid date parameter separators are: '/' '-' and '.' ::: <br />echo.::: Returns 0 in errorlevel if date is valid, else non zero&nbsp; :::<br />echo.:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :::<br />echo.:::----------------------------------------------------------:::<br />exit /b 1<br /><br />:start<br />if &quot;%~1&quot;==&quot;&quot; goto :Valid_Date Syntax<br />if &quot;%~1&quot;==&quot;/?&quot; goto :Valid_Date Syntax<br />SetLocal EnableDelayedExpansion<br />if defined %~1 (set &quot;dte=!%~1!&quot;) else (set &quot;dte=%~1&quot;)<br />set &quot;invalid=&quot;<br />set &quot;sep=&quot;<br />set/a err=1<br />for /f &quot;tokens=1* delims=0123456789-/.&quot; %%a in (&quot;!dte!&quot;) do set &quot;err=%%a&quot;<br />if /i !err! neq 1 set/a err=1&amp;goto :end<br />for /f &quot;tokens=1-2* delims=0123456789&quot; %%a in (&quot;!dte!&quot;) do (<br />&nbsp; set &quot;err=%%a&quot;&amp;set &quot;sep=%%b&quot;&amp;set &quot;invalid=%%c&quot;<br />)<br />call :strln dte len<br />if /i !err! equ 1 ( REM string is numeric only<br />&nbsp; if /i !len! lss 7 goto :end<br />&nbsp; if /i !len! gtr 8 goto :end<br />) else ( REM valid separators found in string<br />&nbsp; set/a err=2<br />&nbsp; if defined invalid goto :end<br />&nbsp; if not defined sep goto :end<br />&nbsp; if /i !len! lss 5 goto :end<br />&nbsp; if /i !len! gtr 10 goto :end<br />)<br />set &quot;dte=%dte:/=-%&quot;<br />set &quot;dte=%dte:.=-%&quot;<br />echo !dte!|Find &quot;--&quot;&gt;nul<br />if !errorlevel! equ 0 goto :end<br />set &quot;ymd=%dte:-=%&quot;<br />if /i !err! equ 1 ( REM process numeric only string<br />&nbsp; if /i !len! equ 7 (call :gdate ymd &amp;set/a err=0)<br />&nbsp; set &quot;dte=!ymd:~4,2!-!ymd:~6,2!-!ymd:~0,4!&quot;<br />)<br />if !err! neq 0 ( REM process separated string<br />&nbsp; for /f &quot;tokens=1-3 delims=-&quot; %%A in (&quot;!dte!&quot;) do (<br />&nbsp; &nbsp; set mm=%%A&amp;set dd=%%B&amp; set &quot;yy=%%C&quot;<br />&nbsp; &nbsp; call :strln mm mlen<br />&nbsp; &nbsp; if /i !mlen! gtr 2&nbsp; (<br />&nbsp; &nbsp; &nbsp; set yy=%%A&amp;set mm=%%B&amp;set &quot;dd=%%C&quot;<br />&nbsp; &nbsp; &nbsp; if not defined dd goto :end<br />&nbsp; &nbsp; )<br />&nbsp; )<br />&nbsp; if not defined yy goto :end<br />&nbsp; call :strln yy ylen<br />&nbsp; if /i !dd! gtr 31 goto :end<br />&nbsp; if /i !mm! gtr 12 goto :end<br />&nbsp; set/a yy=10000!yy! %% 10000,mm=100!mm! %% 100,dd=100!dd! %% 100<br />&nbsp; if !yy! LSS 100 if /i !ylen! lss 3 set /a yy+=2000<br />&nbsp; call :jdate JD yy mm dd<br />&nbsp; if /i 1!mm! lss 20 set &quot;mm=0!mm!&quot;<br />&nbsp; if /i 1!dd! lss 20 set &quot;dd=0!dd!&quot;<br />&nbsp; set &quot;ymd=!yy!!mm!!dd!&quot;<br />&nbsp; call :Gdate JD<br />&nbsp; if /i !JD! equ !ymd! set/a err=0<br />)<br />:end<br />EndLocal&amp;exit /b %err%<br /><br />:gdate<br />setlocal enabledelayedexpansion<br />set &quot;p=!%~1!&quot;<br />set /a p&nbsp; &nbsp; &nbsp; = p + 68569<br />set /a q&nbsp; &nbsp; &nbsp; = 4 * %p% / 146097<br />set /a r&nbsp; &nbsp; &nbsp; = %p% - ( 146097 * %q% +3 ) / 4<br />set /a s&nbsp; &nbsp; &nbsp; = 4000 * ( %r% + 1 ) / 1461001<br />set /a t&nbsp; &nbsp; &nbsp; = %r% - 1461 * %s% / 4 + 31<br />set /a u&nbsp; &nbsp; &nbsp; = 80 * %t% / 2447<br />set /a v&nbsp; &nbsp; &nbsp; = %u% / 11<br />set /a GYear&nbsp; = 100 * ( %q% - 49 ) + %s% + %v%<br />set /a GMonth = %u% + 2 - 12 * %v%<br />set /a GDay&nbsp; &nbsp;= %t% - 2447 * %u% / 80<br />if /i 1%GMonth% lss 20 set &quot;GMonth=0%GMonth%&quot;<br />if /i 1%GDay%&nbsp; &nbsp;lss 20 set &quot;GDay=0%GDay%&quot;<br />endlocal&amp;(<br />&nbsp; set &quot;%~1=%GYear%%GMonth%%GDay%&quot;<br />)&amp;exit/b %GYear%%GMonth%%GDay%<br /><br />:jdate<br />setlocal enabledelayedexpansion<br />set/a yy=!%~2!,mm=!%~3!,dd=!%~4!<br />set /a JD=dd-32075+1461*(yy+4800+(mm-14)/12)/4+367*(mm-2-(mm-14)/12*12)/12-3*((yy+4900+(mm-14)/12)/100)/4<br />endlocal&amp;set/a %~1=%JD%&amp;exit/b<br /><br />:Strln<br />( SetLocal<br />&nbsp; set &quot;str=A!%~1!&quot;<br />&nbsp; set &quot;len=0&quot;<br />&nbsp; for /L %%A in (12,-1,0) do (<br />&nbsp; &nbsp; set /a &quot;len|=1&lt;&lt;%%A&quot;<br />&nbsp; &nbsp; for %%B in (!len!) do if &quot;!str:~%%B,1!&quot;==&quot;&quot; set /a &quot;len&amp;=~1&lt;&lt;%%A&quot;<br />&nbsp; )<br />)<br />EndLocal&amp;(<br />&nbsp; if &quot;%~2&quot; NEQ &quot;&quot; set/a %~2=%len%<br />)&amp;exit /b %len%<br /></code></pre></div></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p32072" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile32072">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist7557.html?mode=viewprofile&amp;u=4243" class="username">carlsomo</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search15dd.html?author_id=4243&amp;sr=posts">91</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 02 Oct 2012 17:21</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content32072">

						<h3 ><a href="#p32072">Re: Pure DOS valid Date checker</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting5208.html?mode=quote&amp;f=3&amp;p=32072" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic4c7d.html?p=32072#p32072" onclick="prompt('Message #6',this.href); return false;">#6</a></span> 
									<a class="unread" href="viewtopic4c7d.html?p=32072#p32072" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist7557.html?mode=viewprofile&amp;u=4243" class="username">carlsomo</a></strong> &raquo; </span>26 Jan 2014 16:24
			</p>
			
			
			
			<div class="content">After a little more research....<br /><br />Prior to Pope Gregory's new Calendar that we now use the Julian Calendar was in force. This calendar had leap years for every year divisible by 4 with no remainder.  This led to a 10 day difference in the spring equinox from where the earth was actually in position with the Sun and kept pushing Easter closer to Summer.  The solution was to declare Friday, October 15th, 1582 as the date that follows Thursday, October 4th, 1582.  From then on leap years did not occur on century dates, such as in February 1700, unless divisible by 400 so years 1600 and 2000 are leap years. In the Julian Calendar there is no year 0. The date at 12 Noon, December 31st, Year 1 BCE (Julian 1721423.0), is followed by the date, 12 Noon January 1st, 1 AD (Julian 1721424.0). Julian day 0.0 is 12 Noon, January 1st, 4713 BCE (Before Common Era)<br /><br />The plot thickens....<br />Basically only devout Catholic nations followed the Pope's lead on October 15, 1582 and many protestant nations and English colonies (like the USA) did not adopt the Gregorian calendar until the 1700's. The various exact dates that specific countries chose to update to the Gregorian calendar are too numerous to account for in a simple script such as this. This modified Valid_Date batch script assumes October 15th, 1582 (one day after October 4th, 1582 on the Julian calendar) as the start of the Gregorian era for purposes of simplicity. This also follows the convention of the US Naval Observatory website and many others capable of converting older dates to Julian day. That being said this script could easily be modified to be 'Country specific' if one knows the conversion date for any given nation. The following website allows the user to toggle between Julian and Gregorian calendars to convert specific dates in question for dates that fall into the nebulous zone after October 4th, 1582:<br /><br /><a href="http://bowie.gsfc.nasa.gov/time/julian.html?delta=1199160" class="postlink">http://bowie.gsfc.nasa.gov/time/julian.html?delta=1199160</a><br /><br />Valid_Date.bat<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off&amp;goto :start<br />:Valid_Date Date<br />echo.&nbsp; &nbsp; &nbsp; &nbsp; :::----------------------------------------------------------:::<br />echo.&nbsp; &nbsp; &nbsp; &nbsp; :::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :::<br />echo.&nbsp; &nbsp; &nbsp; &nbsp; ::: Syntax: Valid_Date.cmd 'Date' ^(variable or string^)&nbsp; &nbsp; &nbsp; &nbsp;:::<br />echo.&nbsp; &nbsp; &nbsp; &nbsp; :::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :::<br />echo.&nbsp; &nbsp; &nbsp; &nbsp; ::: Date may be passed as a value or as a reference variable :::<br />echo.&nbsp; &nbsp; &nbsp; &nbsp; ::: Checks for validity of the Date value, which may be in&nbsp; &nbsp;:::<br />echo.&nbsp; &nbsp; &nbsp; &nbsp; ::: M-D-Y, MM-DD-YYYY, YYYYMMDD or Julian (7 digit) format&nbsp; &nbsp;:::<br />echo.&nbsp; &nbsp; &nbsp; &nbsp; ::: Julian dates correspond to 12 noon on calendar dates&nbsp; &nbsp; &nbsp;:::<br />echo.&nbsp; &nbsp; &nbsp; &nbsp; ::: Julian dates must be 7 digits, ie. 0000000 for day 0&nbsp; &nbsp; &nbsp;:::<br />echo.&nbsp; &nbsp; &nbsp; &nbsp; ::: that corresponds to 12 Noon on January 1st, 4713 BC&nbsp; &nbsp; &nbsp; :::<br />echo.&nbsp; &nbsp; &nbsp; &nbsp; ::: Non English YYYY.MM.DD is valid if year is gtr 2 digits&nbsp; :::<br />echo.&nbsp; &nbsp; &nbsp; &nbsp; ::: 1 or 2 digit years in M-D-Y format are considered 2000+&nbsp; :::<br />echo.&nbsp; &nbsp; &nbsp; &nbsp; ::: For B.C. years a '-' must immediately predcede the year&nbsp; :::<br />echo.&nbsp; &nbsp; &nbsp; &nbsp; ::: For example the year 11 B.C. should be passed as -0011&nbsp; &nbsp;:::<br />echo.&nbsp; &nbsp; &nbsp; &nbsp; ::: The year 45 A.D. should be represented as 0045&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :::<br />echo.&nbsp; &nbsp; &nbsp; &nbsp; ::: The valid date parameter separators are: '/' '-' and '.' ::: <br />echo.&nbsp; &nbsp; &nbsp; &nbsp; ::: The Gregorian calendar is used after Oct 4th, 1582&nbsp; &nbsp; &nbsp; &nbsp;:::<br />echo.&nbsp; &nbsp; &nbsp; &nbsp; ::: The Julian Calendar is used for Oct 4, 1582 and ealier&nbsp; &nbsp;:::<br />echo.&nbsp; &nbsp; &nbsp; &nbsp; ::: Returns 0 in errorlevel if date is valid, else non zero&nbsp; :::<br />echo.&nbsp; &nbsp; &nbsp; &nbsp; ::: Variable 'Valid_Date.ymd' will be set to YYYYMMDD format :::<br />echo.&nbsp; &nbsp; &nbsp; &nbsp; ::: Variable 'Valid_Date.jul' will be set to Julian number&nbsp; &nbsp;:::<br />echo.&nbsp; &nbsp; &nbsp; &nbsp; :::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :::<br />echo.&nbsp; &nbsp; &nbsp; &nbsp; :::----------------------------------------------------------:::<br />exit /b 1<br /><br />:start<br />if &quot;%~1&quot;==&quot;&quot; goto :Valid_Date Syntax<br />if &quot;%~1&quot;==&quot;/?&quot; goto :Valid_Date Syntax<br />SetLocal EnableDelayedExpansion<br />if defined %~1 (set &quot;dte=!%~1!&quot;) else (<br />&nbsp; set &quot;dte=%~1 %~2&quot;<br />&nbsp; if &quot;!dte:~-1!&quot; equ &quot; &quot; set &quot;dte=!dte:~0,-1!&quot;<br />)<br />set &quot;invalid=&quot;<br />set &quot;sep=&quot;<br />set &quot;ymd=&quot;<br />set &quot;Julian=&quot;<br />set/a err=1<br />if /i &quot;!dte:~0,1!&quot; gtr &quot;9&quot; set &quot;dte=!dte:* =!&quot;<br />if /i &quot;!dte:~0,1!&quot; neq &quot;-&quot; (set &quot;sign=&quot;) else (<br />&nbsp; set &quot;sign=-&quot;<br />&nbsp; set &quot;dte=!dte:~1!&quot;<br />)<br />for /f &quot;tokens=1* delims=0123456789-/.&quot; %%a in (&quot;!dte!&quot;) do set &quot;err=%%a&quot;<br />if /i !err! neq 1 set/a err=1&amp;goto :end<br />for /f &quot;tokens=1-2* delims=0123456789&quot; %%a in (&quot;!dte!&quot;) do (<br />&nbsp; set &quot;err=%%a&quot;&amp;set &quot;sep=%%b&quot;&amp;set &quot;invalid=%%c&quot;<br />&nbsp; if &quot;!sep:~-1!&quot; equ &quot;-&quot; if not defined sign (set &quot;sign=-&quot;&amp;set &quot;err=3&quot;)<br />)<br />call :strln dte len<br />if /i !err! equ 1 ( REM string is numeric only<br />&nbsp; if /i !len! lss 7 goto :end<br />&nbsp; if /i !len! gtr 8 goto :end<br />) else ( REM valid separators found in string<br />&nbsp; if !err! neq 3 set/a err=2<br />&nbsp; if defined invalid goto :end<br />&nbsp; if not defined sep goto :end<br />&nbsp; if /i !len! lss 5 goto :end<br />&nbsp; if !err! neq 3 (<br />&nbsp; &nbsp; if /i !len! gtr 10 goto :end<br />&nbsp; ) else if /i !len! gtr 11 goto :end<br />)<br />set &quot;dte=%dte:/=.%&quot;<br />set &quot;dte=%dte:-=.%&quot;<br />echo !dte!|Find &quot;..&quot;&gt;nul<br />if !errorlevel! equ 0 if !err! neq 3 goto :end<br />set &quot;ymd=%dte:.=%&quot;<br />if /i !err! equ 1 ( REM process numeric only string<br />&nbsp; if /i !len! equ 7 (<br />&nbsp; &nbsp; set &quot;ymd=!sign!!ymd!&quot;<br />&nbsp; &nbsp; set &quot;djd=!ymd!&quot;<br />&nbsp; &nbsp; call :gdate ymd<br />&nbsp; &nbsp; set/a err=0<br />&nbsp; )<br />&nbsp; set &quot;dte=!ymd:~4,2!.!ymd:~6,2!.!ymd:~0,4!&quot;<br />)<br />if !err! neq 0 ( REM process separated string<br />&nbsp; for /f &quot;tokens=1-3 delims=.&quot; %%A in (&quot;!dte!&quot;) do (<br />&nbsp; &nbsp; set mm=%%A&amp;set dd=%%B&amp; set &quot;yy=%%C&quot;<br />&nbsp; &nbsp; call :strln mm mlen<br />&nbsp; &nbsp; if /i !mlen! gtr 2 (<br />&nbsp; &nbsp; &nbsp; set yy=%%A&amp;set mm=%%B&amp;set &quot;dd=%%C&quot;<br />&nbsp; &nbsp; &nbsp; if not defined dd goto :end<br />&nbsp; &nbsp; )<br />&nbsp; )<br />&nbsp; if not defined yy goto :end<br />&nbsp; call :strln yy ylen<br />&nbsp; if /i !dd! gtr 31 goto :end<br />&nbsp; if /i !mm! gtr 12 goto :end<br />&nbsp; set/a yy=!sign!10000!yy! %% 10000,mm=100!mm! %% 100,dd=100!dd! %% 100<br />&nbsp; if !yy! geq 0 if !yy! lss 100 if /i !ylen! lss 3 set /a yy+=2000<br />&nbsp; if /i !yy! equ 0 set/a err=1&amp;goto :end<br />&nbsp; if !yy!!mm!!dd! gtr 15821004 if !yy!!mm!!dd! lss 15821015 goto :end<br />&nbsp; call :jdate JD yy mm dd<br />&nbsp; if /i !errorlevel! neq 0 goto :end<br />&nbsp; if /i 1!mm! lss 20 set &quot;mm=0!mm!&quot;<br />&nbsp; if /i 1!dd! lss 20 set &quot;dd=0!dd!&quot;<br />&nbsp; set &quot;ymd=!yy!!mm!!dd!&quot;<br />&nbsp; set/a djd=JD<br />&nbsp; call :Gdate JD<br />&nbsp; if /i !JD! equ !ymd! set/a err=0<br />)<br />:end<br />if /i !err! equ 0 (call :format ymd 8&amp;call :format djd 7) else (set &quot;ymd=&quot;&amp;set &quot;dJD=&quot;)<br />EndLocal&amp;set &quot;Valid_Date.ymd=%ymd%&quot;&amp;set &quot;Valid_Date.jul=%dJD%&quot;&amp;exit/b %err%<br /><br />:format int length<br />if &quot;%~2&quot;==&quot;&quot; exit/b<br />if not defined %~1 exit /b<br />setlocal enabledelayedexpansion<br />set &quot;int=!%~1!&quot;<br />set &quot;sign=!int:~0,1!&quot;<br />if &quot;!sign!&quot; equ &quot;-&quot; (set &quot;int=!int:~1!&quot;) else set &quot;sign=&quot; <br />:format_loop<br />call :strln int len<br />if %len% geq %~2 endlocal&amp;set &quot;%~1=%sign%%int%&quot;&amp;exit/b<br />set &quot;int=0%int%&quot;&amp;goto :format_loop<br /><br />:jdate<br />setlocal enabledelayedexpansion<br />set/a yy=!%~2!,mm=!%~3!,dd=!%~4!<br />if /i !yy! lss 0 set/a yy+=1<br />set/a a=(14 - mm)/12<br />set/a m=mm + 12*a - 3<br />set/a y=yy+4800-a<br />set/a JDGregorian=dd + (153*m + 2)/5 + 365*y + y/4 - y/100 + y/400 - 32045<br />set/a JDJulian=dd + (153*m + 2)/5 + 365*y + y/4 - 32083<br />if /i %JDGregorian% geq 2299161 (set/a JD=%JDGregorian%) else (set/a JD=%JDJulian%)<br />rem echo JD=%JD%&nbsp; JDJ=%JDJulian%&nbsp; &nbsp;JDG=%JDGregorian%<br />endlocal&amp;set/a %~1=%JD%&amp;exit/b 0<br /><br />:Strln<br />( SetLocal<br />&nbsp; set &quot;str=A!%~1!&quot;<br />&nbsp; set &quot;len=0&quot;<br />&nbsp; for /L %%A in (12,-1,0) do (<br />&nbsp; &nbsp; set /a &quot;len|=1&lt;&lt;%%A&quot;<br />&nbsp; &nbsp; for %%B in (!len!) do if &quot;!str:~%%B,1!&quot;==&quot;&quot; set /a &quot;len&amp;=~1&lt;&lt;%%A&quot;<br />&nbsp; )<br />)<br />EndLocal&amp;(<br />&nbsp; if &quot;%~2&quot; NEQ &quot;&quot; set/a %~2=%len%<br />)&amp;exit /b %len%<br /><br />:gdate<br />setlocal enabledelayedexpansion<br />set &quot;p=!%~1!&quot;<br />if &quot;!p:~0,1!&quot; equ &quot;-&quot; (<br />&nbsp; set &quot;p=!p:~1!&quot;<br />&nbsp; set &quot;sign=-&quot;<br />) else set &quot;sign=&quot;<br />if &quot;!p!&quot; neq &quot;0&quot; if &quot;!p:~0,1!&quot; equ &quot;0&quot; (set/a &quot;p=!sign!1!p! %% 1000000&quot;) else set &quot;p=!sign!!p!&quot;<br />if !p! geq 2299161 goto :Gregorian_Calendar<br />:Julian_Calendar<br />&nbsp; set/a b=0<br />&nbsp; set/a c=p + 32082<br />&nbsp; goto :Calc<br />:Gregorian_Calendar<br />&nbsp; set/a a=p + 32044<br />&nbsp; set/a b=(4*a + 3)/146097<br />&nbsp; set/a c=a - (146097*b)/4<br />:Calc<br />set/a d= (4*c + 3)/1461<br />set/a e=c - 1461*d/4<br />set/a m=(5*e + 2)/153<br />set/a GDay=e - (153*m + 2)/5 + 1<br />set/a GMonth=m + 3 - 12*(m/10)<br />set/a GYear=100*b + d - 4800 + m/10<br />if /i %GYear% leq 0 set/a GYear-=1<br />if /i 1%GMonth% lss 20 set &quot;GMonth=0%GMonth%&quot;<br />if /i 1%GDay%&nbsp; &nbsp;lss 20 set &quot;GDay=0%GDay%&quot;<br />endlocal&amp;(<br />&nbsp; set &quot;%~1=%GYear%%GMonth%%GDay%&quot;<br />)&amp;exit/b %GYear%%GMonth%%GDay%<br /></code></pre></div></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
	

	<div class="action-bar bar-bottom">
	
			<a href="posting6e70.html?mode=reply&amp;f=3&amp;t=5217" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopicd080-2.html?f=3&amp;t=5217&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

			<form method="post" action="https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=5217">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			6 posts
							&bull; Page <strong>1</strong> of <strong>1</strong>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="viewforum4d6b.html?f=3" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to “DOS Batch Forum”</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="viewforum31e6.html?f=4" class="jumpbox-cat-link"> <span> DosTips - Dos Batch</span></a></li>
																<li><a href="viewforum4d6b.html?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; DOS Batch Forum</span></a></li>
											</ul>
		</div>
	</div>

	</div>


			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
							<span class="crumb"><a href="../index.html" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>DosTips.com</span></a></span>									<span class="crumb"><a href="index.html" data-navbar-reference="index"><span>Board index</span></a></span>					</li>
		
				<li class="rightside">All times are <span title="UTC-6">UTC-06:00</span></li>
							<li class="rightside">
				<a href="ucp033a.html?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete all board cookies</span>
				</a>
			</li>
												<li class="rightside" data-last-responsive="true">
				<a href="memberlist4bfd.html?mode=team" role="menuitem">
					<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
				</a>
			</li>
									<li class="rightside" data-last-responsive="true">
				<a href="memberlist8733.html?mode=contactadmin" role="menuitem">
					<i class="icon fa-envelope fa-fw" aria-hidden="true"></i><span>Contact us</span>
				</a>
			</li>
			</ul>

	</div>
</div>

	<div class="copyright">
				<!-- WARNING NO DELETE -->Style developer by <a href="http://tricolor.x-tk.ru/">support forum tricolor</a>, <!-- END WARNING NO DELETE -->Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
									</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	<img src="cron5897.gif?cron_type=cron.task.text_reparser.poll_option" width="1" height="1" alt="cron" /></div>

<script type="text/javascript" src="assets/javascript/jquery.mind772.js?assets_version=34"></script>
<script type="text/javascript" src="assets/javascript/cored772.js?assets_version=34"></script>



<script type="text/javascript" src="styles/prosilver/template/forum_fnd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/prosilver/template/ajaxd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/jquery-uid772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/collapsed772.js?assets_version=34"></script>



</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=5217 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 08:46:21 GMT -->
</html>
