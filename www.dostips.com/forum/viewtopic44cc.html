<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?p=41630 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 08:03:09 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>JREPL.BAT v7.14 - regex text processor now with Unicode and XRegExp support - Page 6 - DosTips.com</title>


	<link rel="canonical" href="viewtopicd300.html?t=6044&amp;start=75">

<!--
	phpBB style name: Allan Style - SUBSILVER
	Based on style:   prosilver (this is the default phpBB3 style)
	Based on style:   subsilver2 (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:  Allan ( http://x-tk.ru/ )
-->

<link href="assets/css/font-awesome.mind772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/stylesheetd772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/en/stylesheetd772.css?assets_version=34" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="./styles/AllanStyle-SUBSILVER/theme/tweaks.css?assets_version=34" rel="stylesheet">
<![endif]-->




<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','../../www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-280191-1', 'auto');
	ga('send', 'pageview');
</script>

</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">

<div id="header-subsilver">
	<a id="top" class="top-anchor" accesskey="t"></a>
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description" class="site-description">
				<a id="logo" class="logo" href="../index.html" title="DosTips.com"><span class="site_logo"></span></a>
				<h1>DosTips.com</h1>
				<p>A Forum all about DOS Batch</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

									<div id="search-box" class="search-box search-header" role="search">
				<form action="https://www.dostips.com/forum/search.php" method="get" id="search">
				<fieldset>
					<input name="keywords" id="keywords" type="search" maxlength="128" title="Search for keywords" class="inputbox search tiny" size="20" value="" placeholder="Search…" />
					<button class="button button-search" type="submit" title="Search">
						<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
					</button>
					<a href="search.html" class="button button-search-end" title="Advanced search">
						<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
					</a>
					
				</fieldset>
				</form>
			</div>
						
			</div>
					</div>
</div>


<div id="wrap" class="wrap">
	<div id="page-header">
				<div class="navbar-top" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
																									<li>
								<a href="search33a7.html?search_id=unanswered" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="search526f.html?search_id=active_topics" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-blue" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="search.html" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
											<li class="separator"></li>
																			<li>
								<a href="memberlist4bfd.html?mode=team" role="menuitem">
									<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
								</a>
							</li>
																<li class="separator"></li>

									</ul>
			</div>
		</li>

				<li data-skip-responsive="true">
			<a href="app.php/help/faq.html" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
						
			<li class="rightside"  data-skip-responsive="true">
			<a href="ucp26c3.html?mode=login" title="Login" accesskey="x" role="menuitem">
				<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Login</span>
			</a>
		</li>
					<li class="rightside" data-skip-responsive="true">
				<a href="ucp8319.html?mode=register" role="menuitem">
					<i class="icon fa-pencil-square-o  fa-fw" aria-hidden="true"></i><span>Register</span>
				</a>
			</li>
						</ul>

	</div>
</div>

<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
						<li class="breadcrumbs">
							<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="../index.html" itemprop="url" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span itemprop="title">DosTips.com</span></a></span>
										<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="index.html" itemprop="url" accesskey="h" data-navbar-reference="index"><span itemprop="title">Board index</span></a></span>

											<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="4"><a href="viewforum31e6.html?f=4" itemprop="url"><span itemprop="title">DosTips - Dos Batch</span></a></span>
															<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="3"><a href="viewforum4d6b.html?f=3" itemprop="url"><span itemprop="title">DOS Batch Forum</span></a></span>
												</li>
		
					<li class="rightside responsive-search">
				<a href="search.html" title="View the advanced search options" role="menuitem">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</a>
			</li>
			</ul>

	</div>
</div>

<div class="navbar-top-link">
	<div class="inner">
		<ul>
			<li class="navbar-top-link-left"><a href="search33a7.html?search_id=unanswered">Unanswered topics</a></li>
			<li class="navbar-top-link-left"><a href="search526f.html?search_id=active_topics">Active topics</a></li>

											</ul>
	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
		
<h2 class="topic-title"><a href="viewtopicb4c6.html?f=3&amp;t=6044&amp;start=75">JREPL.BAT v7.14 - regex text processor now with Unicode and XRegExp support</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">Discussion forum for all Windows batch related topics.<br /></div>
<p>
	<strong>Moderator:</strong> <a href="memberlista6a8.html?mode=viewprofile&amp;u=5" class="username">DosItHelp</a>
</p>


<div class="action-bar bar-top">
	
			<a href="postingdfbb.html?mode=reply&amp;f=3&amp;t=6044" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic3913.html?f=3&amp;t=6044&amp;start=75&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="https://www.dostips.com/forum/search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topic…" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="search.html" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="6044" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			393 posts
							<ul>
	<li class="dropdown-container dropdown-button-control dropdown-page-jump page-jump">
		<a class="button button-icon-only dropdown-trigger" href="#" title="Click to jump to page…" role="button"><i class="icon fa-level-down fa-rotate-270" aria-hidden="true"></i><span class="sr-only">Page <strong>6</strong> of <strong>27</strong></span></a>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
				<li>Jump to page:</li>
				<li class="page-jump-form">
					<input type="number" name="page-number" min="1" max="999999" title="Enter the page number you wish to go to" class="inputbox tiny" data-per-page="15" data-base-url=".&#x2F;viewtopic.php&#x3F;f&#x3D;3&amp;amp&#x3B;t&#x3D;6044" data-start-name="start" />
					<input class="button2" value="Go" type="button" />
				</li>
			</ul>
		</div>
	</li>
			<li class="arrow previous"><a class="button button-icon-only" href="viewtopicf93e.html?f=3&amp;t=6044&amp;start=60" rel="prev" role="button"><i class="icon fa-chevron-left fa-fw" aria-hidden="true"></i><span class="sr-only">Previous</span></a></li>
				<li><a class="button" href="viewtopicb16d.html?f=3&amp;t=6044" role="button">1</a></li>
			<li class="ellipsis" role="separator"><span>…</span></li>
				<li><a class="button" href="viewtopic29a7.html?f=3&amp;t=6044&amp;start=45" role="button">4</a></li>
				<li><a class="button" href="viewtopicf93e.html?f=3&amp;t=6044&amp;start=60" role="button">5</a></li>
			<li class="active"><span>6</span></li>
				<li><a class="button" href="viewtopicdf57.html?f=3&amp;t=6044&amp;start=90" role="button">7</a></li>
				<li><a class="button" href="viewtopic7e6f.html?f=3&amp;t=6044&amp;start=105" role="button">8</a></li>
			<li class="ellipsis" role="separator"><span>…</span></li>
				<li><a class="button" href="viewtopic54c6.html?f=3&amp;t=6044&amp;start=390" role="button">27</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopicdf57.html?f=3&amp;t=6044&amp;start=90" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
		</div>




<div id="subsilver-nav-topic">
	<div class="inner"><div class="post has-profile">
		<div class="leftsided postbody subsilver-topic-title">Message</div>
		<div class="leftsided postprofile subsilver-topic-author">Author</div>
	</div></div>
</div>

			<div id="p41543" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile41543">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist1a65.html?mode=viewprofile&amp;u=6800" class="username">Grahack</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search67ac.html?author_id=6800&amp;sr=posts">3</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 25 May 2015 00:19</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content41543">

						<h3 class="first"><a href="#p41543">Re: JREPL.BAT - regex text processor - successor to REPL.BAT</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting2572.html?mode=quote&amp;f=3&amp;p=41543" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic49f0.html?p=41543#p41543" onclick="prompt('Message #76',this.href); return false;">#76</a></span> 
									<a class="unread" href="viewtopic49f0.html?p=41543#p41543" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist1a65.html?mode=viewprofile&amp;u=6800" class="username">Grahack</a></strong> &raquo; </span>08 Jun 2015 03:46
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>jeb wrote:</cite>...<br />After the first parser run in the batch file there is exactly one &lt;LF&gt; between &quot;First line&quot; and &quot;second line&quot;.<br />This would produce two lines, but when this is transfer to the child cmd.exe (by the pipe) then the line is parsed again.<br />But then the linefeed is &quot;raw&quot; without the necessary esacping so it removes simply the rest of the line.<br />This results in the output of only &quot;First line&quot;.</div></blockquote><br /><br />Indeed. I asked StackOverflow in the mean time. See here:<br /><!-- m --><a class="postlink" href="http://stackoverflow.com/questions/30612492/jrepl-bat-only-prints-the-first-line/30616034#30616034">http://stackoverflow.com/questions/3061 ... 4#30616034</a><!-- m --><br />Thanks</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p41581" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile41581">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist2675.html?mode=viewprofile&amp;u=2988" style="color: #00AA00;" class="username-coloured">Squashman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1322.html?author_id=2988&amp;sr=posts">3970</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 Dec 2011 13:59</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content41581">

						<h3 ><a href="#p41581">Re: JREPL.BAT - regex text processor - successor to REPL.BAT</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingbe0b.html?mode=quote&amp;f=3&amp;p=41581" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicbb18.html?p=41581#p41581" onclick="prompt('Message #77',this.href); return false;">#77</a></span> 
									<a class="unread" href="viewtopicbb18.html?p=41581#p41581" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist2675.html?mode=viewprofile&amp;u=2988" style="color: #00AA00;" class="username-coloured">Squashman</a></strong> &raquo; </span>10 Jun 2015 15:55
			</p>
			
			
			
			<div class="content">Hi Guys, sorry I have not been around much.  Super busy with work and family.  <br /><br />Today I got some really horrible data from a client and I think I can fix it with JREPL.<br /><br />You know how sometimes people will hard code a linefeed in an excel file and when they export it out of excel the linefeed also outputs but the line does end with a carriage return and line feed.  Well I got the worst of both worlds on that somehow.  The client somehow has a CRLF in the middle of a field on a CSV file they sent us.  So a lot of the records are wrapping.<br /><br />The records look like this. Typing out \CR\LF so you know what it really is.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>Monrovia,012345678,2015-06-02,SO-0654321,Sales Order,395.00,1015 ARCADIA AVE\CR\LF<br />APT 5,ARCADIA,CA,91007\CR\LF</code></pre></div><br />What it should look like of course is this.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>Monrovia,012345678,2015-06-02,SO-0654321,Sales Order,395.00,1015 ARCADIA AVE APT 5,ARCADIA,CA,91007\CR\LF</code></pre></div><br /><br />I think the common denominator here is there should only be a CRLF if it is preceded by a 5 digit zipcode.  Seems like all the records that are bad have some type of Apartment or Unit designation.  So is there any way to strip the CRLF when it is not preceded by 5 numbers?<br /><br />I guess maybe my other thought process was to count the number of tokens in each line.  If there isn't 10 tokens then hold it in a temporary variable and append it to the next line. Either way it will probably require one of Dave's hybrid scripts in case one of the tokens is empty.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p41582" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile41582">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content41582">

						<h3 ><a href="#p41582">Re: JREPL.BAT - regex text processor - successor to REPL.BAT</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting884c.html?mode=quote&amp;f=3&amp;p=41582" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicbbcb.html?p=41582#p41582" onclick="prompt('Message #78',this.href); return false;">#78</a></span> 
									<a class="unread" href="viewtopicbbcb.html?p=41582#p41582" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>10 Jun 2015 16:31
			</p>
			
			
			
			<div class="content">Sure thing Squashman - easy peasy <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br /><br />Of course the /M option is needed to search for \CR\LF. So this can't work on multi gigabyte files.<br /><br />I use the /T option to establish two search/replace pairs, with the left pair taking precedence. <br /><br />The first looks for comma, followed by 5 digits, followed by \CR\LF (\CR being optional), and replaces the string with itself.<br />The second looks for \CR\LF (\CR being optional), and replaces it with a space.<br /><br />I believe I have a bug <img class="smilies" src="images/smilies/icon_sad.gif" alt=":(" title="Sad" /><br />The following should work, but it does not substitute the $1 value properly. Instead it treats $1 as a literal.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>jrepl &quot;,\d{5}\r?\n|\r?\n&quot; &quot;$1| &quot; /m /t &quot;|&quot; /f test.csv /o -<br /></code></pre></div><br />But the following form using the /J option works great  <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /> <br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>jrepl &quot;,\d{5}\r?\n|\r?\n&quot; &quot;$1|' '&quot; /j /m /t &quot;|&quot; /f test.csv /o -<br /></code></pre></div><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p41591" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile41591">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf147.html?author_id=3221&amp;sr=posts">6033</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Feb 2012 02:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content41591">

						<h3 ><a href="#p41591">Re: JREPL.BAT - regex text processor - successor to REPL.BAT</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting090c.html?mode=quote&amp;f=3&amp;p=41591" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicdfca.html?p=41591#p41591" onclick="prompt('Message #79',this.href); return false;">#79</a></span> 
									<a class="unread" href="viewtopicdfca.html?p=41591#p41591" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a></strong> &raquo; </span>11 Jun 2015 03:50
			</p>
			
			
			
			<div class="content">This does depend on the data obviously, but assuming that the norty CRLF doesn't have a number after the  CRLF then this should work too.<br /><br />Just to be clearer, it's checking for a non-number both (before AND after) the CRLF <br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>jrepl &quot;(\D)\r\n(\D)&quot; &quot;$1 $2&quot; /m /x /f &quot;file.csv&quot;</code></pre></div></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p41601" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile41601">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist2675.html?mode=viewprofile&amp;u=2988" style="color: #00AA00;" class="username-coloured">Squashman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1322.html?author_id=2988&amp;sr=posts">3970</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 Dec 2011 13:59</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content41601">

						<h3 ><a href="#p41601">Re: JREPL.BAT - regex text processor - successor to REPL.BAT</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingc537.html?mode=quote&amp;f=3&amp;p=41601" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic95b2.html?p=41601#p41601" onclick="prompt('Message #80',this.href); return false;">#80</a></span> 
									<a class="unread" href="viewtopic95b2.html?p=41601#p41601" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist2675.html?mode=viewprofile&amp;u=2988" style="color: #00AA00;" class="username-coloured">Squashman</a></strong> &raquo; </span>11 Jun 2015 12:28
			</p>
			
			
			
			<div class="content">I ended up having to go with the 80/20 rule.  The code I used fixed the majority of the wrapping records, but I still had to manually fix a few dozen records because I just could not get it to match the expression.  The data was really bad so I doubt we could have come up with a regular expression that would have fixed them all but getting the majority really helped out a lot.<br /><br />Just tweaked Dave's code a bit.  I put in a check for two character state code before the zipcode.  But I also had to tweak the zipcode logic.  Sometimes the zipcode was listed without the leading Zero.  Why the USPS decided to use leading zeros for the zipcode is beyond me.  We all know how excel likes to drop leading zeros and trailing decimals with zero.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>jrepl &quot;,&#91;a-z&#93;&#91;a-z&#93;,\d{4,}\r?\n|\r?\n&quot; &quot;$1|' '&quot; /i /j /m /t &quot;|&quot; /f file.txt /o -</code></pre></div></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p41616" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile41616">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content41616">

						<h3 ><a href="#p41616">Re: JREPL.BAT - regex text processor - successor to REPL.BAT</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting0281.html?mode=quote&amp;f=3&amp;p=41616" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic23cf-2.html?p=41616#p41616" onclick="prompt('Message #81',this.href); return false;">#81</a></span> 
									<a class="unread" href="viewtopic23cf-2.html?p=41616#p41616" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>12 Jun 2015 07:42
			</p>
			
			
			
			<div class="content">I have fixed the /T bug such that $n and $nn substitution now works properly without the /J option. <img class="smilies" src="images/smilies/icon_smile.gif" alt=":-)" title="Smile" /><br /><br />So for Squashman, either of the following will now work:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>jrepl &quot;,&#91;a-z&#93;&#91;a-z&#93;,\d{4,}\r?\n|\r?\n&quot; &quot;$1| &quot; /i /m /t &quot;|&quot; /f file.txt /o -<br /></code></pre></div>or<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>jrepl &quot;,&#91;a-z&#93;&#91;a-z&#93;,\d{4,}\r?\n|\r?\n&quot; &quot;$&amp;| &quot; /i /m /t &quot;|&quot; /f file.txt /o -<br /></code></pre></div><br /><br /><strong class="text-strong">Here is version 3.5</strong><br /><div class="inline-attachment">
			
		
		
				<dl class="file">
			<dt><span class="imageset icon_topic_attach"></span> <a class="postlink" href="download/file0055.php?id=11">JREPL3.5.zip</a></dt>
						<dd>(8.7 KiB) Downloaded 73 times</dd>
		</dl>
		
		
			</div><br /><br />Dave Benham</div>

			
													<div class="notice">
					Last edited by <a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a> on 12 Jun 2015 10:49, edited 1 time in total.
									</div>
			
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p41617" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile41617">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf147.html?author_id=3221&amp;sr=posts">6033</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Feb 2012 02:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content41617">

						<h3 ><a href="#p41617">Re: JREPL.BAT - regex text processor - successor to REPL.BAT</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting6605-2.html?mode=quote&amp;f=3&amp;p=41617" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic7f79.html?p=41617#p41617" onclick="prompt('Message #82',this.href); return false;">#82</a></span> 
									<a class="unread" href="viewtopic7f79.html?p=41617#p41617" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a></strong> &raquo; </span>12 Jun 2015 09:16
			</p>
			
			
			
			<div class="content">I have a V 3.4 here already, Dave.<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>::JREPL.BAT version 3.4<br />::<br />::&nbsp; Release History:<br />::&nbsp; &nbsp; 2015-01-22 v3.4: Bug fix - Use /TEST instead of TEST as a variable name<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;within the option parser so that it is unlikely to<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;collide with a user defined variable name.<br />::&nbsp; &nbsp; 2014-12-24 v3.3: Bug fix for when /JMATCH is combined with /M or /S<br />::&nbsp; &nbsp; 2014-12-09 v3.2: Bug fix for /T without /JMATCH - fixed dynamic repl func<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Added GOTO at top for improved startup performance<br />::&nbsp; &nbsp; 2014-11-25 v3.1: Added /JLIB option<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Exception handler reports when regex is bad<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Fix /X bug with extended ASCII<br />::&nbsp; &nbsp; 2014-11-23 v3.0: Added /JBEGLN and /JENDLN options<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Added skip, quit, and lpad() global variables/functions<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Exception handler reports when error in user code<br />::&nbsp; &nbsp; 2014-11-21 v2.2: Bug fix for /T with /L option.<br />::&nbsp; &nbsp; 2014-11-20 v2.1: Bug fix for /T option when match is an empty string<br />::&nbsp; &nbsp; 2014-11-17 v2.0: Added /T (translate) and /C (count input lines) options<br />::&nbsp; &nbsp; 2014-11-14 v1.0: Initial release<br />::<br /></code></pre></div></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p41621" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile41621">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content41621">

						<h3 ><a href="#p41621">Re: JREPL.BAT - regex text processor - successor to REPL.BAT</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinga6bb.html?mode=quote&amp;f=3&amp;p=41621" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic6500.html?p=41621#p41621" onclick="prompt('Message #83',this.href); return false;">#83</a></span> 
									<a class="unread" href="viewtopic6500.html?p=41621#p41621" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>12 Jun 2015 10:55
			</p>
			
			
			
			<div class="content">Thanks foxi <img class="smilies" src="images/smilies/icon_exclaim.gif" alt=":!:" title="Exclamation" /> <br /><br />I made the change on a computer with an outdated version. <img class="smilies" src="images/smilies/icon_evil.gif" alt=":evil:" title="Evil or Very Mad" /> <br /><br />I've merged the two versions and edited my prior post to version 3.5.<br /><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p41623" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile41623">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist2675.html?mode=viewprofile&amp;u=2988" style="color: #00AA00;" class="username-coloured">Squashman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1322.html?author_id=2988&amp;sr=posts">3970</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 Dec 2011 13:59</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content41623">

						<h3 ><a href="#p41623">Re: JREPL.BAT - regex text processor - successor to REPL.BAT</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting1766.html?mode=quote&amp;f=3&amp;p=41623" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicc7b8.html?p=41623#p41623" onclick="prompt('Message #84',this.href); return false;">#84</a></span> 
									<a class="unread" href="viewtopicc7b8.html?p=41623#p41623" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist2675.html?mode=viewprofile&amp;u=2988" style="color: #00AA00;" class="username-coloured">Squashman</a></strong> &raquo; </span>12 Jun 2015 15:46
			</p>
			
			
			
			<div class="content">Is it possible to match 9 commas to basically say there are 10 fields and then a CRLF.  I am not sure of the syntax because you could have fields that are blank so it would be a double comma.  But if the asterisk matches the preceding character and a period matches any single character how do you create an expression that says there may or may not be data between the commas?<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>jrepl &quot;.*,.*,.*,.*,.*,.*,.*,.*,.*,.*\r?\n|\r?\n&quot; &quot;$1|' '&quot; /i /j /m /t &quot;|&quot; /f file.txt /o -</code></pre></div><br /><br />Or could you great a grouping and use a repetition factor of that grouping? Again not sure of the syntax.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>jrepl &quot;(.*,){9}.*\r?\n|\r?\n&quot; &quot;$1|' '&quot; /i /j /m /t &quot;|&quot; /f file.txt /o -</code></pre></div></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p41627" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile41627">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf147.html?author_id=3221&amp;sr=posts">6033</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Feb 2012 02:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content41627">

						<h3 ><a href="#p41627">Re: JREPL.BAT - regex text processor - successor to REPL.BAT</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting63c7.html?mode=quote&amp;f=3&amp;p=41627" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic5005-2.html?p=41627#p41627" onclick="prompt('Message #85',this.href); return false;">#85</a></span> 
									<a class="unread" href="viewtopic5005-2.html?p=41627#p41627" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a></strong> &raquo; </span>13 Jun 2015 03:05
			</p>
			
			
			
			<div class="content">Use this construct instead of .* and it will match each comma. <br /><br />By rights this should show you lines that do not have at least 10 fields.<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>jrepl &quot;.*?,.*?,.*?,.*?,.*?,.*?,.*?,.*?,.*?,.*&quot; &quot;&quot; /f file.txt </code></pre></div></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p41630" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile41630">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content41630">

						<h3 ><a href="#p41630">Re: JREPL.BAT - regex text processor - successor to REPL.BAT</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting1d17.html?mode=quote&amp;f=3&amp;p=41630" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic44cc.html?p=41630#p41630" onclick="prompt('Message #86',this.href); return false;">#86</a></span> 
									<a class="unread" href="viewtopic44cc.html?p=41630#p41630" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>13 Jun 2015 07:43
			</p>
			
			
			
			<div class="content">Yes, the ? makes the * non-greedy. That command finds lines with at least 9 commas and turns them into blank lines. The search regex can be dramatically simplified, and the command modified to preserve only lines that have at least 9 commas:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>jrepl &quot;(.*?,){9}.*&quot; &quot;$0&quot; /jmatch /f test.csv<br /></code></pre></div><br />But that doesn't really help solve the problem if you plan on using just a single jrepl pass. Whenever a logical line is split into two, then the first \LF must be turned into a space, but the last one should not, yet the line with the valid \LF did not have 9 commas <img class="smilies" src="images/smilies/icon_exclaim.gif" alt=":!:" title="Exclamation" /><br /><br />The solution is to use 3 jrepl passes. The first pass identifies &quot;valid&quot; \LF and doubles them. The second pass converts \CR\LF that do not precede \LF into a space, and the final pass converts \LF\LF back into \LF. I use [\s\S] instead of a dot so that it can match \LF.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>jrepl &quot;(&#91;\s\S&#93;*?,){9}.*\n&quot; &quot;$&amp;\n&quot; /x /m /f test.csv | jrepl &quot;\r?\n\n|\r?\n&quot; &quot;$&amp;| &quot; /m /t &quot;|&quot;&quot; | jrepl &quot;\n\n&quot; &quot;\n&quot; /x /m /o test.csv.new<br />move /y test.csv.new test.csv &gt;nul<br /></code></pre></div><br />I put the word &quot;valid&quot; in quotes because it is impossible to know for sure which \LF is valid if unwanted \LF can occur in the first column, and can also occur in the last column. <img class="smilies" src="images/smilies/icon_sad.gif" alt=":(" title="Sad" /><br />The above assumes the first occurring \LF after 9 commas is valid, so it does not allow \LF in the last column.<br /><br />Using jSCRIPT with the /J and /JBEG options, it is possible to do everything in one pass <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br />I keep a running count of which column I am in, as identified by commas. If I find a (\CR)\LF while in the 10th column, then I reset the count to 1 and preserve it, otherwise I replace it with a space. I seriously abuse the condition?expression:expression construct with an ugly hack, but it works  <img class="smilies" src="images/smilies/icon_wink.gif" alt=":wink:" title="Wink" /> <br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>jrepl &quot;,|\r?\n&quot; &quot;field+=1;$0|field==10?((field=1)==1?$0:''):' '&quot; /j /jbeg &quot;var field=1&quot; /t &quot;|&quot; /m /f test.csv /o -<br /></code></pre></div><br /><br />One final note - All the discussion so far assumes that all commas are column delimiters. But the CSV format allows for comma literals within values if the field is quoted. In reality, a field can also contain \LF if it is quoted, though not many parsers support that feature. The other complicating feature is quote literals are doubled within a quoted field. I don't think I would use JREPL to support these features with this problem, and I certainly wouldn't attempt it with pure batch. I would probably write a custom JScript script.<br /><br />I've written the hybrid <a href="viewtopic00e3.html?f=3&amp;t=5702" class="postlink">parseCSV.bat</a> that allows FOR /F to parse nearly any properly formatted CSV. But I don't see how it helps with this problem given that the CSV is not valid. However, the JScript within might be a good starting point in developing a custom JScript solution to this problem.<br /><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p41691" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile41691">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist2675.html?mode=viewprofile&amp;u=2988" style="color: #00AA00;" class="username-coloured">Squashman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1322.html?author_id=2988&amp;sr=posts">3970</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 Dec 2011 13:59</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content41691">

						<h3 ><a href="#p41691">Re: JREPL.BAT - regex text processor - successor to REPL.BAT</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting1584.html?mode=quote&amp;f=3&amp;p=41691" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicbc34.html?p=41691#p41691" onclick="prompt('Message #87',this.href); return false;">#87</a></span> 
									<a class="unread" href="viewtopicbc34.html?p=41691#p41691" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist2675.html?mode=viewprofile&amp;u=2988" style="color: #00AA00;" class="username-coloured">Squashman</a></strong> &raquo; </span>17 Jun 2015 22:00
			</p>
			
			
			
			<div class="content">Thanks for your help guys.  Have not tried the last examples as I have not been at work.  But since I have been off of work, it has given me some time to play around with some fun stuff in my free time.<br /><br />My oldest son races mountain bikes in the Wisconsin Off Road Series (WORS). <br /><br />I started working on a batch file to scrape his teams results from the website using WGET.<br /><br />The output is pretty well text aligned but when a person has a DNF (Did not finish) or a NR (Not rated) because they never started the race, the output gets misaligned for those racers because they do not have a time for the race.  Basically the text is off by 11 spaces.  So I am wondering is there a way to get the text lined up again with JREPL.<br /><br />Currently they have only raced in 4 races. After each race I will run this script.<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />TITLE Get WORS Results<br /><br />SET /P &quot;RACENUM=What race number do you want to retrieve? : &quot;<br /><br />FOR %%G IN (junior citizen_m citizen_f sport_m sport_f comp_m elite) DO (<br />&nbsp; &nbsp;FOR /F &quot;delims=&quot; %%H IN ('wget -O - -q http://www.wors.org/results/2015/%RACENUM%/overall/%%G.htm ^|findstr /I /C:&quot;Broken Spoke&quot;') DO (<br />&nbsp; &nbsp;&nbsp; &nbsp;&gt;&gt;ALL_Race_Results.txt echo %%H %RACENUM% %%G<br />&nbsp; &nbsp;)<br />)</code></pre></div><br /><br />So if you see the output of race one you will see what I am talking about.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&nbsp; &nbsp; 6&nbsp; &nbsp; &nbsp; &nbsp; 1 F 11-11&nbsp; &nbsp;6060&nbsp; &nbsp;Willow Kapitz&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Manitowoc&nbsp; WI&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 11&nbsp; &nbsp; &nbsp;28:15.4&nbsp; &nbsp; &nbsp; 3:32.8&nbsp; Broken Spoke Racing&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1 junior<br />&nbsp; &nbsp; 6&nbsp; &nbsp; &nbsp; &nbsp; 3 M 13-13&nbsp; &nbsp;6043&nbsp; &nbsp;Kaleb Moore&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Green Bay&nbsp; WI&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 13&nbsp; &nbsp; &nbsp;22:30.2&nbsp; &nbsp; &nbsp; 2:09.9&nbsp; Broken Spoke&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 junior<br />&nbsp; &nbsp;42&nbsp; &nbsp; &nbsp; &nbsp; 1 M&nbsp; 4- 8&nbsp; &nbsp;6034&nbsp; &nbsp;Thaddeus Sahs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Sturgeon Bay&nbsp; WI&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8&nbsp; &nbsp; &nbsp; 31:29.5&nbsp; &nbsp; &nbsp;11:09.2&nbsp; Broken Spoke Bike Studio&nbsp; &nbsp; &nbsp; &nbsp;1 junior<br />&nbsp; &nbsp;54&nbsp; &nbsp; &nbsp; &nbsp; 4 M&nbsp; 4- 8&nbsp; &nbsp;6061&nbsp; &nbsp;Ash Kapitz&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Manitowoc&nbsp; WI&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;7&nbsp; &nbsp; &nbsp;39:07.4&nbsp; &nbsp; &nbsp;18:47.1&nbsp; Broken Spoke Racing&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1 junior<br />&nbsp; &nbsp;19&nbsp; &nbsp; &nbsp; &nbsp; 2 M 45-49&nbsp; &nbsp;4152&nbsp; &nbsp;David Peck&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Green Bay&nbsp; WI&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 47&nbsp; &nbsp; &nbsp;51:06.0&nbsp; &nbsp; &nbsp; 5:14.4&nbsp; Broken Spoke&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 citizen_m<br />&nbsp; &nbsp;96&nbsp; &nbsp; &nbsp; &nbsp;15 M 45-49&nbsp; &nbsp;4055&nbsp; &nbsp;Dean Scharie&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Manitowoc&nbsp; WI&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 46&nbsp; &nbsp;1:01:42.7&nbsp; &nbsp; &nbsp;15:51.0&nbsp; Broken Spoke&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 citizen_m<br />&nbsp; &nbsp;21&nbsp; &nbsp; &nbsp; &nbsp; 1 F 25-34&nbsp; &nbsp;5066&nbsp; &nbsp;Desiree Schmidt&nbsp; &nbsp; &nbsp; &nbsp; Green Bay&nbsp; WI&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 28&nbsp; &nbsp;1:08:53.8&nbsp; &nbsp; &nbsp;16:04.6&nbsp; Broken Spoke&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 citizen_f<br />&nbsp; &nbsp;23&nbsp; &nbsp; &nbsp; &nbsp; 5 F 45-54&nbsp; &nbsp;5065&nbsp; &nbsp;Deb Neuville&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Sturgeon Bay&nbsp; WI&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;54&nbsp; &nbsp;1:10:34.0&nbsp; &nbsp; &nbsp;17:44.8&nbsp; Broken Spoke&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 citizen_f<br />&nbsp; &nbsp; 3&nbsp; &nbsp; &nbsp; &nbsp; 3 M 30-34&nbsp; &nbsp;2084&nbsp; &nbsp;Zachariah Radey&nbsp; &nbsp; &nbsp; &nbsp; Manitowoc&nbsp; WI&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 31&nbsp; &nbsp;1:09:36.9&nbsp; &nbsp; &nbsp; 2:04.6&nbsp; Broken Spoke Cycling Team&nbsp; &nbsp; &nbsp; 1 sport_m<br />&nbsp; &nbsp; 4&nbsp; &nbsp; &nbsp; &nbsp; 4 M 30-34&nbsp; &nbsp;2357&nbsp; &nbsp;Daniel Hebert&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; De Pere&nbsp; WI&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 31&nbsp; &nbsp;1:09:41.6&nbsp; &nbsp; &nbsp; 2:09.3&nbsp; Broken Spoke Studio&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1 sport_m<br />&nbsp; &nbsp; 9&nbsp; &nbsp; &nbsp; &nbsp; 1 M 35-39&nbsp; &nbsp;2063&nbsp; &nbsp;Greg Halverson&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Sheboygan Falls&nbsp; WI&nbsp; &nbsp; &nbsp; &nbsp; 39&nbsp; &nbsp;1:12:26.2&nbsp; &nbsp; &nbsp; 4:53.9&nbsp; Broken Spoke Cycling&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 sport_m<br />&nbsp; &nbsp;22&nbsp; &nbsp; &nbsp; &nbsp; 3 M 15-16&nbsp; &nbsp;2077&nbsp; &nbsp;Ethan Halverson&nbsp; &nbsp; &nbsp; &nbsp; Sheboygan Falls&nbsp; WI&nbsp; &nbsp; &nbsp; &nbsp; 16&nbsp; &nbsp;1:14:35.5&nbsp; &nbsp; &nbsp; 7:03.2&nbsp; Broken Spoke Cycling&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 sport_m<br />&nbsp; &nbsp;42&nbsp; &nbsp; &nbsp; &nbsp; 4 M 25-29&nbsp; &nbsp;2316&nbsp; &nbsp;David Rossow&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Green Bay&nbsp; WI&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 28&nbsp; &nbsp;1:17:56.3&nbsp; &nbsp; &nbsp;10:24.0&nbsp; The Broken Spoke Bike Studio,&nbsp; 1 sport_m<br />&nbsp; &nbsp;48&nbsp; &nbsp; &nbsp; &nbsp; 7 M 35-39&nbsp; &nbsp;2326&nbsp; &nbsp;Jeremy Rennie&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Green Bay&nbsp; WI&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 37&nbsp; &nbsp;1:18:31.5&nbsp; &nbsp; &nbsp;10:59.2&nbsp; Broken Spoke&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 sport_m<br />&nbsp; 103&nbsp; &nbsp; &nbsp; &nbsp;19 M 45-49&nbsp; &nbsp;2078&nbsp; &nbsp;Randal Sahs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Sturgeon Bay&nbsp; WI&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;46&nbsp; &nbsp;1:24:01.6&nbsp; &nbsp; &nbsp;16:29.3&nbsp; Broken Spoke bike Studio&nbsp; &nbsp; &nbsp; &nbsp;1 sport_m<br />&nbsp; &nbsp;15&nbsp; &nbsp; &nbsp; &nbsp; 4 F 45-54&nbsp; &nbsp;3011&nbsp; &nbsp;Toni House&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Oneida&nbsp; WI&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;53&nbsp; &nbsp;1:36:25.7&nbsp; &nbsp; &nbsp;17:26.9&nbsp; Broken Spoke&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 sport_f<br />&nbsp; &nbsp;23&nbsp; &nbsp; &nbsp; &nbsp; 5 F 25-34&nbsp; &nbsp;3058&nbsp; &nbsp;Jennifer Uttendorfer&nbsp; &nbsp;Madison&nbsp; WI&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 25&nbsp; &nbsp;1:51:59.8&nbsp; &nbsp; &nbsp;33:01.0&nbsp; Broken Spoke&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 sport_f<br />&nbsp; &nbsp;11&nbsp; &nbsp; &nbsp; &nbsp; 1 M 35-39&nbsp; &nbsp;1112&nbsp; &nbsp;Eric Stanke&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Green Bay&nbsp; WI&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 39&nbsp; &nbsp;1:42:00.7&nbsp; &nbsp; &nbsp; 6:16.6&nbsp; Broken Spoke Cycling Team&nbsp; &nbsp; &nbsp; 1 comp_m<br />&nbsp; &nbsp;21&nbsp; &nbsp; &nbsp; &nbsp; 1 M 50-54&nbsp; &nbsp;1160&nbsp; &nbsp;Michael Jones&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Fish Creek&nbsp; WI&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;54&nbsp; &nbsp;1:45:24.3&nbsp; &nbsp; &nbsp; 9:40.3&nbsp; Broken Spoke&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 comp_m<br />&nbsp; &nbsp;23&nbsp; &nbsp; &nbsp; &nbsp; 7 M 30-34&nbsp; &nbsp;1024&nbsp; &nbsp;George Kapitz&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Manitowoc&nbsp; WI&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 33&nbsp; &nbsp;1:45:27.6&nbsp; &nbsp; &nbsp; 9:43.5&nbsp; Broken Spoke Racing&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1 comp_m<br />&nbsp; &nbsp;47&nbsp; &nbsp; &nbsp; &nbsp; 7 M 40-44&nbsp; &nbsp;1074&nbsp; &nbsp;Scott Trierweiler&nbsp; &nbsp; &nbsp; Marshfield&nbsp; WI&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;41&nbsp; &nbsp;1:52:36.9&nbsp; &nbsp; &nbsp;16:52.9&nbsp; Broken Spoke cycles&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1 comp_m<br />&nbsp; DNF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; M 45-49&nbsp; &nbsp;1180&nbsp; &nbsp;Michael Anderson&nbsp; &nbsp; &nbsp; &nbsp;Green Bay&nbsp; WI&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 47&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Broken Spoke&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 comp_m<br />&nbsp; &nbsp;NR&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; M 30-34&nbsp; &nbsp;1037&nbsp; &nbsp;Brandon Teske&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Madison&nbsp; WI&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 32&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Broken Spoke&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 comp_m<br /></code></pre></div><br /><br />Is there any way to get the text to all line up when the racer has a DNF or NR using JREPL?<br /><br />Then eventually I will change the output to a CSV so that I can import it into excel.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p41692" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile41692">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content41692">

						<h3 ><a href="#p41692">Re: JREPL.BAT - regex text processor - successor to REPL.BAT</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting7ebf.html?mode=quote&amp;f=3&amp;p=41692" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopiced29.html?p=41692#p41692" onclick="prompt('Message #88',this.href); return false;">#88</a></span> 
									<a class="unread" href="viewtopiced29.html?p=41692#p41692" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>17 Jun 2015 22:53
			</p>
			
			
			
			<div class="content">Pretty rudimentary regex is all that is needed.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>jrepl &quot;^(&nbsp; DNF|&nbsp; &nbsp;NR).{80}&quot; &quot;$&amp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot; /f test.txt<br /></code></pre></div><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p41693" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile41693">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist2675.html?mode=viewprofile&amp;u=2988" style="color: #00AA00;" class="username-coloured">Squashman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1322.html?author_id=2988&amp;sr=posts">3970</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 Dec 2011 13:59</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content41693">

						<h3 ><a href="#p41693">Re: JREPL.BAT - regex text processor - successor to REPL.BAT</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting5aca.html?mode=quote&amp;f=3&amp;p=41693" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicd7ee.html?p=41693#p41693" onclick="prompt('Message #89',this.href); return false;">#89</a></span> 
									<a class="unread" href="viewtopicd7ee.html?p=41693#p41693" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist2675.html?mode=viewprofile&amp;u=2988" style="color: #00AA00;" class="username-coloured">Squashman</a></strong> &raquo; </span>17 Jun 2015 23:34
			</p>
			
			
			
			<div class="content">Cool beans.  That makes complete sense. Regular Expressions have not always been my forte. If I use them enough I remember how to use them. But if I have not used them in a while I forget how to use them.<br /><br />Of course this now makes for a very very very long line in my batch file.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />TITLE Get WORS Results<br /><br />SET /P &quot;RACENUM=What race number do you want to retrieve? : &quot;<br /><br />FOR %%G IN (junior citizen_m citizen_f sport_m sport_f comp_m elite) DO (<br />&nbsp; &nbsp;FOR /F &quot;delims=&quot; %%H IN ('wget -O - -q http://www.wors.org/results/2015/%RACENUM%/overall/%%G.htm ^|findstr /I /C:&quot;Broken Spoke&quot; ^|jrepl &quot;^(&nbsp; DNF|&nbsp; &nbsp;NR).{80}&quot; &quot;$&amp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;') DO (<br />&nbsp; &nbsp;&nbsp; &nbsp;&gt;&gt;ALL_Race_Results.txt echo %%H %RACENUM% %%G<br />&nbsp; &nbsp;)<br />)</code></pre></div></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p41698" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile41698">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf147.html?author_id=3221&amp;sr=posts">6033</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Feb 2012 02:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content41698">

						<h3 ><a href="#p41698">Re: JREPL.BAT - regex text processor - successor to REPL.BAT</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting5d6c.html?mode=quote&amp;f=3&amp;p=41698" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic250f-2.html?p=41698#p41698" onclick="prompt('Message #90',this.href); return false;">#90</a></span> 
									<a class="unread" href="viewtopic250f-2.html?p=41698#p41698" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a></strong> &raquo; </span>18 Jun 2015 05:27
			</p>
			
			
			
			<div class="content">I didn't read to the end of the page - and my effort would make it even longer... but there ya go:<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>jrepl &quot;(^&#91; &#93;*?)(DNF|NR)(.{90})(.*)&quot; &quot;$1$2$3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$4&quot; /f</code></pre></div></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
	

	<div class="action-bar bar-bottom">
	
			<a href="postingdfbb.html?mode=reply&amp;f=3&amp;t=6044" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic3913.html?f=3&amp;t=6044&amp;start=75&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

			<form method="post" action="https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=6044&amp;start=75">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			393 posts
							<ul>
	<li class="dropdown-container dropdown-button-control dropdown-page-jump page-jump">
		<a class="button button-icon-only dropdown-trigger" href="#" title="Click to jump to page…" role="button"><i class="icon fa-level-down fa-rotate-270" aria-hidden="true"></i><span class="sr-only">Page <strong>6</strong> of <strong>27</strong></span></a>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
				<li>Jump to page:</li>
				<li class="page-jump-form">
					<input type="number" name="page-number" min="1" max="999999" title="Enter the page number you wish to go to" class="inputbox tiny" data-per-page="15" data-base-url=".&#x2F;viewtopic.php&#x3F;f&#x3D;3&amp;amp&#x3B;t&#x3D;6044" data-start-name="start" />
					<input class="button2" value="Go" type="button" />
				</li>
			</ul>
		</div>
	</li>
			<li class="arrow previous"><a class="button button-icon-only" href="viewtopicf93e.html?f=3&amp;t=6044&amp;start=60" rel="prev" role="button"><i class="icon fa-chevron-left fa-fw" aria-hidden="true"></i><span class="sr-only">Previous</span></a></li>
				<li><a class="button" href="viewtopicb16d.html?f=3&amp;t=6044" role="button">1</a></li>
			<li class="ellipsis" role="separator"><span>…</span></li>
				<li><a class="button" href="viewtopic29a7.html?f=3&amp;t=6044&amp;start=45" role="button">4</a></li>
				<li><a class="button" href="viewtopicf93e.html?f=3&amp;t=6044&amp;start=60" role="button">5</a></li>
			<li class="active"><span>6</span></li>
				<li><a class="button" href="viewtopicdf57.html?f=3&amp;t=6044&amp;start=90" role="button">7</a></li>
				<li><a class="button" href="viewtopic7e6f.html?f=3&amp;t=6044&amp;start=105" role="button">8</a></li>
			<li class="ellipsis" role="separator"><span>…</span></li>
				<li><a class="button" href="viewtopic54c6.html?f=3&amp;t=6044&amp;start=390" role="button">27</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopicdf57.html?f=3&amp;t=6044&amp;start=90" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="viewforum4d6b.html?f=3" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to “DOS Batch Forum”</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="viewforum31e6.html?f=4" class="jumpbox-cat-link"> <span> DosTips - Dos Batch</span></a></li>
																<li><a href="viewforum4d6b.html?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; DOS Batch Forum</span></a></li>
											</ul>
		</div>
	</div>

	</div>


			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
							<span class="crumb"><a href="../index.html" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>DosTips.com</span></a></span>									<span class="crumb"><a href="index.html" data-navbar-reference="index"><span>Board index</span></a></span>					</li>
		
				<li class="rightside">All times are <span title="UTC-6">UTC-06:00</span></li>
							<li class="rightside">
				<a href="ucp033a.html?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete all board cookies</span>
				</a>
			</li>
												<li class="rightside" data-last-responsive="true">
				<a href="memberlist4bfd.html?mode=team" role="menuitem">
					<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
				</a>
			</li>
									<li class="rightside" data-last-responsive="true">
				<a href="memberlist8733.html?mode=contactadmin" role="menuitem">
					<i class="icon fa-envelope fa-fw" aria-hidden="true"></i><span>Contact us</span>
				</a>
			</li>
			</ul>

	</div>
</div>

	<div class="copyright">
				<!-- WARNING NO DELETE -->Style developer by <a href="http://tricolor.x-tk.ru/">support forum tricolor</a>, <!-- END WARNING NO DELETE -->Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
									</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	<img src="cron5495.gif?cron_type=cron.task.text_reparser.poll_title" width="1" height="1" alt="cron" /></div>

<script type="text/javascript" src="assets/javascript/jquery.mind772.js?assets_version=34"></script>
<script type="text/javascript" src="assets/javascript/cored772.js?assets_version=34"></script>



<script type="text/javascript" src="styles/prosilver/template/forum_fnd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/prosilver/template/ajaxd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/jquery-uid772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/collapsed772.js?assets_version=34"></script>



</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?p=41630 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 08:03:09 GMT -->
</html>
