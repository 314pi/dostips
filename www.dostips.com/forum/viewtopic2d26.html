<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=1626&hilit=batchlib by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 09:21:41 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>BatchLibrary or how to include batch files - DosTips.com</title>


	<link rel="canonical" href="viewtopica7a4.html?t=1626">

<!--
	phpBB style name: Allan Style - SUBSILVER
	Based on style:   prosilver (this is the default phpBB3 style)
	Based on style:   subsilver2 (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:  Allan ( http://x-tk.ru/ )
-->

<link href="assets/css/font-awesome.mind772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/stylesheetd772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/en/stylesheetd772.css?assets_version=34" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="./styles/AllanStyle-SUBSILVER/theme/tweaks.css?assets_version=34" rel="stylesheet">
<![endif]-->




<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','../../www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-280191-1', 'auto');
	ga('send', 'pageview');
</script>

</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">

<div id="header-subsilver">
	<a id="top" class="top-anchor" accesskey="t"></a>
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description" class="site-description">
				<a id="logo" class="logo" href="../index.html" title="DosTips.com"><span class="site_logo"></span></a>
				<h1>DosTips.com</h1>
				<p>A Forum all about DOS Batch</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

									<div id="search-box" class="search-box search-header" role="search">
				<form action="https://www.dostips.com/forum/search.php" method="get" id="search">
				<fieldset>
					<input name="keywords" id="keywords" type="search" maxlength="128" title="Search for keywords" class="inputbox search tiny" size="20" value="" placeholder="Search…" />
					<button class="button button-search" type="submit" title="Search">
						<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
					</button>
					<a href="search.html" class="button button-search-end" title="Advanced search">
						<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
					</a>
					
				</fieldset>
				</form>
			</div>
						
			</div>
					</div>
</div>


<div id="wrap" class="wrap">
	<div id="page-header">
				<div class="navbar-top" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
																									<li>
								<a href="search33a7.html?search_id=unanswered" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="search526f.html?search_id=active_topics" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-blue" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="search.html" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
											<li class="separator"></li>
																			<li>
								<a href="memberlist4bfd.html?mode=team" role="menuitem">
									<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
								</a>
							</li>
																<li class="separator"></li>

									</ul>
			</div>
		</li>

				<li data-skip-responsive="true">
			<a href="app.php/help/faq.html" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
						
			<li class="rightside"  data-skip-responsive="true">
			<a href="ucp26c3.html?mode=login" title="Login" accesskey="x" role="menuitem">
				<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Login</span>
			</a>
		</li>
					<li class="rightside" data-skip-responsive="true">
				<a href="ucp8319.html?mode=register" role="menuitem">
					<i class="icon fa-pencil-square-o  fa-fw" aria-hidden="true"></i><span>Register</span>
				</a>
			</li>
						</ul>

	</div>
</div>

<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
						<li class="breadcrumbs">
							<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="../index.html" itemprop="url" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span itemprop="title">DosTips.com</span></a></span>
										<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="index.html" itemprop="url" accesskey="h" data-navbar-reference="index"><span itemprop="title">Board index</span></a></span>

											<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="4"><a href="viewforum31e6.html?f=4" itemprop="url"><span itemprop="title">DosTips - Dos Batch</span></a></span>
															<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="3"><a href="viewforum4d6b.html?f=3" itemprop="url"><span itemprop="title">DOS Batch Forum</span></a></span>
												</li>
		
					<li class="rightside responsive-search">
				<a href="search.html" title="View the advanced search options" role="menuitem">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</a>
			</li>
			</ul>

	</div>
</div>

<div class="navbar-top-link">
	<div class="inner">
		<ul>
			<li class="navbar-top-link-left"><a href="search33a7.html?search_id=unanswered">Unanswered topics</a></li>
			<li class="navbar-top-link-left"><a href="search526f.html?search_id=active_topics">Active topics</a></li>

											</ul>
	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
		
<h2 class="topic-title"><a href="viewtopic2d26.html?f=3&amp;t=1626&amp;hilit=batchlib">BatchLibrary or how to include batch files</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">Discussion forum for all Windows batch related topics.<br /></div>
<p>
	<strong>Moderator:</strong> <a href="memberlista6a8.html?mode=viewprofile&amp;u=5" class="username">DosItHelp</a>
</p>


<div class="action-bar bar-top">
	
			<a href="posting234a.html?mode=reply&amp;f=3&amp;t=1626" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopicb1fc.html?f=3&amp;t=1626&amp;hilit=batchlib&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="https://www.dostips.com/forum/search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topic…" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="search.html" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="1626" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			15 posts
							&bull; Page <strong>1</strong> of <strong>1</strong>
					</div>
		</div>




<div id="subsilver-nav-topic">
	<div class="inner"><div class="post has-profile">
		<div class="leftsided postbody subsilver-topic-title">Message</div>
		<div class="leftsided postprofile subsilver-topic-author">Author</div>
	</div></div>
</div>

			<div id="p6369" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile6369">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist7125.html?mode=viewprofile&amp;u=417" class="username">jeb</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search73f1.html?author_id=417&amp;sr=posts">880</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 30 Aug 2007 08:05</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany, Bochum</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content6369">

						<h3 class="first"><a href="#p6369">BatchLibrary or how to include batch files</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting96d5-2.html?mode=quote&amp;f=3&amp;p=6369" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic72f0.html?p=6369#p6369" onclick="prompt('Message #1',this.href); return false;">#1</a></span> 
									<a class="unread" href="viewtopic72f0.html?p=6369#p6369" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist7125.html?mode=viewprofile&amp;u=417" class="username">jeb</a></strong> &raquo; </span>04 Feb 2011 16:46
			</p>
			
			
			
			<div class="content">Hi,<br /><br />this site shows many functions and they all can build a useful library, <br />but it's always annoying that I have to copy &amp; paste them into my code.<br /><br />So I decide to write a batchLibrary that can be included from a batch and can also include other batch files.<br /><br />To use it, there should be a simple way to activate the library without too much overhead.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />REM 1. Prepare the BatchLibrary for the start command<br />call <span class="posthilit">BatchLib</span>.bat<br /><br />REM 2. Start of the <span class="posthilit">Batchlib</span>, acquisition of the command line parameters, activates the code with the base-library<br />&lt;:%BL.Start%<br /><br />rem&nbsp; Importing more libraries ...<br />call :bl.import &quot;bl_DateTime.bat&quot;<br />call :bl.import &quot;bl_String.bat&quot;<br /><br />rem Use library functions<br />call :bl.String.Length result abcdefghij<br />echo len=%result%<br /></code></pre></div><br /><br />I split the library start into two parts, because it seems to be the only way to retrieve the start parameters.<br /><br />And here is the base library<br /><br /><span style="color: #40FF00"><span class="posthilit">BatchLib</span>.bat</span><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>REM ************** BEGIN OF <span class="posthilit">BATCHLIB</span> **************<br />REM * A &quot;real&quot; batch library system, that allowes to import other batch files into a batch application<br />REM * <br />REM * written 2010 by jeb<br />REM *******************<br />@echo off<br />setlocal EnableDelayedExpansion<br />set &quot;param1=%~1&quot;<br /><br />REM *** Decide if the Library is started for initalization or only for the first prepare<br />if &quot;!param1!&quot;==&quot;/INTERN_START&quot; goto :bl_InternalStart<br /><br />if /i &quot;!param1!&quot; EQU &quot;/S&quot; (<br />&nbsp; &nbsp;REM ** Secure start, retrieve the parameter in a secure way, it accepts nearly every parameter, but it needs a temporary file<br />&nbsp; &nbsp;REM ** TODO: Implement the REM redirect, Problems: access more than %1 ..%9 (shift, detect the end), double expansion of %%<br />&nbsp; &nbsp;REM ** Buy it now for only 399Euro :-)<br />&nbsp; &nbsp;echo NOT IMPLEMENTED<br />&nbsp; &nbsp;EXIT<br />) ELSE (<br />&nbsp; &nbsp;REM ** Basic start, retrieve the parameter in a simple way, it fails with complex parameters like &quot;&amp;&quot;&amp;&quot;&amp;<br />&nbsp; &nbsp;REM ** TODO: Accept more than %9 parameters<br />&nbsp; &nbsp;set BL.Start=#&quot;:&lt; nul ( setlocal EnableDelayedExpansion &amp; set &quot;bl.cmdcmdline=^^!cmdcmdline^^!&quot; &amp; call set &quot;bl.param&#91;0&#93;=%%~f0&quot; &amp; FOR /L %%n IN (1,1,9) DO ( call set &quot;bl.param&#91;%%n&#93;=%%~1&quot; &amp; shift /1 ) )#&quot;^<br />#&quot;&nbsp; &nbsp;&amp; &quot;%~f0&quot; /INTERN_START &quot;^^!bl.param&#91;0&#93;^^!&quot;#&quot;<br />)<br />(<br />&nbsp; ENDLOCAL<br />&nbsp; set &quot;BL.Start=%BL.Start:#&quot;=%&quot;<br />&nbsp; goto :eof<br />)<br /><br />:bl_InternalStart<br />rem echo Library init from &quot;%param&#91;0&#93;%&quot;<br /><br />rem Create Temporary Batchfile with library functions<br /><br />rem Create first line with call to library_init and jump to the application, suppress a line ending for consistent line numbers<br />&gt; &quot;%~n2.tmp&quot;&nbsp; &lt;nul set /p &quot;.=call :BL.Init &amp; goto :%%%%Bl.Start%%%% &amp; rem &quot; <br />rem Append the original batch file<br />&gt;&gt; &quot;%~n2.tmp&quot; type &quot;%~f2&quot;<br /><br />REM Append a &quot;good&quot; file stop mark<br />(<br />echo(<br />echo ^)<br />echo goto :eof<br />) &gt;&gt; &quot;%~n2.tmp&quot;<br /><br />rem Append this library<br />&gt;&gt; &quot;%~n2.tmp&quot; type &quot;%~f0&quot;<br /><br />del &quot;%~n2.BLibTmp.bat&quot; 2&gt; nul &gt; nul<br />ren &quot;%~n2.tmp&quot; &quot;%~n2.BLibTmp.bat&quot; &gt; nul<br /><br />rem Asynchron start, creates a new cmd instance in the same window<br />rem Required, even if the application exit or crash the library can do the rest<br />rem (set dummy=) | ( call &quot;%~n1.BLibTmp.bat&quot; &quot;%~2&quot; )<br /><br />REM Block this, so it is cached and not depends on a file<br />(<br />&nbsp; &nbsp;call &quot;%~n2.BLibTmp.bat&quot;<br />&nbsp; &nbsp;rem start &quot;&quot; /wait /b &quot;%~n1.BLibTmp.bat&quot; &quot;%~2&quot;<br />&nbsp; &nbsp;REM echo End of application, remove temporary file^(s^)<br />&nbsp; &nbsp;set &quot;err=%errorlevel%&quot;<br />&nbsp; &nbsp;del &quot;%~n2.BLibTmp.bat&quot; &gt; nul<br />&nbsp; &nbsp;exit /b !err!<br />)<br />:: End of function<br /><br />:BL.Init<br />rem At this moment there is nothing to do<br />call :BL.DragAndDrop.Parser<br />goto :eof<br />:: End of function<br /><br />:: Imports/append the file to the current batch file<br />:BL.Import &#91;filename.bat&#93;<br />(<br />&nbsp; &nbsp;setlocal EnableDelayedExpansion<br />&nbsp; &nbsp;type &quot;%~1&quot; &gt;&gt; &quot;%~dpf0&quot;<br />&nbsp; &nbsp;set &quot;func=%~n1.Init&quot;<br />&nbsp; &nbsp;set &quot;func=!func:_=.!&quot;<br />)<br />(<br />&nbsp; &nbsp;endlocal<br />&nbsp; &nbsp;call :%func%<br />&nbsp; &nbsp;goto :eof<br />)<br />:: End of function<br /><br />:: Builds a drag &amp; drop filelist, this list should be used, because files like &quot;Drag&amp;drop.bat&quot; passed in the wrong way by windows<br />:: Therefore a Drag&amp;Drop Batchfile should always end with an EXIT to suppress the execution of further commands after ampersands<br />rem Take the cmd-line, remove all until the first parameter<br />:BL.DragAndDrop.Parser<br />(<br />&nbsp; &nbsp;set &quot;$$$.params=!bl.cmdcmdline:~0,-1!&quot;<br />&nbsp; &nbsp;set &quot;$$$.params=!$$$.params:*&quot; =!&quot;<br />&nbsp; &nbsp;set bl.dragDrop.count=0<br /><br />&nbsp; &nbsp;rem Split the parameters on spaces but respect the quotes<br />&nbsp; &nbsp;for %%G IN (!$$$.params!) do (<br />&nbsp; &nbsp;&nbsp; set /a bl.dragDrop.count+=1<br />&nbsp; &nbsp;&nbsp; set &quot;bl.dragDrop&#91;!bl.dragDrop.count!&#93;=%%~G&quot;<br />&nbsp; &nbsp;)<br />&nbsp; &nbsp;set &quot;$$$.params=&quot;<br />&nbsp; &nbsp;goto :eof<br />)<br />:: End of function</code></pre></div><br /><br /><span style="color: #40FF00">bl_String.bat</span><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>REM *** begin of library <span class="posthilit">BATCHLIB</span>.String **************<br /><br />REM * STOP here if runs accidental to this point<br />rem %~ CRITICAL STOP in <span class="posthilit">BATCHLIB</span>.String<br /><br />:BL.String.Init<br />call :BL.String.CreateLF<br />call :BL.String.CreateCR<br />call :BL.String.CreateDEL_ESC<br />call :BL.String.CreateLatin1Chars<br />goto :eof<br />::End of function<br /><br />::###############################<br />:BL.String.length &lt;resultVar&gt; &lt;stringVar&gt;<br />(&nbsp; &nbsp;<br />&nbsp; &nbsp;setlocal EnableDelayedExpansion<br />&nbsp; &nbsp; set &quot;s=%~2#&quot;<br />&nbsp; &nbsp; set &quot;len=0&quot;<br />&nbsp; &nbsp; for %%P in (4096 2048 1024 512 256 128 64 32 16 8 4 2 1) do (<br />&nbsp; &nbsp;&nbsp; &nbsp;if &quot;!s:~%%P,1!&quot; NEQ &quot;&quot; ( <br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;set /a &quot;len+=%%P&quot;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;set &quot;s=!s:~%%P!&quot;<br />&nbsp; &nbsp;&nbsp; &nbsp;)<br />&nbsp; &nbsp;)<br />)<br />( <br />&nbsp; &nbsp;endlocal<br />&nbsp; &nbsp; set &quot;%~1=%len%&quot;<br />&nbsp; &nbsp;exit /b<br />)<br />::End of function<br /><br />:BL.String.CreateLF<br />:: Creates a variable with one character LF=Ascii-10<br />:: LF should&nbsp; be used later only with DelayedExpansion<br />set LF=^<br /><br /><br />rem ** The two empty lines are neccessary, spaces are not allowed<br />rem ** Creates a percent variant &quot;NLM=^LF&quot;, but normaly you should use the !LF! variant<br />set ^&quot;NLF=^^^%lf%%lf%^%lf%%lf%^&quot;<br />goto :eof<br /><br />:BL.String.CreateDEL_ESC<br />:: Creates two variables with one character DEL=Ascii-08 and ESC=Ascii-27<br />:: DEL and ESC can be used&nbsp; with and without DelayedExpansion<br />setlocal<br />for /F &quot;tokens=1,2 delims=#&quot; %%a in ('&quot;prompt #$H#$E# &amp; echo on &amp; for %%b in (1) do rem&quot;') do (<br />&nbsp; ENDLOCAL<br />&nbsp; set &quot;DEL=%%a&quot;<br />&nbsp; set &quot;ESC=%%b&quot;<br />&nbsp; goto :EOF<br />)<br />goto :eof<br /><br />:BL.String.CreateCR<br />::: CR should&nbsp; be used only with DelayedExpansion<br />for /F &quot;usebackq&quot; %%a in (`copy /Z &quot;%~dpf0&quot; nul`) DO (<br />&nbsp; &nbsp;set &quot;cr=%%a&quot;<br />)<br />goto :eof<br /><br /><br />:BL.String.CreateCR_OldVariant<br />::: CR should&nbsp; be used only with DelayedExpansion<br />setlocal EnableDelayedExpansion EnableExtensions<br />set &quot;X=.&quot;<br />for /L %%c in (1,1,13) DO set X=!X:~0,4094!!X:~0,4094!<br /><br />echo !X!&nbsp; &gt; %temp%\cr.tmp<br />echo\&gt;&gt; %temp%\cr.tmp<br />for /f &quot;tokens=2 usebackq&quot; %%a in (&quot;%temp%\cr.tmp&quot;) do (<br />&nbsp; &nbsp;endlocal<br />&nbsp; &nbsp;set cr=%%a<br />&nbsp; &nbsp;rem set x=<br />&nbsp; &nbsp;goto :eof<br />)<br />goto :eof<br /><br />:BL.String.CreateLatin1Chars<br />&nbsp; &nbsp;chcp 1252 &gt; NUL<br />&nbsp; &nbsp;set &quot;char&#91;deg&#93;=°&quot;<br />&nbsp; &nbsp;set &quot;char&#91;ae&#93;.lower=ä&quot;<br />&nbsp; &nbsp;set &quot;char&#91;oe&#93;.lower=ö&quot;<br />&nbsp; &nbsp;set &quot;char&#91;ue&#93;.lower=ü&quot;<br />&nbsp; &nbsp;set &quot;char&#91;sz&#93;=ß&quot;<br />&nbsp; &nbsp;set &quot;char&#91;AE&#93;.upper=Ä&quot;<br />&nbsp; &nbsp;set &quot;char&#91;OE&#93;.upper=Ö&quot;<br />&nbsp; &nbsp;set &quot;char&#91;UE&#93;.upper=Ü&quot;<br />&nbsp; &nbsp;chcp 850 &gt; NUL<br />goto :eof<br /><br />:BL.String.Format &lt;resultVar&gt; &lt;format&gt; &#91;parameters&#93;<br />REM TODO: Implement an extended format function<br />&nbsp; &nbsp;setlocal EnableDelayedExpansion<br />&nbsp; &nbsp;set &quot;result=&quot;<br />&nbsp; &nbsp;set &quot;format.count=1&quot;<br />&nbsp; &nbsp;set &quot;formatParam=%~2&quot;<br /><br />&nbsp; &nbsp;:__BL.String.Format.Splitter<br />&nbsp; &nbsp;if not defined formatParam<br />&nbsp; &nbsp;set formatParamLeft=!formatParam:{*=!<br />&nbsp; &nbsp;set &quot;format&#91;%format.count%&#93;=!formatParamLeft!&quot;<br />&nbsp; &nbsp;set /a format.count+=1<br />&nbsp; &nbsp;goto :__BL.String.Format.Splitter<br /><br />&nbsp; &nbsp;set &quot;result=&quot;<br />&nbsp; &nbsp;(<br />&nbsp; &nbsp;&nbsp; &nbsp;ENDLOCAL<br />&nbsp; &nbsp;&nbsp; &nbsp;goto :eof<br />)<br />REM **** end of library <span class="posthilit">BATCHLIB</span>.String<br /></code></pre></div><br /><br /><br /><span style="color: #40FF00">bl_DateTime.bat</span><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>REM *** begin of library <span class="posthilit">BATCHLIB</span>.DateTime **************<br /><br />REM * STOP here if runs accidental to this point<br />rem %~ CRITICAL STOP in <span class="posthilit">BATCHLIB</span>.DateTime<br /><br />::###############################<br />:bl.DateTime.Init<br />goto :eof<br />::End of function<br /><br />::###############################<br />:bl.DateTime.Sleep<br />(<br />setlocal EnableDelayedExpansion<br />set /a sleepCnt=%~1+1<br />ping 127.0.0.1 -n !sleepCnt! 2&gt; nul 1&gt;nul<br />endlocal<br />goto :eof<br />)<br />::End of function<br /><br />::###############################<br />::### WARNING, enclose the time in quotes &quot;, because it can contain comma seperators<br />:bl.DateTime.timeDiff &lt;resultVar&gt; &lt;start_time&gt; &lt;end_time&gt;<br />(<br />&nbsp; SETLOCAL<br />&nbsp; if &quot;%~4&quot; NEQ &quot;&quot; (<br />&nbsp; &nbsp; echo ERROR in :bl.DateTime.timeDiff too much parameter<br />&nbsp; &nbsp;exit /b 4<br />&nbsp; )<br />&nbsp; call :bl.DateTime.timeToMs ms_start &quot;%~2&quot;<br />&nbsp; call :bl.DateTime.timeToMs ms_end &quot;%~3&quot;<br />)<br />set /a diff_ms=ms_end - ms_start<br />(<br />&nbsp; ENDLOCAL<br />&nbsp; set %~1=%diff_ms%<br />&nbsp; goto :eof<br />)<br />::End of function<br /><br />::###############################<br />:bl.DateTime.timeToMs &lt;resultVar&gt; &lt;time&gt;<br />::### WARNING, enclose the time in quotes &quot;, because it can contain comma seperators<br />::### WARNING it does not convert time in am/pm format, because it's regressive<br />SETLOCAL<br />FOR /F &quot;tokens=1,2,3,4 delims=:,.^ &quot; %%a IN (&quot;%~2&quot;) DO (<br />&nbsp; set /a ms=^(^(^(30%%a%%100^)*60+7%%b^)*60+3%%c-42300^)*1000+^(1%%d0 %% 1000^)<br />)<br />(<br />&nbsp; ENDLOCAL<br />&nbsp; set %~1=%ms%<br />&nbsp; goto :eof<br />)<br />::End of function<br /><br />REM **** end of library <span class="posthilit">BATCHLIB</span>.DateTime<br /></code></pre></div><br /><br /><span style="color: #40FF00">LibTest1.bat</span><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br /><br />set &quot;t1=%time%&quot;<br /><br />REM 1. Prepare the BatchLibrary for the start command<br />call <span class="posthilit">BatchLib</span>.bat<br /><br />REM 2. Start of the <span class="posthilit">Batchlib</span>, acquisition of the command line parameters, swtich to the temporary LibTest1.BLibTmp.bat<br />&lt;:%BL.Start%<br /><br />rem&nbsp; Importing libraries ...<br />call :bl.import &quot;bl_DateTime.bat&quot;<br />call :bl.import &quot;bl_String.bat&quot;<br /><br />set &quot;t2=%time%&quot;<br />call :bl.DateTime.timeDiff&nbsp; &nbsp;duration &quot;%t1%&quot; &quot;%t2%&quot;<br />echo libraries loaded, duration %duration%ms<br /><br />echo !lf!Counter demo<br />for /L %%n in (1,1,10) DO (<br />&nbsp; &nbsp;call :bl.dateTime.sleep 1<br />&nbsp; &nbsp;&lt;nul set /p &quot;.=!del!!cr!%%n&quot;<br />)<br />echo(<br /><br />set str=abcdefghijkl<br />call :bl.string.length result %str%<br />echo The length of str=&quot;%str%&quot; is %result%<br /></code></pre></div><br /><br />hope it helps<br />jeb</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6371" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile6371">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search661c.html?author_id=1265&amp;sr=posts">3386</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 22 Jan 2010 18:01</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content6371">

						<h3 ><a href="#p6371">Re: BatchLibrary or how to include batch files</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting5aae.html?mode=quote&amp;f=3&amp;p=6371" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic22fc-2.html?p=6371#p6371" onclick="prompt('Message #2',this.href); return false;">#2</a></span> 
									<a class="unread" href="viewtopic22fc-2.html?p=6371#p6371" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a></strong> &raquo; </span>04 Feb 2011 17:17
			</p>
			
			
			
			<div class="content">That's pretty cool, jeb.<br /><br />Some years ago I thought about &quot;including&quot; and 2 days ago you reminded me on it. If I find my old test files I could post them as well.<br /><br />Regards<br />aGerman</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6475" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile6475">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content6475">

						<h3 ><a href="#p6475">Re: BatchLibrary or how to include batch files</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinge470.html?mode=quote&amp;f=3&amp;p=6475" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic6e2d-2.html?p=6475#p6475" onclick="prompt('Message #3',this.href); return false;">#3</a></span> 
									<a class="unread" href="viewtopic6e2d-2.html?p=6475#p6475" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>15 Feb 2011 22:53
			</p>
			
			
			
			<div class="content">Cool (and scary) looking stuff, though I'm wondering if I have a simpler solution.<br /><br /><blockquote class="uncited"><div>this site shows many functions and they all can build a useful library, <br />but it's always annoying that I have to copy &amp; paste them into my code.</div></blockquote><br /><br />I was surprised by the statement above in bold. When I first discovered this amazing site last year, I assumed people had already developed a mechanism to call the routines in the library from other bat files, without the need for copying. I didn't see anything posted on how to do this, but the solution seemed obvious: the library would itself be a callable bat file, and the 1st parameter passed would be expected to be the name of the function to call. The library would call the desired function, passing along any additional arguments, and then exit.<br /><br />Trivial example:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />:: filename = DOSLIB.BAT<br />call :%*<br />exit /b<br /><br />:f1<br />echo:<br />echo called f1<br />echo arg1=%1<br />echo arg2=%2<br />exit /b<br /><br />:f2<br />echo:<br />echo called f2<br />echo arg1=%1<br />echo arg2=%2<br />exit /b<br /><br />:f3<br />echo:<br />echo called f3<br />echo arg1=%1<br />echo arg2=%2<br />exit /b<br /></code></pre></div><br /><br />Trivial example of using the library:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />:: filename = TEST.BAT<br />call doslib f1 abc xyz<br />call doslib f3 1<br /></code></pre></div></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6476" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile6476">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content6476">

						<h3 ><a href="#p6476">Re: BatchLibrary or how to include batch files</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting1da4.html?mode=quote&amp;f=3&amp;p=6476" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic23ee-2.html?p=6476#p6476" onclick="prompt('Message #4',this.href); return false;">#4</a></span> 
									<a class="unread" href="viewtopic23ee-2.html?p=6476#p6476" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>15 Feb 2011 23:13
			</p>
			
			
			
			<div class="content">Arrg! <img class="smilies" src="images/smilies/icon_mad.gif" alt=":x" title="Mad" />  <img class="smilies" src="images/smilies/icon_redface.gif" alt=":oops:" title="Embarassed" />  I hit submit when I meant to hit preview.<br /><br />To continue - I'm sure I've seen the technique in my previous post described elsewhere, but when I look throughout this site now I realize I don't see any mention of it here.<br /><br />It seems this is much simpler and cleaner than trying to implement an include solution (clever though it may be)<br /><br />Is there some inherent disadvantage with the technique I describe?<br /><br />The code I've given is just a start with much room for improvement. I've got a functioning callable library of 30+ functions that is an extension of this basic idea. I'll try to post it tomorrow.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6477" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile6477">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist7125.html?mode=viewprofile&amp;u=417" class="username">jeb</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search73f1.html?author_id=417&amp;sr=posts">880</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 30 Aug 2007 08:05</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany, Bochum</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content6477">

						<h3 ><a href="#p6477">Re: BatchLibrary or how to include batch files</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting00dd.html?mode=quote&amp;f=3&amp;p=6477" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic6426.html?p=6477#p6477" onclick="prompt('Message #5',this.href); return false;">#5</a></span> 
									<a class="unread" href="viewtopic6426.html?p=6477#p6477" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist7125.html?mode=viewprofile&amp;u=417" class="username">jeb</a></strong> &raquo; </span>16 Feb 2011 14:00
			</p>
			
			
			
			<div class="content">Hi dbenham,<br /><br />you are right.<br /><br />call :%* is one solution, and in many cases it is a good choice.<br /><br />But in my post, I forgot to explain why I decide to write a complex batch include mechanism, instead of using one of the simpler approaches.<br /><br />First, the copy &amp; past solution is not &quot;smart&quot; enough, you have in all batch files a copy of your library, <br />and after a time in nearly all batch files are other versions of the &quot;library&quot;.<br /><br />The calling-batch solution like yours have some disadvantages.<br />- Each single library call is slow<br />- You can not integrate secure parameter and drag&amp;drop handling in an external batch library<br />- You can not build a GetCurrentLine or a StackDump function with an external batch<br />- Each parameter is expanded two times by each call doslib :function, this could be tricky in escape/special character situations<br /><br />The <span class="posthilit">BatchLib</span>-Include solution, I posted have also disadvantages<br />- The start is slower (~50-200ms)<br />- It creates always a temporary file, this could be a problem in a read only situation (can be solved with %temp%)<br />- For a beginner, it is not possible to understand how it works. <br />  Or who can explain, why this is a legal statement and what it is good for?<br /><span style="color: #FF8000">&lt;:%BL.Start% </span><br /><br /><br />I want to explain, what I mean with <br /><strong class="text-strong">secure parameter: </strong>Retrieve %1 even if it contains &quot;&amp;&quot;&amp;&quot;&amp;&quot;<br /><strong class="text-strong">secure drag&amp;drop: </strong>Should work even if you got filenames like Adam&amp;Eve.txt<br /><strong class="text-strong">GetCurrentLine: </strong>It should be possible to write <strong class="text-strong">call :GetCurrentLine LineNr</strong> and retrieve in lineNr the current line number.<br /><strong class="text-strong">StackDump: </strong>It should be possible to <strong class="text-strong">call :StackDump</strong> and get the calling tree like<br />:mainFunc, line 7<br />+  :chessGame, line 50<br />++   :drawBoard, near line 450 (block command)<br />+++       :drawField, line 1034<br />++++         :arrayError, line 1039<br />+++++           :StackDump is started here<br /><br />jeb</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6481" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile6481">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search661c.html?author_id=1265&amp;sr=posts">3386</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 22 Jan 2010 18:01</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content6481">

						<h3 ><a href="#p6481">Re: BatchLibrary or how to include batch files</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting24c8.html?mode=quote&amp;f=3&amp;p=6481" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic1ed7.html?p=6481#p6481" onclick="prompt('Message #6',this.href); return false;">#6</a></span> 
									<a class="unread" href="viewtopic1ed7.html?p=6481#p6481" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a></strong> &raquo; </span>16 Feb 2011 14:40
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>jeb wrote:</cite>  Or who can explain, why this is a legal statement and what it is good for?<br /><span style="color: #FF8000">&lt;:%BL.Start% </span></div></blockquote><br /><br />Hi jeb.<br /><br />When I saw this line I thought to myself &quot;another cool trick of jeb&quot;. But, to be honest, I have no idea how it works and I had no time to figure out yet.<br /><br />Regards<br />aGerman</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6482" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile6482">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist7125.html?mode=viewprofile&amp;u=417" class="username">jeb</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search73f1.html?author_id=417&amp;sr=posts">880</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 30 Aug 2007 08:05</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany, Bochum</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content6482">

						<h3 ><a href="#p6482">Re: BatchLibrary or how to include batch files</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting1e8a.html?mode=quote&amp;f=3&amp;p=6482" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicb95b-2.html?p=6482#p6482" onclick="prompt('Message #7',this.href); return false;">#7</a></span> 
									<a class="unread" href="viewtopicb95b-2.html?p=6482#p6482" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist7125.html?mode=viewprofile&amp;u=417" class="username">jeb</a></strong> &raquo; </span>17 Feb 2011 02:55
			</p>
			
			
			
			<div class="content">I will try to explain it.<br /><br />(btw: I wrote a long explanation at administrator.de, <br /> but I need too much time, <br /> so I'm not logged in any more and the text is lost .. lost ... LOST, what a @*!#)<br /><br /><span style="color: #00BF00">:label</span>   is a label<br /><span style="color: #00BF00">&lt;nul echo x</span> is a cmd, nul is redirected to stdin<br /><br /><span style="color: #00BF00">&lt;: &lt;nul echo x</span> is the same cmd, nul is redirected to stdin<br />Why? Because, there can always only one redirection to one stream.<br /><br />The rule is, scan the line and take only the last redirection for a stream.<br /><span style="color: #00BF00">&lt;file1 &lt;file2 echo&lt;file3 x &lt;nul</span> is the same as <span style="color: #00BF00">&lt;nul echo x</span><br /><br />Assume the content of BL.Start is &quot;&lt;nul echo hello&quot;<br /><span style="color: #00BF00">&lt;:%BL.Start%</span><br />expands to<br /><span style="color: #00BF00">&lt;:&lt;nul echo hello</span><br /><br />A legal command, but why so complicated?<br />Because:<br /><span style="color: #00BF00">:label</span>   is a label, named label<br /><span style="color: #00BF00">:%label%</span>   is a label, named %label%, while searching for a label, it will not expanded<br /><span style="color: #00BF00">*:label</span>   is a label, named label<br /><span style="color: #00BF00">&lt;==,==;=;   = :label</span>   is a label, named label<br /><br />The rule for a label is:<br />Null or one character(any, but colon), followed by any delims of &lt;space&gt;,;= <br />and after the colon: the name of the label is required.<br />The name itself ends at the line end or at a label delim like +&lt;&gt;&amp;|space<br /><br />As a result the <span style="color: #00BF00">&lt;:%BL.Start%</span> <span style="color: #FF8000">is a command and also a legal label.</span><br /><br />So this line can call itself<br /><span style="color: #00BF00">&lt;:label &lt;nul echo 1 &amp; call :label</span><br /><br />But, it isn't an infinite loop, <br />as a call or goto label search the label and the rest of the line will be ignored,<br />the next line will be executed.<br /><br />Now it should be obvious what <span style="color: #00BF00">&lt;:%BL.Start%</span> is good for.<br />First the %Bl.Start% expands to something like<br />&lt;nul GetAllParameter &amp; start the batchlibrary with /INTERN and my own filename (%0)<br /><br />The batchlibrary creates a new temporary batch file<br />The first line contains<br /><span style="color: #00BF00">@echo off &amp; goto :%%BL.Start%% &amp; rem &lt;the rest of the original file&gt;</span><br />Then the original file and the <span class="posthilit">batchLib</span> are appended.<br />And at last the temporary file is started.<br />And now the goto :%%BL.Start%% will continue the program execution direct after the mysterious <span style="color: #00BF00">&lt;:%BL.Start%</span>.<br /><br />That's all<br /><br /><br />jeb</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6483" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile6483">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search661c.html?author_id=1265&amp;sr=posts">3386</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 22 Jan 2010 18:01</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content6483">

						<h3 ><a href="#p6483">Re: BatchLibrary or how to include batch files</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting2751.html?mode=quote&amp;f=3&amp;p=6483" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic3983.html?p=6483#p6483" onclick="prompt('Message #8',this.href); return false;">#8</a></span> 
									<a class="unread" href="viewtopic3983.html?p=6483#p6483" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a></strong> &raquo; </span>17 Feb 2011 11:50
			</p>
			
			
			
			<div class="content">Wow! Thanks for the good explanation, jeb. Now I understood how it works. It's always very interesting for me to read your posts <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /> New methods again and again. Thumbs up!<br /><br /><blockquote><div><cite>jeb wrote:</cite>(btw: I wrote a long explanation at administrator.de, <br /> but I need too much time, <br /> so I'm not logged in any more and the text is lost .. lost ... LOST, what a @*!#)<br /></div></blockquote><br />Bother <img class="smilies" src="images/smilies/icon_sad.gif" alt=":(" title="Sad" /> <br />First I write long posts in my text editor, since it happened to me as well.<br /><br />Regards<br />aGerman</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6484" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile6484">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content6484">

						<h3 ><a href="#p6484">Re: BatchLibrary or how to include batch files</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting22a2.html?mode=quote&amp;f=3&amp;p=6484" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic75a5.html?p=6484#p6484" onclick="prompt('Message #9',this.href); return false;">#9</a></span> 
									<a class="unread" href="viewtopic75a5.html?p=6484#p6484" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>18 Feb 2011 00:57
			</p>
			
			
			
			<div class="content">Hi Jeb<br /><br />Thanks for your response<br /><br />Wow! so many things to talk about. I wanted to respond earlier, but for some reason my account was temporarily deactivated yesterday.<br /><br />-------<br />&lt;:%BL.Start% - Very interesting, with good explanation. I'll file that trick away in my head - maybe it will come in useful someday.<br /><br />To make sure I understand, the arcane behaviour is not necessary for the overall include process, correct? You could simply have<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>call <span class="posthilit">BatchLib</span>.bat<br />%BL.Start%<br />:ResumeHere<br /></code></pre></div><br />And top line of temp bat file would goto :ResumeHere instead of :%BL.Start%.<br />This would be less obfuscated, at the expense of requiring an extra line of code at the top of each file that needs the library.<br /><br />Did you consider appending only the portion of the original bat that appears afer %BL.Start%? Then you would not need any label at all. Better yet you could disable the initial lines through %BL.Start% by prefixing with &quot;: &quot; (no quotes), or REM, thus preserving the line numbers if you wanted.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />setlocal DisableDelayedExpansion<br />set resume=<br />for /f &quot;delims=&quot; %%a in (%~f2) do (<br />&nbsp; if defined resume (&gt;&gt;%~n2.tmp echo %%a ) else (<br />&nbsp; &nbsp; &gt;&gt;%~n2.tmp echo:: %%a<br />&nbsp; &nbsp; if /i .%%a==.%%BL.Start%% set resume=true<br />&nbsp; )<br />)<br /></code></pre></div><br />I suppose the for loop is slower than type, so it might delay startup a bit more. Your drag&amp;drop scenario rears its head here as well (can't enclose the filename in quotes). You could get around this by preprocessing the filename to escape the &amp;, yes?<br /><br />------<br />I see that you parse the arguments originally passed to the initial bat file into an array. But I don't see where you pass those args to the temp bat. Are you relying on the original bat file to reference the parameters in your environment array? I guess this works because the setlocal is in effect throughout the temp bat call, but this seems awkward.<br /><br />This leads to two additional concerns I have with the code as written.<br /><br />1) The initialization of the library is not a black box - the initiating bat file will see your manipulation of the environment. This seems to violate one of principals of a well constructed function library.<br /><br />2) The initiating bat file loses the ability to preserve its environment changes upon exit. This limitation is the biggest concern for me.<br /><br />I see 3 possible remedies, but none of them are perfect:<br /><br />option 1) endlocal before the call to the bat file, don't delete the temp file: environment and errorlevel are preserved, but the temp file remains (yuck)<br /><br />option 2) endlocal before call and delete file within your &quot;cache&quot;: environment preserved but returning errorlevel is lost.<br /><br />option 3) endlocal before call, don't &quot;cache&quot; the delete sequence that pereserves the errorlevel: I'm not sure exactly what the repurcusion is here. I gather from your explanation that a poorly behaved bat file might not exit the library cleanly?<br /><br />------------<br />With regard to my original suggestion, and your original response:<br /><br /><blockquote class="uncited"><div>- Each single library call is slow<br /></div></blockquote><br />Yea, I did some timings comparing external calls to the library vs making the same calls within the library. (I used a for loop for testing) In all tests the loop with the external calls took about 2.8 times longer, regardless of the simplicity or complexity of the routine being called. This surprised me a bit. I thought there would be a constant overhead for each external call, but the routine within the library would behave the same once it had been called. Maybe my testing was flawed. Either way, the performance penalty is acceptable to me in most circumstances. If performance really became an issue I would then go ahead and copy the routine into my batch.<br /><br /><blockquote class="uncited"><div>- Each parameter is expanded two times by each call doslib :function, this could be tricky in escape/special character situations<br /></div></blockquote><br />Yes I'm aware of this, hence my statement that there is much room for improvement. My &quot;finished&quot;library doesn't simply use call :*, it actually parses the arguments to address this issue.<br /><br /><blockquote class="uncited"><div>- You can not build a GetCurrentLine or a StackDump function with an external batch<br /></div></blockquote><br />Can you provide some code (or links) showing how you do this (in general, not with the callable library)? I'm very interested. I can envision how you might build a stack in an environment variable and parse it as needed for easy display, but the solution in my head requires explicit stack building code at each call entry. I haven't a clue how you get line numbers.<br /><br />I'm not sure what good line numbers do for your include solution, because they do not match the original sources. I suppose you could disable the temp file deletion during debugging sessions.<br /><br /><blockquote class="uncited"><div>- You can not integrate secure parameter and drag&amp;drop handling in an external batch library<br /></div></blockquote><br />I have some understanding of the issues you are referring to, but not the depth that I think you have. Can you provide some code (or links) that demonstrate some secure parameter and drag&amp;drop pitfalls and some general strategies on how people deal with them.<br /><br />-------------<br />One major advantage of the callable library is it can be used directly within an interactive session.  The calls do not need to be embedded in a bat file.<br /><br />In theory it seems possible to have one library that is callable as I suggest, but also has routines like yours to implement the include feature.<br /><br /><br />Dbenham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6485" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile6485">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist7125.html?mode=viewprofile&amp;u=417" class="username">jeb</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search73f1.html?author_id=417&amp;sr=posts">880</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 30 Aug 2007 08:05</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany, Bochum</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content6485">

						<h3 ><a href="#p6485">Re: BatchLibrary or how to include batch files</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting6c92.html?mode=quote&amp;f=3&amp;p=6485" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic91f2.html?p=6485#p6485" onclick="prompt('Message #10',this.href); return false;">#10</a></span> 
									<a class="unread" href="viewtopic91f2.html?p=6485#p6485" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist7125.html?mode=viewprofile&amp;u=417" class="username">jeb</a></strong> &raquo; </span>18 Feb 2011 04:34
			</p>
			
			
			
			<div class="content">Hi dbenham,<br /><br /><blockquote class="uncited"><div>To make sure I understand, the arcane behaviour is not necessary for the overall include process, correct? call <span class="posthilit">BatchLib</span>.bat<br />%BL.Start%<br />:ResumeHere<br /><br />And top line of temp bat file would goto :ResumeHere instead of :%BL.Start%.<br />This would be less obfuscated, at the expense of requiring an extra line of code at the top of each file that needs the library.<br /></div></blockquote><br />Yes. But I want to beware the user of adding manual the correct goto's and label's.<br /><br /><blockquote class="uncited"><div>Did you consider appending only the portion of the original bat that appears afer %BL.Start%? Then you would not need any label at all. Better yet you could disable the initial lines through %BL.Start% by prefixing with &quot;: &quot; (no quotes), or REM, thus preserving the line numbers if you wanted.</div></blockquote><br />But the library start could be at the end of a batch file, triggered with an goto :startLib, so I suppose it isn't a good idea.<br /><br /><blockquote class="uncited"><div>I see that you parse the arguments originally passed to the initial bat file into an array. But I don't see where you pass those args to the temp bat. Are you relying on the original bat file to reference the parameters in your environment array? I guess this works because the setlocal is in effect throughout the temp bat call, but this seems awkward.<br />This leads to two additional concerns I have with the code as written.<br /><br />1) The initialization of the library is not a black box - the initiating bat file will see your manipulation of the environment. This seems to violate one of principals of a well constructed function library.<br /><br />2) The initiating bat file loses the ability to preserve its environment changes upon exit. This limitation is the biggest concern for me.</div></blockquote><br />Also: Yes. It isn't a good way at this point, to pass the arguments by &quot;global&quot; variables.<br /><br />As a solution I will build something like<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>set param_all=%* ' A bit smarter, only for the explanation<br />( call :<span class="posthilit">batchLib</span> /internalstart&nbsp; ' Setlocal is active here, for the pass of param_all<br />&nbsp;delete TempBat.bat<br />)<br /><br />-- <span class="posthilit">batchlib</span>.bat<br />... prepare all<br />convert param_all to a secure variant, to use it for the passing to myBatch.tmp.bat<br />set &quot;param_all=!param_all:%%=%%%%!&quot;<br />set &quot;param_all=!param_all:^=^^!&quot;<br />set &quot;param_all=!param_all:&amp;=^&amp;!&quot;<br />set &quot;param_all=!param_all:|=^|!&quot;<br />set &quot;param_all=!param_all:&lt;=^&lt;!&quot;<br />set &quot;param_all=!param_all:&gt;=^&gt;!&quot;<br />set &quot;param_all=!param_all:&quot;&quot;=^&quot;!&quot;<br />(<br />endlocal<br />%tempBat.bat% %Param_all%<br />)<br /></code></pre></div><br /><br /><blockquote class="uncited"><div>option 3) endlocal before call, don't &quot;cache&quot; the delete sequence that pereserves the errorlevel: I'm not sure exactly what the repurcusion is here. I gather from your explanation that a poorly behaved bat file might not exit the library cleanly?</div></blockquote><br /><br />If your batch file halt with a syntax error (try this as command <span style="color: #FF0000">&gt;()</span>  ) you can not handle anything, or you have to start the temp-batch always with start /b /wait cmd /c ...<br /><br /><blockquote class="uncited"><div>Quote:<br />- You can not integrate secure parameter and drag&amp;drop handling in an external batch library<br /><br />I have some understanding of the issues you are referring to, but not the depth that I think you have. Can you provide some code (or links) that demonstrate some secure parameter and drag&amp;drop pitfalls and some general strategies on how people deal with them.<br /></div></blockquote><br /><br />For drag&amp;drop you got problems, if a file is named &quot;Test&amp;Echo.bat&quot;, windows is not smart enough to enclose it with quotes, <br />so you get a cmd line like<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>cmd /c &quot;&quot;C:\temp\test.bat&quot; C:\temp\test&amp;echo.bat&quot;</code></pre></div><br />But this is interpreted as to seperated command:<br />&quot;C:\temp\test.bat&quot; C:\temp\text<br />And <br />echo.bat<br /><br />Therefore in %* is only &quot;C:\temp\text&quot;, the only  way to access the real parameters is the !cmdcmdline! variable<br />and to hard exit the batch, so the echo.bat can't be executed.<br /><br />Secure parameters: Try to access the parameter of the line<br />myBatch.bat &quot;&amp;&quot;^&amp;<br />This is impossible with normal ways, like<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>set var=%1<br />set &quot;var=%1&quot;<br />set var=%~1<br />set &quot;var=%~1&quot;</code></pre></div><br />None will work.<br /><br />I found a trick with redirection the **echo on** output.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />set prompt=#<br />for %%a in (1) do (<br />&nbsp; echo on<br />&nbsp; for %%b in (2) do rem ## %*<br />) &gt; temp<br />@echo off<br />prompt<br />echo ---<br />type temp<br /></code></pre></div><br /><br /><blockquote class="uncited"><div>Can you provide some code (or links) showing how you do this (in general, not with the callable library)? <br />I'm very interested. I can envision how you might build a stack in an environment variable and parse it as needed for easy display, <br />but the solution in my head requires explicit stack building code at each call entry. <br />I haven't a clue how you get line numbers.<br /><br />I'm not sure what good line numbers do for your include solution, because they do not match the original sources. <br /></div></blockquote><br /><br />I'm care of the correct line numbers in the temporary file, as I only add a goto :%%Bl.start%% &amp; rem &lt;original code&gt; at the first line<br /><br />But how to access stackdump or line numbers? It's nearly the same solution.<br />The first key is to access the current function name by %0.<br />To get control over the file you have to use the self modification feature of batch-files.<br />So you are able to recover the line numbers of each call :fn<br /><br />And to get the line number you only have to build your &quot;modified&quot; batch in a way to get the correct one<br />simplified<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>set L=1 &amp; goto :getIt<br />set L=2 &amp; goto :getIt<br />set L=3 &amp; goto :getIt<br />set L=4 &amp; goto :getIt<br />set L=5 &amp; goto :getIt<br /><br />:getIt<br />echo The function %0 has call something at line number %L%<br />goto :eof<br /></code></pre></div><br /><br />Ok, it's not so easy, but this is the concept.<br /><br />hope it helps<br />jeb</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6489" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile6489">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content6489">

						<h3 ><a href="#p6489">Re: BatchLibrary or how to include batch files</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingdcb5.html?mode=quote&amp;f=3&amp;p=6489" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicb211-2.html?p=6489#p6489" onclick="prompt('Message #11',this.href); return false;">#11</a></span> 
									<a class="unread" href="viewtopicb211-2.html?p=6489#p6489" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>20 Feb 2011 03:20
			</p>
			
			
			
			<div class="content">Thanks for your excellent response Jeb. Both your code and explanations are very instructive.<br /><br /><blockquote class="uncited"><div>But the library start could be at the end of a batch file, triggered with an goto :startLib</div></blockquote><br />Ouch! I never considered anyone would put the include anywhere other than the top. Can you think of a reason why this would ever be necessary? This leaves open the possibility of someone calling the :startLib multiple times, with the potential for an endless loop! I suppose you could protect against it, but it doesn't seem like a bad &quot;rule&quot; to say the master include belongs at the top prior to any labels.<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>convert param_all to a secure variant, to use it for the passing to myBatch.tmp.bat<br />set &quot;param_all=!param_all:%%=%%%%!&quot;<br />set &quot;param_all=!param_all:^=^^!&quot;<br />etc.<br /></code></pre></div><br />Referring to your code above, Since this is not production code, I'm assuming the above will be enhanced to deal with the potential for quotes within the string - no escape within quotes, yes escape outside of quotes?<br /><br /><br />I'm still a bit confused about your term &quot;drag&amp;drop&quot;. Does this refer to a windows operation that results in a call like your example below?<br />[code]cmd /c &quot;&quot;C:\temp\test.bat&quot; C:\temp\test&amp;echo.bat&quot;[code]<br />I understand why the above fails. I'm still trying to understand what would lead to a call like above.<br /><br /><br />Secure Parameter Solution - Way Cool! I haven't a clue how it works, but I think this is the missing piece that will finally allow my library to handle any string of printable characters. I've done some prototyping and it's looking good. Thanks!<br /><br /><br /><blockquote class="uncited"><div>I'm (taking) care of the correct line numbers in the temporary file, as I only add a goto :%%Bl.start%% &amp; rem &lt;original code&gt; at the first line</div></blockquote><br />Wow, I saw the code comment on my 1st read through and didn't understand it. 2nd pass I missed the comment and saw you were typing the entire bat file, so I assumed you couldn't possibly be preserving line numbers. I now understand how you supress the new line on your initial temp file creation. Another clever trick.<br /><br />My original comment though was more to do with the line numbers for the library routines. I don't supppose there is much you can do about those?<br /><br /><br />Stack and line number diagnostics - No it doesn't look to be easy. It seems like you would have to parse and identify blocks of code between ( ). That seems like that could be very tricky. I imagine there are other difficulties. Do you have any functioning code you can share? If not, I'll probably stick with my existing embedded debug code.<br /><br /><br />A few other comments: Given your attention to detail, I'm sure you've already thought of these points, but they probably are good to have with this thread:<br /><br />1) I assume you will enhance your code to eliminate the potential for temp file collision in parallel situations (multiple sessions on the same machine, or multiple users sharing a network drive)<br /><br />2) Do you plan on preventing multiple loads of the same library? This is especially possible since a library could load another library as part of its initialization routine.<br /><br />3) Libraries could be developed and shared by many people. I see you are very careful with your label names, but I'm not sure everyone would be so careful. I think people are familiar with the necessity for unique labels within a file, but I'm not sure they would automatically think to ensure uniqueness accross libraries. I like your naming convention with the library name at the front.<br /><br />Finally - Your excellent work has given me a related idea. Perhaps you've already considered this:<br /><br />Instead of dynamically building the &quot;linked&quot; bat file at run time as a temporary file, why not replace the original prior to running? The master bat file could simply have commented lines with include directives. It would not initiate a call to load the libraries. Instead, an external BATLINK.BAT file could be called to parse the file, create a temp file with all of the necessary libraries appended, and then replace the original.<br /><br />The final &quot;linked&quot; file would preserve the include directives. You would need a marker line at the bottom of the master saying &quot;DO NOT MODIFY BELOW THIS LINE&quot; etc. I suppose you would want a similar area at the top to insert calls to library initiation routines.<br /><br />Any time you wanted to refresh the file with updated libraries, you could simply relink it. The &quot;linker&quot; just needs to be smart enough to strip out the previously appended libraries from the bottom and the initialization calls from the top before proceeding. The &quot;linker&quot; could be logically recursive, with each library possibly including other libraries, and library markers could be used to prevent multiple loads of the same library.<br /><br />This would mimimize the initial startup time.<br /><br />This obviously would lose the ability to automatically take advantage of updates to libraries, but that could be a blessing. A library could be enhanced in a non-backward compatible fashion without necessarily breaking an already existing linked bat file. And it would be very easy to relink whenever you wanted.<br /><br />You've given me a lot to chew on. Thanks for all your work Jeb<br /><br />DBenham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6800" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile6800">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist7125.html?mode=viewprofile&amp;u=417" class="username">jeb</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search73f1.html?author_id=417&amp;sr=posts">880</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 30 Aug 2007 08:05</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany, Bochum</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content6800">

						<h3 ><a href="#p6800">Re: BatchLibrary or how to include batch files</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingc02c-3.html?mode=quote&amp;f=3&amp;p=6800" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicb5ec.html?p=6800#p6800" onclick="prompt('Message #12',this.href); return false;">#12</a></span> 
									<a class="unread" href="viewtopicb5ec.html?p=6800#p6800" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist7125.html?mode=viewprofile&amp;u=417" class="username">jeb</a></strong> &raquo; </span>31 Mar 2011 04:26
			</p>
			
			
			
			<div class="content">Sometimes I'm fast, sometimes not ...  <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /> <br /><br /><blockquote class="uncited"><div>Code:<br />convert param_all to a secure variant, to use it for the passing to myBatch.tmp.bat<br />set &quot;param_all=!param_all:%%=%%%%!&quot;<br />set &quot;param_all=!param_all:^=^^!&quot;<br />etc.<br /><br />Referring to your code above, Since this is not production code, I'm assuming the above will be enhanced to deal with the potential for quotes within the string - no escape within quotes, yes escape outside of quotes?<br />...<br />Secure Parameter Solution - Way Cool! I haven't a clue how it works, but I think this is the missing piece that will finally allow my library to handle any string of printable characters. I've done some prototyping and it's looking good. Thanks!<br /></div></blockquote><br />As it's possible but very tricky to escape only outside of the quotes, I decide to quote all even the quotes, so there is no &quot;inside&quot; quotes anymore.<br />To catch the parameter I use my REM/Prompt technic<br /><br />Sample:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>myTest.bat &quot;THIS&amp;&quot;is^&amp;&quot;A&amp;&quot;^^quote&quot;MONSTER&lt;&gt;|&quot;^&lt;^&gt;^|<br /><br />The parameter %1 itself contains then<br />%1=&quot;THIS&amp;&quot;is&amp;&quot;A&amp;&quot;^quote&quot;MONSTER&lt;&gt;|&quot;&lt;&gt;|<br /><br />the library catch the parameter with the REM technic and escape it to<br />^&quot;THIS^&amp;^&quot;is^&amp;^&quot;A^&amp;^&quot;^^quote^&quot;MONSTER^&lt;^&gt;^|^&quot;^&lt;^&gt;^|<br /></code></pre></div><br /><br />The secure escape mechanism is here<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>rem ** Escaping a string to a &quot;secure&quot; variant<br />set &quot;var=%var:&quot;=&quot;&quot;%&quot;<br />set &quot;var=%var:^=^^%&quot;<br />set &quot;var=%var:&amp;=^&amp;%&quot;<br />set &quot;var=%var:|=^|%&quot;<br />set &quot;var=%var:&lt;=^&lt;%&quot;<br />set &quot;var=%var:&gt;=^&gt;%&quot;<br /><br />test2.bat %var:&quot;&quot;=^&quot;%<br /></code></pre></div><br /><br />The REM/Prompt technic, to access even the strongest parameter like &quot;&amp;&quot;^&amp;<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />SETLOCAL DisableDelayedExpansion<br /><br />SETLOCAL<br />for %%a in (1) do (<br />&nbsp; &nbsp; set &quot;prompt=&quot;<br />&nbsp; &nbsp; echo on<br />&nbsp; &nbsp; for %%b in (1) do rem * #%1#<br />&nbsp; &nbsp; @echo off<br />) &gt; param.txt<br />ENDLOCAL<br /><br />for /F &quot;delims=&quot; %%L in (param.txt) do (<br />&nbsp; set &quot;param1=%%L&quot;<br />)<br />SETLOCAL EnableDelayedExpansion<br />set &quot;param1=!param1:*#=!&quot;<br />set &quot;param1=!param1:~0,-2!&quot;<br />echo %%1 is '!param1!'<br /></code></pre></div><br /><br /><blockquote class="uncited"><div>I'm still a bit confused about your term &quot;drag&amp;drop&quot;. Does this refer to a windows operation that results in a call like your example below?<br />[code]cmd /c &quot;&quot;C:\temp\test.bat&quot; C:\temp\test&amp;echo.bat&quot;[code]<br />I understand why the above fails. I'm still trying to understand what would lead to a call like above.<br /></div></blockquote><br /><br />It's drag &amp; drop from the explorer to a batch file.<br />You can select one or more files in the explorer and drop them over a batch file.<br /><br /><br /><blockquote class="uncited"><div>Stack and line number diagnostics - No it doesn't look to be easy. It seems like you would have to parse and identify blocks of code between ( ). That seems like that could be very tricky. I imagine there are other difficulties. Do you have any functioning code you can share? If not, I'll probably stick with my existing embedded debug code.<br /></div></blockquote><br />You are right, it seems to be impossible to get the line number of block-calls, therefore I simply ignore this!<br />I only try to catch line numbers outside of blocks.<br /><br /><blockquote class="uncited"><div>A few other comments: Given your attention to detail, I'm sure you've already thought of these points, but they probably are good to have with this thread:<br /><br />1) I assume you will enhance your code to eliminate the potential for temp file collision in parallel situations (multiple sessions on the same machine, or multiple users sharing a network drive)<br /><br />2) Do you plan on preventing multiple loads of the same library? This is especially possible since a library could load another library as part of its initialization routine.<br /><br />3) Libraries could be developed and shared by many people. I see you are very careful with your label names, but I'm not sure everyone would be so careful. I think people are familiar with the necessity for unique labels within a file, but I'm not sure they would automatically think to ensure uniqueness accross libraries. I like your naming convention with the library name at the front.<br /></div></blockquote><br />1) The problem of multiple temp-file collisions, I want to solve with adding a (random) PID to the temp-filename.<br />2) Multiple library loads I want to prevent by a library load flag for each library<br />3) The naming convention with &quot;namespaces&quot; is useful to prevent collisions, but I think about a mechanism to use a &quot;namespace&quot; by adding wrapper labels, so you can use library functions without the prefix.<br />But then it's on your own responsibility to ensure that a function/label is unique.<br /><br /><br /><blockquote class="uncited"><div>Instead of dynamically building the &quot;linked&quot; bat file at run time as a temporary file, why not replace the original prior to running? The master bat file could simply have commented lines with include directives. It would not initiate a call to load the libraries. Instead, an external BATLINK.BAT file could be called to parse the file, create a temp file with all of the necessary libraries appended, and then replace the original.<br /><br />The final &quot;linked&quot; file would preserve the include directives. You would need a marker line at the bottom of the master saying &quot;DO NOT MODIFY BELOW THIS LINE&quot; etc. I suppose you would want a similar area at the top to insert calls to library initiation routines.<br /><br />Any time you wanted to refresh the file with updated libraries, you could simply relink it. The &quot;linker&quot; just needs to be smart enough to strip out the previously appended libraries from the bottom and the initialization calls from the top before proceeding. The &quot;linker&quot; could be logically recursive, with each library possibly including other libraries, and library markers could be used to prevent multiple loads of the same library.<br /><br />This would mimimize the initial startup time.<br /><br />This obviously would lose the ability to automatically take advantage of updates to libraries, but that could be a blessing. A library could be enhanced in a non-backward compatible fashion without necessarily breaking an already existing linked bat file. And it would be very easy to relink whenever you wanted.<br /></div></blockquote><br /><br />I think about this, but decide not to use it, as it changes the source files and I'm get trouble with repository systems, as they want to check them in.<br /><br />hope it helps<br />jeb</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6811" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile6811">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content6811">

						<h3 ><a href="#p6811">Re: BatchLibrary or how to include batch files</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingdc8a-2.html?mode=quote&amp;f=3&amp;p=6811" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopica6e0-2.html?p=6811#p6811" onclick="prompt('Message #13',this.href); return false;">#13</a></span> 
									<a class="unread" href="viewtopica6e0-2.html?p=6811#p6811" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>31 Mar 2011 17:04
			</p>
			
			
			
			<div class="content">Thanks Jeb<br /><br />Just 1 comment for a change<br /><br /><blockquote class="uncited"><div>You are right, it seems to be impossible to get the line number of block-calls, therefore I simply ignore this!<br />I only try to catch line numbers outside of blocks.<br /></div></blockquote><br />That's the parsing that boggles my mind!<br /><br /><ul><li>You have to recognize when it's possible to begin a block (the command context)</li><li>Even if a block context is possible, you have to ignore escaped and quoted parentheses.</li></ul><br />That seems plenty difficult just if you restrict yourself to what is in the code. But then add the possibility of blocks beginning or ending due to results of variable expansion... My head is now seriously pounding!<br /><br />Kudos to you if you've figured all this out. (Well kudos no matter what, but you know what I mean)<br /><br />Dave</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6852" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile6852">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist7125.html?mode=viewprofile&amp;u=417" class="username">jeb</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search73f1.html?author_id=417&amp;sr=posts">880</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 30 Aug 2007 08:05</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany, Bochum</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content6852">

						<h3 ><a href="#p6852">Re: BatchLibrary or how to include batch files</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting391e.html?mode=quote&amp;f=3&amp;p=6852" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicdb2a.html?p=6852#p6852" onclick="prompt('Message #14',this.href); return false;">#14</a></span> 
									<a class="unread" href="viewtopicdb2a.html?p=6852#p6852" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist7125.html?mode=viewprofile&amp;u=417" class="username">jeb</a></strong> &raquo; </span>04 Apr 2011 14:41
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>dbenham wrote:</cite>That's the parsing that boggles my mind!<br /><br />    * You have to recognize when it's possible to begin a block (the command context)<br />    * Even if a block context is possible, you have to ignore escaped and quoted parentheses.<br /><br /><br />That seems plenty difficult just if you restrict yourself to what is in the code. But then add the possibility of blocks beginning or ending due to results of variable expansion... My head is now seriously pounding!</div></blockquote><br />I suppose it is not possible to detect the correct line number even without to regards the variable expansion.<br />A simple block with to calls seems to be a <em class="text-italics">mission impossible</em> <img class="smilies" src="images/smilies/icon_cool.gif" alt="8)" title="Cool" /> .<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>(<br />call :func 1<br />call :func 1<br />)<br /></code></pre></div><br /><br /><blockquote><div><cite>dbenham wrote:</cite>Kudos to you if you've figured all this out. (Well kudos no matter what, but you know what I mean)</div></blockquote><br />Many thanks  <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" />  <br />The most of this stuff I figured out myself (I realize, I waste to much time..), but it was simply annoying that I can't find any exact answers to my questions.<br /><br />jeb</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p55460" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile55460">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist162c.html?mode=viewprofile&amp;u=9067" class="username">sdrawkcab</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search727f.html?author_id=9067&amp;sr=posts">1</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 24 Jan 2018 13:53</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content55460">

						<h3 ><a href="#p55460">Re: BatchLibrary or how to include batch files</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting7e60.html?mode=quote&amp;f=3&amp;p=55460" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic13ae-2.html?p=55460#p55460" onclick="prompt('Message #15',this.href); return false;">#15</a></span> 
									<a class="unread" href="viewtopic13ae-2.html?p=55460#p55460" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist162c.html?mode=viewprofile&amp;u=9067" class="username">sdrawkcab</a></strong> &raquo; </span>24 Jan 2018 14:00
			</p>
			
			
			
			<div class="content">Hi Jeb,<br>
<br>
Do you happen to have a copy of your batch script library that you're sharing publicly, such as on GitHub? I'd love to follow it and take advantage of the library you've written if you have it posted anywhere.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
	

	<div class="action-bar bar-bottom">
	
			<a href="posting234a.html?mode=reply&amp;f=3&amp;t=1626" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopicb1fc.html?f=3&amp;t=1626&amp;hilit=batchlib&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

			<form method="post" action="https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=1626">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			15 posts
							&bull; Page <strong>1</strong> of <strong>1</strong>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="viewforum4d6b.html?f=3" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to “DOS Batch Forum”</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="viewforum31e6.html?f=4" class="jumpbox-cat-link"> <span> DosTips - Dos Batch</span></a></li>
																<li><a href="viewforum4d6b.html?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; DOS Batch Forum</span></a></li>
											</ul>
		</div>
	</div>

	</div>


			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
							<span class="crumb"><a href="../index.html" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>DosTips.com</span></a></span>									<span class="crumb"><a href="index.html" data-navbar-reference="index"><span>Board index</span></a></span>					</li>
		
				<li class="rightside">All times are <span title="UTC-6">UTC-06:00</span></li>
							<li class="rightside">
				<a href="ucp033a.html?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete all board cookies</span>
				</a>
			</li>
												<li class="rightside" data-last-responsive="true">
				<a href="memberlist4bfd.html?mode=team" role="menuitem">
					<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
				</a>
			</li>
									<li class="rightside" data-last-responsive="true">
				<a href="memberlist8733.html?mode=contactadmin" role="menuitem">
					<i class="icon fa-envelope fa-fw" aria-hidden="true"></i><span>Contact us</span>
				</a>
			</li>
			</ul>

	</div>
</div>

	<div class="copyright">
				<!-- WARNING NO DELETE -->Style developer by <a href="http://tricolor.x-tk.ru/">support forum tricolor</a>, <!-- END WARNING NO DELETE -->Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
									</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	<img src="cron68e3.gif?cron_type=cron.task.text_reparser.pm_text" width="1" height="1" alt="cron" /></div>

<script type="text/javascript" src="assets/javascript/jquery.mind772.js?assets_version=34"></script>
<script type="text/javascript" src="assets/javascript/cored772.js?assets_version=34"></script>



<script type="text/javascript" src="styles/prosilver/template/forum_fnd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/prosilver/template/ajaxd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/jquery-uid772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/collapsed772.js?assets_version=34"></script>



</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=1626&hilit=batchlib by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 09:22:01 GMT -->
</html>
