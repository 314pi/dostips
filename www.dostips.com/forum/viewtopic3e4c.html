<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=6044&start=195 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 08:00:41 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>JREPL.BAT v7.14 - regex text processor now with Unicode and XRegExp support - Page 14 - DosTips.com</title>


	<link rel="canonical" href="viewtopiccb74.html?t=6044&amp;start=195">

<!--
	phpBB style name: Allan Style - SUBSILVER
	Based on style:   prosilver (this is the default phpBB3 style)
	Based on style:   subsilver2 (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:  Allan ( http://x-tk.ru/ )
-->

<link href="assets/css/font-awesome.mind772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/stylesheetd772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/en/stylesheetd772.css?assets_version=34" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="./styles/AllanStyle-SUBSILVER/theme/tweaks.css?assets_version=34" rel="stylesheet">
<![endif]-->




<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','../../www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-280191-1', 'auto');
	ga('send', 'pageview');
</script>

</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">

<div id="header-subsilver">
	<a id="top" class="top-anchor" accesskey="t"></a>
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description" class="site-description">
				<a id="logo" class="logo" href="../index.html" title="DosTips.com"><span class="site_logo"></span></a>
				<h1>DosTips.com</h1>
				<p>A Forum all about DOS Batch</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

									<div id="search-box" class="search-box search-header" role="search">
				<form action="https://www.dostips.com/forum/search.php" method="get" id="search">
				<fieldset>
					<input name="keywords" id="keywords" type="search" maxlength="128" title="Search for keywords" class="inputbox search tiny" size="20" value="" placeholder="Search…" />
					<button class="button button-search" type="submit" title="Search">
						<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
					</button>
					<a href="search.html" class="button button-search-end" title="Advanced search">
						<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
					</a>
					
				</fieldset>
				</form>
			</div>
						
			</div>
					</div>
</div>


<div id="wrap" class="wrap">
	<div id="page-header">
				<div class="navbar-top" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
																									<li>
								<a href="search33a7.html?search_id=unanswered" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="search526f.html?search_id=active_topics" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-blue" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="search.html" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
											<li class="separator"></li>
																			<li>
								<a href="memberlist4bfd.html?mode=team" role="menuitem">
									<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
								</a>
							</li>
																<li class="separator"></li>

									</ul>
			</div>
		</li>

				<li data-skip-responsive="true">
			<a href="app.php/help/faq.html" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
						
			<li class="rightside"  data-skip-responsive="true">
			<a href="ucp26c3.html?mode=login" title="Login" accesskey="x" role="menuitem">
				<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Login</span>
			</a>
		</li>
					<li class="rightside" data-skip-responsive="true">
				<a href="ucp8319.html?mode=register" role="menuitem">
					<i class="icon fa-pencil-square-o  fa-fw" aria-hidden="true"></i><span>Register</span>
				</a>
			</li>
						</ul>

	</div>
</div>

<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
						<li class="breadcrumbs">
							<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="../index.html" itemprop="url" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span itemprop="title">DosTips.com</span></a></span>
										<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="index.html" itemprop="url" accesskey="h" data-navbar-reference="index"><span itemprop="title">Board index</span></a></span>

											<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="4"><a href="viewforum31e6.html?f=4" itemprop="url"><span itemprop="title">DosTips - Dos Batch</span></a></span>
															<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="3"><a href="viewforum4d6b.html?f=3" itemprop="url"><span itemprop="title">DOS Batch Forum</span></a></span>
												</li>
		
					<li class="rightside responsive-search">
				<a href="search.html" title="View the advanced search options" role="menuitem">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</a>
			</li>
			</ul>

	</div>
</div>

<div class="navbar-top-link">
	<div class="inner">
		<ul>
			<li class="navbar-top-link-left"><a href="search33a7.html?search_id=unanswered">Unanswered topics</a></li>
			<li class="navbar-top-link-left"><a href="search526f.html?search_id=active_topics">Active topics</a></li>

											</ul>
	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
		
<h2 class="topic-title"><a href="viewtopic3e4c.html?f=3&amp;t=6044&amp;start=195">JREPL.BAT v7.14 - regex text processor now with Unicode and XRegExp support</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">Discussion forum for all Windows batch related topics.<br /></div>
<p>
	<strong>Moderator:</strong> <a href="memberlista6a8.html?mode=viewprofile&amp;u=5" class="username">DosItHelp</a>
</p>


<div class="action-bar bar-top">
	
			<a href="postingdfbb.html?mode=reply&amp;f=3&amp;t=6044" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic541c.html?f=3&amp;t=6044&amp;start=195&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="https://www.dostips.com/forum/search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topic…" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="search.html" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="6044" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			393 posts
							<ul>
	<li class="dropdown-container dropdown-button-control dropdown-page-jump page-jump">
		<a class="button button-icon-only dropdown-trigger" href="#" title="Click to jump to page…" role="button"><i class="icon fa-level-down fa-rotate-270" aria-hidden="true"></i><span class="sr-only">Page <strong>14</strong> of <strong>27</strong></span></a>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
				<li>Jump to page:</li>
				<li class="page-jump-form">
					<input type="number" name="page-number" min="1" max="999999" title="Enter the page number you wish to go to" class="inputbox tiny" data-per-page="15" data-base-url=".&#x2F;viewtopic.php&#x3F;f&#x3D;3&amp;amp&#x3B;t&#x3D;6044" data-start-name="start" />
					<input class="button2" value="Go" type="button" />
				</li>
			</ul>
		</div>
	</li>
			<li class="arrow previous"><a class="button button-icon-only" href="viewtopicaffe.html?f=3&amp;t=6044&amp;start=180" rel="prev" role="button"><i class="icon fa-chevron-left fa-fw" aria-hidden="true"></i><span class="sr-only">Previous</span></a></li>
				<li><a class="button" href="viewtopicb16d.html?f=3&amp;t=6044" role="button">1</a></li>
			<li class="ellipsis" role="separator"><span>…</span></li>
				<li><a class="button" href="viewtopic4107.html?f=3&amp;t=6044&amp;start=165" role="button">12</a></li>
				<li><a class="button" href="viewtopicaffe.html?f=3&amp;t=6044&amp;start=180" role="button">13</a></li>
			<li class="active"><span>14</span></li>
				<li><a class="button" href="viewtopic57db-2.html?f=3&amp;t=6044&amp;start=210" role="button">15</a></li>
				<li><a class="button" href="viewtopic2473.html?f=3&amp;t=6044&amp;start=225" role="button">16</a></li>
			<li class="ellipsis" role="separator"><span>…</span></li>
				<li><a class="button" href="viewtopic54c6.html?f=3&amp;t=6044&amp;start=390" role="button">27</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopic57db-2.html?f=3&amp;t=6044&amp;start=210" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
		</div>




<div id="subsilver-nav-topic">
	<div class="inner"><div class="post has-profile">
		<div class="leftsided postbody subsilver-topic-title">Message</div>
		<div class="leftsided postprofile subsilver-topic-author">Author</div>
	</div></div>
</div>

			<div id="p47489" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile47489">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf147.html?author_id=3221&amp;sr=posts">6033</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Feb 2012 02:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content47489">

						<h3 class="first"><a href="#p47489">Re: JREPL.BAT - regex text processor - successor to REPL.BAT</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting3792.html?mode=quote&amp;f=3&amp;p=47489" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic15e9.html?p=47489#p47489" onclick="prompt('Message #196',this.href); return false;">#196</a></span> 
									<a class="unread" href="viewtopic15e9.html?p=47489#p47489" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a></strong> &raquo; </span>01 Jul 2016 03:11
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>mirrormirror wrote:</cite>wondered if I might be able to use jRepl or FindRepl to take some bulk out of them.  <br /><br />1. One routine parses the output from &quot;ipconfig /all&quot; to get the &quot;DNS Servers&quot;. I guess there can be 1 or more, in this case there are three:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&nbsp; &nbsp;DNS Servers . . . . . . . . . . . : 192.168.0.1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;184.16.4.22<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;192.168.88.134<br /></code></pre></div><br /><br />2. I have a wordy routine that parses &quot;Local group Membership&quot; from the &quot;NET USER [User Name]&quot; command. The asterik * causes it to be more complex than I'd like. In the example below, I'd like to parse out all of the group names (those beginning with &quot;*test_&quot;)</div></blockquote><br /><br /><br />1.  There can be more than one set of DNS servers in ipconfig /all <br />such as belonging to other network items.  Are you aware of that?<br /><br />2.  I'm guessing that you edited those and *test_ doesn't appear in the actual data.  The characteristics of the text is a common way to filter those lines in batch code and the task isn't clear.<br /><br />EDIT:  There are always other ways to do part 2 but simple code is easier to read and debug into the future.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p47491" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile47491">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content47491">

						<h3 ><a href="#p47491">Re: JREPL.BAT - regex text processor - successor to REPL.BAT</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingafe8.html?mode=quote&amp;f=3&amp;p=47491" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic6d2b.html?p=47491#p47491" onclick="prompt('Message #197',this.href); return false;">#197</a></span> 
									<a class="unread" href="viewtopic6d2b.html?p=47491#p47491" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>01 Jul 2016 06:52
			</p>
			
			
			
			<div class="content"><strong class="text-strong">1) Parse out DNS Servers from IPCONFIG /ALL</strong><br /><br />Ignoring Foxidrive's concern about multiple sets, the following shows one way to put all the DNS Servers into an &quot;array&quot;, and then demonstrates how to print the first, last, or all values.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />setlocal enableDelayedExpansion<br /><br />for /f &quot;tokens=1,2 delims=: &quot; %%A in (<br />&nbsp; 'ipconfig /all ^| jrepl &quot;^&nbsp; &nbsp;DNS Servers (?:\. )+:((&#91;\s\r\n&#93;+(\d+\.){3}\d+)+)&quot; $1 /m /jmatch ^| findstr /n &quot;^&quot;'<br />) do (<br />&nbsp; set &quot;DNSServer.Cnt=%%A&quot;<br />&nbsp; set &quot;DNSServer.%%A=%%B&quot;<br />)<br /><br />echo(<br />echo Listing First DNS Server:<br />echo(!DNSServer.1!<br /><br />echo(<br />echo Listing Last DNS Server:<br />echo(!DNSServer.%DNSServer.Cnt%!<br /><br />echo(<br />echo Listing All DNS Servers:<br />for /l %%N in (1 1 %DNSServer.Cnt%) do echo(!DNSServer.%%N!<br /></code></pre></div><br />Another option is to use the /T option in a similar way as below<br /><br /><br /><strong class="text-strong">2) Parse out all &quot;Local group Membership&quot; groups from the NET USER [User Name] command</strong><br /> <br />Here I use the /T option along with a minimal bit of user supplied JScript code to directly parse out and print the values, one per line. The /JBEG option defines a variable used to indicate whether we are in a section of interest. The first search/replace pair matches the beginning of a &quot;Local Group Memberships&quot; section, as well as the first group, sets the indicator, and prints the first group. The second search/replace pair detects the beginning of any other section (end of previous), and clears the indicator. The last search/replace pair checks the indicator, and only prints the group match if the indicator is TRUE.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>net user user0 | jrepl &quot;^Local Group Memberships|^\w| *\*(\w+)&quot; &quot;go=true;false|go=false|go?$4:false&quot; /jmatch /jbeg &quot;go=false&quot; /t &quot;|&quot;<br /></code></pre></div><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p47505" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile47505">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist411e.html?mode=viewprofile&amp;u=8113" class="username">mirrormirror</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1ac1.html?author_id=8113&amp;sr=posts">127</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 08 Feb 2016 20:25</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content47505">

						<h3 ><a href="#p47505">Re: JREPL.BAT - regex text processor - successor to REPL.BAT</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingf2fd.html?mode=quote&amp;f=3&amp;p=47505" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic5862.html?p=47505#p47505" onclick="prompt('Message #198',this.href); return false;">#198</a></span> 
									<a class="unread" href="viewtopic5862.html?p=47505#p47505" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist411e.html?mode=viewprofile&amp;u=8113" class="username">mirrormirror</a></strong> &raquo; </span>01 Jul 2016 18:23
			</p>
			
			
			
			<div class="content"><blockquote class="uncited"><div>1. There can be more than one set of DNS servers in ipconfig /all<br />such as belonging to other network items. Are you aware of that?</div></blockquote> You are right of course - and I did not take this into consideration. For now I think there is only one adapter on each box where this will run.  I'll worry about multiple-adapter configurations when/if I need to <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br /><span style="color: #00BF80"><strong class="text-strong">--- EDIT---</strong></span><br />My prior code did account for multiple adapters. I used the following code to pick an adapter based on IP address, then parse the DNS servers of that particular adapter:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>FOR /F &quot;usebackq tokens=3,4&quot; %a IN (`route print 0.0.0.0 ^|findstr /C:&quot;0.0.0.0&quot;`) DO @ECHO b: %b</code></pre></div><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&nbsp; &nbsp;FOR /F &quot;usebackq tokens=3,4&quot; %%a IN (`route print 0.0.0.0 ^|findstr /C:&quot;0.0.0.0&quot;`) DO (<br />&nbsp; &nbsp;&nbsp; &nbsp;SET srcIP=%%b<br />&nbsp; &nbsp;)</code></pre></div><br /><blockquote class="uncited"><div> I'm guessing that you edited those and *test_ doesn't appear in the actual data</div></blockquote>It does - these are the names of the groups needing to be parsed:<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>Local Group Memberships&nbsp; &nbsp; &nbsp; *test_et_ro&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*test_et_rw<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*test_t_Links&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*test_troot_files<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*test_sConfigLoc&nbsp; &nbsp; &nbsp; *test_rs_Temp<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*test_rs_WAN&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *Users</code></pre></div><br />I'm going to try out dbenham's solutions shortly and will report back - Thanky you for the assistance!</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p47507" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile47507">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist411e.html?mode=viewprofile&amp;u=8113" class="username">mirrormirror</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1ac1.html?author_id=8113&amp;sr=posts">127</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 08 Feb 2016 20:25</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content47507">

						<h3 ><a href="#p47507">Re: JREPL.BAT - regex text processor - successor to REPL.BAT</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingb032.html?mode=quote&amp;f=3&amp;p=47507" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopice246.html?p=47507#p47507" onclick="prompt('Message #199',this.href); return false;">#199</a></span> 
									<a class="unread" href="viewtopice246.html?p=47507#p47507" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist411e.html?mode=viewprofile&amp;u=8113" class="username">mirrormirror</a></strong> &raquo; </span>01 Jul 2016 23:00
			</p>
			
			
			
			<div class="content">Dave, thank you for the examples, they help out a lot.  They both work great. I modified the 1st example to pull DNS servers associated with a specific IP:<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>FOR /F &quot;usebackq tokens=3,4&quot; %%a IN (`route print 0.0.0.0 ^|findstr /C:&quot;0.0.0.0&quot;`) DO (<br />&nbsp; &nbsp;SET srcIP=%%b<br />)<br /><br />for /f &quot;tokens=1,2 delims=: &quot; %%A in (<br />&nbsp; 'type t:\t.txt ^| jrepl &quot;%srcIP%&#91;\s\S&#93;*?^&#91; \t&#93;*?DNS Servers (?:\. )+:((&#91;\s\r\n&#93;+(\d+\.){3}\d+)+)&quot; $1 /m /jmatch ^| findstr /n &quot;^&quot;'<br />) do (<br />&nbsp; set &quot;DNSServer.Cnt=%%A&quot;<br />&nbsp; set &quot;DNSServer.%%A=%%B&quot;<br />)</code></pre></div><br />The search line changed:<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>'ipconfig /all ^| jrepl &quot;%srcIP%&#91;\s\S&#93;*?^&#91; \t&#93;*?DNS Servers (?:\. )+:((&#91;\s\r\n&#93;+(\d+\.){3}\d+)+)&quot; $1 /m /jmatch ^| findstr /n &quot;^&quot;'<br />'ipconfig /all ^| jrepl &quot;^&nbsp; &nbsp;DNS Servers (?:\. )+:((&#91;\s\r\n&#93;+(\d+\.){3}\d+)+)&quot; $1 /m /jmatch ^| findstr /n &quot;^&quot;'<br /></code></pre></div><br />ASSUMPTION #1: This will find the IP address and EVERYTHING up to the line beginning with &quot;DNS Server&quot;<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>%srcIP%&#91;\s\S&#93;*?</code></pre></div><br />And I also changed<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>^&nbsp; &nbsp;DNS Servers<br />to<br />^&#91; \t&#93;*?DNS Servers</code></pre></div><br />Because I do not trust IPCONFIG /ALL output to be exactly the same across different OS versions.<br />ASSUMPTION #2: the code above will find the start of a line then any number of [TABS] or [SPACES] then the string &quot;DNS Servers&quot;.<br />If either of my assumptions are incorrect please let me know.<br />As it is, it seems to work, but I need to test it out on a few different configurations.<br /><br />Also, I spotted a very minor typographical issue in your jRepl help:<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>::&nbsp; &nbsp; &nbsp; /N MinWidth&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - prefix output with liNe numbers</code></pre></div> - notice the capital N in &quot;liNe&quot; - although perhaps it is intentional?<br /><br />Your 2nd example works but is a bit over my head - I'll work on dissecting it at a later time - but until then, I'll use it in ignorance <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>net user user0 | jrepl &quot;^Local Group Memberships|^\w| *\*(\w+)&quot; &quot;go=true;false|go=false|go?$4:false&quot; /jmatch /jbeg &quot;go=false&quot; /t &quot;|&quot;</code></pre></div></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p47509" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile47509">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content47509">

						<h3 ><a href="#p47509">Re: JREPL.BAT - regex text processor - successor to REPL.BAT</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting2d74.html?mode=quote&amp;f=3&amp;p=47509" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic048d-2.html?p=47509#p47509" onclick="prompt('Message #200',this.href); return false;">#200</a></span> 
									<a class="unread" href="viewtopic048d-2.html?p=47509#p47509" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>01 Jul 2016 23:31
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>mirrormirror wrote:</cite>Also, I spotted a very minor typographical issue in your jRepl help:<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>::&nbsp; &nbsp; &nbsp; /N MinWidth&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - prefix output with liNe numbers</code></pre></div> - notice the capital N in &quot;liNe&quot; - although perhaps it is intentional?<br /></div></blockquote><br />It was indeed intentional. I was trying to highlight how I chose the option letters. But I think I should have capitalized &quot;Number&quot; instead  <img class="smilies" src="images/smilies/icon_confused.gif" alt=":?" title="Confused" /> <br /><br />I'll probably change it next time I make an update.<br /><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p47843" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile47843">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist411e.html?mode=viewprofile&amp;u=8113" class="username">mirrormirror</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1ac1.html?author_id=8113&amp;sr=posts">127</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 08 Feb 2016 20:25</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content47843">

						<h3 ><a href="#p47843">Re: JREPL.BAT - regex text processor - successor to REPL.BAT</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting6723.html?mode=quote&amp;f=3&amp;p=47843" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic1311.html?p=47843#p47843" onclick="prompt('Message #201',this.href); return false;">#201</a></span> 
									<a class="unread" href="viewtopic1311.html?p=47843#p47843" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist411e.html?mode=viewprofile&amp;u=8113" class="username">mirrormirror</a></strong> &raquo; </span>18 Jul 2016 17:32
			</p>
			
			
			
			<div class="content">Ok, I'm back with another question <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br />I'm trying to find an easy/standardized way to generate a few .sql files.  Right now there is only one [%var%] that needs to be expanded. In the &quot;printhere&quot; and &quot;heredoc&quot; threads, I've been trying those solutions but none are perfect for what I need.  I'm wondering if jrepl can do this?<br />I would like to FIND everything between the :SQLFile_Begin - :SQLFile_END labels and pipe it out to a new file:<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@ECHO OFF<br /><br />@ECHO BEGIN ---------------------------------------------<br />:SQLFile_Begin<br />&nbsp; &nbsp;&nbsp; &nbsp;DELETE FROM Users;<br />&nbsp; &nbsp;&nbsp; &nbsp;DROP TABLE IF EXISTS tmpDataInsert;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;CREATE TEMP TABLE IF NOT EXISTS &#91;tmpDataInsert&#93; ( &#91;uName&#93; CHAR );<br />&nbsp; &nbsp;&nbsp; &nbsp;.separator &quot;|&quot;<br />&nbsp; &nbsp;&nbsp; &nbsp;.import %DataFile% tmpDataInsert<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;INSERT INTO Users(UserNm) SELECT * FROM tmpDataInsert;<br />&nbsp; &nbsp;&nbsp; &nbsp;DROP TABLE IF EXISTS tmpDataInsert;<br /><br />:SQLFile_END<br /><br /><br />@ECHO END ---------------------------------------------<br /></code></pre></div> - And the %DataFile% variable would need to be expanded.<br />I'm having trouble figuring out how to use jrepl for simply &quot;searching&quot; without doing any &quot;replacing&quot;.<br />One more note, I have a few other files I'd like to generate this way - and they do include special characters (&gt; &amp; | ! , etc.).<br /><br />Thanks for any assistance!</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p47848" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile47848">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf147.html?author_id=3221&amp;sr=posts">6033</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Feb 2012 02:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content47848">

						<h3 ><a href="#p47848">Re: JREPL.BAT - regex text processor - successor to REPL.BAT</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingefd8.html?mode=quote&amp;f=3&amp;p=47848" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic3941-3.html?p=47848#p47848" onclick="prompt('Message #202',this.href); return false;">#202</a></span> 
									<a class="unread" href="viewtopic3941-3.html?p=47848#p47848" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a></strong> &raquo; </span>18 Jul 2016 18:09
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>mirrormirror wrote:</cite>I would like to FIND everything between the :SQLFile_Begin - :SQLFile_END labels and pipe it out to a new file:<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@ECHO OFF<br /><br />@ECHO BEGIN ---------------------------------------------<br />:SQLFile_Begin<br />&nbsp; &nbsp;&nbsp; &nbsp;DELETE FROM Users;<br />&nbsp; &nbsp;&nbsp; &nbsp;DROP TABLE IF EXISTS tmpDataInsert;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;CREATE TEMP TABLE IF NOT EXISTS &#91;tmpDataInsert&#93; ( &#91;uName&#93; CHAR );<br />&nbsp; &nbsp;&nbsp; &nbsp;.separator &quot;|&quot;<br />&nbsp; &nbsp;&nbsp; &nbsp;.import %DataFile% tmpDataInsert<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;INSERT INTO Users(UserNm) SELECT * FROM tmpDataInsert;<br />&nbsp; &nbsp;&nbsp; &nbsp;DROP TABLE IF EXISTS tmpDataInsert;<br /><br />:SQLFile_END<br /><br /><br />@ECHO END ---------------------------------------------<br /></code></pre></div> - And the %DataFile% variable would need to be expanded.<br /></div></blockquote><br /><br />Aacini's findrepl.bat can handle it this way.<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>call findrepl :SQLFile_Begin /e::SQLFile_END &lt;file.bat|more|findrepl .DataFile. %DataFile%<br /></code></pre></div><br /><br />I've used a very simple way of determining the variable name, but it will only work for unique text in those lines.  Findrepl.bat may already have better way to handle the percent signs.<br /><br />If the variable names are dynamic then some extra fiddling will be needed.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p47858" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile47858">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content47858">

						<h3 ><a href="#p47858">Re: JREPL.BAT - regex text processor - successor to REPL.BAT</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting1a1f.html?mode=quote&amp;f=3&amp;p=47858" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicb6ba.html?p=47858#p47858" onclick="prompt('Message #203',this.href); return false;">#203</a></span> 
									<a class="unread" href="viewtopicb6ba.html?p=47858#p47858" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>18 Jul 2016 22:22
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>mirrormirror wrote:</cite>I'm having trouble figuring out how to use jrepl for simply &quot;searching&quot; without doing any &quot;replacing&quot;.<br /></div></blockquote>It is very easy to instruct JREPL to return only what it matches, one match per line. All you need is the /JMATCH option.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>call jrepl &quot;search&quot; $0 /jmatch /f input.txt<br /></code></pre></div><br />But in your case you actually want to do a replacement. You are searching for the begin and end tags, and only keeping what lies between them. If you were to keep the entire match, then the tabs would be included in the output.<br /><br />You must use the /M option to search across multiple lines.<br /><br />I pipe the result to a second JREPL to perform the variable replacement. The code below attempts to replace any variable with its value. It leaves any %var% alone if var is not defined.<br /><br />I'm assuming your code is embedded within a batch script, so I use &quot;%~f0&quot; as the source file.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>jrepl &quot;:SQLFile_Begin\s*?\n(&#91;\s\S&#93;*?)\r?\n:SQLFile_END&quot; $1 /m /jmatch /f &quot;%~f0&quot; | jrepl &quot;%%(.*?)%%&quot; &quot;env($1)?env($1):$0&quot; /j /o &quot;output.sql&quot;<br /></code></pre></div><br /><br />I see you have already discovered my <a href="viewtopic86d5-2.html?f=3&amp;t=6537" class="postlink">PrintHere.bat</a>, but uncovered a bug. Now that I have fixed the bug, it should be very easy to solve your problem with PrintHere.bat. Note that you would want to change %DataFile% into !DataFile! within your source, and use the PrintHere /E option to cause the variable to be expanded in the result.<br /><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p47879" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile47879">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist411e.html?mode=viewprofile&amp;u=8113" class="username">mirrormirror</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1ac1.html?author_id=8113&amp;sr=posts">127</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 08 Feb 2016 20:25</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content47879">

						<h3 ><a href="#p47879">Re: JREPL.BAT - regex text processor - successor to REPL.BAT</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting1f69.html?mode=quote&amp;f=3&amp;p=47879" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicf741.html?p=47879#p47879" onclick="prompt('Message #204',this.href); return false;">#204</a></span> 
									<a class="unread" href="viewtopicf741.html?p=47879#p47879" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist411e.html?mode=viewprofile&amp;u=8113" class="username">mirrormirror</a></strong> &raquo; </span>19 Jul 2016 17:41
			</p>
			
			
			
			<div class="content"><blockquote class="uncited"><div>jrepl &quot;:SQLFile_Begin\s*?\n([\s\S]*?)\r?\n:SQLFile_END&quot; $1 /m /jmatch /f &quot;%~f0&quot; | jrepl &quot;%%(.*?)%%&quot; &quot;env($1)?env($1):$0&quot; /j /o &quot;output.sql&quot;</div></blockquote><br />This works perfect - thank you.<br />Now for an advice question: I have some other scenarios where I need to generate output files from within batch files. Some of them have special characters (&amp; &gt; &lt; |, etc.).  Can you see any advantages/disadvantages or issues using this jrepl solution for these tasks as compared to using the printhere.bat solution? - other than having to use the /E and !var! to expand variables?<br />I would like to settle on a solution that works for most or all of these cases without having to tweak it each time.<br /><br /><blockquote class="uncited"><div>call findrepl :SQLFile_Begin /e::SQLFile_END &lt;file.bat|more|findrepl .DataFile. %DataFile%</div></blockquote>Thanks foxdrive. This seems to work also! If you have any comments on my question to David (above) I'm all ears.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p47893" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile47893">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf147.html?author_id=3221&amp;sr=posts">6033</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Feb 2012 02:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content47893">

						<h3 ><a href="#p47893">Re: JREPL.BAT - regex text processor - successor to REPL.BAT</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting5c67.html?mode=quote&amp;f=3&amp;p=47893" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic5238.html?p=47893#p47893" onclick="prompt('Message #205',this.href); return false;">#205</a></span> 
									<a class="unread" href="viewtopic5238.html?p=47893#p47893" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a></strong> &raquo; </span>20 Jul 2016 13:00
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>mirrormirror wrote:</cite>I have some other scenarios where I need to generate output files from within batch files. Some of them have special characters (&amp; &gt; &lt; |, etc.). </div></blockquote><br /><br />I'd guess it depends on how those characters are being sent to Jrepl.  <br />If it's from within a file then it's a piece of cake.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p47898" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile47898">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist411e.html?mode=viewprofile&amp;u=8113" class="username">mirrormirror</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1ac1.html?author_id=8113&amp;sr=posts">127</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 08 Feb 2016 20:25</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content47898">

						<h3 ><a href="#p47898">Re: JREPL.BAT - regex text processor - successor to REPL.BAT</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingdd5e.html?mode=quote&amp;f=3&amp;p=47898" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic5b7f-2.html?p=47898#p47898" onclick="prompt('Message #206',this.href); return false;">#206</a></span> 
									<a class="unread" href="viewtopic5b7f-2.html?p=47898#p47898" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist411e.html?mode=viewprofile&amp;u=8113" class="username">mirrormirror</a></strong> &raquo; </span>20 Jul 2016 18:08
			</p>
			
			
			
			<div class="content"><blockquote class="uncited"><div>I'd guess it depends on how those characters are being sent to Jrepl. </div></blockquote> Right now, I am only extracting sections of text from within files. And I am just looking for a consistent, reliable method that will work for all characters. I'd like to avoid tweaking the method and/or text format (i.e. escaping characters, etc.) in the future - I just want a method that will work for my foreseeable needs.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p47900" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile47900">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content47900">

						<h3 ><a href="#p47900">Re: JREPL.BAT - regex text processor - successor to REPL.BAT</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting4a75-2.html?mode=quote&amp;f=3&amp;p=47900" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicb561.html?p=47900#p47900" onclick="prompt('Message #207',this.href); return false;">#207</a></span> 
									<a class="unread" href="viewtopicb561.html?p=47900#p47900" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>20 Jul 2016 18:53
			</p>
			
			
			
			<div class="content">I don't see any advantage of one solution over another. There shouldn't be any character restrictions for any of JREPL, FINDREPL, or PrintHere.<br /><br />Use whatever you are most comfortable with.<br /><br />But why do you need us to tell you that. All you need to do is prepare a file with traditionally &quot;problem&quot; characters, and see how the various solutions handle it.<br /><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p47901" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile47901">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist411e.html?mode=viewprofile&amp;u=8113" class="username">mirrormirror</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1ac1.html?author_id=8113&amp;sr=posts">127</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 08 Feb 2016 20:25</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content47901">

						<h3 ><a href="#p47901">Re: JREPL.BAT - regex text processor - successor to REPL.BAT</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingdc9c.html?mode=quote&amp;f=3&amp;p=47901" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic3cad.html?p=47901#p47901" onclick="prompt('Message #208',this.href); return false;">#208</a></span> 
									<a class="unread" href="viewtopic3cad.html?p=47901#p47901" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist411e.html?mode=viewprofile&amp;u=8113" class="username">mirrormirror</a></strong> &raquo; </span>20 Jul 2016 20:02
			</p>
			
			
			
			<div class="content"><blockquote class="uncited"><div>But why do you need us to tell you that. All you need to do is prepare a file with traditionally &quot;problem&quot; characters, and see how the various solutions handle it.</div></blockquote> I suppose I am just looking to experienced users to advise me of any known limitations/issues I may encounter.<br />DOS batch character handling has eaten a bunch of my time over the years. I've run tests and such but eventually I will run into a situation that fails <img class="smilies" src="images/smilies/icon_sad.gif" alt=":(" title="Sad" /><br />I wish there were a set concise of &quot;RULES&quot; which detailed batch character handling. Things like:<br />-What characters can be safely passed as parameters to other batch labels<br />-What characters can be safely passed as parameters to other batch files<br />- How character handling differs within variables and without variables - ex:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>(ECHO mytext&gt;RandomTextFile)&gt;newTextFile</code></pre></div><br />vs<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>SET &quot;myvar=mytext&gt;RandomTextFile&quot;<br />ECHO %myvar%&gt;newTextFile</code></pre></div> - and these are just a few.<br />My day job is not as a coder and I do these things for personal / friends / family. It can be months between my small scripting sessions because of time constraints and each time I need to dig up some references on how to do stuff because I don't use it every day.<br /><br />This forum is a tremendous source and the people have been very generous with their time and assistance, but I don't always want to bother others in order to find a solution - and searching/reading through post after post to find an answer is very time consuming.<br /><br />An example is my current task of generating a few SQL scripts from with batch files. I want the code to be as simple as possible, readable, and maintainable. I really don't like having to escape every parentheses &quot;^( ... ^)&quot; if I can avoid it, because when I change the SQL script, I will probably miss one of these instances and waste time trying to figure out why the whole process failed.  I did my searches and read through several solutions here on dostips as well as SO. I found your printhere.bat, as well as a couple of &quot;heredoc&quot; solutions - none of them worked out of the box for me - but they are working now. you guys provided me with some solutiuons using jrepl &amp; findrepl and so I have several viable solutions and just looking for advice on the best one for my tasks.<br /> <br />Please don't take my questions for advice as an offloading of due dilligence. I've learned over the years that there is great knowledge &amp; wisdom in groups and so I ask for advice much more now than when I was younger and &quot;wiser&quot; - in my own eyes.<br />As it stands right now, I'm preferring the jrepl solution since I don't have to do anything special with %variable% names or exclamation point escaping &quot;^!&quot; - I am very appreciative for you help in providing both the &quot;jrepl.bat&quot; as well as the syntax for my needs - thank you.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p47904" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile47904">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf147.html?author_id=3221&amp;sr=posts">6033</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Feb 2012 02:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content47904">

						<h3 ><a href="#p47904">Re: JREPL.BAT - regex text processor - successor to REPL.BAT</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingab41.html?mode=quote&amp;f=3&amp;p=47904" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicc014.html?p=47904#p47904" onclick="prompt('Message #209',this.href); return false;">#209</a></span> 
									<a class="unread" href="viewtopicc014.html?p=47904#p47904" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a></strong> &raquo; </span>21 Jul 2016 02:55
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>mirrormirror wrote:</cite>I wish there were a set concise of &quot;RULES&quot; which detailed batch character handling. Things like:<br />-What characters can be safely passed as parameters to other batch labels<br />-What characters can be safely passed as parameters to other batch files<br />- How character handling differs within variables and without variables - ex:<br /></div></blockquote><br /><br />I see your point very clearly and all the regulars will probably agree that there is nothing concise about batch files rules except the rule that says &quot;Everything has it's own set of rules&quot;  <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br /><br />Jrepl will handle all standard characters from a file with no need for any quoting.  Essentially it doesn't use batch scripting for the jrepl engine at all, which makes it so robust.<br /><br />Findrepl is in the same category and Dave's other tools and they all use Jscript which is only launched by a batch file.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p47986" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile47986">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist411e.html?mode=viewprofile&amp;u=8113" class="username">mirrormirror</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1ac1.html?author_id=8113&amp;sr=posts">127</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 08 Feb 2016 20:25</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content47986">

						<h3 ><a href="#p47986">Re: JREPL.BAT - regex text processor - successor to REPL.BAT</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingc6f1.html?mode=quote&amp;f=3&amp;p=47986" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicecc3.html?p=47986#p47986" onclick="prompt('Message #210',this.href); return false;">#210</a></span> 
									<a class="unread" href="viewtopicecc3.html?p=47986#p47986" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist411e.html?mode=viewprofile&amp;u=8113" class="username">mirrormirror</a></strong> &raquo; </span>23 Jul 2016 04:52
			</p>
			
			
			
			<div class="content">Ok, I'm back with another problem <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" />  This one is not crucual as I have a work-a-round but it is far from ideal. This is more of a jscript regex question.<br /><br />I want to parse the output from this:<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>C:\&gt;icacls &quot;c:\Program Files\Common Files&quot;<br />c:\Program Files\Common Files NT SERVICE\TrustedInstaller:(F)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NT SERVICE\TrustedInstaller:(CI)(IO)(F)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NT AUTHORITY\SYSTEM:(M)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NT AUTHORITY\SYSTEM:(OI)(CI)(IO)(F)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; BUILTIN\Administrators:(M)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; BUILTIN\Administrators:(OI)(CI)(IO)(F)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; BUILTIN\Users:(RX)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; BUILTIN\Users:(OI)(CI)(IO)(GR,GE)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CREATOR OWNER:(OI)(CI)(IO)(F)</code></pre></div><br />I just want all of the users/privs - basically everything except the &lt;folder path&gt; and &lt;whitespace&gt;. The only problem I have is the first line of output:<br /> <span style="color: #FF0000"><strong class="text-strong">c:\Program Files\Common Files</strong></span> <span style="color: #00BF00"><strong class="text-strong">NT SERVICE\TrustedInstaller:(F)</strong></span><br />I only want the <span style="color: #00BF00"><strong class="text-strong">GREEN </strong></span>- not the <span style="color: #FF0000"><strong class="text-strong">RED</strong></span>. The problem is the &quot;\&quot; in the file paths - they mess up a [literal] search string in regex - and I suppose periods (.) would do the same. I guess the \Q...\E syntax allowed by other regex engines would solve this but as it stands I don't know how to parse that out. This needs to work for an unknown number of &lt;folder paths&gt; which may include [spaces], [!], etc. I'd like to do something like this but it doesn't work:<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>FOR %%c IN&nbsp; (&quot;c:\Program Files (x86)&quot;; &quot;c:\Program Files\Common Files&quot;) DO (<br />&nbsp; &nbsp;FOR /F &quot;usebackq tokens=* delims=&quot; %%d IN (`icacls &quot;%%~c&quot; ^|jrepl &quot;(%%~c)?(.*)&quot; $2 /jmatch`) DO @ECHO %%d<br />)</code></pre></div><br />My work-a-round is to get the length of the &lt;folder path&gt; (I think the :strlen code is from jeb) then simply skip those number of characters:<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@ECHO OFF<br />FOR %%c IN&nbsp; (&quot;c:\Program Files (x86)&quot;; &quot;c:\Program Files\Common Files&quot;) DO (<br />&nbsp; &nbsp;CALL :testLabel %%~c<br />&nbsp; &nbsp;FOR /F &quot;usebackq tokens=* delims=&quot; %%d IN (`icacls &quot;%%~c&quot; ^|jrepl &quot;%%~c(.*)&quot; $1 /jmatch`) DO @ECHO %%d<br />)<br />GOTO :theEnd<br /><br />:testLabel<br />&nbsp; &nbsp;SET mytmpFldr=%*<br />&nbsp; &nbsp;CALL :strLen myLen mytmpFldr<br />&nbsp; &nbsp;SET /A myLen+=1<br />&nbsp; &nbsp;CALL ECHO CurrentFolder: __________ %*<br />&nbsp; &nbsp;FOR /F &quot;usebackq tokens=* delims=&quot; %%d IN (`icacls &quot;%*&quot; ^|jrepl &quot;.{%myLen%}(.*)$&quot; $1 /jmatch`) DO (<br />&nbsp; &nbsp;&nbsp; &nbsp;@ECHO %%d<br />&nbsp; &nbsp;)<br />&nbsp; &nbsp;@ECHO(<br />GOTO:EOF<br /><br />:strlen &lt;resultVar&gt; &lt;stringVar&gt;<br />(&nbsp; &nbsp;<br />&nbsp; &nbsp; setlocal EnableDelayedExpansion<br />&nbsp; &nbsp; set &quot;s=!%~2!#&quot;<br />&nbsp; &nbsp; set &quot;len=0&quot;<br />&nbsp; &nbsp; for %%P in (4096 2048 1024 512 256 128 64 32 16 8 4 2 1) do (<br />&nbsp; &nbsp; &nbsp; &nbsp; if &quot;!s:~%%P,1!&quot; NEQ &quot;&quot; ( <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; set /a &quot;len+=%%P&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; set &quot;s=!s:~%%P!&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; )<br />&nbsp; &nbsp; )<br />)<br />( <br />&nbsp; &nbsp; endlocal<br />&nbsp; &nbsp; set &quot;%~1=%len%&quot;<br />&nbsp; &nbsp; exit /b<br />)<br /><br />:theEnd</code></pre></div><br />The reason I make the <strong class="text-strong"><span style="color: #FF0000">CALL :testLabel %%~c</span></strong> is because I don't want to use DELAYED expansion in my FOR loop - to avoid problems with Exclamation marks (!) in folder names.<br /><br />Any ideas?</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
	

	<div class="action-bar bar-bottom">
	
			<a href="postingdfbb.html?mode=reply&amp;f=3&amp;t=6044" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic541c.html?f=3&amp;t=6044&amp;start=195&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

			<form method="post" action="https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=6044&amp;start=195">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			393 posts
							<ul>
	<li class="dropdown-container dropdown-button-control dropdown-page-jump page-jump">
		<a class="button button-icon-only dropdown-trigger" href="#" title="Click to jump to page…" role="button"><i class="icon fa-level-down fa-rotate-270" aria-hidden="true"></i><span class="sr-only">Page <strong>14</strong> of <strong>27</strong></span></a>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
				<li>Jump to page:</li>
				<li class="page-jump-form">
					<input type="number" name="page-number" min="1" max="999999" title="Enter the page number you wish to go to" class="inputbox tiny" data-per-page="15" data-base-url=".&#x2F;viewtopic.php&#x3F;f&#x3D;3&amp;amp&#x3B;t&#x3D;6044" data-start-name="start" />
					<input class="button2" value="Go" type="button" />
				</li>
			</ul>
		</div>
	</li>
			<li class="arrow previous"><a class="button button-icon-only" href="viewtopicaffe.html?f=3&amp;t=6044&amp;start=180" rel="prev" role="button"><i class="icon fa-chevron-left fa-fw" aria-hidden="true"></i><span class="sr-only">Previous</span></a></li>
				<li><a class="button" href="viewtopicb16d.html?f=3&amp;t=6044" role="button">1</a></li>
			<li class="ellipsis" role="separator"><span>…</span></li>
				<li><a class="button" href="viewtopic4107.html?f=3&amp;t=6044&amp;start=165" role="button">12</a></li>
				<li><a class="button" href="viewtopicaffe.html?f=3&amp;t=6044&amp;start=180" role="button">13</a></li>
			<li class="active"><span>14</span></li>
				<li><a class="button" href="viewtopic57db-2.html?f=3&amp;t=6044&amp;start=210" role="button">15</a></li>
				<li><a class="button" href="viewtopic2473.html?f=3&amp;t=6044&amp;start=225" role="button">16</a></li>
			<li class="ellipsis" role="separator"><span>…</span></li>
				<li><a class="button" href="viewtopic54c6.html?f=3&amp;t=6044&amp;start=390" role="button">27</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopic57db-2.html?f=3&amp;t=6044&amp;start=210" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="viewforum4d6b.html?f=3" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to “DOS Batch Forum”</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="viewforum31e6.html?f=4" class="jumpbox-cat-link"> <span> DosTips - Dos Batch</span></a></li>
																<li><a href="viewforum4d6b.html?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; DOS Batch Forum</span></a></li>
											</ul>
		</div>
	</div>

	</div>


			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
							<span class="crumb"><a href="../index.html" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>DosTips.com</span></a></span>									<span class="crumb"><a href="index.html" data-navbar-reference="index"><span>Board index</span></a></span>					</li>
		
				<li class="rightside">All times are <span title="UTC-6">UTC-06:00</span></li>
							<li class="rightside">
				<a href="ucp033a.html?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete all board cookies</span>
				</a>
			</li>
												<li class="rightside" data-last-responsive="true">
				<a href="memberlist4bfd.html?mode=team" role="menuitem">
					<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
				</a>
			</li>
									<li class="rightside" data-last-responsive="true">
				<a href="memberlist8733.html?mode=contactadmin" role="menuitem">
					<i class="icon fa-envelope fa-fw" aria-hidden="true"></i><span>Contact us</span>
				</a>
			</li>
			</ul>

	</div>
</div>

	<div class="copyright">
				<!-- WARNING NO DELETE -->Style developer by <a href="http://tricolor.x-tk.ru/">support forum tricolor</a>, <!-- END WARNING NO DELETE -->Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
									</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	<img src="cron5089.gif?cron_type=cron.task.text_reparser.post_text" width="1" height="1" alt="cron" /></div>

<script type="text/javascript" src="assets/javascript/jquery.mind772.js?assets_version=34"></script>
<script type="text/javascript" src="assets/javascript/cored772.js?assets_version=34"></script>



<script type="text/javascript" src="styles/prosilver/template/forum_fnd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/prosilver/template/ajaxd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/jquery-uid772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/collapsed772.js?assets_version=34"></script>



</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=6044&start=195 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 08:01:01 GMT -->
</html>
