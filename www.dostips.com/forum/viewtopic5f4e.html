<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=5595&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 06:45:25 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>DosTips.com &bull; JSORT.BAT v4.2 - Case sensitive sort with option for numeric sort</title>

<link href="styles/AllanStyle-SUBSILVER/theme/print.css" rel="stylesheet">
</head>
<body id="phpbb">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>DosTips.com</h1>
		<p>A Forum all about DOS Batch<br /><a href="index-2.html">https://www.dostips.com/forum/</a></p>

		<h2>JSORT.BAT v4.2 - Case sensitive sort with option for numeric sort</h2>
		<p><a href="viewtopicf1eb.html?f=3&amp;t=5595">https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=5595</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>1</strong> of <strong>4</strong></div>
					<div class="post">
				<h3>JSORT.BAT v4.2 - Case sensitive sort with option for numeric sort</h3>
				<div class="date">Posted: <strong>13 May 2014 22:10</strong></div>
				<div class="author">by <strong>dbenham</strong></div>
				<div class="content"><span style="color: #0000BF"><strong class="text-strong">Here at the top is the current version. The original post follows the current code.</strong></span>
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@if (@X)==(@Y) @end /* Harmless hybrid line that begins a JScript comment
@goto :Batch
 
::************ Documentation ***********
::JSORT.BAT version 4.2
:::
:::JSORT [File] [/Option [Value]]...
:::
:::  Sort lines of text from stdin and write the result to stdout.
:::  JSORT uses an ascending, case sensitive text sort by default.
:::
:::    File - If the optional File argument is specified, then JSORT reads lines
:::           from the file instead of from stdin. If specified, the File must
:::           be the very first argument.
:::
:::  Options:
:::
:::    /C n - Number of sorted lines to print. Skipped lines are always printed
:::           and do not contribute to the count. Default is -1 (all lines).
:::
:::    /D String - Specifies the string used to delimit tokens. The delimiter
:::           string is always case sensitive. A quote literal " must be escaped
:::           as \q, and a backslash literal \ must be escaped as \\.
:::           The default value is an empty string, meaning treat the entire
:::           line as a single token.
:::
:::    /I   - Ignore case when sorting (or when checking for uniqueness)
:::
:::    /N   - Sort consecutive digits as numbers instead of text. The numbers
:::           may be embedded within alpha text. JSort supports numbers up to
:::           20 digits long.
:::
:::    /O File - Writes the output to File instead of stdout.
:::
:::    /P n - Begin sorting at character position n relative to the beginning
:::           of the selected token. Lines that do not extend that far are
:::           treated as equivalent values, and collate before all other lines.
:::           The default value is 1 (first character).
:::
:::    /R   - Sort the lines in Reverse (descending) order.
:::
:::    /S n - Number of lines to skip - default is 0.
:::           Skipped lines are not sorted (remain in place)
:::
:::    /T n - Specify the token at which to begin sorting. The sort is not
:::           restricted to the selected token, it just helps to identify where
:::           to begin sorting. The default value is 1 (first token). A value of
:::           -1 represents the last token, -2 the penultimate token, etc.
:::           A value of 0 is invalid. Note that negative values only recognize
:::           tokens that occur after a delimiter. If the requested token cannot
:::           be found, then the line will collate before all other lines.
:::
:::    /U   - Only write unique lines (discard duplicates)
:::
:::    /V   - Display the version of JSORT.BAT.
:::
:::    /?   - Display this help
:::
:::JSORT.BAT was written by Dave Benham and originally posted at
:::http://www.dostips.com/forum/viewtopic.php?f=3&amp;t=5595
:::

============== :Batch portion =============
@echo off
setlocal disableDelayedExpansion

:: Get optional input file
set "infile="
set "test=%~1"
if defined test (
  setlocal enableDelayedExpansion
  if "!test:~0,1!" neq "/" (
    endlocal
    set ^"infile=^&lt;"%~1""
    shift /1
  ) else endlocal
)

:: Define options
set "options= /?: /c:-1 /d:"" /i: /n: /o:"" /p:1 /r: /s:0 /t:1 /u: /v: "

:: Set default option values
for %%O in (%options%) do for /f "tokens=1,* delims=:" %%A in ("%%O") do set "%%A=%%~B"

:: Get options
:loop
if not "%~1"=="" (
  setlocal enableDelayedExpansion
  set "test=!options:* %~1:=! "
  if "!test!"=="!options! " (
      &gt;&amp;2 echo Error: Invalid option %~1
      exit /b 1
  ) else if "!test:~0,1!"==" " (
      endlocal
      set "%~1=1"
  ) else (
      endlocal
      set "%~1=%~2"
      shift /1
  )
  shift /1
  goto :loop
)

:: Display help
if defined /? (
  for /f "delims=: tokens=*" %%A in ('findstr "^:::" "%~f0"') do echo(%%A
  exit /b 0
)

:: Display version
if defined /v (
  for /f "delims=: tokens=*" %%A in ('findstr /bc:"::JSORT.BAT version" "%~f0"') do echo %%A
  exit /b 0
)

:: Transform and validate options
set /a "case=0%/i%, num=0%/n%, pos=%/p%-1, tok=%/t%, unique=0%/u%, order=1-2*0%/r%, 1/!(0x80000000&amp;pos), 1/tok" 2&gt;nul || (
  &gt;&amp;2 echo Error: Invalid option value.
  exit /b 1
)
if %tok% gtr 0 set /a tok-=1
set "outfile="
if defined /o set ^"outfile=^&gt;"%/o%""

:: Perform the sort
%infile% %outfile% cscript //E:JScript //nologo "%~f0" %case% %num% %pos% %order% %/s% %/c% %tok% "%/d%" %unique%

exit /b 0

************* JScript portion **********/
var array=new Array(),
    nocase =WScript.Arguments.Item(0),
    numeric=WScript.Arguments.Item(1),
    pos    =parseInt(WScript.Arguments.Item(2)),
    order  =WScript.Arguments.Item(3),
    skip   =WScript.Arguments.Item(4),
    count  =WScript.Arguments.Item(5),
    token  =WScript.Arguments.Item(6),
    delim  =WScript.Arguments.Item(7).replace(/\\(?!q|\\)/g,'').replace(/\\\\/g,'\\s').replace(/\\q/g,'"').replace(/\\s/g,'\\'),
    unique =WScript.Arguments.Item(8);
while (!WScript.StdIn.AtEndOfStream) {
  if (skip &gt; 0) {
    WScript.Echo(WScript.StdIn.ReadLine());
    skip-=1
  } else {
    var expanded="", num="", raw=WScript.StdIn.ReadLine(), upper=((nocase==1)?raw.toUpperCase():raw);
    for( var i=pos+FindToken(raw,delim,token); i&lt;raw.length; i++ ) {
      var c=upper.substr(i,1);
      if (numeric==1 &amp;&amp; c&gt;="0" &amp;&amp; c&lt;="9") {
        num+=c;
      } else {
        if (num != "") {
          num="00000000000000000000" + num;
          expanded+=num.substr(num.length-20);
          num="";
        }
        expanded+=c;
      }
    }
    if (num != "") {
      num="00000000000000000000" + num;
      expanded+=num.substr(num.length-20);
    }
    var obj={expanded:expanded, raw:raw};
    array.push(obj);
  }
}
if (count&lt;0) count=array.length;
if (count&gt;array.length) count=array.length;
if (unique==1) {
  array.sort( function(a,b){
                var rtn = (a.expanded&gt;b.expanded)-(a.expanded&lt;b.expanded);
                if (rtn==0) {
                  var a2=(nocase==1)?a.raw.toUpperCase():a.raw;
                  var b2=(nocase==1)?b.raw.toUpperCase():b.raw;
                  rtn = (a2&gt;b2)-(a2&lt;b2);
                }
                return order*rtn;
              });
  if (count&gt;=1) WScript.Echo(array[0].raw);
  for (var i=1; i&lt;count; i++) {
    if (nocase==1 &amp;&amp; array[i].raw.toUpperCase() == array[i-1].raw.toUpperCase()) continue;
    if (nocase==0 &amp;&amp; array[i].raw == array[i-1].raw) continue;
    WScript.Echo(array[i].raw);
  }
} else {
  array.sort(function(a,b){return order*((a.expanded&gt;b.expanded)-(a.expanded&lt;b.expanded));});
  for (var i=0; i&lt;count; i++) WScript.Echo(array[i].raw);
}

function FindToken(str, str2, n) {
  if (n!=0 &amp;&amp; str2=="") return str.length;
  if (n&gt;=0) {
    var rtn = 0;
    for( var i=n; i&gt;0; i-- ) {
      rtn = str.indexOf(str2,rtn);
      if (rtn&lt;0) return str.length;
      rtn+=str2.length;
    }
  } else {
    var rtn = str.length;
    for (var i=n; i&lt;0; i++ ) {
      rtn-=1;
      rtn = str.lastIndexOf(str2,rtn);
      if (rtn&lt;0) return str.length;
    }
    rtn+=str2.length;
  }
  return rtn;
}
</code></pre></div>

------------------------------------------------------------------------------------------<br>
<span style="color: #0000BF"><strong class="text-strong">Original post:</strong></span><br>
<br>
I've often been disappointed that SORT did not have a case sensitive option, but never thought much about doing anything about it.<br>
<br>
It's also not uncommon to want to sort strings with embedded numbers, and I've always parsed and reformatted the strings with 0 padded numbers so that I could use SORT. It works, but it's a pain.<br>
<br>
But then at <a href="viewtopic8ace.html?f=3&amp;t=5583" class="postlink">How can i order the results consecutively in a batch?</a> rootx asked how to sort numeric strings. Squashman linked to the <a href="../index9d9b.html?t=Batch.SortTextWithNumbers" class="postlink">DosTips SortN.bat solution</a>, which I had never noticed before. It works well, but it can be slow with moderate sized input.<br>
<br>
Then I thought, why not write a hybrid JScript/batch SORT utility that can solve both problems efficiently and conveniently <img class="smilies" src="images/smilies/icon_question.gif" width="15" height="15" alt=":?:" title="Question">  <img class="smilies" src="images/smilies/icon_idea.gif" width="15" height="15" alt=":idea:" title="Idea">  - so I did  <img class="smilies" src="images/smilies/icon_smile.gif" width="15" height="15" alt=":)" title="Smile"> I'm no JScript expert, and I did not spend much time optimizing the code. But it seems to work well in my limited testing. But be aware that the utility will load the entire input data set into memory, using more than twice the original space.<br>
<br>
Full documentation is embedded within the script. Use JSORT /? to display the help.<br>

<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@if (@X)==(@Y) @end /* Harmless hybrid line that begins a JScript comment

::************ Documentation ***********
::JSORT.BAT version 1.0
:::
:::JSORT [/Option [Value]]...
:::
:::  Sort lines of text from stdin and write the result to stdout.
:::  JSORT uses an ascending, case sensitive text sort by default.
:::
:::  Options:
:::
:::    /I - Ignore case
:::
:::    /N - Sort consecutive digits as numbers instead of text. The numbers
:::         may be embedded within alpha text.
:::
:::    /P n - Begin sorting at character position n. Lines that have fewer than
:::           n characters are treated as equivalent values, and collate before
:::           all other lines. The default value is 1 (first character).
:::
:::    /R - Sort the lines in reverse (descending) order.
:::
:::    /V - Display the version of JSORT.BAT.
:::
:::    /? - Display this help
:::
:::JSORT.BAT was written by Dave Benham and originally posted at
:::http://www.dostips.com/forum/viewtopic.php?f=3&amp;t=5595
:::

::************ Batch portion ***********
@echo off
setlocal enableDelayedExpansion

:: Define options
set "options= /?: /i: /n: /p:1 /r: /v:"

:: Set default option values
for %%O in (%options%) do for /f "tokens=1,* delims=:" %%A in ("%%O") do set "%%A=%%~B"

:: Get options
:loop
if not "%~1"=="" (
  set "test=!options:* %~1:=! "
  if "!test!"=="!options! " (
      &gt;&amp;2 echo Error: Invalid option %~1
      exit /b 1
  ) else if "!test:~0,1!"==" " (
      set "%~1=1"
  ) else (
      set "%~1=%~2"
      shift /1
  )
  shift /1
  goto :loop
)

:: Display help
if defined /? (
  for /f "delims=: tokens=*" %%A in ('findstr "^:::" "%~f0"') do echo(%%A
  exit /b 0
)

:: Display version
if defined /v (
  for /f "delims=: tokens=*" %%A in ('findstr /bc:"::JSORT.BAT version" "%~f0"') do echo %%A
  exit /b 0
)

:: Transform and validate options
set /a "case=0%/i%, num=0%/n%, pos=%/p%-1, order=1-2*0%/r%, val=1/^!(0x80000000&amp;pos)" 2&gt;nul || (
  &gt;&amp;2 echo Error: Invalid /P value.
  exit /b 1
)

:: Perform the sort
cscript //E:JScript //nologo "%~f0" %case% %num% %pos% %order%
exit /b 0


************* JScript portion **********/
var array=new Array(),
    nocase =WScript.Arguments.Item(0),
    numeric=WScript.Arguments.Item(1),
    pos    =WScript.Arguments.Item(2),
    order  =WScript.Arguments.Item(3);
while (!WScript.StdIn.AtEndOfStream) {
  var expanded="", num="", raw=WScript.StdIn.ReadLine(), upper=((nocase==1)?raw.toUpperCase():raw);
  for( var i=pos; i&lt;raw.length; i++ ) {
    var c=upper.substr(i,1);
    if (numeric==1 &amp;&amp; c&gt;="0" &amp;&amp; c&lt;="9") {
      num+=c;
    } else {
      if (num != "") {
        num="00000000000000000000" + num;
        expanded+=num.substr(num.length-20);
        num="";
      }
      expanded+=c;
    }
  }
  if (num != "") {
    num="00000000000000000000" + num;
    expanded+=num.substr(num.length-20);
  }
  var obj={expanded:expanded, raw:raw};
  array.push(obj);
}
array.sort(function(a,b){return order*((a.expanded&gt;b.expanded)-(a.expanded&lt;b.expanded));})
for (var i=0; i&lt;array.length; i++) WScript.Echo(array[i].raw);
</code></pre></div>

Dave Benham</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: JSORT.BAT - Case sensitive sort with option for numeric</h3>
				<div class="date">Posted: <strong>21 Oct 2014 13:50</strong></div>
				<div class="author">by <strong>dbenham</strong></div>
				<div class="content">There was an interesting StackOverflow question at <a href="http://stackoverflow.com/q/26487895/1012053" class="postlink">Find top 10 processes with wmic command</a>. JSORT.BAT could already sort numercally at a given line position, but it couldn't preserve the header, and it couldn't list just the top 10.<br /><br />So I modified JSORT.BAT to include the /S n (skip n lines), and /C n (print top n sorted lines) options.<br /><br />The solution becomes quite simple, and efficient. The only tricky bit is the position of the WorkingSetSize column varies depending on the longest listed file name. So extra code had to be included to compute the line position at which to start sorting.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />setlocal<br /><br />:: Get full proc list in unicode<br />wmic process list brief &gt;procList.tmp<br /><br />:: Convert unicode to ANSII<br />type procList.tmp &gt;procList.tmp2<br /><br />:: Read the header line<br />&lt;procList.tmp2 set /p &quot;header=&quot;<br /><br />:: Identify position of WorkingSetSize column<br />for /f &quot;delims=W&quot; %%A in (&quot;%header%&quot;) do echo %%A&gt;skipSize.tmp<br />for %%A in (skipSize.tmp) do set /a pos=%%~zA-1<br /><br />:: Print the header, followed by the top 10 sorted by WorkingSetSize<br />type procList.tmp2 | jsort2 /n /r /p %pos% /s 1 /c 10<br /><br />:: Delete the temp files<br />del procList.tmp procList.tmp2 skipSize.tmp<br /></code></pre></div><br /><br />Here is version 2 with the new options <strong class="text-strong"><em class="text-italics"><span style="color: #0000BF">(With 2.1 bug fix for /C option default)</span></em></strong>:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@if (@X)==(@Y) @end /* Harmless hybrid line that begins a JScript comment<br /><br />::************ Documentation ***********<br />::JSORT.BAT version 2.1<br />:::<br />:::JSORT &#91;/Option &#91;Value&#93;&#93;...<br />:::<br />:::&nbsp; Sort lines of text from stdin and write the result to stdout.<br />:::&nbsp; JSORT uses an ascending, case sensitive text sort by default.<br />:::<br />:::&nbsp; Options:<br />:::<br />:::&nbsp; &nbsp; /I&nbsp; &nbsp;- Ignore case<br />:::<br />:::&nbsp; &nbsp; /C n - Number of sorted lines to print. Skipped lines are always printed<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;and do not contribute to the count. Default is -1 (all lines).<br />:::<br />:::&nbsp; &nbsp; /N&nbsp; &nbsp;- Sort consecutive digits as numbers instead of text. The numbers<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;may be embedded within alpha text. JSort supports numbers up to<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;20 digits long.<br />:::<br />:::&nbsp; &nbsp; /P n - Begin sorting at character position n. Lines that have fewer than<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n characters are treated as equivalent values, and collate before<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;all other lines. The default value is 1 (first character).<br />:::<br />:::&nbsp; &nbsp; /R&nbsp; &nbsp;- Sort the lines in Reverse (descending) order.<br />:::<br />:::&nbsp; &nbsp; /S n - Number of lines to skip - default is 0.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Skipped lines are not sorted (remain in place)<br />:::<br />:::&nbsp; &nbsp; /V&nbsp; &nbsp;- Display the version of JSORT.BAT.<br />:::<br />:::&nbsp; &nbsp; /?&nbsp; &nbsp;- Display this help<br />:::<br />:::JSORT.BAT was written by Dave Benham and originally posted at<br />:::http://www.dostips.com/forum/viewtopic.php?f=3&amp;t=5595<br />:::<br /><br />::************ Batch portion ***********<br />@echo off<br />setlocal enableDelayedExpansion<br /><br />:: Define options<br />set &quot;options= /?: /i: /c:-1 /n: /p:1 /r: /s:0 /v:&quot;<br /><br />:: Set default option values<br />for %%O in (%options%) do for /f &quot;tokens=1,* delims=:&quot; %%A in (&quot;%%O&quot;) do set &quot;%%A=%%~B&quot;<br /><br />:: Get options<br />:loop<br />if not &quot;%~1&quot;==&quot;&quot; (<br />&nbsp; set &quot;test=!options:* %~1:=! &quot;<br />&nbsp; if &quot;!test!&quot;==&quot;!options! &quot; (<br />&nbsp; &nbsp; &nbsp; &gt;&amp;2 echo Error: Invalid option %~1<br />&nbsp; &nbsp; &nbsp; exit /b 1<br />&nbsp; ) else if &quot;!test:~0,1!&quot;==&quot; &quot; (<br />&nbsp; &nbsp; &nbsp; set &quot;%~1=1&quot;<br />&nbsp; ) else (<br />&nbsp; &nbsp; &nbsp; set &quot;%~1=%~2&quot;<br />&nbsp; &nbsp; &nbsp; shift /1<br />&nbsp; )<br />&nbsp; shift /1<br />&nbsp; goto :loop<br />)<br /><br />:: Display help<br />if defined /? (<br />&nbsp; for /f &quot;delims=: tokens=*&quot; %%A in ('findstr &quot;^:::&quot; &quot;%~f0&quot;') do echo(%%A<br />&nbsp; exit /b 0<br />)<br /><br />:: Display version<br />if defined /v (<br />&nbsp; for /f &quot;delims=: tokens=*&quot; %%A in ('findstr /bc:&quot;::JSORT.BAT version&quot; &quot;%~f0&quot;') do echo %%A<br />&nbsp; exit /b 0<br />)<br /><br />:: Transform and validate options<br />set /a &quot;case=0%/i%, num=0%/n%, pos=%/p%-1, order=1-2*0%/r%, 1/^!(0x80000000&amp;pos)&quot; 2&gt;nul || (<br />&nbsp; &gt;&amp;2 echo Error: Invalid /P value.<br />&nbsp; exit /b 1<br />)<br /><br />:: Perform the sort<br />cscript //E:JScript //nologo &quot;%~f0&quot; %case% %num% %pos% %order% %/s% %/c%<br />exit /b 0<br /><br /><br />************* JScript portion **********/<br />var array=new Array(),<br />&nbsp; &nbsp; nocase =WScript.Arguments.Item(0),<br />&nbsp; &nbsp; numeric=WScript.Arguments.Item(1),<br />&nbsp; &nbsp; pos&nbsp; &nbsp; =WScript.Arguments.Item(2),<br />&nbsp; &nbsp; order&nbsp; =WScript.Arguments.Item(3),<br />&nbsp; &nbsp;&nbsp; &nbsp;skip&nbsp; &nbsp;=WScript.Arguments.Item(4),<br />&nbsp; &nbsp;&nbsp; &nbsp;count&nbsp; =WScript.Arguments.Item(5);<br />while (!WScript.StdIn.AtEndOfStream) {<br />&nbsp; if (skip &gt; 0) {<br />&nbsp; &nbsp; WScript.Echo(WScript.StdIn.ReadLine());<br />&nbsp; &nbsp; skip-=1<br />&nbsp; } else {<br />&nbsp; &nbsp; var expanded=&quot;&quot;, num=&quot;&quot;, raw=WScript.StdIn.ReadLine(), upper=((nocase==1)?raw.toUpperCase():raw);<br />&nbsp; &nbsp; for( var i=pos; i&lt;raw.length; i++ ) {<br />&nbsp; &nbsp; &nbsp; var c=upper.substr(i,1);<br />&nbsp; &nbsp; &nbsp; if (numeric==1 &amp;&amp; c&gt;=&quot;0&quot; &amp;&amp; c&lt;=&quot;9&quot;) {<br />&nbsp; &nbsp; &nbsp; &nbsp; num+=c;<br />&nbsp; &nbsp; &nbsp; } else {<br />&nbsp; &nbsp; &nbsp; &nbsp; if (num != &quot;&quot;) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; num=&quot;00000000000000000000&quot; + num;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; expanded+=num.substr(num.length-20);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; num=&quot;&quot;;<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; expanded+=c;<br />&nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; if (num != &quot;&quot;) {<br />&nbsp; &nbsp; &nbsp; num=&quot;00000000000000000000&quot; + num;<br />&nbsp; &nbsp; &nbsp; expanded+=num.substr(num.length-20);<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; var obj={expanded:expanded, raw:raw};<br />&nbsp; &nbsp; array.push(obj);<br />&nbsp; }<br />}<br />if (count&lt;0) count=array.length;<br />if (count&gt;array.length) count=array.length;<br />array.sort(function(a,b){return order*((a.expanded&gt;b.expanded)-(a.expanded&lt;b.expanded));});<br />for (var i=0; i&lt;count; i++) WScript.Echo(array&#91;i&#93;.raw);<br /></code></pre></div><br /><br />Dave Benham</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: JSORT.BAT - Case sensitive sort with option for numeric</h3>
				<div class="date">Posted: <strong>21 Oct 2014 22:29</strong></div>
				<div class="author">by <strong>foxidrive</strong></div>
				<div class="content">Thank Dave, as always for your useful tools.<br /><br />Just thinking that you might like to change the batch to provide help when no options are given.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: JSORT.BAT - Case sensitive sort with option for numeric </h3>
				<div class="date">Posted: <strong>22 Oct 2014 06:14</strong></div>
				<div class="author">by <strong>dbenham</strong></div>
				<div class="content">No, JSORT is much like MORE or SORT - it is perfectly reasonable to run the command without any arguments or options, and it will wait silently for input, gathering everything that is entered, and then print out the sorted lines after &lt;Ctrl-Z&gt; is pressed.<br /><br />Running it without any options performs a case sensitive sort.<br /><br /><br />Dave Benham</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: JSORT.BAT - Case sensitive sort with option for numeric </h3>
				<div class="date">Posted: <strong>22 Oct 2014 09:52</strong></div>
				<div class="author">by <strong>dbenham</strong></div>
				<div class="content">Updated to version 2.1 - fixed /C option default. Was 0, corrected to -1. Eariler post has been edited.<br /><br /><br />Dave Benham</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: JSORT.BAT - Case sensitive sort with option for numeric</h3>
				<div class="date">Posted: <strong>22 Oct 2014 17:17</strong></div>
				<div class="author">by <strong>foxidrive</strong></div>
				<div class="content"><blockquote><div><cite>dbenham wrote:</cite>JSORT is much like MORE or SORT - it is perfectly reasonable to run the command without any arguments or options</div></blockquote><br /><br />Okelidokily.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: JSORT.BAT - Case sensitive sort with option for numeric </h3>
				<div class="date">Posted: <strong>05 Nov 2014 17:02</strong></div>
				<div class="author">by <strong>dbenham</strong></div>
				<div class="content">I saw another <a href="http://stackoverflow.com/q/26750360/1012053" class="postlink">StackOverflow question</a> that led me to add yet another feature to JSort.<br /><br />JSort now allows you to sort beginning at a given token position, rather than an absolute character position. The /T option specifies the token, and the /D option specifies the delimiter string (note - the delimiter can have length &gt; 1). The /P option now specifies the position relative to the start of the selected token, rather than from the beginning of the string. The default token is 1, so it does not change the behavior when /T is not specified.<br /><br />I also provide the option to specify the file to sort as the first argument, so you are no longer forced to use redirection or a pipe.<br /><br />So, if given file <strong class="text-strong">test.txt</strong>:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>goodbye,Z570<br />Hello world,A100<br />Ivanhoe,Z36<br />tiddleywinks,B36<br />Variable length text,A9<br /></code></pre></div><br />Then the following command:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>jsort test.txt /t 2 /d &quot;,&quot; /n<br /></code></pre></div><br />produces this output:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>Variable length text,A9<br />Hello world,A100<br />tiddleywinks,B36<br />Ivanhoe,Z36<br />goodbye,Z570<br /></code></pre></div><br /><br />Here is version 3.0<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@if (@X)==(@Y) @end /* Harmless hybrid line that begins a JScript comment<br /><br />::************ Documentation ***********<br />::JSORT.BAT version 3.0<br />:::<br />:::JSORT &#91;File&#93; &#91;/Option &#91;Value&#93;&#93;...<br />:::<br />:::&nbsp; Sort lines of text from stdin and write the result to stdout.<br />:::&nbsp; JSORT uses an ascending, case sensitive text sort by default.<br />:::<br />:::&nbsp; &nbsp; File - If the optional File argument is specified, then JSORT reads lines<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;from the file instead of from stdin. If specified, the File must<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;be the very first argument.<br />:::<br />:::&nbsp; Options:<br />:::<br />:::&nbsp; &nbsp; /C n - Number of sorted lines to print. Skipped lines are always printed<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;and do not contribute to the count. Default is -1 (all lines).<br />:::<br />:::&nbsp; &nbsp; /D string - Specifies the string used to delimit tokens. The delimiter<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;string is always case sensitive. A quote literal &quot; must be escaped<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;as \q, and a backslash literal \ must be escaped as \\.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;The default value is an empty string, meaning treat the entire<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;line as a single token.<br />:::<br />:::&nbsp; &nbsp; /I&nbsp; &nbsp;- Ignore case when sorting<br />:::<br />:::&nbsp; &nbsp; /N&nbsp; &nbsp;- Sort consecutive digits as numbers instead of text. The numbers<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;may be embedded within alpha text. JSort supports numbers up to<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;20 digits long.<br />:::<br />:::&nbsp; &nbsp; /P n - Begin sorting at character position n relative to the beginning<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;of the selected token. Lines that do not extend that far are<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;treated as equivalent values, and collate before all other lines.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;The default value is 1 (first character).<br />:::<br />:::&nbsp; &nbsp; /R&nbsp; &nbsp;- Sort the lines in Reverse (descending) order.<br />:::<br />:::&nbsp; &nbsp; /S n - Number of lines to skip - default is 0.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Skipped lines are not sorted (remain in place)<br />:::<br />:::&nbsp; &nbsp; /T n - Specify the token at which to begin sorting. The default value<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;is 1 (first token).<br />:::<br />:::&nbsp; &nbsp; /V&nbsp; &nbsp;- Display the version of JSORT.BAT.<br />:::<br />:::&nbsp; &nbsp; /?&nbsp; &nbsp;- Display this help<br />:::<br />:::JSORT.BAT was written by Dave Benham and originally posted at<br />:::http://www.dostips.com/forum/viewtopic.php?f=3&amp;t=5595<br />:::<br /><br />::************ Batch portion ***********<br />@echo off<br />setlocal disableDelayedExpansion<br /><br />:: Get optional input file<br />set &quot;redirect=&quot;<br />set &quot;file=%~1&quot;<br />setlocal enableDelayedExpansion<br />if defined file if &quot;!file:~0,1!&quot; neq &quot;/&quot; (<br />&nbsp; set &quot;redirect=&lt;&quot;!file!&quot;&quot;<br />&nbsp; shift /1<br />)<br /><br />:: Define options<br />set &quot;options= /?: /i: /c:-1 /n: /p:1 /r: /s:0 /v: /d:&quot;&quot; /t:1 &quot;<br /><br />:: Set default option values<br />for %%O in (%options%) do for /f &quot;tokens=1,* delims=:&quot; %%A in (&quot;%%O&quot;) do set &quot;%%A=%%~B&quot;<br /><br />:: Get options<br />:loop<br />if not &quot;%~1&quot;==&quot;&quot; (<br />&nbsp; set &quot;test=!options:* %~1:=! &quot;<br />&nbsp; if &quot;!test!&quot;==&quot;!options! &quot; (<br />&nbsp; &nbsp; &nbsp; &gt;&amp;2 echo Error: Invalid option %~1<br />&nbsp; &nbsp; &nbsp; exit /b 1<br />&nbsp; ) else if &quot;!test:~0,1!&quot;==&quot; &quot; (<br />&nbsp; &nbsp; &nbsp; set &quot;%~1=1&quot;<br />&nbsp; ) else (<br />&nbsp; &nbsp; &nbsp; set &quot;%~1=%~2&quot;<br />&nbsp; &nbsp; &nbsp; shift /1<br />&nbsp; )<br />&nbsp; shift /1<br />&nbsp; goto :loop<br />)<br /><br />:: Display help<br />if defined /? (<br />&nbsp; for /f &quot;delims=: tokens=*&quot; %%A in ('findstr &quot;^:::&quot; &quot;%~f0&quot;') do echo(%%A<br />&nbsp; exit /b 0<br />)<br /><br />:: Display version<br />if defined /v (<br />&nbsp; for /f &quot;delims=: tokens=*&quot; %%A in ('findstr /bc:&quot;::JSORT.BAT version&quot; &quot;%~f0&quot;') do echo %%A<br />&nbsp; exit /b 0<br />)<br /><br />:: Transform and validate options<br />set /a &quot;case=0%/i%, num=0%/n%, pos=%/p%-1, tok=%/t%-1, order=1-2*0%/r%, 1/^!(0x80000000&amp;pos), 1/^!(0x80000000&amp;tok)&quot; 2&gt;nul || (<br />&nbsp; &gt;&amp;2 echo Error: Invalid option value.<br />&nbsp; exit /b 1<br />)<br /><br />:: Perform the sort<br />%redirect% cscript //E:JScript //nologo &quot;%~f0&quot; %case% %num% %pos% %order% %/s% %/c% %tok% &quot;%/d%&quot;<br /><br />exit /b 0<br />************* JScript portion **********/<br />var array=new Array(),<br />&nbsp; &nbsp; nocase =WScript.Arguments.Item(0),<br />&nbsp; &nbsp; numeric=WScript.Arguments.Item(1),<br />&nbsp; &nbsp; pos&nbsp; &nbsp; =WScript.Arguments.Item(2),<br />&nbsp; &nbsp; order&nbsp; =WScript.Arguments.Item(3),<br />&nbsp; &nbsp; skip&nbsp; &nbsp;=WScript.Arguments.Item(4),<br />&nbsp; &nbsp; count&nbsp; =WScript.Arguments.Item(5),<br />&nbsp; &nbsp; token&nbsp; =WScript.Arguments.Item(6),<br />&nbsp; &nbsp; delim&nbsp; =WScript.Arguments.Item(7).replace(/\\(?!q|\\)/g,'').replace(/\\\\/g,'\\s').replace(/\\q/g,'&quot;').replace(/\\s/g,'\\');<br />while (!WScript.StdIn.AtEndOfStream) {<br />&nbsp; if (skip &gt; 0) {<br />&nbsp; &nbsp; WScript.Echo(WScript.StdIn.ReadLine());<br />&nbsp; &nbsp; skip-=1<br />&nbsp; } else {<br />&nbsp; &nbsp; var expanded=&quot;&quot;, num=&quot;&quot;, raw=WScript.StdIn.ReadLine(), upper=((nocase==1)?raw.toUpperCase():raw);<br />&nbsp; &nbsp; for( var i=pos+FindToken(raw,delim,token); i&lt;raw.length; i++ ) {<br />&nbsp; &nbsp; &nbsp; var c=upper.substr(i,1);<br />&nbsp; &nbsp; &nbsp; if (numeric==1 &amp;&amp; c&gt;=&quot;0&quot; &amp;&amp; c&lt;=&quot;9&quot;) {<br />&nbsp; &nbsp; &nbsp; &nbsp; num+=c;<br />&nbsp; &nbsp; &nbsp; } else {<br />&nbsp; &nbsp; &nbsp; &nbsp; if (num != &quot;&quot;) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; num=&quot;00000000000000000000&quot; + num;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; expanded+=num.substr(num.length-20);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; num=&quot;&quot;;<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; expanded+=c;<br />&nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; if (num != &quot;&quot;) {<br />&nbsp; &nbsp; &nbsp; num=&quot;00000000000000000000&quot; + num;<br />&nbsp; &nbsp; &nbsp; expanded+=num.substr(num.length-20);<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; var obj={expanded:expanded, raw:raw};<br />&nbsp; &nbsp; array.push(obj);<br />&nbsp; }<br />}<br />if (count&lt;0) count=array.length;<br />if (count&gt;array.length) count=array.length;<br />array.sort(function(a,b){return order*((a.expanded&gt;b.expanded)-(a.expanded&lt;b.expanded));});<br />for (var i=0; i&lt;count; i++) WScript.Echo(array&#91;i&#93;.raw);<br /><br />function FindToken(str, str2, n) {<br />&nbsp; if (n&gt;0 &amp;&amp; str2==&quot;&quot;) return str.length;<br />&nbsp; var rtn = 0;<br />&nbsp; for( var i=n; i&gt;0; i-- ) {<br />&nbsp; &nbsp; rtn = str.indexOf(str2,rtn);<br />&nbsp; &nbsp; if (rtn&lt;0) return str.length;<br />&nbsp; &nbsp; rtn+=str2.length;<br />&nbsp; }<br />&nbsp; return rtn;<br />}<br /></code></pre></div><br /><br />Dave Benham</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: JSORT.BAT - Case sensitive sort with option for numeric </h3>
				<div class="date">Posted: <strong>05 Nov 2014 19:49</strong></div>
				<div class="author">by <strong>Squashman</strong></div>
				<div class="content">Sweet! I am definitely going to use that option. <br />Just wondering if jsort would run faster if you could specify the output filename instead of redirecting stdout? Similar to the built in sort utility.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: JSORT.BAT - Case sensitive sort with option for numeric</h3>
				<div class="date">Posted: <strong>06 Nov 2014 11:02</strong></div>
				<div class="author">by <strong>dbenham</strong></div>
				<div class="content">Perhaps there is a small performance gain to be had, but I'm lazy  <img class="smilies" src="images/smilies/icon_mrgreen.gif" alt=":mrgreen:" title="Mr. Green" /> <br /><br />As I said earlier, I've done very little to optimize the JScript code. It works fine for the small tasks that I've used it for, but it may not perform well with very large files. Given that the JScript loads the entire file in memory (twice over!), I suspect that the utility will completely fail at some size threshold.<br /><br />I've implemented an /O option to specify the output file in lieu of using redirection. However, I took the easy way out and perform redirection within the batch code, so there is no performance benefit to using /O.<br /><br />Version 3.2 also fixes a bug with the File argument implementation. Version 3.0 failed if the file path included an exclamation point (!). (Version 3.1 had major argument parsing bugs)<br /><br /><strong class="text-strong">Version 3.2</strong><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@if (@X)==(@Y) @end /* Harmless hybrid line that begins a JScript comment<br /><br />::************ Documentation ***********<br />::JSORT.BAT version 3.2<br />:::<br />:::JSORT &#91;File&#93; &#91;/Option &#91;Value&#93;&#93;...<br />:::<br />:::&nbsp; Sort lines of text from stdin and write the result to stdout.<br />:::&nbsp; JSORT uses an ascending, case sensitive text sort by default.<br />:::<br />:::&nbsp; &nbsp; File - If the optional File argument is specified, then JSORT reads lines<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;from the file instead of from stdin. If specified, the File must<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;be the very first argument.<br />:::<br />:::&nbsp; Options:<br />:::<br />:::&nbsp; &nbsp; /C n - Number of sorted lines to print. Skipped lines are always printed<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;and do not contribute to the count. Default is -1 (all lines).<br />:::<br />:::&nbsp; &nbsp; /D String - Specifies the string used to delimit tokens. The delimiter<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;string is always case sensitive. A quote literal &quot; must be escaped<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;as \q, and a backslash literal \ must be escaped as \\.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;The default value is an empty string, meaning treat the entire<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;line as a single token.<br />:::<br />:::&nbsp; &nbsp; /I&nbsp; &nbsp;- Ignore case when sorting<br />:::<br />:::&nbsp; &nbsp; /N&nbsp; &nbsp;- Sort consecutive digits as numbers instead of text. The numbers<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;may be embedded within alpha text. JSort supports numbers up to<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;20 digits long.<br />:::<br />:::&nbsp; &nbsp; /O File - Writes the output to File instead of stdout.<br />:::<br />:::&nbsp; &nbsp; /P n - Begin sorting at character position n relative to the beginning<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;of the selected token. Lines that do not extend that far are<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;treated as equivalent values, and collate before all other lines.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;The default value is 1 (first character).<br />:::<br />:::&nbsp; &nbsp; /R&nbsp; &nbsp;- Sort the lines in Reverse (descending) order.<br />:::<br />:::&nbsp; &nbsp; /S n - Number of lines to skip - default is 0.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Skipped lines are not sorted (remain in place)<br />:::<br />:::&nbsp; &nbsp; /T n - Specify the token at which to begin sorting. The default value<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;is 1 (first token).<br />:::<br />:::&nbsp; &nbsp; /V&nbsp; &nbsp;- Display the version of JSORT.BAT.<br />:::<br />:::&nbsp; &nbsp; /?&nbsp; &nbsp;- Display this help<br />:::<br />:::JSORT.BAT was written by Dave Benham and originally posted at<br />:::http://www.dostips.com/forum/viewtopic.php?f=3&amp;t=5595<br />:::<br /><br />::************ Batch portion ***********<br />@echo off<br />setlocal disableDelayedExpansion<br /><br />:: Get optional input file<br />set &quot;infile=&quot;<br />set &quot;test=%~1&quot;<br />setlocal enableDelayedExpansion<br />if defined test if &quot;!test:~0,1!&quot; neq &quot;/&quot; (<br />&nbsp; endlocal<br />&nbsp; set ^&quot;infile=^&lt;&quot;%~1&quot;&quot;<br />&nbsp; shift /1<br />) else endlocal<br /><br />:: Define options<br />set &quot;options= /?: /i: /c:-1 /n: /p:1 /r: /s:0 /v: /d:&quot;&quot; /t:1 /o:&quot;&quot; &quot;<br /><br />:: Set default option values<br />for %%O in (%options%) do for /f &quot;tokens=1,* delims=:&quot; %%A in (&quot;%%O&quot;) do set &quot;%%A=%%~B&quot;<br /><br />:: Get options<br />:loop<br />if not &quot;%~1&quot;==&quot;&quot; (<br />&nbsp; setlocal enableDelayedExpansion<br />&nbsp; set &quot;test=!options:* %~1:=! &quot;<br />&nbsp; if &quot;!test!&quot;==&quot;!options! &quot; (<br />&nbsp; &nbsp; &nbsp; &gt;&amp;2 echo Error: Invalid option %~1<br />&nbsp; &nbsp; &nbsp; exit /b 1<br />&nbsp; ) else if &quot;!test:~0,1!&quot;==&quot; &quot; (<br />&nbsp; &nbsp; &nbsp; endlocal<br />&nbsp; &nbsp; &nbsp; set &quot;%~1=1&quot;<br />&nbsp; ) else (<br />&nbsp; &nbsp; &nbsp; endlocal<br />&nbsp; &nbsp; &nbsp; set &quot;%~1=%~2&quot;<br />&nbsp; &nbsp; &nbsp; shift /1<br />&nbsp; )<br />&nbsp; shift /1<br />&nbsp; goto :loop<br />)<br /><br />:: Display help<br />if defined /? (<br />&nbsp; for /f &quot;delims=: tokens=*&quot; %%A in ('findstr &quot;^:::&quot; &quot;%~f0&quot;') do echo(%%A<br />&nbsp; exit /b 0<br />)<br /><br />:: Display version<br />if defined /v (<br />&nbsp; for /f &quot;delims=: tokens=*&quot; %%A in ('findstr /bc:&quot;::JSORT.BAT version&quot; &quot;%~f0&quot;') do echo %%A<br />&nbsp; exit /b 0<br />)<br /><br />:: Transform and validate options<br />set /a &quot;case=0%/i%, num=0%/n%, pos=%/p%-1, tok=%/t%-1, order=1-2*0%/r%, 1/!(0x80000000&amp;pos), 1/!(0x80000000&amp;tok)&quot; 2&gt;nul || (<br />&nbsp; &gt;&amp;2 echo Error: Invalid option value.<br />&nbsp; exit /b 1<br />)<br />set &quot;outfile=&quot;<br />if defined /o set ^&quot;outfile=^&gt;&quot;%/o%&quot;&quot;<br /><br />:: Perform the sort<br />%infile% %outfile% cscript //E:JScript //nologo &quot;%~f0&quot; %case% %num% %pos% %order% %/s% %/c% %tok% &quot;%/d%&quot;<br /><br />exit /b 0<br />************* JScript portion **********/<br />var array=new Array(),<br />&nbsp; &nbsp; nocase =WScript.Arguments.Item(0),<br />&nbsp; &nbsp; numeric=WScript.Arguments.Item(1),<br />&nbsp; &nbsp; pos&nbsp; &nbsp; =WScript.Arguments.Item(2),<br />&nbsp; &nbsp; order&nbsp; =WScript.Arguments.Item(3),<br />&nbsp; &nbsp; skip&nbsp; &nbsp;=WScript.Arguments.Item(4),<br />&nbsp; &nbsp; count&nbsp; =WScript.Arguments.Item(5),<br />&nbsp; &nbsp; token&nbsp; =WScript.Arguments.Item(6),<br />&nbsp; &nbsp; delim&nbsp; =WScript.Arguments.Item(7).replace(/\\(?!q|\\)/g,'').replace(/\\\\/g,'\\s').replace(/\\q/g,'&quot;').replace(/\\s/g,'\\');<br />while (!WScript.StdIn.AtEndOfStream) {<br />&nbsp; if (skip &gt; 0) {<br />&nbsp; &nbsp; WScript.Echo(WScript.StdIn.ReadLine());<br />&nbsp; &nbsp; skip-=1<br />&nbsp; } else {<br />&nbsp; &nbsp; var expanded=&quot;&quot;, num=&quot;&quot;, raw=WScript.StdIn.ReadLine(), upper=((nocase==1)?raw.toUpperCase():raw);<br />&nbsp; &nbsp; for( var i=pos+FindToken(raw,delim,token); i&lt;raw.length; i++ ) {<br />&nbsp; &nbsp; &nbsp; var c=upper.substr(i,1);<br />&nbsp; &nbsp; &nbsp; if (numeric==1 &amp;&amp; c&gt;=&quot;0&quot; &amp;&amp; c&lt;=&quot;9&quot;) {<br />&nbsp; &nbsp; &nbsp; &nbsp; num+=c;<br />&nbsp; &nbsp; &nbsp; } else {<br />&nbsp; &nbsp; &nbsp; &nbsp; if (num != &quot;&quot;) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; num=&quot;00000000000000000000&quot; + num;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; expanded+=num.substr(num.length-20);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; num=&quot;&quot;;<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; expanded+=c;<br />&nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; if (num != &quot;&quot;) {<br />&nbsp; &nbsp; &nbsp; num=&quot;00000000000000000000&quot; + num;<br />&nbsp; &nbsp; &nbsp; expanded+=num.substr(num.length-20);<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; var obj={expanded:expanded, raw:raw};<br />&nbsp; &nbsp; array.push(obj);<br />&nbsp; }<br />}<br />if (count&lt;0) count=array.length;<br />if (count&gt;array.length) count=array.length;<br />array.sort(function(a,b){return order*((a.expanded&gt;b.expanded)-(a.expanded&lt;b.expanded));});<br />for (var i=0; i&lt;count; i++) WScript.Echo(array&#91;i&#93;.raw);<br /><br />function FindToken(str, str2, n) {<br />&nbsp; if (n&gt;0 &amp;&amp; str2==&quot;&quot;) return str.length;<br />&nbsp; var rtn = 0;<br />&nbsp; for( var i=n; i&gt;0; i-- ) {<br />&nbsp; &nbsp; rtn = str.indexOf(str2,rtn);<br />&nbsp; &nbsp; if (rtn&lt;0) return str.length;<br />&nbsp; &nbsp; rtn+=str2.length;<br />&nbsp; }<br />&nbsp; return rtn;<br />}<br /></code></pre></div><br /><br />Dave Benham</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: JSORT.BAT - Case sensitive sort with option for numeric </h3>
				<div class="date">Posted: <strong>06 Nov 2014 11:39</strong></div>
				<div class="author">by <strong>Squashman</strong></div>
				<div class="content">Well then maybe that won't work for me then.  I mostly work with very large files.  Hundreds of megabytes and sometimes a gigabyte or two.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: JSORT.BAT - Case sensitive sort with option for numeric </h3>
				<div class="date">Posted: <strong>06 Nov 2014 12:40</strong></div>
				<div class="author">by <strong>dbenham</strong></div>
				<div class="content">Can you give a large file a try and report back <img class="smilies" src="images/smilies/icon_question.gif" alt=":?:" title="Question" /> I'm curious.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: JSORT.BAT - Case sensitive sort with option for numeric</h3>
				<div class="date">Posted: <strong>06 Nov 2014 12:44</strong></div>
				<div class="author">by <strong>Squashman</strong></div>
				<div class="content"><blockquote><div><cite>dbenham wrote:</cite>Can you give a large file a try and report back <img class="smilies" src="images/smilies/icon_question.gif" alt=":?:" title="Question" /> I'm curious.</div></blockquote><br />I will put it on my todo list.  Been putting out fires every day this week.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: JSORT.BAT - Case sensitive sort with option for numeric </h3>
				<div class="date">Posted: <strong>06 Nov 2014 13:35</strong></div>
				<div class="author">by <strong>dbenham</strong></div>
				<div class="content">Updated prior post to version 3.2.<br /><br />Version 3.1 had major argument parsing bugs <img class="smilies" src="images/smilies/icon_redface.gif" alt=":oops:" title="Embarassed" /></div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: JSORT.BAT - Case sensitive sort with option for numeric </h3>
				<div class="date">Posted: <strong>06 Nov 2014 14:09</strong></div>
				<div class="author">by <strong>dbenham</strong></div>
				<div class="content">I successfully sorted a ~15 mb file in 64 seconds.<br /><br />I attempted to sort a ~30 mb file and it failed with an &quot;Out of memory&quot; error.  <img class="smilies" src="images/smilies/icon_evil.gif" alt=":evil:" title="Evil or Very Mad" /> <br /><br />So it looks like this utility is no good for large files - Sorry Squashman  <img class="smilies" src="images/smilies/icon_sad.gif" alt=":(" title="Sad" /></div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: JSORT.BAT - Case sensitive sort with option for numeric</h3>
				<div class="date">Posted: <strong>06 Nov 2014 14:24</strong></div>
				<div class="author">by <strong>Squashman</strong></div>
				<div class="content"><blockquote><div><cite>dbenham wrote:</cite>I successfully sorted a ~15 mb file in 64 seconds.<br /><br />I attempted to sort a ~30 mb file and it failed with an &quot;Out of memory&quot; error.  <img class="smilies" src="images/smilies/icon_evil.gif" alt=":evil:" title="Evil or Very Mad" /> <br /><br />So it looks like this utility is no good for large files - Sorry Squashman  <img class="smilies" src="images/smilies/icon_sad.gif" alt=":(" title="Sad" /></div></blockquote><br /><br />How much ram do you have?<br /><br />I know when I only had 1GB of ram on my computer I had issues reading large files with FOR /F because it also loads the whole file into memory first.  I could usually process about a 600 MB file.  Now I have a 4GB and can run larger files but is still pretty slow.</div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="UTC-6">UTC-06:00</span><br />Page <strong>1</strong> of <strong>4</strong></div>
		<div class="copyright">Powered by phpBB&reg; Forum Software &copy; phpBB Limited<br />https://www.phpbb.com/</div>
	</div>
</div>

</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=5595&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 06:45:25 GMT -->
</html>
