<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=7625 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 08:11:57 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>How to speed up a batch script - DosTips.com</title>


	<link rel="canonical" href="viewtopic3342.html?t=7625">

<!--
	phpBB style name: Allan Style - SUBSILVER
	Based on style:   prosilver (this is the default phpBB3 style)
	Based on style:   subsilver2 (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:  Allan ( http://x-tk.ru/ )
-->

<link href="assets/css/font-awesome.mind772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/stylesheetd772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/en/stylesheetd772.css?assets_version=34" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="./styles/AllanStyle-SUBSILVER/theme/tweaks.css?assets_version=34" rel="stylesheet">
<![endif]-->




<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','../../www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-280191-1', 'auto');
	ga('send', 'pageview');
</script>

</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">

<div id="header-subsilver">
	<a id="top" class="top-anchor" accesskey="t"></a>
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description" class="site-description">
				<a id="logo" class="logo" href="../index.html" title="DosTips.com"><span class="site_logo"></span></a>
				<h1>DosTips.com</h1>
				<p>A Forum all about DOS Batch</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

									<div id="search-box" class="search-box search-header" role="search">
				<form action="https://www.dostips.com/forum/search.php" method="get" id="search">
				<fieldset>
					<input name="keywords" id="keywords" type="search" maxlength="128" title="Search for keywords" class="inputbox search tiny" size="20" value="" placeholder="Search…" />
					<button class="button button-search" type="submit" title="Search">
						<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
					</button>
					<a href="search.html" class="button button-search-end" title="Advanced search">
						<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
					</a>
					
				</fieldset>
				</form>
			</div>
						
			</div>
					</div>
</div>


<div id="wrap" class="wrap">
	<div id="page-header">
				<div class="navbar-top" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
																									<li>
								<a href="search33a7.html?search_id=unanswered" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="search526f.html?search_id=active_topics" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-blue" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="search.html" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
											<li class="separator"></li>
																			<li>
								<a href="memberlist4bfd.html?mode=team" role="menuitem">
									<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
								</a>
							</li>
																<li class="separator"></li>

									</ul>
			</div>
		</li>

				<li data-skip-responsive="true">
			<a href="app.php/help/faq.html" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
						
			<li class="rightside"  data-skip-responsive="true">
			<a href="ucp26c3.html?mode=login" title="Login" accesskey="x" role="menuitem">
				<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Login</span>
			</a>
		</li>
					<li class="rightside" data-skip-responsive="true">
				<a href="ucp8319.html?mode=register" role="menuitem">
					<i class="icon fa-pencil-square-o  fa-fw" aria-hidden="true"></i><span>Register</span>
				</a>
			</li>
						</ul>

	</div>
</div>

<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
						<li class="breadcrumbs">
							<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="../index.html" itemprop="url" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span itemprop="title">DosTips.com</span></a></span>
										<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="index.html" itemprop="url" accesskey="h" data-navbar-reference="index"><span itemprop="title">Board index</span></a></span>

											<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="4"><a href="viewforum31e6.html?f=4" itemprop="url"><span itemprop="title">DosTips - Dos Batch</span></a></span>
															<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="3"><a href="viewforum4d6b.html?f=3" itemprop="url"><span itemprop="title">DOS Batch Forum</span></a></span>
												</li>
		
					<li class="rightside responsive-search">
				<a href="search.html" title="View the advanced search options" role="menuitem">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</a>
			</li>
			</ul>

	</div>
</div>

<div class="navbar-top-link">
	<div class="inner">
		<ul>
			<li class="navbar-top-link-left"><a href="search33a7.html?search_id=unanswered">Unanswered topics</a></li>
			<li class="navbar-top-link-left"><a href="search526f.html?search_id=active_topics">Active topics</a></li>

											</ul>
	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
		
<h2 class="topic-title"><a href="viewtopic4aff.html?f=3&amp;t=7625">How to speed up a batch script</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">Discussion forum for all Windows batch related topics.<br /></div>
<p>
	<strong>Moderator:</strong> <a href="memberlista6a8.html?mode=viewprofile&amp;u=5" class="username">DosItHelp</a>
</p>


<div class="action-bar bar-top">
	
			<a href="postingc8e6-2.html?mode=reply&amp;f=3&amp;t=7625" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic3248-2.html?f=3&amp;t=7625&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="https://www.dostips.com/forum/search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topic…" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="search.html" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="7625" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			17 posts
							<ul>
		<li class="active"><span>1</span></li>
				<li><a class="button" href="viewtopicb928.html?f=3&amp;t=7625&amp;start=15" role="button">2</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopicb928.html?f=3&amp;t=7625&amp;start=15" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
		</div>




<div id="subsilver-nav-topic">
	<div class="inner"><div class="post has-profile">
		<div class="leftsided postbody subsilver-topic-title">Message</div>
		<div class="leftsided postprofile subsilver-topic-author">Author</div>
	</div></div>
</div>

			<div id="p50627" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile50627">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist9f07.html?mode=viewprofile&amp;u=8551" class="username">Sounak@9434</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchcd7e.html?author_id=8551&amp;sr=posts">100</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 16 Dec 2016 22:31</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content50627">

						<h3 class="first"><a href="#p50627">How to speed up a batch script</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinga7e8.html?mode=quote&amp;f=3&amp;p=50627" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicd637.html?p=50627#p50627" onclick="prompt('Message #1',this.href); return false;">#1</a></span> 
									<a class="unread" href="viewtopicd637.html?p=50627#p50627" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist9f07.html?mode=viewprofile&amp;u=8551" class="username">Sounak@9434</a></strong> &raquo; </span>22 Dec 2016 09:22
			</p>
			
			
			
			<div class="content">Okay, keeping small thing small,<br />the title says it all (hey that rhymes <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" />)<br />Anyway, I want to know how to speed up any batch file.<br />I know that the way of approaching the final motive matters a lot and each batch file is different(blah blah blah).<br />For my problem at first I searched in the internet and found some webpages but mostly they are telling about a specific script so I thought about asking here.<br />I want to know how to speed up any individual batch files. Like using this command instead of that. Or using this command in this way instead of that. Or using this tool instead of that etc.<br /><br />Thanks in advance.</div>

			
													<div class="notice">
					Last edited by <a href="memberlist9f07.html?mode=viewprofile&amp;u=8551" class="username">Sounak@9434</a> on 26 Dec 2016 05:52, edited 1 time in total.
									</div>
			
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50628" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile50628">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistae17.html?mode=viewprofile&amp;u=8553" class="username">TSnake41</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search656c.html?author_id=8553&amp;sr=posts">11</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 17 Dec 2016 12:49</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content50628">

						<h3 ><a href="#p50628">Re: How to speed up a batch script</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingebe6.html?mode=quote&amp;f=3&amp;p=50628" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopiccb69.html?p=50628#p50628" onclick="prompt('Message #2',this.href); return false;">#2</a></span> 
									<a class="unread" href="viewtopiccb69.html?p=50628#p50628" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistae17.html?mode=viewprofile&amp;u=8553" class="username">TSnake41</a></strong> &raquo; </span>22 Dec 2016 10:51
			</p>
			
			
			
			<div class="content">The speed of a batch script mostly depend of cmd.exe/csrss.exe, and a little of the batch script itself.<br /><br />So, alternatives cmd.exe are very rare and rarely used but you can give a try to Dos9 : <!-- l --><a class="postlink-local" href="viewtopice698.html?f=3&amp;t=5538">viewtopic.php?f=3&amp;t=5538</a><!-- l --> (if you can, build from source to get new features and fixes like pushd/popd)</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50629" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile50629">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search661c.html?author_id=1265&amp;sr=posts">3386</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 22 Jan 2010 18:01</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content50629">

						<h3 ><a href="#p50629">Re: How to speed up a batch script</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingd0be.html?mode=quote&amp;f=3&amp;p=50629" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicb4f3.html?p=50629#p50629" onclick="prompt('Message #3',this.href); return false;">#3</a></span> 
									<a class="unread" href="viewtopicb4f3.html?p=50629#p50629" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a></strong> &raquo; </span>22 Dec 2016 11:17
			</p>
			
			
			
			<div class="content">Batch is slow by design. The main reason is that half of the commands are external utilities. That means as soon as you call such a tool a new process has to be scheduled by the operating system. That takes a lot of time, especially if you call it umpteen times from within a loop. Whenever you have the choice use an internal command rather than an external. I wrote a little batch code that computes the commands outputted by the HELP command and displays whether they are internal functions of cmd.exe or external utilities.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off &amp;setlocal EnableDelayedExpansion<br />set /a int=0, ext=0<br />for /f %%i in ('help^|findstr /rbc:&quot;&#91;A-Z&#93;&#91;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#93;&quot;') do (<br />&nbsp; for /f &quot;tokens=1,2 delims=?&quot; %%j in (&quot;%%i.exe?%%i.com&quot;) do (<br />&nbsp; &nbsp; if &quot;%%~$PATH:j%%~$PATH:k&quot;==&quot;&quot; (<br />&nbsp; &nbsp; &nbsp; set /a int+=1<br />&nbsp; &nbsp; &nbsp; set &quot;line=%%i&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;<br />&nbsp; &nbsp; &nbsp; echo !line:~,50! - internal<br />&nbsp; &nbsp; ) else (<br />&nbsp; &nbsp; &nbsp; set /a ext+=1<br />&nbsp; &nbsp; &nbsp; echo %%i &quot;%%~$PATH:j%%~$PATH:k&quot;<br />&nbsp; &nbsp; )<br />&nbsp; )<br />)<br /><br />echo(<br />echo internal %int%<br />echo external %ext%<br />pause&gt;nul<br /></code></pre></div><br /><br /><br />We had some discussions in the past how to speed up the start of external tools. E.g. normally you would simply write FINDSTR to call C:\Windows\System32\findstr.exe. That means the process has to search the tool using two variables. 1) the directories saved in %PATH% and 2) the file extension saved in %PATHEXT%. That takes time. Instead you could empty these variables and call the tools by their full name.<br /><br /><br />Avoid using GOTO LABEL or CALL :LABEL if you can use a FOR (/L) loop instead. Labels have to be searched in the batch file. The order is top to down. It resumes searching at the top of the file if the end was reached without finding it. The longer the file the more time it takes.<br /><br /><br />But generally spoken: If you have a performance-critical task then don't use batch and prefer compiled languages over interpreted languages.<br /><br /><br />Steffen</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50630" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile50630">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist8beb.html?mode=viewprofile&amp;u=5056" class="username">ShadowThief</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search9642.html?author_id=5056&amp;sr=posts">853</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 06 Sep 2013 21:28</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Virginia, United States</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content50630">

						<h3 ><a href="#p50630">Re: How to speed up a batch script</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinge76b.html?mode=quote&amp;f=3&amp;p=50630" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic452e.html?p=50630#p50630" onclick="prompt('Message #4',this.href); return false;">#4</a></span> 
									<a class="unread" href="viewtopic452e.html?p=50630#p50630" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist8beb.html?mode=viewprofile&amp;u=5056" class="username">ShadowThief</a></strong> &raquo; </span>22 Dec 2016 11:40
			</p>
			
			
			
			<div class="content">It <em class="text-italics">really</em> depends on your existing code; it's not like in VBA where you can say Application.ScreenUpdating=False and the whole thing speeds up by 90%.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50654" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile50654">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist9f07.html?mode=viewprofile&amp;u=8551" class="username">Sounak@9434</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchcd7e.html?author_id=8551&amp;sr=posts">100</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 16 Dec 2016 22:31</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content50654">

						<h3 ><a href="#p50654">Re: How to speed up a batch script</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting28cd.html?mode=quote&amp;f=3&amp;p=50654" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopice6aa-2.html?p=50654#p50654" onclick="prompt('Message #5',this.href); return false;">#5</a></span> 
									<a class="unread" href="viewtopice6aa-2.html?p=50654#p50654" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist9f07.html?mode=viewprofile&amp;u=8551" class="username">Sounak@9434</a></strong> &raquo; </span>26 Dec 2016 06:06
			</p>
			
			
			
			<div class="content">I have used for (/l) in batch scripts  to trigger loops and also somehow found a way to trigger endless loop. <div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>for /l %%a in (1,0,2) do (%command%)</code></pre></div><br />but I was unable to break out of a for loop. Seems like goto label or exit /b does not works inside a for loop.<br />Any ideas anyone?</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50655" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile50655">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search661c.html?author_id=1265&amp;sr=posts">3386</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 22 Jan 2010 18:01</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content50655">

						<h3 ><a href="#p50655">Re: How to speed up a batch script</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting0551.html?mode=quote&amp;f=3&amp;p=50655" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic85d9.html?p=50655#p50655" onclick="prompt('Message #6',this.href); return false;">#6</a></span> 
									<a class="unread" href="viewtopic85d9.html?p=50655#p50655" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a></strong> &raquo; </span>26 Dec 2016 06:50
			</p>
			
			
			
			<div class="content">You can simplify the infinite loop using an empty pair of parentheses.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>for /l %%i in () do ...</code></pre></div><br />However you still can't break the FOR /L loop. The only way is using EXIT which will quit the batch execution. You could run another process if you want to use this method (takes time to load the process etc...) or you have to use GOTO to perform the loop.<br />See this discussion:<br /><!-- l --><a class="postlink-local" href="viewtopic2d6b.html?t=2707">viewtopic.php?t=2707</a><!-- l --><br /><br />Steffen</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50658" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile50658">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist9f07.html?mode=viewprofile&amp;u=8551" class="username">Sounak@9434</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchcd7e.html?author_id=8551&amp;sr=posts">100</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 16 Dec 2016 22:31</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content50658">

						<h3 ><a href="#p50658">Re: How to speed up a batch script</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting21f9.html?mode=quote&amp;f=3&amp;p=50658" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic772b.html?p=50658#p50658" onclick="prompt('Message #7',this.href); return false;">#7</a></span> 
									<a class="unread" href="viewtopic772b.html?p=50658#p50658" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist9f07.html?mode=viewprofile&amp;u=8551" class="username">Sounak@9434</a></strong> &raquo; </span>26 Dec 2016 07:11
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>aGerman wrote:</cite>You can simplify the infinite loop using an empty pair of parentheses.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>for /l %%i in () do ...</code></pre></div><br />However you still can't break the FOR /L loop. The only way is using EXIT which will quit the batch execution. You could run another process if you want to use this method (takes time to load the process etc...) or you have to use GOTO to perform the loop.<br />See this discussion:<br /><!-- l --><a class="postlink-local" href="viewtopic2d6b.html?t=2707">viewtopic.php?t=2707</a><!-- l --><br /><br />Steffen</div></blockquote><br />Thanks Steffen but it does not actually solves my problem. I wanted a for loop because it's faster than goto but if it needs creating a seperate process it's definitely gonna be slower. Gotta find another way to achive this.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50659" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile50659">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search661c.html?author_id=1265&amp;sr=posts">3386</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 22 Jan 2010 18:01</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content50659">

						<h3 ><a href="#p50659">Re: How to speed up a batch script</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingb080-2.html?mode=quote&amp;f=3&amp;p=50659" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic78d9.html?p=50659#p50659" onclick="prompt('Message #8',this.href); return false;">#8</a></span> 
									<a class="unread" href="viewtopic78d9.html?p=50659#p50659" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a></strong> &raquo; </span>26 Dec 2016 07:21
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>Sounak@9434 wrote:</cite>Gotta find another way to achive this.</div></blockquote><br />Good luck.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50665" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile50665">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist9f07.html?mode=viewprofile&amp;u=8551" class="username">Sounak@9434</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchcd7e.html?author_id=8551&amp;sr=posts">100</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 16 Dec 2016 22:31</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content50665">

						<h3 ><a href="#p50665">Re: How to speed up a batch script</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting1493.html?mode=quote&amp;f=3&amp;p=50665" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic1880.html?p=50665#p50665" onclick="prompt('Message #9',this.href); return false;">#9</a></span> 
									<a class="unread" href="viewtopic1880.html?p=50665#p50665" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist9f07.html?mode=viewprofile&amp;u=8551" class="username">Sounak@9434</a></strong> &raquo; </span>27 Dec 2016 09:41
			</p>
			
			
			
			<div class="content">O.k. So after googling for hours I found that that there is no way to break an infinite for loop. Indirectly we can use a while macro.<br />But theoritically speaking which one should be faster on avarage Aacini's while macro or a goto :label loop?</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50667" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile50667">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search661c.html?author_id=1265&amp;sr=posts">3386</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 22 Jan 2010 18:01</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content50667">

						<h3 ><a href="#p50667">Re: How to speed up a batch script</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting789e.html?mode=quote&amp;f=3&amp;p=50667" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicd6e1.html?p=50667#p50667" onclick="prompt('Message #10',this.href); return false;">#10</a></span> 
									<a class="unread" href="viewtopicd6e1.html?p=50667#p50667" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a></strong> &raquo; </span>27 Dec 2016 16:37
			</p>
			
			
			
			<div class="content">As I said, the larger the script the longer does it take to find the label. Just do some tests to figure out which is faster in your case.<br /><br />Steffen</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50671" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile50671">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist54f1.html?mode=viewprofile&amp;u=8229" class="username">misol101</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha06d.html?author_id=8229&amp;sr=posts">356</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 02 May 2016 18:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content50671">

						<h3 ><a href="#p50671">Re: How to speed up a batch script</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingfcfb.html?mode=quote&amp;f=3&amp;p=50671" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic6a65.html?p=50671#p50671" onclick="prompt('Message #11',this.href); return false;">#11</a></span> 
									<a class="unread" href="viewtopic6a65.html?p=50671#p50671" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist54f1.html?mode=viewprofile&amp;u=8229" class="username">misol101</a></strong> &raquo; </span>28 Dec 2016 05:29
			</p>
			
			
			
			<div class="content">Sounak: Did you try the variant I used in some of the scripts I posted recently? The structure is:<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>(set STOP=)<br />:LOOP<br />for /L %%1 in (1,1,300) do if not defined STOP (<br />...<br />(IF stopcondition set STOP=1)<br />)<br />IF not defined STOP goto LOOP<br /></code></pre></div><br /><br />So as you can see the for loop itself is not infinite, But there is only one goto per 300 loops (or as many as you choose).<br /><br />I think einstein1969 posted this first.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50672" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile50672">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist9f07.html?mode=viewprofile&amp;u=8551" class="username">Sounak@9434</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchcd7e.html?author_id=8551&amp;sr=posts">100</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 16 Dec 2016 22:31</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content50672">

						<h3 ><a href="#p50672">Re: How to speed up a batch script</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting955e-2.html?mode=quote&amp;f=3&amp;p=50672" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicf875.html?p=50672#p50672" onclick="prompt('Message #12',this.href); return false;">#12</a></span> 
									<a class="unread" href="viewtopicf875.html?p=50672#p50672" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist9f07.html?mode=viewprofile&amp;u=8551" class="username">Sounak@9434</a></strong> &raquo; </span>28 Dec 2016 06:02
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>misol101 wrote:</cite>Sounak: Did you try the variant I used in some of the scripts I posted recently? The structure is:<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>(set STOP=)<br />:LOOP<br />for /L %%1 in (1,1,300) do if not defined STOP (<br />...<br />(IF stopcondition set STOP=1)<br />)<br />IF not defined STOP goto LOOP<br /></code></pre></div><br /><br />So as you can see the for loop itself is not infinite, But there is only one goto per 300 loops (or as many as you choose).<br /><br />I think einstein1969 posted this first.</div></blockquote><br />I have seen one made by jeb that uses goto:eof<br />I don't quite know if goto:eof is slower than regular goto label but surely your answer is useful.<br />Gonna give it a try too.  <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50688" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile50688">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist14d6.html?mode=viewprofile&amp;u=6377" class="username">NunoLava1998</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search0ce1.html?author_id=6377&amp;sr=posts">10</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 01 Mar 2015 10:06</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content50688">

						<h3 ><a href="#p50688">Re: How to speed up a batch script</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting6b09.html?mode=quote&amp;f=3&amp;p=50688" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopice8f6.html?p=50688#p50688" onclick="prompt('Message #13',this.href); return false;">#13</a></span> 
									<a class="unread" href="viewtopice8f6.html?p=50688#p50688" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist14d6.html?mode=viewprofile&amp;u=6377" class="username">NunoLava1998</a></strong> &raquo; </span>30 Dec 2016 04:34
			</p>
			
			
			
			<div class="content">As of i know, a single batch command takes exactly 1 millisecond to execute.<br /><br />This is proven when you do:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>echo 1<br />echo 2<br />echo 3<br />...<br />echo 999<br />echo 1000</code></pre></div><br />that it takes 1 second to finish.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50689" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile50689">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search661c.html?author_id=1265&amp;sr=posts">3386</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 22 Jan 2010 18:01</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content50689">

						<h3 ><a href="#p50689">Re: How to speed up a batch script</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinga81c.html?mode=quote&amp;f=3&amp;p=50689" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic4a80.html?p=50689#p50689" onclick="prompt('Message #14',this.href); return false;">#14</a></span> 
									<a class="unread" href="viewtopic4a80.html?p=50689#p50689" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a></strong> &raquo; </span>30 Dec 2016 05:25
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>NunoLava1998 wrote:</cite>As of i know, a single batch command takes exactly 1 millisecond to execute.</div></blockquote><br />No. Try<br /><em class="text-italics">&gt;nul echo 1</em><br />etc.<br /><br />and try<br /><em class="text-italics">cmd /c echo 1</em><br />etc.<br /><br />While the first should be faster because it doesn't output to the screen (and thus, doesn't invoke screen updating) the second is certainly a hundred times slower because the OS has to schedule a new process each.<br /><br />Also 1ms may be true on your PC under certain conditions. It highly depends on the speed of your CPU, current CPU use, installed RAM, current memory availability, etc.<br /><br />Steffen</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p50690" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile50690">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist54f1.html?mode=viewprofile&amp;u=8229" class="username">misol101</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha06d.html?author_id=8229&amp;sr=posts">356</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 02 May 2016 18:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content50690">

						<h3 ><a href="#p50690">Re: How to speed up a batch script</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting0ffc.html?mode=quote&amp;f=3&amp;p=50690" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic0e73-2.html?p=50690#p50690" onclick="prompt('Message #15',this.href); return false;">#15</a></span> 
									<a class="unread" href="viewtopic0e73-2.html?p=50690#p50690" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist54f1.html?mode=viewprofile&amp;u=8229" class="username">misol101</a></strong> &raquo; </span>30 Dec 2016 06:59
			</p>
			
			
			
			<div class="content">Another little speedup trick is to clear out all or almost all unused environment variables. I found that all my scripts got a 5-10% speedup by doing this. I found this trick in a script by einstein1969. Just remember to call setlocal first, otherwise the variables are deleted from your actual cmd envioronment.<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>setlocal<br />for /F &quot;tokens=1 delims==&quot; %%v in ('set') do set &quot;%%v=&quot;<br />...<br />endlocal<br /></code></pre></div><br />Note that this will clear all variables, including the PATH. This works as long as you don't call any external programs, OR the external programs are either in your current folder OR they are called with absolute paths.<br /><br />You could also easily keep one or more variables that you need, like PATH, by doing:<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>for /F &quot;tokens=1 delims==&quot; %%v in ('set') do if /I not &quot;%%v&quot;==&quot;PATH&quot; set &quot;%%v=&quot;</code></pre></div></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
	

	<div class="action-bar bar-bottom">
	
			<a href="postingc8e6-2.html?mode=reply&amp;f=3&amp;t=7625" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic3248-2.html?f=3&amp;t=7625&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

			<form method="post" action="https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=7625">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			17 posts
							<ul>
		<li class="active"><span>1</span></li>
				<li><a class="button" href="viewtopicb928.html?f=3&amp;t=7625&amp;start=15" role="button">2</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopicb928.html?f=3&amp;t=7625&amp;start=15" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="viewforum4d6b.html?f=3" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to “DOS Batch Forum”</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="viewforum31e6.html?f=4" class="jumpbox-cat-link"> <span> DosTips - Dos Batch</span></a></li>
																<li><a href="viewforum4d6b.html?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; DOS Batch Forum</span></a></li>
											</ul>
		</div>
	</div>

	</div>


			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
							<span class="crumb"><a href="../index.html" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>DosTips.com</span></a></span>									<span class="crumb"><a href="index.html" data-navbar-reference="index"><span>Board index</span></a></span>					</li>
		
				<li class="rightside">All times are <span title="UTC-6">UTC-06:00</span></li>
							<li class="rightside">
				<a href="ucp033a.html?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete all board cookies</span>
				</a>
			</li>
												<li class="rightside" data-last-responsive="true">
				<a href="memberlist4bfd.html?mode=team" role="menuitem">
					<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
				</a>
			</li>
									<li class="rightside" data-last-responsive="true">
				<a href="memberlist8733.html?mode=contactadmin" role="menuitem">
					<i class="icon fa-envelope fa-fw" aria-hidden="true"></i><span>Contact us</span>
				</a>
			</li>
			</ul>

	</div>
</div>

	<div class="copyright">
				<!-- WARNING NO DELETE -->Style developer by <a href="http://tricolor.x-tk.ru/">support forum tricolor</a>, <!-- END WARNING NO DELETE -->Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
									</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	<img src="cronc6bf.gif?cron_type=cron.task.text_reparser.user_signature" width="1" height="1" alt="cron" /></div>

<script type="text/javascript" src="assets/javascript/jquery.mind772.js?assets_version=34"></script>
<script type="text/javascript" src="assets/javascript/cored772.js?assets_version=34"></script>



<script type="text/javascript" src="styles/prosilver/template/forum_fnd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/prosilver/template/ajaxd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/jquery-uid772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/collapsed772.js?assets_version=34"></script>



</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=7625 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 08:12:21 GMT -->
</html>
