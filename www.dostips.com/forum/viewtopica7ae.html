<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=1696&p=6686 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 09:08:40 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>Need help locating a line in text file and replacing it - DosTips.com</title>


	<link rel="canonical" href="viewtopicf763-3.html?t=1696">

<!--
	phpBB style name: Allan Style - SUBSILVER
	Based on style:   prosilver (this is the default phpBB3 style)
	Based on style:   subsilver2 (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:  Allan ( http://x-tk.ru/ )
-->

<link href="assets/css/font-awesome.mind772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/stylesheetd772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/en/stylesheetd772.css?assets_version=34" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="./styles/AllanStyle-SUBSILVER/theme/tweaks.css?assets_version=34" rel="stylesheet">
<![endif]-->




<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','../../www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-280191-1', 'auto');
	ga('send', 'pageview');
</script>

</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">

<div id="header-subsilver">
	<a id="top" class="top-anchor" accesskey="t"></a>
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description" class="site-description">
				<a id="logo" class="logo" href="../index.html" title="DosTips.com"><span class="site_logo"></span></a>
				<h1>DosTips.com</h1>
				<p>A Forum all about DOS Batch</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

									<div id="search-box" class="search-box search-header" role="search">
				<form action="https://www.dostips.com/forum/search.php" method="get" id="search">
				<fieldset>
					<input name="keywords" id="keywords" type="search" maxlength="128" title="Search for keywords" class="inputbox search tiny" size="20" value="" placeholder="Search…" />
					<button class="button button-search" type="submit" title="Search">
						<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
					</button>
					<a href="search.html" class="button button-search-end" title="Advanced search">
						<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
					</a>
					
				</fieldset>
				</form>
			</div>
						
			</div>
					</div>
</div>


<div id="wrap" class="wrap">
	<div id="page-header">
				<div class="navbar-top" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
																									<li>
								<a href="search33a7.html?search_id=unanswered" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="search526f.html?search_id=active_topics" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-blue" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="search.html" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
											<li class="separator"></li>
																			<li>
								<a href="memberlist4bfd.html?mode=team" role="menuitem">
									<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
								</a>
							</li>
																<li class="separator"></li>

									</ul>
			</div>
		</li>

				<li data-skip-responsive="true">
			<a href="app.php/help/faq.html" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
						
			<li class="rightside"  data-skip-responsive="true">
			<a href="ucp26c3.html?mode=login" title="Login" accesskey="x" role="menuitem">
				<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Login</span>
			</a>
		</li>
					<li class="rightside" data-skip-responsive="true">
				<a href="ucp8319.html?mode=register" role="menuitem">
					<i class="icon fa-pencil-square-o  fa-fw" aria-hidden="true"></i><span>Register</span>
				</a>
			</li>
						</ul>

	</div>
</div>

<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
						<li class="breadcrumbs">
							<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="../index.html" itemprop="url" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span itemprop="title">DosTips.com</span></a></span>
										<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="index.html" itemprop="url" accesskey="h" data-navbar-reference="index"><span itemprop="title">Board index</span></a></span>

											<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="4"><a href="viewforum31e6.html?f=4" itemprop="url"><span itemprop="title">DosTips - Dos Batch</span></a></span>
															<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="3"><a href="viewforum4d6b.html?f=3" itemprop="url"><span itemprop="title">DOS Batch Forum</span></a></span>
												</li>
		
					<li class="rightside responsive-search">
				<a href="search.html" title="View the advanced search options" role="menuitem">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</a>
			</li>
			</ul>

	</div>
</div>

<div class="navbar-top-link">
	<div class="inner">
		<ul>
			<li class="navbar-top-link-left"><a href="search33a7.html?search_id=unanswered">Unanswered topics</a></li>
			<li class="navbar-top-link-left"><a href="search526f.html?search_id=active_topics">Active topics</a></li>

											</ul>
	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
		
<h2 class="topic-title"><a href="viewtopicb0fe.html?f=3&amp;t=1696">Need help locating a line in text file and replacing it</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">Discussion forum for all Windows batch related topics.<br /></div>
<p>
	<strong>Moderator:</strong> <a href="memberlista6a8.html?mode=viewprofile&amp;u=5" class="username">DosItHelp</a>
</p>


<div class="action-bar bar-top">
	
			<a href="posting5c2e.html?mode=reply&amp;f=3&amp;t=1696" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic20f0.html?f=3&amp;t=1696&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="https://www.dostips.com/forum/search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topic…" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="search.html" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="1696" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			10 posts
							&bull; Page <strong>1</strong> of <strong>1</strong>
					</div>
		</div>




<div id="subsilver-nav-topic">
	<div class="inner"><div class="post has-profile">
		<div class="leftsided postbody subsilver-topic-title">Message</div>
		<div class="leftsided postprofile subsilver-topic-author">Author</div>
	</div></div>
</div>

			<div id="p6655" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile6655">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist6037.html?mode=viewprofile&amp;u=2349" class="username">gdsimz</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search3a80.html?author_id=2349&amp;sr=posts">3</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 14 Mar 2011 23:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content6655">

						<h3 class="first"><a href="#p6655">Need help locating a line in text file and replacing it</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingac71.html?mode=quote&amp;f=3&amp;p=6655" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic20d5.html?p=6655#p6655" onclick="prompt('Message #1',this.href); return false;">#1</a></span> 
									<a class="unread" href="viewtopic20d5.html?p=6655#p6655" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist6037.html?mode=viewprofile&amp;u=2349" class="username">gdsimz</a></strong> &raquo; </span>14 Mar 2011 23:32
			</p>
			
			
			
			<div class="content">Hi all,<br /><br />I'm needing a push in the right direct for getting substring of a variable with in a FOR and am new to DOS batch scripting.  I am creating a batch file for editing an ini file and not having the luxury of using c++ or java for this need.  I am trying to locate a line in a file beginning with &quot;XYZ=...&quot; (to later save it back) and storing the line as a variable while replacing the line with &quot;XYZ=&quot;.<br /><br />My code is as follows:<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />set str=teststuff<br />echo.%str%<br />set str=%str:~0,4%<br />echo.%str%<br /><br />SETLOCAL=ENABLEDELAYEDEXPANSION<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; rename c:\lotus\notes\notes.ini notes.tmp<br />&nbsp; &nbsp; &nbsp; &nbsp; for /f %%a in (c:\lotus\notes\notes.tmp) do (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; set foo=%%a<br />&nbsp; &nbsp;&nbsp; &nbsp; set substr=%%a:~0,11%<br />&nbsp; &nbsp;&nbsp; &nbsp; echo.substr<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if substr==&quot;KeyFileName=&quot; set foo=&quot;&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo.%foo% &gt;&gt; c:\lotus\notes\notes.ini)</code></pre></div><br /><br />this pasted is just one of many attempts to get the substring of each to echo out for verifying a value is there.<br /><br />seems that if the value to substring is static then it will return what I am expecting, but getting the substring of a variable is returning nothing &quot; &quot;.<br /><br />I am basically intending to loop through each line and find the substring, and then replace that line (saving to put it back after batch calls an exe).  I've been chasing my tail on this all day and appreciate any assistance.<br /><br />Thanks for your time,<br /><br />Geoff-</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6664" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile6664">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search661c.html?author_id=1265&amp;sr=posts">3386</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 22 Jan 2010 18:01</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content6664">

						<h3 ><a href="#p6664">Re: Need help locating a line in text file and replacing it</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting2e44.html?mode=quote&amp;f=3&amp;p=6664" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicf526.html?p=6664#p6664" onclick="prompt('Message #2',this.href); return false;">#2</a></span> 
									<a class="unread" href="viewtopicf526.html?p=6664#p6664" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a></strong> &raquo; </span>15 Mar 2011 17:23
			</p>
			
			
			
			<div class="content">Maybe replacing tvalues in an INI file is not safe using batch.<br />You have to make sure that you are in the right section. E.g.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>; Comment<br /><br />&#91;section1&#93;<br />abc=000<br />xyz=123<br /><br />&#91;section2&#93;<br />def=000<br />xyz=234<br /></code></pre></div><br />Now you want to replace the value of key xyz in section2, but not in section1...<br /><br />Let's start with finding the right key:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off &amp;setlocal<br /><br />set &quot;inifile=test.ini&quot;<br />set &quot;section=section2&quot;<br />set &quot;key=xyz&quot;<br /><br />for /f &quot;delims=:&quot; %%a in ('findstr /binc:&quot;&#91;%section%&#93;&quot; &quot;%inifile%&quot;') do (<br />&nbsp; for /f &quot;tokens=1* delims==&quot; %%b in ('more +%%a^&lt;&quot;%inifile%&quot;') do (<br />&nbsp; &nbsp; set &quot;_key=%%b&quot;<br />&nbsp; &nbsp; set &quot;value=%%c&quot;<br />&nbsp; &nbsp; setlocal enabledelayedexpansion<br />&nbsp; &nbsp; if &quot;!_key:~,1!&quot;==&quot;&#91;&quot; (endlocal&amp;goto notFound)<br />&nbsp; &nbsp; if /i &quot;!_key!&quot;==&quot;%key%&quot; (endlocal&amp;goto found)<br />&nbsp; &nbsp; endlocal<br />&nbsp; )<br />)<br /><br />:notFound<br />echo key not found<br />pause&gt;nul<br />goto:eof<br /><br />:found<br />echo %value%<br />pause&gt;nul<br /><br /></code></pre></div><br />Change the variables. If this will output the right value we could look forward for further actions...<br /><br />Regards<br />aGerman</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6667" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile6667">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist6037.html?mode=viewprofile&amp;u=2349" class="username">gdsimz</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search3a80.html?author_id=2349&amp;sr=posts">3</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 14 Mar 2011 23:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content6667">

						<h3 ><a href="#p6667">Re: Need help locating a line in text file and replacing it</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingc1fb.html?mode=quote&amp;f=3&amp;p=6667" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicdf66.html?p=6667#p6667" onclick="prompt('Message #3',this.href); return false;">#3</a></span> 
									<a class="unread" href="viewtopicdf66.html?p=6667#p6667" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist6037.html?mode=viewprofile&amp;u=2349" class="username">gdsimz</a></strong> &raquo; </span>15 Mar 2011 22:14
			</p>
			
			
			
			<div class="content">Yes,<br /><br />When I change the variables, the value displays using the following:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off &amp;setlocal<br /><br />set &quot;inifile=C:\lotus\notes\notes.ini&quot;<br />set &quot;section=Notes&quot;<br />set &quot;key=KeyFileName&quot;<br /><br /><br />for /f &quot;delims=:&quot; %%a in ('findstr /binc:&quot;&#91;%section%&#93;&quot; &quot;%inifile%&quot;') do (<br />&nbsp; for /f &quot;tokens=1* delims==&quot; %%b in ('more +%%a^&lt;&quot;%inifile%&quot;') do (<br />&nbsp; &nbsp; set &quot;_key=%%b&quot;<br />&nbsp; &nbsp; set &quot;value=%%c&quot;<br />&nbsp; &nbsp; setlocal enabledelayedexpansion<br />&nbsp; &nbsp; if &quot;!_key:~,1!&quot;==&quot;&#91;&quot; (endlocal&amp;goto notFound)<br />&nbsp; &nbsp; if /i &quot;!_key!&quot;==&quot;%key%&quot; (endlocal&amp;goto found)<br />&nbsp; &nbsp; endlocal<br />&nbsp; )<br />)<br /><br />:notFound<br />echo key not found<br />pause&gt;nul<br />goto:eof<br /><br />:found<br />echo %value%<br /><br />pause&gt;nul<br /></code></pre></div><br /><br />The 'KeyFileName' key will always be there, but value will always be different.  So now having the %value%, I would like to empty the key in the existing line of text.<br /><br />for example &quot;KeyFileName=&quot;.<br /><br />Doing so will allow me to perform an mst installation with out being prompted for a password (called in the bat for silent upgrade).<br /><br />however I need to retain %value% so I can put it back right afterward in the same text line in the ini file.<br /><br /><br />Thanks so much for your help,<br /><br />Geoff</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6673" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile6673">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search661c.html?author_id=1265&amp;sr=posts">3386</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 22 Jan 2010 18:01</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content6673">

						<h3 ><a href="#p6673">Re: Need help locating a line in text file and replacing it</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingaf65.html?mode=quote&amp;f=3&amp;p=6673" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic3342-2.html?p=6673#p6673" onclick="prompt('Message #4',this.href); return false;">#4</a></span> 
									<a class="unread" href="viewtopic3342-2.html?p=6673#p6673" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a></strong> &raquo; </span>16 Mar 2011 16:27
			</p>
			
			
			
			<div class="content">OK. I don't know whether your installation will change the INI file. For that reason we should do the same procedure twice.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off &amp;setlocal<br /><br />set &quot;inifile=C:\lotus\notes\notes.ini&quot;<br />set &quot;section=Notes&quot;<br />set &quot;key=KeyFileName&quot;<br /><br />for /f &quot;delims=:&quot; %%a in ('findstr /binc:&quot;&#91;%section%&#93;&quot; &quot;%inifile%&quot;') do (<br />&nbsp; set /a n=%%a<br />&nbsp; for /f &quot;tokens=1* delims==&quot; %%b in ('more +%%a^&lt;&quot;%inifile%&quot;') do (<br />&nbsp; &nbsp; set &quot;_key=%%b&quot;<br />&nbsp; &nbsp; set &quot;value=%%c&quot;<br />&nbsp; &nbsp; set /a n+=1<br />&nbsp; &nbsp; setlocal enabledelayedexpansion<br />&nbsp; &nbsp; if &quot;!_key:~,1!&quot;==&quot;&#91;&quot; (endlocal&amp;goto notFound)<br />&nbsp; &nbsp; if /i &quot;!_key!&quot;==&quot;%key%&quot; (endlocal&amp;goto found)<br />&nbsp; &nbsp; endlocal<br />&nbsp; )<br />)<br /><br />:notFound<br />echo key not found<br />pause&gt;nul<br />goto:eof<br /><br />:found<br />echo found value %value% in line %n%<br /><br />for /f &quot;tokens=*&quot; %%i in (&quot;%inifile%&quot;) do (<br />&nbsp; set &quot;tempfile=%temp%\%%~nxi&quot;<br />&nbsp; set &quot;inifile=%%~fi&quot;<br />)<br />move /y &quot;%inifile%&quot; &quot;%tempfile%&quot;<br /><br />for /f &quot;tokens=1* delims=:&quot; %%a in ('findstr /n &quot;^&quot; &quot;%tempfile%&quot;') do (<br />&nbsp; set &quot;line=%%b&quot;<br />&nbsp; setlocal enabledelayedexpansion<br />&nbsp; &nbsp; if %%a==%n% (<br />&nbsp; &nbsp; &nbsp; &gt;&gt;&quot;%inifile%&quot; echo(%key%=<br />&nbsp; &nbsp; ) else (<br />&nbsp; &nbsp; &nbsp; &gt;&gt;&quot;%inifile%&quot; echo(!line!<br />&nbsp; &nbsp; )<br />&nbsp; endlocal<br />)<br /><br /><br />:::::::::::::::::::::::::<br />echo do your stuff here<br />pause&gt;nul<br />:::::::::::::::::::::::::<br /><br /><br />for /f &quot;delims=:&quot; %%a in ('findstr /binc:&quot;&#91;%section%&#93;&quot; &quot;%inifile%&quot;') do (<br />&nbsp; set /a n=%%a<br />&nbsp; for /f &quot;tokens=1 delims==&quot; %%b in ('more +%%a^&lt;&quot;%inifile%&quot;') do (<br />&nbsp; &nbsp; set &quot;_key=%%b&quot;<br />&nbsp; &nbsp; set /a n+=1<br />&nbsp; &nbsp; setlocal enabledelayedexpansion<br />&nbsp; &nbsp; if &quot;!_key:~,1!&quot;==&quot;&#91;&quot; (endlocal&amp;goto notFound2)<br />&nbsp; &nbsp; if /i &quot;!_key!&quot;==&quot;%key%&quot; (endlocal&amp;goto found2)<br />&nbsp; &nbsp; endlocal<br />&nbsp; )<br />)<br /><br />:notFound2<br />echo key not found in 2nd step<br />pause&gt;nul<br />goto:eof<br /><br />:found2<br />echo found key %key% in line %n%<br /><br />move /y &quot;%inifile%&quot; &quot;%tempfile%&quot;<br /><br />for /f &quot;tokens=1* delims=:&quot; %%a in ('findstr /n &quot;^&quot; &quot;%tempfile%&quot;') do (<br />&nbsp; set &quot;line=%%b&quot;<br />&nbsp; setlocal enabledelayedexpansion<br />&nbsp; &nbsp; if %%a==%n% (<br />&nbsp; &nbsp; &nbsp; &gt;&gt;&quot;%inifile%&quot; echo(%key%=!value!<br />&nbsp; &nbsp; ) else (<br />&nbsp; &nbsp; &nbsp; &gt;&gt;&quot;%inifile%&quot; echo(!line!<br />&nbsp; &nbsp; )<br />&nbsp; endlocal<br />)<br /><br />del &quot;%tempfile%&quot;<br /><br /></code></pre></div><br />Regards<br />aGerman</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6686" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile6686">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistde6b.html?mode=viewprofile&amp;u=8" class="username">ghostmachine4</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchfe6a.html?author_id=8&amp;sr=posts">319</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 May 2006 01:13</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content6686">

						<h3 ><a href="#p6686">Re: Need help locating a line in text file and replacing it</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting367c.html?mode=quote&amp;f=3&amp;p=6686" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicd709.html?p=6686#p6686" onclick="prompt('Message #5',this.href); return false;">#5</a></span> 
									<a class="unread" href="viewtopicd709.html?p=6686#p6686" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistde6b.html?mode=viewprofile&amp;u=8" class="username">ghostmachine4</a></strong> &raquo; </span>16 Mar 2011 20:09
			</p>
			
			
			
			<div class="content">Gosh, forget about batch for parsing files , even for anything!. It only has very primitive string manipulation capabilities, does not do decimal maths, has ugly syntax making maintenance and debugging difficult, slow to execute etc.  <br />If you can't use a good programming language, use the next best thing that comes with modern Windows, vbscript (or powershell).<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>Set objFS = CreateObject( &quot;Scripting.FileSystemObject&quot; )<br />strFile = WScript.Arguments(0)<br />Set objFile = objFS.OpenTextFile(strFile)<br />contents = objFile.ReadAll<br />Data = Split(contents,vbCrLf&amp;vbCrLf)<br />For i=LBound(Data) To UBound(Data)<br />&nbsp; &nbsp; flag = 0<br />&nbsp; &nbsp;WScript.Echo &quot;-&gt;&quot;&amp;Data(i)<br />&nbsp; &nbsp;d = Split( Data(i) , vbCrLf )<br />&nbsp; &nbsp;For j=LBound(d) To UBound(d)<br />&nbsp; &nbsp;&nbsp; &nbsp;WScript.Echo &quot;==&gt;&quot;&amp;d(j)<br />&nbsp; &nbsp;&nbsp; &nbsp;If InStr( d(j) , &quot;section2&quot; )&gt; 0 Then<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;'set flag when found section2<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;flag = 1<br />&nbsp; &nbsp;&nbsp; &nbsp;End If <br />&nbsp; &nbsp;&nbsp; &nbsp;index = InStr( d(j), &quot;xyz=&quot;&nbsp; )<br />&nbsp; &nbsp;&nbsp; &nbsp;If index &gt; 0 And flag = 1 Then<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;WScript.Echo &quot;Found key before replacement: &quot; &amp; d(j)<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;d(j) = Mid(d(j), 1, Len(&quot;xyz=&quot;) )<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;WScript.Echo &quot;After replacement: &quot; &amp; d(j)<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;Exit For<br />&nbsp; &nbsp;&nbsp; &nbsp;End If &nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;Next<br />&nbsp; &nbsp;Data(i) = Join(d, vbcrlf)&nbsp; &nbsp;<br />Next<br />Data = Join(Data, vbCrLf&amp;vbCrLf )<br />WScript.Echo &quot;====================&quot;<br />WScript.Echo &quot;Final: &quot; &amp;Data<br /></code></pre></div><br /><br />output<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>C:\test&gt;type file<br />; Comment<br /><br />&#91;section1&#93;<br />abc=000<br />xyz=123<br /><br />&#91;section2&#93;<br />def=000<br />xyz=234<br /><br />C:\test&gt;cscript //nologo test.vbs file<br />-&gt;; Comment<br />==&gt;; Comment<br />-&gt;&#91;section1&#93;<br />abc=000<br />xyz=123<br />==&gt;&#91;section1&#93;<br />==&gt;abc=000<br />==&gt;xyz=123<br />-&gt;&#91;section2&#93;<br />def=000<br />xyz=234<br /><br />==&gt;&#91;section2&#93;<br />==&gt;def=000<br />==&gt;xyz=234<br />Found key before replacement: xyz=234<br />After replacement: xyz=<br />====================<br />Final: ; Comment<br /><br />&#91;section1&#93;<br />abc=000<br />xyz=123<br /><br />&#91;section2&#93;<br />def=000<br />xyz=<br /><br /><br /><br /></code></pre></div><br /><br />I show the output using arrows. First of all, the script reads the whole ini file into memory. Then it splits the whole content on 2 new lines , that is, assuming your ini file has the structure as shown. The small arrow &quot;-&gt;&quot; shows each section being split. Next, the script splits again on 1 new line to give you the individual lines in each section. These are shown with &quot;==&gt;&quot; arrows... Now, you can begin searching for your &quot;xyz=&quot; in &quot;section2&quot;. When the script finds &quot;section2&quot; , a flag is set to 1. If &quot;xyz=&quot; is found and the flag is 1, that means the &quot;xyz=&quot; belongs to &quot;section2&quot; and you can do the replacement.<br /><br />If you need to save to a file, use the &quot;&gt;&quot; redirection<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>cscript //nologo test.vbs file &gt; temp<br />ren temp file<br /></code></pre></div><br /><br />This method does not need to read the file multiple times ( i counted more than 8 times in the batch solution! ) using findstr , more blah blah as illustrated by aGerman's long and complicated batch file (no offense to aGerman ), hence, will be much faster than the batch solution, plus, easier to maintain and troubleshoot. If you are interested, get a copy of the vbscript manual <a href="http://www.microsoft.com/downloads/en/details.aspx?FamilyID=01592c48-207d-4be1-8a76-1c4099d7bbb9" class="postlink">here</a></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6694" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile6694">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist562d.html?mode=viewprofile&amp;u=2357" class="username">Cleptography</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search9546.html?author_id=2357&amp;sr=posts">287</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 16 Mar 2011 19:17</dd>		
		
																<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> scriptingpros.com</dd>
							
							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact Cleptography">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact Cleptography</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="https://www.scriptingpros.com.com/" title="Website" class="last-cell">
										<span class="contact-icon phpbb_website-icon">Website</span>
									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content6694">

						<h3 ><a href="#p6694">Re: Need help locating a line in text file and replacing it</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting5593.html?mode=quote&amp;f=3&amp;p=6694" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic52c0-2.html?p=6694#p6694" onclick="prompt('Message #6',this.href); return false;">#6</a></span> 
									<a class="unread" href="viewtopic52c0-2.html?p=6694#p6694" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist562d.html?mode=viewprofile&amp;u=2357" class="username">Cleptography</a></strong> &raquo; </span>17 Mar 2011 00:39
			</p>
			
			
			
			<div class="content">This will replace all occurrences of the specified string.<br />Change world and planet to reflect your needs.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off&amp;&amp;setlocal<br /><br />set file=%~1<br /><br />for /f &quot;tokens=*&quot; %%- in (%file%) do (<br />&nbsp; &nbsp;set str=%%-&amp;&amp;call :NEXT<br />)<br />goto :eof<br /><br />:NEXT<br />set str=%str:world=planet%<br />echo.%str%&gt;&gt;New_%file%<br />goto :eof</code></pre></div><br /><br />Cheers-</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6696" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile6696">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistde6b.html?mode=viewprofile&amp;u=8" class="username">ghostmachine4</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchfe6a.html?author_id=8&amp;sr=posts">319</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 May 2006 01:13</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content6696">

						<h3 ><a href="#p6696">Re: Need help locating a line in text file and replacing it</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingc517.html?mode=quote&amp;f=3&amp;p=6696" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic3890.html?p=6696#p6696" onclick="prompt('Message #7',this.href); return false;">#7</a></span> 
									<a class="unread" href="viewtopic3890.html?p=6696#p6696" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistde6b.html?mode=viewprofile&amp;u=8" class="username">ghostmachine4</a></strong> &raquo; </span>17 Mar 2011 03:06
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>Cleptography wrote:</cite>This will replace all occurrences of the specified string.<br />Change world and planet to reflect your needs.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off&amp;&amp;setlocal<br /><br />set file=%~1<br /><br />for /f &quot;tokens=*&quot; %%- in (%file%) do (<br />&nbsp; &nbsp;set str=%%-&amp;&amp;call :NEXT<br />)<br />goto :eof<br /><br />:NEXT<br />set str=%str:world=planet%<br />echo.%str%&gt;&gt;New_%file%<br />goto :eof</code></pre></div><br /><br />Cheers-</div></blockquote><br /><br />did you understand the question and OP's requirement that was posted ?</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6703" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile6703">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist562d.html?mode=viewprofile&amp;u=2357" class="username">Cleptography</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search9546.html?author_id=2357&amp;sr=posts">287</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 16 Mar 2011 19:17</dd>		
		
																<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> scriptingpros.com</dd>
							
							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact Cleptography">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact Cleptography</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="https://www.scriptingpros.com.com/" title="Website" class="last-cell">
										<span class="contact-icon phpbb_website-icon">Website</span>
									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content6703">

						<h3 ><a href="#p6703">Re: Need help locating a line in text file and replacing it</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting3fcd.html?mode=quote&amp;f=3&amp;p=6703" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic7647.html?p=6703#p6703" onclick="prompt('Message #8',this.href); return false;">#8</a></span> 
									<a class="unread" href="viewtopic7647.html?p=6703#p6703" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist562d.html?mode=viewprofile&amp;u=2357" class="username">Cleptography</a></strong> &raquo; </span>17 Mar 2011 10:19
			</p>
			
			
			
			<div class="content">Oh my apologies &quot;Ghost&quot; I figured the obvious method was there and it was late so excuse me for not going into more detail.<br />Now assuming that we have an ini file that looks like so<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>; Comment<br /><br />&#91;section1&#93;<br />abc=000<br />xyz=123<br /><br />&#91;section2&#93;<br />def=000<br />xyz=234</code></pre></div><br /><br />and the script we use looks like<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />&nbsp;setlocal enabledelayedexpansion<br /><br />set strR=%~1<br />set strW=%~2<br />set file=%~3<br /><br />:GetStr<br />for /f &quot;tokens=*&quot; %%- in (%file%) do (<br />&nbsp; &nbsp;set str=%%-&amp;&amp;call :ReplaceStr<br />)<br />goto :eof<br /><br />:ReplaceStr<br />set str=!str:%strR%=%strW%!<br />echo.%str%<br />goto :eof</code></pre></div><br /><br />We can from the command line type<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>BatchScriptName.bat &quot;234&quot; &quot;456&quot; &quot;File.ini&quot;</code></pre></div><br /><br />which will output<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&#91;section1&#93;<br />abc=000<br />xyz=123<br /><br />&#91;section2&#93;<br />def=000<br />xyz=456</code></pre></div><br /><br />But wait what if we have an ini file that looks like<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&#91;section1&#93;<br />abc=000<br />xyz=123<br /><br />&#91;section2&#93;<br />def=000<br />xyz=234<br /><br />&#91;section3&#93;<br />def=000<br />xyz=234</code></pre></div><br /><br />Well then you add something to the above command args that specifies the section then check for it and append the number +1 to it and when that section is found it knows to change that section and no others that may include xyz=234.<br /><br />Now is this wrong if so I apologize.<br /> <img class="smilies" src="images/smilies/icon_eek.gif" alt=":shock:" title="Shocked" /></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6751" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile6751">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist6037.html?mode=viewprofile&amp;u=2349" class="username">gdsimz</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search3a80.html?author_id=2349&amp;sr=posts">3</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 14 Mar 2011 23:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content6751">

						<h3 ><a href="#p6751">Re: Need help locating a line in text file and replacing it</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting5f2b.html?mode=quote&amp;f=3&amp;p=6751" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicfa05.html?p=6751#p6751" onclick="prompt('Message #9',this.href); return false;">#9</a></span> 
									<a class="unread" href="viewtopicfa05.html?p=6751#p6751" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist6037.html?mode=viewprofile&amp;u=2349" class="username">gdsimz</a></strong> &raquo; </span>22 Mar 2011 22:26
			</p>
			
			
			
			<div class="content">Thanks you all for the replies.  The file had to be created has to be a batch file for this project.  aGerman's last reply does work as expected if it is clicked by the user.  The process of why it has to be a batch is because the collaboration server (Lotus Domino) will update all the user workstations (for email and in house applications).  There needed to be a silent install and for a silent install, the requirement was to unpack the CD install on the network, create a custom mst file, and have a batch file pushed to the user's workstation and triggered by the server.<br /><br />aGerman's code works fine if the batch file is clicked by itself as it goes to the workstation ini file and performs the tasks stated above.  (Thanks so much for your help aGerman btw!!)<br /><br />My problem now is that when the server pushes the batch file down, the lines that trigger the query are not found so the app does not run.  Not sure if it is even finding the ini file or is looking on the server (since the server is pushing it down) or if there is a permissions problem (though the workstation accounts are local admins).<br /><br />Is there a way to maybe use a machine name variable (&quot;\\&quot;+%MACHINE%+&quot;\&quot;..) with a unc path the make sure it is querying the client machine?<br /><br />Thanks again!<br /><br />Geoff-<br /><br />for reference this is what I am trying to use:<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off &amp;setlocal<br /><br />set &quot;inifile=C:\lotus\notes\notes.ini&quot;<br />set &quot;section=Notes&quot;<br />set &quot;key=KeyFileName&quot;<br /><br />for /f &quot;delims=:&quot; %%a in ('findstr /binc:&quot;&#91;%section%&#93;&quot; &quot;%inifile%&quot;') do (<br />&nbsp; set /a n=%%a<br />&nbsp; for /f &quot;tokens=1* delims==&quot; %%b in ('more +%%a^&lt;&quot;%inifile%&quot;') do (<br />&nbsp; &nbsp; set &quot;_key=%%b&quot;<br />&nbsp; &nbsp; set &quot;value=%%c&quot;<br />&nbsp; &nbsp; set /a n+=1<br />&nbsp; &nbsp; setlocal enabledelayedexpansion<br />&nbsp; &nbsp; if &quot;!_key:~,1!&quot;==&quot;&#91;&quot; (endlocal&amp;goto notFound)<br />&nbsp; &nbsp; if /i &quot;!_key!&quot;==&quot;%key%&quot; (endlocal&amp;goto found)<br />&nbsp; &nbsp; endlocal<br />&nbsp; )<br />)<br /><br />:notFound<br />echo KeyFileName for existing install not found!<br />echo press Enter key<br />pause&gt;nul<br />goto:eof<br /><br />:found<br />echo found install ini for %value% in line %n%<br /><br />for /f &quot;tokens=*&quot; %%i in (&quot;%inifile%&quot;) do (<br />&nbsp; set &quot;tempfile=%temp%\%%~nxi&quot;<br />&nbsp; set &quot;inifile=%%~fi&quot;<br />)<br />move /y &quot;%inifile%&quot; &quot;%tempfile%&quot;<br /><br />for /f &quot;tokens=1* delims=:&quot; %%a in ('findstr /n &quot;^&quot; &quot;%tempfile%&quot;') do (<br />&nbsp; set &quot;line=%%b&quot;<br />&nbsp; setlocal enabledelayedexpansion<br />&nbsp; &nbsp; if %%a==%n% (<br />&nbsp; &nbsp; &nbsp; &gt;&gt;&quot;%inifile%&quot; echo(%key%=<br />&nbsp; &nbsp; ) else (<br />&nbsp; &nbsp; &nbsp; &gt;&gt;&quot;%inifile%&quot; echo(!line!<br />&nbsp; &nbsp; )<br />&nbsp; endlocal<br />)<br /><br /><br />:::::::::::::::::::::::::<br />echo *****<br />echo DO NOT CLOSE THIS WINDOW<br />echo *****<br />echo performing Lotus Notes Upgrade..<br /><br />SET R85FILESPATH=\\gutil3\Tech\Apps\8upgrade\<br />%R85FILESPATH%setup.exe /s /v&quot;ALLUSERS=1 TRANSFORMS=%R85FILESPATH%LotusNotes851.mst /qb+!&quot;<br />%R85FILESPATH%FixPack5\setup.exe /S /v&quot;/qb+!&quot;<br />c:\lotus\notes\nconvert -d c:\lotus\notes\data\names.nsf * c:\lotus\notes\data\pernames.ntf<br />c:\lotus\notes\ncompact c:\lotus\notes\data -C -ZU -v -n<br /><br />:::::::::::::::::::::::::<br /><br /><br />for /f &quot;delims=:&quot; %%a in ('findstr /binc:&quot;&#91;%section%&#93;&quot; &quot;%inifile%&quot;') do (<br />&nbsp; set /a n=%%a<br />&nbsp; for /f &quot;tokens=1 delims==&quot; %%b in ('more +%%a^&lt;&quot;%inifile%&quot;') do (<br />&nbsp; &nbsp; set &quot;_key=%%b&quot;<br />&nbsp; &nbsp; set /a n+=1<br />&nbsp; &nbsp; setlocal enabledelayedexpansion<br />&nbsp; &nbsp; if &quot;!_key:~,1!&quot;==&quot;&#91;&quot; (endlocal&amp;goto notFound2)<br />&nbsp; &nbsp; if /i &quot;!_key!&quot;==&quot;%key%&quot; (endlocal&amp;goto found2)<br />&nbsp; &nbsp; endlocal<br />&nbsp; )<br />)<br /><br />:notFound2<br />echo keyFileName not found after installing updates..<br />echo press Enter key<br />pause&gt;nul<br />goto:eof<br /><br />:found2<br />echo found KeyFileName %key% in line %n%<br /><br />move /y &quot;%inifile%&quot; &quot;%tempfile%&quot;<br /><br />for /f &quot;tokens=1* delims=:&quot; %%a in ('findstr /n &quot;^&quot; &quot;%tempfile%&quot;') do (<br />&nbsp; set &quot;line=%%b&quot;<br />&nbsp; setlocal enabledelayedexpansion<br />&nbsp; &nbsp; if %%a==%n% (<br />&nbsp; &nbsp; &nbsp; &gt;&gt;&quot;%inifile%&quot; echo(%key%=!value!<br />&nbsp; &nbsp; ) else (<br />&nbsp; &nbsp; &nbsp; &gt;&gt;&quot;%inifile%&quot; echo(!line!<br />&nbsp; &nbsp; )<br />&nbsp; endlocal<br />)<br /><br />del &quot;%tempfile%&quot;</code></pre></div></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6769" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile6769">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search661c.html?author_id=1265&amp;sr=posts">3386</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 22 Jan 2010 18:01</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content6769">

						<h3 ><a href="#p6769">Re: Need help locating a line in text file and replacing it</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingf949.html?mode=quote&amp;f=3&amp;p=6769" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicf80a.html?p=6769#p6769" onclick="prompt('Message #10',this.href); return false;">#10</a></span> 
									<a class="unread" href="viewtopicf80a.html?p=6769#p6769" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a></strong> &raquo; </span>25 Mar 2011 16:24
			</p>
			
			
			
			<div class="content">I'm not familiar with remote stuff. Try <a href="http://www.microsoft.com/technet/sysinternals/utilities/psexec.mspx" class="postlink">psexec</a>.<br /><br />Regards<br />aGerman</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
	

	<div class="action-bar bar-bottom">
	
			<a href="posting5c2e.html?mode=reply&amp;f=3&amp;t=1696" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic20f0.html?f=3&amp;t=1696&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

			<form method="post" action="https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=1696">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			10 posts
							&bull; Page <strong>1</strong> of <strong>1</strong>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="viewforum4d6b.html?f=3" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to “DOS Batch Forum”</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="viewforum31e6.html?f=4" class="jumpbox-cat-link"> <span> DosTips - Dos Batch</span></a></li>
																<li><a href="viewforum4d6b.html?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; DOS Batch Forum</span></a></li>
											</ul>
		</div>
	</div>

	</div>


			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
							<span class="crumb"><a href="../index.html" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>DosTips.com</span></a></span>									<span class="crumb"><a href="index.html" data-navbar-reference="index"><span>Board index</span></a></span>					</li>
		
				<li class="rightside">All times are <span title="UTC-6">UTC-06:00</span></li>
							<li class="rightside">
				<a href="ucp033a.html?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete all board cookies</span>
				</a>
			</li>
												<li class="rightside" data-last-responsive="true">
				<a href="memberlist4bfd.html?mode=team" role="menuitem">
					<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
				</a>
			</li>
									<li class="rightside" data-last-responsive="true">
				<a href="memberlist8733.html?mode=contactadmin" role="menuitem">
					<i class="icon fa-envelope fa-fw" aria-hidden="true"></i><span>Contact us</span>
				</a>
			</li>
			</ul>

	</div>
</div>

	<div class="copyright">
				<!-- WARNING NO DELETE -->Style developer by <a href="http://tricolor.x-tk.ru/">support forum tricolor</a>, <!-- END WARNING NO DELETE -->Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
									</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	<img src="cron5495.gif?cron_type=cron.task.text_reparser.poll_title" width="1" height="1" alt="cron" /></div>

<script type="text/javascript" src="assets/javascript/jquery.mind772.js?assets_version=34"></script>
<script type="text/javascript" src="assets/javascript/cored772.js?assets_version=34"></script>



<script type="text/javascript" src="styles/prosilver/template/forum_fnd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/prosilver/template/ajaxd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/jquery-uid772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/collapsed772.js?assets_version=34"></script>



</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=1696&p=6686 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 09:08:40 GMT -->
</html>
