<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=3298 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 09:26:22 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>How To Detect User Interacting With Console vs. Auto Task - DosTips.com</title>


	<link rel="canonical" href="viewtopic21fb-2.html?t=3298">

<!--
	phpBB style name: Allan Style - SUBSILVER
	Based on style:   prosilver (this is the default phpBB3 style)
	Based on style:   subsilver2 (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:  Allan ( http://x-tk.ru/ )
-->

<link href="assets/css/font-awesome.mind772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/stylesheetd772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/en/stylesheetd772.css?assets_version=34" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="./styles/AllanStyle-SUBSILVER/theme/tweaks.css?assets_version=34" rel="stylesheet">
<![endif]-->




<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','../../www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-280191-1', 'auto');
	ga('send', 'pageview');
</script>

</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">

<div id="header-subsilver">
	<a id="top" class="top-anchor" accesskey="t"></a>
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description" class="site-description">
				<a id="logo" class="logo" href="../index.html" title="DosTips.com"><span class="site_logo"></span></a>
				<h1>DosTips.com</h1>
				<p>A Forum all about DOS Batch</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

									<div id="search-box" class="search-box search-header" role="search">
				<form action="https://www.dostips.com/forum/search.php" method="get" id="search">
				<fieldset>
					<input name="keywords" id="keywords" type="search" maxlength="128" title="Search for keywords" class="inputbox search tiny" size="20" value="" placeholder="Search…" />
					<button class="button button-search" type="submit" title="Search">
						<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
					</button>
					<a href="search.html" class="button button-search-end" title="Advanced search">
						<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
					</a>
					
				</fieldset>
				</form>
			</div>
						
			</div>
					</div>
</div>


<div id="wrap" class="wrap">
	<div id="page-header">
				<div class="navbar-top" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
																									<li>
								<a href="search33a7.html?search_id=unanswered" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="search526f.html?search_id=active_topics" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-blue" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="search.html" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
											<li class="separator"></li>
																			<li>
								<a href="memberlist4bfd.html?mode=team" role="menuitem">
									<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
								</a>
							</li>
																<li class="separator"></li>

									</ul>
			</div>
		</li>

				<li data-skip-responsive="true">
			<a href="app.php/help/faq.html" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
						
			<li class="rightside"  data-skip-responsive="true">
			<a href="ucp26c3.html?mode=login" title="Login" accesskey="x" role="menuitem">
				<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Login</span>
			</a>
		</li>
					<li class="rightside" data-skip-responsive="true">
				<a href="ucp8319.html?mode=register" role="menuitem">
					<i class="icon fa-pencil-square-o  fa-fw" aria-hidden="true"></i><span>Register</span>
				</a>
			</li>
						</ul>

	</div>
</div>

<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
						<li class="breadcrumbs">
							<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="../index.html" itemprop="url" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span itemprop="title">DosTips.com</span></a></span>
										<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="index.html" itemprop="url" accesskey="h" data-navbar-reference="index"><span itemprop="title">Board index</span></a></span>

											<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="4"><a href="viewforum31e6.html?f=4" itemprop="url"><span itemprop="title">DosTips - Dos Batch</span></a></span>
															<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="3"><a href="viewforum4d6b.html?f=3" itemprop="url"><span itemprop="title">DOS Batch Forum</span></a></span>
												</li>
		
					<li class="rightside responsive-search">
				<a href="search.html" title="View the advanced search options" role="menuitem">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</a>
			</li>
			</ul>

	</div>
</div>

<div class="navbar-top-link">
	<div class="inner">
		<ul>
			<li class="navbar-top-link-left"><a href="search33a7.html?search_id=unanswered">Unanswered topics</a></li>
			<li class="navbar-top-link-left"><a href="search526f.html?search_id=active_topics">Active topics</a></li>

											</ul>
	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
		
<h2 class="topic-title"><a href="viewtopic9422-2.html?f=3&amp;t=3298">How To Detect User Interacting With Console vs. Auto Task</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">Discussion forum for all Windows batch related topics.<br /></div>
<p>
	<strong>Moderator:</strong> <a href="memberlista6a8.html?mode=viewprofile&amp;u=5" class="username">DosItHelp</a>
</p>


<div class="action-bar bar-top">
	
			<a href="postingd779-2.html?mode=reply&amp;f=3&amp;t=3298" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic80e7.html?f=3&amp;t=3298&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="https://www.dostips.com/forum/search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topic…" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="search.html" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="3298" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			17 posts
							<ul>
		<li class="active"><span>1</span></li>
				<li><a class="button" href="viewtopic9b93-2.html?f=3&amp;t=3298&amp;start=15" role="button">2</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopic9b93-2.html?f=3&amp;t=3298&amp;start=15" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
		</div>




<div id="subsilver-nav-topic">
	<div class="inner"><div class="post has-profile">
		<div class="leftsided postbody subsilver-topic-title">Message</div>
		<div class="leftsided postprofile subsilver-topic-author">Author</div>
	</div></div>
</div>

			<div id="p16063" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile16063">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistde6f.html?mode=viewprofile&amp;u=3672" class="username">Hewlit</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchc8e8.html?author_id=3672&amp;sr=posts">2</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 07 May 2012 03:50</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content16063">

						<h3 class="first"><a href="#p16063">How To Detect User Interacting With Console vs. Auto Task</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinga0cc.html?mode=quote&amp;f=3&amp;p=16063" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicf072.html?p=16063#p16063" onclick="prompt('Message #1',this.href); return false;">#1</a></span> 
									<a class="unread" href="viewtopicf072.html?p=16063#p16063" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistde6f.html?mode=viewprofile&amp;u=3672" class="username">Hewlit</a></strong> &raquo; </span>07 May 2012 04:04
			</p>
			
			
			
			<div class="content">Hello,<br /><br />I would like to know how to detect whether there is a person in front of the computer, using the Windows Server Terminal/Console to launch a set of BATCH scripts, or whether there is an automated Background Task that's launching those scripts. I must detect this using simple batch script.<br /><br />Some of the maintainence scripts that have to be launched, might enconter problems and errors. In this case I must inform the user. If the user is actually in front of the computer, I would like to show him a message. But if everything happens in the middle of the night, and there is an automated task that's lanching those scripts, then I would like to send an email to the administrator to inform him about the errors. I hope I explained myself well, and that everybody understands what I am actually trying to do.<br /><br />I've been looking around on the internet for possible differences between those 2 types of &quot;users&quot;, but I can't find anything helpful. Any solution is welcomed: keystroke capture, redirected Standard Input, Terminal/Console session IDs, etc. I tried all those, but couldn't succeed until now...<br /><br />The solution has to work on Windows Server 2003, 2008 and 2008 R2. But to begin with, I'd be more than happy to see it work on just WS 2003. Or at least on any version of Windows.<br /><br />Thank you in advance for your answers!</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p16073" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile16073">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistb857.html?mode=viewprofile&amp;u=2812" class="username">abc0502</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchb539.html?author_id=2812&amp;sr=posts">1007</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 26 Oct 2011 22:38</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Egypt</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content16073">

						<h3 ><a href="#p16073">Re: How To Detect User Interacting With Console vs. Auto Tas</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingcc78.html?mode=quote&amp;f=3&amp;p=16073" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic8037-2.html?p=16073#p16073" onclick="prompt('Message #2',this.href); return false;">#2</a></span> 
									<a class="unread" href="viewtopic8037-2.html?p=16073#p16073" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistb857.html?mode=viewprofile&amp;u=2812" class="username">abc0502</a></strong> &raquo; </span>07 May 2012 19:40
			</p>
			
			
			
			<div class="content">I think that will be hard to do using batch only. <img class="smilies" src="images/smilies/icon_sad.gif" alt=":(" title="Sad" /></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p16086" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile16086">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist306a.html?mode=viewprofile&amp;u=592" class="username">alan_b</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search3aa7.html?author_id=592&amp;sr=posts">357</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 04 Oct 2008 09:49</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content16086">

						<h3 ><a href="#p16086">Re: How To Detect User Interacting With Console vs. Auto Tas</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting121d.html?mode=quote&amp;f=3&amp;p=16086" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicc495.html?p=16086#p16086" onclick="prompt('Message #3',this.href); return false;">#3</a></span> 
									<a class="unread" href="viewtopicc495.html?p=16086#p16086" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist306a.html?mode=viewprofile&amp;u=592" class="username">alan_b</a></strong> &raquo; </span>08 May 2012 07:16
			</p>
			
			
			
			<div class="content">Why bother detecting the presence ?<br /><br />Why not show the message and prompt for a response,<br />and if there is no response within a time-out period email the administrator.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p16089" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile16089">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistb857.html?mode=viewprofile&amp;u=2812" class="username">abc0502</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchb539.html?author_id=2812&amp;sr=posts">1007</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 26 Oct 2011 22:38</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Egypt</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content16089">

						<h3 ><a href="#p16089">Re: How To Detect User Interacting With Console vs. Auto Tas</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting4446.html?mode=quote&amp;f=3&amp;p=16089" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic6919.html?p=16089#p16089" onclick="prompt('Message #4',this.href); return false;">#4</a></span> 
									<a class="unread" href="viewtopic6919.html?p=16089#p16089" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistb857.html?mode=viewprofile&amp;u=2812" class="username">abc0502</a></strong> &raquo; </span>08 May 2012 09:34
			</p>
			
			
			
			<div class="content">but if he keep sending messages and waiting for respond. the user will get mad. &quot;i would if i was him&quot; <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br /><br />I never used windows server so this command not sure it work for it or not;<br />If it's about sending messages use<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>net send /Domain:name message</code></pre></div><br />or<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>net send name message</code></pre></div><br />replace the name and domain if needed and the message of course.<br /><br />And sending email using vbscript &quot;i use this script my self&quot;, if possible use a gmail account.<br />change the <span style="color: #FF0000">colored </span>letters only and <span style="color: #BF0000">don't delete the double quotes in the script</span><br /><blockquote class="uncited"><div>Const fromEmail	= &quot;<span style="color: #FF0000">your_email@gmail.com</span>&quot;<br />Const password	= &quot;<span style="color: #0000FF">password</span>&quot;<br /><br />Dim emailObj, emailConfig<br />Set emailObj      = CreateObject(&quot;CDO.Message&quot;)<br />emailObj.From     = &quot;<span style="color: #FF0000">your_email_used_up@gmail.com</span>&quot;<br />emailObj.To       = &quot;<span style="color: #00BF00">admin_email@what_ever_email_service.com</span>&quot;<br />emailObj.Subject  = &quot; <span style="color: #0000BF">Write Message Subject Here</span> &quot;<br />emailObj.TextBody = &quot; <span style="color: #0000BF">Write Message Here</span> &quot;<br /><br />Set emailConfig = emailObj.Configuration<br />emailConfig.Fields(&quot;http://schemas.microsoft.com/cdo/configuration/smtpserver&quot;)       = &quot;smtp.gmail.com&quot;<br />emailConfig.Fields(&quot;http://schemas.microsoft.com/cdo/configuration/smtpserverport&quot;)   = 465<br />emailConfig.Fields(&quot;http://schemas.microsoft.com/cdo/configuration/sendusing&quot;)        = 2<br />emailConfig.Fields(&quot;http://schemas.microsoft.com/cdo/configuration/smtpauthenticate&quot;) = 1<br />emailConfig.Fields(&quot;http://schemas.microsoft.com/cdo/configuration/smtpusessl&quot;)       = true<br />emailConfig.Fields(&quot;http://schemas.microsoft.com/cdo/configuration/sendusername&quot;)     = fromEmail<br />emailConfig.Fields(&quot;http://schemas.microsoft.com/cdo/configuration/sendpassword&quot;)     = password<br />emailConfig.Fields.Update<br /><br />emailObj.Send<br /><br />Set emailobj	= nothing<br />Set emailConfig	= nothing</div></blockquote><br /><br />about the detection of the active user i really don't know but if u knew any thing post the result  please</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p16091" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile16091">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistb857.html?mode=viewprofile&amp;u=2812" class="username">abc0502</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchb539.html?author_id=2812&amp;sr=posts">1007</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 26 Oct 2011 22:38</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Egypt</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content16091">

						<h3 ><a href="#p16091">Re: How To Detect User Interacting With Console vs. Auto Tas</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingcab6.html?mode=quote&amp;f=3&amp;p=16091" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic1a0d.html?p=16091#p16091" onclick="prompt('Message #5',this.href); return false;">#5</a></span> 
									<a class="unread" href="viewtopic1a0d.html?p=16091#p16091" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistb857.html?mode=viewprofile&amp;u=2812" class="username">abc0502</a></strong> &raquo; </span>08 May 2012 10:20
			</p>
			
			
			
			<div class="content">I could have found a way to detect if user there or not<br /><blockquote class="uncited"><div>@echo off<br />cls<br />setlocal<br />For /f &quot;skip=1 tokens=1&quot; %%a in ('wmic cpu get loadPercentage') do set CPU_usage=%%a<br />If %CPU_usage% GEQ <span style="color: #FF0000">5</span> ( <span style="color: #0000FF">Echo User Exist</span><br />) Else ( <span style="color: #0000FF">Echo User absent</span> )<br /><br /><span style="color: #008000">:: this will check for CPU usage if the user exist he must be running some programs so the usage could be more than 5% but if he running automatic script the usage will be low<br /><br />:: This is not accurate so change the 5 in red to what give u more accurate results<br />:: Change the blue command with ur's to send u a message or any command u want</span> </div></blockquote><br />u can also check if the screen saver process is active so the user must be not there and running scripts automatically<br /><br /><span style="color: #0000FF">Read the notes in</span> <span style="color: #008000">green</span><br />if that wasn't helpful check the <span style="color: #BF0000">wmic </span>command the answer could be there<br /><br />and have a look at this <a href="http://ochafik.com/blog/?p=98" class="postlink">http://ochafik.com/blog/?p=98</a></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p16104" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile16104">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistde6f.html?mode=viewprofile&amp;u=3672" class="username">Hewlit</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchc8e8.html?author_id=3672&amp;sr=posts">2</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 07 May 2012 03:50</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content16104">

						<h3 ><a href="#p16104">Re: How To Detect User Interacting With Console vs. Auto Tas</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting1f24.html?mode=quote&amp;f=3&amp;p=16104" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic0a70.html?p=16104#p16104" onclick="prompt('Message #6',this.href); return false;">#6</a></span> 
									<a class="unread" href="viewtopic0a70.html?p=16104#p16104" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistde6f.html?mode=viewprofile&amp;u=3672" class="username">Hewlit</a></strong> &raquo; </span>09 May 2012 03:12
			</p>
			
			
			
			<div class="content">Thanks for your answers!<br /><br />I allready use a small utility software to send emails. It's called sendEmail and it exists both for Unix/Linux and Windows.<br />I'll try to be more specific about my needs. The scripts I'm working on are for the maintanence of a DataBase (Oracle and later on SQL Server). Some of those scripts will be launched by the server hosting the DataBase. Now I don't know very much about how servers work under Oracle (even less under Microsoft), but from what I understood, when a task needs to execute itself, it demands the creation of a &quot;process&quot; to the main processor. It goes on and continues to login into the OS using one of the administrator accounts (the same ones DBAs use). And then it does its job.<br /><br />Now, I can't be sure of the amount of CPU a human user uses, versus the amout a background task (like described above) uses. And even so, I don't know if the Oracle Server simulates the existance of a virtual CPU when a user/task logs in. If it does, an amount like 5-10% shoud do the job. But maybe the Oracle Server uses its main CPU power, and in this case, considering that there is a DataBase running, and other users connecting to it, the CPU usage should be considerably higher. So I don't think it's a safe bet to use the CPU purcentage.<br /><br />I also thought about setting a timer and asking a question. But you know, DBAs might go grab a coffee, come back 10min later and the mail would be allready sent although they were there nearby. <br /><br />The further I search, the more it seems impossible to do. Unfortunately, at least Windows beheaves the same whether there is a user logged in or a task, using the same account. So there seems to be no differences in the seesions IDs, console IDs, etc. Which untinl now makes it impossible to differentiate the two.<br /><br />Anyways, I'll be looking for a way to make this work, and when I do find one, I'll post it here.<br />Thanks again for all your answers!</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p16111" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile16111">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist306a.html?mode=viewprofile&amp;u=592" class="username">alan_b</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search3aa7.html?author_id=592&amp;sr=posts">357</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 04 Oct 2008 09:49</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content16111">

						<h3 ><a href="#p16111">Re: How To Detect User Interacting With Console vs. Auto Tas</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting19ac-2.html?mode=quote&amp;f=3&amp;p=16111" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicae99.html?p=16111#p16111" onclick="prompt('Message #7',this.href); return false;">#7</a></span> 
									<a class="unread" href="viewtopicae99.html?p=16111#p16111" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist306a.html?mode=viewprofile&amp;u=592" class="username">alan_b</a></strong> &raquo; </span>09 May 2012 09:20
			</p>
			
			
			
			<div class="content">Why not show each message so that it can be seen by the &quot;user&quot; if/when present,<br />AND also append to a log.<br /><br />The log file can be sent by email at the completion of the maintenance updates,<br />and/or can be reviewed by the local user when he returns from a &quot;comfort break&quot; etc,<br />and/or emailed to the &quot;administrator&quot; at an automatic scheduled time unless the local user first returns and cancels the email<br />(and would presumably also deal with the issues).<br /><br />That way you only code the message display and log creation once,<br />after which it is down to users/administrators to fine tune the timing and conditions under which the email is sent.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p16112" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile16112">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistb857.html?mode=viewprofile&amp;u=2812" class="username">abc0502</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchb539.html?author_id=2812&amp;sr=posts">1007</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 26 Oct 2011 22:38</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Egypt</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content16112">

						<h3 ><a href="#p16112">Re: How To Detect User Interacting With Console vs. Auto Tas</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinge457.html?mode=quote&amp;f=3&amp;p=16112" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicc763.html?p=16112#p16112" onclick="prompt('Message #8',this.href); return false;">#8</a></span> 
									<a class="unread" href="viewtopicc763.html?p=16112#p16112" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistb857.html?mode=viewprofile&amp;u=2812" class="username">abc0502</a></strong> &raquo; </span>09 May 2012 10:10
			</p>
			
			
			
			<div class="content">The link at the end of my last post was a java code (<span style="color: #0000FF">work for windows and could be modified to work on UNIX</span>) that detect the last movement of the mouse and the keyboard, I don't understand java so i couldn't try it, It calculate the time between the movement of a mouse and cause there is no automated tasks that use mouse u can use that to know if there is a user in front of the pc or not and for more accuracy  u send hem a message just to make sure.<br />If u understand java u should give it a try, and also there is the <span style="color: #FF0000">GetLastInputInfo method in user32.dll</span><br />it was mentioned in the link and here is the Microsoft support page of it,<br /><a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms646302(v=vs.85).aspx" class="postlink">http://msdn.microsoft.com/en-us/library/windows/desktop/ms646302%28v=vs.85%29.aspx</a></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p16113" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile16113">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist2675.html?mode=viewprofile&amp;u=2988" style="color: #00AA00;" class="username-coloured">Squashman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1322.html?author_id=2988&amp;sr=posts">3970</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 Dec 2011 13:59</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content16113">

						<h3 ><a href="#p16113">Re: How To Detect User Interacting With Console vs. Auto Tas</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting26fb.html?mode=quote&amp;f=3&amp;p=16113" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic0035.html?p=16113#p16113" onclick="prompt('Message #9',this.href); return false;">#9</a></span> 
									<a class="unread" href="viewtopic0035.html?p=16113#p16113" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist2675.html?mode=viewprofile&amp;u=2988" style="color: #00AA00;" class="username-coloured">Squashman</a></strong> &raquo; </span>09 May 2012 10:53
			</p>
			
			
			
			<div class="content">What if we did something like doing a SCHTASKS query and piping that to the FINDSTR command to find %0?</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p16116" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile16116">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistb857.html?mode=viewprofile&amp;u=2812" class="username">abc0502</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchb539.html?author_id=2812&amp;sr=posts">1007</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 26 Oct 2011 22:38</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Egypt</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content16116">

						<h3 ><a href="#p16116">Re: How To Detect User Interacting With Console vs. Auto Tas</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingd4d7-2.html?mode=quote&amp;f=3&amp;p=16116" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicb05f-2.html?p=16116#p16116" onclick="prompt('Message #10',this.href); return false;">#10</a></span> 
									<a class="unread" href="viewtopicb05f-2.html?p=16116#p16116" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistb857.html?mode=viewprofile&amp;u=2812" class="username">abc0502</a></strong> &raquo; </span>09 May 2012 12:35
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>Squashman wrote:</cite>What if we did something like doing a SCHTASKS query and piping that to the FINDSTR command to find %0?</div></blockquote><br />The Problem here is find what string he doesn't know the task, it could be any thing.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p16118" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile16118">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist77fa.html?mode=viewprofile&amp;u=1506" class="username">miskox</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search184b.html?author_id=1506&amp;sr=posts">323</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 28 Jun 2010 03:46</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content16118">

						<h3 ><a href="#p16118">Re: How To Detect User Interacting With Console vs. Auto Tas</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting9bde.html?mode=quote&amp;f=3&amp;p=16118" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopica650.html?p=16118#p16118" onclick="prompt('Message #11',this.href); return false;">#11</a></span> 
									<a class="unread" href="viewtopica650.html?p=16118#p16118" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist77fa.html?mode=viewprofile&amp;u=1506" class="username">miskox</a></strong> &raquo; </span>09 May 2012 15:20
			</p>
			
			
			
			<div class="content">One way would be like this:<br /><br />- under the scheduled task you add a unique parameter and when job executes batch file will know that it was run as a scheduled task:<br /><br />Under Scheduled tasks:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>Run: yourbatch.cmd &quot;SCHEDULED_TASK&quot;<br /></code></pre></div><br /><br />Another idea:<br /><br />- under which account a scheduled task runs? Probably DOMAIN\Admin or something and not a local user? Then you should check for a user when batch runs.<br /><br />Saso</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p16123" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile16123">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf147.html?author_id=3221&amp;sr=posts">6033</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Feb 2012 02:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content16123">

						<h3 ><a href="#p16123">Re: How To Detect User Interacting With Console vs. Auto Tas</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting0418.html?mode=quote&amp;f=3&amp;p=16123" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicab86.html?p=16123#p16123" onclick="prompt('Message #12',this.href); return false;">#12</a></span> 
									<a class="unread" href="viewtopicab86.html?p=16123#p16123" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a></strong> &raquo; </span>09 May 2012 18:13
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>Hewlit wrote:</cite>Thanks for your answers!<br /><br />I allready use a small utility software to send emails. It's called sendEmail and it exists both for Unix/Linux and Windows.<br />I'll try to be more specific about my needs. The scripts I'm working on are for the maintanence of a DataBase (Oracle and later on SQL Server). Some of those scripts will be launched by the server hosting the DataBase. Now I don't know very much about how servers work under Oracle (even less under Microsoft), but from what I understood, when a task needs to execute itself, it demands the creation of a &quot;process&quot; to the main processor. It goes on and continues to login into the OS using one of the administrator accounts (the same ones DBAs use). And then it does its job.<br /><br />I also thought about setting a timer and asking a question. But you know, DBAs might go grab a coffee, come back 10min later and the mail would be allready sent although they were there nearby. <br /></div></blockquote><br /><br />What you could use is a program that hooks into the keyboard and mouse and keeps a time of when either was last changed (so either KB used or mouse moved).<br /><br />It's not an ability of batch files, to my knowledge, but maybe there is something out there in google?</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p16209" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile16209">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistb857.html?mode=viewprofile&amp;u=2812" class="username">abc0502</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchb539.html?author_id=2812&amp;sr=posts">1007</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 26 Oct 2011 22:38</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Egypt</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content16209">

						<h3 ><a href="#p16209">Re: How To Detect User Interacting With Console vs. Auto Tas</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting60f3-2.html?mode=quote&amp;f=3&amp;p=16209" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic2552.html?p=16209#p16209" onclick="prompt('Message #13',this.href); return false;">#13</a></span> 
									<a class="unread" href="viewtopic2552.html?p=16209#p16209" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistb857.html?mode=viewprofile&amp;u=2812" class="username">abc0502</a></strong> &raquo; </span>11 May 2012 09:12
			</p>
			
			
			
			<div class="content"><blockquote class="uncited"><div>What you could use is a program that hooks into the keyboard and mouse and keeps a time of when either was last changed (so either KB used or mouse moved).<br /><br />It's not an ability of batch files, to my knowledge, but maybe there is something out there in google?</div></blockquote><br /><br />that what <span style="color: #0000FF">GetLastInputInfo method in user32.dll</span> do, the code is written in java but i don't understand java codes or how to compile it. here is a link <br /><a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms646302(v=vs.85).aspx" class="postlink">http://msdn.microsoft.com/en-us/library/windows/desktop/ms646302%28v=vs.85%29.aspx</a></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p16210" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile16210">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf147.html?author_id=3221&amp;sr=posts">6033</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Feb 2012 02:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content16210">

						<h3 ><a href="#p16210">Re: How To Detect User Interacting With Console vs. Auto Tas</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting1942.html?mode=quote&amp;f=3&amp;p=16210" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicfd14-2.html?p=16210#p16210" onclick="prompt('Message #14',this.href); return false;">#14</a></span> 
									<a class="unread" href="viewtopicfd14-2.html?p=16210#p16210" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a></strong> &raquo; </span>11 May 2012 09:28
			</p>
			
			
			
			<div class="content">There's a script here too for vb<br /><br /><!-- m --><a class="postlink" href="http://www.bigresource.com/VB-pc-idle-state-not-used-by-user-as-screen-savers-work-c8VobwF2hw.html#">http://www.bigresource.com/VB-pc-idle-s ... F2hw.html#</a><!-- m --></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p16223" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile16223">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchdc63.html?author_id=2923&amp;sr=posts">1540</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 06 Dec 2011 22:15</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> México City, México</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content16223">

						<h3 ><a href="#p16223">Re: How To Detect User Interacting With Console vs. Auto Tas</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting869a.html?mode=quote&amp;f=3&amp;p=16223" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic2618-2.html?p=16223#p16223" onclick="prompt('Message #15',this.href); return false;">#15</a></span> 
									<a class="unread" href="viewtopic2618-2.html?p=16223#p16223" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a></strong> &raquo; </span>11 May 2012 11:33
			</p>
			
			
			
			<div class="content">I think this method should work: If any task/process/whichever create an automated sub-process it knows no user will be there to enter any input to the sub-process, so when it create the sub-process it will redirect stdin to a file or pipe; otherwise, if the sub-process requires any input it will wait until a human being reply to it. This is true even if the subprocess does not read anything.<br /><br />On the other hand, if a human being execute a sub-process, he/she will expect to enter any interactive input to it. This is true even if the subprocess does not read anything. If the human being launched a sub-process in an automated way (with stdin redirected to a file or pipe), then this sub-process will be indistinguishable from any other sub-process created by a task/process/whichever. I think the key point here is if the sub-process will expect to have any interactive interchange with an human being in the console or not.<br /><br />This way, to detect if a sub-process was launched by another process or by an human being, just check if its stdin is redirected to a disk file (automated) or to the console (human being).</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
	

	<div class="action-bar bar-bottom">
	
			<a href="postingd779-2.html?mode=reply&amp;f=3&amp;t=3298" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic80e7.html?f=3&amp;t=3298&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

			<form method="post" action="https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=3298">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			17 posts
							<ul>
		<li class="active"><span>1</span></li>
				<li><a class="button" href="viewtopic9b93-2.html?f=3&amp;t=3298&amp;start=15" role="button">2</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopic9b93-2.html?f=3&amp;t=3298&amp;start=15" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="viewforum4d6b.html?f=3" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to “DOS Batch Forum”</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="viewforum31e6.html?f=4" class="jumpbox-cat-link"> <span> DosTips - Dos Batch</span></a></li>
																<li><a href="viewforum4d6b.html?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; DOS Batch Forum</span></a></li>
											</ul>
		</div>
	</div>

	</div>


			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
							<span class="crumb"><a href="../index.html" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>DosTips.com</span></a></span>									<span class="crumb"><a href="index.html" data-navbar-reference="index"><span>Board index</span></a></span>					</li>
		
				<li class="rightside">All times are <span title="UTC-6">UTC-06:00</span></li>
							<li class="rightside">
				<a href="ucp033a.html?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete all board cookies</span>
				</a>
			</li>
												<li class="rightside" data-last-responsive="true">
				<a href="memberlist4bfd.html?mode=team" role="menuitem">
					<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
				</a>
			</li>
									<li class="rightside" data-last-responsive="true">
				<a href="memberlist8733.html?mode=contactadmin" role="menuitem">
					<i class="icon fa-envelope fa-fw" aria-hidden="true"></i><span>Contact us</span>
				</a>
			</li>
			</ul>

	</div>
</div>

	<div class="copyright">
				<!-- WARNING NO DELETE -->Style developer by <a href="http://tricolor.x-tk.ru/">support forum tricolor</a>, <!-- END WARNING NO DELETE -->Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
									</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	<img src="cron68e3.gif?cron_type=cron.task.text_reparser.pm_text" width="1" height="1" alt="cron" /></div>

<script type="text/javascript" src="assets/javascript/jquery.mind772.js?assets_version=34"></script>
<script type="text/javascript" src="assets/javascript/cored772.js?assets_version=34"></script>



<script type="text/javascript" src="styles/prosilver/template/forum_fnd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/prosilver/template/ajaxd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/jquery-uid772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/collapsed772.js?assets_version=34"></script>



</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=3298 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 09:26:43 GMT -->
</html>
