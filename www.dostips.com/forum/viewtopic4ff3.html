<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=7402&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 05:12:01 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>DosTips.com &bull; Cmdwiz - cmd helper tools (now with Unicode)</title>

<link href="styles/AllanStyle-SUBSILVER/theme/print.css" rel="stylesheet">
</head>
<body id="phpbb">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>DosTips.com</h1>
		<p>A Forum all about DOS Batch<br /><a href="index-2.html">https://www.dostips.com/forum/</a></p>

		<h2>Cmdwiz - cmd helper tools (now with Unicode)</h2>
		<p><a href="viewtopic684d.html?f=3&amp;t=7402">https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=7402</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>1</strong> of <strong>3</strong></div>
					<div class="post">
				<h3>Cmdwiz - cmd helper tools (now with Unicode)</h3>
				<div class="date">Posted: <strong>10 Sep 2016 19:46</strong></div>
				<div class="author">by <strong>misol101</strong></div>
				<div class="content">This program has been wedged in between my other two programs cmdgfx.exe and gotoxy.exe for some time. This thread is mostly to get some documentation up.<br>
<br>
<strong class="text-strong">Now supports Unicode!</strong><br>
<br>
<strong class="text-strong">What is it?</strong><br>
Cmdwiz is a helper tool to do all sorts of useful things in batch scripts (and outside).<br>
<br>
<strong class="text-strong">Where is it?</strong><br>
I don't want to maintain yet another archive so I'll point to gotoxy.zip, where cmdwiz.exe is included: <a href="http://www.mediafire.com/download/8xywdi36hca4dgo/gotoxy.zip" class="postlink">http://www.mediafire.com/download/8xywd ... gotoxy.zip</a><br>
(open link in new tab if it doesn't load)<br>
<br>
<strong class="text-strong">What operations does cmdwiz support?</strong><br>
As of CmdWiz v1.2, there are currently 50 of them, and they can be divided as follows:<br>

<ul><li><strong class="text-strong">1. Set/get windows/cmd buffer size, position and look</strong><br>
<strong class="text-strong">2. Reading input from keyboard and/or mouse</strong><br>
<strong class="text-strong">3. Setting and saving the current console font</strong><br>
<strong class="text-strong">4. Get character and colors in the buffer/system</strong><br>
<strong class="text-strong">5. Setting the cursor position/look and writing text</strong><br>
<strong class="text-strong">6. Working with strings</strong><br>
<strong class="text-strong">7. Working with timing/delay</strong><br>
<strong class="text-strong">8. Moving and clicking with the mouse cursor and sending key events</strong><br>
<strong class="text-strong">9. Moving, saving or examining blocks of characters</strong><br>
<strong class="text-strong">10. Miscellaneous operations</strong></li></ul>

All operations support "cmdwiz operation /?" to get info on arguments and return values.<br>
<br>
There are no operations to write colored text or special characters, which might be expected in a tool such as this.<br>
<br>
This is because all that is done by my other tool "gotoxy.exe" (see <a href="viewtopiccd0f.html?f=3&amp;t=7129" class="postlink">http://www.dostips.com/forum/viewtopic.php?f=3&amp;t=7129</a>), which has many ways to accomplish that task and much more (note: gotoxy.exe is also included in the above archive).<br>
<br>
Also, for more heavy graphics and games, there is "cmdgfx.exe", see <a href="viewtopic9d55.html?f=3&amp;t=7153" class="postlink">http://www.dostips.com/forum/viewtopic.php?f=3&amp;t=7153</a>.<br>
<br>
<br>
<strong class="text-strong">Note on arguments:</strong><br>
I don't follow the normal convention where arguments surrounded by [] are strictly optional.<br>
<br>
For cmdwiz (and my other tools), arguments surrounded by [] ARE optional, *but* if you want to specify the following argument(s) (in order from Left to Right), then they are NOT optional.<br>
<br>
<em class="text-italics">Example: cmdwiz operation [op1] [op2] [op3 op4]</em><br>
<br>
Here, op1 is optional, as is op2, but to specify op2 you must specify op1. Next comes op3 and op4, for which op1 and op2 must both be given first. Op3/op4 must be specified together, since they are within the same block.<br>
<br>
To write the above strictly correct, it would look like: <em class="text-italics">cmdwiz operation [op1 [op2 [op3 op4]]]</em>, which I personally find confusing, so I just don't.<br>
<br>
Think of it as default arguments in a C++ function. Hopefully the operation is constructed so that you should not want to specify op2 without specifying op1 (though not always true)</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Cmdwiz - cmd helper tools</h3>
				<div class="date">Posted: <strong>10 Sep 2016 20:22</strong></div>
				<div class="author">by <strong>misol101</strong></div>
				<div class="content"><strong class="text-strong">1. Set/get the cmd/windows buffer size, position and look</strong><br>
<br>
Operations: getconsoledim, setbuffersize, getdisplaydim, getwindowbounds, setwindowpos, setwindowtransparency, setwindowstyle, getwindowstyle, setpalette, getpalette, fullscreen, showwindow, setwindowsize, windowlist<br>
<br>
<strong class="text-strong">1.0 Using other windows than the console window</strong><br>
<br>
Since CmdWiz 1.2, a number of operations can be used for other windows than the console window. These operations are: setwindowpos, setwindowsize, getwindowbounds, setwindowtransparency, showwindow, getwindowstyle, setwindowstyle, insertbmp<br>
<br>
In order to specify which window to be affected, the <strong class="text-strong">last</strong> argument of the operation must follow this form:<br>
<br>
<em class="text-italics">[/h:HWND|/p:pId|/t:tId|"/n:processName"|"/w:windowTitle"]</em><br>
<br>
This data can (but does not have to) be obtained by using the cmdwiz <em class="text-italics">windowlist </em>operation.<br>
<br>
Note that only one of the options may be used. No spaces are allowed between the switch and the data<br>
<br>
/h: must specify the window handle. This handle is guaranteed to be unique per window.<br>
/p: must specify the process id. This id is not necessarily unique. The Cmdwiz operation will stop once it finds the first window with this processId.<br>
/t: must specify the thread id. This does not appear to work in all cases. Another approach is recommended if possible.<br>
"/n:" must specify the process name. The whole parameter must be within quotes if the name contains spaces. The process name is not necessarily unique per window. Note that the name must match exactly, except that is it not case sensitive.<br>
"/w:" must specify the window title. The whole parameter must be within quotes if the title contains spaces. The title is not necessarily unique per window. Note that the title must match exactly, and it IS case sensitive.<br>
<br>
RETURN VALUE: Using another window only affects the returned errorlevel value if the operation fails to find the specified window. In this case, the operation will return -1.<br>
<br>
Also note that using an operation with a window does not automatically display the window or put it on top of other windows. To make this happen, use the <em class="text-italics">showwindow </em>operation with the argument <em class="text-italics">top</em>.<br>
<br>
<br>
<strong class="text-strong">1.1 getconsoledim</strong><br>
<br>
Prints column/row dimensions of current console, OR returns one of these dimensions in ERRORLEVEL. <br>
<br>
<em class="text-italics">Usage: cmdwiz getconsoledim [w|h|sw|sh|cx|cy]</em><br>
<br>
Without parameters, getconsoledim will print a line of the form:<br>
<br>
WIDTH 80 HEIGHT 50 SCREEN_WIDTH 80 SCREEN_HEIGHT 50 SCROLL_X 0 SCROLL_Y 0<br>
<br>
WIDTH and HEIGHT are the actual number of columns and rows of the console buffer, SCREEN_WIDTH/SCREEN_HEIGHT is the amount of visible columns/rows on the screen, and SCROLL_X/SCROLL_Y is the "position" in the buffer, i.e how far we have scrolled into the buffer from the top left position.<br>
<br>
If supplying a parameter, nothing is printed, but the requested dimension is returned in ERRRORLEVEL. Use w/h for WIDTH/HEIGHT, sw/sh for SCREEN_WIDTH/SCREEN_HEIGHT, cx/cy for SCROLL_X/SCROLL_Y values.<br>
<br>
<br>
<strong class="text-strong">1.2 setbuffersize</strong><br>
<br>
Set the scroll buffer column/row size. It is not a replacement for "mode", since it does not change the number of visible columns/rows, only the size of the scroll buffer.<br>
<br>
<em class="text-italics">Usage: cmdwiz setbuffersize [width|keep|- height|keep|-]</em><br>
<br>
The value(s) given can not be smaller than the currently visible number of columns/rows.<br>
<br>
For both width and height, you can specify "keep" (or short "k") to mean "keep current value".<br>
<br>
To remove a scrollbar (if present), use - for width and/or height. <br>
<br>
<br>
<strong class="text-strong">1.3 getdisplaydim</strong><br>
<br>
Get the width or height of the Windows desktop. This may be useful to e.g position the console window with setwindowpos.<br>
<br>
<em class="text-italics">Usage: cmdwiz getdisplaydim [w|h]</em><br>
<br>
The requested dimension is returned in ERRORLEVEL.<br>
<br>
<br>
<strong class="text-strong">1.4 getwindowbounds</strong><br>
<br>
Get the position of the console window (or other window) in screen coordinates or its width/height in pixels.<br>
<br>
<em class="text-italics">Usage: cmdwiz getwindowbounds [x|y|w|h] [/h:HWND|/p:pId|/t:tId|"/n:processName"|"/w:windowTitle"]</em><br>
<br>
The requested value is returned in ERRORLEVEL. For w/h, keep in mind that these values include the borders of the window (yes, that includes those annoying invisible borders in Windows 10 too)<br>
<br>
See 1.0 for information on how to use the last parameter to affect another window than the console window.<br>
<br>
<br>
<strong class="text-strong">1.5 setwindowpos</strong><br>
<br>
Set the position of the console window (or other window) in screen coordinates.<br>
<br>
<em class="text-italics">Usage: cmdwiz setwindowpos [x|keep y|keep] [/h:HWND|/p:pId|/t:tId|"/n:processName"|"/w:windowTitle"]</em><br>
<br>
For both x and y, you can specify "keep" (or short "k") to mean "keep current coordinate". <br>
<br>
See 1.0 for information on how to use the last parameter to affect another window than the console window.<br>
<br>
<br>
<strong class="text-strong">1.6 setwindowtransparency</strong><br>
<br>
Sets the transparency level of the console window (or other window). The whole window is affected.<br>
<br>
<em class="text-italics">Usage: cmdwiz setwindowtransparency [0-100] [/h:HWND|/p:pId|/t:tId|"/n:processName"|"/w:windowTitle"]</em><br>
<br>
Note that a value of 100 will make the console window completely invisible!<br>
<br>
See 1.0 for information on how to use the last parameter to affect another window than the console window.<br>
<br>
<br>
<strong class="text-strong">1.7 setwindowstyle</strong><br>
<br>
Sets or clears a flag in the console window (or other window) properties, affecting its look or behaviour.<br>
<br>
<em class="text-italics">Usage: cmdwiz setwindowstyle set|clear standard|extended value1 [value2] ... [/h:HWND|/p:pId|/t:tId|"/n:processName"|"/w:windowTitle"]</em><br>
<br>
This operation is rather tricky to use. Please have a look at these two pages: <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms632600.aspx" class="postlink">https://msdn.microsoft.com/en-us/librar ... 32600.aspx</a> (for 'standard' style values) and <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ff700543.aspx" class="postlink">https://msdn.microsoft.com/en-us/librar ... 00543.aspx</a> (extended style values).<br>
<br>
To set or clear a flag, first determine if it is a standard or extended flag you want to affect, then copy the corresponding value.<br>
<br>
See 1.0 for information on how to use the last parameter to affect another window than the console window.<br>
<br>
Examples: <br>
<br>
Disable mouse resizing of window: <em class="text-italics">cmdwiz setwindowstyle clear standard 0x00040000L</em><br>
<br>
Disable maximizing window: <em class="text-italics">cmdwiz setwindowstyle clear standard 0x00010000L</em><br>
<br>
Disable all input to window (not recommended...) : <em class="text-italics">cmdwiz setwindowstyle set standard 0x08000000L</em><br>
<br>
<br>
<strong class="text-strong">1.8 getwindowstyle</strong><br>
<br>
Checks if a flag of the console window (or other window) properties is set or not.<br>
<br>
<em class="text-italics">Usage: cmdwiz getwindowstyle standard|extended value [/h:HWND|/p:pId|/t:tId|"/n:processName"|"/w:windowTitle"]</em><br>
<br>
Returns ERRORLEVEL 1 if style flag set, otherwise 0.<br>
<br>
See 1.7 for useful links.<br>
<br>
See 1.0 for information on how to use the last parameter to affect another window than the console window.<br>
<br>
Example to check if title bar is enabled: <em class="text-italics">cmdwiz getwindowstyle standard 0x00C00000L</em>, followed by <em class="text-italics">echo %ERRORLEVEL%</em><br>
<br>
<br>
<strong class="text-strong">1.9 setpalette</strong><br>
<br>
Sets one or more colors in the cmd window palette (starting from index 0, max 16 colors)<br>
<br>
<em class="text-italics">Usage: cmdwiz setpalette [RRGGBB[,RRGGBB...]] </em><br>
<br>
Example (set color 0-2 to pink,white,yellow ): cmdwiz setpalette ff0088,ffffff,ffff00<br>
<br>
To restore cmd's default palette, you can use: cmdwiz setpalette 000000,000080,008000,008080,800000,800080,808000,c0c0c0,808080,0000ff,00ff00,00ffff,ff0000,ff00ff,ffff00,ffffff <br>
<br>
<br>
<strong class="text-strong">1.10 getpalette</strong><br>
<br>
Prints the RGB values of the current 16 colors of the cmd window. The string can be used as input for setpalette.<br>
<br>
<em class="text-italics">Usage: cmdwiz getpalette</em><br>
<br>
<br>
<strong class="text-strong">1.11 fullscreen</strong><br>
<br>
Turns fullscreen use on or off for the console window.<br>
<br>
<em class="text-italics">Usage: cmdwiz fullscreen [0|1] [legacy]</em><br>
<br>
<em class="text-italics">Note</em>: The fullscreen operation now uses the official Windows API SetConsoleDisplayMode, whereas previously it used code from carlos fscreen program. However, SetConsoleDisplayMode is not available on older Windows versions such as Windows 7. Therefore, if the initial API call fails, the operation will use the legacy fullscreen mode instead, as well as RETURN ERRORLEVEL -1 to indicate this. <br>
<br>
It is also possible to force legacy mode on all machines using the <em class="text-italics">legacy</em> argument.<br>
<br>
Note that the API and the legacy fullscreen modes look different: in the legacy mode, there are borders around the screen, and also, the bottom task bar is visible. <br>
<br>
<br>
<strong class="text-strong">1.12 showwindow</strong><br>
<br>
Maximize, minimize, or restore the console window (or other window), or set its position in the window hierarchy, or close the window.<br>
<br>
<em class="text-italics">Usage: cmdwiz showwindow [minimize|maximize|restore|topmost|top|bottom|close|value:n] [/h:HWND|/p:pId|/t:tId|"/n:processName"|"/w:windowTitle"]</em><br>
<br>
If you specify the <em class="text-italics">topmost</em> argument, the window will hereafter become a topmost window, i.e. always be on top of other windows. To disable this, set it to <em class="text-italics">top </em>or <em class="text-italics">bottom</em>.<br>
<br>
It is also possible to affect the window in some other ways, using the values at <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms633548(v=vs.85).aspx" class="postlink">https://msdn.microsoft.com/en-us/librar ... s.85).aspx</a><br>
<br>
See 1.0 for information on how to use the last parameter to affect another window than the console window.<br>
<br>
Example: cmdwiz showwindow value:0<br>
<br>
will hide the console window completely. Not recommended, because as far as I know you cannot get it back (but the process is still running, as Task Manager will show)<br>
<br>
<br>
<strong class="text-strong">1.13 setwindowsize</strong><br>
<br>
Set the position of the console window (or other window) in pixels.<br>
<br>
<em class="text-italics">Usage: cmdwiz setwindowsize [w|keep h|keep] [/h:HWND|/p:pId|/t:tId|"/n:processName"|"/w:windowTitle"]</em><br>
<br>
For both w and h, you can specify "keep" (or short "k") to mean "keep current size". <br>
<br>
See 1.0 for information on how to use the last parameter to affect another window than the console window.<br>
<br>
<br>
<strong class="text-strong">1.14 windowlist</strong><br>
<br>
Print a list of all (titled) main windows to stdout.<br>
<br>
<em class="text-italics">Usage: cmdwiz windowlist [all]</em><br>
<br>
The output format is the following: <em class="text-italics">window handle|process ID|thread ID|process name|window title</em><br>
<br>
Use the 'all' argument to include untitled windows in the list as well.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Cmdwiz - cmd helper tools</h3>
				<div class="date">Posted: <strong>10 Sep 2016 20:27</strong></div>
				<div class="author">by <strong>misol101</strong></div>
				<div class="content"><strong class="text-strong">2. Reading input from keyboard and/or mouse</strong><br>
    <br>
Operations: getch, getkeystate, getch_and_mouse, getch_or_mouse, getmouse, flushkeys, getquickedit, setquickedit<br>
<br>
<br>
<strong class="text-strong">2.1 getch</strong><br>
<br>
Return scan code of first key in queue, if any.<br>
<br>
<em class="text-italics">Usage: cmdwiz getch [noWait]</em><br>
<br>
The key Scan Code is returned in ERRORLEVEL, or 0 if no key was pressed.<br>
<br>
If "noWait" is specified, the operation does not block waiting for a key press.<br>
<br>
If you want to know the scan codes of some keys for a script, you can either:<br>
<br>
1. Find it here: <a href="https://msdn.microsoft.com/en-us/library/aa299374(v=vs.60).aspx" class="postlink">https://msdn.microsoft.com/en-us/librar ... s.60).aspx</a> . For special keys, such as F1, Home, Cursor keys etc, add 256 to the value. So e.g. Shift-F1 would be 256+84 = 340.<br>
2. Use a little loop to print out the scan codes you are interested in, e.g (use Ctrl-Break to end): <em class="text-italics">for /L %a in (1,1,1000) do @cmdwiz getch&amp;echo !errorlevel!</em><br>
<br>
For non-special keys, you could use this in a script to re-map scancodes back into letters/numbers etc:<br>

<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>set SCHR="()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\] _ abcdefghijklmnopqrstuvwxyz{|}~"
cmdwiz getch&amp;set KEY=!errorlevel!
set LKEY=""
set /A INDEX=%KEY%-40+1
if %KEY% leq 126 if %KEY% geq 40 set LKEY="!SCHR:~%INDEX%,1!"
echo %LKEY%
</code></pre></div>

<br>
<strong class="text-strong">2.2 getkeystate</strong><br>
<br>
Get the state (pressed or not) of specified keys. This is useful for example if you do not want to wait for key repeat, or if you want to check keys such as Shift/Ctrl/Alt etc.<br>
<br>
<em class="text-italics">Usage: cmdwiz getkeystate [all|[l|r]ctrl|[l|r]alt|[l|r]shift|[0x]VKEY[h]] [VK2] ...</em><br>
<br>
This command has double output. It will return a bit pattern in ERRORLEVEL representing the pressed state of the given keys, as well as print the states to stdout. If you do not want the printed output, redirect it to nul.<br>
<br>
The virtual-key codes needed to check a specific key unfortunately do NOT correspond to the scan codes of the "getch" operation. See this link for codes: <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/dd375731(v=vs.85).aspx" class="postlink">https://msdn.microsoft.com/en-us/librar ... 85%29.aspx</a> . In order to check for e.g. "A", you would need to check the pressed state of both VK_SHIFT and 41h ("a").<br>
<br>
The virtual-key code input to getkeystate is either decimal or hexadecimal(followed by 'h'). Hexadecimal is recommended, since it can be taken straight from the above link. There are also shorthands for ctrl, alt and shift (and their left/right versions). The keyword "all" is short for: [shift lshift rshift ctrl lctrl rctrl alt lalt ralt]<br>
<br>
For the output, bit 1 is set if the first given key is pressed, bit 2 is set if the second given key is pressed, etc. The same pattern is true for the written output.<br>
<br>
If you are not familiar with bitwise operations then it will probably be easier to redirect the written output to a file and parse that than to use ERRORLEVEL. However, using ERRORLEVEL is likely to be slightly faster and leaves no file traces if you redirect to nul.<br>
<br>
To see this operation in action, try: <em class="text-italics">for /L %a in (1,1,5000) do @cmdwiz getkeystate lalt 20h 70h 27</em><br>
<br>
We are checking four keys here: Left-Alt, 20h=Space, 70h=F1, 27=Escape<br>
Pressing and holding one or more of these keys will change 0 to 1 for that key.<br>
<br>
To check these keys in a script, here is an example batch file that will hopefully make things a bit more clear:<br>

<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off
setlocal
:REPEAT
cmdwiz getkeystate lalt 20h 70h 27&gt;ks.dat

:: Use errorlevel to get results
set KS=%errorlevel%
set /a "IS_LALT_PRESSED=%KS% &amp; 1, IS_SPACE_PRESSED=%KS% &amp; 2, IS_F1_PRESSED=%KS% &amp; 4, IS_ESC_PRESSED=%KS% &amp; 8"
if %IS_LALT_PRESSED% gtr 0 echo Bitpattern says: Left-Alt pressed
if %IS_SPACE_PRESSED% gtr 0 echo Bitpattern says: Space pressed
if %IS_F1_PRESSED% gtr 0 echo Bitpattern says: F1 pressed

:: OR, use written output to get results
for /F "tokens=1,2,3,4 delims= " %%a in (ks.dat) do set IS_LALT_PRESSED=%%a&amp; set IS_SPACE_PRESSED=%%b&amp; set IS_F1_PRESSED=%%c&amp; set IS_ESC_PRESSED=%%d
if %IS_LALT_PRESSED% gtr 0 echo Output says: Left-Alt pressed
if %IS_SPACE_PRESSED% gtr 0 echo Output says: Space pressed
if %IS_F1_PRESSED% gtr 0 echo Output says: F1 pressed

if %IS_ESC_PRESSED% == 0 goto REPEAT

del /q ks.dat&gt;nul
endlocal
</code></pre></div>

<br>
<strong class="text-strong">2.3 getch_and_mouse</strong><br>
<br>
There are three operations to get mouse input: <em class="text-italics">getch_and_mouse, getch_or_mouse</em>, and <em class="text-italics">getmouse</em>. The written output from all three follows the exact same pattern, while the ERRORLEVEL output differs slightly.<br>
<br>
This operation reports both mouse events and key events that occured since the last run.<br>
<br>
<em class="text-italics">Usage: cmdwiz getch_and_mouse [maxWait_ms]</em><br>
<br>
The operation will wait forever for an event unless maxWait_ms (time in milliseconds) is set.<br>
<br>
The output from the program comes in two forms. The first is written output. In case there is no event (that is, if the timer timed out), the output will be:<br>
<br>
<em class="text-italics">NO_EVENT</em><br>
<br>
Otherwise, it will have the following form:<br>
<br>
<em class="text-italics">EVENT KEY_EVENT 0 MOUSE_EVENT 1 MOUSE_X 22 MOUSE_Y 36 LEFT_BUTTON 0 RIGHT_BUTTON 0 LEFT_DOUBLE_CLICK 0 RIGHT_DOUBLE_CLICK 0 MOUSE_WHEEL 0</em><br>
<br>
If MOUSE_EVENT is 0, then there was no mouse event and the rest of the mouse values can be ignored. If KEY_EVENT is 0, then no key was pressed. <br>
<br>
Any reported key code has the same scan-code values as used by the operation "getch".<br>
<br>
Alternatively, you can read the ERRORLEVEL to get the event information. If there were no events (time-out) the result is -1. Otherwise, the bit pattern follows the form:<br>
<br>
<em class="text-italics">kkkkkkkkkyyyyyyyxxxxxxxxWwRLrlM</em><br>
<br>
where M is set if there was a Mouse event, l/L is single/double left click, r/R is single/double right click, w/W is mouse wheel up/down, x/y are mouse coordinates, and k is the KEY (0 means no key pressed)<br>
<br>
<br>
If you are not familiar with bitwise operations then it will probably be easier to redirect the written output to a file and parse that than to use ERRORLEVEL. However, using ERRORLEVEL is likely to be slightly faster and leaves no file traces if you redirect to nul.<br>
<br>
BUT it is also important to note that because of the limited space of the 32 bit value of ERRORLEVEL, there is a max x value of 255 (8 bits) and a max y value of 127 (7 bits) for the column/row. Using the written output there is no such limitation.<br>
<br>
To see getch_and_mouse in action, try: <em class="text-italics">for /L %a in (1,1,5000) do @cmdwiz getch_and_mouse</em><br>
<br>
Try pressing the keys or moving the mouse around, clicking etc. Note that you might get mouse events even though x/y coordinates don't seem to change. This is because even the tiniest pixel movement by the mouse will create an event, but it might not change the column and/or row, which are typically several pixels wide/high.<br>
<br>
To parse the output in a script, here is an example batch file that will hopefully make things a bit more clear:<br>

<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off
setlocal
:REPEAT
cmdwiz getch_and_mouse&gt;mo.dat

:: Use errorlevel to get results
set MR=%errorlevel%
if %MR%==-1 set KEY=0&amp;goto SKIP
set /a "KEY=(%MR%&gt;&gt;22), MOUSE_EVENT=%MR% &amp; 1, LMB=(%MR% &amp; 2)&gt;&gt;1, RMB=(%MR% &amp; 4)&gt;&gt;2, LDBL=(%MR% &amp; 8)&gt;&gt;3, RDBL=(%MR% &amp; 16)&gt;&gt;4, MWD=(%MR% &amp; 32)&gt;&gt;5, MWU=(%MR% &amp; 64)&gt;&gt;6, MX=(%MR%&gt;&gt;7) &amp; 255, MY=(%MR%&gt;&gt;15) &amp; 127"
if "%MOUSE_EVENT%"=="0" echo Errorlevel says: Key value: %KEY% &amp; goto SKIP
echo Errorlevel says: Mouse x,y: %MX%,%MY% LMB=%LMB% RMB=%RMB% LDBL=%LDBL% RDBL=%RDBL% UP=%MWU% DOWN=%MWD%
:SKIP

:: Use written output to get results
for /F "tokens=1,3,5,7,9,11,13,15,17,19,21 delims= " %%a in (mo.dat) do set EVENT=%%a&amp;set KEY=%%b&amp;set MOUSE_EVENT=%%c&amp;set MX=%%d&amp;set MY=%%e&amp;set LMB=%%f&amp;set RMB=%%g&amp;set LDBL=%%h&amp;set RDBL=%%i&amp;set MWHEEL=%%j
if "%EVENT%"=="NO_EVENT" set KEY=0&amp;goto SKIP2
if "%MOUSE_EVENT%"=="0" echo Written output says: Key value: %KEY% &amp; goto SKIP2
echo Written output says: Mouse x,y: %MX%,%MY% LMB=%LMB% RMB=%RMB% LDBL=%LDBL% RDBL=%RDBL% WHEEL=%MWHEEL%
:SKIP2
echo.

if not %KEY% == 27 goto REPEAT

del /q mo.dat&gt;nul
endlocal
</code></pre></div>

<br>
<strong class="text-strong">2.4 getch_or_mouse</strong><br>
<br>
Get key or mouse events. Very similar to "getch_and_mouse" but does not report both mouse and key events at the same time.<br>
<br>
<em class="text-italics">Usage: cmdwiz getch_or_mouse [maxWait_ms]</em><br>
<br>
The printed output looks exactly the same as for getch_and_mouse (see above).<br>
<br>
For ERRORLEVEL, the value is -1 if there was no event (time-out). If there was a mouse event, the pattern is:<br>
<br>
<em class="text-italics">yyyyyyyyyyxxxxxxxxxxx---WwRLrl0</em><br>
<br>
and if there was a key event, the pattern is:<br>
<br>
<em class="text-italics">kkkkkkkkkk1</em><br>
<br>
This means that the first bit determines if it is a key or mouse event.<br>
<br>
Parsing the mouse event from ERRORLEVEL is the same as for getch_and_mouse, except for the x and y coordinates. Use "(!errorlevel!&gt;&gt;10) &amp; 2047" and "(!errorlevel!&gt;&gt;21 &amp; 1023" to get them.<br>
<br>
Note that you can get larger x/y values than for "getch_and_mouse", max x is 2047 instead of 511 and max y is 1023 instead of 127.<br>
<br>
<br>
<strong class="text-strong">2.5 getmouse</strong><br>
<br>
Get mouse events.<br>
<br>
<em class="text-italics">Usage: cmdwiz getmouse [maxWait_ms]</em><br>
<br>
getmouse is very similar to "getch_or_mouse", except it does not report key events.<br>
<br>
The ERRORLEVEL pattern is the same, except the first bit can be ignored<br>
<br>
<em class="text-italics">yyyyyyyyyyxxxxxxxxxxx---WwRLrl-</em><br>
<br>
NOTE: Even though getmouse does not report key events, it will still unfortunately consume the key events it gets. Therefore, calling "cmdwiz getch" after getmouse will not produce the desired result. If you need to get both mouse and key events, use "getch_or_mouse" or "getch_and_mouse" operations. That said, the "getkeystate" operation does work together with "getmouse".<br>
<br>
<br>
<strong class="text-strong">2.6 flushkeys</strong><br>
<br>
Flush all remaining keys in the pressed key buffer<br>
<br>
<em class="text-italics">Usage: cmdwiz flushkeys</em><br>
<br>
If a program lags behind in its processing of keys (by e.g. doing a heavy task while not checking for key presses), there might be any number of queued up key presses to process once that task ends. If you want to discard any remaining unprocessed key presses up until the current point, use the flushkeys operation.<br>
<br>
<br>
<strong class="text-strong">2.7 getquickedit</strong><br>
<br>
Determines whether the console is in quickedit mode. In quick-edit mode, the mouse can be rapidly used to select/copy/paste text with left/right mouse buttons. In case you want to use mouse input in a script it is generally advisable to turn off quickedit.<br>
<br>
<em class="text-italics">Usage: cmdwiz getquickedit</em><br>
<br>
Returns an ERRORLEVEL of 1 if quickedit is enabled, otherwise 0.<br>
<br>
<br>
<strong class="text-strong">2.8 setquickedit</strong><br>
<br>
Enables or diables quickedit mode. See getquickedit for more info.<br>
<br>
<em class="text-italics">Usage: cmdwiz setquickedit [0|1]</em></div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Cmdwiz - cmd helper tools</h3>
				<div class="date">Posted: <strong>11 Sep 2016 14:41</strong></div>
				<div class="author">by <strong>misol101</strong></div>
				<div class="content"><strong class="text-strong">3. Setting and saving the current console font</strong><br /><br />Operations: setfont, savefont<br /><br /><br /><strong class="text-strong">3.1 setfont</strong><br /><br />Sets the current console font based on either a bitmap font index, or a saved font specification file.<br /><br /><em class="text-italics">Usage: cmdwiz setfont [0-9|filename]</em><br /><br />Font index 0 to 9 will set the corresponding bitmap font.<br /><br />If you specify a filename, the file given must have been saved with the &quot;savefont&quot; operation<br /><br /><br /><strong class="text-strong">3.2 savefont</strong><br /><br />Writes specifications of the current font to a file<br /><br /><em class="text-italics">Usage: cmdwiz savefont [filename]</em><br /><br />Note that no font image data is saved, only the specifications of the fonts (i.e. its name, size, etc)<br /><br />This means two things:<br />1. These files are rather small<br />2. If you use the file on a different computer, &quot;setfont&quot; will only work if the same font is available on that computer too. I guess &quot;Consolas&quot; and &quot;Lucida Console&quot; are pretty much standard these days at least.<br /><br />Also note that for non-bitmap fonts, you will need to set the font/size manually in &quot;Properties&quot; before you use &quot;savefont&quot;, but once it is saved, it can be restored from the file at any time using &quot;setfont&quot;.<br /><br />Savefont/setfont can also be used to restore the initially used font even when it's not known which one that was:<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>cmdwiz savefont tmpfont.fnt<br />cmdwiz setfont 5<br />echo Doing some stuff...<br />cmdwiz setfont tmpfont.fnt<br />del /Q tmpfont.fnt&gt;nul<br /></code></pre></div></div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Cmdwiz - cmd helper tools</h3>
				<div class="date">Posted: <strong>16 Sep 2016 17:23</strong></div>
				<div class="author">by <strong>misol101</strong></div>
				<div class="content"><strong class="text-strong">4. Get character and colors in the buffer/system</strong><br /><br />Operations: getconsolecolor, getcharat, getcolorat<br /><br /><br /><strong class="text-strong">4.1 getconsolecolor</strong><br /><br />Returns either the foreground or background color index currently used by the console.<br /><br /><em class="text-italics">Usage: cmdwiz getconsolecolor [fg|bg]</em><br /><br />The color index is returned in ERRORLEVEL.<br /><br />The console colors can be set with cmd's standard &quot;color&quot; command.<br /><br /><br /><strong class="text-strong">4.2 getcharat</strong><br /><br />Returns the character (extended ASCII value) at the given buffer position.<br /><br /><em class="text-italics">Usage: cmdwiz getcharat [x|k y|k]</em><br /><br />Specify k(for &quot;keep&quot;) for x and/or y to use the current cursor position in x and/or y<br /><br />The result is returned in ERRORLEVEL.<br /><br /><br /><strong class="text-strong">4.3 getcolorat</strong><br /><br />Returns either the foreground or background color index at the given buffer position.<br /><br /><em class="text-italics">Usage: cmdwiz getcolorat [fg|bg x|k y|k]</em><br /><br />Specify k(for &quot;keep&quot;) for x and/or y to use the current cursor position in x and/or y<br /><br />The result is returned in ERRORLEVEL.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Cmdwiz - cmd helper tools</h3>
				<div class="date">Posted: <strong>16 Sep 2016 18:10</strong></div>
				<div class="author">by <strong>misol101</strong></div>
				<div class="content"><strong class="text-strong">5. Setting the cursor position/look and writing text</strong><br /><br />Operations: getcursorpos, setcursorpos, showcursor, print<br /><br /><br /><strong class="text-strong">5.1 getcursorpos</strong><br /><br />Returns either the x(column) or y(row) position of the cursor<br /><br /><em class="text-italics">Usage: cmdwiz getcursorpos [x|y]</em><br /><br />The value is returned in ERRORLEVEL.<br /><br /><br /><strong class="text-strong">5.2 setcursorpos</strong><br /><br />Sets the cursor position in the buffer.<br /><br /><em class="text-italics">Usage: cmdwiz setcursorpos [x|keep y|keep]</em><br /><br />Specify k or keep to use the current cursor position for x and/or y.<br /><br />Note that setting the cursor position also automatically scrolls the buffer (if needed) to make the cursor visible. This can be used to continously scroll step by step in the buffer.<br /><br /><br /><strong class="text-strong">5.3 showcursor</strong><br /><br />Show or hide the cursor, optionally changing its appearance.<br /><br /><em class="text-italics">Usage: cmdwiz showcursor [0|1] [show percentage 1-100 (default 25)]</em><br /><br />A value of 0 hides the cursor, 1 shows it. The second, optional parameter sets the size of the cursor.<br /><br />The return value in ERRORLEVEL is -1 on error, otherwise it indicates whether or not the cursor was previously showing. A value of 0 means the cursor was not visible, a value of 1-100 means the cursor was on with that show percentage.<br /><br /><br /><strong class="text-strong">5.4 print</strong><br /><br />Print the given string to stdout.<br /><br /><em class="text-italics">Usage: cmdwiz print [&quot;string&quot;]</em><br /><br />The surrounding string quotes are not printed.<br /><br />The string can use the following escape sequences borrowed from C:<br />\n prints a newline<br />\a plays a beep sound (prints ^G)<br />\\ prints a \<br />\t prints a tab<br />\b prints a backspace<br />\r prints a carriage return<br />\&quot; prints a &quot;<br /><br /><strong class="text-strong">NOTE:</strong> for advanced text output using colors, moving the cursor around, wrapping, special characters etc, use my other tool &quot;gotoxy.exe&quot; (<!-- l --><a class="postlink-local" href="viewtopiccd0f.html?f=3&amp;t=7129">viewtopic.php?f=3&amp;t=7129</a><!-- l -->), or possibly &quot;cmdgfx.exe&quot; (<!-- l --><a class="postlink-local" href="viewtopic9d55.html?f=3&amp;t=7153">viewtopic.php?f=3&amp;t=7153</a><!-- l -->)</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Cmdwiz - cmd helper tools</h3>
				<div class="date">Posted: <strong>16 Sep 2016 18:13</strong></div>
				<div class="author">by <strong>misol101</strong></div>
				<div class="content"><strong class="text-strong">6. Working with strings</strong><br>
<br>
Operations: stringfind, stringlen<br>
<br>
<br>
<strong class="text-strong">6.1 stringfind</strong><br>
<br>
Searches for a string inside another string<br>
<br>
<em class="text-italics">Usage: cmdwiz stringfind [orgstring findstring] [startindex] [noCase]</em><br>
<br>
This operation attempts to find <em class="text-italics">findstring</em> inside <em class="text-italics">orgstring</em>.<br>
If the search was successful, ERRORLEVEL is set to the 0-based index position in <em class="text-italics">orgstring</em> where <em class="text-italics">findstring</em> was found. If the string was not found, the return value is -1. <br>
<br>
If <em class="text-italics">startindex</em> is set, the search in <em class="text-italics">orgstring</em> starts from the given index position.<br>
<br>
If the <em class="text-italics">noCase</em> argument is given, the string search is not case sensitive.<br>
<br>
It is a good idea to surround both strings with quotes (quotes are not included in the search).<br>
<br>
<br>
<strong class="text-strong">6.2 stringlen</strong><br>
<br>
Returns the length of a given string<br>
<br>
<em class="text-italics">Usage: cmdwiz stringlen [string]</em><br>
<br>
The length of the string (number of characters) is returned in ERRORLEVEL.<br>
<br>
It is a good idea to surround the string with quotes (quotes are not included in the string length).</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Cmdwiz - cmd helper tools</h3>
				<div class="date">Posted: <strong>22 Sep 2016 17:40</strong></div>
				<div class="author">by <strong>misol101</strong></div>
				<div class="content"><strong class="text-strong">7. Working with timing/delays</strong><br /><br />Operations: delay, gettime, await<br /><br /><br /><strong class="text-strong">7.1 delay</strong><br /><br />Pauses for the specified amount of time<br /><br /><em class="text-italics">Usage: cmdwiz delay [ms]</em><br /><br />The execution halts for the amount of milliseconds given. No message is printed.<br /><br /><br /><strong class="text-strong">7.2 gettime</strong><br /><br />Retrieves the number of milliseconds that have elapsed since the system was started<br /><br /><em class="text-italics">Usage: cmdwiz gettime</em><br /><br />The result is returned in ERRORLEVEL. <br /><br />This operation is useful for measuring time (divide by 1000 to get seconds), or in conjunction with <em class="text-italics">await</em> (below).<br /><br /><br /><strong class="text-strong">7.3 await</strong><br /><br />Waits up to the given amount of milliseconds<br /><br /><em class="text-italics">Usage: cmdwiz await [oldtime] [waittime]</em><br /><br />This operation wait for up to <em class="text-italics">waittime</em> ms, depending on how much time passed since <em class="text-italics">oldtime</em>.<br /><br />A typical use case would be something like:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>cmdwiz gettime<br />set STARTTIME=%errorlevel%<br />...do some stuff<br />cmdwiz await %STARTTIME% 5000<br /></code></pre></div><br />If &quot;some stuff&quot; took 3.5s to complete then await will wait the remaining 1.5 s. If it took longer than 5s then it will not wait at all.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Cmdwiz - cmd helper tools</h3>
				<div class="date">Posted: <strong>22 Sep 2016 17:41</strong></div>
				<div class="author">by <strong>misol101</strong></div>
				<div class="content"><strong class="text-strong">8. Moving and clicking with the mouse pointer and sending key events</strong><br>
<br>
Operations: getmousecursorpos setmousecursorpos showmousecursor sendkey<br>
<br>
<br>
<strong class="text-strong">8.1 getmousecursorpos</strong><br>
<br>
Get the x or y position of the mouse cursor in pixels from the top left of the screen<br>
<br>
<em class="text-italics">Usage: cmdwiz getmousecursorpos [x|y]</em><br>
<br>
Note that this is not the column/row position in the console window, but the actual pixel position of the mouse pointer.<br>
<br>
The value is returned in ERRORLEVEL.<br>
<br>
<br>
<strong class="text-strong">8.2 setmousecursorpos</strong><br>
<br>
Sets the mouse cursor position, optionally followed by a click<br>
<br>
<em class="text-italics">Usage: cmdwiz setmousecursorpos [x|keep y|keep] [l|r|d|u|m|wu|wd|wl|wr] [wheelAmount]]</em><br>
<br>
This operation first moves the mouse pointer to the given position. For both x and y, you can specify "keep" (or short "k") to keep the current position. <br>
<br>
If a click argument was given, it follows:<br>
<br>
<em class="text-italics">l:</em> simulates a left click with the mouse<br>
<em class="text-italics">r:</em> simulates a right click with the mouse<br>
<em class="text-italics">d:</em> simulates holding the left mouse key down<br>
<em class="text-italics">u:</em> simulates releasing the left mouse key<br>
<em class="text-italics">m:</em> simulates a middle click with the mouse<br>
<em class="text-italics">wu/wd:</em> simulates moving the vertical mouse wheel up or down. Use optional wheelAmount argument if you want a bigger movement than 1 step.<br>
<em class="text-italics">wl/wr:</em> simulates moving the horizontal mouse wheel left or right. Use optional wheelAmount argument if you want a bigger movement than 1 step.<br>
<br>
<em class="text-italics">d</em> and <em class="text-italics">u</em> can be used together for dragging.<br>
<br>
A left or right or middle double-click can be simulated by running the same setmousecursorposition operation twice.<br>
<br>
<br>
<strong class="text-strong">8.3 showmousecursor</strong><br>
<br>
Hide or show the mouse cursor over the cmd window<br>
<br>
<em class="text-italics">Usage: cmdwiz showmousecursor [0|1]</em><br>
<br>
Note: Unfortunately this operation does not work on Windows 10. It has been shown to at least work on Windows 7.<br>
<br>
<br>
<strong class="text-strong">8.4 sendkey</strong><br>
<br>
Simulates a keyboard input event<br>
<br>
<em class="text-italics">Usage: cmdwiz sendkey [[0x]VKEY[h] p|d|u]</em><br>
<br>
The virtual key code (VKEY) values can be found here: <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/dd375731(v=vs.85).aspx" class="postlink">https://msdn.microsoft.com/en-us/librar ... 85%29.aspx</a><br>
The easiest way to use them is to copy/paste them from the web page in the 0x?? format.<br>
<br>
'p', 'd' or 'u' specifies what kind of event is sent:<br>
<br>
<em class="text-italics">p:</em> simulates that the key was both pressed and released<br>
<em class="text-italics">d:</em> simulates that the key was pressed down but has not been released<br>
<em class="text-italics">u:</em> simulates that a previously pressed key was released<br>
<br>
Example (simulates holding down ALT, then pressing/releasing the TAB key, which will bring up the ALT-TAB menu)
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>cmdwiz sendkey 0x12 d &amp; cmdwiz sendkey 0x09 p</code></pre></div></div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Cmdwiz - cmd helper tools</h3>
				<div class="date">Posted: <strong>22 Sep 2016 17:56</strong></div>
				<div class="author">by <strong>misol101</strong></div>
				<div class="content"><strong class="text-strong">9. Moving, saving or examining blocks of characters</strong><br /><br />Operations: copyblock, moveblock, saveblock, inspectblock<br /><br /><br /><strong class="text-strong">9.1 copyblock</strong><br /><br />Copy a block of characters in the screen buffer from one place to another<br /><br /><em class="text-italics">Usage: cmdwiz copyblock [x y width height newX newY]</em><br /><br />If the block is wider or higher than the buffer or x/y is outside the buffer, the operation will fail and a negative ERRORLEVEL value is returned.<br /><br />Overlapping blocks are ok.<br /><br /><br /><strong class="text-strong">9.2 moveblock</strong><br /><br />Move a block of characters in the screen buffer from one place to another<br /><br /><em class="text-italics">Usage: cmdwiz moveblock [x y width height newX newY] [char] [fgcol] [bgcol]</em><br /><br />If the block is wider or higher than the buffer or x/y is outside the buffer, the operation will fail and an ERRORLEVEL other than 0 is returned.<br /><br />Unless otherwise specified, the area where the block used to be is filled with blankspace characters.<br />It is possible to specify exactly which character and in which color will fill the blank space using the last three parameters. Char can be specified either as char or as a hex value, fgcol/bgcol can be hex or decimal.<br /><br /><br /><strong class="text-strong">9.3 saveblock</strong><br /><br />Saves a block of characters from the screen buffer to file, including color information<br /><br /><em class="text-italics">Usage: cmdwiz saveblock [filename x y width height] [encode|forcecode|nocode|txt] [transparent char] [transparent bgcolor] [transparent fgcolor]</em><br /><br />The filename will automatically have an extension added to it. The default is &quot;.gxy&quot;, which is a file format for colorized text used by my tools <em class="text-italics">cmdgfx</em> and <em class="text-italics">gotoxy</em>. However, if the encoding argument (argument 6) is &quot;txt&quot;, the file is saved as text and will have the file extension &quot;.txt&quot;. For more information on the gxy file format, see the syntax of gotoxy. It is comparable to ANSI escape sequences in order to change colors, print special characters, position the cursor etc.<br /><br />If the block is wider or higher than the buffer or x/y is outside the buffer or the file cannot be saved, the operation will fail and an ERRORLEVEL lower than 0 is returned.<br /><br />Argument 6 specifies which characters in the file should be stored as plain text and which should be encoded. A file with no encoding will be smaller and more readable from a human perspective, but could cause issues when printed. The default setting is <em class="text-italics">encode</em>, which will leave A-Z, a-z, blankspace and numbers unchanged, but encode all other characters. <em class="text-italics">Forcecode </em>will encode all characters, <em class="text-italics">nocode </em>encodes no characters, and <em class="text-italics">txt </em>is like nocode but with no colors saved, and with file extension .txt rather than .gxy. <br /><br />It is possible to make part of the gxy file transparent. This is controlled by the last 3 arguments. If only a <em class="text-italics">transparent char</em> is specified, then all such chars in the input will be transparent in the output. If a <em class="text-italics">bgcolor </em>is given, the previous statement is true, but also the bgcolor needs to match. If an <em class="text-italics">fgcolor </em>is specified, the previous two statements are true, but also the fgcolor needs to match.<br /><br />It's worth noting that a gxy file with no transparency saved can still be printed as transparent, see the last example below.<br /><br />To show the saved gxy file, you can use gotoxy.exe in one of two ways (change 0 0 to k k to print at the current cursor position):<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>gotoxy 0 0 file.gxy<br />gotoxy 0 0 &quot;\I:file.gxy;&quot;</code></pre></div><br />The equivalent for cmdgfx is below. With cmdgfx, gxy files can also be used as textures for 3d.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>cmdgfx &quot;image file.gxy 0 0 0 -1 0,0&quot; p</code></pre></div><br />The gotoxy archive also contains a file called <em class="text-italics">editor.bat</em> which can create/edit gxy files. Either specify a file name as first argument to editor.bat, or load a file during runtime by pressing F1 or Shift-F1.<br /><br />Finally, to print a gxy file as partly transparent even if the gxy file has no transparency (here, all BLANKSPACE characters will be transparent, no matter the color):<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>gotoxy 0 0 &quot;\T20kk0\I:file.gxy;&quot;<br />cmdgfx &quot;image file.gxy 0 0 0 20 0,0&quot; p<br /></code></pre></div><br /><br /><br /><strong class="text-strong">9.4 inspectblock</strong><br /><br />Check for the presence or exclusiveness of one or more characters within a screen buffer block<br /><br /><em class="text-italics">Usage: cmdwiz inspectblock [x y width height inclusive|exclusive char1] [char2] [char3] ...</em><br /><br />This operation can be used e.g. for simple collision detection in games. See the script <em class="text-italics">world.bat</em> in the gotoxy archive for an example.<br /><br />If the block is wider or higher than the buffer or x/y is outside the buffer, the operation will fail and an ERRORLEVEL of -1 is returned.<br /><br />Char(s) can be given either as a hexadecimal ASCII value or as a printed character.<br /><br />If <em class="text-italics">inclusive </em>is specified as argument 5, the output will be set depending on the *presence* of the char(s) in the block, otherwise it's set depending on whether or not ONLY the specified char(s) were present in the block.<br /><br />For <em class="text-italics">inclusive</em>, the ERRORLEVEL set is a bit pattern representing the presence of the given char(s).<br />If only one char is given, ERRORLEVEL will be set to 1 if the char was found in the block. If two chars are given, bit 1 in ERRORLEVEL is set if char 1 was found, and bit 2 is set if char2 was found, and so on.<br /><br />For <em class="text-italics">exclusive</em>, ERRORLEVEL is always 0 or 1. The result is 1 if only the given char(s) were present in the block, otherwise 0.<br /><br />Example:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>cmdwiz inspectblock 0 0 10 10 inclusive 20 A &amp; set RES=!errorlevel!<br />set /a &quot;B1=!RES! &amp; 1&quot; &amp; if !B1! gtr 0 echo One or more blankspaces were found in the block<br />set /a &quot;B2=!RES! &amp; 2&quot; &amp; if !B2! gtr 0 echo One or more A's were found in the block<br /><br />cmdwiz inspectblock 0 0 10 10 exclusive 20 A &amp; set RES=!errorlevel!<br />if %RES% == 1 echo Blankspace's and/or A's were the ONLY characters in the block<br /></code></pre></div></div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Cmdwiz - cmd helper tools</h3>
				<div class="date">Posted: <strong>24 Sep 2016 14:46</strong></div>
				<div class="author">by <strong>misol101</strong></div>
				<div class="content"><strong class="text-strong">10. Miscellaneous operations</strong><br>
<br>
Operations: insertbmp, playsound, getexetype, cache, gettitle, gxyinfo<br>
<br>
<br>
<strong class="text-strong">10.1 insertbmp</strong><br>
<br>
Insert a bitmap image into the console window<br>
<br>
<em class="text-italics">Usage: cmdwiz insertbmp [file.bmp x y] [[z]|[w h]] [bitOp] [/h:HWND|/p:pId|/t:tId|"/n:processName"|"/w:windowTitle"|/D]</em><br>
<br>
Only bmp files are supported. The image is placed at the given x/y position from the top left of the console client area.<br>
<br>
Optional size argument(s) can be given in one of two ways:<br>
<br>
<em class="text-italics">z:</em> A percentage value. 100 is original size, 200 is double size, etc.<br>
<br>
<em class="text-italics">w h:</em> A given width and height in pixels. Aspect ratio is not preserved.<br>
<br>
<em class="text-italics">Bitop</em>'s are: SRCCOPY (default), SRCPAINT, SRCAND, SRCINVERT, SRCERASE, NOTSRCCOPY, NOTSRCERASE, DSTINVERT, BLACKNESS, WHITENESS<br>
<br>
(see <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/dd183370(v=vs.85).aspx" class="postlink">https://msdn.microsoft.com/en-us/librar ... s.85).aspx</a> for an explanation of these bit operations. Or, use trial-and-error <img class="smilies" src="images/smilies/icon_smile.gif" width="15" height="15" alt=":)" title="Smile"> )<br>
<br>
See section 1.0 for information on how to use the last parameter to insert the bitmap into another window than the console window.<br>
<br>
Note that the optional last parameter also contains the switch /D. Using the /D switch, the bitmap will not be placed inside any window, but instead it will be placed directly on the display, on top of all windows. Coordinates 0,0 represesent the top left pixel of the desktop.<br>
<br>
<br>
RETURN: 0 on success, -1 if failed to load file<br>
<br>
Try something like:
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>cls
cmdwiz insertbmp 123.bmp 10 10 100 SRCPAINT
cmdwiz insertbmp 123.bmp 120 20 100 SRCPAINT

or perhaps:

mode 80,50
color 0f
set
cmdwiz insertbmp 123.bmp -200 -200 1200 990 SRCAND
</code></pre></div>

<br>
<strong class="text-strong">10.2 playsound</strong><br>
<br>
Plays a sound file<br>
<br>
<em class="text-italics">Usage: cmdwiz playsound [filename.wav]</em><br>
<br>
Only .wav files are supported.<br>
<br>
The file is played synchronously. For asynchronous playing, use <em class="text-italics">"start /B cmdwiz playsound file.wav"</em>, or possibly <em class="text-italics">"start /MIN"</em> instead. <br>
<br>
<br>
<strong class="text-strong">10.3 getexetype</strong><br>
<br>
Determine the executable type (if any) of a file<br>
<br>
<em class="text-italics">Usage: cmdwiz getexetype [file]</em><br>
<br>
If an error occured, -1 is returned. Otherwise, ERRORLEVEL is set according to the following list:<br>
<br>
0  Unable to determine the type<br>
1  Console application or .bat file<br>
2  MS-DOS .exe or .com file<br>
3  Windows application<br>
<br>
<br>
<strong class="text-strong">10.4 cache</strong><br>
<br>
Put files in Windows file cache<br>
<br>
<em class="text-italics">Usage: cmdwiz cache [filelist] [reportFailedOpen]</em><br>
<br>
In some situations it's advantageous to make sure files are in Windows file cache, since any subsequent operations with those files will be faster. For example, if you show a number of gxy files after each other in an animation, you can ensure a better flow by first putting all the files used into the file cache.<br>
<br>
The filelist should be a plain text file (Ansi, Utf-8 or Utf-16 LE) with path/filename to one or more files, each on its own line.<br>
<br>
If the second argument is given, the operation will report any files in the file list that could not be opened. The default behavior is to simply ignore this.<br>
<br>
<br>
<strong class="text-strong">10.5 gettitle</strong><br>
<br>
Prints the title of the console window to stdout<br>
<br>
<em class="text-italics">Usage: cmdwiz gettitle [strip]</em><br>
<br>
The title includes the name of the current script running, or if no script is running, the command itself. To get the base title only, specify the <em class="text-italics">strip</em> option.<br>
<br>
<br>
<strong class="text-strong">10.6 gxyinfo</strong><br>
<br>
Print information about dimensions and properties of a gxy (or txt) file<br>
<br>
<em class="text-italics">Usage: cmdwiz gxyinfo [filename] [ignoreCodes]</em><br>
<br>
Returns -1 on error, otherwise 0.<br>
<br>
First of all, the operation attempts to print the dimensions (width x height) of the file. Note that gxy files are not necessarily block-shaped, so a dimension of e.g. 10x10 does not necessarily mean that all lines are 10 characters wide, only that the longest line has that many characters.<br>
<br>
Furthermore, the operation prints information on things such as transparency, use of color codes, use of special codes only supported by gotoxy (but not cmdgfx) etc.<br>
<br>
If the input file is a text file, this analysis might be incorrect, in which case the 'ignoreCodes' argument can be given. In this case, only the dimension is printed.<br>
<br>
To get dimensions of a file into variables, use something like:
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>for /F "tokens=1,2,3,4" %%a in ('cmdwiz gxyinfo "myfile.gxy"') do @if "%%a"=="Dimension:" set /a IMGW=%%b, IMGH=%%d</code></pre></div></div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Cmdwiz - cmd helper tools</h3>
				<div class="date">Posted: <strong>25 Sep 2016 07:27</strong></div>
				<div class="author">by <strong>misol101</strong></div>
				<div class="content">Alright, all done. A version with a few updates/fixes will appear soon.<br /><br />If anybody has bug reports, ideas for other operations, or additions to existing ones, do tell.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Cmdwiz - cmd helper tools</h3>
				<div class="date">Posted: <strong>25 Sep 2016 10:56</strong></div>
				<div class="author">by <strong>aGerman</strong></div>
				<div class="content">Seems you want to compete with NirCmd <img class="smilies" src="images/smilies/icon_lol.gif" alt=":lol:" title="Laughing" /><br /><br />I have a pretty basic suggestion. As you may know Windows works with Unicode (aktually UTF-16 LE) internally. Thus, I strongly advise you to use Unicode in your applications also. In particular if you pass a filename or path with non-ASCII characters (and I know the Swedish alphabet contains some of them too) you will get in trouble.<br />Unfortunately MinGW/GCC doesn't support wmain/_tmain in order to receive arguments as &quot;wide&quot; strings directly. It's not that easy to work around this limitation, especially if you want to have a cross-compiler code. (MS decided to impede the usage of __wgetmainargs with Visual Studio 2015.)<br />I'll send you another code of mine (via PM) that you may or may not include in your tool collection. Its purpose is to close a window (which is similar to clicking the red x button). It's not the same as taskkill because you are able to choose what window of the process should be closed and it gives an application the opportunity to cleanup in the window message loop.<br />Nevermind. It shows how to work around the missing _tmain...<br /><br />Steffen</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Cmdwiz - cmd helper tools</h3>
				<div class="date">Posted: <strong>26 Sep 2016 02:35</strong></div>
				<div class="author">by <strong>misol101</strong></div>
				<div class="content"><blockquote><div><cite>aGerman wrote:</cite>Seems you want to compete with NirCmd <img class="smilies" src="images/smilies/icon_lol.gif" alt=":lol:" title="Laughing" /></div></blockquote><br /><br />Not exactly, it's supposed to be tools for the console only, I just threw in a few things to move mouse cursor pointer etc for fun <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /> But I am tempted to add an operation like FindWindow and allow the returned handle to be used for various things. But then again, there are already good tools for this kind of stuff like AutoHotkey, so I don't think I should (where will it end? <img class="smilies" src="images/smilies/icon_wink.gif" alt=";)" title="Wink" /> )<br /><br /><blockquote><div><cite>aGerman wrote:</cite>I strongly advise you to use Unicode in your applications also. In particular if you pass a filename or path with non-ASCII characters (and I know the Swedish alphabet contains some of them too) you will get in trouble.<br />I'll send you another code of mine (via PM) that you may or may not include in your tool collection. </div></blockquote><br /><br />Thanks Steffen! Yes, Unicode is on the todo-list. I suppose since I mostly made this tool for myself it just wasn't a priority. Swedish chars actually works ok for me, I guess it depends on the codepage used.<br /><br />I will have a look at your code soon.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Cmdwiz - cmd helper tools</h3>
				<div class="date">Posted: <strong>26 Sep 2016 14:35</strong></div>
				<div class="author">by <strong>aGerman</strong></div>
				<div class="content"><blockquote><div><cite>misol101 wrote:</cite>But I am tempted to add an operation like FindWindow and allow the returned handle to be used for various things.</div></blockquote><br />FindWindow? Pretty much the same as my tool already does <img class="smilies" src="images/smilies/icon_wink.gif" alt=":wink:" title="Wink" /> Seems you could reuse quite a lot of that code if you want.<br /><br />Steffen</div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="UTC-6">UTC-06:00</span><br />Page <strong>1</strong> of <strong>3</strong></div>
		<div class="copyright">Powered by phpBB&reg; Forum Software &copy; phpBB Limited<br />https://www.phpbb.com/</div>
	</div>
</div>

</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=7402&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 05:12:01 GMT -->
</html>
