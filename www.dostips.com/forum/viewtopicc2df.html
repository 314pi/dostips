<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?p=30347 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 07:58:35 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>getTimestamp.bat for time and date processing - DosTips.com</title>


	<link rel="canonical" href="viewtopic6b09.html?t=4847">

<!--
	phpBB style name: Allan Style - SUBSILVER
	Based on style:   prosilver (this is the default phpBB3 style)
	Based on style:   subsilver2 (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:  Allan ( http://x-tk.ru/ )
-->

<link href="assets/css/font-awesome.mind772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/stylesheetd772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/en/stylesheetd772.css?assets_version=34" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="./styles/AllanStyle-SUBSILVER/theme/tweaks.css?assets_version=34" rel="stylesheet">
<![endif]-->




<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','../../www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-280191-1', 'auto');
	ga('send', 'pageview');
</script>

</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">

<div id="header-subsilver">
	<a id="top" class="top-anchor" accesskey="t"></a>
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description" class="site-description">
				<a id="logo" class="logo" href="../index.html" title="DosTips.com"><span class="site_logo"></span></a>
				<h1>DosTips.com</h1>
				<p>A Forum all about DOS Batch</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

									<div id="search-box" class="search-box search-header" role="search">
				<form action="https://www.dostips.com/forum/search.php" method="get" id="search">
				<fieldset>
					<input name="keywords" id="keywords" type="search" maxlength="128" title="Search for keywords" class="inputbox search tiny" size="20" value="" placeholder="Search…" />
					<button class="button button-search" type="submit" title="Search">
						<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
					</button>
					<a href="search.html" class="button button-search-end" title="Advanced search">
						<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
					</a>
					
				</fieldset>
				</form>
			</div>
						
			</div>
					</div>
</div>


<div id="wrap" class="wrap">
	<div id="page-header">
				<div class="navbar-top" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
																									<li>
								<a href="search33a7.html?search_id=unanswered" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="search526f.html?search_id=active_topics" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-blue" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="search.html" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
											<li class="separator"></li>
																			<li>
								<a href="memberlist4bfd.html?mode=team" role="menuitem">
									<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
								</a>
							</li>
																<li class="separator"></li>

									</ul>
			</div>
		</li>

				<li data-skip-responsive="true">
			<a href="app.php/help/faq.html" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
						
			<li class="rightside"  data-skip-responsive="true">
			<a href="ucp26c3.html?mode=login" title="Login" accesskey="x" role="menuitem">
				<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Login</span>
			</a>
		</li>
					<li class="rightside" data-skip-responsive="true">
				<a href="ucp8319.html?mode=register" role="menuitem">
					<i class="icon fa-pencil-square-o  fa-fw" aria-hidden="true"></i><span>Register</span>
				</a>
			</li>
						</ul>

	</div>
</div>

<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
						<li class="breadcrumbs">
							<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="../index.html" itemprop="url" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span itemprop="title">DosTips.com</span></a></span>
										<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="index.html" itemprop="url" accesskey="h" data-navbar-reference="index"><span itemprop="title">Board index</span></a></span>

											<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="4"><a href="viewforum31e6.html?f=4" itemprop="url"><span itemprop="title">DosTips - Dos Batch</span></a></span>
															<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="3"><a href="viewforum4d6b.html?f=3" itemprop="url"><span itemprop="title">DOS Batch Forum</span></a></span>
												</li>
		
					<li class="rightside responsive-search">
				<a href="search.html" title="View the advanced search options" role="menuitem">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</a>
			</li>
			</ul>

	</div>
</div>

<div class="navbar-top-link">
	<div class="inner">
		<ul>
			<li class="navbar-top-link-left"><a href="search33a7.html?search_id=unanswered">Unanswered topics</a></li>
			<li class="navbar-top-link-left"><a href="search526f.html?search_id=active_topics">Active topics</a></li>

											</ul>
	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
		
<h2 class="topic-title"><a href="viewtopic5ecb.html?f=3&amp;t=4847">getTimestamp.bat for time and date processing</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">Discussion forum for all Windows batch related topics.<br /></div>
<p>
	<strong>Moderator:</strong> <a href="memberlista6a8.html?mode=viewprofile&amp;u=5" class="username">DosItHelp</a>
</p>


<div class="action-bar bar-top">
	
			<a href="postingfde4.html?mode=reply&amp;f=3&amp;t=4847" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopice6a4.html?f=3&amp;t=4847&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="https://www.dostips.com/forum/search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topic…" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="search.html" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="4847" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			46 posts
							<ul>
		<li class="active"><span>1</span></li>
				<li><a class="button" href="viewtopic4c44.html?f=3&amp;t=4847&amp;start=15" role="button">2</a></li>
				<li><a class="button" href="viewtopice8f9.html?f=3&amp;t=4847&amp;start=30" role="button">3</a></li>
				<li><a class="button" href="viewtopiccf06.html?f=3&amp;t=4847&amp;start=45" role="button">4</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopic4c44.html?f=3&amp;t=4847&amp;start=15" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
		</div>




<div id="subsilver-nav-topic">
	<div class="inner"><div class="post has-profile">
		<div class="leftsided postbody subsilver-topic-title">Message</div>
		<div class="leftsided postprofile subsilver-topic-author">Author</div>
	</div></div>
</div>

			<div id="p27422" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile27422">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content27422">

						<h3 class="first"><a href="#p27422">getTimestamp.bat for time and date processing</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingc7f4.html?mode=quote&amp;f=3&amp;p=27422" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic1ad7.html?p=27422#p27422" onclick="prompt('Message #1',this.href); return false;">#1</a></span> 
									<a class="unread" href="viewtopic1ad7.html?p=27422#p27422" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>16 Jul 2013 23:08
			</p>
			
			
			
			<div class="content"><span style="font-size: 150%; line-height: normal"><strong class="text-strong"><span style="color: #FF0000">Important notice</span></strong> - I have ceased development of getTimestamp. The new replacement utility is available at </span> <span style="font-size: 200%; line-height: normal"><a href="viewtopiccd51.html?f=3&amp;t=7523" class="postlink">jTimestamp.bat</a></span>.<br /><br /><span style="color: #0000BF"><strong class="text-strong">The last version 2.6 of getTimestamp.bat can be found later in this thread at the following link</strong><br /><!-- l --><a class="postlink-local" href="viewtopic36d3.html?f=3&amp;t=4847&amp;start=9999#p47680">viewtopic.php?f=3&amp;t=4847&amp;start=9999#p47680</a><!-- l --></span><br /><br />Below is a general purpose timestamp calculator and formatter called <strong class="text-strong">getTimestamp.bat</strong>.<br /><br />There are a great many options for specifying the base date and time, many options for adding positive or negative offsets to the date and time, many options for formatting the result, and an option to capture the result in a variable. Both input and output can be directly expressed as local time, UTC, or any time zone of your choosing.<br /><br />Here are just a few examples of how it could be used.<br /><br />Calling getTimestamp with no arguments simply reports the current local date and time in ISO 8601 format:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&gt;getTimestamp<br />2013-07-16T23:38:38.709-04:00<br /></code></pre></div>The default format string used to get the above output is <strong class="text-strong">-f &quot;{yyyy}-{mm}-{dd}T{hh}:{nn}:{ss}.{fff}{tz}</strong>&quot;<br /><br />To get the current local date and time in the same format that WMIC OS GET LOCALDATETIME reports:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&gt;getTimestamp -f {yyyy}{mm}{dd}{hh}{nn}{ss}.{fff}000{zzzz}<br />20130716233838.709000-240<br /></code></pre></div><br />To get today's date minus 90 days in YYYYMMDD format:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />setlocal<br />call getTimeStamp -od -90 -f {yyyy}{mm}{dd} -r dt<br />echo current date - 90 days (YYYYMMDD) = %dt%<br /></code></pre></div><br />getTimestap.bat can also be used to conveniently compute elapsed time of nearly any time interval, without worrying about the limits of batch arithmetic. This is extremely convenient for timing events.<br /><br />Two calls to getTimestamp are used to store the current timestamp at the beginning and end of a process. The timestamps are expressed as milliseconds since midnight, January 1, 1970. Then one more call to getTimestamp is used to compute the interval. The date for the interval is specified as timestamp2 - timestamp1, and the format can provide the elapsed time in whatever units are required.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />setlocal<br /><br />call getTimestamp -f {ums} -r t1<br />:: Some long running process here<br />call getTimestamp -f {ums} -r t2<br /><br />:: This computes the elapsed time as decimal hours.<br />:: It supports both positive and negative intervals.<br />call getTimestamp -d %t2%-%t1% -f &quot;{uhd} hours&quot;<br /><br />:: This computes the elapsed time as days, hours, mins, secs, ms<br />:: It only supports positive intervals<br />call getTimestamp -d %t2%-%t1% -f &quot;{ud} days {hh}:{nn}:{ss}.{fff}&quot; -u<br /></code></pre></div><br />-- OUTPUT --<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>62.35474888888889 hours<br />2 days 14:21:17.096<br /></code></pre></div><br /><strong class="text-strong">Below is the actual getTimestamp.bat script</strong> The script is large, but note that 2/3 of it is documentation.<br /><br />Parsing options in batch can often be a chore. For this utility I used a handy technique I developed and posted on StackOverflow: <a href="http://stackoverflow.com/a/8162578/1012053" class="postlink">Windows Bat file optional argument parsing</a>. There I describe the theory behind how my option parser works, and provide extensive documentation. I opted to use Unix style options, but it could easily be adapted for Windows style.<br /><br /><strong class="text-strong"><em class="text-italics"><span style="color: #0000BF">EDIT: I added the -Z option to specify the output time zone, fixed a few obscure bugs, and improved the documentation</span></em></strong><br /><strong class="text-strong"><em class="text-italics"><span style="color: #008000">EDIT 2014-03/02: Added credit info to the documentation.</span></em></strong><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@if (@X)==(@Y) @end /* harmless hybrid line that begins a JScript comment<br /><br />::************ Documentation ***********<br />:::getTimestamp&nbsp; &#91;-option &#91;value&#93;&#93;...<br />:::<br />:::&nbsp; Displays a formatted timestamp. Defaults to the current local date<br />:::&nbsp; and time using an ISO 8601 format with milliseconds, time zone<br />:::&nbsp; and punctuation.<br />:::<br />:::&nbsp; Returned ERRORLEVEL is 0 upon success, 1 if failure.<br />:::<br />:::&nbsp; The following options are all case insensitive:<br />:::<br />:::&nbsp; &nbsp; -?<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Prints this documentation for getTimestamp<br />:::<br />:::&nbsp; &nbsp; -U<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Returns a UTC timestamp instead of local timestamp.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is a local timestamp.<br />:::<br />:::&nbsp; &nbsp; -Z TimeZoneMinuteOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Returns the timestamp using the specified time zone offset.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;TimeZoneMinuteOffset is a JScript numeric expression that<br />:::&nbsp; &nbsp; &nbsp; &nbsp;represents the number of minutes offset from UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Decimal values are truncated.<br />:::<br />:::&nbsp; &nbsp; -D DateSpec<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the base date and time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default value is current local date and time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;The DateSpec supports many formats:<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;&quot;&nbsp; &nbsp; (no value)<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Current date and time - the default<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;milliseconds<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;A JScript numeric expression that represents the number of<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;milliseconds since 1970-01-01 00:00:00 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Decimal values are truncated.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative values represent dates prior to 1970-01-01.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'Date &#91;Time&#93; &#91;TimeZone&#93;'&quot;<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;A string representation of the date and time. The date information<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;is required, the time and time zone are optional. Missing time info<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;is assumed to be 0 (midnight). Missing time zone info is assumed to<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;be local time zone.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;The Date, Time, and TimeZone information can be represented as any<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;string that is accepted by the JScript Date.Parse() method.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;There are many formatting options. Documentation is available at:<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;http://msdn.microsoft.com/en-us/library/k4w173wk(v=vs.84).aspx<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Examples of equivalent representations of Midnight on January 4,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2013 assuming local time zone is U.S Eastern Standard Time (EST):<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'1-4-2013'&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Defaults to local time zone<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'January 4, 2013 EST'&quot;&nbsp; &nbsp; &nbsp; &nbsp;Explicit Eastern Std Time (US)<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'2013/1/4 -05'&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Explicit Eastern Std Time (US)<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'Jan 3 2013 23: CST'&quot;&nbsp; &nbsp; &nbsp; &nbsp; Central Standard Time (US)<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'2013 3 Jan 9:00 pm -0800'&quot;&nbsp; Pacific Standard Time (US)<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'01/04/2013 05:00:00 UTC'&quot;&nbsp; &nbsp;Universal Coordinated Time<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'1/4/2013 05:30 +0530'&quot;&nbsp; &nbsp; &nbsp; India Standard Time<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;year, month&#91;, day&#91;, hour&#91;, minute&#91;, second&#91;, millisecond&#93;&#93;&#93;&#93;&#93;&quot;<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;A comma delimited list of numeric JScript expressions representing<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;various components of date and time. Year and month are required,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the rest are optional. Missing values are treated as 0.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Decimal values are truncated. A 0 month represents January.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;A 1 day represents the first day of the month. A 0 day represents<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the last day of the prior month. The date/time value is always<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;in local time. There is no mechanism to specify a time zone.<br />:::<br />:::&nbsp; &nbsp; -OY YearOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the number of years to offset the base date/time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;The JScript numeric expression is truncated to an integral number.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is 0<br />:::<br />:::&nbsp; &nbsp; -OM MonthOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the number of months to offset the base date/time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;The JScript numeric expression is truncated to an integral number.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is 0<br />:::<br />:::&nbsp; &nbsp; -OD DayOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the number of days to offset the base date/time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;The JScript numeric expression is truncated to an integral number.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is 0<br />:::<br />:::&nbsp; &nbsp; -OH HourOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the number of hours to offset the base date/time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;The JScript numeric expression is truncated to an integral number.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is 0<br />:::<br />:::&nbsp; &nbsp; -ON MinuteOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the number of minutes to offset the base date/time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;The JScript numeric expression is truncated to an integral number.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is 0<br />:::<br />:::&nbsp; &nbsp; -OS SecondOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the number of seconds to offset the base date/time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;The JScript numeric expression is truncated to an integral number.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is 0<br />:::<br />:::&nbsp; &nbsp; -OF MillisecondOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the number of milliseconds to offset the base date/time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;The JScript numeric expression is truncated to an integral number.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is 0<br />:::<br />:::&nbsp; &nbsp; -F FormatString<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the timestamp format.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is &quot;{yyyy}-{mm}-{dd}T{hh}:{nn}:{ss}.{fff}{tz}&quot;<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Strings within braces are dynamic components.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;All other strings are literals.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Available components (case insensitive) are:<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{YYYY}&nbsp; 4 digit year, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{YY}&nbsp; &nbsp; 2 digit year, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{Y}&nbsp; &nbsp; &nbsp;year without zero padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{MONTH} month name<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{MTH}&nbsp; &nbsp;month abbreviation<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{MM}&nbsp; &nbsp; 2 digit month, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{M}&nbsp; &nbsp; &nbsp;month without zero padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{WEEKDAY} day of week name<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{WKD}&nbsp; &nbsp;day of week abbreviation<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{W}&nbsp; &nbsp; &nbsp;day of week number, 0=Sunday<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{DD}&nbsp; &nbsp; 2 digit day, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{D}&nbsp; &nbsp; &nbsp;day without zero padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{HH}&nbsp; &nbsp; 2 digit hours, 24 hour format, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{H}&nbsp; &nbsp; &nbsp;hours, 24 hour format without zero padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{HH12}&nbsp; 2 digit hours, 12 hour format, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{H12}&nbsp; &nbsp;hours, 12 hour format without zero padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{NN}&nbsp; &nbsp; 2 digit minutes, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{N}&nbsp; &nbsp; &nbsp;minutes without padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{SS}&nbsp; &nbsp; 2 digit seconds, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{S}&nbsp; &nbsp; &nbsp;seconds without padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{FFF}&nbsp; &nbsp;3 digit milliseconds, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{F}&nbsp; &nbsp; &nbsp;milliseconds without padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{AM}&nbsp; &nbsp; AM or PM in upper case<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{PM}&nbsp; &nbsp; am or pm in lower case<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ZZZZ}&nbsp; timezone expressed as minutes offset from UTC,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;zero padded to 3 digits with sign<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{Z}&nbsp; &nbsp; &nbsp;timzone expressed as minutes offset from UTC without padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ZS}&nbsp; &nbsp; ISO 8601 timezone sign<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ZH}&nbsp; &nbsp; ISO 8601 timezone hours (no sign)<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ZM}&nbsp; &nbsp; ISO 8601 timezone minutes (no sign)<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{TZ}&nbsp; &nbsp; ISO 8601 timezone in +/-hh:mm format<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{U}&nbsp; &nbsp; &nbsp;Unix Epoch time: same as {US}<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Seconds since 1970-01-01 00:00:00 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent dates prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{UMS}&nbsp; &nbsp;Milliseconds since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{US}&nbsp; &nbsp; Seconds since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{UM}&nbsp; &nbsp; Minutes since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{UH}&nbsp; &nbsp; Hours since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{UD}&nbsp; &nbsp; Days since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{USD}&nbsp; &nbsp;Decimal seconds since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{UMD}&nbsp; &nbsp;Decimal minutes since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{UHD}&nbsp; &nbsp;Decimal hours since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{UDD}&nbsp; &nbsp;Decimal days since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; -R ReturnVariable<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Save the timestamp in ReturnVariable instead of displaying it.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;ReturnVariable is undefined if an error occurs.<br />:::<br />:::&nbsp; &nbsp; -WKD &quot;Abbreviated day of week list&quot;<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Override the default output day abbreviations with a space delimited<br />:::&nbsp; &nbsp; &nbsp; &nbsp;quoted list, starting with Sun.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is mixed case 3 character English abbreviations.<br />:::<br />:::&nbsp; &nbsp; -WEEKDAY &quot;Day of week list&quot;<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Override the default output day names with a space delimited,<br />:::&nbsp; &nbsp; &nbsp; &nbsp;quoted list, starting with Sunday.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is mixed case English names.<br />:::<br />:::&nbsp; &nbsp; -MTH &quot;Abbreviated month list&quot;<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Override the default output month abbreviations with a space delimited<br />:::&nbsp; &nbsp; &nbsp; &nbsp;quoted list, starting with Jan.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is mixed case English 3 character abbreviations.<br />:::<br />:::&nbsp; &nbsp; -MONTH &quot;Month list&quot;<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Override the default output month names with a space delimited<br />:::&nbsp; &nbsp; &nbsp; &nbsp;quoted list, starting with January.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is mixed case English names.<br />:::<br />::: getTimestamp.bat was written by Dave Benham. The code was originally posted<br />::: at http://www.dostips.com/forum/viewtopic.php?f=3&amp;t=4847<br />:::<br /><br />::************ Batch portion ***********<br />@echo off<br />setlocal enableDelayedExpansion<br /><br />:: Define options<br />set ^&quot;options=^<br />&nbsp;-?:^<br />&nbsp;-u:^<br />&nbsp;-z:&quot;&quot;^<br />&nbsp;-f:&quot;{yyyy}-{mm}-{dd}T{hh}:{nn}:{ss}.{fff}{tz}&quot;^<br />&nbsp;-d:&quot;&quot;^<br />&nbsp;-oy:&quot;&quot;^<br />&nbsp;-om:&quot;&quot;^<br />&nbsp;-od:&quot;&quot;^<br />&nbsp;-oh:&quot;&quot;^<br />&nbsp;-on:&quot;&quot;^<br />&nbsp;-os:&quot;&quot;^<br />&nbsp;-of:&quot;&quot;^<br />&nbsp;-r:&quot;&quot;^<br />&nbsp;-wkd:&quot;Sun Mon Tue Wed Thu Fri Sat&quot;^<br />&nbsp;-weekday:&quot;Sunday Monday Tuesday Wednesday Thursday Friday Saturday&quot;^<br />&nbsp;-mth:&quot;Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec&quot;^<br />&nbsp;-month:&quot;January February March April May June July August September October November December&quot;^&quot;<br /><br />:: Set default option values<br />for %%O in (%options%) do for /f &quot;tokens=1,* delims=:&quot; %%A in (&quot;%%O&quot;) do set &quot;%%A=%%~B&quot;<br /><br />:: Get options<br />:loop<br />if not &quot;%~1&quot;==&quot;&quot; (<br />&nbsp; set &quot;test=!options:*%~1:=! &quot;<br />&nbsp; if &quot;!test!&quot;==&quot;!options! &quot; (<br />&nbsp; &nbsp; &nbsp; &gt;&amp;2 echo Error: Invalid option %~1<br />&nbsp; &nbsp; &nbsp; exit /b 1<br />&nbsp; ) else if &quot;!test:~0,1!&quot;==&quot; &quot; (<br />&nbsp; &nbsp; &nbsp; set &quot;%~1=UTC&quot;<br />&nbsp; &nbsp; &nbsp; if /i &quot;%~1&quot; equ &quot;-U&quot; set &quot;-z=&quot;<br />&nbsp; ) else (<br />&nbsp; &nbsp; &nbsp; set &quot;%~1=%~2&quot;<br />&nbsp; &nbsp; &nbsp; shift /1<br />&nbsp; )<br />&nbsp; shift /1<br />&nbsp; goto :loop<br />)<br /><br />:: Display help<br />if defined -? (<br />&nbsp; for /f &quot;delims=: tokens=1*&quot; %%A in ('findstr /bln &quot;:::&quot; &quot;%~f0&quot;') do echo(%%B<br />&nbsp; exit /b 0<br />)<br /><br />:: Initialize ReturnVariable to undefined<br />if defined -R set &quot;%-R%=&quot;<br /><br />:: Define lookup arrays<br />for %%N in (-wkd -weekday -mth -month) do (<br />&nbsp; set /a cnt=0<br />&nbsp; for %%V in (!%%N!) do (<br />&nbsp; &nbsp; set &quot;%%N!cnt!=%%V&quot;<br />&nbsp; &nbsp; set /a cnt+=1<br />&nbsp; )<br />)<br /><br />:: Complete the time zone options<br />set &quot;-oz=%-z%&quot;<br />if defined -z set &quot;-u=UTC&quot;<br /><br />:: Complete the offset options<br />set &quot;offsets= -oy:FullYear -om:Month -od:Date -oh:Hours -on:Minutes -os:Seconds -of:Milliseconds -oz:Minutes &quot;<br />for /f &quot;tokens=1,2 delims==&quot; %%A in ('set -o 2^&gt;nul') do (<br />&nbsp; set &quot;offset=!offsets:* %%A:=!&quot;<br />&nbsp; if !offset! neq !offsets! for /f %%C in (&quot;!offset!&quot;) do set &quot;%%A=d.set%%C(d.get%%C()+(%%B));&quot;<br />)<br /><br />:: Define the dynamic JScript script<br />set &quot;jstr=d=new Date(%-d%);%-oy%%-om%%-od%%-oh%%-on%%-os%%-of%%-oz%u=d.getTime();&quot;<br />set &quot;jstr=%jstr%d.get%-u%FullYear()+' '+d.get%-u%Month()+' '+d.get%-u%Date()&quot;<br />set &quot;jstr=%jstr%+' '+d.get%-u%Hours()+' '+d.get%-u%Minutes()&quot;<br />set &quot;jstr=%jstr%+' '+d.get%-u%Seconds()+' '+d.get%-u%Milliseconds()&quot;<br />set &quot;jstr=%jstr%+' '+d.get%-u%Day()+' '+u+' '+(u/1000)+' '+(u/1000/60)&quot;<br />set &quot;jstr=%jstr%+' '+(u/1000/60/60)+' '+(u/1000/60/60/24)&quot;<br />if defined -z (<br />&nbsp; set &quot;jstr=%jstr%+' '+(-~~(%-z%));&quot;<br />) else if defined -u (<br />&nbsp; set &quot;jstr=%jstr%+' 0';&quot;<br />) else (<br />&nbsp; set &quot;jstr=%jstr%+' '+d.getTimezoneOffset();&quot;<br />)<br /><br />:: Execute the JScript script and set raw variables<br />set &quot;ums=&quot;<br />for /f &quot;tokens=1-14&quot; %%A in ('cscript //E:JScript //nologo &quot;%~f0&quot; &quot;%jstr%&quot;') do (<br />&nbsp; set /a &quot;y=%%A, m=%%B, d=%%C, h=%%D, n=%%E, s=%%F, f=%%G, w=%%H, z=-%%N&quot;<br />&nbsp; set &quot;ums=%%I&quot;<br />&nbsp; set &quot;usd=%%J&quot;<br />&nbsp; set &quot;umd=%%K&quot;<br />&nbsp; set &quot;uhd=%%L&quot;<br />&nbsp; set &quot;udd=%%M&quot;<br />)<br /><br />:: Check for errors<br />if not defined ums exit /b 1<br />if %ums% equ NaN (<br />&nbsp; &gt;&amp;2 echo ERROR: Invalid date time<br />&nbsp; exit /b 1<br />)<br /><br />:: Lookup day and month alpha values<br />for %%N in (!w!) do (<br />&nbsp; set &quot;wkd=!-wkd%%N!&quot;<br />&nbsp; set &quot;weekday=!-weekday%%N!&quot;<br />)<br />for %%N in (!m!) do (<br />&nbsp; set &quot;mth=!-mth%%N!&quot;<br />&nbsp; set &quot;month=!-month%%N!&quot;<br />)<br />set /a m+=1<br /><br />:: Define 12 hour values<br />set &quot;am=AM&quot;<br />set &quot;pm=am&quot;<br />set &quot;h12=%h%&quot;<br />if %h% geq 12 (<br />&nbsp; set &quot;am=PM&quot;<br />&nbsp; set &quot;pm=pm&quot;<br />&nbsp; set /a h12=h-12<br />)<br />if %h12% equ 0 set &quot;h12=12&quot;<br /><br />:: Define values needed for ISO 8601 timezone string<br />set &quot;zs=+&quot;<br />if %z% lss 0 (<br />&nbsp; set &quot;zs=-&quot;<br />&nbsp; set /a z=-z<br />)<br />set /a &quot;zh=z/60, zm=z%%60&quot;<br /><br />:: Define integral Unix Epoch values<br />for %%C in (s m h d) do for /f &quot;delims=.&quot; %%N in (&quot;!u%%Cd!&quot;) do set &quot;u%%C=%%N&quot;<br />set &quot;u=%us%&quot;<br /><br />:: Define zero prefixed values<br />set &quot;yyyy=000%y%&quot;<br />set &quot;yyyy=%yyyy:~-4%&quot;<br />for %%A in (yy:y mm:m dd:d hh:h nn:n ss:s hh12:h12 zh:zh zm:zm ) do (<br />&nbsp; for /f &quot;delims=: tokens=1,2&quot; %%B in (&quot;%%A&quot;) do (<br />&nbsp; &nbsp; if !%%C! lss 10 (set %%B=0!%%C!) else (set %%B=!%%C!)<br />&nbsp; )<br />)<br />set &quot;fff=00%f%&quot;<br />set &quot;fff=%fff:~-3%&quot;<br />set &quot;zzzz=00%z%&quot;<br />set &quot;zzzz=%zs%%zzzz:~-3%&quot;<br /><br />:: Restore z sign<br />set /a &quot;z=%zs%z&quot;<br /><br />:: Define ISO 8601 timezone string<br />set &quot;tz=%zs%%zh%:%zm%&quot;<br /><br />:: Substitute values in format string<br />for %%N in (<br />&nbsp; yyyy yy y mm m dd d hh12 h12 hh h nn n ss s fff f zzzz z<br />&nbsp; w wkd weekday mth month am pm zs zh zm tz<br />&nbsp; u ums us um uh ud usd umd uhd udd<br />) do for %%V in (!%%N!) do set &quot;-f=!-f:{%%N}=%%V!&quot;<br /><br />:: Return result<br />endlocal&amp;if &quot;%-R%&quot; neq &quot;&quot; (set &quot;%-R%=%-F%&quot;) else (echo(%-F%)<br />exit /b 0<br /><br /><br />************ JScript portion ***********/<br />WScript.StdOut.Write(eval(WScript.Arguments.Unnamed(0)));<br /></code></pre></div><br /><br /><span style="font-size: 200%; line-height: normal"><strong class="text-strong">END OF CODE</strong></span><br /><br /><br /><strong class="text-strong">Some Preamble from when this post was part of another thread:</strong><br /><br />There are already many posted methods for working with date and time in batch. I thought I would add another option to the fray  <img class="smilies" src="images/smilies/icon_twisted.gif" alt=":twisted:" title="Twisted Evil" /><br /><br />JScript has robust date and time handling, and I already had a hybrid JScript/batch utility called jEval.bat that can dynamically execute any JScript expression and print to stdout the result. The result can be captured by FOR /F for later use. This makes it very easy to incorporate a bit of JScript in any batch script that I want.<br /><br />Assuming jEval.bat is either in the current directory, or else somewhere in the PATH, then the following simple batch subtracts 90 days from the current date and builds a date string that would work well in a file name.<br /><strong class="text-strong"><em class="text-italics"><span style="color: #0000BF">EDIT 2014-08-03: Bug fix dealing with JScript months having 0 index - thanks Paul</span></em></strong><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />setlocal<br />for /f &quot;tokens=1-3&quot; %%A in (<br />&nbsp; 'jeval &quot;d=new Date();d.setDate(d.getDate()-90);d.getFullYear()+' '+(d.getMonth()+1)+' '+d.getDate()&quot;'<br />) do set /a &quot;y=%%A, m=%%B, d=%%C&quot;<br />if %m% lss 10 set &quot;m=0%m%&quot;<br />if %d% lss 10 set &quot;d=0%d%&quot;<br />set &quot;dt=%y%%m%%d%<br />echo current date - 90 days (YYYYMMDD) = %dt%<br /></code></pre></div><br />-- OUTPUT --<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>current date - 90 days (YYYYMMDD) = 20130317<br /></code></pre></div><br />Here is the jEval.bat code:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@if (@X)==(@Y) @end /* harmless hybrid line that begins a JScrpt comment<br /><br />::************ Documentation ***********<br />:::<br />:::jEval&nbsp; JScriptExpression&nbsp; &#91;/N&#93;<br />:::jEval&nbsp; /?<br />:::<br />:::&nbsp; Evaluates a JScript expression and writes the result to stdout.<br />:::<br />:::&nbsp; A newline (CR/LF) is not appended to the result unless the /N<br />:::&nbsp; option is used.<br />:::<br />:::&nbsp; The JScript expression should be enclosed in double quotes.<br />:::<br />:::&nbsp; JScript string literals within the expression should be enclosed<br />:::&nbsp; in single quotes.<br />:::<br />:::&nbsp; Example:<br />:::<br />:::&nbsp; &nbsp; call jEval &quot;'5/4 = ' + 5/4&quot;<br />:::<br />:::&nbsp; Output:<br />:::<br />:::&nbsp; &nbsp; 5/4 = 1.25<br />:::<br /><br />::************ Batch portion ***********<br />@echo off<br /><br />if &quot;%~1&quot; equ &quot;&quot; (<br />&nbsp; call :err &quot;Insufficient arguments&quot;<br />&nbsp; exit /b<br />)<br />if &quot;%~2&quot; neq &quot;&quot; if /i &quot;%~2&quot; neq &quot;/N&quot; (<br />&nbsp; call :err &quot;Invalid option&quot;<br />&nbsp; exit /b<br />)<br />if &quot;%~1&quot; equ &quot;/?&quot; (<br />&nbsp; setlocal enableDelayedExpansion<br />&nbsp; for /f &quot;delims=&quot; %%A in ('findstr &quot;^:::&quot; &quot;%~f0&quot;') do (<br />&nbsp; &nbsp; set &quot;ln=%%A&quot;<br />&nbsp; &nbsp; echo(!ln:~3!<br />&nbsp; )<br />&nbsp; exit /b<br />)<br />cscript //E:JScript //nologo &quot;%~f0&quot; %*<br />exit /b<br /><br />:err<br />&gt;&amp;2 echo ERROR: %~1. Use jeval /? to get help.<br />exit /b 1<br /><br /><br />************ JScript portion ***********/<br />if (WScript.Arguments.Named.Exists(&quot;n&quot;)) {<br />&nbsp; WScript.StdOut.WriteLine(eval(WScript.Arguments.Unnamed(0)));<br />} else {<br />&nbsp; WScript.StdOut.Write(eval(WScript.Arguments.Unnamed(0)));<br />}<br /></code></pre></div><br />All well and good. But then I decided to go crazy with this general technique and add a gazillion options to create a general purpose timestamp calculator and formatter called <strong class="text-strong">getTimestamp.bat</strong>.  See above.<br /><br /><br />Dave Benham</div>

			
													<div class="notice">
					Last edited by <a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a> on 08 Sep 2016 12:38, edited 20 times in total.
									</div>
			
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p27424" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile27424">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf147.html?author_id=3221&amp;sr=posts">6033</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Feb 2012 02:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content27424">

						<h3 ><a href="#p27424">Re: System Date -90 Days and -180 Days</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting0f4f.html?mode=quote&amp;f=3&amp;p=27424" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic7ac4.html?p=27424#p27424" onclick="prompt('Message #2',this.href); return false;">#2</a></span> 
									<a class="unread" href="viewtopic7ac4.html?p=27424#p27424" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a></strong> &raquo; </span>17 Jul 2013 00:22
			</p>
			
			
			
			<div class="content">Another nice bit of kit, Dave. :thumbsup:</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p27451" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile27451">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content27451">

						<h3 ><a href="#p27451">Re: System Date -90 Days and -180 Days</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting237e.html?mode=quote&amp;f=3&amp;p=27451" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicf57c.html?p=27451#p27451" onclick="prompt('Message #3',this.href); return false;">#3</a></span> 
									<a class="unread" href="viewtopicf57c.html?p=27451#p27451" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>17 Jul 2013 12:45
			</p>
			
			
			
			<div class="content">I updated my getTimestamp.bat script above to include a -Z option that specifies the time zone of the output. I also fixed a few obscure bugs, and improved the documentation.<br /><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p27477" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile27477">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistfff4.html?mode=viewprofile&amp;u=3621" class="username">brinda</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search6a76.html?author_id=3621&amp;sr=posts">78</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 25 Apr 2012 23:51</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content27477">

						<h3 ><a href="#p27477">Re: System Date -90 Days and -180 Days</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingb025.html?mode=quote&amp;f=3&amp;p=27477" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic9c9d.html?p=27477#p27477" onclick="prompt('Message #4',this.href); return false;">#4</a></span> 
									<a class="unread" href="viewtopic9c9d.html?p=27477#p27477" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistfff4.html?mode=viewprofile&amp;u=3621" class="username">brinda</a></strong> &raquo; </span>18 Jul 2013 08:22
			</p>
			
			
			
			<div class="content"><img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /> wow. thanks for providing this.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p28095" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile28095">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf147.html?author_id=3221&amp;sr=posts">6033</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Feb 2012 02:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content28095">

						<h3 ><a href="#p28095">Re: getTimestamp.bat for time and date processing</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting8aa7.html?mode=quote&amp;f=3&amp;p=28095" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic0a8c.html?p=28095#p28095" onclick="prompt('Message #5',this.href); return false;">#5</a></span> 
									<a class="unread" href="viewtopic0a8c.html?p=28095#p28095" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a></strong> &raquo; </span>11 Aug 2013 04:57
			</p>
			
			
			
			<div class="content">Dave, I split this off to it's own thread so people can find it.  Cheers.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p30329" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile30329">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist114e.html?mode=viewprofile&amp;u=5221" class="username">gonzalezea</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search523b.html?author_id=5221&amp;sr=posts">1</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 02 Dec 2013 10:17</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content30329">

						<h3 ><a href="#p30329">Re: getTimestamp.bat for time and date processing</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting05f0.html?mode=quote&amp;f=3&amp;p=30329" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic31f6.html?p=30329#p30329" onclick="prompt('Message #6',this.href); return false;">#6</a></span> 
									<a class="unread" href="viewtopic31f6.html?p=30329#p30329" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist114e.html?mode=viewprofile&amp;u=5221" class="username">gonzalezea</a></strong> &raquo; </span>02 Dec 2013 11:00
			</p>
			
			
			
			<div class="content">Great and impressive script !!! <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" />  <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /> thanks !!</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p30347" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile30347">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist79ba.html?mode=viewprofile&amp;u=5194" class="username">julesverne</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search5848.html?author_id=5194&amp;sr=posts">81</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 19 Nov 2013 00:41</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content30347">

						<h3 ><a href="#p30347">Re: getTimestamp.bat for time and date processing</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingc65e.html?mode=quote&amp;f=3&amp;p=30347" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicc2df.html?p=30347#p30347" onclick="prompt('Message #7',this.href); return false;">#7</a></span> 
									<a class="unread" href="viewtopicc2df.html?p=30347#p30347" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist79ba.html?mode=viewprofile&amp;u=5194" class="username">julesverne</a></strong> &raquo; </span>02 Dec 2013 21:29
			</p>
			
			
			
			<div class="content">Awesome!</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p35332" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile35332">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist0d04.html?mode=viewprofile&amp;u=5612" class="username">FunWithLibelium</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search3a90.html?author_id=5612&amp;sr=posts">1</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 20 Jun 2014 11:33</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content35332">

						<h3 ><a href="#p35332">Re: getTimestamp.bat for time and date processing</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting4817.html?mode=quote&amp;f=3&amp;p=35332" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicff21.html?p=35332#p35332" onclick="prompt('Message #8',this.href); return false;">#8</a></span> 
									<a class="unread" href="viewtopicff21.html?p=35332#p35332" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist0d04.html?mode=viewprofile&amp;u=5612" class="username">FunWithLibelium</a></strong> &raquo; </span>20 Jun 2014 12:21
			</p>
			
			
			
			<div class="content">Dave, thanks very much. This worked perfectly for my needs. However please see the following text for a small bug report.<br /><br />Background: I'm a recovering software designer and systems programmer from the '80s. So, I have some (rusty) chops, but almost no experience programming in Windows or even Dos.<br /><br />So, you can imagine how happy I was to stumble on this when I found myself needing to slap yesterday's date into the args to a call to java from a little batch file. Because it was necessary for getTimestamp, and because it looked sufficient for my needs by itself, and because there's an example that does almost exactly what I want, I started with jEval.bat and the subtract 90 days example immediately above it. Ultimately, I made that work, but I believe I found a bug in the example.<br /><br />If you just copy/paste jeval.bat and the &quot;current date minus 90 days&quot; example to a directory and run the example, it gives a date that is 120 days ago, not 90. I believe this is caused by the fact that jscript months are 0 ... 11 rather than 1 ... 12. My proposed fix is:<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />setlocal<br />for /f &quot;tokens=1-3&quot; %%A in (<br />&nbsp; 'jeval &quot;d=new Date();d.setDate(d.getDate()-90);d.getFullYear()+' '+(d.getMonth()+1)+' '+d.getDate()&quot;'<br />) do set /a &quot;y=%%A, m=%%B, d=%%C&quot;<br />if %m% lss 10 set &quot;m=0%m%&quot;<br />if %d% lss 10 set &quot;d=0%d%&quot;<br />set &quot;dt=%y%%m%%d%<br />echo current date - 90 days (YYYYMMDD) = %dt%</code></pre></div><br /><br />And here's the little batch file I used to demonstrate the behavior:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />setlocal<br /><br />echo batch thinks current date is %date%<br /><br />for /f &quot;tokens=1-3&quot; %%A in (<br />&nbsp; 'jeval &quot;d=new Date();d.setDate(d.getDate());d.getFullYear()+' '+d.getMonth()+' '+d.getDate()&quot;'<br />) do set /a &quot;y=%%A, m=%%B, d=%%C&quot;<br />if %m% lss 10 set &quot;m=0%m%&quot;<br />if %d% lss 10 set &quot;d=0%d%&quot;<br />set &quot;dt=%y%%m%%d%<br />echo jEval current date (YYYYMMDD) = %dt%<br /><br />for /f &quot;tokens=1-3&quot; %%A in (<br />&nbsp; 'jeval &quot;d=new Date();d.setDate(d.getDate()-90);d.getFullYear()+' '+d.getMonth()+' '+d.getDate()&quot;'<br />) do set /a &quot;y=%%A, m=%%B, d=%%C&quot;<br />if %m% lss 10 set &quot;m=0%m%&quot;<br />if %d% lss 10 set &quot;d=0%d%&quot;<br />set &quot;dt=%y%%m%%d%<br />echo jEval current date - 90 days (YYYYMMDD) = %dt%<br /><br />echo(<br />echo Accounting for jscript 0-indexed months,<br /><br />for /f &quot;tokens=1-3&quot; %%A in (<br />&nbsp; 'jeval &quot;d=new Date();d.setDate(d.getDate());d.getFullYear()+' '+(d.getMonth()+1)+' '+d.getDate()&quot;'<br />) do set /a &quot;y=%%A, m=%%B, d=%%C&quot;<br />if %m% lss 10 set &quot;m=0%m%&quot;<br />if %d% lss 10 set &quot;d=0%d%&quot;<br />set &quot;dt=%y%%m%%d%<br />echo jEval current date (YYYYMMDD) = %dt%<br /><br />for /f &quot;tokens=1-3&quot; %%A in (<br />&nbsp; 'jeval &quot;d=new Date();d.setDate(d.getDate()-90);d.getFullYear()+' '+(d.getMonth()+1)+' '+d.getDate()&quot;'<br />) do set /a &quot;y=%%A, m=%%B, d=%%C&quot;<br />if %m% lss 10 set &quot;m=0%m%&quot;<br />if %d% lss 10 set &quot;d=0%d%&quot;<br />set &quot;dt=%y%%m%%d%<br />echo jEval current date - 90 days (YYYYMMDD) = %dt%</code></pre></div><br /><br />Because I didn't need or use it, I don't know if the above affects getTimestamp.bat or not.<br /><br />Thanks again.<br /><br />Paul Robinson</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p36092" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile36092">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content36092">

						<h3 ><a href="#p36092">Re: getTimestamp.bat for time and date processing</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting924e.html?mode=quote&amp;f=3&amp;p=36092" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic302f.html?p=36092#p36092" onclick="prompt('Message #9',this.href); return false;">#9</a></span> 
									<a class="unread" href="viewtopic302f.html?p=36092#p36092" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>03 Aug 2014 05:48
			</p>
			
			
			
			<div class="content">Yep - that was a bug in my JEval example. I had detected and fixed the issue with getTimeStamp.bat during initial development, but I forgot to adjust my jEval example. I've edited the initial post.<br /><br />Thanks Paul</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p38387" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile38387">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content38387">

						<h3 ><a href="#p38387">Re: getTimestamp.bat for time and date processing</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingf8a9.html?mode=quote&amp;f=3&amp;p=38387" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic5824-2.html?p=38387#p38387" onclick="prompt('Message #10',this.href); return false;">#10</a></span> 
									<a class="unread" href="viewtopic5824-2.html?p=38387#p38387" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>02 Dec 2014 22:24
			</p>
			
			
			
			<div class="content">getTimestamp.bat version <span style="color: #0000BF"><strong class="text-strong">2.2</strong></span> is here <img class="smilies" src="images/smilies/icon_exclaim.gif" alt=":!:" title="Exclamation" /> <br /><br />This is a major rewrite, but not much new functionality. I am thinking of creating a JScript time formatter function for use in my JREN.BAT utility, and in preparation I modified getTimestamp.bat to do nearly everything in JScript instead of batch.<br /><br />The old functionality and syntax is unchanged, despite the rewrite.<br /><br />New features:<br />- runs about <span style="color: #0000BF"><strong class="text-strong">50%</strong></span> faster than version 1.1<br />- New -V option to display version<br />- Options may now be specified as /Option instead of -Option<br />- Significantly improved error detection and handling<br />- New {{} format component to allow unambiguous { literal in output<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@if (@X)==(@Y) @end&nbsp; /* harmless hybrid line that begins a JScript comment<br />@goto :batch<br />::<br />::getTimestamp.bat version 2.2<br />::<br />::&nbsp; Release History:<br />::&nbsp; &nbsp; 2.2 2014-12-03 - Doc fix: -R ReturnVariable is unchanged if err occurs<br />::&nbsp; &nbsp; 2.1 2014-12-03 - Added GOTO at top to increase performance (32% faster)<br />::&nbsp; &nbsp; 2.0 2014-12-02 - Major rewrite: most code now in JScript (25% faster)<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Better error handling<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;May now use /Option or -Option<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Added -V option<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Added {{} format value to enable unambiguous { literal<br />::&nbsp; &nbsp; 1.1 ????-??-?? - Added -Z option and obscure bug fixes<br />::&nbsp; &nbsp; 1.0 2013-07-17 - Initial release<br />::<br />::============ Documentation ===========<br />:::getTimestamp&nbsp; &#91;-option &#91;value&#93;&#93;...<br />:::<br />:::&nbsp; Displays a formatted timestamp. Defaults to the current local date<br />:::&nbsp; and time using an ISO 8601 format with milliseconds, time zone<br />:::&nbsp; and punctuation.<br />:::<br />:::&nbsp; Returned ERRORLEVEL is 0 upon success, 1 if failure.<br />:::<br />:::&nbsp; Options may be prefaced with - or /<br />:::<br />:::&nbsp; The following options are all case insensitive:<br />:::<br />:::&nbsp; &nbsp; -?<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Prints this documentation for getTimestamp<br />:::<br />:::&nbsp; &nbsp; -V<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Prints the version of getTimeStamp<br />:::<br />:::&nbsp; &nbsp; -U<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Returns a UTC timestamp instead of local timestamp.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is a local timestamp.<br />:::<br />:::&nbsp; &nbsp; -Z TimeZoneMinuteOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Returns the timestamp using the specified time zone offset.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;TimeZoneMinuteOffset is a JScript numeric expression that<br />:::&nbsp; &nbsp; &nbsp; &nbsp;represents the number of minutes offset from UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Decimal values are truncated.<br />:::<br />:::&nbsp; &nbsp; -D DateSpec<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the base date and time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default value is current local date and time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;The DateSpec supports many formats:<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;&quot;&nbsp; &nbsp; (no value)<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Current date and time - the default<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;milliseconds<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;A JScript numeric expression that represents the number of<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;milliseconds since 1970-01-01 00:00:00 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Decimal values are truncated.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative values represent dates prior to 1970-01-01.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'Date &#91;Time&#93; &#91;TimeZone&#93;'&quot;<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;A string representation of the date and time. The date information<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;is required, the time and time zone are optional. Missing time info<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;is assumed to be 0 (midnight). Missing time zone info is assumed to<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;be local time zone.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;The Date, Time, and TimeZone information can be represented as any<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;string that is accepted by the JScript Date.Parse() method.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;There are many formatting options. Documentation is available at:<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;http://msdn.microsoft.com/en-us/library/k4w173wk(v=vs.84).aspx<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Examples of equivalent representations of Midnight on January 4,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2013 assuming local time zone is U.S Eastern Standard Time (EST):<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'1-4-2013'&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Defaults to local time zone<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'January 4, 2013 EST'&quot;&nbsp; &nbsp; &nbsp; &nbsp;Explicit Eastern Std Time (US)<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'2013/1/4 -05'&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Explicit Eastern Std Time (US)<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'Jan 3 2013 23: CST'&quot;&nbsp; &nbsp; &nbsp; &nbsp; Central Standard Time (US)<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'2013 3 Jan 9:00 pm -0800'&quot;&nbsp; Pacific Standard Time (US)<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'01/04/2013 05:00:00 UTC'&quot;&nbsp; &nbsp;Universal Coordinated Time<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'1/4/2013 05:30 +0530'&quot;&nbsp; &nbsp; &nbsp; India Standard Time<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;year, month&#91;, day&#91;, hour&#91;, minute&#91;, second&#91;, millisecond&#93;&#93;&#93;&#93;&#93;&quot;<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;A comma delimited list of numeric JScript expressions representing<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;various components of date and time. Year and month are required,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the rest are optional. Missing values are treated as 0.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Decimal values are truncated. A 0 month represents January.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;A 1 day represents the first day of the month. A 0 day represents<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the last day of the prior month. The date/time value is always<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;in local time. There is no mechanism to specify a time zone.<br />:::<br />:::&nbsp; &nbsp; -OY YearOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the number of years to offset the base date/time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;The JScript numeric expression is truncated to an integral number.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is 0<br />:::<br />:::&nbsp; &nbsp; -OM MonthOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the number of months to offset the base date/time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;The JScript numeric expression is truncated to an integral number.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is 0<br />:::<br />:::&nbsp; &nbsp; -OD DayOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the number of days to offset the base date/time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;The JScript numeric expression is truncated to an integral number.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is 0<br />:::<br />:::&nbsp; &nbsp; -OH HourOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the number of hours to offset the base date/time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;The JScript numeric expression is truncated to an integral number.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is 0<br />:::<br />:::&nbsp; &nbsp; -ON MinuteOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the number of minutes to offset the base date/time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;The JScript numeric expression is truncated to an integral number.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is 0<br />:::<br />:::&nbsp; &nbsp; -OS SecondOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the number of seconds to offset the base date/time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;The JScript numeric expression is truncated to an integral number.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is 0<br />:::<br />:::&nbsp; &nbsp; -OF MillisecondOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the number of milliseconds to offset the base date/time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;The JScript numeric expression is truncated to an integral number.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is 0<br />:::<br />:::&nbsp; &nbsp; -F FormatString<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the timestamp format.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is &quot;{yyyy}-{mm}-{dd}T{hh}:{nn}:{ss}.{fff}{tz}&quot;<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Strings within braces are dynamic components.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;All other strings are literals.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Available components (case insensitive) are:<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{YYYY}&nbsp; 4 digit year, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{YY}&nbsp; &nbsp; 2 digit year, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{Y}&nbsp; &nbsp; &nbsp;year without zero padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{MONTH} month name<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{MTH}&nbsp; &nbsp;month abbreviation<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{MM}&nbsp; &nbsp; 2 digit month, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{M}&nbsp; &nbsp; &nbsp;month without zero padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{WEEKDAY} day of week name<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{WKD}&nbsp; &nbsp;day of week abbreviation<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{W}&nbsp; &nbsp; &nbsp;day of week number, 0=Sunday<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{DD}&nbsp; &nbsp; 2 digit day, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{D}&nbsp; &nbsp; &nbsp;day without zero padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{HH}&nbsp; &nbsp; 2 digit hours, 24 hour format, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{H}&nbsp; &nbsp; &nbsp;hours, 24 hour format without zero padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{HH12}&nbsp; 2 digit hours, 12 hour format, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{H12}&nbsp; &nbsp;hours, 12 hour format without zero padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{NN}&nbsp; &nbsp; 2 digit minutes, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{N}&nbsp; &nbsp; &nbsp;minutes without padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{SS}&nbsp; &nbsp; 2 digit seconds, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{S}&nbsp; &nbsp; &nbsp;seconds without padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{FFF}&nbsp; &nbsp;3 digit milliseconds, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{F}&nbsp; &nbsp; &nbsp;milliseconds without padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{AM}&nbsp; &nbsp; AM or PM in upper case<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{PM}&nbsp; &nbsp; am or pm in lower case<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ZZZZ}&nbsp; timezone expressed as minutes offset from UTC,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;zero padded to 3 digits with sign<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{Z}&nbsp; &nbsp; &nbsp;timzone expressed as minutes offset from UTC without padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ZS}&nbsp; &nbsp; ISO 8601 timezone sign<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ZH}&nbsp; &nbsp; ISO 8601 timezone hours (no sign)<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ZM}&nbsp; &nbsp; ISO 8601 timezone minutes (no sign)<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{TZ}&nbsp; &nbsp; ISO 8601 timezone in +/-hh:mm format<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{U}&nbsp; &nbsp; &nbsp;Unix Epoch time: same as {US}<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Seconds since 1970-01-01 00:00:00 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent dates prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{UMS}&nbsp; &nbsp;Milliseconds since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{US}&nbsp; &nbsp; Seconds since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{UM}&nbsp; &nbsp; Minutes since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{UH}&nbsp; &nbsp; Hours since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{UD}&nbsp; &nbsp; Days since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{USD}&nbsp; &nbsp;Decimal seconds since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{UMD}&nbsp; &nbsp;Decimal minutes since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{UHD}&nbsp; &nbsp;Decimal hours since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{UDD}&nbsp; &nbsp;Decimal days since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{{}&nbsp; &nbsp; &nbsp;A { character<br />:::<br />:::&nbsp; &nbsp; -R ReturnVariable<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Save the timestamp in ReturnVariable instead of displaying it.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;ReturnVariable is unchanged if an error occurs.<br />:::<br />:::&nbsp; &nbsp; -WKD &quot;Abbreviated day of week list&quot;<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Override the default output day abbreviations with a space delimited<br />:::&nbsp; &nbsp; &nbsp; &nbsp;quoted list, starting with Sun.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is mixed case 3 character English abbreviations.<br />:::<br />:::&nbsp; &nbsp; -WEEKDAY &quot;Day of week list&quot;<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Override the default output day names with a space delimited,<br />:::&nbsp; &nbsp; &nbsp; &nbsp;quoted list, starting with Sunday.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is mixed case English names.<br />:::<br />:::&nbsp; &nbsp; -MTH &quot;Abbreviated month list&quot;<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Override the default output month abbreviations with a space delimited<br />:::&nbsp; &nbsp; &nbsp; &nbsp;quoted list, starting with Jan.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is mixed case English 3 character abbreviations.<br />:::<br />:::&nbsp; &nbsp; -MONTH &quot;Month list&quot;<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Override the default output month names with a space delimited<br />:::&nbsp; &nbsp; &nbsp; &nbsp;quoted list, starting with January.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is mixed case English names.<br />:::<br /><br />============= :Batch portion ===========<br />@echo off<br />setlocal enableDelayedExpansion<br /><br />:: Define options<br />set ^&quot;options=^<br />&nbsp;-?:^<br />&nbsp;-v:^<br />&nbsp;-u:^<br />&nbsp;-z:&quot;&quot;^<br />&nbsp;-f:&quot;{yyyy}-{mm}-{dd}T{hh}:{nn}:{ss}.{fff}{tz}&quot;^<br />&nbsp;-d:&quot;&quot;^<br />&nbsp;-oy:&quot;&quot;^<br />&nbsp;-om:&quot;&quot;^<br />&nbsp;-od:&quot;&quot;^<br />&nbsp;-oh:&quot;&quot;^<br />&nbsp;-on:&quot;&quot;^<br />&nbsp;-os:&quot;&quot;^<br />&nbsp;-of:&quot;&quot;^<br />&nbsp;-r:&quot;&quot;^<br />&nbsp;-wkd:&quot;Sun Mon Tue Wed Thu Fri Sat&quot;^<br />&nbsp;-weekday:&quot;Sunday Monday Tuesday Wednesday Thursday Friday Saturday&quot;^<br />&nbsp;-mth:&quot;Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec&quot;^<br />&nbsp;-month:&quot;January February March April May June July August September October November December&quot;^&quot;<br /><br />:: Set default option values<br />for %%O in (%options%) do for /f &quot;tokens=1,* delims=:&quot; %%A in (&quot;%%O&quot;) do set &quot;%%A=%%~B&quot;<br /><br />:: Get options<br />:loop<br />if not &quot;%~1&quot;==&quot;&quot; (<br />&nbsp; set &quot;arg=%~1&quot;<br />&nbsp; if &quot;!arg:~0,1!&quot; equ &quot;/&quot; set &quot;arg=-!arg:~1!&quot;<br />&nbsp; for /f delims^=^ eol^= %%A in (&quot;!arg!&quot;) do set &quot;test=!options:*%%A:=! &quot;<br />&nbsp; if &quot;!test!&quot;==&quot;!options! &quot; (<br />&nbsp; &nbsp; &nbsp; &gt;&amp;2 echo Error: Invalid option %~1. Use %~nx0 -? to get help.<br />&nbsp; &nbsp; &nbsp; exit /b 1<br />&nbsp; ) else if &quot;!test:~0,1!&quot;==&quot; &quot; (<br />&nbsp; &nbsp; &nbsp; set &quot;!arg!=1&quot;<br />&nbsp; &nbsp; &nbsp; if /i &quot;!arg!&quot; equ &quot;-U&quot; set &quot;-z=&quot;<br />&nbsp; ) else (<br />&nbsp; &nbsp; &nbsp; set &quot;!arg!=%~2&quot;<br />&nbsp; &nbsp; &nbsp; shift /1<br />&nbsp; )<br />&nbsp; shift /1<br />&nbsp; goto :loop<br />)<br />if defined -z set &quot;-u=1&quot;<br />if defined -r set &quot;%-r%=&quot;<br /><br />:: Display help<br />if defined -? (<br />&nbsp; for /f &quot;delims=: tokens=*&quot; %%A in ('findstr &quot;^:::&quot; &quot;%~f0&quot;') do echo(%%A<br />&nbsp; exit /b 0<br />)<br /><br />:: Display version<br />if defined -v (<br />&nbsp; for /f &quot;tokens=* delims=:&quot; %%A in ('findstr &quot;^::getTimestamp\.bat&quot; &quot;%~f0&quot;') do @echo(%%A<br />&nbsp; exit /b 0<br />)<br /><br />:: Execute the JScript script and return the result<br />for /f &quot;delims=&quot; %%A in ('cscript //E:JScript //nologo &quot;%~f0&quot;') do (<br />&nbsp; endlocal<br />&nbsp; if &quot;%-R%&quot; neq &quot;&quot; (set &quot;%-R%=%%A&quot;) else (echo(%%A)<br />&nbsp; exit /b 0<br />)<br />exit /b 1;<br /><br /><br />************ JScript portion ***********/<br />var env&nbsp; = WScript.CreateObject(&quot;WScript.Shell&quot;).Environment(&quot;Process&quot;),<br />&nbsp; &nbsp; utc&nbsp; = env('-U'),<br />&nbsp; &nbsp; wkd&nbsp; &nbsp; &nbsp;= env('-WKD').split(' '),<br />&nbsp; &nbsp; weekday = env('-WEEKDAY').split(' '),<br />&nbsp; &nbsp; mth&nbsp; &nbsp; &nbsp;= env('-MTH').split(' '),<br />&nbsp; &nbsp; month&nbsp; &nbsp;= env('-MONTH').split(' '),<br />&nbsp; &nbsp; stderr&nbsp; = WScript.StdErr,<br />&nbsp; &nbsp; y,m,d,w,h,h12,n,s,f,u,z,zs,za;<br /><br />if (wkd.length!=7)&nbsp; &nbsp; &nbsp;badOp('-WKD');<br />if (weekday.length!=7) badOp('-WEEKDAY');<br />if (mth.length!=12)&nbsp; &nbsp; badOp('-MTH');<br />if (month.length!=12)&nbsp; badOp('-MONTH');<br /><br />try {<br />&nbsp; var dt = eval('new Date('+env('-D')+')');<br />} catch(e) {<br />} finally {<br />&nbsp; if (isNaN(dt)) badOp('-D');<br />}<br /><br />if (env('-OY')) dt.setFullYear(&nbsp; &nbsp; &nbsp;dt.getFullYear()&nbsp; &nbsp; +getNum('-OY') );<br />if (env('-OM')) dt.setMonth(&nbsp; &nbsp; &nbsp; &nbsp; dt.getMonth()&nbsp; &nbsp; &nbsp; &nbsp;+getNum('-OM') );<br />if (env('-OD')) dt.setDate(&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dt.getDate()&nbsp; &nbsp; &nbsp; &nbsp; +getNum('-OD') );<br />if (env('-OH')) dt.setHours(&nbsp; &nbsp; &nbsp; &nbsp; dt.getHours()&nbsp; &nbsp; &nbsp; &nbsp;+getNum('-OH') );<br />if (env('-ON')) dt.setMinutes(&nbsp; &nbsp; &nbsp; dt.getMinutes()&nbsp; &nbsp; &nbsp;+getNum('-ON') );<br />if (env('-OS')) dt.setSeconds(&nbsp; &nbsp; &nbsp; dt.getSeconds()&nbsp; &nbsp; &nbsp;+getNum('-OS') );<br />if (env('-OF')) dt.setMilliseconds( dt.getMilliseconds()+getNum('-OF') );<br />if (env('-Z'))&nbsp; dt.setMinutes(&nbsp; &nbsp; &nbsp; dt.getMinutes()&nbsp; +(z=getNum('-Z')) );<br /><br />y = utc ? dt.getUTCFullYear(): dt.getFullYear();<br />m = utc ? dt.getUTCMonth()&nbsp; &nbsp;: dt.getMonth();<br />d = utc ? dt.getUTCDate()&nbsp; &nbsp; : dt.getDate();<br />w = utc ? dt.getUTCDay()&nbsp; &nbsp; &nbsp;: dt.getDay();<br />h = utc ? dt.getUTCHours()&nbsp; &nbsp;: dt.getHours();<br />n = utc ? dt.getUTCMinutes() : dt.getMinutes();<br />s = utc ? dt.getUTCSeconds() : dt.getSeconds();<br />f = utc ? dt.getUTCMilliseconds() : dt.getMilliseconds();<br />u = dt.getTime();<br /><br />h12 = h%12;<br />if (!h12) h12=12;<br /><br />if (z==undefined) if (utc) z=0; else z=-dt.getTimezoneOffset();<br />zs = z&lt;0 ? '-' : '+';<br />za = Math.abs(z);<br /><br />WScript.echo( env('-F').replace( /\{(.*?)\}/gi, repl ) );<br />WScript.Quit(0);<br /><br />function lpad( val, pad ) {<br />&nbsp; var rtn=val.toString();<br />&nbsp; return (rtn.length&lt;pad.length) ? (pad+rtn).slice(-pad.length) : val;<br />}<br /><br />function getNum( v ) {<br />&nbsp; var rtn;<br />&nbsp; try {<br />&nbsp; &nbsp; rtn = Number(eval(env(v)));<br />&nbsp; } catch(e) {<br />&nbsp; } finally {<br />&nbsp; &nbsp; if (isNaN(rtn-rtn)) badOp(v);<br />&nbsp; &nbsp; return rtn;<br />&nbsp; }<br />}<br /><br />function badOp(option) {<br />&nbsp; stderr.WriteLine('Error: Invalid '+option+' value');<br />&nbsp; WScript.Quit(1);<br />}<br /><br />function trunc( n ) { return Math&#91;n&gt;0?&quot;floor&quot;:&quot;ceil&quot;&#93;(n); }<br /><br />function repl($0,$1) {<br />&nbsp; switch ($1.toUpperCase()) {<br />&nbsp; &nbsp; case 'YYYY' : return lpad(y,'0000');<br />&nbsp; &nbsp; case 'YY'&nbsp; &nbsp;: return ('00'+y.toString()).slice(-2);<br />&nbsp; &nbsp; case 'Y'&nbsp; &nbsp; : return y.toString();<br />&nbsp; &nbsp; case 'MM'&nbsp; &nbsp;: return lpad(m+1,'00');<br />&nbsp; &nbsp; case 'M'&nbsp; &nbsp; : return (m+1).toString();<br />&nbsp; &nbsp; case 'DD'&nbsp; &nbsp;: return lpad(d,'00');<br />&nbsp; &nbsp; case 'D'&nbsp; &nbsp; : return d.toString();<br />&nbsp; &nbsp; case 'W'&nbsp; &nbsp; : return w.toString();<br />&nbsp; &nbsp; case 'HH'&nbsp; &nbsp;: return lpad(h,'00');<br />&nbsp; &nbsp; case 'H'&nbsp; &nbsp; : return h.toString();<br />&nbsp; &nbsp; case 'HH12' : return lpad(h12,'00');<br />&nbsp; &nbsp; case 'H12'&nbsp; : return h12.toString();<br />&nbsp; &nbsp; case 'NN'&nbsp; &nbsp;: return lpad(n,'00');<br />&nbsp; &nbsp; case 'N'&nbsp; &nbsp; : return n.toString();<br />&nbsp; &nbsp; case 'SS'&nbsp; &nbsp;: return lpad(s,'00');<br />&nbsp; &nbsp; case 'S'&nbsp; &nbsp; : return s.toString();<br />&nbsp; &nbsp; case 'FFF'&nbsp; : return lpad(f,'000');<br />&nbsp; &nbsp; case 'F'&nbsp; &nbsp; : return f.toString();<br />&nbsp; &nbsp; case 'AM'&nbsp; &nbsp;: return h&gt;=12 ? 'PM' : 'AM';<br />&nbsp; &nbsp; case 'PM'&nbsp; &nbsp;: return h&gt;=12 ? 'pm' : 'am';<br />&nbsp; &nbsp; case 'UMS'&nbsp; : return u.toString();<br />&nbsp; &nbsp; case 'USD'&nbsp; : return (u/1000).toString();<br />&nbsp; &nbsp; case 'UMD'&nbsp; : return (u/1000/60).toString();<br />&nbsp; &nbsp; case 'UHD'&nbsp; : return (u/1000/60/60).toString();<br />&nbsp; &nbsp; case 'UDD'&nbsp; : return (u/1000/60/60/24).toString();<br />&nbsp; &nbsp; case 'U'&nbsp; &nbsp; : return trunc(u/1000).toString();<br />&nbsp; &nbsp; case 'US'&nbsp; &nbsp;: return trunc(u/1000).toString();<br />&nbsp; &nbsp; case 'UM'&nbsp; &nbsp;: return trunc(u/1000/60).toString();<br />&nbsp; &nbsp; case 'UH'&nbsp; &nbsp;: return trunc(u/1000/60/60).toString();<br />&nbsp; &nbsp; case 'UD'&nbsp; &nbsp;: return trunc(u/1000/60/60/24).toString();<br />&nbsp; &nbsp; case 'ZZZZ' : return zs+lpad(za,'000');<br />&nbsp; &nbsp; case 'Z'&nbsp; &nbsp; : return z.toString();<br />&nbsp; &nbsp; case 'ZS'&nbsp; &nbsp;: return zs;<br />&nbsp; &nbsp; case 'ZH'&nbsp; &nbsp;: return lpad(trunc(za/60),'00');<br />&nbsp; &nbsp; case 'ZM'&nbsp; &nbsp;: return lpad(za%60,'00');<br />&nbsp; &nbsp; case 'TZ'&nbsp; &nbsp;: return zs+lpad(trunc(za/60),'00')+':'+lpad(za%60,'00');<br />&nbsp; &nbsp; case 'WEEKDAY': return weekday&#91;w&#93;;<br />&nbsp; &nbsp; case 'WKD'&nbsp; &nbsp; : return wkd&#91;w&#93;;<br />&nbsp; &nbsp; case 'MONTH'&nbsp; : return month&#91;m&#93;;<br />&nbsp; &nbsp; case 'MTH'&nbsp; &nbsp; : return mth&#91;m&#93;;<br />&nbsp; &nbsp; case '{'&nbsp; &nbsp; &nbsp; : return $1;<br />&nbsp; &nbsp; default&nbsp; &nbsp; &nbsp; &nbsp;: return $0;<br />&nbsp; }<br />}<br /></code></pre></div><br /><br />Dave Benham</div>

			
													<div class="notice">
					Last edited by <a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a> on 03 Dec 2014 22:32, edited 2 times in total.
									</div>
			
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p38403" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile38403">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content38403">

						<h3 ><a href="#p38403">Re: getTimestamp.bat for time and date processing</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting18c7.html?mode=quote&amp;f=3&amp;p=38403" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopica968.html?p=38403#p38403" onclick="prompt('Message #11',this.href); return false;">#11</a></span> 
									<a class="unread" href="viewtopica968.html?p=38403#p38403" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>03 Dec 2014 20:47
			</p>
			
			
			
			<div class="content">Updated the prior post to version 2.1.<br /><br />The only change was the addition of a GOTO at the very top so that batch no longer wastes its time parsing the documentation comments. I was mildly surprised that this small change results in 32% speed improvement over version 2.0. So now version 2.1 is 50% faster than 1.1.<br /><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p38404" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile38404">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist2675.html?mode=viewprofile&amp;u=2988" style="color: #00AA00;" class="username-coloured">Squashman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1322.html?author_id=2988&amp;sr=posts">3970</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 Dec 2011 13:59</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content38404">

						<h3 ><a href="#p38404">Re: getTimestamp.bat for time and date processing</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting91ea.html?mode=quote&amp;f=3&amp;p=38404" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic93fd.html?p=38404#p38404" onclick="prompt('Message #12',this.href); return false;">#12</a></span> 
									<a class="unread" href="viewtopic93fd.html?p=38404#p38404" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist2675.html?mode=viewprofile&amp;u=2988" style="color: #00AA00;" class="username-coloured">Squashman</a></strong> &raquo; </span>03 Dec 2014 21:01
			</p>
			
			
			
			<div class="content">Well it is 300 lines of excellent documentation.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p38405" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile38405">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content38405">

						<h3 ><a href="#p38405">Re: getTimestamp.bat for time and date processing</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting9e0b.html?mode=quote&amp;f=3&amp;p=38405" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic7f59.html?p=38405#p38405" onclick="prompt('Message #13',this.href); return false;">#13</a></span> 
									<a class="unread" href="viewtopic7f59.html?p=38405#p38405" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>03 Dec 2014 22:32
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>Squashman wrote:</cite>Well it is 300 lines of excellent documentation.</div></blockquote> <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /> <br /><br />But funny you should say that. I just discovered a long standing mistake in the documentation, so I updated the prior code to version 2.2 with the corrected doc.<br /><br />Going all the way back to version 1, I thought I was undefining the -R return variable upon error. But I was doing that before any ENDLOCAL, so any pre-existing value remained after error. <img class="smilies" src="images/smilies/icon_rolleyes.gif" alt=":roll:" title="Rolling Eyes" /> <br /><br />Upon reflection, my old intent was ambiguous, because the error might occur before I have parsed the -R option.<br /><br />I've decided to change the documentation instead of changing the behavior. Version 2.2 is just a minimal change to the Documentation.<br /><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p39475" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile39475">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist2675.html?mode=viewprofile&amp;u=2988" style="color: #00AA00;" class="username-coloured">Squashman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1322.html?author_id=2988&amp;sr=posts">3970</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 Dec 2011 13:59</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content39475">

						<h3 ><a href="#p39475">Re: getTimestamp.bat for time and date processing</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingd2b3.html?mode=quote&amp;f=3&amp;p=39475" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic7502.html?p=39475#p39475" onclick="prompt('Message #14',this.href); return false;">#14</a></span> 
									<a class="unread" href="viewtopic7502.html?p=39475#p39475" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist2675.html?mode=viewprofile&amp;u=2988" style="color: #00AA00;" class="username-coloured">Squashman</a></strong> &raquo; </span>25 Jan 2015 12:16
			</p>
			
			
			
			<div class="content">I am definitely not understanding how to use this.<br /><br />I have been trying to feed it different date/Time formats for the /D option but everyone of them comes back with an invalid -D option error.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>C:\BatchFiles\JGetTimeStamp&gt;for /F &quot;delims=&quot; %G in ('dir /b &quot;file(2).txt&quot;') do gettimestamp /D &quot;%~tG&quot; /F &quot;{UH}&quot;<br /><br />C:\BatchFiles\JGetTimeStamp&gt;gettimestamp /D &quot;01/25/2015 11:55 AM&quot; /F &quot;{UH}&quot;<br />Error: Invalid -D value<br /><br />C:\BatchFiles\JGetTimeStamp&gt;gettimestamp /D &quot;01/25/15 11:55 AM&quot; /F &quot;{UH}&quot;<br />Error: Invalid -D value<br /><br />C:\BatchFiles\JGetTimeStamp&gt;gettimestamp /D &quot;1/25/15 11:55 AM&quot; /F &quot;{UH}&quot;<br />Error: Invalid -D value<br /><br />C:\BatchFiles\JGetTimeStamp&gt;gettimestamp /D &quot;1/25/15&quot; /F &quot;{UH}&quot;<br />0<br /><br />C:\BatchFiles\JGetTimeStamp&gt;gettimestamp /D &quot;1/25/2015&quot; /F &quot;{UH}&quot;<br />0<br /><br />C:\BatchFiles\JGetTimeStamp&gt;gettimestamp /D &quot;1/25/2015 23:00&quot; /F &quot;{UH}&quot;<br />Error: Invalid -D value</code></pre></div></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p39476" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile39476">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist2675.html?mode=viewprofile&amp;u=2988" style="color: #00AA00;" class="username-coloured">Squashman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1322.html?author_id=2988&amp;sr=posts">3970</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 Dec 2011 13:59</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content39476">

						<h3 ><a href="#p39476">Re: getTimestamp.bat for time and date processing</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting6460.html?mode=quote&amp;f=3&amp;p=39476" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicea98.html?p=39476#p39476" onclick="prompt('Message #15',this.href); return false;">#15</a></span> 
									<a class="unread" href="viewtopicea98.html?p=39476#p39476" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist2675.html?mode=viewprofile&amp;u=2988" style="color: #00AA00;" class="username-coloured">Squashman</a></strong> &raquo; </span>25 Jan 2015 12:48
			</p>
			
			
			
			<div class="content">This confuses me even more.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>C:\BatchFiles\JGetTimeStamp&gt;gettimestamp /D &quot;2015,01,25,11,25&quot;<br />2015-02-25T11:25:00.000-06:00<br /><br />C:\BatchFiles\JGetTimeStamp&gt;gettimestamp /D &quot;2015,1,25,11,25&quot;<br />2015-02-25T11:25:00.000-06:00</code></pre></div></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
	

	<div class="action-bar bar-bottom">
	
			<a href="postingfde4.html?mode=reply&amp;f=3&amp;t=4847" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopice6a4.html?f=3&amp;t=4847&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

			<form method="post" action="https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=4847">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			46 posts
							<ul>
		<li class="active"><span>1</span></li>
				<li><a class="button" href="viewtopic4c44.html?f=3&amp;t=4847&amp;start=15" role="button">2</a></li>
				<li><a class="button" href="viewtopice8f9.html?f=3&amp;t=4847&amp;start=30" role="button">3</a></li>
				<li><a class="button" href="viewtopiccf06.html?f=3&amp;t=4847&amp;start=45" role="button">4</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopic4c44.html?f=3&amp;t=4847&amp;start=15" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="viewforum4d6b.html?f=3" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to “DOS Batch Forum”</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="viewforum31e6.html?f=4" class="jumpbox-cat-link"> <span> DosTips - Dos Batch</span></a></li>
																<li><a href="viewforum4d6b.html?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; DOS Batch Forum</span></a></li>
											</ul>
		</div>
	</div>

	</div>


			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
							<span class="crumb"><a href="../index.html" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>DosTips.com</span></a></span>									<span class="crumb"><a href="index.html" data-navbar-reference="index"><span>Board index</span></a></span>					</li>
		
				<li class="rightside">All times are <span title="UTC-6">UTC-06:00</span></li>
							<li class="rightside">
				<a href="ucp033a.html?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete all board cookies</span>
				</a>
			</li>
												<li class="rightside" data-last-responsive="true">
				<a href="memberlist4bfd.html?mode=team" role="menuitem">
					<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
				</a>
			</li>
									<li class="rightside" data-last-responsive="true">
				<a href="memberlist8733.html?mode=contactadmin" role="menuitem">
					<i class="icon fa-envelope fa-fw" aria-hidden="true"></i><span>Contact us</span>
				</a>
			</li>
			</ul>

	</div>
</div>

	<div class="copyright">
				<!-- WARNING NO DELETE -->Style developer by <a href="http://tricolor.x-tk.ru/">support forum tricolor</a>, <!-- END WARNING NO DELETE -->Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
									</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	<img src="cronc6bf.gif?cron_type=cron.task.text_reparser.user_signature" width="1" height="1" alt="cron" /></div>

<script type="text/javascript" src="assets/javascript/jquery.mind772.js?assets_version=34"></script>
<script type="text/javascript" src="assets/javascript/cored772.js?assets_version=34"></script>



<script type="text/javascript" src="styles/prosilver/template/forum_fnd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/prosilver/template/ajaxd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/jquery-uid772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/collapsed772.js?assets_version=34"></script>



</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?p=30347 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 07:58:35 GMT -->
</html>
