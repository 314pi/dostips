<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=4847&start=15 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 07:57:40 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>getTimestamp.bat for time and date processing - Page 2 - DosTips.com</title>


	<link rel="canonical" href="viewtopic34da.html?t=4847&amp;start=15">

<!--
	phpBB style name: Allan Style - SUBSILVER
	Based on style:   prosilver (this is the default phpBB3 style)
	Based on style:   subsilver2 (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:  Allan ( http://x-tk.ru/ )
-->

<link href="assets/css/font-awesome.mind772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/stylesheetd772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/en/stylesheetd772.css?assets_version=34" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="./styles/AllanStyle-SUBSILVER/theme/tweaks.css?assets_version=34" rel="stylesheet">
<![endif]-->




<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','../../www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-280191-1', 'auto');
	ga('send', 'pageview');
</script>

</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">

<div id="header-subsilver">
	<a id="top" class="top-anchor" accesskey="t"></a>
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description" class="site-description">
				<a id="logo" class="logo" href="../index.html" title="DosTips.com"><span class="site_logo"></span></a>
				<h1>DosTips.com</h1>
				<p>A Forum all about DOS Batch</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

									<div id="search-box" class="search-box search-header" role="search">
				<form action="https://www.dostips.com/forum/search.php" method="get" id="search">
				<fieldset>
					<input name="keywords" id="keywords" type="search" maxlength="128" title="Search for keywords" class="inputbox search tiny" size="20" value="" placeholder="Search…" />
					<button class="button button-search" type="submit" title="Search">
						<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
					</button>
					<a href="search.html" class="button button-search-end" title="Advanced search">
						<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
					</a>
					
				</fieldset>
				</form>
			</div>
						
			</div>
					</div>
</div>


<div id="wrap" class="wrap">
	<div id="page-header">
				<div class="navbar-top" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
																									<li>
								<a href="search33a7.html?search_id=unanswered" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="search526f.html?search_id=active_topics" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-blue" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="search.html" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
											<li class="separator"></li>
																			<li>
								<a href="memberlist4bfd.html?mode=team" role="menuitem">
									<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
								</a>
							</li>
																<li class="separator"></li>

									</ul>
			</div>
		</li>

				<li data-skip-responsive="true">
			<a href="app.php/help/faq.html" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
						
			<li class="rightside"  data-skip-responsive="true">
			<a href="ucp26c3.html?mode=login" title="Login" accesskey="x" role="menuitem">
				<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Login</span>
			</a>
		</li>
					<li class="rightside" data-skip-responsive="true">
				<a href="ucp8319.html?mode=register" role="menuitem">
					<i class="icon fa-pencil-square-o  fa-fw" aria-hidden="true"></i><span>Register</span>
				</a>
			</li>
						</ul>

	</div>
</div>

<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
						<li class="breadcrumbs">
							<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="../index.html" itemprop="url" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span itemprop="title">DosTips.com</span></a></span>
										<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="index.html" itemprop="url" accesskey="h" data-navbar-reference="index"><span itemprop="title">Board index</span></a></span>

											<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="4"><a href="viewforum31e6.html?f=4" itemprop="url"><span itemprop="title">DosTips - Dos Batch</span></a></span>
															<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="3"><a href="viewforum4d6b.html?f=3" itemprop="url"><span itemprop="title">DOS Batch Forum</span></a></span>
												</li>
		
					<li class="rightside responsive-search">
				<a href="search.html" title="View the advanced search options" role="menuitem">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</a>
			</li>
			</ul>

	</div>
</div>

<div class="navbar-top-link">
	<div class="inner">
		<ul>
			<li class="navbar-top-link-left"><a href="search33a7.html?search_id=unanswered">Unanswered topics</a></li>
			<li class="navbar-top-link-left"><a href="search526f.html?search_id=active_topics">Active topics</a></li>

											</ul>
	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
		
<h2 class="topic-title"><a href="viewtopic4c44.html?f=3&amp;t=4847&amp;start=15">getTimestamp.bat for time and date processing</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">Discussion forum for all Windows batch related topics.<br /></div>
<p>
	<strong>Moderator:</strong> <a href="memberlista6a8.html?mode=viewprofile&amp;u=5" class="username">DosItHelp</a>
</p>


<div class="action-bar bar-top">
	
			<a href="postingfde4.html?mode=reply&amp;f=3&amp;t=4847" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic36d6-2.html?f=3&amp;t=4847&amp;start=15&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="https://www.dostips.com/forum/search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topic…" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="search.html" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="4847" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			46 posts
							<ul>
			<li class="arrow previous"><a class="button button-icon-only" href="viewtopic5ecb.html?f=3&amp;t=4847" rel="prev" role="button"><i class="icon fa-chevron-left fa-fw" aria-hidden="true"></i><span class="sr-only">Previous</span></a></li>
				<li><a class="button" href="viewtopic5ecb.html?f=3&amp;t=4847" role="button">1</a></li>
			<li class="active"><span>2</span></li>
				<li><a class="button" href="viewtopice8f9.html?f=3&amp;t=4847&amp;start=30" role="button">3</a></li>
				<li><a class="button" href="viewtopiccf06.html?f=3&amp;t=4847&amp;start=45" role="button">4</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopice8f9.html?f=3&amp;t=4847&amp;start=30" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
		</div>




<div id="subsilver-nav-topic">
	<div class="inner"><div class="post has-profile">
		<div class="leftsided postbody subsilver-topic-title">Message</div>
		<div class="leftsided postprofile subsilver-topic-author">Author</div>
	</div></div>
</div>

			<div id="p39481" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile39481">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content39481">

						<h3 class="first"><a href="#p39481">Re: getTimestamp.bat for time and date processing</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting2fc8.html?mode=quote&amp;f=3&amp;p=39481" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic0c27.html?p=39481#p39481" onclick="prompt('Message #16',this.href); return false;">#16</a></span> 
									<a class="unread" href="viewtopic0c27.html?p=39481#p39481" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>25 Jan 2015 13:37
			</p>
			
			
			
			<div class="content">It is all in the documentation, but it can be confusing differentiating the various options until you get used to it.  <img class="smilies" src="images/smilies/icon_twisted.gif" alt=":twisted:" title="Twisted Evil" /> <br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>-D DateSpec<br /><br />&nbsp; &nbsp;Specify the base date and time.<br />&nbsp; &nbsp;Default value is current local date and time.<br />&nbsp; &nbsp;The DateSpec supports many formats:<br /><br />&nbsp; &nbsp; &nbsp;&quot;&quot;&nbsp; &nbsp; (no value)<br /><br />&nbsp; &nbsp; &nbsp; &nbsp;Current date and time - the default<br /><br />&nbsp; &nbsp; &nbsp;milliseconds<br /><br />&nbsp; &nbsp; &nbsp; &nbsp;A JScript numeric expression that represents the number of<br />&nbsp; &nbsp; &nbsp; &nbsp;milliseconds since 1970-01-01 00:00:00 UTC.<br />&nbsp; &nbsp; &nbsp; &nbsp;Decimal values are truncated.<br />&nbsp; &nbsp; &nbsp; &nbsp;Negative values represent dates prior to 1970-01-01.<br /><br />&nbsp; &nbsp; &nbsp;&quot;'Date &#91;Time&#93; &#91;TimeZone&#93;'&quot;<br /><br />&nbsp; &nbsp; &nbsp; &nbsp;A string representation of the date and time. The date information<br />&nbsp; &nbsp; &nbsp; &nbsp;is required, the time and time zone are optional. Missing time info<br />&nbsp; &nbsp; &nbsp; &nbsp;is assumed to be 0 (midnight). Missing time zone info is assumed to<br />&nbsp; &nbsp; &nbsp; &nbsp;be local time zone.<br /><br />&nbsp; &nbsp; &nbsp; &nbsp;The Date, Time, and TimeZone information can be represented as any<br />&nbsp; &nbsp; &nbsp; &nbsp;string that is accepted by the JScript Date.Parse() method.<br />&nbsp; &nbsp; &nbsp; &nbsp;There are many formatting options. Documentation is available at:<br />&nbsp; &nbsp; &nbsp; &nbsp;http://msdn.microsoft.com/en-us/library/k4w173wk(v=vs.84).aspx<br /><br />&nbsp; &nbsp; &nbsp; &nbsp;Examples of equivalent representations of Midnight on January 4,<br />&nbsp; &nbsp; &nbsp; &nbsp;2013 assuming local time zone is U.S Eastern Standard Time (EST):<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'1-4-2013'&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Defaults to local time zone<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'January 4, 2013 EST'&quot;&nbsp; &nbsp; &nbsp; &nbsp;Explicit Eastern Std Time (US)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'2013/1/4 -05'&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Explicit Eastern Std Time (US)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'Jan 3 2013 23: CST'&quot;&nbsp; &nbsp; &nbsp; &nbsp; Central Standard Time (US)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'2013 3 Jan 9:00 pm -0800'&quot;&nbsp; Pacific Standard Time (US)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'01/04/2013 05:00:00 UTC'&quot;&nbsp; &nbsp;Universal Coordinated Time<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'1/4/2013 05:30 +0530'&quot;&nbsp; &nbsp; &nbsp; India Standard Time<br /><br />&nbsp; &nbsp; &nbsp;&quot;year, month&#91;, day&#91;, hour&#91;, minute&#91;, second&#91;, millisecond&#93;&#93;&#93;&#93;&#93;&quot;<br /><br />&nbsp; &nbsp; &nbsp; &nbsp;A comma delimited list of numeric JScript expressions representing<br />&nbsp; &nbsp; &nbsp; &nbsp;various components of date and time. Year and month are required,<br />&nbsp; &nbsp; &nbsp; &nbsp;the rest are optional. Missing values are treated as 0.<br />&nbsp; &nbsp; &nbsp; &nbsp;Decimal values are truncated. A 0 month represents January.<br />&nbsp; &nbsp; &nbsp; &nbsp;A 1 day represents the first day of the month. A 0 day represents<br />&nbsp; &nbsp; &nbsp; &nbsp;the last day of the prior month. The date/time value is always<br />&nbsp; &nbsp; &nbsp; &nbsp;in local time. There is no mechanism to specify a time zone.<br /></code></pre></div><br /> <br />When specifying the date as a string, you must remember to enclose the value in single quotes. The single quotes are for JScript to signify a string. The value must also be enclosed by double quotes in order for batch to treat the value with spaces as a single argument.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>C:\test&gt;gettimestamp /D &quot;'01/25/2015 11:55 AM'&quot; /F &quot;{UH}&quot;<br />395056<br /></code></pre></div><br /><br />When specifying the date as a comma delimited list of integral values, you must remember that months are zero based: 0=January, 1=February, etc.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>C:\test&gt;gettimestamp /D &quot;2015,0,25,11,25&quot;<br />2015-01-25T11:25:00.000-05:00<br /></code></pre></div><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p39482" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile39482">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist2675.html?mode=viewprofile&amp;u=2988" style="color: #00AA00;" class="username-coloured">Squashman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1322.html?author_id=2988&amp;sr=posts">3970</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 Dec 2011 13:59</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content39482">

						<h3 ><a href="#p39482">Re: getTimestamp.bat for time and date processing</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingd49c.html?mode=quote&amp;f=3&amp;p=39482" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic189e.html?p=39482#p39482" onclick="prompt('Message #17',this.href); return false;">#17</a></span> 
									<a class="unread" href="viewtopic189e.html?p=39482#p39482" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist2675.html?mode=viewprofile&amp;u=2988" style="color: #00AA00;" class="username-coloured">Squashman</a></strong> &raquo; </span>25 Jan 2015 13:52
			</p>
			
			
			
			<div class="content">Thanks Dave,<br />I should have looked at the examples more closely.  That all makes perfect sense now.<br /><br />The stuff you do with Jscript is quite amazing.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p39647" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile39647">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf147.html?author_id=3221&amp;sr=posts">6033</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Feb 2012 02:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content39647">

						<h3 ><a href="#p39647">Re: getTimestamp.bat for time and date processing</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting1621.html?mode=quote&amp;f=3&amp;p=39647" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic363b-2.html?p=39647#p39647" onclick="prompt('Message #18',this.href); return false;">#18</a></span> 
									<a class="unread" href="viewtopic363b-2.html?p=39647#p39647" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a></strong> &raquo; </span>30 Jan 2015 05:33
			</p>
			
			
			
			<div class="content">Hi Dave, <br /><br />It turned out that mkvmerge.exe doesn't give info for filetypes other than MKV so I can't get the elapsed time as per my recent question.<br />MediaInfo from Sourceforge will return the duration of each media file - can you please offer some advice in how to add the time in this format for each call?<br /><span style="color: blue">00:25:00.009</span><br /><br />I tried to get some info from gettimestamp using this code, and the two versions of the <span style="color: blue">r</span> variable, but I'm not clear how to make gettimestamp accept the format.<br /><br />My goal is to add sets of times in the same way as the previous solution that you provided.<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />call :chapter '00:25:00.009'<br />pause<br />goto :eof<br /><br />:chapter<br />set &quot;r={hh}:{nn}:{ss}.{fff} &lt;ChapterTimeStart&gt;{hh}:{nn}:{ss}.{fff}&lt;/ChapterTimeStart&gt;&quot;<br />set &quot;r={ums} &lt;ChapterTimeStart&gt;{hh}:{nn}:{ss}.{fff}&lt;/ChapterTimeStart&gt;&quot;<br />echo &quot;%~1&quot;<br />&nbsp;for /f &quot;tokens=1,2&quot; %%x in (<br />&nbsp;'getTimestamp /d &quot;%~1&quot; /z 0 /f &quot;%r%&quot; ') do (<br />&nbsp;set &quot;chapterTime=%%x&quot;<br />&nbsp;echo %%y<br />&nbsp;)<br /></code></pre></div><br /><br /><br />FWIW this line is how I get the time from mediainfo into a routine<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>for /f &quot;delims=&quot; %%a in ('&quot; &quot;c:\Util\MediaInfo\MediaInfo.exe&quot; -f --output=General;%%Duration/String3%% &quot;%~1&quot; &quot;') do call :chapter %%~a</code></pre></div><br /><br />This was the code to add time in this format if it helps.<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />setlocal enableDelayedExpansion<br />set &quot;chapterTime=0&quot;<br />for %%T in (<br />&nbsp; 1267720000000<br />&nbsp; 1277400000000<br />&nbsp; 1292405000000<br />&nbsp; 1268108000000<br />&nbsp; 1277756000000<br />&nbsp; 2994983000000<br />&nbsp; 1024579200000<br />&nbsp; 1284500000000<br />&nbsp; 2617460000000<br />&nbsp; 1291960000000<br />) do for /f &quot;tokens=1,2&quot; %%A in (<br />&nbsp; 'getTimestamp /d &quot;!chapterTime!+%%T/1000000&quot; /z 0 /f &quot;{ums} &lt;ChapterTimeStart&gt;{hh}:{nn}:{ss}.{fff}&lt;/ChapterTimeStart&gt;&quot;'<br />) do (<br />&nbsp; set &quot;chapterTime=%%A&quot;<br />&nbsp; echo %%B<br />)<br />pause</code></pre></div></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p39677" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile39677">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf147.html?author_id=3221&amp;sr=posts">6033</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Feb 2012 02:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content39677">

						<h3 ><a href="#p39677">Re: getTimestamp.bat for time and date processing</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting9b20.html?mode=quote&amp;f=3&amp;p=39677" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopice72e.html?p=39677#p39677" onclick="prompt('Message #19',this.href); return false;">#19</a></span> 
									<a class="unread" href="viewtopice72e.html?p=39677#p39677" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a></strong> &raquo; </span>30 Jan 2015 18:46
			</p>
			
			
			
			<div class="content"><strong class="text-strong">EDIT: Gah!  Stupid me.  comma's in a call command need to be quoted.  D'uh!</strong><br /><br /><br />Well I studied the documentation further for gettimestamp.bat and I think I understand what it is saying in this regard:<br /><br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;year, month&#91;, day&#91;, hour&#91;, minute&#91;, second&#91;, millisecond&#93;&#93;&#93;&#93;&#93;&quot;<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;A comma delimited list of numeric JScript expressions representing<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;various components of date and time. Year and month are required,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the rest are optional. Missing values are treated as 0.<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Decimal values are truncated. A 0 month represents January.<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;A 1 day represents the first day of the month. A 0 day represents<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the last day of the prior month. The date/time value is always<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;in local time. There is no mechanism to specify a time zone.<br /></code></pre></div><br /><br />So I tested it with this and I get this result, which isn't what I expected.<br /><br /><span style="color: blue">&lt;ChapterTimeStart&gt;11:00:02.015&lt;/ChapterTimeStart&gt;<br />&lt;ChapterTimeStart&gt;11:00:02.015&lt;/ChapterTimeStart&gt;</span><br /><br />Shouldn't it return the exact same timestamp that is in the /D field but in this format: <span style="color: blue">00:25:00.009</span> ?<br /><br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />:: call :chapter '00:25:00.009'<br />call :chapter 2015,1,31,00,25,00,009<br />call :chapter 2015,1,31,0,25,0,9<br />pause<br />goto :eof<br /><br />:chapter<br />set &quot;r={hh}:{nn}:{ss}.{fff} &lt;ChapterTimeStart&gt;{hh}:{nn}:{ss}.{fff}&lt;/ChapterTimeStart&gt;&quot;<br />&nbsp;for /f &quot;tokens=1,2&quot; %%x in (<br />&nbsp;'getTimestamp /d &quot;%~1&quot; /f &quot;%r%&quot; ') do (<br />&nbsp;set &quot;chapterTime=%%x&quot;<br />&nbsp;echo %%y<br />&nbsp;)<br /></code></pre></div></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p39679" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile39679">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content39679">

						<h3 ><a href="#p39679">Re: getTimestamp.bat for time and date processing</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting84fe.html?mode=quote&amp;f=3&amp;p=39679" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicbc31-2.html?p=39679#p39679" onclick="prompt('Message #20',this.href); return false;">#20</a></span> 
									<a class="unread" href="viewtopicbc31-2.html?p=39679#p39679" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>30 Jan 2015 22:30
			</p>
			
			
			
			<div class="content">You need to put quotes around the comma delimited list of numbers so that they are treated as one argument.<br /><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p39682" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile39682">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf147.html?author_id=3221&amp;sr=posts">6033</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Feb 2012 02:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content39682">

						<h3 ><a href="#p39682">Re: getTimestamp.bat for time and date processing</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinga3c8.html?mode=quote&amp;f=3&amp;p=39682" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic7e23-2.html?p=39682#p39682" onclick="prompt('Message #21',this.href); return false;">#21</a></span> 
									<a class="unread" href="viewtopic7e23-2.html?p=39682#p39682" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a></strong> &raquo; </span>31 Jan 2015 01:15
			</p>
			
			
			
			<div class="content">Thanks again.  I realised soon after posting, edited my post and forgot to hit submit for several hours as someone arrived.<br /><br />Is this the kind of thing I need to do, to add the terms in hh:nn:ss.fff format, Dave?<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />set tally=0<br />call getTimestamp /d &quot;2015,1,31&quot;&nbsp; &nbsp; &nbsp;/f &quot;{ums}&quot; /r var0<br /><br />call :chapter &quot;2015,1,31,00,25,00,009&quot;<br />call :chapter &quot;2015,1,31,00,32,01,011&quot;<br />pause<br />goto :eof<br /><br />:chapter<br /><br />call getTimestamp /d &quot;%~1-%var0%&quot;&nbsp; &nbsp; /f &quot;{ums}&quot; /r var1<br />for /f &quot;tokens=1,2&quot; %%a in (<br />&nbsp; ' getTimestamp /d &quot;%var1%+%tally%&quot; /f &quot;{ums} {hh}:{nn}:{ss}.{fff}&quot; /z 0'<br />&nbsp; ) do set tally=%%a&amp;echo %%a %%b<br /><br /></code></pre></div><br /><br />It gives me this:<br /><br /><span style="color: blue">1500009 00:25:00.009<br />3421018 00:57:01.018<br />Press any key to continue . . .</span></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p39683" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile39683">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content39683">

						<h3 ><a href="#p39683">Re: getTimestamp.bat for time and date processing</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting116f.html?mode=quote&amp;f=3&amp;p=39683" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic02fa.html?p=39683#p39683" onclick="prompt('Message #22',this.href); return false;">#22</a></span> 
									<a class="unread" href="viewtopic02fa.html?p=39683#p39683" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>31 Jan 2015 09:06
			</p>
			
			
			
			<div class="content">Going back to your original input timestamps:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&nbsp; 1267720000000<br />&nbsp; 1277400000000<br />&nbsp; 1292405000000<br />&nbsp; 1268108000000<br />&nbsp; 1277756000000<br />&nbsp; 2994983000000<br />&nbsp; 1024579200000<br />&nbsp; 1284500000000<br />&nbsp; 2617460000000<br />&nbsp; 1291960000000<br /></code></pre></div><br />In the new format, they would look like<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&nbsp; 00:21:07.720<br />&nbsp; 00:21:17.400<br />&nbsp; 00:21:32.405<br />&nbsp; 00:21:08.108<br />&nbsp; 00:21:17.756<br />&nbsp; 00:49:54.983<br />&nbsp; 00:17:04.579<br />&nbsp; 00:21:24.500<br />&nbsp; 00:43:37.460<br />&nbsp; 00:21:31.960<br /></code></pre></div><br /><br />We want the times to be computed from the 0 unix time (1/1/1970 00:00:00 UTC). So we initialize the {UMS} value to 0.<br /><br />The /D option can parse a time stamp in string form to seconds only: '1/1/1970 00:21:07 UTC'. The milliseconds would need to be added using the /OF option, along with the prior {UMS} value.<br /><br />So here is how I would adapt the prior solution to the new input format:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />setlocal<br />set &quot;chapterTime=0&quot;<br />for %%A in (<br />&nbsp; 00:21:07.720<br />&nbsp; 00:21:17.400<br />&nbsp; 00:21:32.405<br />&nbsp; 00:21:08.108<br />&nbsp; 00:21:17.756<br />&nbsp; 00:49:54.983<br />&nbsp; 00:17:04.579<br />&nbsp; 00:21:24.500<br />&nbsp; 00:43:37.460<br />&nbsp; 00:21:31.960<br />) do for /f &quot;tokens=1,2 delims=.&quot; %%B in (&quot;%%A&quot;) do for /f &quot;tokens=1,2&quot; %%D in (<br />&nbsp; 'getTimestamp /d &quot;'1/1/1970 %%B UTC'&quot; /of !chapterTime!+%%C /z 0 /f &quot;{ums} &lt;ChapterTimeStart&gt;{hh}:{nn}:{ss}.{fff}&lt;/ChapterTimeStart&gt;&quot;'<br />) do (<br />&nbsp; set &quot;chapterTime=%%D&quot;<br />&nbsp; echo %%E<br />)<br />pause<br /></code></pre></div><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p39684" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile39684">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf147.html?author_id=3221&amp;sr=posts">6033</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Feb 2012 02:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content39684">

						<h3 ><a href="#p39684">Re: getTimestamp.bat for time and date processing</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting2f25-3.html?mode=quote&amp;f=3&amp;p=39684" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopice35c.html?p=39684#p39684" onclick="prompt('Message #23',this.href); return false;">#23</a></span> 
									<a class="unread" href="viewtopice35c.html?p=39684#p39684" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a></strong> &raquo; </span>31 Jan 2015 23:45
			</p>
			
			
			
			<div class="content">Once again, thank you for your gracious help Dave, it works well.<br /><br /><br /><br />Not meaning to look a gift horse in the mouse - I would like to comment that your documentation in GetTimeStamp.bat is very expansive, <br />but it could use some extra examples in the help - because it is very unclear how to manipulate all the terms, even though they are all listed.<br /><br />A simple example is that you use the term <span style="color: blue">milliseconds</span> in the <span style="color: blue">/D</span> help but it is not immediately obvious<br />if the term has to be typed as &quot;milliseconds&quot; or if it is an integer, and where it is to be used.<br /><br />If there were more simple examples interspersed in the help then it would help your users to begin experimenting and perhaps sort some things<br />out in an intuitive way on their own.<br /><br /><br />I am intending to be constructive in my criticism, as I use jrepl and repl often and now gettimestamp and jeval/jren are there too, along with Antonio's findrepl.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p39685" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile39685">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf147.html?author_id=3221&amp;sr=posts">6033</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Feb 2012 02:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content39685">

						<h3 ><a href="#p39685">Re: getTimestamp.bat for time and date processing</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinge196.html?mode=quote&amp;f=3&amp;p=39685" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicd2c7.html?p=39685#p39685" onclick="prompt('Message #24',this.href); return false;">#24</a></span> 
									<a class="unread" href="viewtopicd2c7.html?p=39685#p39685" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a></strong> &raquo; </span>31 Jan 2015 23:51
			</p>
			
			
			
			<div class="content">New post, different theme:<br /><br />I have one more suggestion - which I have solved here with an extra batch file:<br /><br />When using the command line and needing to read the help for these tools, I need to type <span style="color: blue">name /?|more</span> and that is a chore because I type it so very often.<br /><br />It would be very useful to get paged output by simply typing the command name - instead of these:<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>c:\&gt;jrepl<br />ERROR: Insufficient arguments.<br />(Use JREPL /? to get help.)<br /><br />c:\&gt;repl<br />ERROR: Insufficient arguments. Use REPL /? to get help.<br /><br />c:\&gt;gettimestamp<br />2015-02-01T16:36:50.320+11:00<br /><br />c:\&gt;jeval<br />ERROR: Insufficient arguments. Use jeval /? to get help.<br /><br />c:\&gt;findrepl<br />c:\Files\bat\findrepl.bat(318, 1) Microsoft JScript runtime error: Permission denied<br /></code></pre></div><br /><br />I have many ways to solve this - but there are probably many people needing to refer to help often, and having to retype the commands.<br /><br />Perhaps a <span style="color: blue">/p</span> switch to page the help would be an option - though doing it by default could be very useful.<br />OR maybe piping it to a file and opening it in notepad so the user can navigate back and forward through the help?<br /><br />Thanks for all your help - and for the utilities.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p39686" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile39686">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content39686">

						<h3 ><a href="#p39686">Re: getTimestamp.bat for time and date processing</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting68b5.html?mode=quote&amp;f=3&amp;p=39686" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic2dbe.html?p=39686#p39686" onclick="prompt('Message #25',this.href); return false;">#25</a></span> 
									<a class="unread" href="viewtopic2dbe.html?p=39686#p39686" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>01 Feb 2015 10:25
			</p>
			
			
			
			<div class="content">Yes, I've thought about putting a few more examples in the documentation, especially for the /D option. I may get around to that some day.<br /><br />I also thought about automatically piping the help through MORE, but opted against it because I frequently use the help, and I find that MORE gets in my way.<br /><br />I set up my console window to have a large buffer that allows me to scroll up and see previous output. It is a one time setup.<br /><br /> - launch the console via your favorite shortcut, and right click on the title bar at the top.<br /> - select &quot;properties&quot;<br /> - select the&quot;layout&quot; tab<br /> - my &quot;Screen Buffer Size&quot; is Width=3000, Height=1000<br /> - my &quot;Window Size&quot; is Width=150, Height=45<br /> - Press &quot;OK&quot; to accept the changes. I get those settings every time I use the shortcut.<br /><br />I haven't played with the &quot;Defaults&quot; option (as opposed to &quot;Properties&quot;). I don't know what &quot;Defaults&quot; does.<br /><br />You say you use an auxiliary batch script to pipe the help through more. Another option is to define a DOSKEY macro that can be used on the command line to page the output of any command.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>C:\test&gt;doskey m=$*^|more<br /><br />C:\test&gt;m gettimestamp /?<br /></code></pre></div><br /><br />Perhaps someday I will add an option to the help to utilize MORE, but until then, the above strategies can help.<br /><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p39687" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile39687">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistba6b.html?mode=viewprofile&amp;u=4238" class="username">Sponge Belly</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchc7ad.html?author_id=4238&amp;sr=posts">192</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 01 Oct 2012 13:32</dd>		
		
																<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Ireland</dd>
							
							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact Sponge Belly">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact Sponge Belly</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="http://sbjh.wordpress.com/" title="Website" class="last-cell">
										<span class="contact-icon phpbb_website-icon">Website</span>
									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content39687">

						<h3 ><a href="#p39687">Re: getTimestamp.bat for time and date processing</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting3404.html?mode=quote&amp;f=3&amp;p=39687" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicd2c8.html?p=39687#p39687" onclick="prompt('Message #26',this.href); return false;">#26</a></span> 
									<a class="unread" href="viewtopicd2c8.html?p=39687#p39687" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistba6b.html?mode=viewprofile&amp;u=4238" class="username">Sponge Belly</a></strong> &raquo; </span>01 Feb 2015 11:46
			</p>
			
			
			
			<div class="content">@Foxi<br /><br />Did you really say “look a gift horse in the mouse”? <img class="smilies" src="images/smilies/icon_lol.gif" alt=":lol:" title="Laughing" /><br /><br />Turn off the computer and go out into the fresh air for a walk! <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /><br /><br /><em class="text-italics">- SB</em></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p39702" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile39702">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf147.html?author_id=3221&amp;sr=posts">6033</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Feb 2012 02:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content39702">

						<h3 ><a href="#p39702">Re: getTimestamp.bat for time and date processing</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinge162.html?mode=quote&amp;f=3&amp;p=39702" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicc1b6-2.html?p=39702#p39702" onclick="prompt('Message #27',this.href); return false;">#27</a></span> 
									<a class="unread" href="viewtopicc1b6-2.html?p=39702#p39702" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a></strong> &raquo; </span>02 Feb 2015 05:55
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>Sponge Belly wrote:</cite>@Foxi<br /><br />Did you really say “look a gift horse in the mouse”? <img class="smilies" src="images/smilies/icon_lol.gif" alt=":lol:" title="Laughing" /><br /><br />Turn off the computer and go out into the fresh air for a walk! <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /><br /><br /><em class="text-italics">- SB</em></div></blockquote><br /><br />Yes, it looks like I did! <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /><br /><br />I used to love bushwalking - but I'd have to go by wheelchair these days.<br />I'm not in a wheelchair, but I can't walk far without feeling like crap.<br /><br /><br />Dave, just an idle comment here but my cmd history buffer is large also but microsoft has a bug with my microsoft trackball - and my scrollwheel doesn't move page-by-page but instead jumps by several pages - so looking back in the cmd history is painful.<br /><br />This is my batch file to show me the help.<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />if &quot;%~1&quot;==&quot;&quot; echo f = findrepl r = repl, j = jrepl, e = eval, g = gettimestamp &amp; pause &amp; goto :EOF<br /><br />set &quot;file=%temp%\readdoc.tmp.txt&quot;<br />if /i &quot;%~1&quot;==&quot;r&quot;&nbsp; repl /?&gt;&quot;%file%&quot;&amp;call m1 &quot;%file%&quot;<br />if /i &quot;%~1&quot;==&quot;j&quot; jrepl /?&gt;&quot;%file%&quot;&amp;call m1 &quot;%file%&quot;<br />if /i &quot;%~1&quot;==&quot;g&quot; GetTimeStamp /?&gt;&quot;%file%&quot;&amp;call m1 &quot;%file%&quot;<br />if /i &quot;%~1&quot;==&quot;e&quot; eval /?&gt;&quot;%file%&quot;&amp;call m1 &quot;%file%&quot;<br />if /i &quot;%~1&quot;==&quot;f&quot; findrepl /?&gt;&quot;%file%&quot;&amp;call m1 &quot;%file%&quot;<br /></code></pre></div></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p42034" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile42034">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content42034">

						<h3 ><a href="#p42034">Re: getTimestamp.bat for time and date processing</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting399e.html?mode=quote&amp;f=3&amp;p=42034" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic96a3-2.html?p=42034#p42034" onclick="prompt('Message #28',this.href); return false;">#28</a></span> 
									<a class="unread" href="viewtopic96a3-2.html?p=42034#p42034" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>12 Jul 2015 15:30
			</p>
			
			
			
			<div class="content">I've released version 2.3<br /><br /><strong class="text-strong">New Formats</strong><br /><br />I've added new formats for Day of Year:<br /><br />{DDY} - Day of year number, zero padded to 3 digits<br />{DY} - Day of year number without padding<br /><br />I've also added formats for convenient ISO 8601 date and time strings. The form with a dash provides a string with punctuation, and the form without a dash provides a compressed string without punctuation.<br /><br />{ISO-TS} - date and time as YYYY-MM-DDThh:mm:ss.fff+hh:mm<br />{ISOTS} - date and time as YYYYMMDDThhmmss.fff+hhmm<br />{ISO-DT} - date as YYYY-MM-DD<br />{ISODT} - date as YYYYMMDD<br />{ISO-TM} - time as hh:mm:ss.fff<br />{ISOTM} - time as hhmmss.fff<br />{ISO-TZ} - time zone as +hh:ss (or -hh:ss)<br />{ISOTZ} - time zone as +hhss (or -hhss)<br /><br /><strong class="text-strong">New paged help option</strong><br /><br />I've added the -?? option for paged help via MORE. GetTimestamp -?? is the same as (GetTimestamp -? | more) 2&gt;nul. I redirect stderr to nul to avoid <em class="text-italics">&quot;The process tried to write to a nonexistent pipe.&quot;</em> error when Q is pressed to abort the help.<br /><br /><strong class="text-strong"> User defined option defaults</strong><br /><br />I now allow user defined option defaults via environment variables of the form &quot;GetTimestamp-Option=Value&quot;. For example, the default day of week abbreviations for {WKD} are normally mixed case. You could change the default to upper case abbreviations by defining &quot;GetTimestamp-wkd=SUN MON TUE WED THU FRI&quot;. This feature makes it easy to adapt GetTimestamp for any language, without resorting to code modification. The default option variables can be defined within your script, within AutoRun commands defined within the registry, or as User or System variables defined in the registry.<br /><br /><strong class="text-strong">GetTimestamp.bat version 2.3</strong><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@if (@X)==(@Y) @end&nbsp; /* harmless hybrid line that begins a JScript comment<br />@goto :batch<br />::<br />::getTimestamp.bat version 2.3 by Dave Benham<br />::<br />::&nbsp; Release History:<br />::&nbsp; &nbsp; 2.3 2015-07-12 - Added {ISO-xx}, {ISOxx}, {DY} and {DDY} formats<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Added -?? (paged help) option<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Allow user defined default option values by defining<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;variables of the form &quot;GetTimestamp-Option=Value&quot;<br />::&nbsp; &nbsp; 2.2 2014-12-03 - Doc fix: -R ReturnVariable is unchanged if err occurs<br />::&nbsp; &nbsp; 2.1 2014-12-03 - Added GOTO at top to increase performance (32% faster)<br />::&nbsp; &nbsp; 2.0 2014-12-02 - Major rewrite: most code now in JScript (25% faster)<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Better error handling<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;May now use /Option or -Option<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Added -V option<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Added {{} format value to enable unambiguous { literal<br />::&nbsp; &nbsp; 1.1 ????-??-?? - Added -Z option and obscure bug fixes<br />::&nbsp; &nbsp; 1.0 2013-07-17 - Initial release<br />::<br />::============ Documentation ===========<br />:::<br />:::getTimestamp&nbsp; &#91;-option &#91;value&#93;&#93;...<br />:::<br />:::&nbsp; Displays a formatted timestamp. Defaults to the current local date<br />:::&nbsp; and time using an ISO 8601 format with milliseconds, time zone<br />:::&nbsp; and punctuation.<br />:::<br />:::&nbsp; Returned ERRORLEVEL is 0 upon success, 1 if failure.<br />:::<br />:::&nbsp; Options may be prefaced with - or /<br />:::<br />:::&nbsp; All options have default values. The default value can be overridden by<br />:::&nbsp; defining a variable of the form &quot;GetTimestamp-OPTION=VALUE&quot;. For example,<br />:::&nbsp; upper case English weekday abbreviations can be specified as the default<br />:::&nbsp; by defining &quot;GetTimestamp-WKD=SUN MON TUE WED THU FRI SAT&quot;.<br />:::<br />:::&nbsp; Command line option values take precedence, followed by environment variable<br />:::&nbsp; defaults, followed by built in defaults.<br />:::<br />:::&nbsp; The following options are all case insensitive:<br />:::<br />:::&nbsp; &nbsp; -?&nbsp; : Prints this documentation for getTimestamp<br />:::<br />:::&nbsp; &nbsp; -?? : Prints this documentation with pagination via MORE<br />:::<br />:::&nbsp; &nbsp; -V&nbsp; : Prints the version of getTimeStamp<br />:::<br />:::&nbsp; &nbsp; -U&nbsp; : Returns a UTC timestamp instead of local timestamp.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Default is a local timestamp.<br />:::<br />:::&nbsp; &nbsp; -Z TimeZoneMinuteOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Returns the timestamp using the specified time zone offset.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;TimeZoneMinuteOffset is a JScript numeric expression that<br />:::&nbsp; &nbsp; &nbsp; &nbsp;represents the number of minutes offset from UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Decimal values are truncated.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is empty, meaning local timezone.<br />:::<br />:::&nbsp; &nbsp; -D DateSpec<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the base date and time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default value is current local date and time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;The DateSpec supports many formats:<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;&quot;&nbsp; &nbsp; (no value)<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Current date and time - the default<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;milliseconds<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;A JScript numeric expression that represents the number of<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;milliseconds since 1970-01-01 00:00:00 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Decimal values are truncated.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative values represent dates prior to 1970-01-01.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'Date &#91;Time&#93; &#91;TimeZone&#93;'&quot;<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;A string representation of the date and time. The date information<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;is required, the time and time zone are optional. Missing time info<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;is assumed to be 0 (midnight). Missing time zone info is assumed to<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;be local time zone.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;The Date, Time, and TimeZone information can be represented as any<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;string that is accepted by the JScript Date.Parse() method.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;There are many formatting options. Documentation is available at:<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;http://msdn.microsoft.com/en-us/library/k4w173wk(v=vs.84).aspx<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Examples of equivalent representations of Midnight on January 4,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2013 assuming local time zone is U.S Eastern Standard Time (EST):<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'1-4-2013'&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Defaults to local time zone<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'January 4, 2013 EST'&quot;&nbsp; &nbsp; &nbsp; &nbsp;Explicit Eastern Std Time (US)<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'2013/1/4 -05'&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Explicit Eastern Std Time (US)<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'Jan 3 2013 23: CST'&quot;&nbsp; &nbsp; &nbsp; &nbsp; Central Standard Time (US)<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'2013 3 Jan 9:00 pm -0800'&quot;&nbsp; Pacific Standard Time (US)<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'01/04/2013 05:00:00 UTC'&quot;&nbsp; &nbsp;Universal Coordinated Time<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'1/4/2013 05:30 +0530'&quot;&nbsp; &nbsp; &nbsp; India Standard Time<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;year, month&#91;, day&#91;, hour&#91;, minute&#91;, second&#91;, millisecond&#93;&#93;&#93;&#93;&#93;&quot;<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;A comma delimited list of numeric JScript expressions representing<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;various components of date and time. Year and month are required,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the rest are optional. Missing values are treated as 0.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Decimal values are truncated. A 0 month represents January.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;A 1 day represents the first day of the month. A 0 day represents<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the last day of the prior month. The date/time value is always<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;in local time. There is no mechanism to specify a time zone.<br />:::<br />:::&nbsp; &nbsp; -OY YearOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the number of years to offset the base date/time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;The JScript numeric expression is truncated to an integral number.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is 0<br />:::<br />:::&nbsp; &nbsp; -OM MonthOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the number of months to offset the base date/time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;The JScript numeric expression is truncated to an integral number.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is 0<br />:::<br />:::&nbsp; &nbsp; -OD DayOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the number of days to offset the base date/time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;The JScript numeric expression is truncated to an integral number.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is 0<br />:::<br />:::&nbsp; &nbsp; -OH HourOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the number of hours to offset the base date/time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;The JScript numeric expression is truncated to an integral number.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is 0<br />:::<br />:::&nbsp; &nbsp; -ON MinuteOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the number of minutes to offset the base date/time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;The JScript numeric expression is truncated to an integral number.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is 0<br />:::<br />:::&nbsp; &nbsp; -OS SecondOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the number of seconds to offset the base date/time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;The JScript numeric expression is truncated to an integral number.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is 0<br />:::<br />:::&nbsp; &nbsp; -OF MillisecondOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the number of milliseconds to offset the base date/time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;The JScript numeric expression is truncated to an integral number.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is 0<br />:::<br />:::&nbsp; &nbsp; -F FormatString<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the timestamp format.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is &quot;{ISO-TS}&quot;<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Strings within braces are dynamic components.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;All other strings are literals.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Available components (case insensitive) are:<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{YYYY}&nbsp; 4 digit year, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{YY}&nbsp; &nbsp; 2 digit year, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{Y}&nbsp; &nbsp; &nbsp;year without zero padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{MONTH} month name, as preferentially specified by:<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1) -MONTH option<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2) GetTimestamp-MONTH environment variable<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3) Mixed case, English month names<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{MTH}&nbsp; &nbsp;month abbreviation, as preferentially specified by:<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1) -MTH option<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2) GetTimestamp-MTH environment variable<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3) Mixed case, English month abbreviations<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{MM}&nbsp; &nbsp; 2 digit month number, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{M}&nbsp; &nbsp; &nbsp;month number without zero padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{WEEKDAY} day of week name, as preferentially specified by:<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1) -WEEKDAY option<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2) GetTimestamp-WEEKDAY environment variable<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3) Mixed case, English day names<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{WKD}&nbsp; &nbsp;day of week abbreviation, as preferentially specified by:<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1) -WKD option<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2) GetTimestamp-WKD environment variable<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3) Mixed case, English day abbreviations<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{W}&nbsp; &nbsp; &nbsp;day of week number, 0=Sunday<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{DD}&nbsp; &nbsp; 2 digit day of month number, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{D}&nbsp; &nbsp; &nbsp;day of month number, without zero padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{DDY}&nbsp; &nbsp;3 digit day of year number, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{DY}&nbsp; &nbsp; day of year number, without zero padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{HH}&nbsp; &nbsp; 2 digit hours, 24 hour format, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{H}&nbsp; &nbsp; &nbsp;hours, 24 hour format without zero padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{HH12}&nbsp; 2 digit hours, 12 hour format, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{H12}&nbsp; &nbsp;hours, 12 hour format without zero padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{NN}&nbsp; &nbsp; 2 digit minutes, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{N}&nbsp; &nbsp; &nbsp;minutes without padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{SS}&nbsp; &nbsp; 2 digit seconds, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{S}&nbsp; &nbsp; &nbsp;seconds without padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{FFF}&nbsp; &nbsp;3 digit milliseconds, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{F}&nbsp; &nbsp; &nbsp;milliseconds without padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{AM}&nbsp; &nbsp; AM or PM in upper case<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{PM}&nbsp; &nbsp; am or pm in lower case<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ZZZZ}&nbsp; timezone expressed as minutes offset from UTC,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;zero padded to 3 digits with sign<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{Z}&nbsp; &nbsp; &nbsp;timzone expressed as minutes offset from UTC without padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ZS}&nbsp; &nbsp; ISO 8601 timezone sign<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ZH}&nbsp; &nbsp; ISO 8601 timezone hours (no sign)<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ZM}&nbsp; &nbsp; ISO 8601 timezone minutes (no sign)<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{TZ}&nbsp; &nbsp; ISO 8601 timezone in +/-hh:mm format<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISOTS} YYYYMMDDThhmmss.fff+hhss<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Compressed ISO 8601 date/time (timestamp) with milliseconds<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;and time zone<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISODT} YYYYMMDD<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Compressed ISO 8601 date format<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISOTM} hhmmss.fff<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Compressed ISO 8601 time format with milliseconds<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISOTZ} +hhmm<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Compressed ISO 8601 timezone format<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISO-TS} YYYY-MM-DDThh:mm:ss.fff+hh:ss<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ISO 8601 date/time (timestamp) with milliseconds and time zone<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISO-DT} YYYY-MM-DD<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ISO 8601 date format<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISO-TM} hh:mm:ss.fff<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ISO 8601 time format with milliseconds<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISO-TZ} +hh:mm<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ISO 8601 timezone&nbsp; (same as {TZ})<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{U}&nbsp; &nbsp; &nbsp;Unix Epoch time: same as {US}<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Seconds since 1970-01-01 00:00:00 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent dates prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{UMS}&nbsp; &nbsp;Milliseconds since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{US}&nbsp; &nbsp; Seconds since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{UM}&nbsp; &nbsp; Minutes since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{UH}&nbsp; &nbsp; Hours since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{UD}&nbsp; &nbsp; Days since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{USD}&nbsp; &nbsp;Decimal seconds since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{UMD}&nbsp; &nbsp;Decimal minutes since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{UHD}&nbsp; &nbsp;Decimal hours since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{UDD}&nbsp; &nbsp;Decimal days since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{{}&nbsp; &nbsp; &nbsp;A { character<br />:::<br />:::&nbsp; &nbsp; -R ReturnVariable<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Save the timestamp in ReturnVariable instead of displaying it.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;ReturnVariable is unchanged if an error occurs.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is empty, meaning print to screen.<br />:::<br />:::&nbsp; &nbsp; -WKD &quot;Abbreviated day of week list&quot;<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Override the default day abbreviations with a space delimited,<br />:::&nbsp; &nbsp; &nbsp; &nbsp;quoted list, starting with Sun.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is mixed case, 3 character English day abbreviations.<br />:::<br />:::&nbsp; &nbsp; -WEEKDAY &quot;Day of week list&quot;<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Override the default day names with a space delimited, quoted list,<br />:::&nbsp; &nbsp; &nbsp; &nbsp;starting with Sunday.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is mixed case English day names.<br />:::<br />:::&nbsp; &nbsp; -MTH &quot;Abbreviated month list&quot;<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Override the default month abbreviations with a space delimited,<br />:::&nbsp; &nbsp; &nbsp; &nbsp;quoted list, starting with Jan.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is mixed case, 3 character English month abbreviations.<br />:::<br />:::&nbsp; &nbsp; -MONTH &quot;Month list&quot;<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Override the default month names with a space delimited, quoted list,<br />:::&nbsp; &nbsp; &nbsp; &nbsp;starting with January.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is mixed case English month names.<br />:::<br />:::<br />:::&nbsp; GetTimestamp.bat was written by Dave Benham and originally posted at<br />:::&nbsp; http://www.dostips.com/forum/viewtopic.php?f=3&amp;t=4847<br />:::<br /><br />============= :Batch portion ===========<br />@echo off<br />setlocal enableDelayedExpansion<br /><br />:: Define options<br />set ^&quot;options=^<br />&nbsp;-?:^<br />&nbsp;-??:^<br />&nbsp;-v:^<br />&nbsp;-u:^<br />&nbsp;-z:&quot;&quot;^<br />&nbsp;-f:&quot;{ISO-TS}&quot;^<br />&nbsp;-d:&quot;&quot;^<br />&nbsp;-oy:&quot;&quot;^<br />&nbsp;-om:&quot;&quot;^<br />&nbsp;-od:&quot;&quot;^<br />&nbsp;-oh:&quot;&quot;^<br />&nbsp;-on:&quot;&quot;^<br />&nbsp;-os:&quot;&quot;^<br />&nbsp;-of:&quot;&quot;^<br />&nbsp;-r:&quot;&quot;^<br />&nbsp;-wkd:&quot;Sun Mon Tue Wed Thu Fri Sat&quot;^<br />&nbsp;-weekday:&quot;Sunday Monday Tuesday Wednesday Thursday Friday Saturday&quot;^<br />&nbsp;-mth:&quot;Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec&quot;^<br />&nbsp;-month:&quot;January February March April May June July August September October November December&quot;^&quot;<br /><br />:: Set default option values<br />for %%O in (%options%) do for /f &quot;tokens=1,* delims=:&quot; %%A in (&quot;%%O&quot;) do (<br />&nbsp; if defined GetTimestamp%%A (set &quot;%%A=!GetTimestamp%%A!&quot;) else set &quot;%%A=%%~B&quot;<br />)<br />set &quot;-?=&quot;<br />set &quot;-??=&quot;<br /><br />:: Get options<br />:loop<br />if not &quot;%~1&quot;==&quot;&quot; (<br />&nbsp; set &quot;arg=%~1&quot;<br />&nbsp; if &quot;!arg:~0,1!&quot; equ &quot;/&quot; set &quot;arg=-!arg:~1!&quot;<br />&nbsp; for /f delims^=^ eol^= %%A in (&quot;!arg!&quot;) do set &quot;test=!options:*%%A:=! &quot;<br />&nbsp; if &quot;!test!&quot;==&quot;!options! &quot; (<br />&nbsp; &nbsp; &nbsp; &gt;&amp;2 echo Error: Invalid option %~1. Use %~nx0 -? to get help.<br />&nbsp; &nbsp; &nbsp; exit /b 1<br />&nbsp; ) else if &quot;!test:~0,1!&quot;==&quot; &quot; (<br />&nbsp; &nbsp; &nbsp; set &quot;!arg!=1&quot;<br />&nbsp; &nbsp; &nbsp; if /i &quot;!arg!&quot; equ &quot;-U&quot; set &quot;-z=&quot;<br />&nbsp; ) else (<br />&nbsp; &nbsp; &nbsp; set &quot;!arg!=%~2&quot;<br />&nbsp; &nbsp; &nbsp; shift /1<br />&nbsp; )<br />&nbsp; shift /1<br />&nbsp; goto :loop<br />)<br />if defined -z set &quot;-u=1&quot;<br />if defined -r set &quot;%-r%=&quot;<br /><br />:: Display paged help<br />if defined -?? (<br />&nbsp; (for /f &quot;delims=: tokens=*&quot; %%A in ('findstr &quot;^:::&quot; &quot;%~f0&quot;') do @echo(%%A)|more /e<br />&nbsp; exit /b 0<br />) 2&gt;nul<br /><br />:: Display help<br />if defined -? (<br />&nbsp; for /f &quot;delims=: tokens=*&quot; %%A in ('findstr &quot;^:::&quot; &quot;%~f0&quot;') do echo(%%A<br />&nbsp; exit /b 0<br />)<br /><br />:: Display version<br />if defined -v (<br />&nbsp; for /f &quot;tokens=* delims=:&quot; %%A in ('findstr &quot;^::getTimestamp\.bat&quot; &quot;%~f0&quot;') do @echo(%%A<br />&nbsp; exit /b 0<br />)<br /><br />:: Execute the JScript script and return the result<br />for /f &quot;delims=&quot; %%A in ('cscript //E:JScript //nologo &quot;%~f0&quot;') do (<br />&nbsp; endlocal<br />&nbsp; if &quot;%-R%&quot; neq &quot;&quot; (set &quot;%-R%=%%A&quot;) else (echo(%%A)<br />&nbsp; exit /b 0<br />)<br />exit /b 1;<br /><br /><br />************ JScript portion ***********/<br />var env&nbsp; = WScript.CreateObject(&quot;WScript.Shell&quot;).Environment(&quot;Process&quot;),<br />&nbsp; &nbsp; utc&nbsp; = env('-U'),<br />&nbsp; &nbsp; wkd&nbsp; &nbsp; &nbsp;= env('-WKD').split(' '),<br />&nbsp; &nbsp; weekday = env('-WEEKDAY').split(' '),<br />&nbsp; &nbsp; mth&nbsp; &nbsp; &nbsp;= env('-MTH').split(' '),<br />&nbsp; &nbsp; month&nbsp; &nbsp;= env('-MONTH').split(' '),<br />&nbsp; &nbsp; stderr&nbsp; = WScript.StdErr,<br />&nbsp; &nbsp; y,m,d,w,h,h12,n,s,f,u,z,zs,za,<br />&nbsp; &nbsp; pc=':', pd='-', pp='.', p2='00', p3='000', p4='0000';<br /><br />if (wkd.length!=7)&nbsp; &nbsp; &nbsp;badOp('-WKD');<br />if (weekday.length!=7) badOp('-WEEKDAY');<br />if (mth.length!=12)&nbsp; &nbsp; badOp('-MTH');<br />if (month.length!=12)&nbsp; badOp('-MONTH');<br /><br />try {<br />&nbsp; var dt = eval('new Date('+env('-D')+')');<br />} catch(e) {<br />} finally {<br />&nbsp; if (isNaN(dt)) badOp('-D');<br />}<br /><br />if (env('-OY')) dt.setFullYear(&nbsp; &nbsp; &nbsp;dt.getFullYear()&nbsp; &nbsp; +getNum('-OY') );<br />if (env('-OM')) dt.setMonth(&nbsp; &nbsp; &nbsp; &nbsp; dt.getMonth()&nbsp; &nbsp; &nbsp; &nbsp;+getNum('-OM') );<br />if (env('-OD')) dt.setDate(&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dt.getDate()&nbsp; &nbsp; &nbsp; &nbsp; +getNum('-OD') );<br />if (env('-OH')) dt.setHours(&nbsp; &nbsp; &nbsp; &nbsp; dt.getHours()&nbsp; &nbsp; &nbsp; &nbsp;+getNum('-OH') );<br />if (env('-ON')) dt.setMinutes(&nbsp; &nbsp; &nbsp; dt.getMinutes()&nbsp; &nbsp; &nbsp;+getNum('-ON') );<br />if (env('-OS')) dt.setSeconds(&nbsp; &nbsp; &nbsp; dt.getSeconds()&nbsp; &nbsp; &nbsp;+getNum('-OS') );<br />if (env('-OF')) dt.setMilliseconds( dt.getMilliseconds()+getNum('-OF') );<br />if (env('-Z'))&nbsp; dt.setMinutes(&nbsp; &nbsp; &nbsp; dt.getMinutes()&nbsp; +(z=getNum('-Z')) );<br /><br />y = utc ? dt.getUTCFullYear(): dt.getFullYear();<br />m = utc ? dt.getUTCMonth()&nbsp; &nbsp;: dt.getMonth();<br />d = utc ? dt.getUTCDate()&nbsp; &nbsp; : dt.getDate();<br />w = utc ? dt.getUTCDay()&nbsp; &nbsp; &nbsp;: dt.getDay();<br />h = utc ? dt.getUTCHours()&nbsp; &nbsp;: dt.getHours();<br />n = utc ? dt.getUTCMinutes() : dt.getMinutes();<br />s = utc ? dt.getUTCSeconds() : dt.getSeconds();<br />f = utc ? dt.getUTCMilliseconds() : dt.getMilliseconds();<br />u = dt.getTime();<br /><br />h12 = h%12;<br />if (!h12) h12=12;<br /><br />if (z==undefined) if (utc) z=0; else z=-dt.getTimezoneOffset();<br />zs = z&lt;0 ? '-' : '+';<br />za = Math.abs(z);<br /><br />WScript.echo( env('-F').replace( /\{(.*?)\}/gi, repl ) );<br />WScript.Quit(0);<br /><br />function lpad( val, pad ) {<br />&nbsp; var rtn=val.toString();<br />&nbsp; return (rtn.length&lt;pad.length) ? (pad+rtn).slice(-pad.length) : val;<br />}<br /><br />function getNum( v ) {<br />&nbsp; var rtn;<br />&nbsp; try {<br />&nbsp; &nbsp; rtn = Number(eval(env(v)));<br />&nbsp; } catch(e) {<br />&nbsp; } finally {<br />&nbsp; &nbsp; if (isNaN(rtn-rtn)) badOp(v);<br />&nbsp; &nbsp; return rtn;<br />&nbsp; }<br />}<br /><br />function badOp(option) {<br />&nbsp; stderr.WriteLine('Error: Invalid '+option+' value');<br />&nbsp; WScript.Quit(1);<br />}<br /><br />function trunc( n ) { return Math&#91;n&gt;0?&quot;floor&quot;:&quot;ceil&quot;&#93;(n); }<br /><br />function repl($0,$1) {<br />&nbsp; switch ($1.toUpperCase()) {<br />&nbsp; &nbsp; case 'YYYY' : return lpad(y,p4);<br />&nbsp; &nbsp; case 'YY'&nbsp; &nbsp;: return (p2+y.toString()).slice(-2);<br />&nbsp; &nbsp; case 'Y'&nbsp; &nbsp; : return y.toString();<br />&nbsp; &nbsp; case 'MM'&nbsp; &nbsp;: return lpad(m+1,p2);<br />&nbsp; &nbsp; case 'M'&nbsp; &nbsp; : return (m+1).toString();<br />&nbsp; &nbsp; case 'DD'&nbsp; &nbsp;: return lpad(d,p2);<br />&nbsp; &nbsp; case 'D'&nbsp; &nbsp; : return d.toString();<br />&nbsp; &nbsp; case 'W'&nbsp; &nbsp; : return w.toString();<br />&nbsp; &nbsp; case 'DY'&nbsp; &nbsp;: return trunc(((new Date(y,m,d)).getTime()-(new Date(y,0,0)).getTime())/86400000).toString();<br />&nbsp; &nbsp; case 'DDY'&nbsp; : return lpad( trunc(((new Date(y,m,d)).getTime()-(new Date(y,0,0)).getTime())/86400000), p3);<br />&nbsp; &nbsp; case 'HH'&nbsp; &nbsp;: return lpad(h,p2);<br />&nbsp; &nbsp; case 'H'&nbsp; &nbsp; : return h.toString();<br />&nbsp; &nbsp; case 'HH12' : return lpad(h12,p2);<br />&nbsp; &nbsp; case 'H12'&nbsp; : return h12.toString();<br />&nbsp; &nbsp; case 'NN'&nbsp; &nbsp;: return lpad(n,p2);<br />&nbsp; &nbsp; case 'N'&nbsp; &nbsp; : return n.toString();<br />&nbsp; &nbsp; case 'SS'&nbsp; &nbsp;: return lpad(s,p2);<br />&nbsp; &nbsp; case 'S'&nbsp; &nbsp; : return s.toString();<br />&nbsp; &nbsp; case 'FFF'&nbsp; : return lpad(f,p3);<br />&nbsp; &nbsp; case 'F'&nbsp; &nbsp; : return f.toString();<br />&nbsp; &nbsp; case 'AM'&nbsp; &nbsp;: return h&gt;=12 ? 'PM' : 'AM';<br />&nbsp; &nbsp; case 'PM'&nbsp; &nbsp;: return h&gt;=12 ? 'pm' : 'am';<br />&nbsp; &nbsp; case 'UMS'&nbsp; : return u.toString();<br />&nbsp; &nbsp; case 'USD'&nbsp; : return (u/1000).toString();<br />&nbsp; &nbsp; case 'UMD'&nbsp; : return (u/1000/60).toString();<br />&nbsp; &nbsp; case 'UHD'&nbsp; : return (u/1000/60/60).toString();<br />&nbsp; &nbsp; case 'UDD'&nbsp; : return (u/1000/60/60/24).toString();<br />&nbsp; &nbsp; case 'U'&nbsp; &nbsp; : return trunc(u/1000).toString();<br />&nbsp; &nbsp; case 'US'&nbsp; &nbsp;: return trunc(u/1000).toString();<br />&nbsp; &nbsp; case 'UM'&nbsp; &nbsp;: return trunc(u/1000/60).toString();<br />&nbsp; &nbsp; case 'UH'&nbsp; &nbsp;: return trunc(u/1000/60/60).toString();<br />&nbsp; &nbsp; case 'UD'&nbsp; &nbsp;: return trunc(u/1000/60/60/24).toString();<br />&nbsp; &nbsp; case 'ZZZZ' : return zs+lpad(za,p3);<br />&nbsp; &nbsp; case 'Z'&nbsp; &nbsp; : return z.toString();<br />&nbsp; &nbsp; case 'ZS'&nbsp; &nbsp;: return zs;<br />&nbsp; &nbsp; case 'ZH'&nbsp; &nbsp;: return lpad(trunc(za/60),p2);<br />&nbsp; &nbsp; case 'ZM'&nbsp; &nbsp;: return lpad(za%60,p2);<br />&nbsp; &nbsp; case 'TZ'&nbsp; &nbsp;: return zs+lpad(trunc(za/60),p2)+':'+lpad(za%60,p2);<br />&nbsp; &nbsp; case 'ISOTS'&nbsp; : return ''+lpad(y,p4)+lpad(m+1,p2)+lpad(d,p2)+'T'+lpad(h,p2)+lpad(n,p2)+lpad(s,p2)+pp+lpad(f,p3)+zs+lpad(trunc(za/60),p2)+lpad(za%60,p2);<br />&nbsp; &nbsp; case 'ISODT'&nbsp; : return ''+lpad(y,p4)+lpad(m+1,p2)+lpad(d,p2);<br />&nbsp; &nbsp; case 'ISOTM'&nbsp; : return ''+lpad(h,p2)+lpad(n,p2)+lpad(s,p2)+pp+lpad(f,p3);<br />&nbsp; &nbsp; case 'ISOTZ'&nbsp; : return ''+zs+lpad(trunc(za/60),p2)+lpad(za%60,p2);<br />&nbsp; &nbsp; case 'ISO-TS' : return ''+lpad(y,p4)+pd+lpad(m+1,p2)+pd+lpad(d,p2)+'T'+lpad(h,p2)+pc+lpad(n,p2)+pc+lpad(s,p2)+pp+lpad(f,p3)+zs+lpad(trunc(za/60),p2)+pc+lpad(za%60,p2);<br />&nbsp; &nbsp; case 'ISO-DT' : return ''+lpad(y,p4)+pd+lpad(m+1,p2)+pd+lpad(d,p2);<br />&nbsp; &nbsp; case 'ISO-TM' : return ''+lpad(h,p2)+pc+lpad(n,p2)+pc+lpad(s,p2)+pp+lpad(f,p3);<br />&nbsp; &nbsp; case 'ISO-TZ' : return ''+zs+lpad(trunc(za/60),p2)+pc+lpad(za%60,p2);<br />&nbsp; &nbsp; case 'WEEKDAY': return weekday&#91;w&#93;;<br />&nbsp; &nbsp; case 'WKD'&nbsp; &nbsp; : return wkd&#91;w&#93;;<br />&nbsp; &nbsp; case 'MONTH'&nbsp; : return month&#91;m&#93;;<br />&nbsp; &nbsp; case 'MTH'&nbsp; &nbsp; : return mth&#91;m&#93;;<br />&nbsp; &nbsp; case '{'&nbsp; &nbsp; &nbsp; : return $1;<br />&nbsp; &nbsp; default&nbsp; &nbsp; &nbsp; &nbsp;: return $0;<br />&nbsp; }<br />}<br /></code></pre></div><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p42039" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile42039">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf147.html?author_id=3221&amp;sr=posts">6033</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Feb 2012 02:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content42039">

						<h3 ><a href="#p42039">Re: getTimestamp.bat for time and date processing</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting0138.html?mode=quote&amp;f=3&amp;p=42039" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicf451.html?p=42039#p42039" onclick="prompt('Message #29',this.href); return false;">#29</a></span> 
									<a class="unread" href="viewtopicf451.html?p=42039#p42039" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a></strong> &raquo; </span>13 Jul 2015 05:49
			</p>
			
			
			
			<div class="content">Thanks for your updates Dave. :thumbsup:</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p44148" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile44148">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content44148">

						<h3 ><a href="#p44148">Re: getTimestamp.bat for time and date processing</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting00cc.html?mode=quote&amp;f=3&amp;p=44148" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicea73.html?p=44148#p44148" onclick="prompt('Message #30',this.href); return false;">#30</a></span> 
									<a class="unread" href="viewtopicea73.html?p=44148#p44148" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>27 Nov 2015 21:22
			</p>
			
			
			
			<div class="content">I've been pretty much off the grid for a few months, concentrating on work and music.<br /><br />But here is a new version 2.4 of getTimeStamp.bat<br /><br />I reorganized the documentation a bit, and added some new examples for the /D option.<br /><br />New Features:<br /><br /><strong class="text-strong">1) New formats to specify comma or period as decimal point in ISO 8601 time values:</strong><br />These are just a convenience, since they could be constructed from component parts.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>{ISO-TM.}&nbsp; hh:mm:ss.fff&nbsp; (same as {ISO-TM})<br />{ISO-TM,}&nbsp; hh:mm:ss,fff<br />{ISOTM.}&nbsp; &nbsp;hhmmss.fff&nbsp; &nbsp; (same as {ISOTM})<br />{ISOTM,}&nbsp; &nbsp;hhmmss,fff<br />{ISO-TS.}&nbsp; YYYY-MM-DDThh:mm:ss.fff+hh:mm&nbsp; (same as {ISO-TS})<br />{ISO-TS,}&nbsp; YYYY-MM-DDThh:mm:ss,fff+hh:mm<br />{ISOTS.}&nbsp; &nbsp;YYYYMMDDThhmmss.fff+hhmm&nbsp; &nbsp; &nbsp; &nbsp;(same as {ISOTS})<br />{ISOTS,}&nbsp; &nbsp;YYYYMMDDThhmmss,fff+hhmm<br /></code></pre></div><br /><br /><strong class="text-strong">2) ISO 8601 Week Dates</strong><br />There are 52 or 53 full weeks in every year.<br />The week numbering year varies from the normal calendar year around Jan 1.<br />- Dec 29, 30, or 31 may belong to the next Jan year<br />- Jan 01, 02, or 03 may belong to the prior Dec year<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>{ISOWY}&nbsp; &nbsp;yyyy = Week numbering year<br />{ISOWK}&nbsp; &nbsp;ww = Week Number<br />{ISOWD}&nbsp; &nbsp;d = Day of Week (1=Monday, 7=Sunday)<br />{ISO-DTW} yyyy-Www-d<br />{ISODT2}&nbsp; yyyyWwwd<br /></code></pre></div><br /><br /><strong class="text-strong">3) ISO 8601 Ordinal Dates</strong><br />The component parts were already available, so these are just a convenience.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>{ISO-DTO}&nbsp; YYYY-DDD<br />{ISODTO}&nbsp; &nbsp;YYYYDDD<br /></code></pre></div><br /><br /><strong class="text-strong">Here is the code:</strong><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@if (@X)==(@Y) @end&nbsp; /* harmless hybrid line that begins a JScript comment<br />@goto :batch<br />::<br />::getTimestamp.bat version 2.4 by Dave Benham<br />::<br />::&nbsp; Release History:<br />::&nbsp; &nbsp; 2.4 2015-11-27 - Added formats to support comma as decimal mark in<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ISO 8601 time and timestamp formats.<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Added formats to support ISO 8601 week dates<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;and ordinal dates.<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Rearranged documentation, and added examples for<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;base date specified as a list of numeric values.<br />::&nbsp; &nbsp; 2.3 2015-07-11 - Added {ISO-xx}, {ISOxx}, {DY} and {DDY} formats<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Added -?? (paged help) option<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Allow user defined default option values by defining<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;variables of the form &quot;GetTimestamp-OPTION=VALUE&quot;<br />::&nbsp; &nbsp; 2.2 2014-12-03 - Doc fix: -R ReturnVariable is unchanged if err occurs<br />::&nbsp; &nbsp; 2.1 2014-12-03 - Added GOTO at top to increase performance (32% faster)<br />::&nbsp; &nbsp; 2.0 2014-12-02 - Major rewrite: most code now in JScript (25% faster)<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Better error handling<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;May now use /Option or -Option<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Added -V option<br />::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Added {{} format value to enable unambiguous { literal<br />::&nbsp; &nbsp; 1.1 ????-??-?? - Added -Z option and obscure bug fixes<br />::&nbsp; &nbsp; 1.0 2013-07-17 - Initial release<br />::<br />::============ Documentation ===========<br />:::<br />:::getTimestamp&nbsp; &#91;-option &#91;value&#93;&#93;...<br />:::<br />:::&nbsp; Displays a formatted timestamp. Defaults to the current local date<br />:::&nbsp; and time using an ISO 8601 format with milliseconds, time zone<br />:::&nbsp; and punctuation, using period as a decimal mark.<br />:::<br />:::&nbsp; Returned ERRORLEVEL is 0 upon success, 1 if failure.<br />:::<br />:::&nbsp; Options may be prefaced with - or /<br />:::<br />:::&nbsp; All options have default values. The default value can be overridden by<br />:::&nbsp; defining an evironment variable of the form &quot;GetTimestamp-OPTION=VALUE&quot;.<br />:::&nbsp; For example, upper case English weekday abbreviations can be specified as<br />:::&nbsp; the default by defining &quot;GetTimestamp-WKD=SUN MON TUE WED THU FRI SAT&quot;.<br />:::<br />:::&nbsp; Command line option values take precedence, followed by environment variable<br />:::&nbsp; defaults, followed by built in defaults.<br />:::<br />:::&nbsp; The following options are all case insensitive:<br />:::<br />:::&nbsp; &nbsp; -?&nbsp; : Prints this documentation for getTimestamp<br />:::<br />:::&nbsp; &nbsp; -?? : Prints this documentation with pagination via MORE<br />:::<br />:::&nbsp; &nbsp; -V&nbsp; : Prints the version of getTimeStamp<br />:::<br />:::&nbsp; &nbsp; -D DateSpec<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the base date and time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default value is current local date and time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;The DateSpec supports many formats:<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;&quot;&nbsp; &nbsp; (no value)<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Current date and time - the default<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;milliseconds<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;A JScript numeric expression that represents the number of<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;milliseconds since 1970-01-01 00:00:00 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Decimal values are truncated.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative values represent dates prior to 1970-01-01.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'Date &#91;Time&#93; &#91;TimeZone&#93;'&quot;<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;A string representation of the date and time. The date information<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;is required, the time and time zone are optional. Missing time info<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;is assumed to be 0 (midnight). Missing time zone info is assumed to<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;be local time zone.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;The Date, Time, and TimeZone information can be represented as any<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;string that is accepted by the JScript Date.Parse() method.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;There are many formatting options. Documentation is available at:<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;http://msdn.microsoft.com/en-us/library/k4w173wk(v=vs.84).aspx<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Examples of equivalent representations of Midnight on January 4,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2013 assuming local time zone is U.S Eastern Standard Time (EST):<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'1-4-2013'&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Defaults to local time zone<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'January 4, 2013 EST'&quot;&nbsp; &nbsp; &nbsp; &nbsp;Explicit Eastern Std Time (US)<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'2013/1/4 -05'&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Explicit Eastern Std Time (US)<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'Jan 3 2013 23: CST'&quot;&nbsp; &nbsp; &nbsp; &nbsp; Central Standard Time (US)<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'2013 3 Jan 9:00 pm -0800'&quot;&nbsp; Pacific Standard Time (US)<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'01/04/2013 05:00:00 UTC'&quot;&nbsp; &nbsp;Universal Coordinated Time<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;'1/4/2013 05:30 +0530'&quot;&nbsp; &nbsp; &nbsp; India Standard Time<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;year, month&#91;, day&#91;, hour&#91;, minute&#91;, second&#91;, millisecond&#93;&#93;&#93;&#93;&#93;&quot;<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;A comma delimited list of numeric JScript expressions representing<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;various components of date and time. Year and month are required,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the rest are optional. Missing values are treated as 0.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Decimal values are truncated. A 0 month represents January.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;A 1 day represents the first day of the month. A 0 day represents<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the last day of the prior month. The date/time value is always<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;in local time. There is no mechanism to specify a time zone.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Examples: (all in local time)<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;2012,0,1,12,45,3,121&quot;&nbsp; 12:45:03.121 on Jan 1, 2012<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;2012,0,1,12&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Noon on Jan 1, 2012<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;2012,1,1&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Midnight on Feb 1, 2012<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;2012,2,0&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Midnight on Feb 29, 2012 (last day of Feb)<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;2012,2&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Midnight on Feb 29, 2012 (last day of Feb)<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;The ability to use JScript expressions makes it convenient to do<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;date and time offset computations in a very compact form.<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;For example, starting with:<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;2015,8,7,14,5&quot;&nbsp; &nbsp; &nbsp; &nbsp; Sep 7, 2015 at 14:05:00<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;It is simple to subtract 30 days and 30 minutes from the above:<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;2015,8,7-30,14,5-30&quot;&nbsp; Aug 8, 2015 at 13:35:00<br />:::<br />:::&nbsp; &nbsp; -U&nbsp; : Returns a UTC timestamp instead of local timestamp.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Default is a local timestamp.<br />:::<br />:::&nbsp; &nbsp; -Z TimeZoneMinuteOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Returns the timestamp using the specified time zone offset.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;TimeZoneMinuteOffset is a JScript numeric expression that<br />:::&nbsp; &nbsp; &nbsp; &nbsp;represents the number of minutes offset from UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Decimal values are truncated.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is empty, meaning local timezone.<br />:::<br />:::&nbsp; &nbsp; -OY YearOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the number of years to offset the base date/time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;The JScript numeric expression is truncated to an integral number.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is 0<br />:::<br />:::&nbsp; &nbsp; -OM MonthOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the number of months to offset the base date/time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;The JScript numeric expression is truncated to an integral number.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is 0<br />:::<br />:::&nbsp; &nbsp; -OD DayOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the number of days to offset the base date/time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;The JScript numeric expression is truncated to an integral number.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is 0<br />:::<br />:::&nbsp; &nbsp; -OH HourOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the number of hours to offset the base date/time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;The JScript numeric expression is truncated to an integral number.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is 0<br />:::<br />:::&nbsp; &nbsp; -ON MinuteOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the number of minutes to offset the base date/time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;The JScript numeric expression is truncated to an integral number.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is 0<br />:::<br />:::&nbsp; &nbsp; -OS SecondOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the number of seconds to offset the base date/time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;The JScript numeric expression is truncated to an integral number.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is 0<br />:::<br />:::&nbsp; &nbsp; -OF MillisecondOffset<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the number of milliseconds to offset the base date/time.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;The JScript numeric expression is truncated to an integral number.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is 0<br />:::<br />:::&nbsp; &nbsp; -F FormatString<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Specify the timestamp format.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is &quot;{ISO-TS.}&quot;<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Strings within braces are dynamic components.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;All other strings are literals.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Available components (case insensitive) are:<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{YYYY}&nbsp; 4 digit year, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{YY}&nbsp; &nbsp; 2 digit year, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{Y}&nbsp; &nbsp; &nbsp;year without zero padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{MONTH} month name, as preferentially specified by:<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1) -MONTH option<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2) GetTimestamp-MONTH environment variable<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3) Mixed case, English month names<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{MTH}&nbsp; &nbsp;month abbreviation, as preferentially specified by:<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1) -MTH option<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2) GetTimestamp-MTH environment variable<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3) Mixed case, English month abbreviations<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{MM}&nbsp; &nbsp; 2 digit month number, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{M}&nbsp; &nbsp; &nbsp;month number without zero padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{WEEKDAY} day of week name, as preferentially specified by:<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1) -WEEKDAY option<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2) GetTimestamp-WEEKDAY environment variable<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3) Mixed case, English day names<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{WKD}&nbsp; &nbsp;day of week abbreviation, as preferentially specified by:<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1) -WKD option<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2) GetTimestamp-WKD environment variable<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3) Mixed case, English day abbreviations<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{W}&nbsp; &nbsp; &nbsp;day of week number: 0=Sunday, 6=Saturday<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{DD}&nbsp; &nbsp; 2 digit day of month number, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{D}&nbsp; &nbsp; &nbsp;day of month number, without zero padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{DDY}&nbsp; &nbsp;3 digit day of year number, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{DY}&nbsp; &nbsp; day of year number, without zero padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{HH}&nbsp; &nbsp; 2 digit hours, 24 hour format, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{H}&nbsp; &nbsp; &nbsp;hours, 24 hour format without zero padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{HH12}&nbsp; 2 digit hours, 12 hour format, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{H12}&nbsp; &nbsp;hours, 12 hour format without zero padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{NN}&nbsp; &nbsp; 2 digit minutes, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{N}&nbsp; &nbsp; &nbsp;minutes without padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{SS}&nbsp; &nbsp; 2 digit seconds, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{S}&nbsp; &nbsp; &nbsp;seconds without padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{FFF}&nbsp; &nbsp;3 digit milliseconds, zero padded<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{F}&nbsp; &nbsp; &nbsp;milliseconds without padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{AM}&nbsp; &nbsp; AM or PM in upper case<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{PM}&nbsp; &nbsp; am or pm in lower case<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ZZZZ}&nbsp; timezone expressed as minutes offset from UTC,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;zero padded to 3 digits with sign<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{Z}&nbsp; &nbsp; &nbsp;timzone expressed as minutes offset from UTC without padding<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ZS}&nbsp; &nbsp; ISO 8601 timezone sign<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ZH}&nbsp; &nbsp; ISO 8601 timezone hours (no sign)<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ZM}&nbsp; &nbsp; ISO 8601 timezone minutes (no sign)<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{TZ}&nbsp; &nbsp; ISO 8601 timezone in +/-hh:mm format<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISOTS}&nbsp; same as {ISOTS.}<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISOTS.} YYYYMMDDThhmmss.fff+hhss<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Compressed ISO 8601 date/time (timestamp) with milliseconds<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; and time zone, using . as decimal mark<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISOTS,} YYYYMMDDThhmmss,fff+hhss<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Compressed ISO 8601 date/time (timestamp) with milliseconds<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; and time zone, using , as decimal mark<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISODT}&nbsp; YYYYMMDD<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Compressed ISO 8601 date format<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISOTM}&nbsp; same as {ISOTM.}<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISOTM.} hhmmss.fff<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Compressed ISO 8601 time format with milliseconds,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using . as decimal mark<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISOTM,} hhmmss,fff<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Compressed ISO 8601 time format with milliseconds,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using , as decimal mark<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISOTZ}&nbsp; +hhmm<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Compressed ISO 8601 timezone format<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISOWY}&nbsp; yyyy<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ISO 8601 week numbering year<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Dec 29, 30, or 31 may belong to the next Jan year<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Jan 01, 02, or 03 may belong to the prior Dec year<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISOWK}&nbsp; ww<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ISO 8601 week number<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Week 01 is the week with the year's first Thursday<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISOWD}&nbsp; d<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ISO 8601 day of week: 1=Monday, 7=Sunday<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISODTW} yyyyWwwd<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Compressed ISO 8601 week date format<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISODTO} YYYYDDD<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Compressed ISO 8601 ordinal date format<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISO-TS} same as {ISO-TS.}<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISO-TS.} YYYY-MM-DDThh:mm:ss.fff+hh:ss<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ISO 8601 date/time (timestamp) with milliseconds and time zone<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using . as decimal mark<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISO-TS,} YYYY-MM-DDThh:mm:ss,fff+hh:ss<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ISO 8601 date/time (timestamp) with milliseconds and time zone<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using , as decimal mark<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISO-DT} YYYY-MM-DD<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ISO 8601 date format<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISO-TM} same as {ISO-TM.}<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISO-TM.} hh:mm:ss.fff<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ISO 8601 time format with milliseconds,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using . as decimal mark<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISO-TM,} hh:mm:ss,fff<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ISO 8601 time format with milliseconds,<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using , as decimal mark<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISO-TZ} +hh:mm<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ISO 8601 timezone&nbsp; (same as {TZ})<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISO-DTW} yyyy-Www-d<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ISO 8601 week date format<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ISO-DTO} YYYY-DDD<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ISO 8601 ordinal date format<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{UMS}&nbsp; &nbsp;Milliseconds since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{U}&nbsp; &nbsp; &nbsp;Same as {US}<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{US}&nbsp; &nbsp; Seconds since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{UM}&nbsp; &nbsp; Minutes since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{UH}&nbsp; &nbsp; Hours since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{UD}&nbsp; &nbsp; Days since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{USD}&nbsp; &nbsp;Decimal seconds since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{UMD}&nbsp; &nbsp;Decimal minutes since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{UHD}&nbsp; &nbsp;Decimal hours since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{UDD}&nbsp; &nbsp;Decimal days since 1970-01-01 00:00:00.000 UTC.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Negative numbers represent days prior to 1970-01-01.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value is unaffected by the -U option.<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This value should not be used with the -Z option<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{{}&nbsp; &nbsp; &nbsp;A { character<br />:::<br />:::&nbsp; &nbsp; -R ReturnVariable<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Save the timestamp in ReturnVariable instead of displaying it.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;ReturnVariable is unchanged if an error occurs.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is empty, meaning print to screen.<br />:::<br />:::&nbsp; &nbsp; -WKD &quot;Abbreviated day of week list&quot;<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Override the default day abbreviations with a space delimited,<br />:::&nbsp; &nbsp; &nbsp; &nbsp;quoted list, starting with Sun.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is mixed case, 3 character English day abbreviations.<br />:::<br />:::&nbsp; &nbsp; -WEEKDAY &quot;Day of week list&quot;<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Override the default day names with a space delimited, quoted list,<br />:::&nbsp; &nbsp; &nbsp; &nbsp;starting with Sunday.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is mixed case English day names.<br />:::<br />:::&nbsp; &nbsp; -MTH &quot;Abbreviated month list&quot;<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Override the default month abbreviations with a space delimited,<br />:::&nbsp; &nbsp; &nbsp; &nbsp;quoted list, starting with Jan.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is mixed case, 3 character English month abbreviations.<br />:::<br />:::&nbsp; &nbsp; -MONTH &quot;Month list&quot;<br />:::<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Override the default month names with a space delimited, quoted list,<br />:::&nbsp; &nbsp; &nbsp; &nbsp;starting with January.<br />:::&nbsp; &nbsp; &nbsp; &nbsp;Default is mixed case English month names.<br />:::<br />:::<br />:::&nbsp; GetTimestamp.bat was written by Dave Benham and originally posted at<br />:::&nbsp; http://www.dostips.com/forum/viewtopic.php?f=3&amp;t=4847<br />:::<br /><br />============= :Batch portion ===========<br />@echo off<br />setlocal enableDelayedExpansion<br /><br />:: Define options<br />set ^&quot;options=^<br />&nbsp;-?:^<br />&nbsp;-??:^<br />&nbsp;-v:^<br />&nbsp;-u:^<br />&nbsp;-z:&quot;&quot;^<br />&nbsp;-f:&quot;{ISO-TS}&quot;^<br />&nbsp;-d:&quot;&quot;^<br />&nbsp;-oy:&quot;&quot;^<br />&nbsp;-om:&quot;&quot;^<br />&nbsp;-od:&quot;&quot;^<br />&nbsp;-oh:&quot;&quot;^<br />&nbsp;-on:&quot;&quot;^<br />&nbsp;-os:&quot;&quot;^<br />&nbsp;-of:&quot;&quot;^<br />&nbsp;-r:&quot;&quot;^<br />&nbsp;-wkd:&quot;Sun Mon Tue Wed Thu Fri Sat&quot;^<br />&nbsp;-weekday:&quot;Sunday Monday Tuesday Wednesday Thursday Friday Saturday&quot;^<br />&nbsp;-mth:&quot;Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec&quot;^<br />&nbsp;-month:&quot;January February March April May June July August September October November December&quot;^&quot;<br /><br />:: Set default option values<br />for %%O in (%options%) do for /f &quot;tokens=1,* delims=:&quot; %%A in (&quot;%%O&quot;) do (<br />&nbsp; if defined GetTimestamp%%A (set &quot;%%A=!GetTimestamp%%A!&quot;) else set &quot;%%A=%%~B&quot;<br />)<br />set &quot;-?=&quot;<br />set &quot;-??=&quot;<br /><br />:: Get options<br />:loop<br />if not &quot;%~1&quot;==&quot;&quot; (<br />&nbsp; set &quot;arg=%~1&quot;<br />&nbsp; if &quot;!arg:~0,1!&quot; equ &quot;/&quot; set &quot;arg=-!arg:~1!&quot;<br />&nbsp; for /f delims^=^ eol^= %%A in (&quot;!arg!&quot;) do set &quot;test=!options:*%%A:=! &quot;<br />&nbsp; if &quot;!test!&quot;==&quot;!options! &quot; (<br />&nbsp; &nbsp; &nbsp; &gt;&amp;2 echo Error: Invalid option %~1. Use %~nx0 -? to get help.<br />&nbsp; &nbsp; &nbsp; exit /b 1<br />&nbsp; ) else if &quot;!test:~0,1!&quot;==&quot; &quot; (<br />&nbsp; &nbsp; &nbsp; set &quot;!arg!=1&quot;<br />&nbsp; &nbsp; &nbsp; if /i &quot;!arg!&quot; equ &quot;-U&quot; set &quot;-z=&quot;<br />&nbsp; ) else (<br />&nbsp; &nbsp; &nbsp; set &quot;!arg!=%~2&quot;<br />&nbsp; &nbsp; &nbsp; shift /1<br />&nbsp; )<br />&nbsp; shift /1<br />&nbsp; goto :loop<br />)<br />if defined -z set &quot;-u=1&quot;<br />if defined -r set &quot;%-r%=&quot;<br /><br />:: Display paged help<br />if defined -?? (<br />&nbsp; (for /f &quot;delims=: tokens=*&quot; %%A in ('findstr &quot;^:::&quot; &quot;%~f0&quot;') do @echo(%%A)|more /e<br />&nbsp; exit /b 0<br />) 2&gt;nul<br /><br />:: Display help<br />if defined -? (<br />&nbsp; for /f &quot;delims=: tokens=*&quot; %%A in ('findstr &quot;^:::&quot; &quot;%~f0&quot;') do echo(%%A<br />&nbsp; exit /b 0<br />)<br /><br />:: Display version<br />if defined -v (<br />&nbsp; for /f &quot;tokens=* delims=:&quot; %%A in ('findstr &quot;^::getTimestamp\.bat&quot; &quot;%~f0&quot;') do @echo(%%A<br />&nbsp; exit /b 0<br />)<br /><br />:: Execute the JScript script and return the result<br />for /f &quot;delims=&quot; %%A in ('cscript //E:JScript //nologo &quot;%~f0&quot;') do (<br />&nbsp; endlocal<br />&nbsp; if &quot;%-R%&quot; neq &quot;&quot; (set &quot;%-R%=%%A&quot;) else (echo(%%A)<br />&nbsp; exit /b 0<br />)<br />exit /b 1;<br /><br /><br />************ JScript portion ***********/<br />var env&nbsp; = WScript.CreateObject(&quot;WScript.Shell&quot;).Environment(&quot;Process&quot;),<br />&nbsp; &nbsp; utc&nbsp; = env('-U'),<br />&nbsp; &nbsp; wkd&nbsp; &nbsp; &nbsp;= env('-WKD').split(' '),<br />&nbsp; &nbsp; weekday = env('-WEEKDAY').split(' '),<br />&nbsp; &nbsp; mth&nbsp; &nbsp; &nbsp;= env('-MTH').split(' '),<br />&nbsp; &nbsp; month&nbsp; &nbsp;= env('-MONTH').split(' '),<br />&nbsp; &nbsp; stderr&nbsp; = WScript.StdErr,<br />&nbsp; &nbsp; y,m,d,w,h,h12,n,s,f,u,z,zs,za,<br />&nbsp; &nbsp; pc=':', pcm=',', pd='-', pp='.', p2='00', p3='000', p4='0000';<br /><br />if (wkd.length!=7)&nbsp; &nbsp; &nbsp;badOp('-WKD');<br />if (weekday.length!=7) badOp('-WEEKDAY');<br />if (mth.length!=12)&nbsp; &nbsp; badOp('-MTH');<br />if (month.length!=12)&nbsp; badOp('-MONTH');<br /><br />try {<br />&nbsp; var dt = eval('new Date('+env('-D')+')');<br />} catch(e) {<br />} finally {<br />&nbsp; if (isNaN(dt)) badOp('-D');<br />}<br /><br />if (env('-OY')) dt.setFullYear(&nbsp; &nbsp; &nbsp;dt.getFullYear()&nbsp; &nbsp; +getNum('-OY') );<br />if (env('-OM')) dt.setMonth(&nbsp; &nbsp; &nbsp; &nbsp; dt.getMonth()&nbsp; &nbsp; &nbsp; &nbsp;+getNum('-OM') );<br />if (env('-OD')) dt.setDate(&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dt.getDate()&nbsp; &nbsp; &nbsp; &nbsp; +getNum('-OD') );<br />if (env('-OH')) dt.setHours(&nbsp; &nbsp; &nbsp; &nbsp; dt.getHours()&nbsp; &nbsp; &nbsp; &nbsp;+getNum('-OH') );<br />if (env('-ON')) dt.setMinutes(&nbsp; &nbsp; &nbsp; dt.getMinutes()&nbsp; &nbsp; &nbsp;+getNum('-ON') );<br />if (env('-OS')) dt.setSeconds(&nbsp; &nbsp; &nbsp; dt.getSeconds()&nbsp; &nbsp; &nbsp;+getNum('-OS') );<br />if (env('-OF')) dt.setMilliseconds( dt.getMilliseconds()+getNum('-OF') );<br />if (env('-Z'))&nbsp; dt.setMinutes(&nbsp; &nbsp; &nbsp; dt.getMinutes()&nbsp; +(z=getNum('-Z')) );<br /><br />y = utc ? dt.getUTCFullYear(): dt.getFullYear();<br />m = utc ? dt.getUTCMonth()&nbsp; &nbsp;: dt.getMonth();<br />d = utc ? dt.getUTCDate()&nbsp; &nbsp; : dt.getDate();<br />w = utc ? dt.getUTCDay()&nbsp; &nbsp; &nbsp;: dt.getDay();<br />h = utc ? dt.getUTCHours()&nbsp; &nbsp;: dt.getHours();<br />n = utc ? dt.getUTCMinutes() : dt.getMinutes();<br />s = utc ? dt.getUTCSeconds() : dt.getSeconds();<br />f = utc ? dt.getUTCMilliseconds() : dt.getMilliseconds();<br />u = dt.getTime();<br /><br />h12 = h%12;<br />if (!h12) h12=12;<br /><br />if (z==undefined) if (utc) z=0; else z=-dt.getTimezoneOffset();<br />zs = z&lt;0 ? '-' : '+';<br />za = Math.abs(z);<br /><br />WScript.echo( env('-F').replace( /\{(.*?)\}/gi, repl ) );<br />WScript.Quit(0);<br /><br />function lpad( val, pad ) {<br />&nbsp; var rtn=val.toString();<br />&nbsp; return (rtn.length&lt;pad.length) ? (pad+rtn).slice(-pad.length) : val;<br />}<br /><br />function getNum( v ) {<br />&nbsp; var rtn;<br />&nbsp; try {<br />&nbsp; &nbsp; rtn = Number(eval(env(v)));<br />&nbsp; } catch(e) {<br />&nbsp; } finally {<br />&nbsp; &nbsp; if (isNaN(rtn-rtn)) badOp(v);<br />&nbsp; &nbsp; return rtn;<br />&nbsp; }<br />}<br /><br />function badOp(option) {<br />&nbsp; stderr.WriteLine('Error: Invalid '+option+' value');<br />&nbsp; WScript.Quit(1);<br />}<br /><br />function trunc( n ) { return Math&#91;n&gt;0?&quot;floor&quot;:&quot;ceil&quot;&#93;(n); }<br /><br />function weekNum(dt) {<br />&nbsp; &nbsp;var dt2 = new Date(dt.valueOf());<br />&nbsp; &nbsp;var day = (dt.getDay()+6)%7;<br />&nbsp; &nbsp;dt2.setDate(dt2.getDate()-day+3);<br />&nbsp; &nbsp;var now = dt2.valueOf();<br />&nbsp; &nbsp;dt2.setMonth(0, 1);<br />&nbsp; &nbsp;if (dt2.getDay() != 4) {<br />&nbsp; &nbsp;&nbsp; &nbsp;dt2.setMonth( 0, (11-dt2.getDay())%7 + 1 );<br />&nbsp; &nbsp;}<br />&nbsp; &nbsp;return 1 + Math.ceil((now-dt2.valueOf())/604800000);<br />}<br /><br />function weekYr(dt) {<br />&nbsp; &nbsp;var dt2 = new Date(dt.valueOf());<br />&nbsp; &nbsp;dt2.setDate(dt2.getDate()+3-(dt.getDay()+6)%7);<br />&nbsp; &nbsp;return dt2.getFullYear();<br />}<br /><br />function repl($0,$1) {<br />&nbsp; switch ($1.toUpperCase()) {<br />&nbsp; &nbsp; case 'YYYY' : return lpad(y,p4);<br />&nbsp; &nbsp; case 'YY'&nbsp; &nbsp;: return (p2+y.toString()).slice(-2);<br />&nbsp; &nbsp; case 'Y'&nbsp; &nbsp; : return y.toString();<br />&nbsp; &nbsp; case 'MM'&nbsp; &nbsp;: return lpad(m+1,p2);<br />&nbsp; &nbsp; case 'M'&nbsp; &nbsp; : return (m+1).toString();<br />&nbsp; &nbsp; case 'DD'&nbsp; &nbsp;: return lpad(d,p2);<br />&nbsp; &nbsp; case 'D'&nbsp; &nbsp; : return d.toString();<br />&nbsp; &nbsp; case 'W'&nbsp; &nbsp; : return w.toString();<br />&nbsp; &nbsp; case 'DY'&nbsp; &nbsp;: return trunc(((new Date(y,m,d)).getTime()-(new Date(y,0,0)).getTime())/86400000).toString();<br />&nbsp; &nbsp; case 'DDY'&nbsp; : return lpad( trunc(((new Date(y,m,d)).getTime()-(new Date(y,0,0)).getTime())/86400000), p3);<br />&nbsp; &nbsp; case 'HH'&nbsp; &nbsp;: return lpad(h,p2);<br />&nbsp; &nbsp; case 'H'&nbsp; &nbsp; : return h.toString();<br />&nbsp; &nbsp; case 'HH12' : return lpad(h12,p2);<br />&nbsp; &nbsp; case 'H12'&nbsp; : return h12.toString();<br />&nbsp; &nbsp; case 'NN'&nbsp; &nbsp;: return lpad(n,p2);<br />&nbsp; &nbsp; case 'N'&nbsp; &nbsp; : return n.toString();<br />&nbsp; &nbsp; case 'SS'&nbsp; &nbsp;: return lpad(s,p2);<br />&nbsp; &nbsp; case 'S'&nbsp; &nbsp; : return s.toString();<br />&nbsp; &nbsp; case 'FFF'&nbsp; : return lpad(f,p3);<br />&nbsp; &nbsp; case 'F'&nbsp; &nbsp; : return f.toString();<br />&nbsp; &nbsp; case 'AM'&nbsp; &nbsp;: return h&gt;=12 ? 'PM' : 'AM';<br />&nbsp; &nbsp; case 'PM'&nbsp; &nbsp;: return h&gt;=12 ? 'pm' : 'am';<br />&nbsp; &nbsp; case 'UMS'&nbsp; : return u.toString();<br />&nbsp; &nbsp; case 'USD'&nbsp; : return (u/1000).toString();<br />&nbsp; &nbsp; case 'UMD'&nbsp; : return (u/1000/60).toString();<br />&nbsp; &nbsp; case 'UHD'&nbsp; : return (u/1000/60/60).toString();<br />&nbsp; &nbsp; case 'UDD'&nbsp; : return (u/1000/60/60/24).toString();<br />&nbsp; &nbsp; case 'U'&nbsp; &nbsp; :<br />&nbsp; &nbsp; case 'US'&nbsp; &nbsp;: return trunc(u/1000).toString();<br />&nbsp; &nbsp; case 'UM'&nbsp; &nbsp;: return trunc(u/1000/60).toString();<br />&nbsp; &nbsp; case 'UH'&nbsp; &nbsp;: return trunc(u/1000/60/60).toString();<br />&nbsp; &nbsp; case 'UD'&nbsp; &nbsp;: return trunc(u/1000/60/60/24).toString();<br />&nbsp; &nbsp; case 'ZZZZ' : return zs+lpad(za,p3);<br />&nbsp; &nbsp; case 'Z'&nbsp; &nbsp; : return z.toString();<br />&nbsp; &nbsp; case 'ZS'&nbsp; &nbsp;: return zs;<br />&nbsp; &nbsp; case 'ZH'&nbsp; &nbsp;: return lpad(trunc(za/60),p2);<br />&nbsp; &nbsp; case 'ZM'&nbsp; &nbsp;: return lpad(za%60,p2);<br />&nbsp; &nbsp; case 'TZ'&nbsp; &nbsp;:<br />&nbsp; &nbsp; case 'ISO-TZ' : return ''+zs+lpad(trunc(za/60),p2)+pc+lpad(za%60,p2);<br />&nbsp; &nbsp; case 'ISOTS'&nbsp; :<br />&nbsp; &nbsp; case 'ISOTS.' : return ''+lpad(y,p4)+lpad(m+1,p2)+lpad(d,p2)+'T'+lpad(h,p2)+lpad(n,p2)+lpad(s,p2)+pp+lpad(f,p3)+zs+lpad(trunc(za/60),p2)+lpad(za%60,p2);<br />&nbsp; &nbsp; case 'ISOTS,' : return ''+lpad(y,p4)+lpad(m+1,p2)+lpad(d,p2)+'T'+lpad(h,p2)+lpad(n,p2)+lpad(s,p2)+pcm+lpad(f,p3)+zs+lpad(trunc(za/60),p2)+lpad(za%60,p2);<br />&nbsp; &nbsp; case 'ISODT'&nbsp; : return ''+lpad(y,p4)+lpad(m+1,p2)+lpad(d,p2);<br />&nbsp; &nbsp; case 'ISOTM'&nbsp; :<br />&nbsp; &nbsp; case 'ISOTM.' : return ''+lpad(h,p2)+lpad(n,p2)+lpad(s,p2)+pp+lpad(f,p3);<br />&nbsp; &nbsp; case 'ISOTM,' : return ''+lpad(h,p2)+lpad(n,p2)+lpad(s,p2)+pcm+lpad(f,p3);<br />&nbsp; &nbsp; case 'ISOTZ'&nbsp; : return ''+zs+lpad(trunc(za/60),p2)+lpad(za%60,p2);<br />&nbsp; &nbsp; case 'ISO-TS' :<br />&nbsp; &nbsp; case 'ISO-TS.': return ''+lpad(y,p4)+pd+lpad(m+1,p2)+pd+lpad(d,p2)+'T'+lpad(h,p2)+pc+lpad(n,p2)+pc+lpad(s,p2)+pp+lpad(f,p3)+zs+lpad(trunc(za/60),p2)+pc+lpad(za%60,p2);<br />&nbsp; &nbsp; case 'ISO-TS,': return ''+lpad(y,p4)+pd+lpad(m+1,p2)+pd+lpad(d,p2)+'T'+lpad(h,p2)+pc+lpad(n,p2)+pc+lpad(s,p2)+pcm+lpad(f,p3)+zs+lpad(trunc(za/60),p2)+pc+lpad(za%60,p2);<br />&nbsp; &nbsp; case 'ISO-DT' : return ''+lpad(y,p4)+pd+lpad(m+1,p2)+pd+lpad(d,p2);<br />&nbsp; &nbsp; case 'ISO-TM' :<br />&nbsp; &nbsp; case 'ISO-TM.': return ''+lpad(h,p2)+pc+lpad(n,p2)+pc+lpad(s,p2)+pp+lpad(f,p3);<br />&nbsp; &nbsp; case 'ISO-TM,': return ''+lpad(h,p2)+pc+lpad(n,p2)+pc+lpad(s,p2)+pcm+lpad(f,p3);<br />&nbsp; &nbsp; case 'ISOWY'&nbsp; : return ''+lpad(weekYr(dt),p4);<br />&nbsp; &nbsp; case 'ISOWK'&nbsp; : return ''+lpad(weekNum(dt),p2);<br />&nbsp; &nbsp; case 'ISOWD'&nbsp; : return ''+((w+6)%7+1);<br />&nbsp; &nbsp; case 'ISODTW' : return ''+lpad(weekYr(dt),p4)+'W'+lpad(weekNum(dt),p2)+((w+6)%7+1);<br />&nbsp; &nbsp; case 'ISODTO' : return ''+lpad(y,p4)+lpad( trunc(((new Date(y,m,d)).getTime()-(new Date(y,0,0)).getTime())/86400000), p3);<br />&nbsp; &nbsp; case 'ISO-DTW': return ''+lpad(weekYr(dt),p4)+pd+'W'+lpad(weekNum(dt),p2)+pd+((w+6)%7+1);<br />&nbsp; &nbsp; case 'ISO-DTO': return ''+lpad(y,p4)+pd+lpad( trunc(((new Date(y,m,d)).getTime()-(new Date(y,0,0)).getTime())/86400000), p3);<br />&nbsp; &nbsp; case 'WEEKDAY': return weekday&#91;w&#93;;<br />&nbsp; &nbsp; case 'WKD'&nbsp; &nbsp; : return wkd&#91;w&#93;;<br />&nbsp; &nbsp; case 'MONTH'&nbsp; : return month&#91;m&#93;;<br />&nbsp; &nbsp; case 'MTH'&nbsp; &nbsp; : return mth&#91;m&#93;;<br />&nbsp; &nbsp; case '{'&nbsp; &nbsp; &nbsp; : return $1;<br />&nbsp; &nbsp; default&nbsp; &nbsp; &nbsp; &nbsp;: return $0;<br />&nbsp; }<br />}<br /></code></pre></div><br /><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
	

	<div class="action-bar bar-bottom">
	
			<a href="postingfde4.html?mode=reply&amp;f=3&amp;t=4847" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic36d6-2.html?f=3&amp;t=4847&amp;start=15&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

			<form method="post" action="https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=4847&amp;start=15">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			46 posts
							<ul>
			<li class="arrow previous"><a class="button button-icon-only" href="viewtopic5ecb.html?f=3&amp;t=4847" rel="prev" role="button"><i class="icon fa-chevron-left fa-fw" aria-hidden="true"></i><span class="sr-only">Previous</span></a></li>
				<li><a class="button" href="viewtopic5ecb.html?f=3&amp;t=4847" role="button">1</a></li>
			<li class="active"><span>2</span></li>
				<li><a class="button" href="viewtopice8f9.html?f=3&amp;t=4847&amp;start=30" role="button">3</a></li>
				<li><a class="button" href="viewtopiccf06.html?f=3&amp;t=4847&amp;start=45" role="button">4</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopice8f9.html?f=3&amp;t=4847&amp;start=30" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="viewforum4d6b.html?f=3" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to “DOS Batch Forum”</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="viewforum31e6.html?f=4" class="jumpbox-cat-link"> <span> DosTips - Dos Batch</span></a></li>
																<li><a href="viewforum4d6b.html?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; DOS Batch Forum</span></a></li>
											</ul>
		</div>
	</div>

	</div>


			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
							<span class="crumb"><a href="../index.html" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>DosTips.com</span></a></span>									<span class="crumb"><a href="index.html" data-navbar-reference="index"><span>Board index</span></a></span>					</li>
		
				<li class="rightside">All times are <span title="UTC-6">UTC-06:00</span></li>
							<li class="rightside">
				<a href="ucp033a.html?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete all board cookies</span>
				</a>
			</li>
												<li class="rightside" data-last-responsive="true">
				<a href="memberlist4bfd.html?mode=team" role="menuitem">
					<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
				</a>
			</li>
									<li class="rightside" data-last-responsive="true">
				<a href="memberlist8733.html?mode=contactadmin" role="menuitem">
					<i class="icon fa-envelope fa-fw" aria-hidden="true"></i><span>Contact us</span>
				</a>
			</li>
			</ul>

	</div>
</div>

	<div class="copyright">
				<!-- WARNING NO DELETE -->Style developer by <a href="http://tricolor.x-tk.ru/">support forum tricolor</a>, <!-- END WARNING NO DELETE -->Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
									</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	<img src="cron5089.gif?cron_type=cron.task.text_reparser.post_text" width="1" height="1" alt="cron" /></div>

<script type="text/javascript" src="assets/javascript/jquery.mind772.js?assets_version=34"></script>
<script type="text/javascript" src="assets/javascript/cored772.js?assets_version=34"></script>



<script type="text/javascript" src="styles/prosilver/template/forum_fnd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/prosilver/template/ajaxd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/jquery-uid772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/collapsed772.js?assets_version=34"></script>



</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=4847&start=15 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 07:57:58 GMT -->
</html>
