<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=7402&start=15&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 05:12:39 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>DosTips.com &bull; Cmdwiz - cmd helper tools (now with Unicode) - Page 2</title>

<link href="styles/AllanStyle-SUBSILVER/theme/print.css" rel="stylesheet">
</head>
<body id="phpbb">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>DosTips.com</h1>
		<p>A Forum all about DOS Batch<br /><a href="index-2.html">https://www.dostips.com/forum/</a></p>

		<h2>Cmdwiz - cmd helper tools (now with Unicode)</h2>
		<p><a href="viewtopic684d.html?f=3&amp;t=7402">https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=7402</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>2</strong> of <strong>3</strong></div>
					<div class="post">
				<h3>Re: Cmdwiz - cmd helper tools</h3>
				<div class="date">Posted: <strong>28 Sep 2016 12:16</strong></div>
				<div class="author">by <strong>misol101</strong></div>
				<div class="content">Archive was updated after some bug fixes and addons.<br /><br />1. InspectBlock did not return -1 on error, now fixed<br /><br />2. Operation showcursor now returns the previous state of the cursor, so 0 if it was off, or 1-100 (the show percentage) if it was on.<br /><br />3. Bug in print operation fixed. If using % in the string, things could go very bad...<br /><br />4. Also for print operation, it now accepts \&quot; to print a &quot;.<br /><br />5. Operations setwindowpos and setmousecursorpos now accepts &quot;keep&quot;(or short, &quot;k&quot;) as x and/or y coordinate, meaning keep current position.<br /><br />6. New operation &quot;gettitle&quot; was added. It prints the title of the current window to stdout. I added it as 10.5 above, see description there.<br /><br />No Unicode yet.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Cmdwiz - cmd helper tools</h3>
				<div class="date">Posted: <strong>17 Dec 2016 18:52</strong></div>
				<div class="author">by <strong>Diegoddk</strong></div>
				<div class="content">this and the cmdgfx is amazing tools to make some games<br />thanks  <img class="smilies" src="images/smilies/icon_cool.gif" alt="8)" title="Cool" /></div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Cmdwiz - cmd helper tools</h3>
				<div class="date">Posted: <strong>18 Dec 2016 14:15</strong></div>
				<div class="author">by <strong>misol101</strong></div>
				<div class="content">Thanks, happy to hear that  <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /> <br /><br />Let me know if you finish some games, would be nice to see!<br /><br />There are a few games included in the cmdgfx/gotoxy archives to look at as well, but you have probably already seen that.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Cmdwiz - cmd helper tools</h3>
				<div class="date">Posted: <strong>18 Dec 2016 23:01</strong></div>
				<div class="author">by <strong>Sounak@9434</strong></div>
				<div class="content">A request from me.<br />Could you possibly remove all the helping text from the tool? (which appears on cmdwiz operation /? or cmdwiz /?)<br />I think it would lower down the file size significantly and make it more usable. You can add a readme.txt file with the download to explain the features.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Cmdwiz - cmd helper tools</h3>
				<div class="date">Posted: <strong>19 Dec 2016 07:39</strong></div>
				<div class="author">by <strong>aGerman</strong></div>
				<div class="content">Of course the help text will increase the size of the tool (the same size as the text has) but it will not decrease the performance of the tool in a manner as you may think. In the attachment are 2 &quot;Hello World&quot; programs. In the first is also a dummy text of 5.5 KB included that you can see if you open it in a text editor. Just try ...<br />A useful help message is rather a matter of usability and comfort in my opinion. I would never remove it (but that's misol101's decision).<br /><br />Steffen</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Cmdwiz - cmd helper tools</h3>
				<div class="date">Posted: <strong>19 Dec 2016 15:16</strong></div>
				<div class="author">by <strong>misol101</strong></div>
				<div class="content">I'm with aGerman on this one, I don't think it would have the effect (make it more usable(?)) that you would like (is it more speed you are thinking of?). Also I like the fact that the info can be retrieved without looking at a separate file.<br /><br />aGerman: I generally agree that file size doesn't matter for speed, what does matter though is the compiler used and how much overhead it adds to the program startup. I must regretfully admit that some quick tests shows that Aacini's &quot;GetKey.exe /n&quot; is &quot;much faster&quot; than &quot;cmdwiz getch noWait&quot; (&quot;much faster&quot; in this context means a few milliseconds, which only matters if you do stuff like animated graphics).<br /><br />They do essentially exactly the same thing, so I think the difference in speed is due to the overhead added by gcc, and also due to linking libraries like user32, winmm, gdi32 needed for other operations), whereas GetKey has very little overhead and is written in assembler for a very specific purpose.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Cmdwiz - cmd helper tools</h3>
				<div class="date">Posted: <strong>19 Dec 2016 16:09</strong></div>
				<div class="author">by <strong>aGerman</strong></div>
				<div class="content">Overhead may be a problem of any compiled language. Only Assembly doesn't need a compiler for the translation into machine code. <br /><br />Never mind. We are talking about string literals. Loading them into memory doesn't noticeably decrease the performance of a utility. Scheduling the process by the operating system takes much longer.<br /><br />Steffen</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Cmdwiz - cmd helper tools</h3>
				<div class="date">Posted: <strong>19 Dec 2016 22:54</strong></div>
				<div class="author">by <strong>Sounak@9434</strong></div>
				<div class="content">@misol101<br />I am not saying about speed or stuff but usually batch files are meant to be small. If there are games or other stuff to be made I think the size really matters. Though 74.4 KB is not much but still. It's obviously upto you.<br />You can just create or add a secondary file in the zip in which no help text is added, you don't need to remove the real one at all.<br />But all in all it's upto you what to do. <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /></div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Cmdwiz - cmd helper tools</h3>
				<div class="date">Posted: <strong>02 Sep 2017 16:42</strong></div>
				<div class="author">by <strong>misol101</strong></div>
				<div class="content">Archive and repo update (<a href="http://www.mediafire.com/download/8xywdi36hca4dgo/gotoxy.zip" class="postlink">http://www.mediafire.com/download/8xywdi36hca4dgo/gotoxy.zip</a>).<br /><br />The following was done:<br /><br />1. <strong class="text-strong">setfont</strong> operation now works for Win10<br />2. Support bitwise operations for the <strong class="text-strong">insertbmp </strong>operation. It's now e.g. possible to &quot;fake&quot; transparency (see 10.1 above)<br />3. <strong class="text-strong">moveblock </strong>operation can now specify a character/color to fill in the area where the block moved from (see 9.2)<br />4. New operation: <strong class="text-strong">gxyinfo</strong>. This is used to print out the dimensions of a gxy/txt file, plus give additional info (see 10.6)<br />5. The insertbmp and saveblock operations now return negative values on error, to make them consistent with the other operations (10.1, 9.3)<br />6. New operations: <strong class="text-strong">getwindowstyle/setwindowstyle</strong>. These are used to get/set properties of the console window. It's pretty complicated to use and I will only briefly document it, but it's there to use anyway (see 1.7 and 1.8 )</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Cmdwiz - cmd helper tools</h3>
				<div class="date">Posted: <strong>09 Sep 2017 09:27</strong></div>
				<div class="author">by <strong>misol101</strong></div>
				<div class="content">Another update (same link).<br /><br />Changes:<br /><br />1. New operations: <strong class="text-strong">setpalette/getpalette</strong>. As the names suggest they are used to get or set the color palette used by the current cmd window (see 1.9 and 1.10 above)<br />2. New operation: <strong class="text-strong">showmousecursor</strong>. Used to disable or enable showing the mouse cursor over the cmd window (see 8.3). Thanks to carlos for the code which is from the fscreen program<br />3. get/setwindowstyle: now accepts 0x in front of value so these can be copied straight from the Microsoft page(s) (see 1.7 and 1.8 )<br />4. (hopefully) all operations now return a negative Errorlevel value (usually -1) if an error occured</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Cmdwiz - cmd helper tools</h3>
				<div class="date">Posted: <strong>09 Jul 2018 11:19</strong></div>
				<div class="author">by <strong>misol101</strong></div>
				<div class="content">Version 1.0 release!  <img class="smilies" src="images/smilies/icon_razz.gif" width="15" height="15" alt=":P" title="Razz"> <br>
<br>
<strong class="text-strong">Archive was updated</strong>, see first post for link.<br>
<br>
What's new?<br>
<br>
1. <strong class="text-strong">Unicode support!</strong> Yes, Steffen only had to wait almost 2 years for his feature request to be implemented <img class="smilies" src="images/smilies/icon_razz.gif" width="15" height="15" alt=":P" title="Razz"> Sorry about that. More about Unicode and versions below<br>
2. This version is officially called 1.0, which can be seen if starting cmdwiz without arguments or with /?<br>
3. Some operations were previously not working if stdin and/or stdout were in use (typically, if running inside a pipe, for example with cmdgfx_input as stdin and cmdgfx as stdout). This is now fixed.<br>
4. New operation: <strong class="text-strong">fullscreen</strong> (see 1.11 above). Used to set fullscreen on/off for the console window<br>
5. New operation: <strong class="text-strong">showwindow </strong>(see 1.12). Used to minimize/maximize/restore etc the console window<br>
6. Topmost argument added for <strong class="text-strong">setwindowpos </strong>(see 1.5). Used to make the console a topmost window (i.e. always on top of other windows)<br>
7. ReportFailedOpen argument added for <strong class="text-strong">cache </strong>operation (see 10.4). Used if you want an error message printed for each file in the cache list that could not be opened<br>
8. File size cut down about 35kb due to using "strip" on the binary<br>
<br>
<strong class="text-strong">About Unicode support:</strong><br>
<br>
<em class="text-italics">Cmdwiz.exe</em> is the new Unicode enabled version. I'm fairly confident it works for all operations, but just to be on the safe side there is also <em class="text-italics">cmdwiz-ascii.exe</em> included in the archive, which is the legacy version without Unicode support.<br>
<br>
So what does it mean Cmdwiz now supports Unicode?<br>
<br>
1. For all operations that read or write a file, the file name can now include Unicode characters. These operations are: <em class="text-italics">saveblock, playsound, getexetype, cache, insertbmp, savefont, setfont, gxyinfo </em><br>
2. For operations that writes user decided output to stdout, they will now print Unicode characters (provided of course that the font used has the character). These operations are: <em class="text-italics">print, gettitle</em><br>
3. String operations <em class="text-italics">stringlen </em>and <em class="text-italics">stringfind </em>now accept Unicode as well<br>
4. The file used by the <em class="text-italics">cache </em>operation can now contain file names with Unicode characters. The cache file can be saved as either Utf-8, Utf-8 BOM, Utf-16 LE, or Ansi (OEM or Windows codepage). If this sounds like overkill for such an obscure operation as "cache", then you are correct, but I used it for educating myself. Beware though, Utf-16 BE is not supported! <img class="smilies" src="images/smilies/icon_smile.gif" width="15" height="15" alt=":)" title="Smile"><br>
<br>
What is *not* Unicode?<br>
<br>
1. The saveblock operation support saving the file with Unicode characters in the filename. However, the block saved does NOT preserve any Unicode characters. The gxy file format does not even support coding characters above 0xff at the moment, so there is no point. Also note that it is not actually recommended to save a gxy file with Unicode characters in the filename, because cmdgfx will not even be able to read it (gotoxy will, partly).<br>
<br>
2. I might be wrong about this, but a more general problem seems to be that for Unicode command line arguments to a C program in general, you can support either Utf-8 or Utf-16, but not both, because there is no way to know which one is coming in. Utf-16 is standard on Windows (and is what I use), but there are some situations where this is not true (I can provide an example, but I don't want to get too long-winded).</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Cmdwiz - cmd helper tools</h3>
				<div class="date">Posted: <strong>11 Jul 2018 12:35</strong></div>
				<div class="author">by <strong>aGerman</strong></div>
				<div class="content"><blockquote><div><cite><a href="memberlist54f1.html?mode=viewprofile&amp;u=8229">misol101</a> wrote: <a href="viewtopicdb83.html?p=57369#p57369" data-post-id="57369" onclick="if(document.getElementById(hash.substr(1)))href=hash">↑</a><div class="responsive-hide">09 Jul 2018 11:19</div></cite>Yes, Steffen only had to wait almost 2 years for his feature request to be implemented <img class="smilies" src="images/smilies/icon_razz.gif" width="15" height="15" alt=":P" title="Razz"> Sorry about that.</div></blockquote>
Don't worry about that. I was quite sure you would implemt this feature sooner or later <img class="smilies" src="images/smilies/icon_lol.gif" width="15" height="15" alt=":lol:" title="Laughing"> <br>

<blockquote><div><cite><a href="memberlist54f1.html?mode=viewprofile&amp;u=8229">misol101</a> wrote: <a href="viewtopicdb83.html?p=57369#p57369" data-post-id="57369" onclick="if(document.getElementById(hash.substr(1)))href=hash">↑</a><div class="responsive-hide">09 Jul 2018 11:19</div></cite>I might be wrong about this, but a more general problem seems to be that for Unicode command line arguments to a C program in general, you can support either Utf-8 or Utf-16, but not both, because there is no way to know which one is coming in. Utf-16 is standard on Windows (and is what I use), but there are some situations where this is not true (I can provide an example, but I don't want to get too long-winded).</div></blockquote>
You would need to make some efforts to support both but it's actually not worth it (first check the char* arguments character by character whether they contain multibyte UTF-8 characters). It may sound weird but even ASCII parameters are passed to the program UTF-16-encoded. The C-implementation is narrowing them down to ANSI again. So your best bet is to use the wmain() entry point using Visual Studio or the __wgetmainargs() function for any other compiler. Passing a UTF-16 file name to the program is the real problem since you might not be able to have it hard-coded in a batch file. You would need ugly workarounds using a FOR loop with an asterisk or question mark as search pattern, then pass the FOR variable (which is able to contain the Unicode file name). Parameter variables are also possible where you need to drag/drop the file to the script.<br>
<br>
Steffen</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Cmdwiz - cmd helper tools (now with Unicode)</h3>
				<div class="date">Posted: <strong>01 Aug 2018 16:13</strong></div>
				<div class="author">by <strong>misol101</strong></div>
				<div class="content">Here is <strong class="text-strong">version 1.1 of Cmdwiz</strong> (see updated archive link in first post)<br>
<br>
What's new?<br>
<br>
1. <strong class="text-strong">showwindow</strong>: Added options to make the window <em class="text-italics">topmost, top, or bottom</em>. Also added <em class="text-italics">close</em> in order to close the window. Topmost option was removed from setwindowpos operation. (see 1.12 above)<br>
2. New operation: <strong class="text-strong">sendkey</strong>. As the name suggests, it can be used to simulate keyboard input (see 8.4)<br>
3. The <strong class="text-strong">fullscreen</strong> operation now uses official Windows API SetConsoleDisplayMode, which is 100% fullscreen. The old method can still be used with the legacy argument. Legacy mode is also used automatically if new API fails (1.11)<br>
4. <strong class="text-strong">setmousecursorpos</strong> now also supports middle button click, plus mouse wheel and horizontal mouse wheel (8.2)<br>
5. <strong class="text-strong">setbuffersize</strong> now supports using - as argument to remove vertical and/or horizontal scrollbar (1.2)<br>
6. <strong class="text-strong">gettitle </strong> operation now has a <em class="text-italics">strip</em> argument to attempt removal of last part of the title (10.5)<br>
7. <strong class="text-strong">getkeystate </strong> operation now accepts 0x before virtual key values to allow straight copying from Microsoft's website (2.2)<br>
8. Fixed a bug where using <em class="text-italics">setwindowpos </em>after <em class="text-italics">setwindowstyle </em>in some cases caused graphical artifacts</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Cmdwiz - cmd helper tools (now with Unicode)</h3>
				<div class="date">Posted: <strong>29 Aug 2018 10:30</strong></div>
				<div class="author">by <strong>misol101</strong></div>
				<div class="content"><strong class="text-strong">Version 1.2 of CmdWiz is out</strong> (usual link at the top or get the repo).<br>
<br>
This version is something of a game changer, as it allows all window operations to be used not only for the cmd window, but for any currently open window!<br>
<br>
Big thanks to Steffen, whose code for enumerating/finding windows I reused (with permission) with a few modifications.<br>
<br>
These operations are available for all windows: <em class="text-italics">setwindowpos, setwindowsize, getwindowbounds, setwindowtransparency, showwindow, getwindowstyle, setwindowstyle, insertbmp</em><br>
<br>
To get available windows,use the new <em class="text-italics">windowlist </em>operation.<br>
<br>
Essentially, this means that cmdwiz can now be used as a <strong class="text-strong">general automation tool for Windows</strong>, especially when combining the above operations with the <em class="text-italics">sendkey </em>and <em class="text-italics">setmousecursorpos </em>operations. Granted, there are more powerful alternatives like AutoHotkey, but not that can be easily integrated with Batch (I think).<br>
<br>
I will document the new operations and usage of finding windows soon. In the meantime, here is a little example automation script, which does the following: closes down existing notepad.exe instances, opens a new one, wait for it to pop up, puts the window on top, changes its size, centers it on the desktop, writes text to the document, sets the window transparency, injects a bitmap image (if available) into the document, moves the window around randomly, selects and deletes the text and image, writes some more text and then quits <img class="smilies" src="images/smilies/icon_smile.gif" width="15" height="15" alt=":)" title="Smile"><br>

<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off
setlocal EnableDelayedExpansion
taskkill /F /IM notepad.exe &gt;nul 2&gt;nul
call :WAITWIN notepad.exe 1
start notepad.exe
call :WAITWIN notepad.exe 0

cmdwiz showwindow top /N:notepad.exe
cmdwiz setwindowsize 600 480 /N:notepad.exe
cmdwiz getdisplaydim w &amp; set SW=!errorlevel!
cmdwiz getdisplaydim h &amp; set SH=!errorlevel!
cmdwiz getwindowbounds w /N:notepad.exe &amp; set WINW=!errorlevel!
cmdwiz getwindowbounds h /N:notepad.exe &amp; set WINH=!errorlevel!
set /a WPX=%SW%/2-%WINW%/2,WPY=%SH%/2-%WINH%/2
cmdwiz setwindowpos %WPX% %WPY% /N:notepad.exe

cmdwiz delay 500
cmdwiz sendkey 0x10 d &amp; cmdwiz sendkey 0x48 p &amp; cmdwiz sendkey 0x10 u
for %%a in (0x45 0x4C 0x4C 0x4F 0x20 0x57 0x4f 0x52 0x4c 0x44) do cmdwiz sendkey %%a p
cmdwiz sendkey 0x10 d &amp; cmdwiz sendkey 0x31 p &amp; cmdwiz sendkey 0x10 u
cmdwiz delay 1000
cmdwiz setwindowtransparency 10 /N:notepad.exe
cmdwiz delay 1000
if exist gotoxy-examples\123.bmp cmdwiz insertbmp gotoxy-examples\123.bmp 10 50 100 /N:notepad.exe
cmdwiz delay 1000

set /a TIMES=30
:MOVERANDOMLOOP
	set /a "X=(!RANDOM! %% %SW%) - 300, Y=(!RANDOM! %% %SH%) - 240, TIMES-=1"
	cmdwiz setwindowpos %X% %Y% /N:notepad.exe
	cmdwiz delay 100
if %TIMES% gtr 0 goto :MOVERANDOMLOOP
cmdwiz setwindowpos %WPX% %WPY% /N:notepad.exe

cmdwiz delay 1000
cmdwiz sendkey 0x11 d &amp; cmdwiz sendkey 0x41 p &amp; cmdwiz sendkey 0x11 u
cmdwiz delay 1000
cmdwiz sendkey 0x08 p
cmdwiz delay 1000
cmdwiz sendkey 0x10 d &amp; cmdwiz sendkey 0x42 p &amp; cmdwiz sendkey 0x10 u
for %%a in (0x59 0x45 0xbe 0xbe 0xbe) do cmdwiz sendkey %%a p
cmdwiz delay 1000
taskkill /F /IM notepad.exe &gt;nul 2&gt;nul

endlocal
goto :eof

:WAITWIN &lt;procName&gt; &lt;findVal&gt;
	cmdwiz windowlist | find "%1"&gt;nul
if %errorlevel% neq %2 goto :WAITWIN
</code></pre></div></div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Cmdwiz - cmd helper tools (now with Unicode)</h3>
				<div class="date">Posted: <strong>29 Aug 2018 13:26</strong></div>
				<div class="author">by <strong>misol101</strong></div>
				<div class="content">By the way, Steffen and Carlos are now mentioned in both the in-program help text and the source code for CmdWiz, since I have used code snippets from both of you for some of the operations.<br>
<br>
Please let me know if you for whatever reason prefer not to be mentioned, or prefer to be mentioned by your alias only, or similar.<br>
<br>
Thank you again.</div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="UTC-6">UTC-06:00</span><br />Page <strong>2</strong> of <strong>3</strong></div>
		<div class="copyright">Powered by phpBB&reg; Forum Software &copy; phpBB Limited<br />https://www.phpbb.com/</div>
	</div>
</div>

</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=7402&start=15&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 05:12:39 GMT -->
</html>
