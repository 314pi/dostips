<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=2167&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 09:14:28 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>DosTips.com &bull; Insert text into column b csv file</title>

<link href="styles/AllanStyle-SUBSILVER/theme/print.css" rel="stylesheet">
</head>
<body id="phpbb">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>DosTips.com</h1>
		<p>A Forum all about DOS Batch<br /><a href="index-2.html">https://www.dostips.com/forum/</a></p>

		<h2>Insert text into column b csv file</h2>
		<p><a href="viewtopic864c.html?f=3&amp;t=2167">https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=2167</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>1</strong> of <strong>2</strong></div>
					<div class="post">
				<h3>Insert text into column b csv file</h3>
				<div class="date">Posted: <strong>29 Aug 2011 06:10</strong></div>
				<div class="author">by <strong>Ken</strong></div>
				<div class="content">Can someone help me... Is there a way using a batch file to input text into column B in a csv file.  I have dates in column A and I want the inserted text to goto column B.<br /><br />Thank you<br />Ken</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Insert text into column b csv file</h3>
				<div class="date">Posted: <strong>29 Aug 2011 13:38</strong></div>
				<div class="author">by <strong>trebor68</strong></div>
				<div class="content">You can see this in following link<br /><br /><a href="viewtopic1d75-2.html?f=3&amp;t=2156" class="postlink">http://www.dostips.com/forum/viewtopic.php?f=3&amp;t=2156</a><br /><br />The row with letter A will overwrite a file.<br />The other echo commands are writing a new row at the end of the file.<br /><br />I will hope that will help you.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Insert text into column b csv file</h3>
				<div class="date">Posted: <strong>29 Aug 2011 15:25</strong></div>
				<div class="author">by <strong>Ken</strong></div>
				<div class="content">I looked at the Link Posted Output to excel/csv file but The date will always be in column A and my input text needs to start on the same line as the date in column A. <br />This is what it is doing.<br />8/29/2011<br />1 2 3 4 5 6 etc...<br />8/29/2011<br />1 2 3 4 5 6 <br /><br />This is the way I want it to look.<br />8/29/2011 1 2 3 4 5 6<br />8/29/2011 1 2 3 4 5 etc.<br /><br />Thanks again for your help<br />Ken</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Insert text into column b csv file</h3>
				<div class="date">Posted: <strong>29 Aug 2011 20:05</strong></div>
				<div class="author">by <strong>ghostmachine4</strong></div>
				<div class="content">Use something better to process files instead of batch.. If you want native solution, you can use vbscript (or powershell),<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>Set objFS = CreateObject( &quot;Scripting.FileSystemObject&quot; )<br />strFile = WScript.Arguments(0)<br />Set objFile = objFS.OpenTextFile(strFile)<br />Do Until objFile.AtEndOfStream<br />&nbsp; &nbsp;strLine= objFile.ReadLine<br />&nbsp; &nbsp; &nbsp; &nbsp; WScript.Echo strLine &amp; &quot; &quot; &amp; &quot;test&quot;<br />Loop<br />objFile.Close<br /><br /></code></pre></div><br /><br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>C:\test&gt; cscript //nologo myscript.vbs file<br /></code></pre></div></div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Insert text into column b csv file</h3>
				<div class="date">Posted: <strong>30 Aug 2011 04:20</strong></div>
				<div class="author">by <strong>Ken</strong></div>
				<div class="content">Thanks for the reply... I need it in a batch format. Other people will be accessing the file placed on there desktops.  The CSV file has changing dates in column A.  When they input a line it needs to line up with the dates already in file on the network (line B1, B2, B3 etc...)  They may not have powershell installed.  Thanks again</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Insert text into column b csv file</h3>
				<div class="date">Posted: <strong>30 Aug 2011 07:22</strong></div>
				<div class="author">by <strong>ghostmachine4</strong></div>
				<div class="content"><blockquote><div><cite>Ken wrote:</cite>Thanks for the reply... I need it in a batch format. Other people will be accessing the file placed on there desktops.  The CSV file has changing dates in column A.  When they input a line it needs to line up with the dates already in file on the network (line B1, B2, B3 etc...)  They may not have powershell installed.  Thanks again</div></blockquote><br />It is not powershell, it is vbscript.  vbscript is present on Win9x and above, so there is not need to download anything.... just put the command inside a text file and name it whatever.bat (its called a batch file after that).</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Insert text into column b csv file</h3>
				<div class="date">Posted: <strong>30 Aug 2011 09:55</strong></div>
				<div class="author">by <strong>Ken</strong></div>
				<div class="content">Ok... I did not understand, does this script need to be inserted before the current commands are run?<br /><br />I guess I am not understanding this script.  When I execute it as a batch file I get several errors... Could you give me a little example of how I should be using this.<br /><br />Thank you very much for your time.<br /><br />Errors:<br />C:\Documents and Settings\Ken\Desktop\Test Batch&gt;Set objFS = CreateObject( &quot;Scripting.FileSystemObject&quot; )<br /><br />C:\Documents and Settings\Ken\Desktop\Test Batch&gt;strFile = WScript.Arguments(0)<br />'strFile' is not recognized as an internal or external command,<br />operable program or batch file.<br /><br />C:\Documents and Settings\Ken\Desktop\Test Batch&gt;Set objFile = objFS.OpenTextFile(test.csv)<br /><br />C:\Documents and Settings\Ken\Desktop\Test Batch&gt;Do Until objFile.AtEndOfStream<br />'Do' is not recognized as an internal or external command,<br />operable program or batch file.<br /><br />C:\Documents and Settings\Ken\Desktop\Test Batch&gt;strLine= objFile.ReadLine<br />'strLine' is not recognized as an internal or external command,<br />operable program or batch file.<br /><br />C:\Documents and Settings\Ken\Desktop\Test Batch&gt;WScript.Echo strLine   &amp; &quot; &quot;   &amp; &quot;test&quot;<br />'WScript.Echo' is not recognized as an internal or external command,<br />operable program or batch file.<br />'&quot; &quot;' is not recognized as an internal or external command,<br />operable program or batch file.<br />'&quot;test&quot;' is not recognized as an internal or external command,<br />operable program or batch file.<br /><br />C:\Documents and Settings\Ken\Desktop\Test Batch&gt;Loop<br />'Loop' is not recognized as an internal or external command,<br />operable program or batch file.<br /><br />C:\Documents and Settings\Ken\Desktop\Test Batch&gt;objFile.Close<br />'objFile.Close' is not recognized as an internal or external command,<br />operable program or batch file.<br /><br />C:\Documents and Settings\Ken\Desktop\Test Batch&gt;pause</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Insert text into column b csv file</h3>
				<div class="date">Posted: <strong>30 Aug 2011 11:32</strong></div>
				<div class="author">by <strong>A_Bobby</strong></div>
				<div class="content">Try this<br /><br />echo ,CellB1 &gt; test2.csv<br /><br />I know it looks absurdly simple. Hope I am not missing anything!</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Insert text into column b csv file</h3>
				<div class="date">Posted: <strong>30 Aug 2011 11:48</strong></div>
				<div class="author">by <strong>trebor68</strong></div>
				<div class="content">Please excuse my first post, where I had a misconception.<br /><br />Here is the correct posting.<br /><br />The file Test.bat<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />setlocal ENABLEEXTENSIONS ENABLEDELAYEDEXPANSION<br />if not exist Test1.csv for %%a in (1 2 3 4) do echo &quot;A%%a&quot;&gt;&gt;Test1.csv<br />::<br />if exist Test2.csv del Test2.csv<br />set row=0<br />for /f &quot;tokens=*&quot; %%d in (Test1.csv) do (<br />&nbsp; set /a row+=1<br />&nbsp; call :eingabe !row!<br />&nbsp; echo %%d,&quot;!newcell!&quot;&gt;&gt;Test2.csv<br />)<br />:: (del Test1.csv) &amp; (ren Test2.csv Test1.csv)<br />goto :eof<br />:eingabe<br />set &quot;newcell=&quot;<br />if not %1#==2# (<br />&nbsp; set /p newcell=Value for row %1: <br />&nbsp; if !newcell!#==# set newcell=B%1<br />)<br />goto :eof<br /></code></pre></div><br /><br />The row 3 in the code will make the first file with cell A1 to A4.<br />With the other rows make input value for the cell B1 to B4, with reading the first file.<br />The block &quot;:eingabe&quot; is for making the value for the cell.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Insert text into column b csv file</h3>
				<div class="date">Posted: <strong>30 Aug 2011 14:04</strong></div>
				<div class="author">by <strong>Ken</strong></div>
				<div class="content">Wow... You are GREAT!  This is the direction I want to go.  Great Job Thank You!!<br />Question:  <br />It starts in Cell B1 and skips Cell B2 and then continues without issue.  <br />Example 8/28/2011 B1<br />           8/29/2011 &lt;-- Blank cell<br />           8/30/2011 B2<br />           8/31/2011 B3<br />Can I correct this (where in code) or is this a drawback?<br />And may I ask one more question?  If I use an array for input using 10 fields going across what and where can I add to your code to extend these fields?<br /><br />Example of what I am trying to do: each () is Cell A1, B1, C1, D1 etc...<br /><br />(8/29/2011),(8:30am),(Persons Name),(address),(zipcode) etc ...<br /><br />Would I use newcell then add another set /p name=value for row %1:<br />                                                    if !name!#==# set newcell=C%1 ) - Just guessing<br /><br />Thank you again for the help</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Insert text into column b csv file</h3>
				<div class="date">Posted: <strong>30 Aug 2011 20:41</strong></div>
				<div class="author">by <strong>ghostmachine4</strong></div>
				<div class="content"><blockquote><div><cite>Ken wrote:</cite>Ok... I did not understand, does this script need to be inserted before the current commands are run?<br /><br />I guess I am not understanding this script.  When I execute it as a batch file I get several errors... Could you give me a little example of how I should be using this.<br /><br />Thank you very much for your time.<br /></div></blockquote><br /><br />you put these vbscript statements inside a file and save it as myscript.vbs (for example)<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>Set objFS = CreateObject( &quot;Scripting.FileSystemObject&quot; )<br />strFile = WScript.Arguments(0)<br />Set objFile = objFS.OpenTextFile(strFile)<br />Do Until objFile.AtEndOfStream<br />&nbsp; &nbsp;strLine= objFile.ReadLine<br />&nbsp; &nbsp; &nbsp; &nbsp; WScript.Echo strLine &amp; &quot; &quot; &amp; &quot;test&quot;<br />Loop<br />objFile.Close<br /></code></pre></div><br /><br />They are not batch commands/statements ok.?<br /><br />then on the command line : just type<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>c:\&gt; cscript //nologo myscipt.vbs file<br /></code></pre></div><br /><br />If you want to put the command into a batch file, just open another new file using wordpad or your favourite editor, type the cscript command in and save as mybatch.bat. Simple as that.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Insert text into column b csv file</h3>
				<div class="date">Posted: <strong>31 Aug 2011 01:27</strong></div>
				<div class="author">by <strong>trebor68</strong></div>
				<div class="content">In the block &quot;:eingabe&quot; you can define routines as you want to do it. I've done through the command <strong class="text-strong">if</strong> input for B2 as an empty field.<br /><br />Here for all cell B1 to B4<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&nbsp;....<br /><br />:eingabe<br />set &quot;newcell=&quot;<br /><br />set /p newcell=Value for row %1:<br />if !newcell!#==# set newcell=B%1<br /><br />goto :eof</code></pre></div><br /><br />To understand the word &quot;Eingabe&quot; is German in English &quot;Input&quot;.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Insert text into column b csv file</h3>
				<div class="date">Posted: <strong>31 Aug 2011 02:43</strong></div>
				<div class="author">by <strong>trebor68</strong></div>
				<div class="content">Here the code for input 10 value for a row.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />setlocal ENABLEEXTENSIONS ENABLEDELAYEDEXPANSION<br />set dat=TestFile.csv<br />::<br />cls<br />echo.<br />echo&nbsp; Input the value for ten fields for any row.<br />echo.<br />:input<br />echo.<br />for /l %%a in (1,1,10) do set &quot;cell%%a=&quot;<br /><br />set /p cell1= Input the date: <br />if %cell1%#==t# set cell1=%date%<br />if %cell1%#==T# set cell1=%date%<br /><br />set /p cell2= Input the time: <br /><br />set /p cell3= Input the persons name: <br />set /p cell4= Input the address: <br />set /p cell5= Input the zip-code: <br />set /p cell6= Input field 6: <br />set /p cell7= Input field 7: <br />set /p cell8= Input field 8: <br />set /p cell9= Input field 9: <br />set /p cell10= Input field 10: <br /><br />echo &quot;%cell1%&quot;,&quot;%cell2%&quot;,&quot;%cell3%&quot;,&quot;%cell4%&quot;,&quot;%cell5%&quot;,&quot;%cell6%&quot;,&quot;%cell7%&quot;,&quot;%cell8%&quot;,&quot;%cell9%&quot;,&quot;%cell10%&quot;&gt;&gt;%dat%<br /><br />echo.<br />set /p andnow= Add a line to enter? (Y/N) <br />if %andnow%#==y# goto :input<br />if %andnow%#==Y# goto :input<br /></code></pre></div><br /><br />But, why you not input this directly in a excel file.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Insert text into column b csv file</h3>
				<div class="date">Posted: <strong>31 Aug 2011 06:37</strong></div>
				<div class="author">by <strong>Ken</strong></div>
				<div class="content">Thank you Trebor68 for all your help... The code for input 10 value is GREAT!!!, but what I need is to skip Columns A and B which already have a (Date - Column A) and a (Time - Column B) in them.  So in (Column C) other people would enter Name, (Column D) address, (Column E) zipcode etc... Up to 10 fields going across the columns.  They only need to enter one set of (fields) at a time then be asked if they want to enter another using the next date.<br /><br />Example of what I am trying to do<br />(col A) ,   (col B) &lt;-- Already there <br />8/29/2011 08:30 <br />(col C - Name),(col D - Address),(col E - City),(col F - Zipcode) etc...<br />     Ken    ,       1234 Smith St   ,    Dallas      ,      75235         etc...<br /><br />From Batch -- Input another Y or N - If they choose Y it would fall on the next line in (Column C) Enter Name... etc<br /><br />Thank You again.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Insert text into column b csv file</h3>
				<div class="date">Posted: <strong>01 Sep 2011 05:31</strong></div>
				<div class="author">by <strong>trebor68</strong></div>
				<div class="content">Bevor you will start this batch, make a file &quot;TestFile.csv&quot; with value in column A and B.<br />Here a example:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&quot;8/29/2011&quot;,&quot;08:30&quot; <br />&quot;8/29/2011&quot;,&quot;09:30&quot; <br />&quot;8/29/2011&quot;,&quot;10:30&quot; </code></pre></div><br /><br />Here the solution:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />cls<br />setlocal ENABLEEXTENSIONS ENABLEDELAYEDEXPANSION<br />set dat=TestFile.csv<br />set tmpdat=TestFile2.csv<br />if not exist %dat% goto :error1<br />set row=0<br />set eing=n<br />::<br />for /f &quot;tokens=1,2* delims=,&quot; %%d in (%dat%) do (<br />&nbsp; for /l %%s in (3,1,10) do set cell%%s=&quot;&quot;<br />&nbsp; set cell1=%%d<br />&nbsp; set cell2=%%e<br />&nbsp; set /a row+=1<br />&nbsp; set help=0<br />&nbsp; if %%f#==# set /a help+=1<br />&nbsp; if %%f==&quot;&quot; set /a help+=1<br />&nbsp; if !eing!==y set help=0<br />&nbsp; if not !help!==0 (<br />&nbsp; &nbsp; call :input !row! %%d %%e<br />&nbsp; &nbsp; echo %%d,%%e,&quot;!cell3!&quot;,&quot;!cell4!&quot;,&quot;!cell5!&quot;,&quot;!cell6!&quot;,&quot;!cell7!&quot;,&quot;!cell8!&quot;,&quot;!cell9!&quot;,&quot;!cell10!&quot;&gt;&gt;%tmpdat%<br />&nbsp; &nbsp; set eing=y<br />&nbsp; ) else echo %%d,%%e,%%f&gt;&gt;%tmpdat%<br />)<br />del %dat%<br />ren %tmpdat% %dat%<br />goto :eof<br />::<br />:error1<br />echo.<br />echo ERROR - File %dat% is not exist.<br />goto :eof<br />:input<br />echo&nbsp; Date: %~2&nbsp; &nbsp; Time: %~3<br />set /p &quot;cell3=Name&nbsp; &nbsp; : &quot;<br />set /p &quot;cell4=Address : &quot;<br />set /p &quot;cell5=City&nbsp; &nbsp; : &quot;<br />set /p &quot;cell6=ZIP-code: &quot;<br />set /p &quot;cell7= value7 : &quot;<br />set /p &quot;cell8= value8 : &quot;<br />set /p &quot;cell9= value9 : &quot;<br />set /p &quot;cell10= value10 : &quot;<br />for /l %%t in (3,1,10) do if !cell%%t!==&quot;&quot; set &quot;cell%%t=&quot;<br />goto :eof</code></pre></div></div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="UTC-6">UTC-06:00</span><br />Page <strong>1</strong> of <strong>2</strong></div>
		<div class="copyright">Powered by phpBB&reg; Forum Software &copy; phpBB Limited<br />https://www.phpbb.com/</div>
	</div>
</div>

</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=2167&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 09:14:28 GMT -->
</html>
