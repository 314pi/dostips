<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=6625 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 06:01:02 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>Batch-BGI: A *standard* graphics library for Batch files! - DosTips.com</title>


	<link rel="canonical" href="viewtopic57b9.html?t=6625">

<!--
	phpBB style name: Allan Style - SUBSILVER
	Based on style:   prosilver (this is the default phpBB3 style)
	Based on style:   subsilver2 (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:  Allan ( http://x-tk.ru/ )
-->

<link href="assets/css/font-awesome.mind772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/stylesheetd772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/en/stylesheetd772.css?assets_version=34" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="./styles/AllanStyle-SUBSILVER/theme/tweaks.css?assets_version=34" rel="stylesheet">
<![endif]-->




<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','../../www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-280191-1', 'auto');
	ga('send', 'pageview');
</script>

</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">

<div id="header-subsilver">
	<a id="top" class="top-anchor" accesskey="t"></a>
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description" class="site-description">
				<a id="logo" class="logo" href="../index.html" title="DosTips.com"><span class="site_logo"></span></a>
				<h1>DosTips.com</h1>
				<p>A Forum all about DOS Batch</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

									<div id="search-box" class="search-box search-header" role="search">
				<form action="https://www.dostips.com/forum/search.php" method="get" id="search">
				<fieldset>
					<input name="keywords" id="keywords" type="search" maxlength="128" title="Search for keywords" class="inputbox search tiny" size="20" value="" placeholder="Search…" />
					<button class="button button-search" type="submit" title="Search">
						<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
					</button>
					<a href="search.html" class="button button-search-end" title="Advanced search">
						<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
					</a>
					
				</fieldset>
				</form>
			</div>
						
			</div>
					</div>
</div>


<div id="wrap" class="wrap">
	<div id="page-header">
				<div class="navbar-top" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
																									<li>
								<a href="search33a7.html?search_id=unanswered" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="search526f.html?search_id=active_topics" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-blue" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="search.html" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
											<li class="separator"></li>
																			<li>
								<a href="memberlist4bfd.html?mode=team" role="menuitem">
									<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
								</a>
							</li>
																<li class="separator"></li>

									</ul>
			</div>
		</li>

				<li data-skip-responsive="true">
			<a href="app.php/help/faq.html" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
						
			<li class="rightside"  data-skip-responsive="true">
			<a href="ucp26c3.html?mode=login" title="Login" accesskey="x" role="menuitem">
				<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Login</span>
			</a>
		</li>
					<li class="rightside" data-skip-responsive="true">
				<a href="ucp8319.html?mode=register" role="menuitem">
					<i class="icon fa-pencil-square-o  fa-fw" aria-hidden="true"></i><span>Register</span>
				</a>
			</li>
						</ul>

	</div>
</div>

<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
						<li class="breadcrumbs">
							<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="../index.html" itemprop="url" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span itemprop="title">DosTips.com</span></a></span>
										<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="index.html" itemprop="url" accesskey="h" data-navbar-reference="index"><span itemprop="title">Board index</span></a></span>

											<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="4"><a href="viewforum31e6.html?f=4" itemprop="url"><span itemprop="title">DosTips - Dos Batch</span></a></span>
															<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="3"><a href="viewforum4d6b.html?f=3" itemprop="url"><span itemprop="title">DOS Batch Forum</span></a></span>
												</li>
		
					<li class="rightside responsive-search">
				<a href="search.html" title="View the advanced search options" role="menuitem">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</a>
			</li>
			</ul>

	</div>
</div>

<div class="navbar-top-link">
	<div class="inner">
		<ul>
			<li class="navbar-top-link-left"><a href="search33a7.html?search_id=unanswered">Unanswered topics</a></li>
			<li class="navbar-top-link-left"><a href="search526f.html?search_id=active_topics">Active topics</a></li>

											</ul>
	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
		
<h2 class="topic-title"><a href="viewtopic3168.html?f=3&amp;t=6625">Batch-BGI: A *standard* graphics library for Batch files!</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">Discussion forum for all Windows batch related topics.<br /></div>
<p>
	<strong>Moderator:</strong> <a href="memberlista6a8.html?mode=viewprofile&amp;u=5" class="username">DosItHelp</a>
</p>


<div class="action-bar bar-top">
	
			<a href="posting633b.html?mode=reply&amp;f=3&amp;t=6625" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic569f.html?f=3&amp;t=6625&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="https://www.dostips.com/forum/search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topic…" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="search.html" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="6625" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			1 post
							&bull; Page <strong>1</strong> of <strong>1</strong>
					</div>
		</div>




<div id="subsilver-nav-topic">
	<div class="inner"><div class="post has-profile">
		<div class="leftsided postbody subsilver-topic-title">Message</div>
		<div class="leftsided postprofile subsilver-topic-author">Author</div>
	</div></div>
</div>

			<div id="p42617" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile42617">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchdc63.html?author_id=2923&amp;sr=posts">1540</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 06 Dec 2011 22:15</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> México City, México</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content42617">

						<h3 class="first"><a href="#p42617">Batch-BGI: A *standard* graphics library for Batch files!</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingcc70.html?mode=quote&amp;f=3&amp;p=42617" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic074a.html?p=42617#p42617" onclick="prompt('Message #1',this.href); return false;">#1</a></span> 
									<a class="unread" href="viewtopic074a.html?p=42617#p42617" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a></strong> &raquo; </span>23 Aug 2015 22:32
			</p>
			
			
			
			<div class="content">After developed the method described at <a href="viewtopicda13.html?f=3&amp;t=6594" class="postlink">Drawing HTA &quot;canvas&quot; graphics in Batch files</a>, the next step is to use such canvas tag capabilities to programatically draw graphics in a Batch file emulating the mechanism provided in old programming languages. This point requires to define a graphics interface that can be used in a Batch file in a simpler way than the canvas syntax. I choosen Borland Graphics Interface (BGI), the graphics standard developed by Borland more than 25 years ago for its series of programming languages (Turbo-Pascal, Turbo-C, etc). This selection allows to translate existent Turbo-Pascal and Turbo-C graphing programs into a Batch file in a direct way. Of course, when a BGI feature can not be emulated via canvas tag capabilities (like floodfill), such feature will not be implemented in the Batch-BGI library.<br /><br />Below is a preliminary working version of &quot;Batch-BGI&quot; graphics library for Batch files. Note that this is work in progress, so several BGI functions are not yet implemented and there are some values that needs to be defined before they can be implemented, like all the styles used in lines, fills and text, etc.<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&quot;Batch-BGI&quot; Borland Graphics Interface library for Windows Batch files<br />Written by Antonio Perez Ayala aka Aacini<br /><br />BGI Reference: http://www.cs.colorado.edu/~main/bgi/doc/<br />Canvas Reference: http://www.w3schools.com/tags/ref_canvas.asp<br /><br />2015/08/23 - Version 0.1 (preliminary)<br />&nbsp; &nbsp; - Several BGI functions are under development or research; see individual notes below.<br />&nbsp; &nbsp; - Most &quot;BGI for Windows&quot; &#91;WIN&#93; functions will not be developed, and a few were/will be modified.<br /><br />----------------------------------------------------------------------<br /><br />All numeric parameters for Batch-BGI subroutines must be constants or JScript expressions over constants. Note<br />that commas, semicolons and equal-signs may be used to separate parameters in Batch subroutines and are optional.<br />When an expression may include separators or special Batch characters, it must be enclosed in quotes:<br />set /A x=100, y=100, r=90<br />call :arc x, y, 0, 360, r&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- Wrong (x, y and r are *variables*)<br />call :arc %x%, %y%, 0, 360, %r%&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- Correct (their values are constants)<br />call :arc %x% %y% 0 360 Math.min(%x%,%y%)-10&nbsp; &nbsp; &nbsp; &nbsp; - Wrong, the comma separate Batch parameters<br />call :arc %x% %y% 0 360 &quot;Math.min(%x%,%y%)-10&quot;&nbsp; &nbsp; &nbsp; - Correct<br />call :setfillstyle SOLID_FILL RED&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- Wrong<br />call :setfillstyle %SOLID_FILL% %RED%&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- Correct<br />call :setfillstyle = %SOLID_FILL%, %RED%;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- Correct<br />The only subroutines that accept BGI names in the parameters are initgraph and closegraph.<br /><br />All Batch-BGI subroutines with &quot;getvalue&quot; name just return the value of the corresponding<br />variable called &quot;_value&quot;, so you may directly use it. For example, instead of:<br />&nbsp; &nbsp;call :getmaxx width=<br />&nbsp; &nbsp;call :getmaxy height=<br />&nbsp; &nbsp;set /A midX = width / 2, midY = height / 2<br />you may directly do this:<br />&nbsp; &nbsp;set /A midX = _maxx / 2, midY = _maxy / 2<br /><br />======================================================================<br /><br />:arc x y stangle endangle radius<br />echo ctx.beginPath();ctx.arc(%~1,%~2,%~5,(360-(%~3))*Math.PI/180,(360-(%~4))*Math.PI/180,true);ctx.stroke(); &gt;&amp;3<br />goto refresh<br /><br />======================================================================<br /><br />:bar left top right bottom<br />echo ctx.fillRect(%~1,%~2,(%~3)-(%~1),(%~4)-(%~2)); &gt;&amp;3<br />goto refresh<br /><br />======================================================================<br /><br />depth and topflag are optional parameters and must be constants, not expressions.<br /><br />:bar3d left top right bottom &#91;depth &#91;topflag&#93;&#93;<br />echo ctx.beginPath();ctx.rect(%~1,%~2,(%~3)-(%~1),(%~4)-(%~2)); &gt;&amp;3<br />if &quot;%5&quot; equ &quot;&quot; (goto endbar3d) else if &quot;%5&quot; equ &quot;0&quot; goto endbar3d<br />&nbsp; &nbsp;echo ctx.moveTo(%~3,%~4);ctx.lineTo((%~3)+(%~5),(%~4)-(%~5));ctx.lineTo((%~3)+(%~5),(%~2)-(%~5));ctx.lineTo(%~3,%~2); &gt;&amp;3<br />&nbsp; &nbsp;if &quot;%6&quot; equ &quot;&quot; (goto endbar3d1) else if &quot;%6&quot; equ &quot;0&quot; goto endbar3d1<br />&nbsp; &nbsp; &nbsp; echo ctx.lineTo((%~3)+(%~5),(%~2)-(%~5));ctx.lineTo((%~1)+(%~5),(%~2)-(%~5));ctx.lineTo(%~1,%~2);ctx.lineTo(%~3,%~2); &gt;&amp;3<br />&nbsp; &nbsp;:endbar3d1<br />:endbar3d<br />echo ctx.fill();ctx.stroke(); &gt;&amp;3<br />goto refresh<br /><br />======================================================================<br /><br />:circle x y radius<br />echo ctx.beginPath();ctx.arc(%~1,%~2,%~3,0,2*Math.PI);ctx.stroke(); &gt;&amp;3<br />goto refresh<br /><br />=======================================================================<br /><br />:cleardevice<br />echo ctx.clearRect(0,0,canvas.width,canvas.height); &gt;&amp;3<br />goto refresh<br /><br />=======================================================================<br /><br />void clearviewport (void);<br />Under development<br /><br />=======================================================================<br /><br />closegraph &#91;pagenum|CURRENT_WINDOW|ALL_WINDOWS|KEEP_CURRENT_WINDOW|KEEP_ALL_WINDOWS&#93;<br /><br />Closes the graphics system and all graphics windows. This function has an optional parameter which is the page<br />number (given to initwindow when the window was created) of the window that is to be closed. This parameter may<br />also be one of these words: CURRENT_WINDOW (causing closegraph to close only the current window), or ALL_WINDOWS<br />(which is the default, causing closegraph to close all open graphics windows). If the current window is closed,<br />then there is no longer a current window and no further drawing operations may be done until a new window is<br />created via initgraph/initwindow or an existent window page is activated by calling setactivepage.<br /><br />The parameter may also be KEEP_CURRENT_WINDOW or KEEP_ALL_WINDOWS that close the access to current or all<br />windows, respectively, but keep the windows open; in this case the user must manually close the windows.<br />All Batch-BGI programs must always call closegraph before terminate.<br /><br />closegraph function body was moved to the end of this file<br /><br />=======================================================================<br /><br />:converttorgb color rgb=<br />setlocal EnableDelayedExpansion<br />endlocal &amp; set &quot;%2=!p%1!&quot;<br />exit /B<br /><br />=======================================================================<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;void delay (int millisec); &#91;WIN&#93;<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;void detectgraph (int *graphdriver, int *graphmode);<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;void drawpoly (int numpoints, int *polypoints);<br /><br />=======================================================================<br /><br />void ellipse (int x, int y, int stangle, int endangle, int xradius, int yradius);<br />Under development<br /><br />=======================================================================<br /><br />void fillellipse (int x, int y, int xradius, int yradius);<br />Under development<br /><br />=======================================================================<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;void fillpoly (int numpoints, int *polypoints);<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;void floodfill (int x, int y, int border);<br /><br />=======================================================================<br /><br />:getactivepage activepage=<br />set &quot;%~1=%_activepage%&quot;<br />exit /B<br /><br />=======================================================================<br /><br />void getarccoords (struct arccoordstype *arccoords);<br />Under development<br /><br />=======================================================================<br /><br />:getaspectratio xasp= yasp=<br />set /A &quot;%~1=1, %~2=1&quot;<br />exit /B<br /><br />=======================================================================<br /><br />:getbkcolor bkcolor=<br />set &quot;%~1=%_bkcolor%&quot;<br />exit /B<br /><br />=======================================================================<br /><br />:getcolor color=<br />set &quot;%~1=%_color%&quot;<br />exit /B<br /><br />=======================================================================<br /><br />:getdefaultpalette defaultpalette=<br />set &quot;%~1=%_defaultpalette%&quot;<br />exit /B<br /><br />=======================================================================<br /><br />:getdrivername drivername=<br />set &quot;%~1=%_drivername%&quot;<br />exit /B<br /><br />=======================================================================<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;void getfillpattern (char *pattern); <br /><br />=======================================================================<br /><br />:getfillsettings struct_fillsettingstype=<br />set /A &quot;%~1.pattern=_fillpattern, %~1.color=_fillcolor&quot;<br />exit /B<br /><br />=======================================================================<br /><br />:getgraphmode graphmode=<br />set &quot;%~1=%_graphmode%&quot;<br />set /B<br /><br />=======================================================================<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;void getimage (int left, int top, int right, int bottom, void *bitmap);<br /><br />=======================================================================<br /><br />:getlinesettings struct_linesettingstype=<br />set /A &quot;%~1.linestyle=_linestyle, %~1.upattern=_upattern, %~1.thickness=_thickness&quot;<br />exit /B<br /><br />=======================================================================<br /><br />:getmaxcolor maxcolor=<br />set &quot;%~1=%_maxcolor%&quot;<br />exit /B<br /><br />=======================================================================<br /><br />:getmaxmode maxmode=<br />set &quot;%~1=%_himode%&quot;<br />exit /B<br /><br />=======================================================================<br /><br />:getmaxx maxx=<br />set &quot;%~1=%_maxx%&quot;<br />exit /B<br /><br />=======================================================================<br /><br />:getmaxy maxy=<br />set &quot;%~1=%_maxy%&quot;<br />exit /B<br /><br />=======================================================================<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; char* getmodename (int mode_number);<br /><br />=======================================================================<br /><br />:getmoderange dummydriver lomode= himode=<br />set /A &quot;%2=_lomode, %3=_himode&quot;<br />exit /B<br /><br />=======================================================================<br /><br />Return the current values in &quot;p#&quot; palette array as a list; this will fail if the result<br />is larger than 8191 chars, that is, when the palette contain more than 1023 colors<br /><br />:getpalette palette=<br />setlocal EnableDelayedExpansion<br />set &quot;p=&quot;<br />for /L %%i in (0,1,%_maxcolor%) do set &quot;p=!p! !p%%i!&quot;<br />endlocal &amp; set &quot;%~1=%p:~1%<br />exit /B<br /><br />=======================================================================<br /><br />:getpalettesize palettesize=<br />set &quot;%~1=%_palettesize%&quot;<br />exit /B<br /><br />=======================================================================<br />int getpixel (int x, int y);<br />Not implemented<br />=======================================================================<br /><br />:gettextsettings struct_textsettingstype=<br />set /A &quot;%~1.font=_font, %~1.direction=_direction, %~1.charsize=_charsize, %~1.horiz=_horiz, %~1.vert=_vert&quot;<br />exit /B<br /><br />=======================================================================<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;void getviewsettings (struct viewporttype *viewport);<br /><br />=======================================================================<br /><br />:getvisualpage visualpage=<br />set &quot;%~1=_visualpage%&quot;<br />exit /B<br /><br />=======================================================================<br />int getwindowheight (void); &#91;WIN&#93;<br />Not implemented<br />=======================================================================<br />int getwindowwidth (void); &#91;WIN&#93;<br />Not implemented<br />=======================================================================<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; int getx (void);<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; int gety (void);<br /><br />=======================================================================<br />char* grapherrormsg (int errorcode);<br />Not implemented<br />=======================================================================<br />int graphresult(void);<br />Not implemented<br />=======================================================================<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;unsigned imagesize (int left, int top, int right, int bottom);<br /><br />=======================================================================<br /><br />initgraph graphdriver graphmode<br /><br />Initializes the graphics system, open the graphics window and resets all graphics settings to their defaults.<br />The graphdriver parameter must be one of these *words* (a number is NOT valid here):<br />DETECT, CGA, MCGA, EGA, EGA64, EGAMONO, IBM8514, HERCMONO, ATT400, VGA, PC3270.<br />If the first parameter is DETECT, the initwindow subroutine with no parameters is called instead;<br />otherwise, the second parameter must be one of the words given below as described at:<br />http://www.cs.colorado.edu/~main/bgi/doc/initgraph.html<br />(CGAC0, CGAC1, CGAC2, CGAC3, CGAHI)&nbsp; (MCGAC0, MCGAC1, MCGAC2, MCGAC3, MCGAMED, MCGAHI)<br />(EGALO, EGAHI)&nbsp; (EGA64LO, EGA64HI)&nbsp; (EGAMONOHI)&nbsp; (IBM8514LO, IBM8514HI)&nbsp; (HERCMONOHI)<br />(ATT400C0, ATT400C1, ATT400C2, ATT400C3, ATT400MED, ATT400HI)&nbsp; (VGALO, VGAMED, VGAHI)&nbsp; (PC3270HI)<br />This subroutine does NOT return any value; use getdrivername, getgraphmode and getmoderange instead.<br /><br />As a (preferred) alternative, the user may call initwindow instead of initgraph.<br /><br />The initgraph function body was moved to the end of this file<br /><br />=======================================================================<br /><br />initwindow&nbsp; width=640&nbsp; height=480&nbsp; title=&quot;Batch-BGI&quot;&nbsp; left=-1&nbsp; top=-1&nbsp; page=0<br /><br />This function initializes the graphics system by opening a graphics window.<br />All parameters are optional; the parameters and their default values are listed in the line above.<br />The width and height parameters specify the size of the graphics window area in pixels.<br />The title parameter is the title that will be printed at the top of the window.<br />The left and top parameters determine the screen coordinates of the left and top sides of the window;<br />a value less than zero (the default) indicate to let the system place the window.<br />The page parameter is the page number of the created window (&quot;window page&quot;) that will be used in<br />setactivepage/setvisualpage subroutines in order to set which of several windows is currently being<br />used. You may choose any numbers you wish; all created windows should have different page numbers.<br />Immediately after calling initwindow, the current window is always the window that was just created. <br /><br />The initgraph function body was moved to the end of this file<br /><br />=======================================================================<br />int installuserdriver (char *name, int huge (*detect)(void)); <br />Not implemented<br />=======================================================================<br />int installuserfont (char *name); <br />Not implemented<br />=======================================================================<br /><br />:line x1 y1 x2 y2<br />echo ctx.beginPath();ctx.moveTo(%~1,%~2);ctx.lineTo(%~3,%~4);ctx.stroke(); &gt;&amp;3<br />goto refresh<br /><br />=======================================================================<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;void linerel (int dx, int dy);<br /><br />=======================================================================<br /><br />:lineto x y<br />echo ctx.lineTo(%~1,%~2);ctx.stroke(); &gt;&amp;3<br />goto refresh<br /><br />=======================================================================<br />int mousex (void); &#91;WIN&#93;<br />Not implemented<br />=======================================================================<br />int mousey (void); &#91;WIN&#93;<br />Not implemented<br />=======================================================================<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;void moverel (int dx, int dy);<br /><br />=======================================================================<br /><br />:moveto x y<br />echo ctx.beginPath();ctx.moveTo(%~1,%~2); &gt;&amp;3<br />exit /B<br /><br />=======================================================================<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;void outtext (char *textstring);<br /><br />=======================================================================<br /><br />To do: separate text color from lines color, and then use strokeText instead of fillText<br /><br />:outtextxy x y &quot;textstring&quot;<br />echo ctx.fillText(&quot;%~3&quot;,%~1,%~2); &gt;&amp;3<br />goto refresh<br /><br />=======================================================================<br /><br />:pieslice x y stangle endangle radius<br />echo ctx.beginPath();ctx.arc(%~1,%~2,%~5,(360-(%~3))*Math.PI/180,(360-(%~4))*Math/180.PI,true);ctx.lineTo(%~1,%~2);ctx.closePath();ctx.fill(); &gt;&amp;3<br />exit /B<br /><br />=======================================================================<br /><br />void putimage (int left, int top, void *bitmap, int op);<br />Under research<br /><br />=======================================================================<br /><br />void putpixel (int x, int y, int color);<br />Under research<br /><br />=======================================================================<br /><br />&nbsp; &nbsp; void readimagefile (const char* filename=NULL,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; int left=0, int top=0, int right=INT_MAX, int bottom=INT_MAX);<br /><br />=======================================================================<br /><br />:rectangle left top right bottom<br />echo ctx.beginPath();ctx.rect(%~1,%~2,(%~3)-(%~1),(%~4)-(%~2));ctx.stroke(); &gt;&amp;3<br />goto refresh<br /><br />=======================================================================<br />int registerbgidriver (void (*driver)(void));<br />Not implemented<br />=======================================================================<br />int registerbgifont (void (*font)(void));<br />Not implemented<br />=======================================================================<br />:restorecrtmode<br />exit /B<br />Do nothing function<br />=======================================================================<br /><br />void sector (int x, int y, int stangle, int endangle, int xradius, int yradius);<br />Under development<br /><br />=======================================================================<br /><br />setactivepage makes page the active graphics window page.<br />All subsequent graphics output will be directed to that graphics window page.<br />If screen refresh is suspended via call :setvisualpage -1, the commands directed<br />to all window pages (via pipes) will be read until screen refresh is resumed.<br /><br />To do: multiple &quot;window pages&quot; management is not fully implemented...<br /><br />:setactivepage page<br />if defined _maxx&#91;%~1&#93; (<br />&nbsp; &nbsp;set &quot;_activepage=%~1&quot;<br />&nbsp; &nbsp;echo eval(&quot;activepage=%~1&quot;); &gt;&amp;3<br />&nbsp; &nbsp;set /A &quot;_maxx=_maxx&#91;%~1&#93;, _maxy=_maxy&#91;%~1&#93;&quot;<br />)<br />exit /B<br /><br />=======================================================================<br /><br />setallpalette color0 color1 ... colorN<br /><br />Each parameter of setallpalette must be an HTML color given as standard name or in #RRGGBB format.<br />The palette can contain *any number* of colors, that will be used via their 0..(palettesize-1) numbers.<br />A maximum of 395 colors can be given to this subroutine, but any number of colors may be defined via<br />direct Batch code. Another method to show many different colors is use a palette with less colors<br />(i.e. the default 16) and for each different color modify a palette entry via setrgbpalette and use it.<br />In Batch-BGI library, when the palette is changed the colors shown on the screen are *NOT* changed.<br /><br />setallpalette subroutine body was moved to the end of this file<br /><br />Below there are three extra Batch-BGI subroutines that create standard palettes.<br /><br />Create a 256 colors palette with even distribution (expand one byte to three)<br /><br />:get256palette palette=<br />setlocal EnableDelayedExpansion<br />set &quot;hexa=0123456789ABCDEF&quot;<br />set &quot;p=&quot;<br />set i=0<br />for /L %%r in (0,1,7) do (<br />&nbsp; &nbsp;set /A &quot;RR=%%r*36, RH=RR&gt;&gt;4, RL=RR&amp;15&quot;<br />&nbsp; &nbsp;for /F &quot;tokens=1,2&quot; %%i in (&quot;!RH! !RL!&quot;) do set &quot;RR=!hexa:~%%i,1!!hexa:~%%j,1!&quot;<br />&nbsp; &nbsp;for /L %%g in (0,1,7) do (<br />&nbsp; &nbsp; &nbsp; set /A &quot;GG=%%g*36, GH=GG&gt;&gt;4, GL=GG&amp;15&quot;<br />&nbsp; &nbsp; &nbsp; for /F &quot;tokens=1,2&quot; %%i in (&quot;!GH! !GL!&quot;) do set &quot;GG=!hexa:~%%i,1!!hexa:~%%j,1!&quot;<br />&nbsp; &nbsp; &nbsp; for /L %%b in (0,2,6) do (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set /A &quot;BB=%%b*36, BH=BB&gt;&gt;4, BL=BB&amp;15&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for /F &quot;tokens=1,2&quot; %%i in (&quot;!BH! !BL!&quot;) do set &quot;BB=!hexa:~%%i,1!!hexa:~%%j,1!&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set &quot;p=!p! #!RR!!GG!!BB!&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set /A i+=1<br />&nbsp; &nbsp; &nbsp; )<br />&nbsp; &nbsp;)<br />)<br />endlocal &amp; set &quot;%~1=%p:~1%&quot;<br />exit /B<br /><br />Create the standard &quot;Web Safe Color&quot; palette (6x6x6 Cube) with 216 colors<br /><br />:get6x6x6palette palette=<br />setlocal EnableDelayedExpansion<br />set &quot;p=&quot;<br />set &quot;i=0&quot;<br />for %%r in (00 33 66 99 CC FF) do (<br />&nbsp; &nbsp;for %%g in (00 33 66 99 CC FF) do (<br />&nbsp; &nbsp; &nbsp; for %%b in (00 33 66 99 CC FF) do (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set &quot;p=!p! #%%r%%g%%b&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set /A i+=1<br />&nbsp; &nbsp; &nbsp; )<br />&nbsp; &nbsp;)<br />)<br />endlocal &amp; set &quot;%~1=%p:~1%&quot;<br />exit /B<br /><br />Create the 256 gray shades Black&amp;White palette<br /><br />:get256BWpalette palette=<br />setlocal EnableDelayedExpansion<br />set &quot;p=&quot;<br />set &quot;i=0&quot;<br />for %%h in (0 1 2 3 4 5 6 7 8 9 A B C D E F) do (<br />&nbsp; &nbsp;for %%l in (0 1 2 3 4 5 6 7 8 9 A B C D E F) do (<br />&nbsp; &nbsp; &nbsp; set &quot;p=!p! #%%h%%l%%h%%l%%h%%l&quot;<br />&nbsp; &nbsp; &nbsp; set /A i+=1<br />&nbsp; &nbsp;)<br />)<br />endlocal &amp; set &quot;%~1=%p:~1%&quot;<br />exit /B<br /><br />=======================================================================<br />void setaspectratio (int xasp, int yasp);<br />Not implemented<br />=======================================================================<br /><br />:setbkcolor color<br />set &quot;_bkcolor=%~1&quot;<br />call echo document.body.style.background=&quot;%%p%~1%%&quot;; &gt;&amp;3<br />goto refresh<br /><br />=======================================================================<br /><br />:setcolor color<br />set &quot;_color=%~1&quot;<br />call echo ctx.strokeStyle=&quot;%%p%~1%%&quot;; &gt;&amp;3<br />exit /B<br /><br />=======================================================================<br /><br />void setfillpattern (char *upattern, int color); <br />Under research<br /><br />=======================================================================<br /><br />To do: define fill patterns via ctx.fillStyle=ctx.createPattern(img,&quot;repeat&quot;);<br />Predefined Batch variables: EMPTY_FILL, SOLID_FILL, LINE_FILL, LTSLASH_FILL, SLASH_FILL, BKSLASH_FILL,<br />LTBKSLASH_FILL, HATCH_FILL, XHATCH_FILL, INTERLEAVE_FILL, WIDE_DOT_FILL and CLOSE_DOT_FILL;<br /><br />:setfillstyle pattern, color<br />set /A &quot;_fillpattern=%~1, _fillcolor=%~2&quot;<br />call echo ctx.fillStyle=&quot;%%p%~2%%&quot;; &gt;&amp;3<br />exit /B<br /><br />=======================================================================<br />unsigned setgraphbufsize (unsigned bufsize); <br />Not implemented<br />=======================================================================<br />:setgraphmode (int mode); <br />exit /B<br />Do nothing function<br />=======================================================================<br /><br />To do: define line patterns via ctx.strokeStyle=ctx.createPattern(img,&quot;repeat&quot;);<br />Predefined Batch variables: SOLID_LINE, DOTTED_LINE, CENTER_LINE and DASHED_LINE;<br />NORM_WIDTH (1) and THICK_WIDTH (3). thickness parameter may be any value.<br /><br />:setlinestyle linestyle upattern thickness<br />set /A &quot;_linestyle=%~1, _upattern=%~2, _thickness=%~3&quot;<br />echo ctx.lineWidth=%~3; &gt;&amp;3<br />exit /b<br /><br />=======================================================================<br /><br />:setpalette colornum color<br />set &quot;p%1=%~2&quot;<br />exit /B<br /><br />=======================================================================<br /><br />:setrgbpalette colornum red green blue<br />setlocal EnableDelayedExpansion<br />set &quot;hexa=0123456789ABCDEF&quot;<br />set &quot;rgb=#&quot;<br />for %%a in (%~2 %~3 %~4) do (<br />&nbsp; &nbsp;set /A &quot;H=%%a &gt;&gt; 4, L=%%a &amp; 15&quot;<br />&nbsp; &nbsp;for /F &quot;tokens=1,2&quot; %%i in (&quot;!H! !L!&quot;) do set &quot;rgb=!rgb!!hexa:~%%i,1!!hexa:~%%j,1!&quot;<br />)<br />endlocal &amp; set &quot;p%~1=%rgb%&quot;<br />exit /B<br /><br />=======================================================================<br /><br />set /A LEFT_TEXT=0, CENTER_TEXT=1, RIGHT_TEXT=2,&nbsp; BOTTOM_TEXT=0, TOP_TEXT=2<br /><br />:settextjustify horiz vert<br />set /A &quot;_horiz=%~1, _vert=%~2, _i=_horiz+1, _j=_vert+1&quot;<br />for /F &quot;tokens=%_i%&quot; %%a in (&quot;left center right&quot;) do echo ctx.textAlign=&quot;%%a&quot;; &gt;&amp;3<br />for /F &quot;tokens=%_j%&quot; %%a in (&quot;bottom middle top&quot;) do echo ctx.textBaseline=&quot;%%a&quot;; &gt;&amp;3<br />exit /B<br /><br />=======================================================================<br /><br />http://www.w3schools.com/tags/canvas_font.asp<br /><br />set /A &quot;DEFAULT_FONT=0, TRIPLEX_FONT=1, SMALL_FONT=2, SANS_SERIF_FONT=3, GOTHIC_FONT=4, SCRIPT_FONT=5&quot;<br />set /A &quot;SIMPLEX_FONT=6, TRIPLEX_SCR_FONT=7, COMPLEX_FONT=8, EUROPEAN_FONT=9, BOLD_FONT=10&quot;<br /><br />Default values: _font=&quot;sans-serif&quot; _charsize=10 (direction=0 ALWAYS)<br />To do: find a better match between BGI predefined fonts and existent Windows fonts<br /><br />:settextstyle font direction charsize<br />set /A &quot;_font=%~1, _direction=%~2, _charsize=%~3&quot;<br />setlocal EnableDelayedExpansion<br />set &quot;i=0&quot;<br />for %%a in (Monospace&nbsp; &quot;Times New Roman&quot;&nbsp; Fantasy&nbsp; sans-serif&nbsp; Helvetica&nbsp; Script<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;Comic Sans&quot;&nbsp; &nbsp; &nbsp; &nbsp;Arial&nbsp; &nbsp; Verdana&nbsp; &nbsp; &nbsp;serif&nbsp; &nbsp; &nbsp; Impact) do (<br />&nbsp; &nbsp;if &quot;!i!&quot; equ &quot;%_font%&quot; echo ctx.font=&quot;%~3px %%~a&quot;; &gt;&amp;3<br />&nbsp; &nbsp;set /A i+=1<br />)<br />endlocal<br />exit /B<br /><br />=======================================================================<br />void setusercharsize (int multx, int divx, int multy, int divy);<br />Not implemented<br />=======================================================================<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;void setviewport (int left, int top, int right, int bottom, int clip);<br /><br />=======================================================================<br /><br />setvisualpage makes page the visual graphics page.<br />If the page is set to -1 (no visual page), the screen window refresh is suspended.<br />To do: multiple &quot;window pages&quot; management is not fully implemented yet<br /><br />:setvisualpage page<br />set &quot;_visualpage=%~1&quot;<br />echo eval(&quot;visualpage=%~1&quot;); &gt;&amp;3<br />exit /B<br /><br />=======================================================================<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;void setwritemode (int mode);<br /><br />=======================================================================<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; int textheight (char *textstring);<br /><br />=======================================================================<br /><br />This is a special function that currently can only be called as a *real JScript function*, that is,<br />included in an expression. For example: call :outtextxy&nbsp; (%_maxx%-textwidth(&quot;%text%&quot;))/2&nbsp; %_maxy%/2&nbsp; &quot;%text%&quot;<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; int textwidth (&quot;textstring&quot;)<br /><br />=======================================================================<br /><br />&nbsp; &nbsp; void writeimagefile (const char* filename=NULL,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;double width_inches=7, double border_left_inches=0.75, double border_top_inches=0.75,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;int left=0, int top=0, int right=INT_MAX, int bottom=INT_MAX); &#91;WIN&#93;<br /><br />=======================================================================<br /><br />To do: multiple &quot;window pages&quot; management is not yet implemented; open just one window for now...<br /><br />:initwindow width height title left top page<br />set /A &quot;_maxx=640, _maxy=480, _left=-1, _top=-1, _page=0<br />set &quot;_title=Batch-BGI&quot;<br /><br />if &quot;%~1&quot; neq &quot;&quot; set /A &quot;_maxx=%~1, _maxy=%~2&quot;<br />shift &amp; shift<br />if &quot;%~1&quot; neq &quot;&quot; set &quot;_title=%~1&quot;<br />shift<br />if &quot;%~1&quot; neq &quot;&quot; set /A &quot;_left=%~1, _top=%~2&quot;<br />shift &amp; shift<br />if &quot;%~1&quot; neq &quot;&quot; set /A &quot;_page=%~1&quot;<br /><br />set &quot;_drivername=Batch-BGI&quot;<br />set /A &quot;_maxpage=0, _lomode=0, _himode=0, _graphmode=0&quot;<br />set /A &quot;_maxx&#91;%_page%&#93;=_maxx, _maxy&#91;%_page%&#93;=_maxy, _visualpage=_page&quot;<br />if %_page% gtr %_maxpage% &quot;set _maxpage=%_page%&quot;<br />set &quot;_defaultpalette=Black Navy Green Teal Maroon Purple Olive Silver Gray Blue Lime Aqua Red Fuchsia Yellow White&quot;<br /><br />::&nbsp; -----------------------------------------------------------------------<br /><br />rem openwindow entry point is used in both initgraph and initwindow subroutines<br />rem To do: insert &quot;nomovable&quot; property in the pages of standard video modes (EGA/VGA),<br />rem&nbsp; &nbsp; &nbsp; &nbsp; and test if this way the several pages can not be separated<br /><br />:openwindow<br />if not defined BLACK (<br />&nbsp; &nbsp;rem First window created in the system: define standard colors and palette<br />&nbsp; &nbsp;set _i=0<br />&nbsp; &nbsp;for %%a in (BLACK&nbsp; &nbsp; &nbsp;BLUE&nbsp; &nbsp; &nbsp; &nbsp;GREEN&nbsp; &nbsp; &nbsp; &nbsp;CYAN&nbsp; &nbsp; &nbsp; &nbsp;RED&nbsp; &nbsp; &nbsp; &nbsp;MAGENTA&nbsp; &nbsp; &nbsp; &nbsp;BROWN&nbsp; &nbsp;LIGHTGRAY<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DARKGRAY&nbsp; LIGHTBLUE&nbsp; LIGHTGREEN&nbsp; LIGHTCYAN&nbsp; LIGHTRED&nbsp; LIGHTMAGENTA&nbsp; YELLOW&nbsp; WHITE&nbsp; &nbsp; ) do (<br />&nbsp; &nbsp; &nbsp; set /A &quot;%%a=_i, _i+=1&quot;<br />&nbsp; &nbsp;)<br />&nbsp; &nbsp;call :setallpalette %_defaultpalette%<br />)<br /><br />echo openwindow;%_maxx%;%_maxy%;%_title%;%_left%;%_top%;%_page%; &gt;&amp;3<br />set &quot;_color=%_maxcolor%&quot;<br />call echo ctx.strokeStyle=&quot;%%p%_maxcolor%%%&quot;; &gt;&amp;3<br />set SOLID_FILL=1<br />set /A &quot;_fillpattern=SOLID_FILL, _fillcolor=_maxcolor&quot;<br />call echo ctx.fillStyle=&quot;%%p%_maxcolor%%%&quot;; &gt;&amp;3<br />set &quot;_bkcolor=0&quot;<br />goto refresh<br /><br />=======================================================================<br /><br />:setallpalette color0 color1 ... colorN<br />setlocal EnableDelayedExpansion<br />set &quot;p=&quot;<br />set &quot;i=0&quot;<br />for %%a in (%*) do (<br />&nbsp; &nbsp;set &quot;p=!p!&amp; set &quot;p!i!=%%a&quot; &quot;<br />&nbsp; &nbsp;set /A i+=1<br />)<br />endlocal &amp; set &quot;_palettesize=%i%&quot; &amp; %p:~1%<br />set /A &quot;_maxcolor=_palettesize-1&quot;<br />exit /B<br /><br />=======================================================================<br /><br />To do: several &quot;window pages&quot; management is not yet implemented, just KEEP_CURRENT_WINDOW parameter<br /><br />:closegraph &#91;pagenum|CURRENT_WINDOW|ALL_WINDOWS|KEEP_CURRENT_WINDOW|KEEP_ALL_WINDOWS&#93;<br />if &quot;%~1&quot; equ &quot;KEEP_CURRENT_WINDOW&quot; (<br />&nbsp; &nbsp;echo ignorekey=function (^) { }; window.onkeydown=ignorekey; &gt;&amp;3<br />) else (<br />&nbsp; &nbsp;echo window.close(^); &gt;&amp;3<br />)<br />echo/&gt;&amp;3<br />exit /B<br /><br />=======================================================================<br /><br />Common exit point: request refresh window contents after all drawing functions<br /><br />:refresh<br />echo/&gt;&amp;3<br />exit /B<br /><br />=======================================================================<br /><br />:: Batch-BGI library: End Of File<br /></code></pre></div><br />The code in the library include descriptions only when a Batch-BGI subroutine works differently than the same function described in the <a href="http://www.cs.colorado.edu/~main/bgi/doc/" class="postlink">BGI functions reference</a> used as base for this work; previous information and the example program shown below should be enough to start to write your own graphing programs. I am preparing a more detailed description of the Batch-BGI library and the differences it have vs. the original BGI functions; if you ask for it, I will post this document &quot;as is&quot;.<br /><br />A Batch program must have certain structure in order to successfully use the Batch-BGI library; the example below show the base format required.<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@if (@CodeSection == @Batch) @then<br /><br />@echo off<br /><br />:: &quot;Batch-BGI Example.bat&quot;: Standard format required in Batch files that use the Batch-BGI graphics library<br />:: Written by Antonio Perez Ayala aka Aacini<br /><br />setlocal<br />if &quot;%~1&quot; equ &quot;BGI_interface&quot; goto %1<br /><br />rem Place here commands to execute before drawing graphics<br /><br />echo Start drawing interface<br />&quot;%~F0&quot; BGI_interface 3&gt;&amp;1 1&gt;&amp;2 | CScript //nologo //E:JScript &quot;%~F0&quot;<br />echo End drawing interface<br /><br />rem Place here commands to execute after drawing graphics<br /><br />goto :EOF<br /><br /><br />:BGI_interface<br /><br />rem Place here all drawing graphics commands.<br />rem This program include several short BGI examples copied from: <br />rem http://www.cs.colorado.edu/~main/bgi/doc/<br /><br />echo Initialize the HTA window<br />call :initwindow 400 300 &quot;Batch-BGI Example&quot;<br /><br />echo/<br />echo --^&gt; ARC example coming...<br />timeout /T 4<br />set /A stangle = 45, endangle = 135, radius = 100<br />set /A midx = _maxx / 2, midy = _maxy / 2<br />call :arc %midx%, %midy%, %stangle%, %endangle%, %radius%<br /><br />echo/<br />echo --^&gt; BAR example coming...<br />timeout /T 3<br />call :bar %midx%-110, %midy%-50, %midx%-10, %midy%+50<br /><br />echo/<br />echo --^&gt; BAR3D example coming...<br />timeout /T 3<br />call :setfillstyle 1, %BLUE%<br />call :bar3d %midx%+10, %midy%-50, %midx%+110, %midy%+50, 25, 1<br /><br />echo/<br />echo --^&gt; CIRCLE example coming...<br />timeout /T 3<br />call :setcolor %LIGHTRED%<br />call :circle %midx% %midy% %radius%+30<br /><br />echo/<br />echo --^&gt; MOVETO/LINETO example coming...<br />timeout /T 3<br />call :setcolor %LIGHTGREEN%<br />call :moveto 40,20 &amp; call :lineto 120,100 &amp; call :lineto 200,20 &amp; call :lineto 280,100<br /><br />echo/<br />echo --^&gt; OUTTEXTXY example coming...<br />timeout /T 3<br />call :setfillstyle 1, %LIGHTMAGENTA%<br />set /A &quot;Arial=7, SOLID_FILL=0&quot;<br />call :settextstyle %Arial% %SOLID_FILL% 50<br />set &quot;text=This is a test.&quot;<br />rem Note the use of textwidth *real JScript function* to center the text in the window:<br />call :outtextxy&nbsp; (%_maxx%-textwidth(&quot;%text%&quot;))/2&nbsp; %_maxy%-30&nbsp; &quot;%text%&quot;<br /><br />rem To keep the graphics window open after this program terminate,<br />rem add KEEP_CURRENT_WINDOW parameter to closegraph subroutine<br />echo/<br />echo --^&gt; Closing grahics...<br />timeout /T 6<br />echo Close the window<br />call :closegraph<br /><br />echo End of drawing commands<br />goto :EOF<br /><br />===============================================================================<br />Include here the code of the required Batch-BGI subroutines; copy they from the library file.<br /><br />This example program use: arc, bar, bar3d, circle, lineto, moveto, outtextxy,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; setcolor, setfillstyle, settextstyle and initwindow.<br /><br />Copy from initwindow subroutine to the end of the library file; this will include<br />setallpalette and closegraph subroutines, that are also required.<br />===============================================================================<br /><br />:: End of Batch section<br /><br />@end<br /><br />// Start of JScript section<br /><br />var fso&nbsp; &nbsp; &nbsp; = new ActiveXObject(&quot;Scripting.FileSystemObject&quot;),<br />&nbsp; &nbsp; WshShell = new ActiveXObject(&quot;WScript.Shell&quot;),<br />&nbsp; &nbsp; HTA&nbsp; &nbsp; &nbsp; = new Array(), command, activepage, visualpage;<br /><br />// Create the HTA file<br />HTA.FullName = WScript.ScriptFullName.replace(WScript.ScriptName,&quot;Batch-BGI.hta&quot;);<br />HTA.file = fso.CreateTextFile(HTA.FullName,true);<br />HTA.file.WriteLine(<br />&nbsp; &nbsp;&quot;&lt;meta http-equiv='x-ua-compatible' content='ie=edge'/&gt;\r\n&quot; +<br />&nbsp; &nbsp;&quot;&lt;html&gt; &lt;head&gt;&lt;HTA:APPLICATION&gt;&lt;/head&gt;\r\n&quot; +<br />&nbsp; &nbsp;&quot;&lt;script language='JavaScript'&gt;\r\n&quot; +<br />&nbsp; &nbsp;&quot;var fso&nbsp; &nbsp;= new ActiveXObject('Scripting.FileSystemObject'),\r\n&quot; +<br />&nbsp; &nbsp;&quot;&nbsp; &nbsp; stdin = fso.GetStandardStream(0), command, canvas, ctx;\r\n&quot; +<br />&nbsp; &nbsp;&quot;fso.GetStandardStream(1).WriteLine();\r\n&quot; +<br />&nbsp; &nbsp;&quot;function evalCommands() {while (command=stdin.ReadLine()) eval(command);}\r\n&quot; +<br />&nbsp; &nbsp;&quot;window.onkeydown = evalCommands;\r\n&quot; +<br />&nbsp; &nbsp;&quot;&lt;/script&gt;\r\n&quot; +<br />&nbsp; &nbsp;&quot;&lt;/html&gt;\r\n&quot;<br />);<br />HTA.file.Close();<br /><br />// Receive commands from Batch section and send they to the HTA window<br />while ( ! WScript.Stdin.AtEndOfStream ) {<br /><br />&nbsp; &nbsp;command = WScript.Stdin.ReadLine();<br /><br />&nbsp; &nbsp;if ( command.substr(0,6) == 'eval(&quot;' ) {<br />&nbsp; &nbsp; &nbsp; eval(command.split('&quot;')&#91;1&#93;);&nbsp; &nbsp;// command = eval(&quot;any *local* expression&quot;);<br />&nbsp; &nbsp;} else {<br /><br />&nbsp; &nbsp; &nbsp; if ( command.substr(0,11) == &quot;openwindow;&quot; ) {<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// command = &quot;openwindow;width;height;title;left;top;page&quot; - create a new mshta.exe .HTA window<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;var p = command.split(&quot;;&quot;), width = p&#91;1&#93;, height = p&#91;2&#93;, title=p&#91;3&#93;, left = p&#91;4&#93;, top = p&#91;5&#93;;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;activepage = visualpage = parseInt(p&#91;6&#93;);<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Define the contents of the HTA window<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;command = &quot;\&quot;&lt;title&gt;&quot;+title+&quot;&lt;/title&gt; &quot; +<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;&lt;style type='text/css'&gt;body {color:white; background:black;}&lt;/style&gt; &quot; +<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;&lt;canvas id='BGIcanvas' width='&quot;+width+&quot;' height='&quot;+height+&quot;' style='border:1px solid;'&gt;&quot; +<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;Your browser don't support the HTML5 Canvas tag&quot; +<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;&lt;/canvas&gt;\&quot;&quot;;<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Open the window and wait for confirmation<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;HTA&#91;activepage&#93; = WshShell.Exec('mshta.exe &quot;'+HTA.FullName+'&quot;');<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;HTA&#91;activepage&#93;.Stdout.ReadLine();<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;HTA&#91;activepage&#93;.Stdin.WriteLine( <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;window.resizeTo(&quot;+width+&quot;+34,&quot;+height+&quot;+64); &quot;&nbsp; &nbsp;+&nbsp; &nbsp;// To adjust the margin, try: 34..40 64..82<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ((left!=&quot;-1&quot;)?(&quot;window.moveTo(&quot;+left+&quot;,&quot;+top+&quot;); &quot;):&quot;&quot;) +<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;document.body.innerHTML = &quot;+command+&quot;; &quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;canvas = document.getElementById('BGIcanvas'); &quot; +<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;ctx = canvas.getContext('2d'); &quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;textwidth = function (txt) {return(ctx.measureText(txt).width)}; &quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;);<br /><br />&nbsp; &nbsp; &nbsp; } else {<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Read and send commands to the *active page*<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// until an &quot;end of block&quot; mark (empty line) is received<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;while ( command ) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; HTA&#91;activepage&#93;.Stdin.WriteLine(command);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; command = WScript.Stdin.ReadLine();<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br /><br />&nbsp; &nbsp; &nbsp; }<br /><br />&nbsp; &nbsp; &nbsp; // Raise the event for &quot;window.onkeydown&quot; function in the HTA window<br />&nbsp; &nbsp; &nbsp; if ( visualpage &gt;= 0 ) {&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;// if screen refresh is active:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;HTA&#91;activepage&#93;.Stdin.WriteLine();&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;//&nbsp; &nbsp; Send the &quot;end of block&quot; mark (empty line)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;WshShell.AppActivate(HTA&#91;visualpage&#93;.ProcessID);&nbsp; &nbsp;//&nbsp; &nbsp; Set focus on the HTA window *visual page*<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;WshShell.SendKeys(&quot; &quot;);&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;//&nbsp; &nbsp; And do a &quot;key down&quot;<br />&nbsp; &nbsp; &nbsp; }<br /><br />&nbsp; &nbsp;}<br /><br />}<br /><br />fso.DeleteFile(HTA.FullName);<br /></code></pre></div><br />Note that you must insert the code of the Batch-BGI subroutines in the Batch file. You may include only the subroutines used; just be sure to always include from initwindow subroutine to the end of the file. This is the output displayed by previous example program (when KEEP_CURRENT_WINDOW optional parameter is inserted in closegraph subroutine):<br /><br /><img src="../../i.imgur.com/frr5Tv1.png" class="postimage" alt="Image" /><br /><br />The library file may be splitted in separate files with appropriate names (arc.bat, bar.bat, etc) so the writting of a graphing program would be simpler, although the execution be slower. On the other hand, a series of macros with parameters may be defined in order to get a faster execution, but the program will become more complex. A good idea would be to have the Batch-BGI subroutines in these three forms, so beginners may start writting graphing programs using the simplest &quot;call arc ...&quot; external subroutines, and advanced users may write faster programs via &quot;%arc% ...&quot; macros. Also, you may bypass the Batch-BGI frame and directly execute canvas functions sending graphics commands to &gt;&amp;3 stream, so your program may use canvas features not supported by the BGI library (if you know how to use such features).<br /><br />More information, library subroutines and complete examples coming soon...<br /><br />Note: you must copy a series of subroutines from the library file into the example program in order for it to work. The Batch-BGI library is a tool for Batch file programmers that used to <em class="text-italics">write programs</em>, so no: there is not a &quot;complete example&quot; ready to be just downloaded and executed!<br /><br />Antonio</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
	

	<div class="action-bar bar-bottom">
	
			<a href="posting633b.html?mode=reply&amp;f=3&amp;t=6625" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic569f.html?f=3&amp;t=6625&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

	
	
	
			<div class="pagination">
			1 post
							&bull; Page <strong>1</strong> of <strong>1</strong>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="viewforum4d6b.html?f=3" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to “DOS Batch Forum”</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="viewforum31e6.html?f=4" class="jumpbox-cat-link"> <span> DosTips - Dos Batch</span></a></li>
																<li><a href="viewforum4d6b.html?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; DOS Batch Forum</span></a></li>
											</ul>
		</div>
	</div>

	</div>


			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
							<span class="crumb"><a href="../index.html" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>DosTips.com</span></a></span>									<span class="crumb"><a href="index.html" data-navbar-reference="index"><span>Board index</span></a></span>					</li>
		
				<li class="rightside">All times are <span title="UTC-6">UTC-06:00</span></li>
							<li class="rightside">
				<a href="ucp033a.html?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete all board cookies</span>
				</a>
			</li>
												<li class="rightside" data-last-responsive="true">
				<a href="memberlist4bfd.html?mode=team" role="menuitem">
					<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
				</a>
			</li>
									<li class="rightside" data-last-responsive="true">
				<a href="memberlist8733.html?mode=contactadmin" role="menuitem">
					<i class="icon fa-envelope fa-fw" aria-hidden="true"></i><span>Contact us</span>
				</a>
			</li>
			</ul>

	</div>
</div>

	<div class="copyright">
				<!-- WARNING NO DELETE -->Style developer by <a href="http://tricolor.x-tk.ru/">support forum tricolor</a>, <!-- END WARNING NO DELETE -->Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
									</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	<img src="cron5897.gif?cron_type=cron.task.text_reparser.poll_option" width="1" height="1" alt="cron" /></div>

<script type="text/javascript" src="assets/javascript/jquery.mind772.js?assets_version=34"></script>
<script type="text/javascript" src="assets/javascript/cored772.js?assets_version=34"></script>



<script type="text/javascript" src="styles/prosilver/template/forum_fnd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/prosilver/template/ajaxd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/jquery-uid772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/collapsed772.js?assets_version=34"></script>



</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=6625 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 06:01:07 GMT -->
</html>
