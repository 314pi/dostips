<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=1733 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 09:04:39 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>new functions: :chr, :asc, :asciiMap - DosTips.com</title>


	<link rel="canonical" href="viewtopic3aa7.html?t=1733">

<!--
	phpBB style name: Allan Style - SUBSILVER
	Based on style:   prosilver (this is the default phpBB3 style)
	Based on style:   subsilver2 (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:  Allan ( http://x-tk.ru/ )
-->

<link href="assets/css/font-awesome.mind772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/stylesheetd772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/en/stylesheetd772.css?assets_version=34" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="./styles/AllanStyle-SUBSILVER/theme/tweaks.css?assets_version=34" rel="stylesheet">
<![endif]-->




<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','../../www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-280191-1', 'auto');
	ga('send', 'pageview');
</script>

</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">

<div id="header-subsilver">
	<a id="top" class="top-anchor" accesskey="t"></a>
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description" class="site-description">
				<a id="logo" class="logo" href="../index.html" title="DosTips.com"><span class="site_logo"></span></a>
				<h1>DosTips.com</h1>
				<p>A Forum all about DOS Batch</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

									<div id="search-box" class="search-box search-header" role="search">
				<form action="https://www.dostips.com/forum/search.php" method="get" id="search">
				<fieldset>
					<input name="keywords" id="keywords" type="search" maxlength="128" title="Search for keywords" class="inputbox search tiny" size="20" value="" placeholder="Search…" />
					<button class="button button-search" type="submit" title="Search">
						<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
					</button>
					<a href="search.html" class="button button-search-end" title="Advanced search">
						<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
					</a>
					
				</fieldset>
				</form>
			</div>
						
			</div>
					</div>
</div>


<div id="wrap" class="wrap">
	<div id="page-header">
				<div class="navbar-top" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
																									<li>
								<a href="search33a7.html?search_id=unanswered" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="search526f.html?search_id=active_topics" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-blue" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="search.html" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
											<li class="separator"></li>
																			<li>
								<a href="memberlist4bfd.html?mode=team" role="menuitem">
									<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
								</a>
							</li>
																<li class="separator"></li>

									</ul>
			</div>
		</li>

				<li data-skip-responsive="true">
			<a href="app.php/help/faq.html" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
						
			<li class="rightside"  data-skip-responsive="true">
			<a href="ucp26c3.html?mode=login" title="Login" accesskey="x" role="menuitem">
				<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Login</span>
			</a>
		</li>
					<li class="rightside" data-skip-responsive="true">
				<a href="ucp8319.html?mode=register" role="menuitem">
					<i class="icon fa-pencil-square-o  fa-fw" aria-hidden="true"></i><span>Register</span>
				</a>
			</li>
						</ul>

	</div>
</div>

<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
						<li class="breadcrumbs">
							<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="../index.html" itemprop="url" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span itemprop="title">DosTips.com</span></a></span>
										<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="index.html" itemprop="url" accesskey="h" data-navbar-reference="index"><span itemprop="title">Board index</span></a></span>

											<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="4"><a href="viewforum31e6.html?f=4" itemprop="url"><span itemprop="title">DosTips - Dos Batch</span></a></span>
															<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="3"><a href="viewforum4d6b.html?f=3" itemprop="url"><span itemprop="title">DOS Batch Forum</span></a></span>
												</li>
		
					<li class="rightside responsive-search">
				<a href="search.html" title="View the advanced search options" role="menuitem">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</a>
			</li>
			</ul>

	</div>
</div>

<div class="navbar-top-link">
	<div class="inner">
		<ul>
			<li class="navbar-top-link-left"><a href="search33a7.html?search_id=unanswered">Unanswered topics</a></li>
			<li class="navbar-top-link-left"><a href="search526f.html?search_id=active_topics">Active topics</a></li>

											</ul>
	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
		
<h2 class="topic-title"><a href="viewtopicf6d0-2.html?f=3&amp;t=1733">new functions: :chr, :asc, :asciiMap</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">Discussion forum for all Windows batch related topics.<br /></div>
<p>
	<strong>Moderator:</strong> <a href="memberlista6a8.html?mode=viewprofile&amp;u=5" class="username">DosItHelp</a>
</p>


<div class="action-bar bar-top">
	
			<a href="postingeebd.html?mode=reply&amp;f=3&amp;t=1733" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic1609.html?f=3&amp;t=1733&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="https://www.dostips.com/forum/search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topic…" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="search.html" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="1733" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			32 posts
							<ul>
		<li class="active"><span>1</span></li>
				<li><a class="button" href="viewtopic116d.html?f=3&amp;t=1733&amp;start=15" role="button">2</a></li>
				<li><a class="button" href="viewtopicdcad.html?f=3&amp;t=1733&amp;start=30" role="button">3</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopic116d.html?f=3&amp;t=1733&amp;start=15" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
		</div>




<div id="subsilver-nav-topic">
	<div class="inner"><div class="post has-profile">
		<div class="leftsided postbody subsilver-topic-title">Message</div>
		<div class="leftsided postprofile subsilver-topic-author">Author</div>
	</div></div>
</div>

			<div id="p6801" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile6801">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content6801">

						<h3 class="first"><a href="#p6801">new functions: :chr, :asc, :asciiMap</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting9ce3-3.html?mode=quote&amp;f=3&amp;p=6801" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicf461-2.html?p=6801#p6801" onclick="prompt('Message #1',this.href); return false;">#1</a></span> 
									<a class="unread" href="viewtopicf461-2.html?p=6801#p6801" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>31 Mar 2011 05:12
			</p>
			
			
			
			<div class="content">Here is code I developed for 3 new functions to support bi-directional conversion between numeric ASCII codes and characters. I think I saw routines with similar functionality some where that relied on DEBUG and temp files. These routines do not need either.<br /><br />There are 10 characters that are problematic when trying to put them in a variable that are not supported. Jeb has some tricks for some (all?) of them. But I'm not sure it would be productive for this application. <br /><br />code...<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />setlocal disableDelayedExpansion<br />for /l %%n in (0,1,255) do (<br />&nbsp; call :chr %%n char<br />&nbsp; if not errorlevel 1 (<br />&nbsp; &nbsp; call :asc char 0 n<br />&nbsp; &nbsp; call echo &quot;%%n:%%char%%:%%n%%&quot;<br />&nbsp; ) else echo chr %%n produced above error<br />)<br />exit /b<br /><br />:asc&nbsp; &nbsp; &nbsp; &nbsp; StrVar IntVal &#91;RtnVar&#93;<br />::<br />::&nbsp; Computes the ASCII code for a specified character within the string<br />::&nbsp; contained by variable StrVar. The position within the string is specified<br />::&nbsp; by the IntVal argument. A non-negative value is relative to the beginning<br />::&nbsp; of the string, with 0 specifying the first character. A negative value is<br />::&nbsp; relative to the end of the string, with -1 specifying the last character.<br />::<br />::&nbsp; Sets RtnVar=result<br />::&nbsp; or displays result if RtnVar not specified<br />::<br />::&nbsp; IntVal may be passed as a variable without enclosing the name in quotes.<br />:::<br />::: Dependencies - asciiMap<br />:::<br />&nbsp; setlocal disableDelayedExpansion<br />&nbsp; set /a n=%~2 2&gt;nul<br />&nbsp; call set &quot;chr=%%%~1:~%n%,1%%&quot;<br />&nbsp; call :asciiMap ascii<br />&nbsp; setlocal enableDelayedExpansion<br />&nbsp; if &quot;!chr!&quot;==&quot; &quot; set /a rtn=32&amp;goto :asc.end<br />&nbsp; set rtn=<br />&nbsp; for /l %%n in (0,1,255) do if &quot;!ascii:~%%n,1!&quot;==&quot;!chr!&quot; set rtn=%%n<br />&nbsp; :asc.end<br />&nbsp; (endlocal &amp; rem -- return values<br />&nbsp; &nbsp; endlocal<br />&nbsp; &nbsp; if &quot;%~3&quot; neq &quot;&quot; (set %~3=%rtn%) else (echo:%rtn%)<br />&nbsp; )<br />exit /b<br /><br /><br />:chr&nbsp; &nbsp; &nbsp; &nbsp; IntVal &#91;RtnVar&#93;<br />::<br />::&nbsp; Converts ASCII code IntVal into the corresponding character.<br />::<br />::&nbsp; Sets RtnVar=result<br />::&nbsp; or displays result if RtnVar not specified<br />::<br />::&nbsp; IntVal must be a value between 0 and 255.<br />::<br />::&nbsp; Aborts with an error message to stderr and errorlevel 1 if IntVal<br />::&nbsp; corresponds to one of the following problematic characters:<br />::<br />::&nbsp; &nbsp; Dec&nbsp; &nbsp;Hex&nbsp; &nbsp;Oct&nbsp; Char<br />::&nbsp; &nbsp; ---&nbsp; ----&nbsp; ----&nbsp; ----<br />::&nbsp; &nbsp; &nbsp; 0&nbsp; 0x00&nbsp; &nbsp; 00&nbsp; NUL&nbsp; (null)<br />::&nbsp; &nbsp; &nbsp; 3&nbsp; 0x03&nbsp; &nbsp; 03&nbsp; ETX&nbsp; (end of text)<br />::&nbsp; &nbsp; &nbsp; 8&nbsp; 0x08&nbsp; &nbsp;010&nbsp; BS&nbsp; &nbsp;(backspace)<br />::&nbsp; &nbsp; &nbsp; 9&nbsp; 0x09&nbsp; &nbsp;011&nbsp; TAB&nbsp; (horizontal tab)<br />::&nbsp; &nbsp; &nbsp;10&nbsp; 0x0A&nbsp; &nbsp;012&nbsp; LF&nbsp; &nbsp;(line feed)<br />::&nbsp; &nbsp; &nbsp;11&nbsp; 0x0B&nbsp; &nbsp;013&nbsp; VT&nbsp; &nbsp;(vertical tab)<br />::&nbsp; &nbsp; &nbsp;12&nbsp; 0x0C&nbsp; &nbsp;014&nbsp; FF&nbsp; &nbsp;(form feed)<br />::&nbsp; &nbsp; &nbsp;13&nbsp; 0x0D&nbsp; &nbsp;015&nbsp; CR&nbsp; &nbsp;(carriage return)<br />::&nbsp; &nbsp; &nbsp;26&nbsp; 0x1A&nbsp; &nbsp;032&nbsp; SUB&nbsp; (substitute)<br />::&nbsp; &nbsp; 127&nbsp; 0x7F&nbsp; 0177&nbsp; DEL&nbsp; (delete)<br />::<br />::&nbsp; IntVal may be passed as a variable without enclosing the name in quotes.<br />:::<br />::: Dependencies - asciiMap<br />:::<br />&nbsp; setlocal disableDelayedExpansion<br />&nbsp; set /a n=%~1 2&gt;nul<br />&nbsp; if %n%==32 set &quot;c= &quot;&amp;goto :chr.end<br />&nbsp; call :asciiMap map<br />&nbsp; call set &quot;c=%%map:~%n%,1%%&quot;<br />&nbsp; if &quot;%c%%c%&quot;==&quot;&nbsp; &quot; (<br />&nbsp; &nbsp; echo ERROR: Problematic ASCII Code &gt;&amp;2<br />&nbsp; &nbsp; exit /b 1<br />&nbsp; )<br />&nbsp; :chr.end<br />&nbsp; (endlocal &amp; rem -- return values<br />&nbsp; &nbsp; if &quot;%~2&quot; neq &quot;&quot; (set %~2=^%c%) else (echo:^%c%)<br />&nbsp; )<br />exit /b<br /><br /><br />:asciiMap&nbsp; &nbsp;rtnVar<br />::<br />::&nbsp; Sets variable rtnVar to a 256 character string containing the complete<br />::&nbsp; extended ASCII character set except a space has been substituted for each<br />::&nbsp; of the following problematic characters:<br />::<br />::&nbsp; &nbsp; Dec&nbsp; &nbsp;Hex&nbsp; &nbsp;Oct&nbsp; Char<br />::&nbsp; &nbsp; ---&nbsp; ----&nbsp; ----&nbsp; ----<br />::&nbsp; &nbsp; &nbsp; 0&nbsp; 0x00&nbsp; &nbsp; 00&nbsp; NUL&nbsp; (null)<br />::&nbsp; &nbsp; &nbsp; 3&nbsp; 0x03&nbsp; &nbsp; 03&nbsp; ETX&nbsp; (end of text)<br />::&nbsp; &nbsp; &nbsp; 8&nbsp; 0x08&nbsp; &nbsp;010&nbsp; BS&nbsp; &nbsp;(backspace)<br />::&nbsp; &nbsp; &nbsp; 9&nbsp; 0x09&nbsp; &nbsp;011&nbsp; TAB&nbsp; (horizontal tab)<br />::&nbsp; &nbsp; &nbsp;10&nbsp; 0x0A&nbsp; &nbsp;012&nbsp; LF&nbsp; &nbsp;(line feed)<br />::&nbsp; &nbsp; &nbsp;11&nbsp; 0x0B&nbsp; &nbsp;013&nbsp; VT&nbsp; &nbsp;(vertical tab)<br />::&nbsp; &nbsp; &nbsp;12&nbsp; 0x0C&nbsp; &nbsp;014&nbsp; FF&nbsp; &nbsp;(form feed)<br />::&nbsp; &nbsp; &nbsp;13&nbsp; 0x0D&nbsp; &nbsp;015&nbsp; CR&nbsp; &nbsp;(carriage return)<br />::&nbsp; &nbsp; &nbsp;26&nbsp; 0x0A&nbsp; &nbsp;032&nbsp; SUB&nbsp; (substitute)<br />::&nbsp; &nbsp; 127&nbsp; 0x7F&nbsp; 0177&nbsp; DEL&nbsp; (delete)<br />:::<br />::: Dependencies - &lt;none&gt;<br />:::<br />&nbsp; set %~1=  &nbsp; &nbsp; &nbsp;   !^&quot;#$%%^&amp;'^(^)*+,-./0123456789:;^&lt;=^&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ&#91;\&#93;^^_`abcdefghijklmnopqrstuvwxyz{^|}~ €‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ ¡¢£¤¥¦§¨©ª«¬­®¯°±²³´µ¶·¸¹º»¼½¾¿ÀÁÂÃÄÅÆÇÈÉÊËÌÍÎÏÐÑÒÓÔÕÖ×ØÙÚÛÜÝÞßàáâãäåæçèéêëìíîïðñòóôõö÷øùúûüýþÿ<br />exit /b<br /></code></pre></div><br /><br />and output...<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>ERROR: Problematic ASCII Code <br />chr 0 produced above error<br />&quot;1::1&quot;<br />&quot;2::2&quot;<br />ERROR: Problematic ASCII Code <br />chr 3 produced above error<br />&quot;4::4&quot;<br />&quot;5::5&quot;<br />&quot;6::6&quot;<br />&quot;7::7&quot;<br />ERROR: Problematic ASCII Code <br />chr 8 produced above error<br />ERROR: Problematic ASCII Code <br />chr 9 produced above error<br />ERROR: Problematic ASCII Code <br />chr 10 produced above error<br />ERROR: Problematic ASCII Code <br />chr 11 produced above error<br />ERROR: Problematic ASCII Code <br />chr 12 produced above error<br />ERROR: Problematic ASCII Code <br />chr 13 produced above error<br />&quot;14::14&quot;<br />&quot;15::15&quot;<br />&quot;16::16&quot;<br />&quot;17::17&quot;<br />&quot;18::18&quot;<br />&quot;19::19&quot;<br />&quot;20::20&quot;<br />&quot;21::21&quot;<br />&quot;22::22&quot;<br />&quot;23::23&quot;<br />&quot;24::24&quot;<br />&quot;25::25&quot;<br />ERROR: Problematic ASCII Code <br />chr 26 produced above error<br />&quot;27::27&quot;<br />&quot;28::28&quot;<br />&quot;29::29&quot;<br />&quot;30::30&quot;<br />&quot;31::31&quot;<br />&quot;32: :32&quot;<br />&quot;33:!:33&quot;<br />&quot;34:&quot;:34&quot;<br />&quot;35:#:35&quot;<br />&quot;36:$:36&quot;<br />&quot;37:%:37&quot;<br />&quot;38:&amp;:38&quot;<br />&quot;39:':39&quot;<br />&quot;40:(:40&quot;<br />&quot;41:):41&quot;<br />&quot;42:*:42&quot;<br />&quot;43:+:43&quot;<br />&quot;44:,:44&quot;<br />&quot;45:-:45&quot;<br />&quot;46:.:46&quot;<br />&quot;47:/:47&quot;<br />&quot;48:0:48&quot;<br />&quot;49:1:49&quot;<br />&quot;50:2:50&quot;<br />&quot;51:3:51&quot;<br />&quot;52:4:52&quot;<br />&quot;53:5:53&quot;<br />&quot;54:6:54&quot;<br />&quot;55:7:55&quot;<br />&quot;56:8:56&quot;<br />&quot;57:9:57&quot;<br />&quot;58:::58&quot;<br />&quot;59:;:59&quot;<br />&quot;60:&lt;:60&quot;<br />&quot;61:=:61&quot;<br />&quot;62:&gt;:62&quot;<br />&quot;63:?:63&quot;<br />&quot;64:@:64&quot;<br />&quot;65:A:65&quot;<br />&quot;66:B:66&quot;<br />&quot;67:C:67&quot;<br />&quot;68:D:68&quot;<br />&quot;69:E:69&quot;<br />&quot;70:F:70&quot;<br />&quot;71:G:71&quot;<br />&quot;72:H:72&quot;<br />&quot;73:I:73&quot;<br />&quot;74:J:74&quot;<br />&quot;75:K:75&quot;<br />&quot;76:L:76&quot;<br />&quot;77:M:77&quot;<br />&quot;78:N:78&quot;<br />&quot;79:O:79&quot;<br />&quot;80:P:80&quot;<br />&quot;81:Q:81&quot;<br />&quot;82:R:82&quot;<br />&quot;83:S:83&quot;<br />&quot;84:T:84&quot;<br />&quot;85:U:85&quot;<br />&quot;86:V:86&quot;<br />&quot;87:W:87&quot;<br />&quot;88:X:88&quot;<br />&quot;89:Y:89&quot;<br />&quot;90:Z:90&quot;<br />&quot;91:&#91;:91&quot;<br />&quot;92:\:92&quot;<br />&quot;93:&#93;:93&quot;<br />&quot;94:^:94&quot;<br />&quot;95:_:95&quot;<br />&quot;96:`:96&quot;<br />&quot;97:a:97&quot;<br />&quot;98:b:98&quot;<br />&quot;99:c:99&quot;<br />&quot;100:d:100&quot;<br />&quot;101:e:101&quot;<br />&quot;102:f:102&quot;<br />&quot;103:g:103&quot;<br />&quot;104:h:104&quot;<br />&quot;105:i:105&quot;<br />&quot;106:j:106&quot;<br />&quot;107:k:107&quot;<br />&quot;108:l:108&quot;<br />&quot;109:m:109&quot;<br />&quot;110:n:110&quot;<br />&quot;111:o:111&quot;<br />&quot;112:p:112&quot;<br />&quot;113:q:113&quot;<br />&quot;114:r:114&quot;<br />&quot;115:s:115&quot;<br />&quot;116:t:116&quot;<br />&quot;117:u:117&quot;<br />&quot;118:v:118&quot;<br />&quot;119:w:119&quot;<br />&quot;120:x:120&quot;<br />&quot;121:y:121&quot;<br />&quot;122:z:122&quot;<br />&quot;123:{:123&quot;<br />&quot;124:|:124&quot;<br />&quot;125:}:125&quot;<br />&quot;126:~:126&quot;<br />ERROR: Problematic ASCII Code <br />chr 127 produced above error<br />&quot;128:€:128&quot;<br />&quot;129::129&quot;<br />&quot;130:‚:130&quot;<br />&quot;131:ƒ:131&quot;<br />&quot;132:„:132&quot;<br />&quot;133:…:133&quot;<br />&quot;134:†:134&quot;<br />&quot;135:‡:135&quot;<br />&quot;136:ˆ:136&quot;<br />&quot;137:‰:137&quot;<br />&quot;138:Š:138&quot;<br />&quot;139:‹:139&quot;<br />&quot;140:Œ:140&quot;<br />&quot;141::141&quot;<br />&quot;142:Ž:142&quot;<br />&quot;143::143&quot;<br />&quot;144::144&quot;<br />&quot;145:‘:145&quot;<br />&quot;146:’:146&quot;<br />&quot;147:“:147&quot;<br />&quot;148:”:148&quot;<br />&quot;149:•:149&quot;<br />&quot;150:–:150&quot;<br />&quot;151:—:151&quot;<br />&quot;152:˜:152&quot;<br />&quot;153:™:153&quot;<br />&quot;154:š:154&quot;<br />&quot;155:›:155&quot;<br />&quot;156:œ:156&quot;<br />&quot;157::157&quot;<br />&quot;158:ž:158&quot;<br />&quot;159:Ÿ:159&quot;<br />&quot;160: :160&quot;<br />&quot;161:¡:161&quot;<br />&quot;162:¢:162&quot;<br />&quot;163:£:163&quot;<br />&quot;164:¤:164&quot;<br />&quot;165:¥:165&quot;<br />&quot;166:¦:166&quot;<br />&quot;167:§:167&quot;<br />&quot;168:¨:168&quot;<br />&quot;169:©:169&quot;<br />&quot;170:ª:170&quot;<br />&quot;171:«:171&quot;<br />&quot;172:¬:172&quot;<br />&quot;173:­:173&quot;<br />&quot;174:®:174&quot;<br />&quot;175:¯:175&quot;<br />&quot;176:°:176&quot;<br />&quot;177:±:177&quot;<br />&quot;178:²:178&quot;<br />&quot;179:³:179&quot;<br />&quot;180:´:180&quot;<br />&quot;181:µ:181&quot;<br />&quot;182:¶:182&quot;<br />&quot;183:·:183&quot;<br />&quot;184:¸:184&quot;<br />&quot;185:¹:185&quot;<br />&quot;186:º:186&quot;<br />&quot;187:»:187&quot;<br />&quot;188:¼:188&quot;<br />&quot;189:½:189&quot;<br />&quot;190:¾:190&quot;<br />&quot;191:¿:191&quot;<br />&quot;192:À:192&quot;<br />&quot;193:Á:193&quot;<br />&quot;194:Â:194&quot;<br />&quot;195:Ã:195&quot;<br />&quot;196:Ä:196&quot;<br />&quot;197:Å:197&quot;<br />&quot;198:Æ:198&quot;<br />&quot;199:Ç:199&quot;<br />&quot;200:È:200&quot;<br />&quot;201:É:201&quot;<br />&quot;202:Ê:202&quot;<br />&quot;203:Ë:203&quot;<br />&quot;204:Ì:204&quot;<br />&quot;205:Í:205&quot;<br />&quot;206:Î:206&quot;<br />&quot;207:Ï:207&quot;<br />&quot;208:Ð:208&quot;<br />&quot;209:Ñ:209&quot;<br />&quot;210:Ò:210&quot;<br />&quot;211:Ó:211&quot;<br />&quot;212:Ô:212&quot;<br />&quot;213:Õ:213&quot;<br />&quot;214:Ö:214&quot;<br />&quot;215:×:215&quot;<br />&quot;216:Ø:216&quot;<br />&quot;217:Ù:217&quot;<br />&quot;218:Ú:218&quot;<br />&quot;219:Û:219&quot;<br />&quot;220:Ü:220&quot;<br />&quot;221:Ý:221&quot;<br />&quot;222:Þ:222&quot;<br />&quot;223:ß:223&quot;<br />&quot;224:à:224&quot;<br />&quot;225:á:225&quot;<br />&quot;226:â:226&quot;<br />&quot;227:ã:227&quot;<br />&quot;228:ä:228&quot;<br />&quot;229:å:229&quot;<br />&quot;230:æ:230&quot;<br />&quot;231:ç:231&quot;<br />&quot;232:è:232&quot;<br />&quot;233:é:233&quot;<br />&quot;234:ê:234&quot;<br />&quot;235:ë:235&quot;<br />&quot;236:ì:236&quot;<br />&quot;237:í:237&quot;<br />&quot;238:î:238&quot;<br />&quot;239:ï:239&quot;<br />&quot;240:ð:240&quot;<br />&quot;241:ñ:241&quot;<br />&quot;242:ò:242&quot;<br />&quot;243:ó:243&quot;<br />&quot;244:ô:244&quot;<br />&quot;245:õ:245&quot;<br />&quot;246:ö:246&quot;<br />&quot;247:÷:247&quot;<br />&quot;248:ø:248&quot;<br />&quot;249:ù:249&quot;<br />&quot;250:ú:250&quot;<br />&quot;251:û:251&quot;<br />&quot;252:ü:252&quot;<br />&quot;253:ý:253&quot;<br />&quot;254:þ:254&quot;<br />&quot;255:ÿ:255&quot;<br /><br /></code></pre></div><br /><br />Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6803" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile6803">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist7125.html?mode=viewprofile&amp;u=417" class="username">jeb</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search73f1.html?author_id=417&amp;sr=posts">880</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 30 Aug 2007 08:05</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany, Bochum</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content6803">

						<h3 ><a href="#p6803">Re: new functions: :chr, :asc, :asciiMap</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingec6f.html?mode=quote&amp;f=3&amp;p=6803" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic0618.html?p=6803#p6803" onclick="prompt('Message #2',this.href); return false;">#2</a></span> 
									<a class="unread" href="viewtopic0618.html?p=6803#p6803" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist7125.html?mode=viewprofile&amp;u=417" class="username">jeb</a></strong> &raquo; </span>31 Mar 2011 08:12
			</p>
			
			
			
			<div class="content">Nice, <br />but you should be able to output each character, only the NUL=0=0x00 character should be hard.<br />I never found a way to handle it in a variable.<br /><br />The problematic characters can be handeld with delayed expansion.<br />But &lt;CR&gt; and &lt;LF&gt; can be inserted in the string only indirectly.<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>set LF=^<br /><br /><br />rem the two empty lines are important (without any spaces)<br />for /F %%a in ('copy /Z &quot;%~f0&quot; nul') DO set &quot;cr=%%a&quot;<br />set &quot;map=!map:~0,10!!LF!!map:~11!&quot;<br />set &quot;map=!map:~0,13!!CR!!map:~14!&quot;</code></pre></div><br /><br /><br />hope it helps<br />jeb</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6812" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile6812">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content6812">

						<h3 ><a href="#p6812">Re: new functions: :chr, :asc, :asciiMap</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting10db.html?mode=quote&amp;f=3&amp;p=6812" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopice643.html?p=6812#p6812" onclick="prompt('Message #3',this.href); return false;">#3</a></span> 
									<a class="unread" href="viewtopice643.html?p=6812#p6812" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>31 Mar 2011 17:30
			</p>
			
			
			
			<div class="content">Thanks again Jeb.<br /><br />What about the other non NULL &quot;problematic&quot; characters? I'm still stumped on how to introduce them.<br /><br />I have some concern with 0x0A (Ctrl-Z). Is this no longer treated as an end of file marker? I haven't done any testing, I'm just remembering issues I ran into back in the 80's.<br /><br />One other thing: The :asc linear search through the map seems inefficient. I thought I could employ a search mechanism similar to what is used for the :strLen function. But I hit a snag in that the collation sequence of the characters does not match the ASCII code sequence. Is there a way to temporarily change the collation rules of string comparisons from within a batch file?</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6813" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile6813">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content6813">

						<h3 ><a href="#p6813">Re: new functions: :chr, :asc, :asciiMap</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingbde5-2.html?mode=quote&amp;f=3&amp;p=6813" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic4d6a-2.html?p=6813#p6813" onclick="prompt('Message #4',this.href); return false;">#4</a></span> 
									<a class="unread" href="viewtopic4d6a-2.html?p=6813#p6813" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>31 Mar 2011 17:37
			</p>
			
			
			
			<div class="content">...and for the TAB character, I can get that character in my source, but my programming editor is typically set to convert tabs into spaces. Eventually I'm sure I would make a mistake and forget to disable this feature when editing the source, and my map would become corrupted.<br /><br />Any way to programmatically generate a tab character without it appearing in the source?</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6816" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile6816">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content6816">

						<h3 ><a href="#p6816">Re: new functions: :chr, :asc, :asciiMap</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingb3fb.html?mode=quote&amp;f=3&amp;p=6816" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicc36f.html?p=6816#p6816" onclick="prompt('Message #5',this.href); return false;">#5</a></span> 
									<a class="unread" href="viewtopicc36f.html?p=6816#p6816" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>31 Mar 2011 18:47
			</p>
			
			
			
			<div class="content">...and I'm back to thinking many of the &quot;problematic&quot; characters are still a problem.<br /><br /><blockquote class="uncited"><div>The problematic characters can be handeld with delayed expansion.<br /></div></blockquote><br /><br />I can't use delayed expansion in my endlocal block that returns the results. This was what I meant in my original post when I said &quot;I'm not sure [putting the problem characters in the map variable] would be productive for this application.&quot;</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6817" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile6817">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist7125.html?mode=viewprofile&amp;u=417" class="username">jeb</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search73f1.html?author_id=417&amp;sr=posts">880</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 30 Aug 2007 08:05</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany, Bochum</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content6817">

						<h3 ><a href="#p6817">Re: new functions: :chr, :asc, :asciiMap</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinga5fd.html?mode=quote&amp;f=3&amp;p=6817" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic6512.html?p=6817#p6817" onclick="prompt('Message #6',this.href); return false;">#6</a></span> 
									<a class="unread" href="viewtopic6512.html?p=6817#p6817" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist7125.html?mode=viewprofile&amp;u=417" class="username">jeb</a></strong> &raquo; </span>31 Mar 2011 22:55
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>dbenham wrote:</cite>...and I'm back to thinking many of the &quot;problematic&quot; characters are still a problem.<br /></div></blockquote><br />The &quot;problematic&quot; are not so problematic ...  <img class="smilies" src="images/smilies/icon_wink.gif" alt=":wink:" title="Wink" /> <br /><br /><blockquote><div><cite>dbenham wrote:</cite>I can't use delayed expansion in my endlocal block that returns the results. This was what I meant in my original post when I said &quot;I'm not sure [putting the problem characters in the map variable] would be productive for this application.&quot;</div></blockquote><br /><br />You can simply use the delayed expansion to return a var from a local block with the FOR-Endlocal technic.<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>:CreateLF varByRef<br />setlocal<br />set LF=^<br /><br /><br />for %%a in (&quot;!lf!&quot;) do (<br />&nbsp; &nbsp;endlocal<br />&nbsp; &nbsp;set &quot;%~1=%%~a&quot;<br />)<br />goto :eof<br /></code></pre></div><br /><br />jeb</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6824" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile6824">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content6824">

						<h3 ><a href="#p6824">Re: new functions: :chr, :asc, :asciiMap</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting21fa.html?mode=quote&amp;f=3&amp;p=6824" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicbef0.html?p=6824#p6824" onclick="prompt('Message #7',this.href); return false;">#7</a></span> 
									<a class="unread" href="viewtopicbef0.html?p=6824#p6824" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>01 Apr 2011 13:10
			</p>
			
			
			
			<div class="content">Simple solution, and powerfull. <br />Thanks Jeb!<br /><br />What about the other issues in my prior back-to-back posts?<br /><br />I still can't get the other chars in my source code (editor limitation). But even if I do I'm worried what will happen when the command line interprets the text at execution time. For example, will &lt;BS&gt; not simply erase the prior character in the variable?<br /><br />conern over &lt;Ctrl-Z&gt; as end of file marker - is this valid?<br /><br />If I could get the chars in my source I would test, but I'm stuck.  <img class="smilies" src="images/smilies/icon_redface.gif" alt=":oops:" title="Embarassed" /> Any suggestions here?<br /><br />Finally, any thoughts on how to change character collation so I can improve :asc asciiMap lookup performance?<br /><br />Thanks for your help<br />Dave</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6827" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile6827">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist7125.html?mode=viewprofile&amp;u=417" class="username">jeb</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search73f1.html?author_id=417&amp;sr=posts">880</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 30 Aug 2007 08:05</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany, Bochum</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content6827">

						<h3 ><a href="#p6827">Re: new functions: :chr, :asc, :asciiMap</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinga41b.html?mode=quote&amp;f=3&amp;p=6827" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic88e5.html?p=6827#p6827" onclick="prompt('Message #8',this.href); return false;">#8</a></span> 
									<a class="unread" href="viewtopic88e5.html?p=6827#p6827" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist7125.html?mode=viewprofile&amp;u=417" class="username">jeb</a></strong> &raquo; </span>01 Apr 2011 15:34
			</p>
			
			
			
			<div class="content">Ok, I will try ...<br /><br />first the characters<br /><br />0x08 = DEL - can be produced with the prompt method<br />0x09 = TAB - didn't know how to produce it (never tried it, my editor didn't remove it)<br />0x0A = LF   - can be produced with the multiline method<br />0x0D = CR  - can be produced with the buffer overlflow or the copy /z method<br />0x1A = EOF/CTRL-Z - can be produced with the copy /a nul+nul method<br />0x1B = ESC - can be produced with the prompt method<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>:BL.String.CreateLF<br />:: Creates a variable with one character LF=Ascii-10<br />:: LF should&nbsp; be used later only with DelayedExpansion<br />set LF=^<br /><br /><br />rem ** The two empty lines are neccessary, spaces are not allowed<br />rem ** Creates a percent variant &quot;NLM=^LF&quot;, but normaly you should use the !LF! variant<br />set ^&quot;NLF=^^^%lf%%lf%^%lf%%lf%^&quot;<br />goto :eof<br /><br />:BL.String.CreateDEL_ESC<br />:: Creates two variables with one character DEL=Ascii-08 and ESC=Ascii-27<br />:: DEL and ESC can be used&nbsp; with and without DelayedExpansion<br />setlocal<br />for /F &quot;tokens=1,2 delims=#&quot; %%a in ('&quot;prompt #$H#$E# &amp; echo on &amp; for %%b in (1) do rem&quot;') do (<br />&nbsp; ENDLOCAL<br />&nbsp; set &quot;DEL=%%a&quot;<br />&nbsp; set &quot;ESC=%%b&quot;<br />&nbsp; goto :EOF<br />)<br />goto :eof<br /><br />:BL.String.CreateCR<br />::: CR should&nbsp; be used only with DelayedExpansion<br />for /F &quot;usebackq&quot; %%a in (`copy /Z &quot;%~dpf0&quot; nul`) DO (<br />&nbsp; &nbsp;set &quot;cr=%%a&quot;<br />)<br />goto :eof<br /><br />:BL.String.CreateSUB<br />::: SUB = 0x1A can be used with or without DelayedExpansion<br />copy /A nul+nul sub.tmp &gt; nul<br />for /F %%a in (sub.tmp) DO (<br />&nbsp; &nbsp;set &quot;char.sub=%%a&quot;<br />)<br />del sub.tmp<br />goto :eof<br /></code></pre></div><br /><br />The DEL(0x08) didn't remove the content of a variable, but you can use it to remove characters on the screen.<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&lt;nul set /p &quot;.=123456&quot;<br />echo !DEL!!DEL!AB<br />---- OUTPUT ---<br />1234AB<br /></code></pre></div><br /><br />The DEL(0x08) didn't remove the content of a variable, but you can use it to remove characters on the screen.<br />Batch handle it like any other character<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&lt;nul set /p &quot;.=123456&quot;<br />echo !DEL!!DEL!AB<br />---- OUTPUT ---<br />1234AB<br /></code></pre></div><br /><br />CR/LF can be produced, can be handeld as variable content but causes many problems/new behaviour.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&lt;nul set /p &quot;.=123456&quot;<br />echo !CR!AB<br />echo one!LF!two<br />---- OUTPUT ---<br />AB3456<br />one<br />two<br /></code></pre></div><br /><br />EOF/CTRL-Z=0x1A can't be set in a variable directly, but with the FOR /F read from a file it works.<br /><br />All characters except of NUL can be read from a file, therefore I would move the map into an external file.<br />And read it with a FOR /F into a variable.<br /><br />To build the characters I use debug.exe or xvi32 (a hex-editor), or a small jscript.<br /><br />To be faster, I would only once build the map, and reuse it everytime.<br /><br />jeb</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6829" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile6829">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content6829">

						<h3 ><a href="#p6829">Re: new functions: :chr, :asc, :asciiMap</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting748a.html?mode=quote&amp;f=3&amp;p=6829" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic4d3f.html?p=6829#p6829" onclick="prompt('Message #9',this.href); return false;">#9</a></span> 
									<a class="unread" href="viewtopic4d3f.html?p=6829#p6829" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>01 Apr 2011 17:36
			</p>
			
			
			
			<div class="content">Thanks Jeb<br /><br />I'll try out your suggestions in a few days. I'm heading out of town in a few minutes and won't have access to a computer.<br /><br />Dave</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6839" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile6839">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist11b9.html?mode=viewprofile&amp;u=767" class="username">plp626</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha9e9.html?author_id=767&amp;sr=posts">5</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 17 Apr 2009 00:36</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> China</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content6839">

						<h3 ><a href="#p6839">Re: new functions: :chr, :asc, :asciiMap</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting628b.html?mode=quote&amp;f=3&amp;p=6839" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic3024.html?p=6839#p6839" onclick="prompt('Message #10',this.href); return false;">#10</a></span> 
									<a class="unread" href="viewtopic3024.html?p=6839#p6839" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist11b9.html?mode=viewprofile&amp;u=767" class="username">plp626</a></strong> &raquo; </span>03 Apr 2011 13:11
			</p>
			
			
			
			<div class="content"><blockquote class="uncited"><div>0x09 = TAB - didn't know how to produce it (never tried it, my editor didn't remove it)</div></blockquote><br /><br />=========================<br />TAB can be produced with the 'cacls|find &quot; /R user&quot;' or 'reg query hkcu\environment /v temp |find /i &quot;temp&quot;' method<br /><br />here is the function （my OS is XP. test OK!）<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>:BL.String.CreateTAB<br />For /F &quot;skip=4 delims=pR tokens=1,2&quot; %%a In (<br />&nbsp; &nbsp; 'reg query hkcu\environment /v temp'<br />)Do if &quot;%~1&quot;==&quot;&quot; (set TAB=%%b)else set &quot;%~1=%%b&quot;<br />goto :eof</code></pre></div></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6840" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile6840">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist7125.html?mode=viewprofile&amp;u=417" class="username">jeb</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search73f1.html?author_id=417&amp;sr=posts">880</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 30 Aug 2007 08:05</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany, Bochum</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content6840">

						<h3 ><a href="#p6840">Re: new functions: :chr, :asc, :asciiMap</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting990f.html?mode=quote&amp;f=3&amp;p=6840" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic5066.html?p=6840#p6840" onclick="prompt('Message #11',this.href); return false;">#11</a></span> 
									<a class="unread" href="viewtopic5066.html?p=6840#p6840" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist7125.html?mode=viewprofile&amp;u=417" class="username">jeb</a></strong> &raquo; </span>03 Apr 2011 15:02
			</p>
			
			
			
			<div class="content">Very nice,   <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /> <br />I tested also some commands, but can't find any TAB-producer.<br /><br />I'm tested your solutions with XP and Vista, the &quot;reg query&quot; method fails under Vista.<br /><br />The calcs way is also ok, but could be a bit more complicated, as the &quot;find User&quot; is very localized (and doesn't work on my system).<br /><br />Perhaps it's possible to capture the lines and find the &lt;TAB&gt; without using a static search string.<br /><br />always amused about the complexity of batch<br />jeb</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6841" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile6841">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search661c.html?author_id=1265&amp;sr=posts">3386</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 22 Jan 2010 18:01</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content6841">

						<h3 ><a href="#p6841">Re: new functions: :chr, :asc, :asciiMap</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting6909.html?mode=quote&amp;f=3&amp;p=6841" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic09ef-2.html?p=6841#p6841" onclick="prompt('Message #12',this.href); return false;">#12</a></span> 
									<a class="unread" href="viewtopic09ef-2.html?p=6841#p6841" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a></strong> &raquo; </span>03 Apr 2011 16:37
			</p>
			
			
			
			<div class="content">Both don't work on Win7. It seems M$ replaced all TABs by spaces. I didn't found any command which output a TAB character yet.<br /><br />Regards<br />aGerman</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6853" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile6853">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search661c.html?author_id=1265&amp;sr=posts">3386</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 22 Jan 2010 18:01</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content6853">

						<h3 ><a href="#p6853">Re: new functions: :chr, :asc, :asciiMap</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingc642.html?mode=quote&amp;f=3&amp;p=6853" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic3351.html?p=6853#p6853" onclick="prompt('Message #13',this.href); return false;">#13</a></span> 
									<a class="unread" href="viewtopic3351.html?p=6853#p6853" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a></strong> &raquo; </span>04 Apr 2011 15:32
			</p>
			
			
			
			<div class="content">[EDIT]<br />Found a command on Win7: shutdown /? displays the following on my PC<br />..... snip<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&nbsp;U&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp;0&nbsp; &nbsp;Anderer Grund (nicht geplant)<br />E&nbsp; &nbsp;&nbsp; &nbsp;0&nbsp; &nbsp;0&nbsp; &nbsp;Anderer Grund (nicht geplant)<br />E P &nbsp; &nbsp;0&nbsp; &nbsp;0&nbsp; &nbsp;Anderer Grund (geplant)<br />&nbsp;U&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp;5&nbsp; &nbsp;Anderer Fehler: System reagierte nicht mehr<br />E&nbsp; &nbsp;&nbsp; &nbsp;1&nbsp; &nbsp;1&nbsp; &nbsp;Hardware: Wartung (nicht geplant)<br />E P &nbsp; &nbsp;1&nbsp; &nbsp;1&nbsp; &nbsp;Hardware: Wartung (geplant)<br />E&nbsp; &nbsp;&nbsp; &nbsp;1&nbsp; &nbsp;2&nbsp; &nbsp;Hardware: Installation (nicht geplant)<br />E P &nbsp; &nbsp;1&nbsp; &nbsp;2&nbsp; &nbsp;Hardware: Installation (geplant)<br />E&nbsp; &nbsp;&nbsp; &nbsp;2&nbsp; &nbsp;2&nbsp; &nbsp;Betriebssystem: Wiederherstellung (geplant)<br />E P &nbsp; &nbsp;2&nbsp; &nbsp;2&nbsp; &nbsp;Betriebssystem: Wiederherstellung (geplant)<br />&nbsp; P &nbsp; &nbsp;2&nbsp; &nbsp;3&nbsp; &nbsp;Betriebssystem: Aktualisierung (geplant)<br />E&nbsp; &nbsp;&nbsp; &nbsp;2&nbsp; &nbsp;4&nbsp; &nbsp;Betriebssystem: Neukonfigurierung (nicht geplant)<br />E P &nbsp; &nbsp;2&nbsp; &nbsp;4&nbsp; &nbsp;Betriebssystem: Neukonfigurierung (geplant)<br />&nbsp; P &nbsp; &nbsp;2&nbsp; &nbsp;16&nbsp; &nbsp;Betriebssystem: Service Pack (geplant)<br />&nbsp; &nbsp; &nbsp; &nbsp;2&nbsp; &nbsp;17&nbsp; &nbsp;Betriebssystem: Hotfix (nicht geplant)<br />&nbsp; P &nbsp; &nbsp;2&nbsp; &nbsp;17&nbsp; &nbsp;Betriebssystem: Hotfix (geplant)<br />&nbsp; &nbsp; &nbsp; &nbsp;2&nbsp; &nbsp;18&nbsp; &nbsp;Betriebssystem: Sicherheitspatch (nicht geplant)<br />&nbsp; P &nbsp; &nbsp;2&nbsp; &nbsp;18&nbsp; &nbsp;Betriebssystem: Sicherheitspatch (geplant)<br />E&nbsp; &nbsp;&nbsp; &nbsp;4&nbsp; &nbsp;1&nbsp; &nbsp;Anwendung: Wartung (nicht geplant)<br />E P &nbsp; &nbsp;4&nbsp; &nbsp;1&nbsp; &nbsp;Anwendung: Wartung (geplant)<br />E P &nbsp; &nbsp;4&nbsp; &nbsp;2&nbsp; &nbsp;Anwendung: Installiert (geplant)<br />E&nbsp; &nbsp;&nbsp; &nbsp;4&nbsp; &nbsp;5&nbsp; &nbsp;Anwendung: Reagiert nicht<br />E&nbsp; &nbsp;&nbsp; &nbsp;4&nbsp; &nbsp;6&nbsp; &nbsp;Anwendung: Instabil<br />&nbsp;U&nbsp; &nbsp; &nbsp;5&nbsp; &nbsp;15&nbsp; &nbsp;Systemfehler: Abbruchfehler<br />&nbsp;U&nbsp; &nbsp; &nbsp;5&nbsp; &nbsp;19&nbsp; &nbsp;Sicherheitsproblem<br />E&nbsp; &nbsp;&nbsp; &nbsp;5&nbsp; &nbsp;19&nbsp; &nbsp;Sicherheitsproblem<br />E P &nbsp; &nbsp;5&nbsp; &nbsp;19&nbsp; &nbsp;Sicherheitsproblem<br />E&nbsp; &nbsp;&nbsp; &nbsp;5&nbsp; &nbsp;20&nbsp; &nbsp;Netzwerkkonnektivität getrennt (nicht geplant)<br />&nbsp;U&nbsp; &nbsp; &nbsp;6&nbsp; &nbsp;11&nbsp; &nbsp;Stromversorgungsfehler: Kabel entfernt<br />&nbsp;U&nbsp; &nbsp; &nbsp;6&nbsp; &nbsp;12&nbsp; &nbsp;Stromversorgungsfehler: Umgebung<br />&nbsp; P &nbsp; &nbsp;7&nbsp; &nbsp;0&nbsp; &nbsp;Herunterfahren von Legacy-API<br /></code></pre></div><br />..... snip<br /><br />I found a TAB character before, between and behind the numbers.<br /><br />This code works for me:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off &amp;setlocal<br /><br />for /f &quot;tokens=2 delims=1234567890&quot; %%a in ('shutdown /?^|findstr /bc:&quot;E&quot;') do set &quot;TAB=%%a&quot;<br /><br />echo text%TAB%text<br />pause<br /><br /></code></pre></div><br />... but should be tested on other PC's and other Windows versions.<br /><br />Regards<br />aGerman<br /><br />[/EDIT]</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6854" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile6854">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist7125.html?mode=viewprofile&amp;u=417" class="username">jeb</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search73f1.html?author_id=417&amp;sr=posts">880</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 30 Aug 2007 08:05</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany, Bochum</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content6854">

						<h3 ><a href="#p6854">Re: new functions: :chr, :asc, :asciiMap</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting1c51.html?mode=quote&amp;f=3&amp;p=6854" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic9e6d.html?p=6854#p6854" onclick="prompt('Message #14',this.href); return false;">#14</a></span> 
									<a class="unread" href="viewtopic9e6d.html?p=6854#p6854" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist7125.html?mode=viewprofile&amp;u=417" class="username">jeb</a></strong> &raquo; </span>04 Apr 2011 16:22
			</p>
			
			
			
			<div class="content">Yes, you found it.  <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /> <br /><br />I tested it with XP and Vista and both works (Both also in a german version).<br /><br />And I build a code to get the TAB without findstr for a <em class="text-italics">constant</em> text or number.<br />It uses the FOR /F delims functionality to split at spaces and TAB.<br />First I split, then I replace the spaces and then I split again, a delim can be only a TAB then.<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />setlocal <br />call :BL.Strings.CreateTAB<br />echo TAB=#%tab%#<br />goto :eof<br /><br />:BL.Strings.CreateTAB<br />setlocal EnableDelayedExpansion<br />set &quot;TAB=#&quot;<br />for /F &quot;tokens=*&quot; %%a in ('shutdown /?') do (<br />&nbsp; &nbsp;set &quot;line=%%a&quot;<br />&nbsp; &nbsp;set &quot;line=!line: =!&quot;<br />&nbsp; &nbsp;for /F &quot;tokens=1,2*&quot; %%x in (&quot;!line!&quot;) do (<br />&nbsp; &nbsp;&nbsp; set &quot;split=!line:%%x=!&quot;<br />&nbsp; &nbsp;&nbsp; &nbsp;if &quot;%%y&quot; NEQ &quot;&quot; (&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;set &quot;tab=!split:~0,1!&quot;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;goto :tab_found<br />&nbsp; &nbsp;&nbsp; &nbsp;)<br />&nbsp; &nbsp;)<br />)<br />:tab_found<br />(<br />&nbsp; &nbsp;endlocal<br />&nbsp; &nbsp;set &quot;TAB=%tab%&quot;<br />&nbsp; &nbsp;goto :eof<br />)<br /><br />goto :eof<br /></code></pre></div><br /><br />jeb</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p6855" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile6855">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search661c.html?author_id=1265&amp;sr=posts">3386</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 22 Jan 2010 18:01</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content6855">

						<h3 ><a href="#p6855">Re: new functions: :chr, :asc, :asciiMap</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingea42.html?mode=quote&amp;f=3&amp;p=6855" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic45d0-2.html?p=6855#p6855" onclick="prompt('Message #15',this.href); return false;">#15</a></span> 
									<a class="unread" href="viewtopic45d0-2.html?p=6855#p6855" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a></strong> &raquo; </span>04 Apr 2011 17:01
			</p>
			
			
			
			<div class="content">Good idea, jeb!<br />Honestly I'm not sure whether the E is language independent or not. Maybe I can check this at work. The half of the commands are in English, hopefully shutdown is one of them.<br /><br />Regards<br />aGerman</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
	

	<div class="action-bar bar-bottom">
	
			<a href="postingeebd.html?mode=reply&amp;f=3&amp;t=1733" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic1609.html?f=3&amp;t=1733&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

			<form method="post" action="https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=1733">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			32 posts
							<ul>
		<li class="active"><span>1</span></li>
				<li><a class="button" href="viewtopic116d.html?f=3&amp;t=1733&amp;start=15" role="button">2</a></li>
				<li><a class="button" href="viewtopicdcad.html?f=3&amp;t=1733&amp;start=30" role="button">3</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopic116d.html?f=3&amp;t=1733&amp;start=15" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="viewforum4d6b.html?f=3" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to “DOS Batch Forum”</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="viewforum31e6.html?f=4" class="jumpbox-cat-link"> <span> DosTips - Dos Batch</span></a></li>
																<li><a href="viewforum4d6b.html?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; DOS Batch Forum</span></a></li>
											</ul>
		</div>
	</div>

	</div>


			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
							<span class="crumb"><a href="../index.html" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>DosTips.com</span></a></span>									<span class="crumb"><a href="index.html" data-navbar-reference="index"><span>Board index</span></a></span>					</li>
		
				<li class="rightside">All times are <span title="UTC-6">UTC-06:00</span></li>
							<li class="rightside">
				<a href="ucp033a.html?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete all board cookies</span>
				</a>
			</li>
												<li class="rightside" data-last-responsive="true">
				<a href="memberlist4bfd.html?mode=team" role="menuitem">
					<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
				</a>
			</li>
									<li class="rightside" data-last-responsive="true">
				<a href="memberlist8733.html?mode=contactadmin" role="menuitem">
					<i class="icon fa-envelope fa-fw" aria-hidden="true"></i><span>Contact us</span>
				</a>
			</li>
			</ul>

	</div>
</div>

	<div class="copyright">
				<!-- WARNING NO DELETE -->Style developer by <a href="http://tricolor.x-tk.ru/">support forum tricolor</a>, <!-- END WARNING NO DELETE -->Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
									</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	<img src="cron5089.gif?cron_type=cron.task.text_reparser.post_text" width="1" height="1" alt="cron" /></div>

<script type="text/javascript" src="assets/javascript/jquery.mind772.js?assets_version=34"></script>
<script type="text/javascript" src="assets/javascript/cored772.js?assets_version=34"></script>



<script type="text/javascript" src="styles/prosilver/template/forum_fnd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/prosilver/template/ajaxd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/jquery-uid772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/collapsed772.js?assets_version=34"></script>



</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=1733 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 09:05:06 GMT -->
</html>
