<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=7147 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 08:20:25 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>Listb - a file explorer/viewer inside the console window - DosTips.com</title>


	<link rel="canonical" href="viewtopiccdec.html?t=7147">

<!--
	phpBB style name: Allan Style - SUBSILVER
	Based on style:   prosilver (this is the default phpBB3 style)
	Based on style:   subsilver2 (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:  Allan ( http://x-tk.ru/ )
-->

<link href="assets/css/font-awesome.mind772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/stylesheetd772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/en/stylesheetd772.css?assets_version=34" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="./styles/AllanStyle-SUBSILVER/theme/tweaks.css?assets_version=34" rel="stylesheet">
<![endif]-->




<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','../../www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-280191-1', 'auto');
	ga('send', 'pageview');
</script>

</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">

<div id="header-subsilver">
	<a id="top" class="top-anchor" accesskey="t"></a>
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description" class="site-description">
				<a id="logo" class="logo" href="../index.html" title="DosTips.com"><span class="site_logo"></span></a>
				<h1>DosTips.com</h1>
				<p>A Forum all about DOS Batch</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

									<div id="search-box" class="search-box search-header" role="search">
				<form action="https://www.dostips.com/forum/search.php" method="get" id="search">
				<fieldset>
					<input name="keywords" id="keywords" type="search" maxlength="128" title="Search for keywords" class="inputbox search tiny" size="20" value="" placeholder="Search…" />
					<button class="button button-search" type="submit" title="Search">
						<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
					</button>
					<a href="search.html" class="button button-search-end" title="Advanced search">
						<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
					</a>
					
				</fieldset>
				</form>
			</div>
						
			</div>
					</div>
</div>


<div id="wrap" class="wrap">
	<div id="page-header">
				<div class="navbar-top" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
																									<li>
								<a href="search33a7.html?search_id=unanswered" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="search526f.html?search_id=active_topics" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-blue" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="search.html" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
											<li class="separator"></li>
																			<li>
								<a href="memberlist4bfd.html?mode=team" role="menuitem">
									<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
								</a>
							</li>
																<li class="separator"></li>

									</ul>
			</div>
		</li>

				<li data-skip-responsive="true">
			<a href="app.php/help/faq.html" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
						
			<li class="rightside"  data-skip-responsive="true">
			<a href="ucp26c3.html?mode=login" title="Login" accesskey="x" role="menuitem">
				<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Login</span>
			</a>
		</li>
					<li class="rightside" data-skip-responsive="true">
				<a href="ucp8319.html?mode=register" role="menuitem">
					<i class="icon fa-pencil-square-o  fa-fw" aria-hidden="true"></i><span>Register</span>
				</a>
			</li>
						</ul>

	</div>
</div>

<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
						<li class="breadcrumbs">
							<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="../index.html" itemprop="url" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span itemprop="title">DosTips.com</span></a></span>
										<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="index.html" itemprop="url" accesskey="h" data-navbar-reference="index"><span itemprop="title">Board index</span></a></span>

											<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="4"><a href="viewforum31e6.html?f=4" itemprop="url"><span itemprop="title">DosTips - Dos Batch</span></a></span>
															<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="3"><a href="viewforum4d6b.html?f=3" itemprop="url"><span itemprop="title">DOS Batch Forum</span></a></span>
												</li>
		
					<li class="rightside responsive-search">
				<a href="search.html" title="View the advanced search options" role="menuitem">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</a>
			</li>
			</ul>

	</div>
</div>

<div class="navbar-top-link">
	<div class="inner">
		<ul>
			<li class="navbar-top-link-left"><a href="search33a7.html?search_id=unanswered">Unanswered topics</a></li>
			<li class="navbar-top-link-left"><a href="search526f.html?search_id=active_topics">Active topics</a></li>

											</ul>
	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
		
<h2 class="topic-title"><a href="viewtopic247d.html?f=3&amp;t=7147">Listb - a file explorer/viewer inside the console window</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">Discussion forum for all Windows batch related topics.<br /></div>
<p>
	<strong>Moderator:</strong> <a href="memberlista6a8.html?mode=viewprofile&amp;u=5" class="username">DosItHelp</a>
</p>


<div class="action-bar bar-top">
	
			<a href="postingda97.html?mode=reply&amp;f=3&amp;t=7147" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopice053.html?f=3&amp;t=7147&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="https://www.dostips.com/forum/search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topic…" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="search.html" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="7147" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			28 posts
							<ul>
		<li class="active"><span>1</span></li>
				<li><a class="button" href="viewtopicdf60.html?f=3&amp;t=7147&amp;start=15" role="button">2</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopicdf60.html?f=3&amp;t=7147&amp;start=15" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
		</div>




<div id="subsilver-nav-topic">
	<div class="inner"><div class="post has-profile">
		<div class="leftsided postbody subsilver-topic-title">Message</div>
		<div class="leftsided postprofile subsilver-topic-author">Author</div>
	</div></div>
</div>

			<div id="p46597" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile46597">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist54f1.html?mode=viewprofile&amp;u=8229" class="username">misol101</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha06d.html?author_id=8229&amp;sr=posts">356</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 02 May 2016 18:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content46597">

						<h3 class="first"><a href="#p46597">Listb - a file explorer/viewer inside the console window</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingc2b9-2.html?mode=quote&amp;f=3&amp;p=46597" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic6988.html?p=46597#p46597" onclick="prompt('Message #1',this.href); return false;">#1</a></span> 
									<a class="unread" href="viewtopic6988.html?p=46597#p46597" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist54f1.html?mode=viewprofile&amp;u=8229" class="username">misol101</a></strong> &raquo; </span>12 May 2016 14:00
			</p>
			
			
			
			<div class="content">This script was included in the gotoxy archive, but I feel it could use its own thread.<br /><br /><img src="https://uc0a9898107aa1596f1a3bc63b31.dl.dropboxusercontent.com/cd/0/inline/ATYmCuJhL4mFSPmzT7QLmtE3ZC03lGCtbs5pt3N9H3QmrQZryZ3AtTBu6AA_KdNrh-Tr9cYNprkHNLhy7J9rYl7wqsfwKnDkPhwoP0gsAj4dAA3QLzR-bOgTfEjz2L9oKVuV3T93odCHQd4IXDnOD0Tsha-wS67sg6d-hPKSEAgN8em4cGMX-GHiTxpLBh0xDlc/file" class="postimage" alt="Image" /><br /><br /><strong class="text-strong">What is it?</strong><br />Listb is a file explorer to browse/view/copy etc files inside the console window. It is also reasonably easy to extend with added funtionality building on the separate extendlistb.bat.<br />Listb was inspired by List for DOS by Vernon D. Buerg, which no longer works for modern Windows machines.<br /><br /><strong class="text-strong">Where is it?</strong><br />Here: <a href="http://www.mediafire.com/download/2jnxy6vywh5arv6/listb.zip" class="postlink">http://www.mediafire.com/download/2jnxy6vywh5arv6/listb.zip</a>. Or it can be git cloned from <!-- m --><a class="postlink" href="https://github.com/misol1/gotoxy">https://github.com/misol1/gotoxy</a><!-- m --> (which also has a lot of other stuff)<br /><br /><strong class="text-strong">What are the requirements?</strong><br />Listb.bat must be put in a PATH folder, otherwise Listb will cease to work when you browse to a separate folder than the one you started in. The same is true for extendlistb.bat, as well as the gotoxy.exe and cmdwiz.exe tools(included), which are used by Listb. Also, I use a small extra batch file called l.bat to make listb quicker to launch and work better (including making use of extendlistb.bat), put l.bat in a PATH folder too.<br /><br />It is highly recommended to run listb by running l.bat. The arguments to l.bat are the same as for listb.bat below, but if arguments are not given, it does a better job of setting up the environment automatically.<br /><br /><strong class="text-strong">What are the arguments to Listb/l.bat?</strong><br />listb [path] [width] [height] [-][columns] [extend_path\name] [mouse]<br /><br />[path] specifies which folder to start in. If not specified, this is &quot;.&quot;, the current folder<br />[width] Number of columns (default is 80)<br />[rows] Number of rows (default is 50)<br />[columns] Number of file columns used. Default is 4. (this can be changed while running by pressing 1-9). A negative value enables adaptive columns, and the number then represents the maximum number of columns. <br />[extend_path\name] Path to optional script with extended functionality for Listb (this can be either an ABOLUTE path, or a PATH folder using the syntax for that). extendlistb.bat is included, and is pointed to by l.bat by assuming it is in a PATH folder.<br />[mouse] if this argument is &quot;Y&quot;, then mouse support is enabled (you can click on files to go there, doubleclick to view it, right doubleclick to run/invoke it)<br /><br /><strong class="text-strong">Do I need to edit something before running Listb/l.bat?</strong><br />No, it will work fine as long as you put all the files in a PATH folder.<br /><br />The default view and edit commands are set to work for everyone at first, but I personally prefer other options. The default is to use &quot;more&quot; to view files, and &quot;notepad&quot; to edit them. I prefer to use less for view and b.exe for editing. To change this, open extendlistb.bat and search for &quot;SETVIEWERS&quot;. Then change them to whatever you would like to use.<br /><br /><strong class="text-strong">What functionality does Listb have?</strong><br />Press F1 or ? to see what keys are available. Most of it is centered around copying/moving/deleting one or more files (select several files with Space), but there is plenty of other functionality too. A nice feature is pressing 'i', which will run whatever program is associated with the extension of the file (a jpeg file will show in an image viewer, an exe file will run etc).<br />If any of the functionality is unclear or does not work as expected, please report that.<br /><br /><strong class="text-strong">What are the limitations?</strong><br />Things get rather slow when there are many files in a folder (say more than 2000). As for bugs, please report them. Also, see Listb.KNOWN_ISSUES (included)</div>

			
													<div class="notice">
					Last edited by <a href="memberlist54f1.html?mode=viewprofile&amp;u=8229" class="username">misol101</a> on 16 Apr 2017 13:44, edited 8 times in total.
									</div>
			
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p46598" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile46598">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist54f1.html?mode=viewprofile&amp;u=8229" class="username">misol101</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha06d.html?author_id=8229&amp;sr=posts">356</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 02 May 2016 18:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content46598">

						<h3 ><a href="#p46598">Re: Listb - a file explorer/viewer inside the console window</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingf459.html?mode=quote&amp;f=3&amp;p=46598" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic4f4b.html?p=46598#p46598" onclick="prompt('Message #2',this.href); return false;">#2</a></span> 
									<a class="unread" href="viewtopic4f4b.html?p=46598#p46598" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist54f1.html?mode=viewprofile&amp;u=8229" class="username">misol101</a></strong> &raquo; </span>12 May 2016 14:04
			</p>
			
			
			
			<div class="content">Here's the Listb script. If you see weird, non-optimal or stupid things please tell me.<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>:: LISTb : Mikael Sollenborn 2015-16<br />@echo off<br />if &quot;%~1&quot;==&quot;_YESNO&quot; call :YESNO %2&amp;goto :eof<br />if &quot;%~1&quot;==&quot;_GETANSWER&quot; call :GETANSWER %2 %3&amp;goto :eof<br />if &quot;%~1&quot;==&quot;_SHOWBOTTOMBAR&quot; call :SHOWBOTTOMBAR %2&amp;goto :eof<br />if &quot;%~1&quot;==&quot;_COUNTITEMS&quot; call :COUNTITEMS %2 %3&amp;goto :eof<br /><br />setlocal ENABLEDELAYEDEXPANSION<br />cmdwiz showcursor 0<br />set COLS=80&amp;if not &quot;%2&quot; == &quot;&quot; set /A COLS=%2&amp;if !COLS! lss 80 set COLS=80<br />set LINES=50&amp;if not &quot;%3&quot; == &quot;&quot; set /A LINES=%3&amp;if !LINES! lss 20 set LINES=20<br />set ADAPTCPS=0&amp;set MAXCPS=0<br />set COLSPERSCR=4&amp;if not &quot;%4&quot; == &quot;&quot; set COLSPERSCR=%4&amp;(if !COLSPERSCR! lss 0 set ADAPTCPS=1&amp;set /A MAXCPS=-!COLSPERSCR!&amp;set /A COLSPERSCR=-!COLSPERSCR!)&amp;(if !COLSPERSCR! gtr 9 set COLSPERSCR=9)&amp;if !COLSPERSCR! lss 1 set COLSPERSCR=1<br />if %MAXCPS%==0 set MAXCPS=%COLSPERSCR%<br />set OLDCOLSPERSCR=%COLSPERSCR%<br />cls<br />mode con lines=%LINES% cols=%COLS%<br />set OLDCOLS=%COLS%<br />set BAR=&quot;&quot;<br />for /L %%a in (1,1,%COLS%) do set BAR=&quot;!BAR:~1,-1! &quot;<br />set /a BARPOS=%LINES%-1<br />set MYTEMP=<br />if not &quot;%TMP%&quot; == &quot;&quot; set MYTEMP=%TMP%\<br />if not &quot;%TEMP%&quot; == &quot;&quot; set MYTEMP=%TEMP%\<br />set UPDATEBOTTOM=0<br />set DIR1=&quot;%CD%&quot;<br />if not &quot;%1&quot; == &quot;&quot; cd /D %1 2&gt;nul<br />set DIR0=&quot;%CD%&quot;<br />set DIRP=0<br />set DIROP=1<br />set FCOUNTSUB=0<br />set SORT=N<br />set EXTEND=&quot;&quot;&amp;if not &quot;%~5&quot; == &quot;&quot; set EXTEND=&quot;%~5&quot;<br />set CLIPB=<br />set HDIV=1<br />set DETAILS=0<br /><br />set BARCOL=3<br />set BARTEXTCOL=F<br />set BARINFOCOL=0<br />set CURRCOL=1<br />cmdwiz getconsolecolor bg<br />if &quot;%CURRCOL%&quot; == &quot;!ERRORLEVEL!&quot; (if not &quot;%CURRCOL%&quot;==&quot;0&quot; set CURRCOL=0)&amp;(if &quot;%CURRCOL%&quot;==&quot;0&quot; set CURRCOL=1)<br />set FILECOL=u<br />set DIRCOL=B<br />set SELCOL=4<br />set PATHNOFCOL=B<br />set SELCHAR=\g07<br />set HLPC1=\BU<br />set HLPC2=\7U<br />if not %EXTEND% == &quot;&quot; if exist %EXTEND% call %EXTEND% _SET_COLORS<br /><br />set SCHR=&quot;()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ&#91;\&#93; _ abcdefghijklmnopqrstuvwxyz{|}~&quot;<br /><br />set MOUSESUPPORT=0<br />if /I &quot;%~6&quot; == &quot;Y&quot; set MOUSESUPPORT=1<br />if %MOUSESUPPORT%==1 cmdwiz getquickedit &amp; set QE=!errorlevel!&amp;cmdwiz setquickedit 0<br /><br />set VIEWCMD=&quot;more # ^&amp;cmdwiz getch&quot;<br />set EDITCMD=start notepad<br />set NEWCMDWINDOW=start<br />if not %EXTEND% == &quot;&quot; if exist %EXTEND% call %EXTEND% _SET_VIEWERS<br /><br />call :MAKEDIRLIST<br />call :SHOWLIST<br /><br />:MAINLOOP<br />cmdwiz getch_and_mouse&gt;nul<br />set MR=%ERRORLEVEL%<br />if %MR% == -1 goto MAINLOOP<br />set /a KEY=(%MR%^&gt;^&gt;22)<br />if %MOUSESUPPORT%==1 set /a MT=%MR% ^&amp; 1 &amp;if !MT! == 1 call :PROCESS_MOUSE &amp; if !DBLCL!==0 if !KEY!==0 goto MAINLOOP<br /><br />if %KEY% == 336 set OLDPOS=%CURRPOS%&amp;set /a CURRPOS+=1 &amp; call :UPDATELIST &amp; goto MAINLOOP &amp; rem DOWN<br />if %KEY% == 328 set OLDPOS=%CURRPOS%&amp;set /a CURRPOS-=1 &amp; call :UPDATELIST &amp; goto MAINLOOP &amp; rem UP<br />if %KEY% == 331 set OLDPOS=%CURRPOS%&amp;set /a CURRPOS-=%LH% &amp; call :UPDATELIST &amp; goto MAINLOOP &amp; rem LEFT<br />if %KEY% == 333 set OLDPOS=%CURRPOS%&amp;set /a CURRPOS+=%LH% &amp; call :UPDATELIST &amp; goto MAINLOOP &amp; rem RIGHT<br />if %KEY% == 327 set OLDPOS=%CURRPOS%&amp;set CURRPOS=0&amp; call :UPDATELIST &amp; goto MAINLOOP &amp; rem HOME<br />if %KEY% == 335 set OLDPOS=%CURRPOS%&amp;set CURRPOS=%FCOUNT%&amp; call :UPDATELIST &amp; goto MAINLOOP &amp; rem END<br />if %KEY% == 337 set OLDPOS=%CURRPOS%&amp;set /a CURRPOS+=%LH%*%COLSPERSCR% &amp; call :UPDATELIST &amp; goto MAINLOOP &amp; rem PAGEDOWN<br />if %KEY% == 329 set OLDPOS=%CURRPOS%&amp;set /a CURRPOS-=%LH%*%COLSPERSCR% &amp; call :UPDATELIST &amp; goto MAINLOOP &amp; rem PAGEUP<br />if %UPDATEBOTTOM%==1 set UPDATEBOTTOM=0&amp;call :SHOWBOTTOMBAR<br /><br />if %KEY% == 32 call :MARKITEM &amp; goto MAINLOOP &amp; rem SPACE<br /><br />set LKEY=&quot;&quot;<br />set OR=0&amp;(if %KEY% gtr 126 set OR=1)&amp;(if %KEY% lss 40 set OR=1)&amp;if !OR!==1 goto NOALTPRESSED<br />set /A MKEY=%KEY%-40+1<br />set LKEY=&quot;!SCHR:~%MKEY%,1!&quot;<br /><br />cmdwiz getkeystate alt&gt;nul<br />set /a TR = %ERRORLEVEL% ^&amp; 1&amp; if !TR! == 0 goto NOALTPRESSED<br />set /a TC=%CURRPOS%+1<br />for /L %%a in (%TC%,1,%FCOUNTSUB%) do set FTP=!FO%%a!&amp;set FTP=!FTP:~1,1!&amp;if &quot;!FTP!&quot;==%LKEY% set OLDPOS=%CURRPOS%&amp; set CURRPOS=%%a&amp; call :UPDATELIST &amp; goto MAINLOOP<br />for /L %%a in (0,1,%FCOUNTSUB%) do set FTP=!FO%%a!&amp;set FTP=!FTP:~1,1!&amp;if &quot;!FTP!&quot;==%LKEY% set OLDPOS=%CURRPOS%&amp; set CURRPOS=%%a&amp; call :UPDATELIST &amp; goto MAINLOOP<br />goto MAINLOOP<br />:NOALTPRESSED<br /><br />if %KEY% == 13 if &quot;!FT%CURRPOS%!&quot;==&quot;/&quot; cd !FO%CURRPOS%!&amp;call :MAKEDIRLIST&amp;call :SHOWLIST &amp; rem RETURN/^M (folder)<br />if %KEY% == 13 if not &quot;!FT%CURRPOS%!&quot;==&quot;/&quot; cls&amp;set ANSWER=%VIEWCMD%&amp;call :SPLITANSWER &amp;cmd /C !ANSWER! !FO%CURRPOS%! !ANSWER2!&amp;call :SHOWLIST R &amp; rem RETURN/^M (file)<br /><br />if %KEY% == 315 call :SHOWHELP &amp; rem F1<br />if %KEY% == 27 goto EXITLIST &amp; rem ESC<br />if %KEY% == 6 call :GETANSWER &quot;Search for:&quot; STRIPQUOTES&amp; if not &quot;!ANSWER!&quot;==&quot;&quot; call :FINDOP &amp; rem ^F<br />if %LKEY% == &quot;?&quot; call :SHOWHELP<br />if %LKEY% == &quot;+&quot; (if !DETAILS!==1 for /L %%a in (0,1,%FCOUNTSUB%) do set FL%%a=) &amp; set /a DETAILS=1-%DETAILS% &amp; (if !DETAILS!==1 set OLDCOLSPERSCR=%COLSPERSCR%) &amp; (if !DETAILS!==0 set COLSPERSCR=%OLDCOLSPERSCR%) &amp; call :MAKEDIRLIST R&amp;call :SHOWLIST<br />if %LKEY% == &quot;x&quot; goto EXITLIST<br />if %LKEY% == &quot;q&quot; goto EXITLIST<br />if %LKEY% == &quot;y&quot;&nbsp; set DIR%DIRP%=&quot;%CD%&quot;&amp;set /a DIRP=1-%DIRP% &amp; cd /D !DIR%DIROP%! &amp;set /a DIROP=1-!DIRP!&amp;call :MAKEDIRLIST&amp;call :SHOWLIST<br />if %LKEY% == &quot;s&quot; call :GETANSWER &quot;Command:&quot;&amp; if not &quot;!ANSWER!&quot;==&quot;&quot; cls&amp;cmdwiz showcursor 1&amp;cmd /C &quot;!ANSWER!&quot;&amp;mode con lines=%LINES% cols=%COLS%&amp;cmdwiz showcursor 0&amp;call :MAKEDIRLIST R&amp;call :SHOWLIST<br />if %LKEY% == &quot;S&quot; call :GETANSWER &quot;Command:&quot;&amp; if not &quot;!ANSWER!&quot;==&quot;&quot; cls&amp;cmdwiz showcursor 1&amp;cmd /C &quot;!ANSWER!&quot;&amp;call :PAUSE \n&amp;mode con lines=%LINES% cols=%COLS%&amp;cmdwiz showcursor 0&amp;call :MAKEDIRLIST R&amp;call :SHOWLIST<br />if %LKEY% == &quot;o&quot; call :SORTOP<br />if %LKEY% == &quot;p&quot; %NEWCMDWINDOW%<br />if %LKEY% == &quot;&lt;&quot; call :GOTOPARENT<br />if %KEY% == 8 call :GOTOPARENT &amp; rem BACKSPACE/^H<br />if %KEY% geq 49 if %KEY% leq 57 set /a COLSPERSCR=%KEY%-48 &amp; (if %DETAILS%==1 set DETAILS=0&amp;for /L %%a in (0,1,%FCOUNTSUB%) do set FL%%a=) &amp; call :SHOWLIST R &amp; rem 1-9<br />if %LKEY% == &quot;0&quot; set /A ADAPTCPS=1-%ADAPTCPS%&amp;if %DETAILS%==0 call :CALCNOFCOLUMNS&amp;call :SHOWLIST<br /><br />if %LKEY% == &quot;i&quot; if not &quot;!FT%CURRPOS%!&quot;==&quot;/&quot; call :LAUNCHFILE !FO%CURRPOS%!<br />if %LKEY% == &quot;j&quot; if not &quot;!FT%CURRPOS%!&quot;==&quot;/&quot; call :LAUNCHFILE !FO%CURRPOS%! 1<br />if %LKEY% == &quot;I&quot; call :GETANSWER &quot;Action, # inserts filename:&quot;&amp; if not &quot;!ANSWER!&quot;==&quot;&quot; call :SPLITANSWER &amp;cls&amp;cmd /C !ANSWER! !FO%CURRPOS%! !ANSWER2!&amp;call :PAUSE \n&amp;mode con lines=%LINES% cols=%COLS%&amp;cmdwiz showcursor 0&amp;call :MAKEDIRLIST R&amp;call :SHOWLIST<br />if %LKEY% == &quot;e&quot; if not &quot;!FT%CURRPOS%!&quot;==&quot;/&quot; cmd /C %EDITCMD% !FO%CURRPOS%!<br />if %LKEY% == &quot;E&quot; call :GETANSWER &quot;Edit file:&quot;&amp; if not &quot;!ANSWER!&quot;==&quot;&quot; cmd /C %EDITCMD% !ANSWER! &amp; call :MAKEDIRLIST R&amp;call :SHOWLIST<br />if %LKEY% == &quot;f&quot; if not &quot;!FT%CURRPOS%!&quot;==&quot;/&quot; set OLDDIRCMD=%DIRCMD%&amp; set DIRCMD=&amp; cmd /C dir /-C /A !FO%CURRPOS%!|find !FO%CURRPOS%!&gt;%MYTEMP%out.dat&amp;set DIRCMD=!OLDDIRCMD!&amp;set OLDDIRCMD=&amp;for /F &quot;tokens=*&quot; %%a in (%MYTEMP%out.dat) do set INF=&quot;%%a &quot;&amp;call :SHOWBOTTOMBAR !INF!<br />if %LKEY% == &quot;f&quot; if &quot;!FT%CURRPOS%!&quot;==&quot;/&quot; if not !FO%CURRPOS%!==&quot;..&quot; set OLDDIRCMD=%DIRCMD%&amp; set DIRCMD=&amp;cmd /C dir /A /-C&gt;%MYTEMP%out.dat&amp;set DIRCMD=!OLDDIRCMD!&amp;set OLDDIRCMD=&amp;for /F &quot;tokens=1,2,3*&quot; %%a in (%MYTEMP%out.dat) do if &quot;%%d&quot;==!FO%CURRPOS%! set INF=&quot;%%a&nbsp; %%b&nbsp; &nbsp; %%c&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; %%d&quot;&amp;call :SHOWBOTTOMBAR !INF!&amp; rem f for folder (a hack)<br />if %LKEY% == &quot;F&quot; call :SHOWBOTTOMBAR !FO%CURRPOS%!<br />if %LKEY% == &quot;d&quot; if not &quot;!FT%CURRPOS%!&quot;==&quot;/&quot; call :YESNO &quot;Really delete?(y/n) &quot; &amp; if &quot;!ANSWER!&quot;==&quot;Y&quot; cmd /C del !FO%CURRPOS%!&amp;call :MAKEDIRLIST R&amp;call :SHOWLIST<br />if %LKEY% == &quot;r&quot; call :GETANSWER &quot;Rename to:&quot;&amp; if not &quot;!ANSWER!&quot;==&quot;&quot; rename !FO%CURRPOS%! &quot;!ANSWER!&quot;&amp;call :MAKEDIRLIST R&amp;call :SHOWLIST<br />if %LKEY% == &quot;c&quot; if not &quot;!FT%CURRPOS%!&quot;==&quot;/&quot; call :GETANSWER &quot;Copy file to:&quot; STRIPQUOTES&amp; if not &quot;!ANSWER!&quot;==&quot;&quot; call :COPYOP !FO%CURRPOS%! &quot;!ANSWER!&quot; copy Copied &quot; to !ANSWER!.&quot;&amp; call :MAKEDIRLIST R&amp;call :SHOWLIST<br />if %LKEY% == &quot;m&quot; if not !FO%CURRPOS%!==&quot;..&quot; call :GETANSWER &quot;Move file/folder to:&quot; STRIPQUOTES&amp; if not &quot;!ANSWER!&quot;==&quot;&quot; if exist &quot;!ANSWER!\&quot; call :COPYOP !FO%CURRPOS%! &quot;!ANSWER!&quot; move Moved &quot; to !ANSWER!.&quot;&amp; call :MAKEDIRLIST R&amp;call :SHOWLIST<br />if %LKEY% == &quot;k&quot; call :GETANSWER &quot;New folder:&quot;&amp; if not &quot;!ANSWER!&quot;==&quot;&quot; cmd /C mkdir !ANSWER! &amp; call :MAKEDIRLIST R&amp;call :SHOWLIST<br />if %LKEY% == &quot;/&quot; call :GETANSWER &quot;Go to path:&quot; STRIPQUOTES&amp; if not &quot;!ANSWER!&quot;==&quot;&quot; call :SETPATHOP &quot;!ANSWER!&quot;<br />if %LKEY% == &quot;Y&quot; if not &quot;!FT%CURRPOS%!&quot;==&quot;/&quot; if not !DIR%DIROP%!==&quot;%CD%&quot; call :COPYOP !FO%CURRPOS%! !DIR%DIROP%! copy Copied &quot; to alternate path.&quot;<br />if %KEY% == 25 if not !FO%CURRPOS%!==&quot;..&quot; if not !DIR%DIROP%!==&quot;%CD%&quot; call :COPYOP !FO%CURRPOS%! !DIR%DIROP%! move Moved &quot; to alternate path.&quot; &amp; call :MAKEDIRLIST R&amp;call :SHOWLIST &amp; rem ^Y<br /><br />if %LKEY% == &quot;D&quot; call :MULTIDELOP<br />if %LKEY% == &quot;C&quot; call :COUNTITEMS CNT&amp; (if !CNT! lss 1 call :SHOWBOTTOMBAR &quot;No files selected.&quot;) &amp; if !CNT! geq 1 call :GETANSWER &quot;Copy selected files to:&quot; STRIPQUOTES&amp; if not &quot;!ANSWER!&quot;==&quot;&quot; if exist &quot;!ANSWER!\&quot; call :MULTICOPYOP copy &quot;!ANSWER!&quot; SKIPYN<br />if %LKEY% == &quot;M&quot; call :COUNTITEMS CNT Y&amp; (if !CNT! lss 1 call :SHOWBOTTOMBAR &quot;No files selected.&quot;) &amp; if !CNT! geq 1 call :GETANSWER &quot;Move selected files to:&quot; STRIPQUOTES&amp; if not &quot;!ANSWER!&quot;==&quot;&quot; if exist &quot;!ANSWER!\&quot; call :MULTICOPYOP move &quot;!ANSWER!&quot; SKIPYN<br />if %LKEY% == &quot;T&quot; (if !DIR%DIROP%!==&quot;%CD%&quot; call :SHOWBOTTOMBAR &quot;Both paths are the same.&quot;) &amp; if not !DIR%DIROP%!==&quot;%CD%&quot; call :MULTICOPYOP copy !DIR%DIROP%!<br />if %KEY% == 20 (if !DIR%DIROP%!==&quot;%CD%&quot; call :SHOWBOTTOMBAR &quot;Both paths are the same.&quot;) &amp; if not !DIR%DIROP%!==&quot;%CD%&quot; call :MULTICOPYOP move !DIR%DIROP%!&amp; rem ^T<br />if %KEY% == 9 call :MULTIOP &amp; rem ^I<br /><br />if %LKEY% == &quot;v&quot; if not !FO%CURRPOS%!==&quot;..&quot; call :PUTINCB 3 &amp;call :SHOWBOTTOMBAR &quot;Cleared clipboard and added item.&quot;<br />if %LKEY% == &quot;V&quot; if not !FO%CURRPOS%!==&quot;..&quot; call :PUTINCB 4 &amp;call :SHOWBOTTOMBAR &quot;Added item to clipboard.&quot;<br />if %LKEY% == &quot;b&quot; call :COUNTITEMS CNT Y &amp; (if !CNT! lss 1 call :SHOWBOTTOMBAR &quot;No files selected.&quot;) &amp; if !CNT! geq 1 call :PUTINCB 1 &amp;call :SHOWBOTTOMBAR &quot;Cleared clipboard and added item(s).&quot;<br />if %LKEY% == &quot;B&quot; call :CLIPBOARDCOPYOP copy<br />if %KEY% == 2 call :CLIPBOARDCOPYOP move&amp; rem ^B<br />::if %KEY% == 22 call :COUNTITEMS CNT Y &amp; (if !CNT! lss 1 call :SHOWBOTTOMBAR &quot;No files selected.&quot;) &amp; if !CNT! geq 1 call :PUTINCB 2 &amp;call :SHOWBOTTOMBAR &quot;Added item(s) to clipboard.&quot;&amp; rem ^V<br /><br />if not %EXTEND% == &quot;&quot; if exist %EXTEND% call :EXTENDOP<br /><br />if %LKEY% == &quot;U&quot; call :MAKEDIRLIST&amp;call :SHOWLIST<br /><br />goto MAINLOOP<br /><br />:EXITLIST<br />cmdwiz showcursor 1<br />if %MOUSESUPPORT%==1 cmdwiz setquickedit %QE%<br />set /a LINES-=1<br />gotoxy 0 !LINES!<br />endlocal&amp;if %LKEY%==&quot;x&quot; cd &quot;%CD%&quot;<br />goto :eof<br /><br /><br />:CLIPBOARDCOPYOP<br />cmdwiz stringlen &quot;%CLIPB%&quot;<br />if !ERRORLEVEL! == 0 call :SHOWBOTTOMBAR &quot;No items in clipboard.&quot;&amp;goto :eof<br />if &quot;%1&quot;==&quot;copy&quot; call :YESNO &quot;Really %1 ALL selected files from clipboard?(y/n) &quot; <br />if &quot;%1&quot;==&quot;move&quot; call :YESNO &quot;Really %1 ALL selected files/folders from clipboard?(y/n) &quot; <br />if &quot;!ANSWER!&quot;==&quot;N&quot; goto :eof<br />if &quot;%1&quot;==&quot;copy&quot; for /D %%a in (%CLIPB%) do if not exist &quot;%%a\&quot; call :COPYOP %%a &quot;.&quot; copy Copied &quot;.&quot;<br />if &quot;%1&quot;==&quot;move&quot; for /D %%a in (%CLIPB%) do call :COPYOP %%a &quot;.&quot; move Moved &quot;.&quot;<br />call :MAKEDIRLIST R<br />call :SHOWLIST<br />set CLIPB=<br />goto :eof<br /><br /><br />:PUTINCB<br />if not %1 == 2 if not %1 == 4 set CLIPB=<br />if %1 geq 3 set CLIPB=!CLIPB! &quot;%CD%\!FO%CURRPOS%:~1,-1!&quot;&amp;goto :eof<br />for /L %%a in (0,1,%FCOUNTSUB%) do if not &quot;!FS%%a!&quot;==&quot;&quot; set CLIPB=!CLIPB! &quot;%CD%\!FO%%a:~1,-1!&quot;<br />call :CLEARSELECTED<br />call :SHOWLIST<br />goto :eof<br /><br /><br />:GOTOPARENT<br />echo &quot;%CD%&quot;&gt;%MYTEMP%out.dat<br />set ANSWER=<br />for /F &quot;delims=\ tokens=*&quot; %%a in (%MYTEMP%out.dat) do set ANSWER=%%~nxa<br />cd ..&amp;call :MAKEDIRLIST<br />if not &quot;%ANSWER%&quot; == &quot;&quot; call :FINDOP SKIPSHOW<br />call :SHOWLIST<br />goto :eof<br /><br /><br />:EXTENDOP<br />call %EXTEND% !FO%CURRPOS%!<br />set RESULT=%ERRORLEVEL%<br />if %RESULT% equ 1 call :SHOWLIST<br />if %RESULT% equ 2 call :MAKEDIRLIST&amp;call :SHOWLIST<br />if %RESULT% equ 3 call :MAKEDIRLIST R&amp;call :SHOWLIST<br />if %RESULT% equ 0 call :SHOWTOPBAR<br />goto :eof<br /><br /><br />:SETPATHOP<br />set BS=\<br />if &quot;%~1&quot; == &quot;\&quot; set BS=<br />if &quot;%~1&quot; == &quot;/&quot; set BS=<br />set NEWPATH=&quot;%~1&quot;<br />set NEWPATH=%NEWPATH:/=\%<br />if not exist &quot;%NEWPATH:~1,-1%%BS%&quot; call :SHOWBOTTOMBAR &quot;No such path&quot; &amp; goto :eof<br />cd /D %NEWPATH%<br />call :MAKEDIRLIST R<br />call :SHOWLIST<br />goto :eof<br /><br /><br />:PAUSE<br />gotoxy 0 k &quot;%1Press a key to continue...&quot; u U c<br />cmdwiz getch<br />goto :eof<br /><br /><br />:MULTIOP<br />call :COUNTITEMS CNT &amp; if !CNT! lss 1 call :SHOWBOTTOMBAR &quot;No files selected.&quot;&amp;goto :eof<br />call :GETANSWER &quot;Action on selected files, # inserts filename:&quot;<br />if &quot;!ANSWER!&quot;==&quot;&quot; goto :eof<br />call :SPLITANSWER<br />cls<br />for /L %%a in (0,1,%FCOUNTSUB%) do if not &quot;!FS%%a!&quot;==&quot;&quot; if not &quot;!FT%%a!&quot;==&quot;/&quot; cmd /C !ANSWER! !FO%%a! !ANSWER2!<br />call :PAUSE \n<br />mode con lines=%LINES% cols=%COLS%<br />cmdwiz showcursor 0<br />call :MAKEDIRLIST R<br />call :SHOWLIST<br />goto :eof<br /><br />:SPLITANSWER<br />set SPLITPOS=-1<br />set ANSWER2=<br />set ANSWER=%ANSWER:&quot;=%<br />cmdwiz stringlen &quot;%ANSWER%&quot;&amp;set LEN=!ERRORLEVEL!<br />for /L %%a in (0,1,%LEN%) do if &quot;!ANSWER:~%%a,1!&quot;==&quot;#&quot; set SPLITPOS=%%a<br />set /a A2=%SPLITPOS%+1<br />if not %SPLITPOS%==-1 set ANSWER2=!ANSWER:~%A2%!&amp;set ANSWER=!ANSWER:~0,%SPLITPOS%!<br />goto :eof<br /><br /><br />:MULTIDELOP<br />call :COUNTITEMS CNT &amp; if !CNT! lss 1 call :SHOWBOTTOMBAR &quot;No files selected.&quot;&amp;goto :eof<br />call :YESNO &quot;Really delete ALL selected files?(y/n) &quot; <br />if &quot;!ANSWER!&quot;==&quot;N&quot; goto :eof<br />for /L %%a in (0,1,%FCOUNTSUB%) do if not &quot;!FS%%a!&quot;==&quot;&quot; if not &quot;!FT%%a!&quot;==&quot;/&quot; cmd /C del /Q !FO%%a!<br />call :MAKEDIRLIST R<br />call :SHOWLIST<br />goto :eof<br /><br /><br />:MULTICOPYOP<br />if not &quot;%3&quot;==&quot;&quot; goto SKIPYN<br />set ALLOWFOLDERS=&amp;if &quot;%1&quot;==&quot;move&quot; set ALLOWFOLDERS=Y<br />call :COUNTITEMS CNT %ALLOWFOLDERS%&amp; if !CNT! lss 1 call :SHOWBOTTOMBAR &quot;No items selected.&quot;&amp;goto :eof<br />if &quot;%1&quot;==&quot;copy&quot; call :YESNO &quot;Really %1 ALL selected files to second path?(y/n) &quot; <br />if &quot;%1&quot;==&quot;move&quot; call :YESNO &quot;Really %1 ALL selected files/folders to second path?(y/n) &quot; <br />if &quot;!ANSWER!&quot;==&quot;N&quot; goto :eof<br />:SKIPYN<br />if &quot;%1&quot;==&quot;copy&quot; for /L %%a in (0,1,%FCOUNTSUB%) do if not &quot;!FS%%a!&quot;==&quot;&quot; if not &quot;!FT%%a!&quot;==&quot;/&quot; call :COPYOP !FO%%a! %2 copy Copied &quot;.&quot;<br />if &quot;%1&quot;==&quot;move&quot; for /L %%a in (0,1,%FCOUNTSUB%) do if not &quot;!FS%%a!&quot;==&quot;&quot; call :COPYOP !FO%%a! %2 move Moved &quot;.&quot;<br />if &quot;%1&quot;==&quot;move&quot; call :MAKEDIRLIST R<br />if &quot;%1&quot;==&quot;copy&quot; call :CLEARSELECTED<br />call :SHOWLIST<br />goto :eof<br /><br /><br />:MARKITEM<br />cmdwiz getkeystate ctrl&gt;nul<br />set /a TR = %ERRORLEVEL% ^&amp; 1&amp; if !TR! == 0 goto NOCTRLPRESSED<br />call :CLEARSELECTED<br />call :SHOWLIST<br />goto :eof<br />:NOCTRLPRESSED<br />if !FO%CURRPOS%!==&quot;..&quot; goto SKIPITEM<br />set TC=!FS%CURRPOS%!<br />if &quot;%TC%&quot; == &quot;&quot; set FS%CURRPOS%=\%SELCOL%U%SELCHAR%<br />if not &quot;%TC%&quot; == &quot;&quot; set FS%CURRPOS%=<br />:SKIPITEM<br />set OLDPOS=%CURRPOS%&amp;set /a CURRPOS+=1 &amp; call :UPDATELIST<br />goto :eof<br /><br />:CLEARSELECTED<br />for /L %%a in (0,1,%FCOUNTSUB%) do set FS%%a=<br />goto :eof<br /><br /><br />:COPYOP<br />set FPATH=%2<br />set FFILE=%1<br />if exist &quot;%FPATH:~1,-1%\%FFILE:~1,-1%&quot; call :YESNO &quot;Overwrite?(y/n) (%FFILE:~1,-1%)&quot; &amp; if &quot;!ANSWER!&quot;==&quot;N&quot; goto :eof<br />if not exist &quot;%FPATH:~1,-1%\&quot; if exist %FPATH% call :YESNO &quot;Overwrite?(y/n) (%FPATH:~1,-1%)&quot; &amp; if &quot;!ANSWER!&quot;==&quot;N&quot; goto :eof<br />%3 /Y %FFILE% %FPATH%&gt;nul<br />call :SHOWBOTTOMBAR &quot;%~4 file%~5&quot;<br />goto :eof<br /><br /><br />:SORTOP<br />call :SHOWBOTTOMBAR &quot;Sort using (n)ame, (e)xtension, (s)ize, or (d)date? &quot;<br />:SORTLOOP<br />cmdwiz getch<br />set YNKEY=%ERRORLEVEL%<br />if %YNKEY% == 110 set SORT=N&amp;set YNKEY=-1<br />if %YNKEY% == 101 set SORT=EN&amp;set YNKEY=-1<br />if %YNKEY% == 115 set SORT=-SN&amp;set YNKEY=-1<br />if %YNKEY% == 100 set SORT=-DN&amp;set YNKEY=-1<br />if not %YNKEY%==-1 goto SORTLOOP<br />call :MAKEDIRLIST<br />call :SHOWLIST<br />goto :eof<br /><br /><br />:FINDOP<br />cmdwiz stringlen &quot;%ANSWER%&quot;&amp;set LEN=!ERRORLEVEL!<br />for /L %%a in (0,1,%FCOUNTSUB%) do set FTP=!FO%%a!&amp;set FTP=!FTP:~1,%LEN%!&amp;if !FTP!==!ANSWER! set OLDPOS=%CURRPOS%&amp; set CURRPOS=%%a&amp; (if &quot;%1&quot;==&quot;&quot; call :UPDATELIST) &amp; goto :eof<br />goto :eof<br /><br /><br />:MAKEDIRLIST<br />for /L %%a in (0,1,%FCOUNTSUB%) do set FO%%a=&amp;set FT%%a=&amp;set FS%%a=<br />if %DETAILS%==1 for /L %%a in (0,1,%FCOUNTSUB%) do set FL%%a=<br />if not &quot;%1&quot;==&quot;R&quot; set CURRPOS=0&amp;set OLDPOS=0&amp;set OLDPAGE=0<br /><br />set OLDDIRCMD=%DIRCMD%<br />set DIRCMD=<br /><br />dir /b /ad-l /O%SORT% &gt;%MYTEMP%folders.dat 2&gt;nul<br />set CNT=0<br />cmdwiz stringlen &quot;%CD%&quot;&amp;set LEN=!ERRORLEVEL!<br />if %LEN% geq 4 set FO!CNT!=&quot;..&quot;&amp;set FT!CNT!=/&amp;set /a CNT+=1<br />for /F &quot;tokens=*&quot; %%a in (%MYTEMP%folders.dat) do set FO!CNT!=&quot;%%a&quot;&amp;set FT!CNT!=/&amp;set /a CNT+=1<br />dir /b /a-d-l /O%SORT%&gt;%MYTEMP%files.dat 2&gt;nul<br />for /F &quot;tokens=*&quot; %%a in (%MYTEMP%files.dat) do set FO!CNT!=&quot;%%a&quot;&amp;set FT!CNT!=&amp;set /a CNT+=1<br /><br />if %DETAILS%==0 goto SKIPDETAILS<br />set /a CNT2=0,FND=0<br />dir /a-l /-C /OG%SORT%&gt;%MYTEMP%longfiles.dat 2&gt;nul<br />for /F &quot;tokens=*&quot; %%a in (%MYTEMP%longfiles.dat) do (if !FND!==0 cmdwiz stringfind &quot;%%a &quot; &quot; !FO0:~1,-1!&quot; &amp; if not !errorlevel!==-1 set FND=1) &amp; if !FND!==1 set FNAME=&quot;%%a&quot;&amp;set FL!CNT2!=!FNAME:\=/!&amp;set /a CNT2+=1<br />:SKIPDETAILS<br /><br />set DIRCMD=%OLDDIRCMD%<br />set OLDDIRCMD=<br /><br />set /a FCOUNT=%CNT%<br />set /a FCOUNTSUB=%CNT%-1<br />set /a LH=%LINES%-2<br /><br />call :CALCNOFCOLUMNS<br />if %DETAILS%==1 set COLSPERSCR=1<br />goto :eof<br /><br />:CALCNOFCOLUMNS<br />if %ADAPTCPS%==1 set /A COLSPERSCR=%FCOUNTSUB%/%LH%+1&amp;if !COLSPERSCR! gtr %MAXCPS% set COLSPERSCR=%MAXCPS%<br />goto :eof<br /><br /><br />:SHOWLIST<br />if %CURRPOS% lss 0 set CURRPOS=0<br />if %CURRPOS% gtr %FCOUNTSUB% set CURRPOS=%FCOUNTSUB%<br />set /a PAGE=%CURRPOS%/(%COLSPERSCR%*%LH%)<br />if not %PAGE% == %OLDPAGE% set MODE=&amp;set OLDPAGE=%PAGE%<br />set X=0<br />set Y=1<br />set /a CX=%COLS%/%COLSPERSCR%<br />set /a CXM=%CX%-1-%HDIV%<br />set /a CXMM=%CXM%-1<br />set /a CNT=%PAGE%*(%COLSPERSCR%*%LH%)<br />set CC=0<br />set SHOWS=&quot;&quot;<br />set /a PARTPRINT=%LH%+1<br />set /A FMCOUNT=%FCOUNT%-1<br /><br />set /A BLH=%LINES%-2&amp;gotoxy 0 0 &quot;\O0;1;%COLS%;!BLH!;&quot;<br />call :SHOWBOTTOMBAR<br />call :SHOWTOPBAR<br /><br />:: b3, ba, 7c, db<br />if %HDIV%==1 set /A NOFCP=%COLSPERSCR%-1&amp;(if !NOFCP! lss 1 set NOFCP=1)&amp;set BARS=&quot;&quot;&amp;for /L %%a in (1,1,!NOFCP!) do set /A X=%%a*%CX%-1 &amp; set BARS=&quot;!BARS:~1,-1!\p!X!;1;\M%LH%{\gb3\n}&quot;<br />if %HDIV%==1 gotoxy 0 0 %BARS% %BARCOL% U x&amp;set BARS=<br /><br />set X=0&amp;for /L %%a in (%CNT%,1,%FMCOUNT%) do set BGCOL=U&amp;(if %%a==%CURRPOS% set BGCOL=%CURRCOL%)&amp;set FGCOL=%FILECOL%&amp;(if &quot;!FT%%a!&quot;==&quot;/&quot; set FGCOL=%DIRCOL%)&amp;set SEL= &amp;(if not &quot;!FS%%a!&quot;==&quot;&quot; set SEL=!FS%%a!)&amp;set FNAME=!FO%%a!&amp;(if %DETAILS%==1 set FNAME=!FL%%a!)&amp;set FNAME=!FNAME:~1,-1!!FT%%a!&amp;set OUTF=!FNAME:~0,%CXM%!&amp;(if not &quot;!OUTF!&quot;==&quot;!FNAME!&quot; set OUTF=!FNAME:~0,%CXMM%!~)&amp;set SHOWS=&quot;!SHOWS:~1,-1!\!FGCOL!!BGCOL!!OUTF!!SEL!\n&quot;&amp;set /a Y+=1&amp;set /a PTEMP=!Y! %% %PARTPRINT%&amp;(if !PTEMP!==0 gotoxy 0 1 !SHOWS! !DIRCOL!&amp;set SHOWS=&quot;&quot;)&amp;(if !Y! gtr %LH% set Y=1&amp;set /a X+=%CX%&amp;set SHOWS=&quot;!SHOWS:~1,-1!\p!X!;!Y!&quot;&amp; set /a CC+=1&amp;if !CC! geq %COLSPERSCR% goto OUTLOOP)&amp;set /a CNT+=1<br /><br />:OUTLOOP<br />gotoxy 0 1 %SHOWS% %DIRCOL%<br /><br />goto :eof<br /><br /><br />:UPDATELIST<br />if %CURRPOS% lss 0 set CURRPOS=0<br />if %CURRPOS% gtr %FCOUNTSUB% set CURRPOS=%FCOUNTSUB%<br />set /a PAGE=%CURRPOS%/(%COLSPERSCR%*%LH%)<br />if not %PAGE% == %OLDPAGE% set OLDPAGE=%PAGE%&amp;call :SHOWLIST&amp;goto :eof<br />if %UPDATEBOTTOM%==1 set UPDATEBOTTOM=0&amp;call :SHOWBOTTOMBAR<br />call :SHOWTOPBAR U<br />set /a CNT=%PAGE%*(%COLSPERSCR%*%LH%)<br />set CX=%COLS%/%COLSPERSCR%<br />set /a CXM=%CX%-1-%HDIV%<br />set /a CXMM=%CXM%-1<br />set CC=0<br />set SHOWS=&quot;&quot;<br /><br />set /a N=%OLDPOS%-%CNT%<br />set /a NX=(%N%/%LH%)<br />set /a NX*=%CX%<br />set /a NY=(%N% %% %LH%)+1<br /><br />set FGCOL=%FILECOL%U&amp;if &quot;!FT%OLDPOS%!&quot;==&quot;/&quot; set FGCOL=%DIRCOL%U<br />set SEL= &amp;if not &quot;!FS%OLDPOS%!&quot;==&quot;&quot; set SEL=!FS%OLDPOS%!<br />for %%a in (%OLDPOS%) do set FNAME=!FO%%a!&amp;(if %DETAILS%==1 set FNAME=!FL%%a!)&amp;set FNAME=!FNAME:~1,-1!!FT%%a!&amp;set OUTF=!FNAME:~0,%CXM%!&amp;(if not &quot;!OUTF!&quot;==&quot;!FNAME!&quot; set OUTF=!FNAME:~0,%CXMM%!~)<br />set SHOWS=&quot;%SHOWS:~1,-1%\p%NX%;%NY%\%FGCOL%%OUTF%%SEL%&quot;<br /><br />set /a N=%CURRPOS%-%CNT%<br />set /a NX=(%N%/%LH%)<br />set /a NX*=%CX%<br />set /a NY=(%N% %% %LH%)+1<br /><br />set FGCOL=%FILECOL%%CURRCOL%&amp;if &quot;!FT%CURRPOS%!&quot;==&quot;/&quot; set FGCOL=%DIRCOL%%CURRCOL%<br />set SEL= &amp;if not &quot;!FS%CURRPOS%!&quot;==&quot;&quot; set SEL=!FS%CURRPOS%!<br />for %%a in (%CURRPOS%) do set FNAME=!FO%%a!&amp;(if %DETAILS%==1 set FNAME=!FL%%a!)&amp;set FNAME=!FNAME:~1,-1!!FT%%a!&amp;set OUTF=!FNAME:~0,%CXM%!&amp;(if not &quot;!OUTF!&quot;==&quot;!FNAME!&quot; set OUTF=!FNAME:~0,%CXMM%!~)<br />set SHOWS=&quot;%SHOWS:~1,-1%\p%NX%;%NY%\%FGCOL%%OUTF%%SEL%&quot;<br /><br />gotoxy 0 0 %SHOWS% 0 0<br />goto :eof<br /><br /><br />:SHOWTOPBAR<br />set /a CURRTMP=%CURRPOS%+1<br />if not &quot;%~1&quot;==&quot;U&quot; goto NOUPDTB<br />set BARINFO=&quot;%CURRTMP%/%FCOUNT%&quot;<br />gotoxy 6 0 &quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;\p5;0 %BARINFO:~1,-1%&quot; %BARTEXTCOL% %BARCOL%<br />goto :eof<br />:NOUPDTB<br />set BARINFO=&quot;Item %CURRTMP%/%FCOUNT%&quot;<br />set TCD=&quot;%CD:\=/%&quot;<br />gotoxy 0 0 &quot;%BAR:~1,-1%\p1;0%BARINFO:~1,-1%\p18;0%TCD:~1,-1%&quot; %BARTEXTCOL% %BARCOL%<br />set /a TC=%COLS%-1&amp;set /a TDP=%DIRP%+1&amp;gotoxy !TC! 0 &quot;!TDP!&quot; %PATHNOFCOL% %BARCOL%<br />goto :eof<br /><br /><br />:SHOWBOTTOMBAR<br />set MSG=&quot;%~1&quot;<br />set MSG=%MSG:\=/%<br />if not &quot;%~1&quot;==&quot;&quot; gotoxy 0 %BARPOS% &quot;%BAR:~1,-1%\p1;%BARPOS%;%MSG:~1,-1%&quot; %BARINFOCOL% %BARCOL%&amp; set UPDATEBOTTOM=1<br />if &quot;%~1&quot;==&quot;&quot; set /a TP=%COLS%-14 &amp; gotoxy 0 %BARPOS% &quot;%BAR:~1,-1%\p!TP!;%BARPOS%;F1/? for help&quot; %BARINFOCOL% %BARCOL%<br />set MSG=<br />goto :eof<br /><br /><br />:YESNO<br />call :SHOWBOTTOMBAR %1<br />:YNLOOP<br />cmdwiz getch<br />set YNKEY=%ERRORLEVEL%<br />if %YNKEY% == 110 set ANSWER=N&amp;set YNKEY=-1<br />if %YNKEY% == 121 set ANSWER=Y&amp;set YNKEY=-1<br />if not %YNKEY%==-1 goto YNLOOP<br />call :SHOWBOTTOMBAR<br />goto :eof<br /><br /><br />:GETANSWER<br />gotoxy 0 0 %BAR% %BARINFOCOL% %BARCOL%<br />gotoxy 1 0 %1 %BARTEXTCOL% %BARCOL%<br />cmdwiz stringlen %1&amp;set LEN=!ERRORLEVEL!<br />set /a LEN+=2<br />gotoxy %LEN% 0<br />cmdwiz showcursor 1<br />set ANSWER=<br />set /P ANSWER=<br />cmdwiz showcursor 0<br />if not &quot;%2&quot;==&quot;&quot; call :STRIPQUOTES %ANSWER%<br />call :SHOWTOPBAR<br />goto :eof<br /><br />:STRIPQUOTES<br />if not &quot;%2&quot;==&quot;&quot; goto :eof<br />set ANSWER=%~1<br />goto :eof<br /><br /><br />:SHOWHELP<br />cls<br />gotoxy 0 0 &quot;%BAR:~1,-1%\p1;0LISTb Help&quot; %BARTEXTCOL% %BARCOL%<br />gotoxy 1 2 &quot;%HLPC1%Up/Down/Left/Right/Home/End/PageUp/PageDown: %HLPC2%navigate\n%HLPC1%Alt-key: %HLPC2%jump to next file/folder starting with key\n%HLPC1%^F: %HLPC2%find file in list starting with specified string\n%HLPC1%1-9/0/+: %HLPC2%columns per screen / adaptive columns on/off / details on/off\n%HLPC1%U: %HLPC2%refresh file listing/screen\n\n%HLPC1%Return: %HLPC2%enter folder/show file\n%HLPC1%&lt;/BS: %HLPC2%enter parent folder\n%HLPC1%/: %HLPC2%enter specified path\n%HLPC1%y: %HLPC2%switch beteen paths 1 and 2\n%HLPC1%o: %HLPC2%specify sorting order\n%HLPC1%p: %HLPC2%launch command prompt\n%HLPC1%q/x: %HLPC2%quit in start/current folder\n\n%HLPC1%e/E: %HLPC2%edit current/specified file\n%HLPC1%i/j: %HLPC2%invoke file (j updates file list after)\n%HLPC1%I: %HLPC2%perform action with file/folder\n%HLPC1%f/F: %HLPC2%show file information / show full item name\n%HLPC1%S/s: %HLPC2%execute command with/without waiting for key after\n%HLPC1%r: %HLPC2%rename file/folder\n%HLPC1%k: %HLPC2%create new folder\n%HLPC1%c: %HLPC2%copy file to specified destination\n%HLPC1%m: %HLPC2%move file/folder to specified folder\n%HLPC1%Y/^Y: %HLPC2%copy/move file/folder to second path (see y)\n%HLPC1%v/V: %HLPC2%put item in clipboard with/without clearing clipboard (see B)\n\n%HLPC1%Space/^Space: %HLPC2%select file/folder / deselect all items\n%HLPC1%^I: %HLPC2%perform specified action with selected files\n%HLPC1%D: %HLPC2%delete selected files\n%HLPC1%C/M: %HLPC2%copy/move selected files/folders to specified folder\n%HLPC1%T/^T: %HLPC2%copy/move selected files/folders to second path (see y)\n%HLPC1%b/B/^B: %HLPC2%put selected items in clipboard / copy/move from clipboard\n\n%HLPC1%Arguments: %HLPC2%listb &#91;path&#93; &#91;width&#93; &#91;height&#93; &#91;-&#93;&#91;columns&#93; &#91;extendfile&#93; &#91;mouse&#93;\n&quot; 0 0 c<br />if not %EXTEND% == &quot;&quot; if exist %EXTEND% call %EXTEND% _SHOW_EXTENDED_HELP<br />call :SHOWBOTTOMBAR &quot;Press ESCAPE to go back.&quot;<br />:HELPLOOP<br />cmdwiz getch<br />if not %ERRORLEVEL% == 27 goto HELPLOOP<br />call :SHOWLIST<br />goto :eof<br /><br /><br />:COUNTITEMS &lt;nof&gt; &lt;allowFolders&gt;<br />set CNTI=0<br />if &quot;%2&quot; == &quot;&quot; for /L %%a in (0,1,%FCOUNTSUB%) do if not &quot;!FS%%a!&quot;==&quot;&quot; if not &quot;!FT%%a!&quot;==&quot;/&quot; set /a CNTI+=1<br />if not &quot;%2&quot; == &quot;&quot; for /L %%a in (0,1,%FCOUNTSUB%) do if not &quot;!FS%%a!&quot;==&quot;&quot; set /a CNTI+=1<br />set %1=%CNTI%<br />goto :eof<br /><br /><br />:LAUNCHFILE<br />set FND=0&amp;for %%a in (.exe .com .bat .cmd .EXE .COM .BAT .CMD) do cmdwiz stringfind %1 &quot;%%a&quot;&amp;if !ERRORLEVEL! geq 0 set FND=1<br />::if %FND% == 0 call :SHOWBOTTOMBAR &quot;Launched %~1.&quot;<br />if %FND% == 0 start ^&quot;^&quot; %1 &amp; goto :eof<br /><br />cmdwiz getexetype %1<br />if %ERRORLEVEL% == 3 start ^&quot;^&quot; %1 &amp; goto :eof<br /><br />cls&amp;cmdwiz showcursor 1<br />cmd /C %1<br />call :PAUSE \n<br />mode con lines=%LINES% cols=%COLS%<br />cmdwiz showcursor 0<br />if not &quot;%2&quot;==&quot;&quot; call :MAKEDIRLIST R<br />call :SHOWLIST<br />goto :eof<br /><br /><br />:PROCESS_MOUSE<br />set OLDCP=%CURRPOS%<br />set DBLCL=0<br /><br />set /a MT=%MR% ^&amp; 2 &amp;if !MT! geq 1 set DL=1<br />set /a MT=%MR% ^&amp; 2 &amp;if !MT! equ 0 set DL=0<br />set /a MT=%MR% ^&amp; 4 &amp;if !MT! geq 1 set DR=1<br />set /a MT=%MR% ^&amp; 4 &amp;if !MT! equ 0 set DR=0<br />set /a MT=%MR% ^&amp; 8 &amp;if !MT! geq 1 set DL=2<br />set /a MT=%MR% ^&amp; 16 &amp;if !MT! geq 1 set DR=2<br />set /a MT=%MR% ^&amp; 32 &amp;if !MT! geq 1 set /a CURRPOS+=%LH%*%COLSPERSCR%<br />set /a MT=%MR% ^&amp; 64 &amp;if !MT! geq 1 set /a CURRPOS-=%LH%*%COLSPERSCR%<br />set /a MX=(%MR%^&gt;^&gt;7) ^&amp; 255<br />set /a MY=(%MR%^&gt;^&gt;15) ^&amp; 127<br /><br />if %DL% == 0 if %DR% == 0 goto NOPRESS<br />set /a PAGE=%CURRPOS%/(%COLSPERSCR%*%LH%)<br />set /a CPT=%LINES%-1<br />if %MY% geq %CPT% goto NOPRESS<br />if %MY% leq 0 goto NOPRESS<br />set /a CURRPOS=(%COLSPERSCR%*%LH%)*%PAGE%<br />set /a CPX=%MY%-1<br />set /a CURRPOS+=%CPX%<br />set /a CPT=%OLDCOLS%/%COLSPERSCR%<br />set /a CPT=%MX%/%CPT%<br />if %CPT% geq %COLSPERSCR% set /a CPT-=1<br />set /a CURRPOS+=%CPT%*%LH%<br />if %DL%==2 set KEY=13&amp;set DBLCL=1<br />if %DR%==2 set KEY=105&amp;set DBLCL=1<br />:NOPRESS<br /><br />if not %OLDCP% == %CURRPOS% set OLDPOS=%OLDCP%&amp; call :UPDATELIST<br />goto :eof<br /></code></pre></div></div>

			
													<div class="notice">
					Last edited by <a href="memberlist54f1.html?mode=viewprofile&amp;u=8229" class="username">misol101</a> on 10 Sep 2016 15:23, edited 16 times in total.
									</div>
			
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p46599" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile46599">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist54f1.html?mode=viewprofile&amp;u=8229" class="username">misol101</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha06d.html?author_id=8229&amp;sr=posts">356</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 02 May 2016 18:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content46599">

						<h3 ><a href="#p46599">Re: Listb - a file explorer/viewer inside the console window</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingc0cb.html?mode=quote&amp;f=3&amp;p=46599" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic787d.html?p=46599#p46599" onclick="prompt('Message #3',this.href); return false;">#3</a></span> 
									<a class="unread" href="viewtopic787d.html?p=46599#p46599" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist54f1.html?mode=viewprofile&amp;u=8229" class="username">misol101</a></strong> &raquo; </span>12 May 2016 14:28
			</p>
			
			
			
			<div class="content"><strong class="text-strong">How to extend functionality with extendlistb.bat?</strong><br /><br />extendlistb.bat is just a convenient way to extend listb without modifying listb.bat. I think the easiest way is to look at the examples in there.<br /><br />Note that the file currently uses several external programs that you may or may not have (less, ansicon, zip, unzip, npp.bat (supposed to run Notepad++), etc).<br /><br />One important thing to note is the return value. exit /b with return value of 0 does nothing(good if the screen does not change), 1 refreshes the list/screen, 2 re-reads files and refreshes screen, 3 does the same as 2 but also sets the file position in the list back to 0.<br /><br />The following functionality is available by calling listb.bat itself from within extendlistb.bat: 1. requesting a yes/no answer, 2. requesting a written answer, 3. write a message in the bottom bar of the screen, 4. count the number of selected items in the list.<br /><br /><br /><strong class="text-strong">What are the :SHOWHELP and :SETCOLORS and :SETVIEWERS functions?</strong><br />These functions are called by Listb.bat, in the first case when the user presses F1 or ?, and in the second and third case when starting listb. The first can be used to keep track of your addons, the second one can be used to change the colors/look of the UI, and the third can be used to change the programs used when pressing RETURN, e, and p.<br /><br /><br /><strong class="text-strong">What are these key codes (%KEY% == ??)? How do I know which one to use?</strong><br />Run getchloop.bat (included), and press any keys you like (Escape to quit). The key code is the Ascii code for normal characters, but not for special characters like function keys etc<br /><br />For normal characters, you can now also use LKEY, as in %LKEY% == &quot;a&quot;</div>

			
													<div class="notice">
					Last edited by <a href="memberlist54f1.html?mode=viewprofile&amp;u=8229" class="username">misol101</a> on 24 Jun 2016 16:08, edited 3 times in total.
									</div>
			
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p46619" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile46619">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search661c.html?author_id=1265&amp;sr=posts">3386</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 22 Jan 2010 18:01</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content46619">

						<h3 ><a href="#p46619">Re: Listb - a file explorer/viewer inside the console window</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting8878.html?mode=quote&amp;f=3&amp;p=46619" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic5242.html?p=46619#p46619" onclick="prompt('Message #4',this.href); return false;">#4</a></span> 
									<a class="unread" href="viewtopic5242.html?p=46619#p46619" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a></strong> &raquo; </span>14 May 2016 04:39
			</p>
			
			
			
			<div class="content"><blockquote class="uncited"><div>What are these key codes (%KEY% == ??)? [...]<br />[...] but not for special characters like function keys etc</div></blockquote><br />The 2nd call of getch() returns the Key Scan Code in this case.<br /><a href="https://msdn.microsoft.com/en-us/library/aa299374(v=vs.60).aspx" class="postlink">https://msdn.microsoft.com/en-us/library/aa299374(v=vs.60).aspx</a><br />Your implementation returns Scan Code + N where N differs depending on the kind of the key. That doesn't make much sense. N could be always 256 because the Scan Codes are unique for a certain keyboard. That way you could easily predict your &quot;key code&quot; for function keys, arrow keys, etc. if you use the linked table.<br /><br />Regards<br />aGerman</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p46621" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile46621">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist54f1.html?mode=viewprofile&amp;u=8229" class="username">misol101</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha06d.html?author_id=8229&amp;sr=posts">356</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 02 May 2016 18:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content46621">

						<h3 ><a href="#p46621">Re: Listb - a file explorer/viewer inside the console window</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingeac2.html?mode=quote&amp;f=3&amp;p=46621" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic0b63.html?p=46621#p46621" onclick="prompt('Message #5',this.href); return false;">#5</a></span> 
									<a class="unread" href="viewtopic0b63.html?p=46621#p46621" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist54f1.html?mode=viewprofile&amp;u=8229" class="username">misol101</a></strong> &raquo; </span>14 May 2016 05:57
			</p>
			
			
			
			<div class="content">Hi, thanks for the reply.<br /><br />It looks like you are absolutely correct. I had a memory of overlapping key codes (something like Shift-F1 would be the same as Ctrl-Home or something...), but now that I try it I can't find any overlaps. Silly me...<br /><br />This should definitely be changed soon, too bad I have to change a lot of my batch files too <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br /><br />Edit: I don't really understand why getch returns 0 in some cases and 224 in others to indicate a special key (since the following scancode is, as you said, unique anyway). Do you know why?<br /><br />Thanks!</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p46623" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile46623">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search661c.html?author_id=1265&amp;sr=posts">3386</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 22 Jan 2010 18:01</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content46623">

						<h3 ><a href="#p46623">Re: Listb - a file explorer/viewer inside the console window</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting4768.html?mode=quote&amp;f=3&amp;p=46623" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic8359.html?p=46623#p46623" onclick="prompt('Message #6',this.href); return false;">#6</a></span> 
									<a class="unread" href="viewtopic8359.html?p=46623#p46623" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a></strong> &raquo; </span>14 May 2016 07:28
			</p>
			
			
			
			<div class="content"><blockquote class="uncited"><div>I don't really understand why getch returns 0 in some cases and 224 in others</div></blockquote><br />Unfortunately that's badly documented.<br />The function reference of <a href="https://msdn.microsoft.com/en-us/library/078sfkak.aspx" class="postlink">_getch()</a> (that you should prefer over getch()) only says<br /><blockquote class="uncited"><div>When reading a function key or an arrow key, each function must be called twice; the first call returns 0 or 0xE0, and the second call returns the actual key code.</div></blockquote><br /><br />Again have a look at the table with the Key Scan Codes. Some of the Keys are marked with and without a £ symbol for &quot;extended keyboards&quot; (also see the legend below the table). In the 6th column you'll find either NUL (0) or E0 (224) which is the value that _getch() returns in the first place. Nowadays almost every keyboard is &quot;extended&quot;. E.g. 224 is returned for the separate arrow keys you should usually have at your keyboard. But if you use the arrow keys at the numpad (with numlock switched off) 0 is returned instead. That's what was meant when I wrote &quot;kind of the key&quot; above. Thus, the first return value is only usefull if you have to distinguish where the key pressed is placed at your keyboard. But that's out of interest for your tool I guess <img class="smilies" src="images/smilies/icon_wink.gif" alt=":wink:" title="Wink" /> <br /><br />Regards<br />aGerman</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p46624" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile46624">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist7eee.html?mode=viewprofile&amp;u=8185" class="username">Thor</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search0236.html?author_id=8185&amp;sr=posts">43</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 31 Mar 2016 15:02</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content46624">

						<h3 ><a href="#p46624">Re: Listb - a file explorer/viewer inside the console window</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting8c0e.html?mode=quote&amp;f=3&amp;p=46624" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic2e07-2.html?p=46624#p46624" onclick="prompt('Message #7',this.href); return false;">#7</a></span> 
									<a class="unread" href="viewtopic2e07-2.html?p=46624#p46624" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist7eee.html?mode=viewprofile&amp;u=8185" class="username">Thor</a></strong> &raquo; </span>14 May 2016 09:45
			</p>
			
			
			
			<div class="content">I have a question though, when running this batch file and using the cursor to move around, I don't know where the cursor is at since the file is not highlighted as the cursor move around, besides just the index number is updated, but I have no clue what file the cursor is at. It would be nice to have the current file at the cursor highlighted in different color or its name is listed in the taskbar or something.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p46625" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile46625">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist54f1.html?mode=viewprofile&amp;u=8229" class="username">misol101</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha06d.html?author_id=8229&amp;sr=posts">356</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 02 May 2016 18:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content46625">

						<h3 ><a href="#p46625">Re: Listb - a file explorer/viewer inside the console window</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting2624.html?mode=quote&amp;f=3&amp;p=46625" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic90cf.html?p=46625#p46625" onclick="prompt('Message #8',this.href); return false;">#8</a></span> 
									<a class="unread" href="viewtopic90cf.html?p=46625#p46625" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist54f1.html?mode=viewprofile&amp;u=8229" class="username">misol101</a></strong> &raquo; </span>14 May 2016 10:03
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>Thor wrote:</cite>I have a question though, when running this batch file and using the cursor to move around, I don't know where the cursor is at since the file is not highlighted as the cursor move around, besides just the index number is updated, but I have no clue what file the cursor is at. It would be nice to have the current file at the cursor highlighted in different color or its name is listed in the taskbar or something.</div></blockquote><br /><br />Hmm, that is confusing! Does your background colour happen to be blue? Because the current file is (supposed to be) highlighted with a blue background color at the moment, as in:<br /><br /><!-- m --><a class="postlink" href="../../www.mediafire.com/view/izt55grob1n883c/listb.html">http://www.mediafire.com/view/izt55grob1n883c/listb.PNG</a><!-- m --><br /><br />...so that could be why you cannot see it!<br /><br />(actually also here the text color is set to white, that's a result of running with extendlistb.bat, where I override this color).<br /><br />You can either try running with path to extendlistb.bat, or directly edit listb.bat to change the background color for the selected item. To do this, open listb.bat and search for &quot;set CURRCOL=&quot;, then change 1 to e.g. 4, that should give the current file a red background.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p46626" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile46626">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist7eee.html?mode=viewprofile&amp;u=8185" class="username">Thor</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search0236.html?author_id=8185&amp;sr=posts">43</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 31 Mar 2016 15:02</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content46626">

						<h3 ><a href="#p46626">Re: Listb - a file explorer/viewer inside the console window</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting27e6.html?mode=quote&amp;f=3&amp;p=46626" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic901d.html?p=46626#p46626" onclick="prompt('Message #9',this.href); return false;">#9</a></span> 
									<a class="unread" href="viewtopic901d.html?p=46626#p46626" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist7eee.html?mode=viewprofile&amp;u=8185" class="username">Thor</a></strong> &raquo; </span>14 May 2016 10:15
			</p>
			
			
			
			<div class="content">You're absolutely right, my default background is blue that's why I could not see the highligted color (still in blue), I've changed it to 2 (green) and it's working fine now. Thanks for explaining and for a wonderful tool.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p46628" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile46628">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist54f1.html?mode=viewprofile&amp;u=8229" class="username">misol101</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha06d.html?author_id=8229&amp;sr=posts">356</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 02 May 2016 18:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content46628">

						<h3 ><a href="#p46628">Re: Listb - a file explorer/viewer inside the console window</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingeedc.html?mode=quote&amp;f=3&amp;p=46628" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic54cf.html?p=46628#p46628" onclick="prompt('Message #10',this.href); return false;">#10</a></span> 
									<a class="unread" href="viewtopic54cf.html?p=46628#p46628" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist54f1.html?mode=viewprofile&amp;u=8229" class="username">misol101</a></strong> &raquo; </span>14 May 2016 11:27
			</p>
			
			
			
			<div class="content">Archive updated, link at the top!<br /><br />The following changes were made:<br /><br />1. Following healthy advice from aGerman, I changed the key code returned from cmdwiz getch/gotoxy k etc. No key codes are above 512 now, and they can be calculated by looking at <a href="https://msdn.microsoft.com/en-us/library/aa299374(v=vs.60).aspx" class="postlink">https://msdn.microsoft.com/en-us/library/aa299374(v=vs.60).aspx</a> . I still find it helpful to run getchloop.bat though to find out key codes.<br /><br />2. If the specified background color for the selected item is the same as the background color, another background color is used (following the mishap that Thor had)<br /><br />3. Listb.bat now takes [columns] as its third parameter. <br /><br />4. l.bat and listb.bat was changed to have width 80 and 4 columns as default (previously 81 and 3).<br />Also, I added code in l.bat (currently commented out) to make listb use the current width and height of the console window, and calculate the number of columns based on the width. I imagine some people would prefer this. To get this functionality, edit l.bat and put back all lines that are commented out.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p46645" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile46645">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist54f1.html?mode=viewprofile&amp;u=8229" class="username">misol101</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha06d.html?author_id=8229&amp;sr=posts">356</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 02 May 2016 18:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content46645">

						<h3 ><a href="#p46645">Re: Listb - a file explorer/viewer inside the console window</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingaeb9.html?mode=quote&amp;f=3&amp;p=46645" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopica721.html?p=46645#p46645" onclick="prompt('Message #11',this.href); return false;">#11</a></span> 
									<a class="unread" href="viewtopica721.html?p=46645#p46645" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist54f1.html?mode=viewprofile&amp;u=8229" class="username">misol101</a></strong> &raquo; </span>16 May 2016 04:18
			</p>
			
			
			
			<div class="content">Archive updated again.<br /><br />Added re-mapping of key codes back to chars in listb.bat, now possible to use<br /><br />if %LKEY% == &quot;a&quot; <br /><br />instead of<br /><br />if %KEY% == 97<br /><br />This makes the bat file more readable and extendlistb.bat easier to work with.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p46658" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile46658">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist742a.html?mode=viewprofile&amp;u=6577" class="username">thefeduke</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search454a.html?author_id=6577&amp;sr=posts">211</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 05 Apr 2015 13:06</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> MA South Shore, USA</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content46658">

						<h3 ><a href="#p46658">Re: Listb - a file explorer/viewer inside the console window</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingec34.html?mode=quote&amp;f=3&amp;p=46658" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopice475.html?p=46658#p46658" onclick="prompt('Message #12',this.href); return false;">#12</a></span> 
									<a class="unread" href="viewtopice475.html?p=46658#p46658" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist742a.html?mode=viewprofile&amp;u=6577" class="username">thefeduke</a></strong> &raquo; </span>17 May 2016 17:30
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>misol101 wrote:</cite><strong class="text-strong">Do I need to edit something before running Listb?</strong><br />No, it will work fine as long as you put the files in a PATH folder. BUT if you want the extended functionality of extendlistb.bat and you want to use l.bat to run listb.bat, you should edit l.bat to point to extendlistb.bat by modifying the absolute path to it.</div></blockquote>I made a modification to locate extendlistb.bat that should serve without change if the guidelines of having the required running files in one folder that has been added to the PATH.  I use the same version of l.bat on my hard drive and my utility memory stick.<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>call listb.bat %L_PATH% %L_W% %L_H% %L_COLUMNS% %~dp0extendlistb.bat %L_MOUSE%<br /></code></pre></div><br />John A.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p46664" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile46664">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist54f1.html?mode=viewprofile&amp;u=8229" class="username">misol101</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha06d.html?author_id=8229&amp;sr=posts">356</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 02 May 2016 18:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content46664">

						<h3 ><a href="#p46664">Re: Listb - a file explorer/viewer inside the console window</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting519a-2.html?mode=quote&amp;f=3&amp;p=46664" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic1260.html?p=46664#p46664" onclick="prompt('Message #13',this.href); return false;">#13</a></span> 
									<a class="unread" href="viewtopic1260.html?p=46664#p46664" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist54f1.html?mode=viewprofile&amp;u=8229" class="username">misol101</a></strong> &raquo; </span>18 May 2016 11:13
			</p>
			
			
			
			<div class="content">Thefeduke: That's great, I didn't know that was possible! I can't change the repo for a while (no computer access), but will put it in there eventually.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p46769" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile46769">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist54f1.html?mode=viewprofile&amp;u=8229" class="username">misol101</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha06d.html?author_id=8229&amp;sr=posts">356</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 02 May 2016 18:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content46769">

						<h3 ><a href="#p46769">Re: Listb - a file explorer/viewer inside the console window</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting223e.html?mode=quote&amp;f=3&amp;p=46769" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic8673.html?p=46769#p46769" onclick="prompt('Message #14',this.href); return false;">#14</a></span> 
									<a class="unread" href="viewtopic8673.html?p=46769#p46769" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist54f1.html?mode=viewprofile&amp;u=8229" class="username">misol101</a></strong> &raquo; </span>29 May 2016 03:06
			</p>
			
			
			
			<div class="content"><img class="smilies" src="images/smilies/icon_eek.gif" alt=":shock:" title="Shocked" /> <br /><br />Ok, so the view counter for this thread is currently at 101030 and running...<br /><br />Did somebody fall asleep on the F5 button? Did somebody link to this thread on a Chinese warez site promising &quot;hot teens&quot;? Did the forum software malfunction? Did everybody in the world suddenly need a batch file explorer (of course!)<br /><br />And, if by any chance some of this traffic is real, then why doesn't anybody say anything? <br /><br />Perhaps a forum moderator can see where it's all coming from?</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p46770" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile46770">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search661c.html?author_id=1265&amp;sr=posts">3386</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 22 Jan 2010 18:01</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content46770">

						<h3 ><a href="#p46770">Re: Listb - a file explorer/viewer inside the console window</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting3a34.html?mode=quote&amp;f=3&amp;p=46770" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicd6cb.html?p=46770#p46770" onclick="prompt('Message #15',this.href); return false;">#15</a></span> 
									<a class="unread" href="viewtopicd6cb.html?p=46770#p46770" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a></strong> &raquo; </span>29 May 2016 03:56
			</p>
			
			
			
			<div class="content">Things like that happened several times in the past. Yesterday and still today the forum is temporary not available. Whatever the cause is (server fault, maintenance, attacks, ...) it leads the counter to increase tenfold for some threads or even more. I fear only the hoster knows why.<br /><br />Regards<br />aGerman</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
	

	<div class="action-bar bar-bottom">
	
			<a href="postingda97.html?mode=reply&amp;f=3&amp;t=7147" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopice053.html?f=3&amp;t=7147&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

			<form method="post" action="https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=7147">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			28 posts
							<ul>
		<li class="active"><span>1</span></li>
				<li><a class="button" href="viewtopicdf60.html?f=3&amp;t=7147&amp;start=15" role="button">2</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopicdf60.html?f=3&amp;t=7147&amp;start=15" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="viewforum4d6b.html?f=3" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to “DOS Batch Forum”</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="viewforum31e6.html?f=4" class="jumpbox-cat-link"> <span> DosTips - Dos Batch</span></a></li>
																<li><a href="viewforum4d6b.html?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; DOS Batch Forum</span></a></li>
											</ul>
		</div>
	</div>

	</div>


			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
							<span class="crumb"><a href="../index.html" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>DosTips.com</span></a></span>									<span class="crumb"><a href="index.html" data-navbar-reference="index"><span>Board index</span></a></span>					</li>
		
				<li class="rightside">All times are <span title="UTC-6">UTC-06:00</span></li>
							<li class="rightside">
				<a href="ucp033a.html?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete all board cookies</span>
				</a>
			</li>
												<li class="rightside" data-last-responsive="true">
				<a href="memberlist4bfd.html?mode=team" role="menuitem">
					<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
				</a>
			</li>
									<li class="rightside" data-last-responsive="true">
				<a href="memberlist8733.html?mode=contactadmin" role="menuitem">
					<i class="icon fa-envelope fa-fw" aria-hidden="true"></i><span>Contact us</span>
				</a>
			</li>
			</ul>

	</div>
</div>

	<div class="copyright">
				<!-- WARNING NO DELETE -->Style developer by <a href="http://tricolor.x-tk.ru/">support forum tricolor</a>, <!-- END WARNING NO DELETE -->Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
									</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	<img src="cron68e3.gif?cron_type=cron.task.text_reparser.pm_text" width="1" height="1" alt="cron" /></div>

<script type="text/javascript" src="assets/javascript/jquery.mind772.js?assets_version=34"></script>
<script type="text/javascript" src="assets/javascript/cored772.js?assets_version=34"></script>



<script type="text/javascript" src="styles/prosilver/template/forum_fnd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/prosilver/template/ajaxd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/jquery-uid772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/collapsed772.js?assets_version=34"></script>



</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=7147 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 08:20:48 GMT -->
</html>
