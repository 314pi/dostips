<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?p=28105 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 08:14:10 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>BinToBat.bat - Easily install files of any type or size! - DosTips.com</title>


	<link rel="canonical" href="viewtopic045a.html?t=4842">

<!--
	phpBB style name: Allan Style - SUBSILVER
	Based on style:   prosilver (this is the default phpBB3 style)
	Based on style:   subsilver2 (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:  Allan ( http://x-tk.ru/ )
-->

<link href="assets/css/font-awesome.mind772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/stylesheetd772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/en/stylesheetd772.css?assets_version=34" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="./styles/AllanStyle-SUBSILVER/theme/tweaks.css?assets_version=34" rel="stylesheet">
<![endif]-->




<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','../../www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-280191-1', 'auto');
	ga('send', 'pageview');
</script>

</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">

<div id="header-subsilver">
	<a id="top" class="top-anchor" accesskey="t"></a>
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description" class="site-description">
				<a id="logo" class="logo" href="../index.html" title="DosTips.com"><span class="site_logo"></span></a>
				<h1>DosTips.com</h1>
				<p>A Forum all about DOS Batch</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

									<div id="search-box" class="search-box search-header" role="search">
				<form action="https://www.dostips.com/forum/search.php" method="get" id="search">
				<fieldset>
					<input name="keywords" id="keywords" type="search" maxlength="128" title="Search for keywords" class="inputbox search tiny" size="20" value="" placeholder="Search…" />
					<button class="button button-search" type="submit" title="Search">
						<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
					</button>
					<a href="search.html" class="button button-search-end" title="Advanced search">
						<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
					</a>
					
				</fieldset>
				</form>
			</div>
						
			</div>
					</div>
</div>


<div id="wrap" class="wrap">
	<div id="page-header">
				<div class="navbar-top" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
																									<li>
								<a href="search33a7.html?search_id=unanswered" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="search526f.html?search_id=active_topics" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-blue" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="search.html" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
											<li class="separator"></li>
																			<li>
								<a href="memberlist4bfd.html?mode=team" role="menuitem">
									<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
								</a>
							</li>
																<li class="separator"></li>

									</ul>
			</div>
		</li>

				<li data-skip-responsive="true">
			<a href="app.php/help/faq.html" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
						
			<li class="rightside"  data-skip-responsive="true">
			<a href="ucp26c3.html?mode=login" title="Login" accesskey="x" role="menuitem">
				<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Login</span>
			</a>
		</li>
					<li class="rightside" data-skip-responsive="true">
				<a href="ucp8319.html?mode=register" role="menuitem">
					<i class="icon fa-pencil-square-o  fa-fw" aria-hidden="true"></i><span>Register</span>
				</a>
			</li>
						</ul>

	</div>
</div>

<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
						<li class="breadcrumbs">
							<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="../index.html" itemprop="url" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span itemprop="title">DosTips.com</span></a></span>
										<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="index.html" itemprop="url" accesskey="h" data-navbar-reference="index"><span itemprop="title">Board index</span></a></span>

											<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="4"><a href="viewforum31e6.html?f=4" itemprop="url"><span itemprop="title">DosTips - Dos Batch</span></a></span>
															<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="3"><a href="viewforum4d6b.html?f=3" itemprop="url"><span itemprop="title">DOS Batch Forum</span></a></span>
												</li>
		
					<li class="rightside responsive-search">
				<a href="search.html" title="View the advanced search options" role="menuitem">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</a>
			</li>
			</ul>

	</div>
</div>

<div class="navbar-top-link">
	<div class="inner">
		<ul>
			<li class="navbar-top-link-left"><a href="search33a7.html?search_id=unanswered">Unanswered topics</a></li>
			<li class="navbar-top-link-left"><a href="search526f.html?search_id=active_topics">Active topics</a></li>

											</ul>
	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
		
<h2 class="topic-title"><a href="viewtopic43e2.html?f=3&amp;t=4842">BinToBat.bat - Easily install files of any type or size!</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">Discussion forum for all Windows batch related topics.<br /></div>
<p>
	<strong>Moderator:</strong> <a href="memberlista6a8.html?mode=viewprofile&amp;u=5" class="username">DosItHelp</a>
</p>


<div class="action-bar bar-top">
	
			<a href="postingc595.html?mode=reply&amp;f=3&amp;t=4842" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopicc91b.html?f=3&amp;t=4842&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="https://www.dostips.com/forum/search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topic…" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="search.html" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="4842" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			26 posts
							<ul>
		<li class="active"><span>1</span></li>
				<li><a class="button" href="viewtopic53d6.html?f=3&amp;t=4842&amp;start=15" role="button">2</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopic53d6.html?f=3&amp;t=4842&amp;start=15" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
		</div>




<div id="subsilver-nav-topic">
	<div class="inner"><div class="post has-profile">
		<div class="leftsided postbody subsilver-topic-title">Message</div>
		<div class="leftsided postprofile subsilver-topic-author">Author</div>
	</div></div>
</div>

			<div id="p28064" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile28064">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchdc63.html?author_id=2923&amp;sr=posts">1540</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 06 Dec 2011 22:15</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> México City, México</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content28064">

						<h3 class="first"><a href="#p28064">BinToBat.bat - Easily install files of any type or size!</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingcfe9.html?mode=quote&amp;f=3&amp;p=28064" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicff73.html?p=28064#p28064" onclick="prompt('Message #1',this.href); return false;">#1</a></span> 
									<a class="unread" href="viewtopicff73.html?p=28064#p28064" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a></strong> &raquo; </span>09 Aug 2013 22:50
			</p>
			
			
			
			<div class="content">I take my old <a href="viewtopic3b4a.html?f=3&amp;t=3202" class="postlink">BinToHex.bat and HexToBin.bat</a> conversion programs, that allows to encode and decode any binary file into Ascii digits, and modified they in order to keep them updated. The new encoding/decoding method can manage several data files in the same Batch program, as foxidrive suggested some time ago, and have also some features that are useful when installing a large number of files. I also optimized the JScript code so even large files, of about 10-15 MB size, can be encoded and decoded in a reasonably period of time.<br /><br /><strong class="text-strong">EDIT</strong>: I fixed the small bug that foxidrive reported in his reply...<br /><strong class="text-strong">EDIT</strong>: I added an IF to avoid the inclusion of BinToBat.bat itself.<br /><strong class="text-strong">EDIT</strong>: Oct/16/2013: I modified the method to encode text files preserving they as text, so the resulting encoded file is lesser.<br /><strong class="text-strong">EDIT</strong>: Oct/20/2013: I added the ability to split a large output file in several parts of a maximum given size.<br /><br /><strong class="text-strong">BinToBat.bat</strong>:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@if (@CodeSection == @Batch) @then<br /><br />@echo off<br /><br />REM BinToBat.bat: Create an installer Batch program for binary and text data files<br />REM Antonio Perez Ayala<br /><br />if &quot;%~1&quot; neq &quot;&quot; if &quot;%~1&quot; neq &quot;/?&quot; goto begin<br /><br />echo Create an installer Batch program for data files of any type<br />echo/<br />echo BINTOBAT &#91;/T:.ext1.ext2...&#93; &#91;/L:lineSize&#93; &#91;/F&#91;:fileSize&#93;&#93; filename ...<br />echo/<br />echo&nbsp; &nbsp;/T:.ext1.ext2&nbsp; &nbsp; Specify the extensions of text type files that will not be<br />echo&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; encoded as hexadecimal digits, but preserved as text.<br />echo&nbsp; &nbsp;/L:lineSize&nbsp; &nbsp; &nbsp; Specify the size of output lines (default: 78).<br />echo&nbsp; &nbsp;/F&#91;:fileSize&#93;&nbsp; &nbsp; /F switch specify to generate a Full installer file.<br />echo&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The optional fileSize specify the maximum output file size.<br />echo/<br />echo BinToBat encode the given data files as hexadecimal digits (or preserve they<br />echo as compressed text) and insert they into InstallFiles.bat program; when this<br />echo program run, it generates the original data files.<br />echo/<br />echo You may rename the InstallFiles.bat program as you wish, but preserving the<br />echo &quot;Install&quot; prefix is suggested.<br />echo/<br />echo You may use wild-cards in the filename list.<br />echo/<br />echo If the /F switch is not given, a Partial installer is created:<br />echo - You may insert a short description for each file.<br />echo - You may insert divisions in the file listing via a dash in the parameters.<br />echo - The installer allows to select which files will be downloaded and ask<br />echo&nbsp; &nbsp;before overwrite existent files.<br />echo/<br />echo If the /F switch is given, a Full installer is created:<br />echo - The installer always download all files.<br />echo - You may specify commands that will be executed after the files were copied.<br />echo - You may specify the maximum size of the output file via /F:fileFize, so in<br />echo&nbsp; &nbsp;this case the output file will be divided in parts with a numeric postfix.<br />echo/<br />echo&nbsp; &nbsp;If you use /F switch you can NOT rename the InstallFiles??.bat files; the<br />echo&nbsp; &nbsp;first one is the installer and the rest just contain data.<br />echo/<br />goto :EOF<br /><br />:begin<br />setlocal EnableDelayedExpansion<br />set atSign=@<br /><br />rem Process parameters: BinToBat /T:.ext1.ext2 /L:lineSize /F:fileSize file list ...<br />set &quot;myself=%~F0&quot;<br />set &quot;params=%*&quot;<br /><br />set &quot;param=%~1&quot;<br />set &quot;textTypes=&quot;<br />if /I &quot;%param:~0,3%&quot; equ &quot;/T:&quot; (<br />&nbsp; &nbsp;set &quot;textTypes=%param:~3%.&quot;<br />&nbsp; &nbsp;set &quot;params=!params:* =!&quot;<br />&nbsp; &nbsp;shift<br />)<br /><br />set &quot;param=%~1&quot;<br />set lineSize=78<br />if /I &quot;%param:~0,3%&quot; equ &quot;/L:&quot; (<br />&nbsp; &nbsp;set &quot;lineSize=%param:~3%&quot;<br />&nbsp; &nbsp;set &quot;params=!params:* =!&quot;<br />&nbsp; &nbsp;shift<br />)<br /><br />set &quot;param=%~1&quot;<br />if /I &quot;%param:~0,2%&quot; equ &quot;/F&quot; goto FullInstaller<br /><br /><br />:PartialInstaller<br /><br />rem Create the heading part of output file<br />(<br />echo %atSign%if (@CodeSection == @Batch^) @then<br />call :getResource BatchSection-PartialInstaller<br />echo %atSign%end<br />call :getResource JScriptSection<br />echo %atSign%if (@CodeSection == @Resources^) @then<br />) &gt; InstallFiles.bat<br /><br />rem Convert each given file to hex digits and embed them in its resource<br />echo --^&gt;&nbsp; Enter a short description for each division or file<br />echo/<br />set /A id=0, dId=0<br />for %%a in (%params%) do if /I &quot;%%~NXa&quot; neq &quot;InstallFiles.bat&quot; if /I &quot;%%~NXa&quot; neq &quot;%~NX0&quot; (<br />&nbsp; &nbsp;if &quot;%%a&quot; neq &quot;-&quot; (<br />&nbsp; &nbsp; &nbsp; if not exist &quot;%%~a&quot; (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;echo File not found: %%a<br />&nbsp; &nbsp; &nbsp; ) else (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set /A id+=1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set &quot;desc= &quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set /P &quot;desc=!id!- %%~NXa: &quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set type=notx<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if defined textTypes if &quot;!textTypes:%%~Xa.=!&quot; neq &quot;%textTypes%&quot; set type=text<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;( rem Start of redirected block<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;echo/<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;echo ^&lt;resource id=&quot;!id!|%%~Za|%%~NXa|!type!|!desc!&quot;^&gt;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Cscript //nologo //E:JScript &quot;%myself%&quot; !id! &quot;%%~a&quot; !type! !lineSize!<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;echo ^&lt;/resource^&gt;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;) &gt;&gt; InstallFiles.bat<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;echo %%~NXa file embedded<br />&nbsp; &nbsp; &nbsp; )<br />&nbsp; &nbsp;) else (<br />&nbsp; &nbsp; &nbsp; set /A dId-=1<br />&nbsp; &nbsp; &nbsp; set &quot;desc= &quot;<br />&nbsp; &nbsp; &nbsp; set /P &quot;desc=- &quot;<br />&nbsp; &nbsp; &nbsp; ( rem Start of redirected block<br />&nbsp; &nbsp; &nbsp; echo/<br />&nbsp; &nbsp; &nbsp; echo ^&lt;resource id=&quot;!dId!|0|- |div|!desc!&quot;^&gt;<br />&nbsp; &nbsp; &nbsp; echo ^&lt;/resource^&gt;<br />&nbsp; &nbsp; &nbsp; ) &gt;&gt; InstallFiles.bat<br />&nbsp; &nbsp;)<br />&nbsp; &nbsp;echo/<br />)<br /><br />rem Create the trailing part of output file<br />(<br />echo/<br />echo :getLastID<br />echo set lastID=!id!<br />echo exit /B<br />echo/<br />echo %atSign%end<br />) &gt;&gt; InstallFiles.bat<br />goto endFile<br /><br /><br />:FullInstaller<br /><br />rem Get the maximum file size from this parameter: /F:fileSize<br />for /F &quot;tokens=2 delims=:&quot; %%a in (&quot;%param%&quot;) do set &quot;maxSize=%%a&quot;<br />if defined maxSize (<br />&nbsp; &nbsp;set /A maxSize-=10<br />) else (<br />&nbsp; &nbsp;set /A maxSize=0x7FFFFFFF<br />)<br />set &quot;params=!params:* =!&quot;<br /><br />rem Create the heading part of output file<br />del InstallFiles??.bat 2&gt; NUL<br />(<br />echo %atSign%if (@CodeSection == @Batch^) @then<br />call :getResource BatchSection-FullInstaller<br />) &gt; InstallFiles00.bat<br />echo Enter commands that will be executed after the files were copied,<br />echo or an empty line to continue:<br />echo/<br />:nextCommand<br />&nbsp; &nbsp;set &quot;command=&quot;<br />&nbsp; &nbsp;set /P &quot;command=&gt; &quot;<br />&nbsp; &nbsp;if not defined command goto continue<br />&nbsp; &nbsp;echo !command!&gt;&gt; InstallFiles00.bat<br />goto nextCommand<br />:continue<br />( rem Start of redirected block<br />echo goto :EOF<br />echo/<br />echo End of Batch section<br />echo/<br />echo/<br />echo %atSign%end<br />call :getResource JScriptSection<br />echo %atSign%if (@CodeSection == @Resources^) @then<br />) &gt;&gt; InstallFiles00.bat<br /><br />rem Sort files by size in descending order<br />for %%a in (%params%) do set &quot;N=%%~Na&quot; &amp; if /I &quot;!N:~0,12!%%~Xa&quot; neq &quot;InstallFiles.bat&quot; if /I &quot;%%~Fa&quot; neq &quot;%myself%&quot; (<br />&nbsp; &nbsp;if not exist &quot;%%~a&quot; (<br />&nbsp; &nbsp; &nbsp; echo File not found: %%a<br />&nbsp; &nbsp;) else (<br />&nbsp; &nbsp; &nbsp; set /A fileSize=0x7FFFFFFF-%%~Za<br />&nbsp; &nbsp; &nbsp; set fileSize=000000000!fileSize!<br />&nbsp; &nbsp; &nbsp; set &quot;fileName&#91;!fileSize:~-10!-%%a&#93;=1&quot;<br />&nbsp; &nbsp;)<br />)<br /><br />rem Convert each given file to hex digits or encoded text and embed they in its resource<br />echo/<br />set id=0<br />set lastFile=100<br />for /F &quot;tokens=2 delims=-&#93;&quot; %%a in ('set fileName&#91;') do (<br />&nbsp; &nbsp;set /A id+=1<br />&nbsp; &nbsp;set type=notx<br />&nbsp; &nbsp;if defined textTypes if &quot;!textTypes:%%~Xa.=!&quot; neq &quot;%textTypes%&quot; set type=text<br />&nbsp; &nbsp;( rem Start of redirected block<br />&nbsp; &nbsp;echo/<br />&nbsp; &nbsp;echo ^&lt;resource id=&quot;!id!|%%~Za|%%~NXa|!type!| &quot;^&gt;<br />&nbsp; &nbsp;Cscript //nologo //E:JScript &quot;%myself%&quot; !id! &quot;%%~a&quot; !type! !lineSize!<br />&nbsp; &nbsp;echo ^&lt;/resource^&gt;<br />&nbsp; &nbsp;) &gt; InstallFiles.bat<br />&nbsp; &nbsp;rem Insert this data in the first output file with enough free space<br />&nbsp; &nbsp;for %%f in (InstallFiles.bat) do set increment=%%~Zf<br />&nbsp; &nbsp;for /L %%i in (100,1,!lastFile!) do if exist InstallFiles.bat (<br />&nbsp; &nbsp; &nbsp; set i=%%i<br />&nbsp; &nbsp; &nbsp; for %%f in (&quot;InstallFiles!i:~1!.bat&quot;) do set /A newSize=%%~Zf+increment<br />&nbsp; &nbsp; &nbsp; if !newSize! leq %maxSize% (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;type InstallFiles.bat &gt;&gt; InstallFiles!i:~1!.bat<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;del&nbsp; InstallFiles.bat<br />&nbsp; &nbsp; &nbsp; )<br />&nbsp; &nbsp;)<br />&nbsp; &nbsp;if exist InstallFiles.bat (<br />&nbsp; &nbsp; &nbsp; rem Create a new output file<br />&nbsp; &nbsp; &nbsp; set /A lastFile+=1<br />&nbsp; &nbsp; &nbsp; (<br />&nbsp; &nbsp; &nbsp; echo :InstallFiles!lastFile:~1!.bat<br />&nbsp; &nbsp; &nbsp; echo/<br />&nbsp; &nbsp; &nbsp; echo @goto :EOF<br />&nbsp; &nbsp; &nbsp; ) &gt; InstallFiles!lastFile:~1!.bat<br />&nbsp; &nbsp; &nbsp; if !increment! leq %maxSize% (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;rem Insert this data in the new empty file<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;type InstallFiles.bat &gt;&gt; InstallFiles!lastFile:~1!.bat<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;del&nbsp; InstallFiles.bat<br />&nbsp; &nbsp; &nbsp; ) else (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;rem Split this data in several new files<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;echo Creating part !lastFile:~1!<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set adjust=0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if !id! gtr 9 set adjust=1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set /A &quot;line=0, maxLines=(maxSize-1)/(lineSize+4+adjust)+1&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for /F &quot;delims=&quot; %%b in (InstallFiles.bat) do (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; set /A line+=1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if !line! equ !maxLines! (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;echo ^&lt;/resource^&gt;&gt;&gt; InstallFiles!lastFile:~1!.bat<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set /A lastFile+=1, line=0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;echo :InstallFiles!lastFile:~1!.bat<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;echo/<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;echo @goto :EOF<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;echo ^&lt;resource id=&quot;!id!|%%~Za|%%~NXa|!type!| &quot;^&gt;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;) &gt; InstallFiles!lastFile:~1!.bat<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;echo Creating part !lastFile:~1!<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; setlocal DisableDelayedExpansion<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo %%b<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; endlocal<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ) &gt;&gt; InstallFiles!lastFile:~1!.bat<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;del InstallFiles.bat<br />&nbsp; &nbsp; &nbsp; )<br />&nbsp; &nbsp;)<br />&nbsp; &nbsp;echo %%~NXa file embedded<br />)<br /><br />rem Create the trailing part of output file<br />(<br />echo/<br />echo %atSign%end<br />) &gt;&gt; InstallFiles00.bat<br /><br /><br />:endFile<br />echo/<br />echo InstallFiles.bat file(s) created<br />goto :EOF<br /><br /><br />:getResource resourceId<br />rem Resource data start format: ^&lt;resource id=&quot;resourceId&quot;^&gt;<br />set start=<br />set lines=<br />for /F &quot;tokens=1,3 delims=:=&gt;&quot; %%a in ('findstr /N &quot;^&lt;/*resource&quot; &quot;%myself%&quot;') do (<br />&nbsp; &nbsp;if not defined start (<br />&nbsp; &nbsp; &nbsp; if &quot;%1&quot; equ &quot;%%~b&quot; set start=%%a<br />&nbsp; &nbsp;) else (<br />&nbsp; &nbsp; &nbsp; if not defined lines set /A lines=%%a-start-1<br />&nbsp; &nbsp;)<br />)<br />set line=0<br />for /F &quot;skip=%start% tokens=1* delims=&#93;&quot; %%a in ('find /N /V &quot;&quot; ^&lt; &quot;%myself%&quot;') do (<br />&nbsp; &nbsp;setlocal DisableDelayedExpansion<br />&nbsp; &nbsp;echo(%%b<br />&nbsp; &nbsp;endlocal<br />&nbsp; &nbsp;set /A line+=1<br />&nbsp; &nbsp;if !line! equ %lines% exit /B<br />)<br />exit /B<br /><br />End of Batch section<br /><br /><br />@end<br /><br /><br />// JScript section<br /><br />// Convert original input file to encoded Stdout<br />// Antonio Perez Ayala<br /><br />// Arguments: idNumber fileName type lineSize<br /><br />var id = WScript.Arguments(0), lineSize = parseInt(WScript.Arguments(3));<br /><br />if ( WScript.Arguments(2) == &quot;text&quot; ) {<br /><br />// Convert input text file into an encoded text form in Stdout<br />// Each line is encoded as: &lt;number of spaces from 3 to 29&gt;&lt;line length&gt;:&lt;line contents&gt;<br /><br />var fso = new ActiveXObject(&quot;Scripting.FileSystemObject&quot;);<br />var input = fso.OpenTextFile(WScript.Arguments(1), 1);&nbsp; // ForReading = 1<br />var output = WScript.Stdout, outputLine = &quot;&quot;, atSign, key, pos;<br /><br />while ( ! input.AtEndOfStream ) {<br />&nbsp; &nbsp;var inputLine = input.ReadLine(), spaces = 0;<br />&nbsp; &nbsp;// Encode &lt;number of spaces&gt;<br />&nbsp; &nbsp;while ( inputLine.charAt(spaces) == &quot; &quot; ) spaces++;<br />&nbsp; &nbsp;if ( 3 &lt;= spaces &amp;&amp; spaces &lt;= 29 ) {<br />&nbsp; &nbsp; &nbsp; outputLine += spaces;<br />&nbsp; &nbsp; &nbsp; inputLine = inputLine.substr(spaces);<br />&nbsp; &nbsp;} else {<br />&nbsp; &nbsp; &nbsp; outputLine += &quot;0&quot;;<br />&nbsp; &nbsp;}<br />&nbsp; &nbsp;// Break JScript conditional compilation statements<br />&nbsp; &nbsp;atSign = 1;<br />&nbsp; &nbsp;while ( atSign ) {<br />&nbsp; &nbsp; &nbsp; atSign = inputLine.length;<br />&nbsp; &nbsp; &nbsp; for ( key in {&quot;if&quot;:0,&quot;elif&quot;:0,&quot;else&quot;:0,&quot;end&quot;:0} ) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if ( pos = inputLine.indexOf(&quot;@&quot;+key)+1 ) atSign=Math.min(atSign,pos);<br />&nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; if ( atSign &lt; inputLine.length ) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;outputLine += atSign+&quot;:&quot;+inputLine.substr(0,atSign)+&quot;@&quot;;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;inputLine = inputLine.substr(atSign);<br />&nbsp; &nbsp; &nbsp; } else {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;atSign = 0;<br />&nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp;}<br />&nbsp; &nbsp;// Encode joined &lt;line length&gt;: <br />&nbsp; &nbsp;if ( inputLine.length ) outputLine += inputLine.length;<br />&nbsp; &nbsp;outputLine += &quot;:&quot;;<br />&nbsp; &nbsp;if ( outputLine.length &gt;= lineSize ) {<br />&nbsp; &nbsp; &nbsp; output.WriteLine(id+&quot;:&quot;+outputLine);<br />&nbsp; &nbsp; &nbsp; outputLine = &quot;&quot;;<br />&nbsp; &nbsp;}<br />&nbsp; &nbsp;// Encode line contents<br />&nbsp; &nbsp;if ( inputLine.length ) outputLine += inputLine;<br />&nbsp; &nbsp;// Output result in segments<br />&nbsp; &nbsp;while ( outputLine.length &gt; lineSize ) {<br />&nbsp; &nbsp; &nbsp; output.WriteLine(id+&quot;:&quot;+outputLine.substr(0,lineSize));<br />&nbsp; &nbsp; &nbsp; outputLine = outputLine.substr(lineSize);<br />&nbsp; &nbsp;}<br />}<br />if ( outputLine.length ) output.WriteLine(id+&quot;:&quot;+outputLine);<br /><br />} else {<br /><br />// Convert binary bytes from input file to Hex digits in Stdout<br /><br />var ado = WScript.CreateObject(&quot;ADODB.Stream&quot;);<br />ado.Type = 2;&nbsp; // adTypeText = 2<br />ado.CharSet = &quot;iso-8859-1&quot;;&nbsp; // code page with minimum adjustments for input<br />ado.Open();<br />ado.LoadFromFile(WScript.Arguments(1));<br /><br />var adjustment = &quot;\u20AC\u0081\u201A\u0192\u201E\u2026\u2020\u2021&quot; +<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;\u02C6\u2030\u0160\u2039\u0152\u008D\u017D\u008F&quot; +<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;\u0090\u2018\u2019\u201C\u201D\u2022\u2013\u2014&quot; +<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;\u02DC\u2122\u0161\u203A\u0153\u009D\u017E\u0178&quot; ;<br /><br />var thisByte = ado.ReadText(1), lastByte = thisByte.charCodeAt(0), lastCount = 1, lastLen = 0,<br />&nbsp; &nbsp; output = WScript.Stdout, outputLine = &quot;&quot;;<br />if ( lastByte &gt; 255 ) lastByte = 128 + adjustment.indexOf(thisByte);<br />while ( ! ado.EOS ) {<br />&nbsp; &nbsp;var inputLine = ado.ReadText(128*1024);<br />&nbsp; &nbsp;for ( var index = 0; index &lt; inputLine.length; index++ ) {<br />&nbsp; &nbsp; &nbsp; thisByte = inputLine.charCodeAt(index);<br />&nbsp; &nbsp; &nbsp; if ( thisByte &gt; 255 ) thisByte = 128 + adjustment.indexOf(inputLine.charAt(index));<br />&nbsp; &nbsp; &nbsp; if ( thisByte == lastByte ) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;lastCount++;<br />&nbsp; &nbsp; &nbsp; } else {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;lastLen = outputLine.length;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;lastByte = (&quot;0&quot;+lastByte.toString(16)).slice(-2);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if ( (lastByte == &quot;00&quot; &amp;&amp; lastCount == 1) || (lastByte != &quot;00&quot; &amp;&amp; lastCount &lt; 4 ) ) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for ( var i = 1; i &lt;= lastCount; i++ ) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;outputLine += lastByte;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} else {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; outputLine += '&#91;' + lastCount;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ( lastByte != &quot;00&quot; ) outputLine += 'x' + lastByte;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; outputLine += '&#93;';<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;lastByte = thisByte;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;lastCount = 1;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if ( outputLine.length &gt; lineSize ) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; output.WriteLine(id+':'+outputLine.substr(0,lastLen));<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; outputLine = outputLine.substr(lastLen);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br />&nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp;}<br />&nbsp; &nbsp;WScript.Stderr.Write((ado.Position/ado.Size*100).toFixed() + &quot; % converted\r&quot;);<br />}<br />lastByte = (&quot;0&quot;+lastByte.toString(16)).slice(-2);<br />if ( lastCount &lt; 4 ) {<br />&nbsp; &nbsp;for ( i = 1; i &lt;= lastCount; i++ ) {<br />&nbsp; &nbsp; &nbsp; outputLine += lastByte;<br />&nbsp; &nbsp;}<br />} else {<br />&nbsp; &nbsp;outputLine += '&#91;' + lastCount;<br />&nbsp; &nbsp;if ( lastByte != &quot;00&quot; ) {<br />&nbsp; &nbsp; &nbsp; outputLine += 'x' + lastByte;<br />&nbsp; &nbsp;}<br />&nbsp; &nbsp;outputLine += '&#93;';<br />}<br />output.WriteLine(id+':'+outputLine);<br />ado.Close();<br /><br />}<br /><br />// End of JScript section<br /><br /><br />@if (@CodeSection == @Resources) @then<br /><br /><br />&lt;resource id=&quot;BatchSection-PartialInstaller&quot;&gt;<br /><br /><br />@echo off<br />setlocal EnableDelayedExpansion<br />if &quot;%~1&quot; neq &quot;&quot; if &quot;%~1&quot; neq &quot;/?&quot; goto begin<br />if &quot;%~1&quot; equ &quot;&quot; (<br />&nbsp; &nbsp;echo This program can install the following data files:<br />&nbsp; &nbsp;echo/<br />&nbsp; &nbsp;for /F tokens^=2-6^ delims^=^&quot;^| %%a in ('findstr &quot;^&lt;resource&quot; &quot;%~F0&quot;') do (<br />&nbsp; &nbsp; &nbsp; if %%a gtr 0 (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;echo&nbsp; &nbsp;%%a- %%c %%e<br />&nbsp; &nbsp; &nbsp; ) else (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;echo/<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;echo - %%e<br />&nbsp; &nbsp; &nbsp; )<br />&nbsp; &nbsp;)<br />&nbsp; &nbsp;echo/<br />&nbsp; &nbsp;echo For help, type: %0 /?<br />) else (<br />&nbsp; &nbsp;echo This program is an installer of several data files included in it.<br />&nbsp; &nbsp;echo/<br />&nbsp; &nbsp;echo To show a list of the included files, type just:&nbsp; %0<br />&nbsp; &nbsp;echo/<br />&nbsp; &nbsp;echo Enter the numbers of the desired files using the same format of &quot;tokens=...&quot;<br />&nbsp; &nbsp;echo FOR command's option (type: FOR /? for further details^). For example:<br />&nbsp; &nbsp;echo/<br />&nbsp; &nbsp;echo&nbsp; &nbsp; &nbsp;Install just file 6:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;%0 6<br />&nbsp; &nbsp;echo&nbsp; &nbsp; &nbsp;Install files 2, 4 and from 7 to 9:&nbsp; %0 2,4,7-9<br />&nbsp; &nbsp;echo&nbsp; &nbsp; &nbsp;Install files from 14 to last one:&nbsp; &nbsp;%0 14*<br />&nbsp; &nbsp;echo&nbsp; &nbsp; &nbsp;Install all files:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;%0 *<br />&nbsp; &nbsp;echo/<br />&nbsp; &nbsp;echo/<br />&nbsp; &nbsp;echo Created using BinToBat.bat file written by Antonio Perez Ayala (aka Aacini^)<br />)<br />echo/<br />goto :EOF<br /><br />:begin<br />call :getLastID<br />set argv=%*<br />if &quot;%argv%&quot; equ &quot;*&quot; (<br />&nbsp; &nbsp;set argv=1-%lastID%<br />) else (<br />&nbsp; &nbsp;if &quot;%argv:~-1%&quot; equ &quot;*&quot; (<br />&nbsp; &nbsp; &nbsp; if &quot;%argv:~-2%&quot; equ &quot;,*&quot; set argv=%argv:~0,-1%<br />&nbsp; &nbsp; &nbsp; set argv=!argv:~0,-1!-%lastID%<br />&nbsp; &nbsp;)<br />)<br />set idList=/<br />for %%a in (%argv%) do (<br />&nbsp; &nbsp;for /F &quot;tokens=1,2 delims=-&quot; %%b in (&quot;%%a&quot;) do (<br />&nbsp; &nbsp; &nbsp; if &quot;%%c&quot; equ &quot;&quot; (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set idList=!idList!%%b/<br />&nbsp; &nbsp; &nbsp; ) else (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for /L %%i in (%%b,1,%%c) do set idList=!idList!%%i/<br />&nbsp; &nbsp; &nbsp; )<br />&nbsp; &nbsp;)<br />)<br />set action=N<br />for /F tokens^=2-5^ delims^=^&quot;^| %%a in ('findstr &quot;^&lt;resource&quot; &quot;%~F0&quot;') do (<br />&nbsp; &nbsp;if &quot;!idList:/%%a/=/!&quot; neq &quot;%idList%&quot; (<br />&nbsp; &nbsp; &nbsp; set &quot;output=%~DP0%%c&quot;<br />&nbsp; &nbsp; &nbsp; if exist &quot;!output!&quot; (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if /I !action! neq A (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; set /P &quot;action=Overwrite %%c? (No/Yes/All): &quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; set &quot;action=!action:~0,1!<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set act=!action!<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if /I !act! equ A set act=Y<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if /I !act! equ Y del &quot;!output!&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if /I !action! neq A set action=N<br />&nbsp; &nbsp; &nbsp; )<br />&nbsp; &nbsp; &nbsp; if not exist &quot;!output!&quot; (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;echo/<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;echo Extracting %%c<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;findstr &quot;^%%a:&quot; &quot;%~F0&quot; | Cscript //nologo //E:JScript &quot;%~F0&quot; &quot;!output!&quot; %%b %%d<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;echo %%c file created<br />&nbsp; &nbsp; &nbsp; )<br />&nbsp; &nbsp; &nbsp; echo/<br />&nbsp; &nbsp;)<br />)<br />goto :EOF<br /><br />End of Batch section<br /><br /><br />&lt;/resource&gt;<br /><br /><br />&lt;resource id=&quot;BatchSection-FullInstaller&quot;&gt;<br /><br />@echo off<br />setlocal EnableDelayedExpansion<br /><br />cd &quot;%~P0&quot;<br />set lastFile=:dummy:<br />for %%f in (InstallFiles*.bat) do (<br />&nbsp; &nbsp;for /F tokens^=2-5^ delims^=^&quot;^| %%a in ('findstr &quot;^&lt;resource&quot; &quot;%%f&quot;') do (<br />&nbsp; &nbsp; &nbsp; if &quot;%%c&quot; neq &quot;!lastFile!&quot; (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;echo Extracting %%c<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set &quot;part=&quot;<br />&nbsp; &nbsp; &nbsp; ) else (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;echo Appending next part<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set part=part<br />&nbsp; &nbsp; &nbsp; )<br />&nbsp; &nbsp; &nbsp; findstr &quot;^%%a:&quot; &quot;%%f&quot; | Cscript //nologo //E:JScript InstallFiles00.bat &quot;%%c!part!&quot; %%b %%d<br />&nbsp; &nbsp; &nbsp; if defined part (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;type &quot;%%c!part!&quot; &gt;&gt; &quot;%%c&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;del&nbsp; &quot;%%c!part!&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;echo Part appended<br />&nbsp; &nbsp; &nbsp; ) else (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;echo %%c file created<br />&nbsp; &nbsp; &nbsp; )<br />&nbsp; &nbsp; &nbsp; set &quot;lastFile=%%c&quot;<br />&nbsp; &nbsp;)<br />)<br />&lt;/resource&gt;<br /><br /><br />&lt;resource id=&quot;JScriptSection&quot;&gt;<br /><br /><br />// JScript section<br /><br />// Convert encoded Stdin to original output file<br />// Antonio Perez Ayala<br /><br />// Arguments: fileName size type<br /><br />if ( WScript.Arguments(2) == &quot;text&quot; ) {<br /><br />// Convert encoded text from Stdin to output text file<br />// Each line is encoded as: &lt;number of spaces from 3 to 29&gt;&lt;line length&gt;:&lt;line contents&gt;<br /><br />var fso = new ActiveXObject(&quot;Scripting.FileSystemObject&quot;);<br />var output = fso.CreateTextFile(WScript.Arguments(0), true);<br />//&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 12345678901234567890123456789 <br />var spaces = &quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;, cutId, digits, inputBuf;<br />var input = WScript.StdIn, inputLine = &quot;&quot;, newLine = &quot;&quot;, len;<br /><br />while ( ! input.AtEndOfStream || inputLine.length ) {<br />&nbsp; &nbsp;if ( ! inputLine.length ) {<br />&nbsp; &nbsp; &nbsp; inputLine = input.ReadLine();<br />&nbsp; &nbsp; &nbsp; for ( cutId = 0; inputLine.charAt(cutId++) != &quot;:&quot;; );<br />&nbsp; &nbsp; &nbsp; inputLine = inputLine.substr(cutId);<br />&nbsp; &nbsp;}<br />&nbsp; &nbsp;len = inputLine.charAt(0);<br />&nbsp; &nbsp;inputLine = inputLine.substr(1);<br />&nbsp; &nbsp;if ( len == &quot;1&quot;&nbsp; ||&nbsp; len == &quot;2&quot; ) {<br />&nbsp; &nbsp; &nbsp; len += inputLine.charAt(0);<br />&nbsp; &nbsp; &nbsp; inputLine = inputLine.substr(1);<br />&nbsp; &nbsp;}<br />&nbsp; &nbsp;if ( len != &quot;@&quot;&nbsp; ) output.Write(newLine+spaces.substr(0,parseInt(len)));<br />&nbsp; &nbsp;newLine = &quot;\r\n&quot;;<br />&nbsp; &nbsp;for ( digits = 0; inputLine.charAt(digits) != &quot;:&quot;; digits++ );<br />&nbsp; &nbsp;len = digits ? parseInt(inputLine.substr(0,digits)) : 0;<br />&nbsp; &nbsp;inputLine = inputLine.substr(digits+1);<br />&nbsp; &nbsp;while ( inputLine.length &lt; len ) {<br />&nbsp; &nbsp; &nbsp; inputBuf = input.ReadLine();<br />&nbsp; &nbsp; &nbsp; for ( cutId = 0; inputBuf.charAt(cutId++) != &quot;:&quot;; );<br />&nbsp; &nbsp; &nbsp; inputLine += inputBuf.substr(cutId);<br />&nbsp; &nbsp;}<br />&nbsp; &nbsp;output.Write(inputLine.substr(0,len));<br />&nbsp; &nbsp;inputLine = inputLine.substr(len);<br />}<br />output.WriteLine();<br />output.Close();<br /><br />} else {<br /><br />// Convert Hex digits from Stdin to binary bytes in output file<br /><br />var ado = WScript.CreateObject(&quot;ADODB.Stream&quot;);<br />ado.Type = 2;&nbsp; // adTypeText = 2<br />ado.CharSet = &quot;iso-8859-1&quot;;&nbsp; // right code page for output (no adjustments)<br />ado.Open();<br /><br />var input = WScript.StdIn, cutId = 0, outputLine = &quot;&quot;, byte, count;<br />var size = parseInt(WScript.Arguments(1));<br />while ( ! input.AtEndOfStream ) {<br />&nbsp; &nbsp;var inputLine = input.ReadLine();<br />&nbsp; &nbsp;if ( cutId == 0 ) while ( inputLine.charAt(cutId++) != ':' );<br />&nbsp; &nbsp;for ( var index = cutId; index &lt; inputLine.length; ) {<br />&nbsp; &nbsp; &nbsp; if ( inputLine.charAt(index) == '&#91;' ) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for ( count = ++index; inputLine.charAt(index) != 'x' &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inputLine.charAt(index) != '&#93;' ; index++ ) ;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;count = parseInt(inputLine.slice(count,index++));<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if ( inputLine.charAt(index-1) == 'x' ) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; byte = String.fromCharCode(parseInt(inputLine.substr(index,2),16));<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; index += 3;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} else {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; byte = String.fromCharCode(0);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for ( var i = 1; i &lt;= count; i++ ) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; outputLine += byte;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br />&nbsp; &nbsp; &nbsp; } else {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;outputLine += String.fromCharCode(parseInt(inputLine.substr(index,2),16));<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;index += 2;<br />&nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp;}<br />&nbsp; &nbsp;if ( outputLine.charAt(32*1024) != &quot;&quot; ) {<br />&nbsp; &nbsp; &nbsp; ado.WriteText(outputLine);<br />&nbsp; &nbsp; &nbsp; outputLine = &quot;&quot;;<br />&nbsp; &nbsp; &nbsp; WScript.Stderr.Write((ado.Position/size*100).toFixed() + &quot; % converted\r&quot;);<br />&nbsp; &nbsp;}<br />}<br />if ( outputLine.length ) ado.WriteText(outputLine);<br />ado.SaveToFile(WScript.Arguments(0),2);&nbsp; // adSaveCreateOverWrite = 2<br />ado.Close();<br /><br />}<br /><br />// End of JScript section<br /><br /><br />&lt;/resource&gt;<br /><br /><br />@end<br /></code></pre></div><br /><br />I personally don't like this approach because the resulting installer files are too large, but I must admit that this method is simpler to follow. However, I think that the new complaints will come now from the opposite way: &quot;Why I must download a huge program if I only want a small file included in it?&quot; <img class="smilies" src="images/smilies/icon_wink.gif" alt=":wink:" title="Wink" /> <br /><br />Antonio</div>

			
													<div class="notice">
					Last edited by <a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a> on 21 Oct 2013 00:25, edited 5 times in total.
									</div>
			
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p28066" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile28066">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf147.html?author_id=3221&amp;sr=posts">6033</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Feb 2012 02:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content28066">

						<h3 ><a href="#p28066">Re: BinToBat.bat - Easily install files of any type or size!</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting5bcf.html?mode=quote&amp;f=3&amp;p=28066" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic2b9f.html?p=28066#p28066" onclick="prompt('Message #2',this.href); return false;">#2</a></span> 
									<a class="unread" href="viewtopic2b9f.html?p=28066#p28066" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a></strong> &raquo; </span>10 Aug 2013 02:10
			</p>
			
			
			
			<div class="content">That's a nice idea Aacini.<br /><br />I tested it and have to report a bug.<br /><br />When executing this on around 16 files:<br /><br /><span style="color: #0040FF">bin2bat.bat *</span><br />and <br /><span style="color: #0040FF">bin2bat.bat *.txt</span><br /><br />and then restoring the files in M:\ with <span style="color: #0040FF">InstallFiles.bat *</span> and running <span style="color: #0040FF">fc /b *.* m:*.*</span> I got an error on two files both times.<br />When testing just on those two files it worked fine.<br /><br />Here is one error:<br /><br /><span style="color: #0040FF">Comparing files text1.txt and M:text1.txt<br />00000000: 32 00<br />00000001: 30 00<br />00000002: 31 02<br />00000003: 33 00<br />00000004: 30 00<br />00000005: 37 3F<br />FC: text1.txt longer than M:text1.txt<br /><br /></span><br /><br /><br />It looks to have lots of potential.  Nice work otherwise.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p28069" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile28069">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchdc63.html?author_id=2923&amp;sr=posts">1540</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 06 Dec 2011 22:15</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> México City, México</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content28069">

						<h3 ><a href="#p28069">Re: BinToBat.bat - Easily install files of any type or size!</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingeb88.html?mode=quote&amp;f=3&amp;p=28069" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic2055.html?p=28069#p28069" onclick="prompt('Message #3',this.href); return false;">#3</a></span> 
									<a class="unread" href="viewtopic2055.html?p=28069#p28069" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a></strong> &raquo; </span>10 Aug 2013 04:52
			</p>
			
			
			
			<div class="content">Thanks a lot for your answer, foxi!  <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /> <br /><br />Do you mean that if you encode 16 files there is an error in text1.txt file and another one, but if you encode just these files there is NO error?  This is strange: the code for the encoding/decoding is the same in both cases...<br /><br />Are the files with error in certain positions inside the list of 16 files? Happen the error again if the files change positions in the list? <br /><br />May I ask you to do a small test? Please extract the section that corresponds to text1.txt file from the two InstallFiles.bat (including the &quot;&lt;resource id=&quot; lines), modify one of them so the number of the resource be the same in both cases and then FC both sections; indicate in the result which section is the correct one and which one have the error. I apologize for this request, but I tested my program several times and found no error... <img class="smilies" src="images/smilies/icon_confused.gif" alt=":?" title="Confused" /> <br /><br />Antonio</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p28072" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile28072">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchdc63.html?author_id=2923&amp;sr=posts">1540</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 06 Dec 2011 22:15</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> México City, México</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content28072">

						<h3 ><a href="#p28072">Re: BinToBat.bat - Easily install files of any type or size!</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingefa0.html?mode=quote&amp;f=3&amp;p=28072" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopice1f1.html?p=28072#p28072" onclick="prompt('Message #4',this.href); return false;">#4</a></span> 
									<a class="unread" href="viewtopice1f1.html?p=28072#p28072" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a></strong> &raquo; </span>10 Aug 2013 06:20
			</p>
			
			
			
			<div class="content">BUG FIXED <img class="smilies" src="images/smilies/icon_exclaim.gif" alt=":!:" title="Exclamation" />  <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /> <br /><br />Thanks again, foxidrive <img class="smilies" src="images/smilies/icon_mrgreen.gif" alt=":mrgreen:" title="Mr. Green" /> <br /><br />Antonio</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p28073" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile28073">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf147.html?author_id=3221&amp;sr=posts">6033</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 10 Feb 2012 02:20</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content28073">

						<h3 ><a href="#p28073">Re: BinToBat.bat - Easily install files of any type or size!</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingd29d.html?mode=quote&amp;f=3&amp;p=28073" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic505e.html?p=28073#p28073" onclick="prompt('Message #5',this.href); return false;">#5</a></span> 
									<a class="unread" href="viewtopic505e.html?p=28073#p28073" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5b5d.html?mode=viewprofile&amp;u=3221" style="color: #00AA00;" class="username-coloured">foxidrive</a></strong> &raquo; </span>10 Aug 2013 06:31
			</p>
			
			
			
			<div class="content">The two sections compare identically.<br /><br />I've PM'd you an FTP link for the files to check.<br /><br />The files that fail to decode properly are 6 and 9.<br /><br /><strong class="text-strong">EDIT:</strong> That's great.  I've tested your new version and it's working fine.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p28075" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile28075">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistc2fd.html?mode=viewprofile&amp;u=4985" class="username">Magialisk</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search6f26.html?author_id=4985&amp;sr=posts">104</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 25 Jul 2013 19:00</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content28075">

						<h3 ><a href="#p28075">Re: BinToBat.bat - Easily install files of any type or size!</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingfd58-2.html?mode=quote&amp;f=3&amp;p=28075" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic9f95.html?p=28075#p28075" onclick="prompt('Message #6',this.href); return false;">#6</a></span> 
									<a class="unread" href="viewtopic9f95.html?p=28075#p28075" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistc2fd.html?mode=viewprofile&amp;u=4985" class="username">Magialisk</a></strong> &raquo; </span>10 Aug 2013 08:13
			</p>
			
			
			
			<div class="content">Wow Aacini this is fantastically useful, and to be honest it couldn't have come at a better time for a project I'm working on in another thread.<br /><br />I was literally going to start a new thread in the next day or two asking if anyone knew how to take an entire file and convert it to hex, and then back again.  This is because I am writing an AES encryption cipher over in the string encryption thread and I wanted to be able to point it at a file and encrypt the hex data representing that file 128 bits at a time.<br /><br />I have the encryption working, haven't coded the decryption yet, but once I get there I had no idea how to translate a file to hex and back.  I just downloaded and tested your BinToHex from the linked thread and it works perfectly.  I should be able to use that as the front end into the encryptor and just parse the result 32 hex characters at a time.  THANK YOU <img class="smilies" src="images/smilies/icon_exclaim.gif" alt=":!:" title="Exclamation" /> <br /><br />I had a little more trouble using your HexToBin.bat to recover the file.  It works fine with the associated HexChar.vbs script, but the HexChar.exe doesn't work because it says it's not compatible with 64-bit versions of Windows.  I guess that means it's a 16-bit executable?  In reading your initial thread I very much agree that I'd prefer not to have a .vbs script required for recovering the binary file, so I was wondering how difficult it would be to create a 64-bit compatible exe?  Even without that this is a fantastic set of utilities that I'll definitely be playing with once I get my own code finished.  Thanks again!</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p28079" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile28079">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistfcd5.html?mode=viewprofile&amp;u=4915" style="color: #00AA00;" class="username-coloured">penpen</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1bf7.html?author_id=4915&amp;sr=posts">1612</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 Jun 2013 06:15</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content28079">

						<h3 ><a href="#p28079">Re: BinToBat.bat - Easily install files of any type or size!</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingd9d6.html?mode=quote&amp;f=3&amp;p=28079" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic48ac.html?p=28079#p28079" onclick="prompt('Message #7',this.href); return false;">#7</a></span> 
									<a class="unread" href="viewtopic48ac.html?p=28079#p28079" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistfcd5.html?mode=viewprofile&amp;u=4915" style="color: #00AA00;" class="username-coloured">penpen</a></strong> &raquo; </span>10 Aug 2013 14:26
			</p>
			
			
			
			<div class="content">If you have .NET installed, you may use jsc.exe to compile JScript.NET code to an executable, that will work on your system.<br />Just create jsc.bat:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>:main<br />&nbsp; &nbsp;@echo off<br />&nbsp; &nbsp;setlocal<br />&nbsp; &nbsp;cls<br /><br />&nbsp; &nbsp;set &quot;jsc=&quot;<br /><br />&nbsp; &nbsp;pushd &quot;%SystemRoot%\Microsoft.NET\Framework&quot;<br />&nbsp; &nbsp;for /f &quot;tokens=* delims=&quot; %%i in ('dir /b /o:n &quot;v*&quot;') do (<br />&nbsp; &nbsp;&nbsp; &nbsp;dir /a-d /b &quot;%%~fi\jsc.exe&quot; &gt;nul 2&gt;&amp;1 &amp;&amp; set &quot;jsc=&quot;%%~fi\jsc.exe&quot;&quot;<br />&nbsp; &nbsp;)<br />&nbsp; &nbsp;popd<br /><br />&nbsp; &nbsp;if defined jsc (<br />&nbsp; &nbsp;&nbsp; &nbsp;echo most recent JScript.NET compiler located in:<br />&nbsp; &nbsp;&nbsp; &nbsp;echo %jsc%.<br />&nbsp; &nbsp;) else (<br />&nbsp; &nbsp;&nbsp; &nbsp;echo JScript.NET compiler not found.<br />&nbsp; &nbsp;&nbsp; &nbsp;goto :eof<br />&nbsp; &nbsp;)<br /><br />&nbsp; &nbsp;%jsc% /nologo /target:exe /out:&quot;%~f1.exe&quot; &quot;%~f1.js&quot;<br />&nbsp; &nbsp;goto :eof<br /></code></pre></div><br />Then create the JScript.NET source file to compile.<br />Note, that WScript is not defined there, so you have to encapsulate this functionality within an own class.<br />Maybe some other classes are not accessible from .NET... you have just to try it out.<br />Here is just an example Test.js:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>import System;<br /><br />class WScript {<br />&nbsp; &nbsp;public static function Arguments (index:int) : String { <br />&nbsp; &nbsp;&nbsp; &nbsp;return System.Environment.GetCommandLineArgs() &#91;index&#93;;<br />&nbsp; &nbsp;}<br /><br />&nbsp; &nbsp;public static function Echo (message:String) : void {<br />&nbsp; &nbsp;&nbsp; &nbsp;print (message);<br />&nbsp; &nbsp;}<br />}<br /><br />WScript.Echo (WScript.Arguments(1));<br /></code></pre></div><br />And compile all using:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>jsc.bat Test<br /></code></pre></div>This will produce Test.exe.<br />Much fun with that <img class="smilies" src="images/smilies/icon_mrgreen.gif" alt=":mrgreen:" title="Mr. Green" /> <br /><br />penpen</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p28080" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile28080">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistc2fd.html?mode=viewprofile&amp;u=4985" class="username">Magialisk</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search6f26.html?author_id=4985&amp;sr=posts">104</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 25 Jul 2013 19:00</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content28080">

						<h3 ><a href="#p28080">Re: BinToBat.bat - Easily install files of any type or size!</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingb99a.html?mode=quote&amp;f=3&amp;p=28080" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic9fbe.html?p=28080#p28080" onclick="prompt('Message #8',this.href); return false;">#8</a></span> 
									<a class="unread" href="viewtopic9fbe.html?p=28080#p28080" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistc2fd.html?mode=viewprofile&amp;u=4985" class="username">Magialisk</a></strong> &raquo; </span>10 Aug 2013 15:12
			</p>
			
			
			
			<div class="content">Thank you penpen but I have to admit you're talking a little over my head.  Apart from 'gcc -o name name.c' my experience compiling source is as close to zero as to be indistinguishable  <img class="smilies" src="images/smilies/icon_redface.gif" alt=":oops:" title="Embarassed" />.  <br /><br />I actually understand your instructions and I believe I could follow them with some trial and error, however forgive me for not understanding this one particular point:  Would I have to take Aacini's .vbs code and re-write it in javascript (or JScript.NET as you called it) or would .NET compile the VB?  I'm sure that sounds like a noob question, but I've only ever written C/C++, never Java, Javascript or VBS, and I've certainly never done any .NET programming.  I'd probably be better off just rewriting it in C if I'm going to have to port it either way.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p28083" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile28083">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistfcd5.html?mode=viewprofile&amp;u=4915" style="color: #00AA00;" class="username-coloured">penpen</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1bf7.html?author_id=4915&amp;sr=posts">1612</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 23 Jun 2013 06:15</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content28083">

						<h3 ><a href="#p28083">Re: BinToBat.bat - Easily install files of any type or size!</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting4777.html?mode=quote&amp;f=3&amp;p=28083" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic749b.html?p=28083#p28083" onclick="prompt('Message #9',this.href); return false;">#9</a></span> 
									<a class="unread" href="viewtopic749b.html?p=28083#p28083" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistfcd5.html?mode=viewprofile&amp;u=4915" style="color: #00AA00;" class="username-coloured">penpen</a></strong> &raquo; </span>10 Aug 2013 15:59
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>Magialisk wrote:</cite>Would I have to take Aacini's .vbs code and re-write it in javascript (or JScript.NET as you called it) or would .NET compile the VB?<br /></div></blockquote>Acini's code to convert hex digits to bytes above is in JScript, and i thought the reverse operation is done in JScript, too.<br />If this were the case you can use this code, then add the WScript class surogate (the above example is not complete, and should only show, that you only have to define the needed functions), save it to a *.js file and compile the file(s).<br /><br />But if it is done in vbs, you may use the VB.NET compiler vbc.exe instead of the jsc.exe (with some slight changes to the script, too) to compile it.<br />If VBS/VB.NET is not your favorite you may translate it to JScript.NET code if you want (or to C# code with csc.exe C#.NET compiler).<br /> <img class="smilies" src="images/smilies/icon_idea.gif" alt=":idea:" title="Idea" /> Or maybe Aacini translates it from VBS to VB.NET or JScript.NET.<br /><br />penpen<br /><br />PS: JScript.NET is not JScript is not javascript&#058;<br />javascript is specified by the W3C. JScript 1.0 is compatible with this javascript 1.0 (the same with higher versions i think), but has some extra features..., but in the actual version of JScript it is nearly another language.<br />JScript is interpreted only; this is done by the WSH (Windows Scripting Host).<br />JScript.NET is part of the .NET idea and produces executable code only, these two differs mainly on different objects that are accessible, for example the WScript object.<br />The .NET compilers are little brothers of the compilers contained in Microsofts Visual Studio (much more code optimization, and interface definitions).<br />But the .NET compilers suffices in most cases, for small tasks as this one (hex value &lt;-&gt; byte).</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p28084" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile28084">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistc2fd.html?mode=viewprofile&amp;u=4985" class="username">Magialisk</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search6f26.html?author_id=4985&amp;sr=posts">104</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 25 Jul 2013 19:00</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content28084">

						<h3 ><a href="#p28084">Re: BinToBat.bat - Easily install files of any type or size!</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingd9b5.html?mode=quote&amp;f=3&amp;p=28084" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopice6ad.html?p=28084#p28084" onclick="prompt('Message #10',this.href); return false;">#10</a></span> 
									<a class="unread" href="viewtopice6ad.html?p=28084#p28084" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistc2fd.html?mode=viewprofile&amp;u=4985" class="username">Magialisk</a></strong> &raquo; </span>10 Aug 2013 18:18
			</p>
			
			
			
			<div class="content">penpen I really appreciate your attempts to help me, but I'm afraid I'm more confused now after your second post than I was after your first.  I'm just out of touch with programming anything that isn't a batch file <img class="smilies" src="images/smilies/icon_razz.gif" alt=":P" title="Razz" /><br /><br />I'll read your post again with clearer eyes in the morning, but I may just have to fall back to my original plan for doing hex-&gt;ascii.  I was just going to use a lookup table of sorts to do the conversion, since jeb and dbenham and others have found ways to represent almost every ascii character (all but null?) in batch, I was thinking I could just run the hex through a lookup table to reconstitute the original ascii text.  I'm assuming that the reason Aacini's solution is more complicated is because of one of the following:<br />1.)  He's encoding executables, and/or other binary data that isn't strictly ASCII text whereas I'm only concerned about encoding text files.   - or -<br />2.)  I haven't given this problem enough thought, and I really need something like Aacini created but I don't know it yet<br /><br />In any case I still need to code the decryption portion of my AES algorithm before I can worry about running files through it, so I'll have to revist this issue again when the time comes.  Thanks again for your help!</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p28085" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile28085">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistcb12.html?mode=viewprofile&amp;u=1621" class="username">carlos</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchda66.html?author_id=1621&amp;sr=posts">472</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 20 Aug 2010 13:57</dd>		
		
																<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Chile</dd>
							
							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact carlos">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact carlos</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="https://web.archive.org/web/20180902091521/http://consolesoft.com/" title="Website" class="last-cell">
										<span class="contact-icon phpbb_website-icon">Website</span>
									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content28085">

						<h3 ><a href="#p28085">Re: BinToBat.bat - Easily install files of any type or size!</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingebc0.html?mode=quote&amp;f=3&amp;p=28085" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicf49b-2.html?p=28085#p28085" onclick="prompt('Message #11',this.href); return false;">#11</a></span> 
									<a class="unread" href="viewtopicf49b-2.html?p=28085#p28085" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistcb12.html?mode=viewprofile&amp;u=1621" class="username">carlos</a></strong> &raquo; </span>10 Aug 2013 19:11
			</p>
			
			
			
			<div class="content">aacini i run it for know it and i get a message error using windows xp xp3:<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>C:\Documents and Settings\Carlos\Escritorio\bintobat.cmd(195, 1) WScript.CreateObject: No se pudo crear el objeto denominado &quot;ADODB.Stream&quot;.</code></pre></div><br /><br />also, you look my bhx utility <div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>http://www.dostips.com/forum/viewtopic.php?f=3&amp;t=4104</code></pre></div>, i work hard in it, it can generate compatible code for do rebuilds in windows nt, and also, if the file es cabinet it automatically add the code for expand it, and is open source.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p28105" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile28105">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistfff4.html?mode=viewprofile&amp;u=3621" class="username">brinda</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search6a76.html?author_id=3621&amp;sr=posts">78</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 25 Apr 2012 23:51</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content28105">

						<h3 ><a href="#p28105">Re: BinToBat.bat - Easily install files of any type or size!</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting8d34.html?mode=quote&amp;f=3&amp;p=28105" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic0421.html?p=28105#p28105" onclick="prompt('Message #12',this.href); return false;">#12</a></span> 
									<a class="unread" href="viewtopic0421.html?p=28105#p28105" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistfff4.html?mode=viewprofile&amp;u=3621" class="username">brinda</a></strong> &raquo; </span>11 Aug 2013 07:16
			</p>
			
			
			
			<div class="content">antonio,<br />thanks working in win2000 and winxp. another way to pass executable through email. Unless the anti-virus starts detecting... <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p29211" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile29211">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchdc63.html?author_id=2923&amp;sr=posts">1540</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 06 Dec 2011 22:15</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> México City, México</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content29211">

						<h3 ><a href="#p29211">Re: BinToBat.bat - Easily install files of any type or size!</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting3208.html?mode=quote&amp;f=3&amp;p=29211" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic2ebe.html?p=29211#p29211" onclick="prompt('Message #13',this.href); return false;">#13</a></span> 
									<a class="unread" href="viewtopic2ebe.html?p=29211#p29211" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a></strong> &raquo; </span>16 Oct 2013 10:14
			</p>
			
			
			
			<div class="content">@carlos:<br /><br />The main reason I had to write this program was the capability to include several files in the same encoded data and extract individual files. My <a href="viewtopic3b4a.html?f=3&amp;t=3202" class="postlink">first program</a> can be used to encode/decode any data file including those formats that contain several files, althought I prefer the more common .zip format instead of the .cab one, but there is no method to extract an individual file from anyone of these compressed formats. Also, my program is entirely provided in source code.<br /><br />___________________________________________________________________________________<br /><br /><br />I modified the BinToBat.bat program in order to preserve the format of text files and not encode they in hexadecimal digits, so the size of the resulting data is lesser. The posted code have now the updated version.<br /><br />Antonio</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p31616" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile31616">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchdc63.html?author_id=2923&amp;sr=posts">1540</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 06 Dec 2011 22:15</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> México City, México</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content31616">

						<h3 ><a href="#p31616">Re: BinToBat.bat - Easily install files of any type or size!</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingc3e4.html?mode=quote&amp;f=3&amp;p=31616" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicb4ce.html?p=31616#p31616" onclick="prompt('Message #14',this.href); return false;">#14</a></span> 
									<a class="unread" href="viewtopicb4ce.html?p=31616#p31616" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a></strong> &raquo; </span>09 Jan 2014 19:41
			</p>
			
			
			
			<div class="content">I started the conversion programs mentioned at beginning of this thread with the purpose to have a method to convert binary files to Ascii text and vice versa, so they can be copied from forums like this one or sent via email, for example. The programs of that thread evolved into this one so the last version of BinToBat.bat have multiple features useful for encode a large number of files, select which ones to extract, split the encoded data in several parts of a maximum size, etc. However, as foxidrive indicated several times, these methods are not simple enough to be used by a novice Batch file user. This is a problem if you write a program that use a binary file (for example, one of my <a href="viewtopic9635.html?f=3&amp;t=3428" class="postlink">Auxiliary .EXE Programs</a>) and you want that the Batch file be downloaded and used by anyone.<br /><br />I extracted the decoding part from BinToBat.bat program and isolate it into a subroutine that may be easily called in a Batch program; this subroutine is a simpler form suitable for small files. This way, you may develop your own Batch file applications with embedded binary data so the final user have not to complete any additional step in order to use they, besides downloading the program.<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@if (@CodeSection == @Batch) @then<br /><br /><br />@echo off <br /><br />rem Place your Batch code here. <br />echo This program requires filename.ext binary file.<br /><br />rem Use :ExtractBinaryFile subroutine to extract the binary file; for example:<br />if not exist filename.ext call :ExtractBinaryFile filename.ext<br /><br />goto :EOF<br /><br /><br />rem Extract Binary File from hexadecimal digits placed in a &quot;resource&quot; in this .bat file<br /><br />:ExtractBinaryFile filename.ext<br />setlocal EnableDelayedExpansion<br />set &quot;start=&quot;<br />set &quot;end=&quot;<br />for /F &quot;tokens=1,3 delims=:=&gt;&quot; %%a in ('findstr /N /B &quot;&lt;/*resource&quot; &quot;%~F0&quot;') do (<br />&nbsp; &nbsp;if not defined start (<br />&nbsp; &nbsp; &nbsp; if &quot;%%~b&quot; equ &quot;%~1&quot; set start=%%a<br />&nbsp; &nbsp;) else if not defined end set end=%%a<br />)<br />(for /F &quot;skip=%start% tokens=1* delims=:&quot; %%a in ('findstr /N &quot;^&quot; &quot;%~F0&quot;') do (<br />&nbsp; &nbsp;if &quot;%%a&quot; == &quot;%end%&quot; goto decodeHexFile<br />&nbsp; &nbsp;echo %%b<br />)) &gt; &quot;%~1.hex&quot;<br />:decodeHexFile<br />&lt; &quot;%~1.hex&quot; Cscript //nologo //E:JScript &quot;%~F0&quot; Extract &quot;%~1&quot;<br />del &quot;%~1.hex&quot;<br />exit /B<br /><br />&lt;resource id=&quot;filename.ext&quot;&gt;<br />Put here the hexadecimal digits representation of &quot;filename.ext&quot;. You may create it with BinToHex.bat program:<br />http://www.dostips.com/forum/viewtopic.php?f=3&amp;t=3202<br />&lt;/resource&gt;<br /><br />&lt;resource id=&quot;anotherFile.ext&quot;&gt;<br />You may include several binary files, each one with its own resource id.<br />&lt;/resource&gt;<br /><br /><br />@end<br /><br /><br />// Convert Ascii hexadecimal digits from Stdin to a binary string<br />var count, byte, output = &quot;&quot;;<br />while ( !WScript.Stdin.AtEndOfStream ) {<br />&nbsp; &nbsp;var input = WScript.Stdin.ReadLine();<br />&nbsp; &nbsp;for ( var index = 0; index &lt; input.length; ) {<br />&nbsp; &nbsp; &nbsp; if ( input.charAt(index) == '&#91;' ) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for ( count = ++index; input.charAt(index) != 'x' &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; input.charAt(index) != '&#93;' ; index++ ) ;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;count = parseInt(input.slice(count,index++));<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if ( input.charAt(index-1) == 'x' ) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; byte = String.fromCharCode(parseInt(input.substr(index,2),16));<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; index += 3;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} else {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; byte = String.fromCharCode(0);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for ( var i = 1; i &lt;= count; i++ ) output += byte;<br />&nbsp; &nbsp; &nbsp; } else {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;output += String.fromCharCode(parseInt(input.substr(index,2),16));<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;index += 2;<br />&nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp;}<br />}<br /><br />// Write the binary string to the output file<br />var ado = WScript.CreateObject(&quot;ADODB.Stream&quot;);<br />ado.Type = 2;&nbsp; // adTypeText = 2<br />ado.CharSet = &quot;iso-8859-1&quot;;&nbsp; // right code page for output (no adjustments)<br />ado.Open();<br />ado.WriteText(output);<br />ado.SaveToFile(WScript.Arguments(0),2); // adSaveCreateOverWrite = 2<br />ado.Close();<br /></code></pre></div><br /><br />You may review and example of this method at <a href="http://ss64.org/viewtopic.php?pid=7326#p7326" class="postlink">this post</a>.<br /><br />Antonio</div>

			
													<div class="notice">
					Last edited by <a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a> on 10 Jan 2014 12:58, edited 1 time in total.
									</div>
			
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p31631" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile31631">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5152.html?mode=viewprofile&amp;u=5284" class="username">siberia-man</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search7f01.html?author_id=5284&amp;sr=posts">108</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 26 Dec 2013 09:28</dd>		
		
											
							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact siberia-man">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact siberia-man</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="http://with-love-from-siberia.blogspot.com/" title="Website" class="last-cell">
										<span class="contact-icon phpbb_website-icon">Website</span>
									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content31631">

						<h3 ><a href="#p31631">Re: BinToBat.bat - Easily install files of any type or size!</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting0742.html?mode=quote&amp;f=3&amp;p=31631" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicd547-2.html?p=31631#p31631" onclick="prompt('Message #15',this.href); return false;">#15</a></span> 
									<a class="unread" href="viewtopicd547-2.html?p=31631#p31631" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5152.html?mode=viewprofile&amp;u=5284" class="username">siberia-man</a></strong> &raquo; </span>10 Jan 2014 08:07
			</p>
			
			
			
			<div class="content"><strong class="text-strong">Aacini</strong>, you have posted very interesting solution at your first post. I've just began to learn it and found the weird code. Could you give more details on it? <br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&nbsp; &nbsp;// Encode &lt;number of spaces&gt;<br />&nbsp; &nbsp;while ( inputLine.charAt(spaces) == &quot; &quot; ) spaces++;<br />&nbsp; &nbsp;if ( 3 &lt;= spaces &amp;&amp; spaces &lt;= 29 ) {<br />&nbsp; &nbsp; &nbsp; outputLine += spaces;<br />&nbsp; &nbsp; &nbsp; inputLine = inputLine.substr(spaces);<br />&nbsp; &nbsp;} else {<br />&nbsp; &nbsp; &nbsp; outputLine += &quot;0&quot;;<br />&nbsp; &nbsp;}<br /></code></pre></div><br /><br />Why the number of leading spaces to be trimmed is limited by 3 and 29? <br />I cannot understand what is the big difference between 29 and 30 leading spaces =)Why leading spaces only, not trailing?<br />Is it possible to rewrite it to be better understandable? What will happen if I replace the part above by the following example (it looks much better):<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>// Encode the number of leading spaces<br />var re = /^ +/;<br />var m = re.exec(inputLine) || { lastIndex: 0 };<br /><br />inputLine = inputLine.slice(m.lastIndex);<br />outputLine += m.lastIndex;<br /></code></pre></div><br /><br /><strong class="text-strong">update</strong><br /><br />Could you be so kind as to perform the following changes to your script<br />1. Replace the first line of the script with (append the opening js-comment <strong class="text-strong"> /*</strong>)<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@if (@CodeSection == @Batch) @then /*</code></pre></div><br />2. Put the closing JS-comment between cmd and js parts<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@end<br />*/<br /></code></pre></div><br /><br />Of course, we can do it ourselves. But it will help folks reading the code in editors with syntax highlighting.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
	

	<div class="action-bar bar-bottom">
	
			<a href="postingc595.html?mode=reply&amp;f=3&amp;t=4842" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopicc91b.html?f=3&amp;t=4842&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

			<form method="post" action="https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=4842">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			26 posts
							<ul>
		<li class="active"><span>1</span></li>
				<li><a class="button" href="viewtopic53d6.html?f=3&amp;t=4842&amp;start=15" role="button">2</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="viewtopic53d6.html?f=3&amp;t=4842&amp;start=15" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="viewforum4d6b.html?f=3" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to “DOS Batch Forum”</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="viewforum31e6.html?f=4" class="jumpbox-cat-link"> <span> DosTips - Dos Batch</span></a></li>
																<li><a href="viewforum4d6b.html?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; DOS Batch Forum</span></a></li>
											</ul>
		</div>
	</div>

	</div>


			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
							<span class="crumb"><a href="../index.html" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>DosTips.com</span></a></span>									<span class="crumb"><a href="index.html" data-navbar-reference="index"><span>Board index</span></a></span>					</li>
		
				<li class="rightside">All times are <span title="UTC-6">UTC-06:00</span></li>
							<li class="rightside">
				<a href="ucp033a.html?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete all board cookies</span>
				</a>
			</li>
												<li class="rightside" data-last-responsive="true">
				<a href="memberlist4bfd.html?mode=team" role="menuitem">
					<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
				</a>
			</li>
									<li class="rightside" data-last-responsive="true">
				<a href="memberlist8733.html?mode=contactadmin" role="menuitem">
					<i class="icon fa-envelope fa-fw" aria-hidden="true"></i><span>Contact us</span>
				</a>
			</li>
			</ul>

	</div>
</div>

	<div class="copyright">
				<!-- WARNING NO DELETE -->Style developer by <a href="http://tricolor.x-tk.ru/">support forum tricolor</a>, <!-- END WARNING NO DELETE -->Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
									</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	</div>

<script type="text/javascript" src="assets/javascript/jquery.mind772.js?assets_version=34"></script>
<script type="text/javascript" src="assets/javascript/cored772.js?assets_version=34"></script>



<script type="text/javascript" src="styles/prosilver/template/forum_fnd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/prosilver/template/ajaxd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/jquery-uid772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/collapsed772.js?assets_version=34"></script>



</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?p=28105 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 08:14:10 GMT -->
</html>
