<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?p=12053 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 06:43:57 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>Macros with parameters appended - Page 2 - DosTips.com</title>


	<link rel="canonical" href="viewtopic19cd.html?t=2518&amp;start=15">

<!--
	phpBB style name: Allan Style - SUBSILVER
	Based on style:   prosilver (this is the default phpBB3 style)
	Based on style:   subsilver2 (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:  Allan ( http://x-tk.ru/ )
-->

<link href="assets/css/font-awesome.mind772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/stylesheetd772.css?assets_version=34" rel="stylesheet">
<link href="styles/AllanStyle-SUBSILVER/theme/en/stylesheetd772.css?assets_version=34" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="./styles/AllanStyle-SUBSILVER/theme/tweaks.css?assets_version=34" rel="stylesheet">
<![endif]-->




<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','../../www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-280191-1', 'auto');
	ga('send', 'pageview');
</script>

</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">

<div id="header-subsilver">
	<a id="top" class="top-anchor" accesskey="t"></a>
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description" class="site-description">
				<a id="logo" class="logo" href="../index.html" title="DosTips.com"><span class="site_logo"></span></a>
				<h1>DosTips.com</h1>
				<p>A Forum all about DOS Batch</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

									<div id="search-box" class="search-box search-header" role="search">
				<form action="https://www.dostips.com/forum/search.php" method="get" id="search">
				<fieldset>
					<input name="keywords" id="keywords" type="search" maxlength="128" title="Search for keywords" class="inputbox search tiny" size="20" value="" placeholder="Search…" />
					<button class="button button-search" type="submit" title="Search">
						<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
					</button>
					<a href="search.html" class="button button-search-end" title="Advanced search">
						<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
					</a>
					
				</fieldset>
				</form>
			</div>
						
			</div>
					</div>
</div>


<div id="wrap" class="wrap">
	<div id="page-header">
				<div class="navbar-top" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
																									<li>
								<a href="search33a7.html?search_id=unanswered" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="search526f.html?search_id=active_topics" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-blue" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="search.html" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
											<li class="separator"></li>
																			<li>
								<a href="memberlist4bfd.html?mode=team" role="menuitem">
									<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
								</a>
							</li>
																<li class="separator"></li>

									</ul>
			</div>
		</li>

				<li data-skip-responsive="true">
			<a href="app.php/help/faq.html" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
						
			<li class="rightside"  data-skip-responsive="true">
			<a href="ucp26c3.html?mode=login" title="Login" accesskey="x" role="menuitem">
				<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Login</span>
			</a>
		</li>
					<li class="rightside" data-skip-responsive="true">
				<a href="ucp8319.html?mode=register" role="menuitem">
					<i class="icon fa-pencil-square-o  fa-fw" aria-hidden="true"></i><span>Register</span>
				</a>
			</li>
						</ul>

	</div>
</div>

<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
						<li class="breadcrumbs">
							<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="../index.html" itemprop="url" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span itemprop="title">DosTips.com</span></a></span>
										<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope=""><a href="index.html" itemprop="url" accesskey="h" data-navbar-reference="index"><span itemprop="title">Board index</span></a></span>

											<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="4"><a href="viewforum31e6.html?f=4" itemprop="url"><span itemprop="title">DosTips - Dos Batch</span></a></span>
															<span class="crumb"  itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" data-forum-id="3"><a href="viewforum4d6b.html?f=3" itemprop="url"><span itemprop="title">DOS Batch Forum</span></a></span>
												</li>
		
					<li class="rightside responsive-search">
				<a href="search.html" title="View the advanced search options" role="menuitem">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</a>
			</li>
			</ul>

	</div>
</div>

<div class="navbar-top-link">
	<div class="inner">
		<ul>
			<li class="navbar-top-link-left"><a href="search33a7.html?search_id=unanswered">Unanswered topics</a></li>
			<li class="navbar-top-link-left"><a href="search526f.html?search_id=active_topics">Active topics</a></li>

											</ul>
	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
		
<h2 class="topic-title"><a href="viewtopic667d.html?f=3&amp;t=2518&amp;start=15">Macros with parameters appended</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">Discussion forum for all Windows batch related topics.<br /></div>
<p>
	<strong>Moderator:</strong> <a href="memberlista6a8.html?mode=viewprofile&amp;u=5" class="username">DosItHelp</a>
</p>


<div class="action-bar bar-top">
	
			<a href="posting5376.html?mode=reply&amp;f=3&amp;t=2518" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopicf967.html?f=3&amp;t=2518&amp;start=15&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="https://www.dostips.com/forum/search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topic…" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="search.html" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="2518" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			29 posts
							<ul>
			<li class="arrow previous"><a class="button button-icon-only" href="viewtopic1ca9.html?f=3&amp;t=2518" rel="prev" role="button"><i class="icon fa-chevron-left fa-fw" aria-hidden="true"></i><span class="sr-only">Previous</span></a></li>
				<li><a class="button" href="viewtopic1ca9.html?f=3&amp;t=2518" role="button">1</a></li>
			<li class="active"><span>2</span></li>
	</ul>
					</div>
		</div>




<div id="subsilver-nav-topic">
	<div class="inner"><div class="post has-profile">
		<div class="leftsided postbody subsilver-topic-title">Message</div>
		<div class="leftsided postprofile subsilver-topic-author">Author</div>
	</div></div>
</div>

			<div id="p12052" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile12052">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist7125.html?mode=viewprofile&amp;u=417" class="username">jeb</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search73f1.html?author_id=417&amp;sr=posts">880</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 30 Aug 2007 08:05</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany, Bochum</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content12052">

						<h3 class="first"><a href="#p12052">Re: Macros with parameters appended</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting5bbf.html?mode=quote&amp;f=3&amp;p=12052" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopica81f.html?p=12052#p12052" onclick="prompt('Message #16',this.href); return false;">#16</a></span> 
									<a class="unread" href="viewtopica81f.html?p=12052#p12052" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist7125.html?mode=viewprofile&amp;u=417" class="username">jeb</a></strong> &raquo; </span>12 Dec 2011 07:46
			</p>
			
			
			
			<div class="content">Ok, it's obvious: I didn't test it before  <img class="smilies" src="images/smilies/icon_sad.gif" alt=":(" title="Sad" /> <br />But also that the brackets are unbalanced <img class="smilies" src="images/smilies/icon_exclaim.gif" alt=":!:" title="Exclamation" /> <br />That's the test against newbies  <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /> <br /><br />It should be<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>set LF=^<br /><br /><br />set ^&quot;\n=^^^%LF%%LF%^%LF%%LF%^^&quot;<br />set $SomeMacro=for /L %%n in (1 1 2) do if %%n==2 (%\n%<br />&nbsp; &nbsp; &nbsp; set argv%\n%<br />&nbsp; &nbsp; &nbsp; for /f &quot;delims=&quot; %%r in (&quot;!argv!&quot;) do endlocal^&amp; echo.set &quot;%%~3=%%~r&quot; %\n%<br />) ELSE setlocal enableDelayedExpansion ^&amp; echo ProofOfconcept is showed only once %%n ^&amp; set argv=,<br /><br />%$SomeMacro% a,b,c<br /></code></pre></div><br /><br /><blockquote><div><cite>Output wrote:</cite>ProofOfconcept is showed only once 1<br />argv=, a,b,c<br />set &quot;%~3=, a,b,c&quot;<br /></div></blockquote><br /><br />jeb</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p12053" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile12053">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberliste2cd.html?mode=viewprofile&amp;u=2453" class="username">Ed Dyreen</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search0d5e.html?author_id=2453&amp;sr=posts">1497</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 16 May 2011 08:21</dd>		
		
																<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Flanders(Belgium)</dd>
							
							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact Ed Dyreen">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact Ed Dyreen</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="http://ed-dyreen.ddns.net/" title="Website" class="last-cell">
										<span class="contact-icon phpbb_website-icon">Website</span>
									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content12053">

						<h3 ><a href="#p12053">Re: Macros with parameters appended</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingdace.html?mode=quote&amp;f=3&amp;p=12053" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic4165.html?p=12053#p12053" onclick="prompt('Message #17',this.href); return false;">#17</a></span> 
									<a class="unread" href="viewtopic4165.html?p=12053#p12053" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberliste2cd.html?mode=viewprofile&amp;u=2453" class="username">Ed Dyreen</a></strong> &raquo; </span>12 Dec 2011 07:53
			</p>
			
			
			
			<div class="content">'<br />I see, but to get oopsy at the bottom you still need bracket <img class="smilies" src="images/smilies/icon_sad.gif" alt=":(" title="Sad" /> <br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br /><br />set LF=^<br /><br /><br />set ^&quot;\n=^^^%LF%%LF%^%LF%%LF%^^&quot;<br />set $SomeMacro=for /L %%n in (1 1 2) do if %%n==2 (%\n%<br />&nbsp; &nbsp; &nbsp; set argv%\n%<br />&nbsp; &nbsp; &nbsp; for /f &quot;delims=&quot; %%r in (&quot;!argv!&quot;) do endlocal^&amp; echo.set &quot;%%~3=%%~r&quot; %\n%<br />) ELSE setlocal enableDelayedExpansion ^&amp; echo ProofOfconcept is showed only once %%n ^&amp; set argv=,<br /><br />%$SomeMacro% a,b,c &amp;echo.oopsy<br /><br />pause<br />exit<br /></code></pre></div><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>ProofOfconcept is showed only once 1<br />oopsy<br />argv=, a,b,c<br />set &quot;%~3=, a,b,c &quot;<br />Druk op een toets om door te gaan. . .<br /></code></pre></div><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br /><br />set LF=^<br /><br /><br />set ^&quot;\n=^^^%LF%%LF%^%LF%%LF%^^&quot;<br />set $SomeMacro=for /L %%n in (1 1 2) do if %%n==2 (%\n%<br />&nbsp; &nbsp; &nbsp; set argv%\n%<br />&nbsp; &nbsp; &nbsp; for /f &quot;delims=&quot; %%r in (&quot;!argv!&quot;) do endlocal^&amp; echo.set &quot;%%~3=%%~r&quot; %\n%<br />) ELSE setlocal enableDelayedExpansion ^&amp; echo ProofOfconcept is showed only once %%n ^&amp; set argv=,<br /><br />( %$SomeMacro% a,b,c ) &amp;echo.oopsy<br /><br />pause<br />exit<br /></code></pre></div><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>ProofOfconcept is showed only once 1<br />argv=, a,b,c<br />set &quot;%~3=, a,b,c &quot;<br />oopsy<br />Druk op een toets om door te gaan. . .<br /></code></pre></div></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p12077" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile12077">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchdc63.html?author_id=2923&amp;sr=posts">1540</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 06 Dec 2011 22:15</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> México City, México</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content12077">

						<h3 ><a href="#p12077">Re: Macros with parameters appended</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting91a8.html?mode=quote&amp;f=3&amp;p=12077" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopica7e6.html?p=12077#p12077" onclick="prompt('Message #18',this.href); return false;">#18</a></span> 
									<a class="unread" href="viewtopica7e6.html?p=12077#p12077" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a></strong> &raquo; </span>12 Dec 2011 21:55
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>jeb wrote:</cite>Welcome Aacini to the expert discussions <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /> <br /><br />Thanks, jeb. <br /><br /><blockquote><div><cite>Aacini wrote:</cite>Because this trick use textual substitution of whichever text placed after the macro, if another &amp; COMMAND is placed after macro params, that command will also be carried into the for body and hence also executed 2 times:<br />[...]<br />The only way to avoid this effect is isolating the macro and parameters from the rest of the line by enclosing they in parentheses, as Ed indicated.</div></blockquote><br />Did I said that I love to disprove such declarations <img class="smilies" src="images/smilies/icon_question.gif" alt=":?:" title="Question" />  <img class="smilies" src="images/smilies/icon_cool.gif" alt="8)" title="Cool" /> <br /><br />I simply forgot to post the solution for this<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>set $SomeMacro=for /L %%n in (1 1 2) do if %%n==2 (%\n%<br />&nbsp; &nbsp;&nbsp; &nbsp;rem *** MACRO Content<br />&nbsp; &nbsp;&nbsp; &nbsp;for /f &quot;delims=&quot; %%r in (&quot;!result!&quot;) do endlocal^&amp; set &quot;%%~3=%%~r&quot; %\n%<br />&nbsp; &nbsp;) %\n%<br />) ELSE setlocal enableDelayedExpansion ^&amp; echo ProofOfconcept is showed only once %%n ^&amp; set argv=,<br /></code></pre></div><br />In this case it is really obvious, isn't it?<br /><br />jeb</div></blockquote><br />Although you are right, we are talking about two different things.<br /><br />All my description is based on your first example, where the FOR command have parentheses to enclose its body:<br /><blockquote><div><cite>jeb wrote:</cite>The main idea is this:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>FOR/L %%n in (1,1,2) DO (<br />&nbsp; if %%n==2 ( // Now we can access the parameters<br />&nbsp; &nbsp; &nbsp;// get the parameters<br />&nbsp; &nbsp; &nbsp;// run the macro<br />&nbsp; )<br />) &amp; set parameters=<br /></code></pre></div><br /><br />And here is a working sample...<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&#91;...&#93;<br />set $strLen=for /L %%n in (1 1 2) do ( %\n%<br />&nbsp; &nbsp;if %%n==2 (%\n%<br />&#91;...&#93;<br /></code></pre></div><br /><br />jeb</div></blockquote><br />When dbenham noted that ...<br /><blockquote><div><cite>jeb wrote:</cite><blockquote><div><cite>dbenham wrote:</cite>Two minor inconveniences: [...]<br /><br />2) Any command added on the same line after the macro call will be executed twice</div></blockquote><br /><br />The solution for these two points is obviously  <img class="smilies" src="images/smilies/icon_wink.gif" alt=":wink:" title="Wink" /> <br /><br />- Do the set argv and the rest only if %%n==1<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&#91;...&#93;<br />set argv=original<br />set $strLen=for /L %%n in (1 1 2) do if %%n==2 (%\n%<br />&#91;...&#93;<br /></code></pre></div><br />[...]<br />jeb</div></blockquote><br />... you &quot;forgot&quot; to mention that, in order for this method to work, the parentheses of the FOR body <strong class="text-strong">MUST</strong> be deleted <img class="smilies" src="images/smilies/icon_exclaim.gif" alt=":!:" title="Exclamation" />  I didn't realized that these parentheses were removed until now. This change mades my description about this problem totally nonsense, including the FOR with 3 IF's example. I must modify these parts in my explanation... <img class="smilies" src="images/smilies/icon_confused.gif" alt=":?" title="Confused" /> <br /><br />Antonio</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p12132" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile12132">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchdc63.html?author_id=2923&amp;sr=posts">1540</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 06 Dec 2011 22:15</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> México City, México</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content12132">

						<h3 ><a href="#p12132">Re: Macros with parameters appended</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting7139.html?mode=quote&amp;f=3&amp;p=12132" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicbc31.html?p=12132#p12132" onclick="prompt('Message #19',this.href); return false;">#19</a></span> 
									<a class="unread" href="viewtopicbc31.html?p=12132#p12132" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a></strong> &raquo; </span>15 Dec 2011 22:46
			</p>
			
			
			
			<div class="content">jeb: I modified my original answer as I said. Perhaps you would like to review it looking for a new declaration to disprove  <img class="smilies" src="images/smilies/icon_neutral.gif" alt=":|" title="Neutral" />  <img class="smilies" src="images/smilies/icon_confused.gif" alt=":?" title="Confused" /></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p12173" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile12173">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist7125.html?mode=viewprofile&amp;u=417" class="username">jeb</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search73f1.html?author_id=417&amp;sr=posts">880</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 30 Aug 2007 08:05</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany, Bochum</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content12173">

						<h3 ><a href="#p12173">Re: Macros with parameters appended</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingead9.html?mode=quote&amp;f=3&amp;p=12173" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic9b5f.html?p=12173#p12173" onclick="prompt('Message #20',this.href); return false;">#20</a></span> 
									<a class="unread" href="viewtopic9b5f.html?p=12173#p12173" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist7125.html?mode=viewprofile&amp;u=417" class="username">jeb</a></strong> &raquo; </span>18 Dec 2011 17:01
			</p>
			
			
			
			<div class="content">@Aacini: The explanation looks fine  <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /> <br /><br />Currently I haven't an idea to solve the &amp; append command problem, so the command will be executed after the rest of the macro.<br /><br />Pipes have the required precedence, but they seem to be unsuitable for a solution here.<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>macro .... | set argv=&nbsp; &nbsp;.... &amp; echo This executes at the end<br />( echo 1 &amp; echo 2 ) | more &amp; echo end</code></pre></div><br /><br />jeb</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p12306" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile12306">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchdc63.html?author_id=2923&amp;sr=posts">1540</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 06 Dec 2011 22:15</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> México City, México</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content12306">

						<h3 ><a href="#p12306">Re: Macros with parameters appended</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting3406.html?mode=quote&amp;f=3&amp;p=12306" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic4e9e.html?p=12306#p12306" onclick="prompt('Message #21',this.href); return false;">#21</a></span> 
									<a class="unread" href="viewtopic4e9e.html?p=12306#p12306" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist07be.html?mode=viewprofile&amp;u=2923" style="color: #00AA00;" class="username-coloured">Aacini</a></strong> &raquo; </span>27 Dec 2011 00:28
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>Ed Dyreen wrote:</cite>And while you're at it, how about&#058;<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>set /a $var=%StrLen% ( &quot;I wish this worked&quot; ) + %random%<br /></code></pre></div> Now that would be really impressive. <img class="smilies" src="images/smilies/icon_lol.gif" alt=":lol:" title="Laughing" /></div></blockquote><br /><br />Yes, it can be done now this way:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>set &quot;string=I wish this worked&quot;<br />%set/a% $var=StrLen(string)+%random%<br /></code></pre></div><br />See my SET/A macro at <a href="viewtopic537b.html?t=2704" class="postlink">this topic</a></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p48172" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile48172">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist411e.html?mode=viewprofile&amp;u=8113" class="username">mirrormirror</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1ac1.html?author_id=8113&amp;sr=posts">127</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 08 Feb 2016 20:25</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content48172">

						<h3 ><a href="#p48172">Re: Macros with parameters appended</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingc3da.html?mode=quote&amp;f=3&amp;p=48172" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic13fe.html?p=48172#p48172" onclick="prompt('Message #22',this.href); return false;">#22</a></span> 
									<a class="unread" href="viewtopic13fe.html?p=48172#p48172" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist411e.html?mode=viewprofile&amp;u=8113" class="username">mirrormirror</a></strong> &raquo; </span>28 Jul 2016 19:39
			</p>
			
			
			
			<div class="content">I'm working to get my head around macros and just wanted to ask if this thread contained the most recent developments / syntax conventions that you guys use.  In particular, I'm relying on this post: <a href="viewtopic1ca9.html?f=3&amp;t=2518#p12045" class="postlink">http://www.dostips.com/forum/viewtopic.php?f=3&amp;t=2518#p12045</a> and hoping the info. is up to date.<br /><br />I've read through newer threads discussing techniques to add comments to macros but they seemed to use the same conventions as discussed here.<br /><br />I'm trying to write a couple of macros and just want to use the latest and greatest methods if possible.<br /><br />btw: a special thanks to Aacini for taking the time to document this in detail.  A question on your post though... Was there supposed to be a code example in here - right before the &quot;Second Part:...&quot; ?<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>However, because this method use textual substitution of whichever text placed after the macro, if another &amp; COMMAND is placed after macro params, then that command also belongs to ELSE part and will also be executed before the macro, that is an unexpected behavior. The only way to avoid this effect is isolating the macro and parameters from the rest of the line by enclosing they in parentheses.<br /><br /><br /><br />Second part: An additional contribution.<br /><br />When we define a macroFuncWithParams variable with this format, we may duplicate the original macroFunc code in the macro execution part, taking the parameters from argv variable (as in jeb example above); or we may use the original macroFunc code over argv variable in a nested macro invocation:</code></pre></div></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p48194" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile48194">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist411e.html?mode=viewprofile&amp;u=8113" class="username">mirrormirror</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1ac1.html?author_id=8113&amp;sr=posts">127</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 08 Feb 2016 20:25</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content48194">

						<h3 ><a href="#p48194">Re: Macros with parameters appended</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting8340.html?mode=quote&amp;f=3&amp;p=48194" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicc619.html?p=48194#p48194" onclick="prompt('Message #23',this.href); return false;">#23</a></span> 
									<a class="unread" href="viewtopicc619.html?p=48194#p48194" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist411e.html?mode=viewprofile&amp;u=8113" class="username">mirrormirror</a></strong> &raquo; </span>29 Jul 2016 16:56
			</p>
			
			
			
			<div class="content">Also, Aacini, when I try your code from this post: <strong class="text-strong"><a href="viewtopic1ca9.html?f=3&amp;t=2518#p12045" class="postlink">http://www.dostips.com/forum/viewtopic.php?f=3&amp;t=2518#p12045</a></strong> it doesn't work - i.e. my output differs from what you indicated in your post:<br />your code:<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />cls<br />setlocal DisableDelayedExpansion<br />set LF=^<br /><br /><br /><br />::Above 2 blank lines are required - do not remove<br />set ^&quot;\n=^^^%LF%%LF%^%LF%%LF%^^&quot;<br /><br /><br />set strLen=(%\n%<br />&nbsp; &nbsp;setlocal enableDelayedExpansion%\n%<br />&nbsp; &nbsp;set &quot;str=A!%%~b!&quot;%\n%<br />&nbsp; &nbsp;set &quot;len=0&quot;%\n%<br />&nbsp; &nbsp;for /l %%A in (12,-1,0) do (%\n%<br />&nbsp; &nbsp; &nbsp; set /a &quot;len|=1&lt;&lt;%%A&quot;%\n%<br />&nbsp; &nbsp; &nbsp; for %%B in (!len!) do if &quot;!str:~%%B,1!&quot;==&quot;&quot; set /a &quot;len&amp;=~1&lt;&lt;%%A&quot;%\n%<br />&nbsp; &nbsp;)%\n%<br />&nbsp; &nbsp;for %%v in (!len!) do endlocal^&amp;if &quot;%%~a&quot; neq &quot;&quot; (set &quot;%%~a=%%v&quot;) else echo %%v%\n%<br />)<br /><br /><br />set let=for %%n in (1 2) do if %%n==2 (%\n%<br />&nbsp; &nbsp; &nbsp; for /F &quot;tokens=1-4 delims==(,) &quot; %%1 in (&quot;!argv!&quot;) do (%\n%<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;echo -------------------------- %\n%<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set macroFunc=%%1%\n%<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;echo macroFunc=!macroFunc! %\n%<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set param1=%%2%\n%<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;echo param1=!param1! %\n%<br />REM&nbsp; &nbsp; &nbsp; set param2=%%3%\n%<br />REM&nbsp; &nbsp; &nbsp; echo param2=!param2! %\n%<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set resultVar=%%3%\n%<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;echo resultVar=!resultvar! %\n%<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;call !macroFunc! !param1! !param2! resultValue%\n%<br />REM&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for /F &quot;tokens=1-26&quot; %%a in (&quot;!param1! !param2! resultValue&quot;) do (%\n%<br />REM&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;nested call %%%%macroFunc%%%% %\n%<br />REM&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;)%\n%<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for %%v in (!resultValue!) do endlocal^&amp;set &quot;%%1=%%v&quot;%\n%<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;echo -------------------------- %\n%<br />&nbsp; &nbsp; &nbsp; )%\n%<br />&nbsp; &nbsp;) else setlocal enableDelayedExpansion ^&amp; set argv=<br /><br /><br />set &quot;testString=this has a length of 23&quot;<br />echo Test string is (&quot;%testString%&quot;)<br />echo/<br /><br />echo Original (FOR /F ...) strLen macro invocation:<br />for /F &quot;tokens=1-26&quot; %%a in (&quot;testString forResult&quot;) do %strLen%<br />echo Original FOR macro invocation result is %forResult%<br />echo/<br /><br />echo Original &quot;CALL :strLen testString subResult&quot; subroutine invocation:<br />call :strLen testString subResult=<br />echo Original CALL subroutine invocation result is %subResult%<br />echo/<br /><br />echo %%Let%% letResult=:strLen(testString) invocation:<br />%let% letResult=:strLen(testString)<br />echo LET letResult=strLen(testString) result is %letResult%<br /><br />goto :EOF<br /><br /><br />:strLen string resultVar=<br />setlocal enableDelayedExpansion<br />set &quot;str=0!%~1!&quot;<br />set &quot;len=0&quot;<br />for /l %%A in (12,-1,0) do (<br />&nbsp; &nbsp;set /a &quot;len|=1&lt;&lt;%%A&quot;<br />&nbsp; &nbsp;for %%B in (!len!) do if &quot;!str:~%%B,1!&quot;==&quot;&quot; set /a &quot;len&amp;=~1&lt;&lt;%%A&quot;<br />)<br />for %%v in (!len!) do endlocal&amp;if &quot;%~2&quot; neq &quot;&quot; (set &quot;%~2=%%v&quot;) else echo %%v<br />exit /B<br /></code></pre></div> Your Output:<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>Test string is (&quot;this has a length of 23&quot;)<br /><br />Original (FOR /F ...) strLen macro invocation:<br />Original FOR macro invocation result is 23<br /><br />Original &quot;CALL :strLen testString subResult&quot; subroutine invocation:<br />Original CALL subroutine invocation result is 23<br /><br />%Let% letResult=:strLen(testString) invocation:<br />--------------------------<br />macroFunc=:strLen<br />param1=testString<br />resultVar=letResult<br />--------------------------<br />LET letResult=strLen(testString) result is 23</code></pre></div><br />My Output:<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>Test string is (&quot;this has a length of 23&quot;)<br /><br />Original (FOR /F ...) strLen macro invocation:<br />Original FOR macro invocation result is<br /><br />Original &quot;CALL :strLen testString subResult&quot; subroutine invocation:<br />Original CALL subroutine invocation result is 1<br /><br />%Let% letResult=:strLen(testString) invocation:<br />--------------------------<br />macroFunc=letResult<br />param1=:strLen<br />resultVar=testString<br />'letResult' is not recognized as an internal or external command,<br />operable program or batch file.<br />--------------------------<br />LET letResult=strLen(testString) result is</code></pre></div></div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p48218" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile48218">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist7125.html?mode=viewprofile&amp;u=417" class="username">jeb</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search73f1.html?author_id=417&amp;sr=posts">880</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 30 Aug 2007 08:05</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany, Bochum</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content48218">

						<h3 ><a href="#p48218">Re: Macros with parameters appended</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting5155.html?mode=quote&amp;f=3&amp;p=48218" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic8df6.html?p=48218#p48218" onclick="prompt('Message #24',this.href); return false;">#24</a></span> 
									<a class="unread" href="viewtopic8df6.html?p=48218#p48218" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist7125.html?mode=viewprofile&amp;u=417" class="username">jeb</a></strong> &raquo; </span>31 Jul 2016 05:31
			</p>
			
			
			
			<div class="content">Hi mirrormirror,<br /><br />yes, I suppose it's more or less the <em class="text-italics">state of art</em> for macro programming.</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p57692" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile57692">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content57692">

						<h3 ><a href="#p57692">Re: Macros with parameters appended</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting4cc7.html?mode=quote&amp;f=3&amp;p=57692" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopicd24b.html?p=57692#p57692" onclick="prompt('Message #25',this.href); return false;">#25</a></span> 
									<a class="unread" href="viewtopicd24b.html?p=57692#p57692" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>05 Aug 2018 19:49
			</p>
			
			
			
			<div class="content">The \n value used to create multi-line macros <a href="viewtopic3740.html?f=3&amp;t=8769&amp;start=15#p57691" class="postlink">can be greatly simplified as ^&lt;LF&gt; instead of ^&lt;LF&gt;&lt;LF&gt;^</a>.<br>

<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>(set \n=^^^
%= This creates an escaped Line Feed - DO NOT ALTER =%
)
</code></pre></div>

<br>
Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p57694" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile57694">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search661c.html?author_id=1265&amp;sr=posts">3386</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 22 Jan 2010 18:01</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content57694">

						<h3 ><a href="#p57694">Re: Macros with parameters appended</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingc80c.html?mode=quote&amp;f=3&amp;p=57694" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic2f9e.html?p=57694#p57694" onclick="prompt('Message #26',this.href); return false;">#26</a></span> 
									<a class="unread" href="viewtopic2f9e.html?p=57694#p57694" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a></strong> &raquo; </span>06 Aug 2018 11:32
			</p>
			
			
			
			<div class="content">Do you remember what the caret at the end was good for if you read that, Dave?<br>
<a href="viewtopicbcaf.html?f=3&amp;t=1827#p7358" class="postlink">viewtopic.php?f=3&amp;t=1827#p7358</a><br>
I tried to follow that old thread but with all these double and triple escapings I'm not able to recognize it anymore  <img class="smilies" src="images/smilies/icon_confused.gif" width="15" height="15" alt=":?" title="Confused"> <br>
<br>
Steffen</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p57695" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile57695">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content57695">

						<h3 ><a href="#p57695">Re: Macros with parameters appended</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingee63.html?mode=quote&amp;f=3&amp;p=57695" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic514c.html?p=57695#p57695" onclick="prompt('Message #27',this.href); return false;">#27</a></span> 
									<a class="unread" href="viewtopic514c.html?p=57695#p57695" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>06 Aug 2018 12:19
			</p>
			
			
			
			<div class="content">Sure.<br>
<br>
The old \n was defined as ^^^&lt;LF&gt;&lt;LF&gt;^&lt;LF&gt;&lt;LF&gt;^^<br>
<br>
After parsing the definition, the actual stored value is ^&lt;LF&gt;&lt;LF&gt;^<br>
<br>
When included at the end of a macro definition line, the ^&lt;LF&gt;&lt;LF&gt; inserts a single &lt;LF&gt; into the macro definition, <strong class="text-strong"><span style="color: #0000FF">and the trailing ^ escapes the (&lt;CR&gt;)&lt;LF&gt; at the end of the source code line</span></strong> so that the next source line is included in the definition. The first character of that next line is escaped during the definition of the macro -  But that typically doesn't matter.<br>
<br>
The new \n is defined as ^^^(&lt;CR&gt;)&lt;LF&gt;(&lt;CR&gt;)&lt;LF&gt;<br>
<br>
After parsing the definition, the actual stored value is ^&lt;LF&gt;<br>
<br>
When included at the end of a macro definition line, the ^&lt;LF&gt; is in front of the (&lt;CR&gt;)&lt;LF&gt; at the end of the source line, which is parsed as a single &lt;LF&gt; that gets inserted into the definition, and the next line is still appended to the definition. This time the first character of the next line is not escaped during the definition - Again, this typically does not matter.<br>
<br>
<br>
Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p57696" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile57696">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search661c.html?author_id=1265&amp;sr=posts">3386</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 22 Jan 2010 18:01</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Germany</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content57696">

						<h3 ><a href="#p57696">Re: Macros with parameters appended</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting19af.html?mode=quote&amp;f=3&amp;p=57696" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic9d6a.html?p=57696#p57696" onclick="prompt('Message #28',this.href); return false;">#28</a></span> 
									<a class="unread" href="viewtopic9d6a.html?p=57696#p57696" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistf667.html?mode=viewprofile&amp;u=1265" style="color: #00AA00;" class="username-coloured">aGerman</a></strong> &raquo; </span>06 Aug 2018 13:10
			</p>
			
			
			
			<div class="content"><blockquote><div><cite><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258">dbenham</a> wrote: <a href="viewtopic514c.html?p=57695#p57695" data-post-id="57695" onclick="if(document.getElementById(hash.substr(1)))href=hash">↑</a><div class="responsive-hide">06 Aug 2018 12:19</div></cite>Again, this typically does not matter.</div></blockquote>
That's what I wasn't clear anymore <img class="smilies" src="images/smilies/icon_wink.gif" width="15" height="15" alt=":wink:" title="Wink"> I just wanted to make sure there was no exception where escaping the first character would have been required.<br>
<br>
Steffen</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p57697" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile57697">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a>							</dt>

						<dd class="profile-rank">Expert</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searcha86d.html?author_id=2258&amp;sr=posts">2152</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> 12 Feb 2011 21:02</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> United States (east coast)</dd>
							
						
		</dl>

		<div class="postbody">
						<div id="post_content57697">

						<h3 ><a href="#p57697">Re: Macros with parameters appended</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingecd9.html?mode=quote&amp;f=3&amp;p=57697" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author"><span class="posti"><a href="viewtopic0dc8.html?p=57697#p57697" onclick="prompt('Message #29',this.href); return false;">#29</a></span> 
									<a class="unread" href="viewtopic0dc8.html?p=57697#p57697" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist3d77.html?mode=viewprofile&amp;u=2258" style="color: #00AA00;" class="username-coloured">dbenham</a></strong> &raquo; </span>06 Aug 2018 15:25
			</p>
			
			
			
			<div class="content">No, that was a side effect rather than a goal. We mistakenly thought the \n definition required ^&lt;LF&gt;&lt;LF&gt;, meaning the (&lt;CR&gt;)&lt;LF&gt; at the end of the line would normally terminate the definition. The trailing ^ was just to force the next line to be appended to the definition.<br>
<br>
The escaped first character of the next line is only during the definition of the macro. So if the first character of the next line happens to be a special character that normally requires escaping, then the old definition avoids the need to explicitly escape it. The only case I can think of where this makes sense in a macro definition is if you put redirection at the front of a command.<br>
<br>
I also often get confused between the escapes in the definition vs the execution of the macro.  <img class="smilies" src="images/smilies/icon_confused.gif" width="15" height="15" alt=":?" title="Confused"> <br>
In a previous post I think I said there could be an advantage of the new \n, but now I don't see any.<br>
<br>
<br>
Dave Benham</div>

			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
	

	<div class="action-bar bar-bottom">
	
			<a href="posting5376.html?mode=reply&amp;f=3&amp;t=2518" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopicf967.html?f=3&amp;t=2518&amp;start=15&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

			<form method="post" action="https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=2518&amp;start=15">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			29 posts
							<ul>
			<li class="arrow previous"><a class="button button-icon-only" href="viewtopic1ca9.html?f=3&amp;t=2518" rel="prev" role="button"><i class="icon fa-chevron-left fa-fw" aria-hidden="true"></i><span class="sr-only">Previous</span></a></li>
				<li><a class="button" href="viewtopic1ca9.html?f=3&amp;t=2518" role="button">1</a></li>
			<li class="active"><span>2</span></li>
	</ul>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="viewforum4d6b.html?f=3" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to “DOS Batch Forum”</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="viewforum31e6.html?f=4" class="jumpbox-cat-link"> <span> DosTips - Dos Batch</span></a></li>
																<li><a href="viewforum4d6b.html?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; DOS Batch Forum</span></a></li>
											</ul>
		</div>
	</div>

	</div>


			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
							<span class="crumb"><a href="../index.html" data-navbar-reference="home"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>DosTips.com</span></a></span>									<span class="crumb"><a href="index.html" data-navbar-reference="index"><span>Board index</span></a></span>					</li>
		
				<li class="rightside">All times are <span title="UTC-6">UTC-06:00</span></li>
							<li class="rightside">
				<a href="ucp033a.html?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete all board cookies</span>
				</a>
			</li>
												<li class="rightside" data-last-responsive="true">
				<a href="memberlist4bfd.html?mode=team" role="menuitem">
					<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
				</a>
			</li>
									<li class="rightside" data-last-responsive="true">
				<a href="memberlist8733.html?mode=contactadmin" role="menuitem">
					<i class="icon fa-envelope fa-fw" aria-hidden="true"></i><span>Contact us</span>
				</a>
			</li>
			</ul>

	</div>
</div>

	<div class="copyright">
				<!-- WARNING NO DELETE -->Style developer by <a href="http://tricolor.x-tk.ru/">support forum tricolor</a>, <!-- END WARNING NO DELETE -->Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
									</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	<img src="cron5897.gif?cron_type=cron.task.text_reparser.poll_option" width="1" height="1" alt="cron" /></div>

<script type="text/javascript" src="assets/javascript/jquery.mind772.js?assets_version=34"></script>
<script type="text/javascript" src="assets/javascript/cored772.js?assets_version=34"></script>



<script type="text/javascript" src="styles/prosilver/template/forum_fnd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/prosilver/template/ajaxd772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/jquery-uid772.js?assets_version=34"></script>
<script type="text/javascript" src="styles/AllanStyle-SUBSILVER/template/collapsed772.js?assets_version=34"></script>



</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?p=12053 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 06:43:57 GMT -->
</html>
