<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=4741&start=30&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 08:33:48 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>DosTips.com &bull; SNAKE.BAT 4.1 - An arcade style game using pure batch - Page 3</title>

<link href="styles/AllanStyle-SUBSILVER/theme/print.css" rel="stylesheet">
</head>
<body id="phpbb">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>DosTips.com</h1>
		<p>A Forum all about DOS Batch<br /><a href="index-2.html">https://www.dostips.com/forum/</a></p>

		<h2>SNAKE.BAT 4.1 - An arcade style game using pure batch</h2>
		<p><a href="viewtopic6484.html?f=3&amp;t=4741">https://www.dostips.com/forum/viewtopic.php?f=3&amp;t=4741</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>3</strong> of <strong>8</strong></div>
					<div class="post">
				<h3>Re: SNAKE.BAT - An arcade style game using pure batch</h3>
				<div class="date">Posted: <strong>17 Jul 2013 13:35</strong></div>
				<div class="author">by <strong>aGerman</strong></div>
				<div class="content">Well actually the /L option is not necessary since XCOPY doesn't copy the same file onto itself. It was just my thinking to tell XCOPY that it should only do a simulation of the copy action instead of trying to really copy the file. A double safeguarding so to speak <img class="smilies" src="images/smilies/icon_wink.gif" alt=":wink:" title="Wink" /><br />I'm not quite certain what the /X option has to do with it though <img class="smilies" src="images/smilies/icon_confused.gif" alt=":?" title="Confused" /> Where did you see it?<br /><br />Regards<br />aGerman</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: SNAKE.BAT - An arcade style game using pure batch</h3>
				<div class="date">Posted: <strong>17 Jul 2013 19:51</strong></div>
				<div class="author">by <strong>dbenham</strong></div>
				<div class="content"><img class="smilies" src="images/smilies/icon_eek.gif" alt=":shock:" title="Shocked" />  <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /> <br />Using XCOPY to replace CHOICE is brilliant <img class="smilies" src="images/smilies/icon_exclaim.gif" alt=":!:" title="Exclamation" /> Thanks jeb, aGerman, and Carlos (and any one else that may have worked on it)<br /><br />I've reworked SNAKE.BAT to use XCOPY instead of CHOICE. There are lots of benefits:<br /><br />- A pure batch solution is now compatible with XP<br />- No more nasty beep when pressing an invalid key<br />- No more need to check for the version of CHOICE<br />- No more key translation<br /><br />The implementation I used for my controller does not read ! properly due to delayed expansion being enabled. But that does not matter since the game does not need that key.<br /><br />The code works great on my Win 7 machine. I don't detect any delay between key press and character turning.<br /><br />The code also &quot;works&quot; running on a virtual XP machine hosted by my Win 7 machine. But now there is a significant delay from when I press a key to when the game detects the key press. So it is hard to get the turn timing down. The old version that used CHOICE did not suffer from this problem on my virtual XP machine.<br /><br />Can someone out there test on a real XP machine and tell me how this new version performs? If it works well, then I will abandon the CHOICE version altogether.<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>@echo off<br />if &quot;%~1&quot; == &quot;startGame&quot; goto :game<br />if &quot;%~1&quot; == &quot;startController&quot; goto :controller<br /><br />::---------------------------------------------------------------------<br />:: setup some global variables used by both the game and the controller<br /><br />set &quot;keyFile=key.txt&quot;<br />set &quot;cmdFile=cmd.txt&quot;<br /><br /><br />::------------------------------------------<br />:: launch the game and the controller<br /><br />copy nul &quot;%keyFile%&quot; &gt;nul<br />start &quot;&quot; /b &quot;%~f0&quot; startController 9^&gt;^&gt;%keyFile% 2^&gt;nul ^&gt;nul<br />cmd /c &quot;%~f0&quot; startGame 9^&lt;%keyFile% ^&lt;nul<br />echo(<br /><br />::--------------------------------------------------------------------------------<br />:: Upon exit, wait for the controller to close before deleting the temp input file<br /><br />:close<br />2&gt;nul (&gt;&gt;&quot;%keyFile%&quot; call )||goto :close<br />del &quot;%keyFile%&quot;<br />exit /b<br /><br /><br />::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::<br />:game<br />setlocal disableDelayedExpansion<br />title %~nx0<br />cls<br /><br />::----------------------------<br />:: user configurable options<br /><br />set &quot;up=W&quot;<br />set &quot;down=S&quot;<br />set &quot;left=A&quot;<br />set &quot;right=D&quot;<br /><br />set &quot;width=40&quot;&nbsp; &nbsp;max=99<br />set &quot;height=25&quot;&nbsp; max=99<br />:: max playing field: (width-2)*(height-2) &lt;= 1365<br /><br />::----------------------------<br />:: resize the console window<br /><br />set /a cols=width+1, lines=height+10, area=(width-2)*(height-2)<br />if %area% gtr 1365 (<br />&nbsp; echo ERROR: Playfield area too large<br />&nbsp; &gt;&quot;%cmdFile%&quot; (echo quit)<br />&nbsp; exit<br />)<br />if %lines% lss 14 set lines=14<br />if %cols% lss 46 set cols=46<br />mode con: cols=%cols% lines=%lines%<br /><br />::----------------------------<br />:: define variables<br /><br />set &quot;spinner1=-&quot;<br />set &quot;spinner2=\&quot;<br />set &quot;spinner3=|&quot;<br />set &quot;spinner4=/&quot;<br />set &quot;spinner= spinner1 spinner2 spinner3 spinner4 &quot;<br /><br />set &quot;space= &quot;<br />set &quot;bound=#&quot;<br />set &quot;food=+&quot;<br />set &quot;head=@&quot;<br />set &quot;body=O&quot;<br />set &quot;death=X&quot;<br />set &quot;playerSpace=%space%%food%&quot;<br /><br />set &quot;xDiff%up%=+0&quot;<br />set &quot;xDiff%down%=+0&quot;<br />set &quot;xDiff%left%=-1&quot;<br />set &quot;xDiff%right%=+1&quot;<br /><br />set &quot;yDiff%up%=-1&quot;<br />set &quot;yDiff%down%=+1&quot;<br />set &quot;yDiff%left%=+0&quot;<br />set &quot;yDiff%right%=+0&quot;<br /><br />set &quot;%up%Axis=Y&quot;<br />set &quot;%down%Axis=Y&quot;<br />set &quot;%left%Axis=X&quot;<br />set &quot;%right%Axis=X&quot;<br /><br />set &quot;delay1=20&quot;<br />set &quot;delay2=15&quot;<br />set &quot;delay3=10&quot;<br />set &quot;delay4=7&quot;<br />set &quot;delay5=5&quot;<br />set &quot;delay6=3&quot;<br />set &quot;delay0=0&quot;<br /><br />set &quot;desc1=Sluggard&quot;<br />set &quot;desc2=Crawl&quot;<br />set &quot;desc3=Slow&quot;<br />set &quot;desc4=Normal&quot;<br />set &quot;desc5=Fast&quot;<br />set &quot;desc6=Insane&quot;<br />set &quot;desc0=Unplayable&quot;<br /><br />set &quot;spinnerDelay=3&quot;<br /><br />set /a &quot;width-=1, height-=1&quot;<br /><br /><br />::---------------------------<br />:: define macros<br /><br />::define a Line Feed (newline) string (normally only used as !LF!)<br />set LF=^<br /><br /><br />::Above 2 blank lines are required - do not remove<br /><br />::define a newline with line continuation<br />set ^&quot;\n=^^^%LF%%LF%^%LF%%LF%^^&quot;<br /><br />:: setErr<br />:::&nbsp; Sets the ERRORLEVEL to 1<br />set &quot;setErr=(call)&quot;<br /><br />:: clrErr<br />:::&nbsp; Sets the ERRORLEVEL to 0<br />set &quot;clrErr=(call )&quot;<br /><br /><br />:: getKey&nbsp; ValidKeys<br />::: Check for keypress. Only accept keys listed in ValidKeys<br />::: Accept any key if ValidKeys is empty.<br />::: Return result in Key variable. Key is undefined if no valid keypress.<br />set getKey=%\n%<br />for %%# in (1 2) do if %%#==2 (for /f &quot;eol= delims= &quot; %%1 in (&quot;!args!&quot;) do (%\n%<br />&nbsp; set &quot;validKeys=%%1&quot;%\n%<br />&nbsp; set &quot;key=&quot;%\n%<br />&nbsp; ^&lt;^&amp;9 set /p &quot;key=&quot;%\n%<br />&nbsp; if defined validKeys for %%K in (!key!) do if &quot;!validKeys:%%K=!&quot; equ &quot;!validKeys!&quot; set &quot;key=&quot;%\n%<br />)) else set args=<br /><br /><br />:: draw<br />:::&nbsp; draws the board<br />set draw=%\n%<br />cls%\n%<br />for /l %%Y in (0,1,%height%) do echo(!line%%Y!%\n%<br />echo Speed=!Difficulty!%\n%<br />echo Score=!score!<br /><br /><br />:: test&nbsp; X&nbsp; Y&nbsp; ValueListVar<br />:::&nbsp; tests if value at coordinates X,Y is within contents of ValueListVar<br />set test=%\n%<br />for %%# in (1 2) do if %%#==2 (for /f &quot;tokens=1-3&quot; %%1 in (&quot;!args!&quot;) do (%\n%<br />&nbsp; for %%A in (&quot;!line%%2:~%%1,1!&quot;) do if &quot;!%%3:%%~A=!&quot; neq &quot;!%%3!&quot; %clrErr% else %setErr%%\n%<br />)) else set args=<br /><br /><br />:: plot&nbsp; X&nbsp; Y&nbsp; ValueVar<br />:::&nbsp; places contents of ValueVar at coordinates X,Y<br />set plot=%\n%<br />for %%# in (1 2) do if %%#==2 (for /f &quot;tokens=1-3&quot; %%1 in (&quot;!args!&quot;) do (%\n%<br />&nbsp; set &quot;part2=!line%%2:~%%1!&quot;%\n%<br />&nbsp; set &quot;line%%2=!line%%2:~0,%%1!!%%3!!part2:~1!&quot;%\n%<br />)) else set args=<br /><br /><br />::--------------------------------------<br />:: start the game<br />setlocal enableDelayedExpansion<br />call :initialize<br /><br /><br />::--------------------------------------<br />:: main loop (infinite loop)<br />for /l %%. in (1 0 1) do (<br /><br />&nbsp; %=== compute time since last move ===%<br />&nbsp; for /f &quot;tokens=1-4 delims=:.,&quot; %%a in (&quot;!time: =0!&quot;) do set /a &quot;t2=(((1%%a*60)+1%%b)*60+1%%c)*100+1%%d-36610100, tDiff=t2-t1&quot;<br />&nbsp; if !tDiff! lss 0 set /a tDiff+=24*60*60*100<br /><br />&nbsp; if !tDiff! geq !delay! (<br />&nbsp; &nbsp; %=== delay has expired, so time for movement ===%<br /><br />&nbsp; &nbsp; %=== establish direction ===%<br />&nbsp; &nbsp; %getKey% ASDW<br />&nbsp; &nbsp; for %%K in (!key!) do if &quot;!%%KAxis!&quot; neq &quot;!axis!&quot; (<br />&nbsp; &nbsp; &nbsp; set /a &quot;xDiff=xDiff%%K, yDiff=yDiff%%K&quot;<br />&nbsp; &nbsp; &nbsp; set &quot;axis=!%%KAxis!&quot;<br />&nbsp; &nbsp; )<br /><br />&nbsp; &nbsp; %=== erase the tail ===%<br />&nbsp; &nbsp; set &quot;TX=!snakeX:~-2!&quot;<br />&nbsp; &nbsp; set &quot;TY=!snakeY:~-2!&quot;<br />&nbsp; &nbsp; set &quot;snakeX=!snakeX:~0,-2!&quot;<br />&nbsp; &nbsp; set &quot;snakeY=!snakeY:~0,-2!&quot;<br />&nbsp; &nbsp; %plot% !TX! !TY! space<br /><br />&nbsp; &nbsp; %=== compute new head location and attempt to move ===%<br />&nbsp; &nbsp; set /a &quot;X=PX+xDiff, Y=PY+yDiff&quot;<br />&nbsp; &nbsp; set &quot;X= !X!&quot;<br />&nbsp; &nbsp; set &quot;Y= !Y!&quot;<br />&nbsp; &nbsp; set &quot;X=!X:~-2!&quot;<br />&nbsp; &nbsp; set &quot;Y=!Y:~-2!&quot;<br />&nbsp; &nbsp; (%test% !X! !Y! playerSpace) &amp;&amp; (<br /><br />&nbsp; &nbsp; &nbsp; %=== move successful ===%<br /><br />&nbsp; &nbsp; &nbsp; %=== remove the new head location from the empty list ===%<br />&nbsp; &nbsp; &nbsp; for %%X in (&quot;!X!&quot;) do for %%Y in (&quot;!Y!&quot;) do set &quot;empty=!empty:#%%~X %%~Y=!&quot;<br /><br />&nbsp; &nbsp; &nbsp; (%test% !X! !Y! food) &amp;&amp; (<br />&nbsp; &nbsp; &nbsp; &nbsp; %=== moving to food - eat it ===%<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; %=== restore the tail ===%<br />&nbsp; &nbsp; &nbsp; &nbsp; %plot% !TX! !TY! body<br />&nbsp; &nbsp; &nbsp; &nbsp; set &quot;snakeX=!snakeX!!TX!&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; set &quot;snakeY=!snakeY!!TY!&quot;<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; %=== increment score and locate and draw new food ===%<br />&nbsp; &nbsp; &nbsp; &nbsp; set /a &quot;score+=1, F=(!random!%%(emptyCnt-=1))*6+1&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; for %%F in (!F!) do (%plot% !empty:~%%F,5! food)<br /><br />&nbsp; &nbsp; &nbsp; ) || (<br />&nbsp; &nbsp; &nbsp; &nbsp; %=== moving to empty space ===%<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; %=== add the former tail position to the empty list ===%<br />&nbsp; &nbsp; &nbsp; &nbsp; set &quot;empty=!empty!#!TX! !TY!&quot;<br />&nbsp; &nbsp; &nbsp; )<br /><br />&nbsp; &nbsp; &nbsp; %=== draw the new head ===%<br />&nbsp; &nbsp; &nbsp; if defined snakeX (%plot% !PX! !PY! body)<br />&nbsp; &nbsp; &nbsp; %plot% !X! !Y! head<br /><br />&nbsp; &nbsp; &nbsp; %=== Add the new head position to the snake strings ===%<br />&nbsp; &nbsp; &nbsp; set &quot;snakeX=!X!!snakeX!&quot;<br />&nbsp; &nbsp; &nbsp; set &quot;snakeY=!Y!!snakeY!&quot;<br />&nbsp; &nbsp; &nbsp; set &quot;PX=!X!&quot;<br />&nbsp; &nbsp; &nbsp; set &quot;PY=!Y!&quot;<br /><br />&nbsp; &nbsp; &nbsp; %draw%<br /><br />&nbsp; &nbsp; ) || (<br /><br />&nbsp; &nbsp; &nbsp; %=== failed move - game over ===%<br />&nbsp; &nbsp; &nbsp; %plot% !TX! !TY! body<br />&nbsp; &nbsp; &nbsp; call :spinner !PX! !PY! death<br />&nbsp; &nbsp; &nbsp; %draw%<br />&nbsp; &nbsp; &nbsp; echo(<br />&nbsp; &nbsp; &nbsp; call :ask &quot;Would you like to play again? (Y/N)&quot; YN<br />&nbsp; &nbsp; &nbsp; if /i &quot;!key!&quot; equ &quot;N&quot; (<br />&nbsp; &nbsp; &nbsp; &nbsp; &gt;&quot;%cmdFile%&quot; (echo quit)<br />&nbsp; &nbsp; &nbsp; &nbsp; exit<br />&nbsp; &nbsp; &nbsp; ) else (<br />&nbsp; &nbsp; &nbsp; &nbsp; call :initialize<br />&nbsp; &nbsp; &nbsp; )<br />&nbsp; &nbsp; )<br /><br />&nbsp; &nbsp; set /a t1=t2<br />&nbsp; )<br />)<br /><br />:ask&nbsp; Prompt&nbsp; ValidKeys<br />:: Prompt for a keypress. ValidKeys is a list of acceptable keys<br />:: Wait until a valid key is pressed and return result in Key variable<br />&gt;&quot;%cmdFile%&quot; (echo prompt)<br />&lt;nul set /p &quot;=%~1 &quot;<br />:purge<br />(%getKey% {purged})<br />if !key! neq {purged} goto :purge<br />:getResponse<br />(%getKey% %2)<br />if not defined key (<br />&nbsp; &gt;&quot;%cmdFile%&quot; (echo one)<br />&nbsp; goto :getResponse<br />)<br />exit /b<br /><br /><br />:spinner&nbsp; X&nbsp; Y&nbsp; ValueVar<br />set /a d1=-1000000<br />for /l %%N in (1 1 5) do for %%C in (%spinner%) do (<br />&nbsp; call :spinnerDelay<br />&nbsp; %plot% %1 %2 %%C<br />&nbsp; %draw%<br />)<br />call :spinnerDelay<br />(%plot% %1 %2 %3)<br />exit /b<br /><br />:spinnerDelay<br />for /f &quot;tokens=1-4 delims=:.,&quot; %%a in (&quot;!time: =0!&quot;) do set /a &quot;d2=(((1%%a*60)+1%%b)*60+1%%c)*100+1%%d-36610100, dDiff=d2-d1&quot;<br />if %dDiff% lss 0 set /a dDiff+=24*60*60*100<br />if %dDiff% lss %spinnerDelay% goto :spinnerDelay<br />set /a d1=d2<br />exit /b<br /><br /><br />::-------------------------------------<br />:initialize<br />cls<br /><br />echo Speed Options:<br />echo&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;delay<br />echo&nbsp; &nbsp; #&nbsp; &nbsp;Description&nbsp; (seconds)<br />echo&nbsp; &nbsp;---&nbsp; -----------&nbsp; ---------<br />echo&nbsp; &nbsp; 1&nbsp; &nbsp;Sluggard&nbsp; &nbsp; &nbsp; &nbsp; 0.20<br />echo&nbsp; &nbsp; 2&nbsp; &nbsp;Crawl&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.15<br />echo&nbsp; &nbsp; 3&nbsp; &nbsp;Slow&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.10<br />echo&nbsp; &nbsp; 4&nbsp; &nbsp;Normal&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.07<br />echo&nbsp; &nbsp; 5&nbsp; &nbsp;Fast&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.05<br />echo&nbsp; &nbsp; 6&nbsp; &nbsp;Insane&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.03<br />echo&nbsp; &nbsp; 0&nbsp; &nbsp;Unplayable&nbsp; &nbsp; &nbsp; none<br />echo(<br />call :ask &quot;Pick a speed (1-6, 0):&quot; 1234560<br />set &quot;difficulty=!desc%key%!&quot;<br />set &quot;delay=!delay%key%!&quot;<br />echo %key% - %difficulty%<br />echo(<br />&lt;nul set /p &quot;=Initializing.&quot;<br />set &quot;axis=X&quot;<br />set &quot;xDiff=+1&quot;<br />set &quot;yDiff=+0&quot;<br />set &quot;empty=&quot;<br />set /a &quot;PX=1, PY=height/2, FX=width/2+1, FY=PY, score=0, emptyCnt=0, t1=-1000000&quot;<br />set &quot;snakeX= %PX%&quot;<br />set &quot;snakeY= %PY%&quot;<br />set &quot;snakeX=%snakeX:~-2%&quot;<br />set &quot;snakeY=%snakeY:~-2%&quot;<br />for /l %%Y in (0 1 %height%) do (<br />&nbsp; &lt;nul set /p &quot;=.&quot;<br />&nbsp; set &quot;line%%Y=&quot;<br />&nbsp; for /l %%X in (0,1,%width%) do (<br />&nbsp; &nbsp; set &quot;cell=&quot;<br />&nbsp; &nbsp; if %%Y equ 0&nbsp; &nbsp; &nbsp; &nbsp; set &quot;cell=%bound%&quot;<br />&nbsp; &nbsp; if %%Y equ %height% set &quot;cell=%bound%&quot;<br />&nbsp; &nbsp; if %%X equ 0&nbsp; &nbsp; &nbsp; &nbsp; set &quot;cell=%bound%&quot;<br />&nbsp; &nbsp; if %%X equ %width%&nbsp; set &quot;cell=%bound%&quot;<br />&nbsp; &nbsp; if %%X equ %PX% if %%Y equ %PY% set &quot;cell=%head%&quot;<br />&nbsp; &nbsp; if not defined cell (<br />&nbsp; &nbsp; &nbsp; set &quot;cell=%space%&quot;<br />&nbsp; &nbsp; &nbsp; set &quot;eX= %%X&quot;<br />&nbsp; &nbsp; &nbsp; set &quot;eY= %%Y&quot;<br />&nbsp; &nbsp; &nbsp; set &quot;empty=!empty!#!eX:~-2! !eY:~-2!&quot;<br />&nbsp; &nbsp; &nbsp; set /a emptyCnt+=1<br />&nbsp; &nbsp; )<br />&nbsp; &nbsp; if %%X equ %FX% if %%Y equ %FY% set &quot;cell=%food%&quot;<br />&nbsp; &nbsp; set &quot;line%%Y=!line%%Y!!cell!&quot;<br />&nbsp; )<br />)<br />(%draw%)<br />echo(<br />echo Movement keys: %up%=up %down%=down %left%=left %right%=right<br />echo Avoid running into yourself (%body%%body%%head%) or wall (%bound%)<br />echo Eat food (%food%) to grow.<br />echo(<br />call :ask &quot;Press a key to start...&quot;<br />&gt;&quot;%cmdFile%&quot; (echo go)<br />exit /b<br /><br /><br />::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::<br />:controller<br />:: As written, this routine incorrectly reports ! as )<br />:: But that doesn't matter since we don't need the ! key.<br /><br />setlocal enableDelayedExpansion<br />set &quot;cmd=hold&quot;<br />set &quot;key=&quot;<br />for /l %%. in (1 0 1) do (<br />&nbsp; if &quot;!cmd!&quot; neq &quot;hold&quot; (<br />&nbsp; &nbsp; for /f &quot;delims=&quot; %%A in ('xcopy /w &quot;%~f0&quot; &quot;%~f0&quot; 2^&gt;nul') do (<br />&nbsp; &nbsp; &nbsp; if not defined key set &quot;key=%%A&quot;<br />&nbsp; &nbsp; )<br />&nbsp; &nbsp; set &quot;key=!key:~-1!&quot;<br />&nbsp; )<br />&nbsp; if exist &quot;%cmdFile%&quot; (<br />&nbsp; &nbsp; &lt;&quot;%cmdFile%&quot; set /p &quot;cmd=&quot;<br />&nbsp; &nbsp; del &quot;%cmdFile%&quot;<br />&nbsp; )<br />&nbsp; if &quot;!cmd!&quot; equ &quot;quit&quot; exit<br />&nbsp; if defined key (<br />&nbsp; &nbsp; if &quot;!cmd!&quot; equ &quot;prompt&quot; &gt;&amp;9 (echo {purged})<br />&nbsp; &nbsp; &gt;&amp;9 (echo !key!)<br />&nbsp; &nbsp; if &quot;!cmd!&quot; neq &quot;go&quot; set &quot;cmd=hold&quot;<br />&nbsp; &nbsp; set &quot;key=&quot;<br />&nbsp; )<br />)<br /></code></pre></div><br /><br />Dave Benham</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: SNAKE.BAT - An arcade style game using pure batch</h3>
				<div class="date">Posted: <strong>17 Jul 2013 20:46</strong></div>
				<div class="author">by <strong>foxidrive</strong></div>
				<div class="content">Snake using xcopy works fine on crawl speed on my XP SP3 laptop 1.7GHz core two duo, with an SSD.  No delay in turns.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: SNAKE.BAT - An arcade style game using pure batch</h3>
				<div class="date">Posted: <strong>17 Jul 2013 20:51</strong></div>
				<div class="author">by <strong>dbenham</strong></div>
				<div class="content"><blockquote><div><cite>foxidrive wrote:</cite>Snake using xcopy works fine on crawl speed on my XP SP3 laptop 1.7GHz core two duo, with an SSD.  No delay in turns.</div></blockquote><br />Very cool <img class="smilies" src="images/smilies/icon_cool.gif" alt="8)" title="Cool" /> Have you tried a faster speed <img class="smilies" src="images/smilies/icon_question.gif" alt=":?:" title="Question" /></div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: SNAKE.BAT - An arcade style game using pure batch</h3>
				<div class="date">Posted: <strong>18 Jul 2013 00:57</strong></div>
				<div class="author">by <strong>foxidrive</strong></div>
				<div class="content">I have now.  speeds 4,5,6 also respond immediately as far as I can tell.  speed 0 was too quick for me.  <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br /><br />Maybe the SSD helps with loading xcopy but it should be cached anyway you'd think.<br /><br />One item that could possibly be enhanced - have a choice between the arrow keys or w,a,s,d or maybe i,j,k,l and select with w, i or up arrow.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: SNAKE.BAT - An arcade style game using pure batch</h3>
				<div class="date">Posted: <strong>18 Jul 2013 05:36</strong></div>
				<div class="author">by <strong>dbenham</strong></div>
				<div class="content"><blockquote><div><cite>foxidrive wrote:</cite>I have now.  speeds 4,5,6 also respond immediately as far as I can tell.  speed 0 was too quick for me.  <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br /><br />Maybe the SSD helps with loading xcopy but it should be cached anyway you'd think.</div></blockquote><br />That is great news it works for you, but I would love to hear from an XP user that does not have a solid state drive. Anyone out there <img class="smilies" src="images/smilies/icon_question.gif" alt=":?:" title="Question" /> <br /><br /><blockquote><div><cite>foxidrive wrote:</cite>One item that could possibly be enhanced - have a choice between the arrow keys or w,a,s,d or maybe i,j,k,l and select with w, i or up arrow.</div></blockquote><br />The key mappings are easily changed in the source code. Simply change the definitions that appear under the comment: <strong class="text-strong">&quot;:: user configurable options&quot;</strong>. XCOPY can detect keys (or key combinations) that map to single byte code characters. This includes things like &lt;Enter&gt;, &lt;Tab&gt;, &lt;Backspace&gt; and control characters accessed via combinations like &lt;Ctrl&gt;&lt;A&gt; for 0x01. But arrow keys, function keys, etc. cannot be detected.<br /><br />XCOPY is a major improvement over CHOICE in that CHOICE can only accept alpha-numeric keys.<br /><br />Note - when mapping keys, do not use the * ~ or = keys<br /><br /><br />Dave Benham</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: SNAKE.BAT - An arcade style game using pure batch</h3>
				<div class="date">Posted: <strong>18 Jul 2013 06:06</strong></div>
				<div class="author">by <strong>jeb</strong></div>
				<div class="content">Hi Dave,<br /><br />nice implenatation, especially I like the real life example of macros <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /> <br /><br /><blockquote><div><cite>dbenham wrote:</cite>That is great news it works for you, but I would love to hear from an XP user that does not have a solid state drive. Anyone out there <img class="smilies" src="images/smilies/icon_question.gif" alt=":?:" title="Question" /> </div></blockquote><br /><br />In my host Win7 system it works good.<br />In my vmWare XP-System it works quite good, it's flickering a bit too much.<br /><br />The flickering is mostly just after I press any key.<br /><br />jeb</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: SNAKE.BAT - An arcade style game using pure batch</h3>
				<div class="date">Posted: <strong>18 Jul 2013 07:51</strong></div>
				<div class="author">by <strong>dbenham</strong></div>
				<div class="content">Thanks jeb <img class="smilies" src="images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br /><br />Given that it works OK for you in VM-Ware, I think I will retire the CHOICE version. If it works on VM-Ware, I've got to believe it works on native XP.<br /><br />The flicker has very little to do with the user input, since input and display are two entirely different processes. But I suppose there is limited bandwidth for all processes in VM-Ware. The CHOICE version flickers badly on my VM-Ware XP as well. But the XCOPY version has turning delay for me on VM-Ware. I'm glad turning works well for you.<br /><br /><br />Dave Benham</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: SNAKE.BAT - An arcade style game using pure batch</h3>
				<div class="date">Posted: <strong>18 Jul 2013 08:12</strong></div>
				<div class="author">by <strong>brinda</strong></div>
				<div class="content">Dave,<br /><br />thanks for making this. <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /> <br />slight flicker using winxp sp3. AMD athlon 1.53Ghz with Western Digital HDD 20GB. 6 and 0 are unplayable - too fast.<br /><br />Did not notice any delay on turning. Just as responsive on keypress.<br /><br />thanks.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: SNAKE.BAT - An arcade style game using pure batch</h3>
				<div class="date">Posted: <strong>18 Jul 2013 09:11</strong></div>
				<div class="author">by <strong>dbenham</strong></div>
				<div class="content">That is great news Brinda. Thanks.<br /><br />Speeds 6 and 0 are intended to be unplayable. Thery are only there to demonstrate the potential speed of batch animation.<br /><br /><br />Dave Benham</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: SNAKE.BAT - An arcade style game using pure batch</h3>
				<div class="date">Posted: <strong>20 Jul 2013 17:20</strong></div>
				<div class="author">by <strong>dbenham</strong></div>
				<div class="content">I've posted a new and improved version at the top of the original post in this thread.<br /><br />The prior version still had inter-process communication issues that could lead to the game hanging - refusing to accept input. It was mostly due to sequencing issues.<br /><br />I've completely reworked the inter-process communication such that the game should be much more stable now. I'm hoping this will solve the problems Squashman was seeing. I know it solved problems that I was seeing.<br /><br />Foxidrive had requested the ability to redefine the movement keys. I told him that he just needed to change the values in some variable assignments. Well I discovered that was I lie. There was still a critical place where I had the movement keys hard coded. This version fixes the parameterization of the key definitions.<br /><br />The location of the temporary files is now controlled by the TEMP (or TMP) environment variable, which <em class="text-italics">should</em> always point to a high speed device. Now it should not matter where SNAKE.BAT is run from.<br /><br />Finally, I establish a unique session ID and lock for each instance of a running SNAKE game. The session ID is incorporated into the names of the temp files, so multiple instances should be able to share the same temp folder without interference. The session ID is derived from the current time to 1/100th second. I doubt there will ever be a collision. But if there is a collision, the game lock for one of the instances will fail and it will automatically loop back and try a new session ID.<br /><br /><br />Dave Benham</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: SNAKE.BAT - An arcade style game using pure batch</h3>
				<div class="date">Posted: <strong>20 Jul 2013 20:11</strong></div>
				<div class="author">by <strong>foxidrive</strong></div>
				<div class="content">tis working here in Win8.  No delays.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: SNAKE.BAT - An arcade style game using pure batch</h3>
				<div class="date">Posted: <strong>06 Aug 2013 20:49</strong></div>
				<div class="author">by <strong>dbenham</strong></div>
				<div class="content">Updated the code in the first post. No functional changes. Mostly just improved comments/documentation<br /><br /><br />Dave Benham</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: SNAKE.BAT - An arcade style game using pure batch</h3>
				<div class="date">Posted: <strong>02 Sep 2013 07:10</strong></div>
				<div class="author">by <strong>einstein1969</strong></div>
				<div class="content">hi dave, <br /><br />great work!<br /><br />On my machine the cpu is always at 100%!!!<br /><br />you could add an option to speed it consumes less cpu?<br /><br />For those PCs that have the serial you could insert a delay in this way:<br /><br />echo(&gt;Com3:<br /><br />On my pc has a delay of about 230ms this command, whith 10-15% cpu usage.<br /><br />I tried it on snake on my PC and it actually reduces cpu usage up to about 20%.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: SNAKE.BAT - An arcade style game using pure batch</h3>
				<div class="date">Posted: <strong>05 Oct 2013 16:26</strong></div>
				<div class="author">by <strong>Delmar Grande</strong></div>
				<div class="content">Very good!<br />I posted your code here <!-- m --><a class="postlink" href="http://dbatchscript.forumeiros.com/">http://dbatchscript.forumeiros.com/</a><!-- m --><br /> <img class="smilies" src="images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /></div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="UTC-6">UTC-06:00</span><br />Page <strong>3</strong> of <strong>8</strong></div>
		<div class="copyright">Powered by phpBB&reg; Forum Software &copy; phpBB Limited<br />https://www.phpbb.com/</div>
	</div>
</div>

</body>

<!-- Mirrored from www.dostips.com/forum/viewtopic.php?f=3&t=4741&start=30&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 08:33:48 GMT -->
</html>
