<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html lang="en-US">

<!-- Mirrored from www.dostips.com/?t=Filter.FtpBatchScript by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 03:48:32 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<META http-equiv=content-type content="text/html; charset=iso-8859-1">
<META content=TRUE name=MSSmartTagsPreventParsing>
<META http-equiv=expires content=-1>
<META http-equiv=pragma content=no-cache>
<META content=all name=robots>
<META name=keywords content='dos,functions,vista,xp,command line,batch,examples,substring,variables,copies,date'>
<link rel=Stylesheet type="text/css" media=all href="_style0b84.css?v=0001">
<link rel="shortcut icon" href="favicon.ico" >
<link rel="icon" href="animated_favicon1.gif" type="image/gif" >
<title>DOS Batch - FTP Scripts</title>
<!--index.php-->
</head>
<body>

<div class="nav">
        <br>
    <div class="navi">
        <a href='index.html'><img src='TitleDostips.jpg' height='80' alt='DosTips.com'></a>
        <br><span style="font-size: 9px; font-weight: bold;">for Windows10,Windows8,Windows7,VISTA,</span>
        <br><span style="font-size: 9px; font-weight: bold;">XP,NT,Server 2000,Server 2003,Server 2008</span>
        <br>
        <br>
            <!-- SiteSearch Google -->
<div class="search">
<script>
  (function() {
    var cx = 'partner-pub-4331089886589220:2001057635';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = '../cse.google.com/cse07b6.html?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:searchbox-only></gcse:searchbox-only>
</div>
<!-- SiteSearch Google -->
        <br>
            <ul>
        <li class='nsel'><a href='index.html'>Home</a>&nbsp;
            <ul>
                <li class='nsel'>&nbsp;</li>
            </ul>
        </li>
        <li class='nsel'><a>Source Script</a>&nbsp;
            <ul>
                <li class='nsel'><a href='DtCodeBatchFiles.html'>Batch Files</a>&nbsp;</li>
                <li class='nsel'><a href='DtCodeFunctions.html'>Functions</a>&nbsp;</li>
                <li class='nsel'><a href='DtCodeCmdLib.html'>Function Library</a>&nbsp;</li>
                <li class='nsel'><a href='DtCodeSnippets.html'>Script Snippets</a>&nbsp;</li>
                <li class='nsel'><a href='DtCodeInterfacing.html'>Interfacing</a>&nbsp;</li>
                <li class='nsel'>&nbsp;</li>
            </ul>
        </li>
        <li class='nsel'><a>Tips and Tricks</a>&nbsp;
            <ul>
                <li class='nsel'><a href='DtTipsXCopy.html'>Copy Tips</a>&nbsp;</li>
                <li class='nsel'><a href='DtTipsMenu.html'>Menu in Batch</a>&nbsp;</li>
                <li class='nsel'><a href='DtTipsStringManipulation.html'>String Manipulation</a>&nbsp;</li>
                <li class='nsel'><a href='DtTipsStringOperations.html'>String Operations</a>&nbsp;</li>
                <li class='nsel'><a href='DtTipsDateTime.html'>Date and Time</a>&nbsp;</li>
                <li class='nsel'><a href='DtTipsArithmetic.html'>Arithmetic</a>&nbsp;</li>
                <li class='nsel'><a href='DtTipsFtpBatchScript.html'>FTP Batch Script</a>&nbsp;</li>
                <li class='nsel'><a href='DosCommandIndex.html'>Command Index</a>&nbsp;</li>
                <li class='nsel'>&nbsp;</li>
            </ul>
        </li>
        <li class='nsel'><a>Tutorials</a>&nbsp;
            <ul>
                <li class='nsel'><a href='DtTutoFirstBatch.html'>My First Batch</a>&nbsp;</li>
                <li class='nsel'><a href='DtTutoFramework.html'>Solid Framework</a>&nbsp;</li>
                <li class='nsel'><a href='DtTutoFunctions.html'>Functions</a>&nbsp;</li>
                <li class='nsel'><a href='DtTutoPersistency.html'>Persistency</a>&nbsp;</li>
                <li class='nsel'>&nbsp;</li>
            </ul>
        </li>
        <li class='nsel'><a href='forum/viewforum4d6b.html?f=3'>Forum</a>&nbsp;
            <ul>
                <li class='nsel'>&nbsp;</li>
            </ul>
        </li>
        <li class='nsel'><a href='DtGeneGeneral.html'>General</a>&nbsp;
            <ul>
                <li class='nsel'><a href='DtGeneTermsOfUse.html'>Terms of Use</a>&nbsp;</li>
                <li class='nsel'><a href='DtGeneEnabler.html'>Enablers</a>&nbsp;</li>
                <li class='nsel'><a href='DtGeneAboutUs.html'>About Us</a>&nbsp;</li>
                <li class='nsel'><a href='forum/memberlist8733.html?mode=contactadmin'>Contact Us</a>&nbsp;</li>
                <li class='nsel'>&nbsp;</li>
            </ul>
        </li>
        <li class='nsel'><a>Others</a>&nbsp;
            <ul>
                <li class='nsel'><a href='https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&amp;hosted_button_id=9018663'><marquee width="120" scrollamount="2">Want donate a cup of Cafe? . click . </marquee></a>&nbsp;</li>
                <li class='nsel'>&nbsp;</li>
            </ul>
        </li>
    </ul>
    </div>
</div>
<H1>DOS Batch - FTP Scripts</H1>
<span class='shortText'>File Transfer with FTP, One-File Solutions.</span><br><br>
  <table class='posts'>
  </table>
<br><table class='menu' cellpadding='0' cellspacing='0'>
<tr><td colspan='2'>
</td></tr>
<tr><td class='title'><a href='#Batch.FtpBatch'>FTP - Simple Single Batch</a></td>
<td class='text'>FTP script and batch in a single file.</td>
</tr>
<tr><td class='title'><a href='#Batch.FtpBatchAutoLogin'>FTP - Automatic Login</a></td>
<td class='text'>Automatically login to your FTP session with a single click.</td>
</tr>
<tr><td class='title'><a href='#Batch.FtpBatchDownloadOnlyNewFiles'>FTP - Download Only New Files</a></td>
<td class='text'>Ftp script to download only files that don`t exist in local folder, i.e. to avoid overwrite</td>
</tr>
<tr><td class='title'><a href='#Batch.FtpBatchLoginSharing'>FTP Scripts Sharing Login Info</a></td>
<td class='text'>Manage the FTP login separately from your FTP scripts.</td>
</tr>
<tr><td class='title'><a href='#Batch.FtpBatchUploadOnlyNewFiles'>FTP - Upload Only New Files</a></td>
<td class='text'>Ftp script to upload only files that don`t exist in remote folder, i.e. incremental upload.</td>
</tr>
<tr><td class='title'><a href='#Batch.FtpBatchUsingVariables'>FTP - Resolving Environment Variables</a></td>
<td class='text'>Creating FTP script on the fly at runtime and using variables within the FTP script.</td>
</tr>
<tr><td class='title'><a href='#Batch.FtpPure'>Classic FTP</a></td>
<td class='text'>Executing a FTP script.</td>
</tr>
</table>    <hr>
    <a name=''></a>
    <a name='Batch.FtpBatch'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-01-01</font></font></div>
    <H2>FTP - Simple Single Batch - FTP script and batch in a single file</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'><p>Embed FTP script into a batch script.  Add this line at the beginning of the FTP script:</p>
<b>@ftp -i -s:"%~f0"&GOTO:EOF</b>
<p>The "FTP -s:ftpscript.txt" option executes a FTP script wheres "%~f0" resolved to the name of the running batch file.
"GOTO:EOF" ends the batch script and makes sure the FTP script doesn`t run as part of the batch.
<br>Good: You end up with only one file that contains the batch script and the FTP script combined.
<br>Minor flaw: The batch command in the first line causes an "Invalid command." error when executed in FTP context, however the FTP execution will continue.</p>
Features:
<ul>
    <li>Single file to distribute combining batch and FTP script</li>
</ul></td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'>@ftp&nbsp;-i&nbsp;-s:&quot;<span class=c_pvar>%~f0</span>&quot;&amp;GOTO:EOF</span><br>
<span style='color=#000000'>open&nbsp;example.com</span><br>
<span style='color=#000000'>username</span><br>
<span style='color=#000000'>password</span><br>
<span style='color=#000000'>!:---&nbsp;FTP&nbsp;commands&nbsp;below&nbsp;here&nbsp;---</span><br>
<span style='color=#000000'>lcd&nbsp;c:\MyLocalDirectory</span><br>
<span style='color=#000000'>cd&nbsp;&nbsp;public_html/MyRemoteDirectory</span><br>
<span style='color=#000000'>binary</span><br>
<span style='color=#000000'>mput&nbsp;&quot;*.*&quot;</span><br>
<span style='color=#000000'>disconnect</span><br>
<span style='color=#000000'>bye</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script Output:</td>
      <td class='text'  VALIGN='top'><table class="dosw" border="0" cellspacing="2" cellpadding="3">    <tr><td class="title">&nbsp;<img src="SysIcon.jpg" alt="DOS">&nbsp;Script Output    </td></tr>    <tr><td class="text"><pre>ftp&gt; @ftp -i -s:&quot;%~f0&quot;&amp;GOTO:EOF
Invalid command.
ftp&gt; open example.com
User (Username:(none)):

ftp&gt; !:--- FTP commands below here ---
ftp&gt; lcd c:\MyLocalDirectory
Local directory now c:\MyLocalDirectory.
ftp&gt; cd  public_html/MyRemoteDirectory
ftp&gt; binary
ftp&gt; !: mput &quot;*.*&quot;
ftp&gt; disconnect
ftp&gt; bye
</pre></td></tr></table></td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Batch.FtpBatchAutoLogin'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2009-12-06</font></font></div>
    <H2>FTP - Automatic Login - Automatically login to your FTP session with a single click</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'><p>If you frequently find yourself calling <a href="DosCommandIndex-2.html#FTP">FTP</a> from the command line, each time having to login and  
change directory and change FTP modes, until you finally get where you want be in order to do some real 
work then you may wish to get there with a singe click.
<p>This little batch can connect to your FTP server and logs you in before it gives you the prompt.  You can 
easily add more FTP commands to it, like changing directories or switching to binary mode or whatever you 
like to be done before taking over control on the FTP prompt.
<p>The FTP connection information is embedded within the batch itself.  The batch connects to an 
FTP server by executing itself in FTP context using the <a href="DosCommandIndex-2.html#FTP">FTP</a> -s option.  Once executing in FTP context 
it executes all FTP commands listed in the file.  By omitting the final <a href="DosCommandIndex-2.html#FTP">FTP</a> "bye" command it will stop
at the FTP prompt and wait for user input.
<p>Optionally a FTP script can be provided as input stream, that way multiple FTP scripts can share the same 
login information.  Example:
<p>FtpLogin.bat &lt;script1.ftp</td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'><span style='float:right;'>Download: <a href='FtpLogin.bat'>FtpLogin.bat</a>&nbsp;&nbsp;</span>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'>@ftp&nbsp;-i&nbsp;-s:&quot;<span class=c_pvar>%~f0</span>&quot;&amp;GOTO:EOF</span><br>
<span style='color=#000000'>open&nbsp;example.com</span><br>
<span style='color=#000000'>username</span><br>
<span style='color=#000000'>password</span><br>
<span style='color=#000000'>pwd</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script Output:</td>
      <td class='text'  VALIGN='top'><table class="dosw" border="0" cellspacing="2" cellpadding="3">    <tr><td class="title">&nbsp;<img src="SysIcon.jpg" alt="DOS">&nbsp;Script Output    </td></tr>    <tr><td class="text"><pre>ftp&gt; @ftp -i -s:&quot;%~f0&quot;&amp;GOTO:EOF
Invalid command.
ftp&gt; open example.com
Connected to example.com.
220-
220 FTP Server ready
User (example.com:(none)):
331 Password required

230 User logged in
ftp&gt; pwd
257 &quot;/&quot; is the current directory
ftp&gt;
</pre></td></tr></table></td>
    </tr>
  </table>
    <hr>
    <a name='Batch.FtpBatchGetNewFilesOnly'></a>
    <a name='Batch.FtpBatchDownloadOnlyNewFiles'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2010-02-05</font></font></div>
    <H2>FTP - Download Only New Files - Ftp script to download only files that don`t exist in local folder, i.e. to avoid overwrite</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>This batch connects twice to the FTP server.  First time it retrieves a list of files
on the FTP server.  This list is being trimmed to contain only files that don`t 
already exist locally.  The files in the trimmed list are then downloaded during a second 
connection.
<p>Note: Since all files are passed into the FTP`s MGET command there might be a limit to the number 
of files that can be processed at once.</td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'><span style='float:right;'>Download: <a href='BatchFtpDownloadOnlyNewFiles.bat'>BatchFtpDownloadOnlyNewFiles.bat</a>&nbsp;&nbsp;</span>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br><a name='13'>13.</a><br><a name='14'>14.</a><br><a name='15'>15.</a><br><a name='16'>16.</a><br><a name='17'>17.</a><br><a name='18'>18.</a><br><a name='19'>19.</a><br><a name='20'>20.</a><br><a name='21'>21.</a><br><a name='22'>22.</a><br><a name='23'>23.</a><br><a name='24'>24.</a><br><a name='25'>25.</a><br><a name='26'>26.</a><br><a name='27'>27.</a><br><a name='28'>28.</a><br><a name='29'>29.</a><br><a name='30'>30.</a><br><a name='31'>31.</a><br><a name='32'>32.</a><br><a name='33'>33.</a><br><a name='34'>34.</a><br><a name='35'>35.</a><br><a name='36'>36.</a><br><a name='37'>37.</a><br><a name='38'>38.</a><br><a name='39'>39.</a><br><a name='40'>40.</a><br><a name='41'>41.</a><br><a name='42'>42.</a><br><a name='43'>43.</a><br><a name='44'>44.</a><br><a name='45'>45.</a><br><a name='46'>46.</a><br><a name='47'>47.</a><br><a name='48'>48.</a><br><a name='49'>49.</a><br><a name='50'>50.</a><br><a name='51'>51.</a><br><a name='52'>52.</a><br><a name='53'>53.</a><br><a name='54'>54.</a><br><a name='55'>55.</a><br><a name='56'>56.</a><br><a name='57'>57.</a><br><a name='58'>58.</a><br><a name='59'>59.</a><br><a name='60'>60.</a><br><a name='61'>61.</a><br><a name='62'>62.</a><br><a name='63'>63.</a><br><a name='64'>64.</a><br><a name='65'>65.</a><br><a name='66'>66.</a><br><a name='67'>67.</a><br><a name='68'>68.</a><br><a name='69'>69.</a><br><a name='70'>70.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'>@Echo&nbsp;Off</span><br>
<span style='color=#000000'></span><br>
<span style='color=#000000'><span class=c_cmmt>REM&nbsp;--&nbsp;Define&nbsp;File&nbsp;Filter,&nbsp;i.e.&nbsp;files&nbsp;with&nbsp;extension&nbsp;.txt</span></span><br>
<span style='color=#000000'>Set&nbsp;FindStrArgs=/E&nbsp;/C:&quot;.txt&quot;</span><br>
<span style='color=#000000'></span><br>
<span style='color=#000000'><span class=c_cmmt>REM&nbsp;--&nbsp;Extract&nbsp;Ftp&nbsp;Script&nbsp;to&nbsp;create&nbsp;List&nbsp;of&nbsp;Files</span></span><br>
<span style='color=#000000'>Set&nbsp;&quot;FtpCommand=ls&quot;</span><br>
<span style='color=#000000'>Call:extractFileSection&nbsp;&quot;[Ftp&nbsp;Script&nbsp;1]&quot;&nbsp;&quot;-&quot;&gt;&quot;%temp%\<span class=c_pvar>%~n0</span>.ftp&quot;</span><br>
<span style='color=#000000'><span class=c_cmmt>Rem&nbsp;Notepad&nbsp;&quot;%temp%\<span class=c_pvar>%~n0</span>.ftp&quot;</span></span><br>
<span style='color=#000000'></span><br>
<span style='color=#000000'><span class=c_cmmt>REM&nbsp;--&nbsp;Execute&nbsp;Ftp&nbsp;Script,&nbsp;collect&nbsp;File&nbsp;Names</span></span><br>
<span style='color=#000000'>Set&nbsp;&quot;FileList=&quot;</span><br>
<span style='color=#000000'>For&nbsp;/F&nbsp;&quot;Delims=&quot;&nbsp;<span class=c_pvar>%%A</span>&nbsp;In&nbsp;('&quot;Ftp&nbsp;-v&nbsp;-i&nbsp;-s:&quot;%temp%\<span class=c_pvar>%~n0</span>.ftp&quot;|Findstr&nbsp;%FindStrArgs%&quot;')&nbsp;Do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;Call&nbsp;Set&nbsp;&quot;FileList=<span class=c_pvar>%%F</span>ileList%%&nbsp;&quot;<span class=c_pvar>%%A</span>&quot;&quot;</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'></span><br>
<span style='color=#000000'><span class=c_cmmt>REM&nbsp;--&nbsp;Extract&nbsp;Ftp&nbsp;Script&nbsp;to&nbsp;download&nbsp;files&nbsp;that&nbsp;don't&nbsp;exist&nbsp;in&nbsp;local&nbsp;folder</span></span><br>
<span style='color=#000000'>Set&nbsp;&quot;FtpCommand=mget&quot;</span><br>
<span style='color=#000000'>For&nbsp;<span class=c_pvar>%%A</span>&nbsp;In&nbsp;(%FileList%)&nbsp;Do&nbsp;If&nbsp;Not&nbsp;Exist&nbsp;&quot;<span class=c_pvar>%%~A</span>&quot;&nbsp;Call&nbsp;Set&nbsp;&quot;FtpCommand=<span class=c_pvar>%%F</span>tpCommand%%&nbsp;&quot;<span class=c_pvar>%%~A</span>&quot;&quot;</span><br>
<span style='color=#000000'>Call:extractFileSection&nbsp;&quot;[Ftp&nbsp;Script&nbsp;1]&quot;&nbsp;&quot;-&quot;&gt;&quot;%temp%\<span class=c_pvar>%~n0</span>.ftp&quot;</span><br>
<span style='color=#000000'><span class=c_cmmt>Rem&nbsp;Notepad&nbsp;&quot;%temp%\<span class=c_pvar>%~n0</span>.ftp&quot;</span></span><br>
<span style='color=#000000'></span><br>
<span style='color=#000000'>For&nbsp;<span class=c_pvar>%%A</span>&nbsp;In&nbsp;(%FtpCommand%)&nbsp;Do&nbsp;Echo.<span class=c_pvar>%%A</span></span><br>
<span style='color=#000000'></span><br>
<span style='color=#000000'><span class=c_cmmt>REM&nbsp;--&nbsp;Execute&nbsp;Ftp&nbsp;Script,&nbsp;download&nbsp;files</span></span><br>
<span style='color=#000000'>ftp&nbsp;-i&nbsp;-s:&quot;%temp%\<span class=c_pvar>%~n0</span>.ftp&quot;</span><br>
<span style='color=#000000'>Del&nbsp;&quot;%temp%\<span class=c_pvar>%~n0</span>.ftp&quot;</span><br>
<span style='color=#000000'>GOTO:EOF</span><br>
<span style='color=#000000'></span><br>
<span style='color=#000000'></span><br>
<span style='color=#000000'><span class=c_labl><a name='extractFileSection'>:extractFileSection</a></span><span class=c_cmmt>&nbsp;StartMark&nbsp;EndMark&nbsp;FileName&nbsp;--&nbsp;extract&nbsp;a&nbsp;section&nbsp;of&nbsp;file&nbsp;that&nbsp;is&nbsp;defined&nbsp;by&nbsp;a&nbsp;start&nbsp;and&nbsp;end&nbsp;mark</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;[IN]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;StartMark&nbsp;-&nbsp;start&nbsp;mark,&nbsp;use&nbsp;'...:S'&nbsp;mark&nbsp;to&nbsp;allow&nbsp;variable&nbsp;substitution</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;[IN,OPT]&nbsp;EndMark&nbsp;&nbsp;&nbsp;-&nbsp;optional&nbsp;end&nbsp;mark,&nbsp;default&nbsp;is&nbsp;first&nbsp;empty&nbsp;line</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;[IN,OPT]&nbsp;FileName&nbsp;&nbsp;-&nbsp;optional&nbsp;source&nbsp;file,&nbsp;default&nbsp;is&nbsp;THIS&nbsp;file</span></span><br>
<span style='color=#000000'>:$created&nbsp;20080219&nbsp;:$changed&nbsp;20100205&nbsp;:$categories&nbsp;ReadFile</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL&nbsp;Disabledelayedexpansion</span><br>
<span style='color=#000000'>set&nbsp;&quot;bmk=<span class=c_pvar>%~1</span>&quot;</span><br>
<span style='color=#000000'>set&nbsp;&quot;emk=<span class=c_pvar>%~2</span>&quot;</span><br>
<span style='color=#000000'>set&nbsp;&quot;src=<span class=c_pvar>%~3</span>&quot;</span><br>
<span style='color=#000000'>set&nbsp;&quot;bExtr=&quot;</span><br>
<span style='color=#000000'>set&nbsp;&quot;bSubs=&quot;</span><br>
<span style='color=#000000'>if&nbsp;&quot;%src%&quot;==&quot;&quot;&nbsp;set&nbsp;src=<span class=c_pvar>%~f0</span>&amp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=c_cmmt>rem&nbsp;if&nbsp;no&nbsp;source&nbsp;file&nbsp;then&nbsp;assume&nbsp;THIS&nbsp;file</span></span><br>
<span style='color=#000000'>for&nbsp;/f&nbsp;&quot;tokens=1,*&nbsp;delims=]&quot;&nbsp;<span class=c_pvar>%%A</span>&nbsp;in&nbsp;('find&nbsp;/n&nbsp;/v&nbsp;&quot;&quot;&nbsp;&quot;%src%&quot;')&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;/i&nbsp;&quot;<span class=c_pvar>%%B</span>&quot;==&quot;%emk%&quot;&nbsp;set&nbsp;&quot;bExtr=&quot;&amp;set&nbsp;&quot;bSubs=&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;defined&nbsp;bExtr&nbsp;if&nbsp;defined&nbsp;bSubs&nbsp;(call&nbsp;echo.<span class=c_pvar>%%B</span>)&nbsp;ELSE&nbsp;(echo.<span class=c_pvar>%%B</span>)</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;/i&nbsp;&quot;<span class=c_pvar>%%B</span>&quot;==&quot;%bmk%&quot;&nbsp;&nbsp;&nbsp;set&nbsp;&quot;bExtr=Y&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;/i&nbsp;&quot;<span class=c_pvar>%%B</span>&quot;==&quot;%bmk%:S&quot;&nbsp;set&nbsp;&quot;bExtr=Y&quot;&amp;set&nbsp;&quot;bSubs=Y&quot;</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
<span style='color=#000000'></span><br>
<span style='color=#000000'></span><br>
<span style='color=#000000'>[Ftp&nbsp;Script&nbsp;1]:S</span><br>
<span style='color=#000000'>!Title&nbsp;Connecting...</span><br>
<span style='color=#000000'>open&nbsp;example.com</span><br>
<span style='color=#000000'>username</span><br>
<span style='color=#000000'>password</span><br>
<span style='color=#000000'></span><br>
<span style='color=#000000'>!Title&nbsp;Preparing...</span><br>
<span style='color=#000000'>cd&nbsp;public_html/MyRemoteDirectory</span><br>
<span style='color=#000000'>lcd&nbsp;c:\MyLocalDirectory</span><br>
<span style='color=#000000'>binary</span><br>
<span style='color=#000000'>hash</span><br>
<span style='color=#000000'></span><br>
<span style='color=#000000'>!Title&nbsp;Processing...&nbsp;%FtpCommand%</span><br>
<span style='color=#000000'>%FtpCommand%</span><br>
<span style='color=#000000'></span><br>
<span style='color=#000000'>!Title&nbsp;Disconnecting...</span><br>
<span style='color=#000000'>disconnect</span><br>
<span style='color=#000000'>bye</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Batch.FtpBatchLoginSharing'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2009-12-06</font></font></div>
    <H2>FTP Scripts Sharing Login Info - Manage the FTP login separately from your FTP scripts</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'><p>If you have multiple FTP scripts that all use the same login information to your FTP site then you may 
wish to manage the login information separately from your FTP scripts in a single place.  That way 
if the username, password or hostname for the FTP connection changes you only need to edit a single place 
instead of having to edit all FTP scripts one by one.
<p>This automatic login script (also described in detail earlier) can be used to execute different FTP scripts
that share the same login information stored within the batch file. 
<p>Example: <b>FtpLogin.bat script1.ftp</b>
<p><b>Note:</b> The FTP scripts passed into the batch must have the login sequence removed.
<p><b>Note:</b> The FTP script executes even if the connection sequence fails potentially causing `Not connected` 
and other errors.  This is no different from regularly executing <a href="DosCommandIndex-2.html#FTP">FTP</a> with -s option.
</td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'><span style='float:right;'>Download: <a href='FtpLoginSharing.bat'>FtpLoginSharing.bat</a>&nbsp;&nbsp;</span>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'>@type&nbsp;%1|ftp&nbsp;-i&nbsp;-s:&quot;<span class=c_pvar>%~f0</span>&quot;&amp;GOTO:EOF</span><br>
<span style='color=#000000'>open&nbsp;example.com</span><br>
<span style='color=#000000'>username</span><br>
<span style='color=#000000'>password</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Batch.FtpBatchUploadOnlyNewFiles'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2010-02-05</font></font></div>
    <H2>FTP - Upload Only New Files - Ftp script to upload only files that don`t exist in remote folder, i.e. incremental upload</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>This batch connects twice to the FTP server.  First time it retrieves a list of files
on the FTP server.  Local files that are are not in this list will then be uploaded during a second 
connection.
<p>Note: Since all files are passed into the FTP`s MPUT command there might be a limit to the number 
of files that can be processed at once.</td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'><span style='float:right;'>Download: <a href='BatchFtpUploadOnlyNewFiles.bat'>BatchFtpUploadOnlyNewFiles.bat</a>&nbsp;&nbsp;</span>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br><a name='13'>13.</a><br><a name='14'>14.</a><br><a name='15'>15.</a><br><a name='16'>16.</a><br><a name='17'>17.</a><br><a name='18'>18.</a><br><a name='19'>19.</a><br><a name='20'>20.</a><br><a name='21'>21.</a><br><a name='22'>22.</a><br><a name='23'>23.</a><br><a name='24'>24.</a><br><a name='25'>25.</a><br><a name='26'>26.</a><br><a name='27'>27.</a><br><a name='28'>28.</a><br><a name='29'>29.</a><br><a name='30'>30.</a><br><a name='31'>31.</a><br><a name='32'>32.</a><br><a name='33'>33.</a><br><a name='34'>34.</a><br><a name='35'>35.</a><br><a name='36'>36.</a><br><a name='37'>37.</a><br><a name='38'>38.</a><br><a name='39'>39.</a><br><a name='40'>40.</a><br><a name='41'>41.</a><br><a name='42'>42.</a><br><a name='43'>43.</a><br><a name='44'>44.</a><br><a name='45'>45.</a><br><a name='46'>46.</a><br><a name='47'>47.</a><br><a name='48'>48.</a><br><a name='49'>49.</a><br><a name='50'>50.</a><br><a name='51'>51.</a><br><a name='52'>52.</a><br><a name='53'>53.</a><br><a name='54'>54.</a><br><a name='55'>55.</a><br><a name='56'>56.</a><br><a name='57'>57.</a><br><a name='58'>58.</a><br><a name='59'>59.</a><br><a name='60'>60.</a><br><a name='61'>61.</a><br><a name='62'>62.</a><br><a name='63'>63.</a><br><a name='64'>64.</a><br><a name='65'>65.</a><br><a name='66'>66.</a><br><a name='67'>67.</a><br><a name='68'>68.</a><br><a name='69'>69.</a><br><a name='70'>70.</a><br><a name='71'>71.</a><br><a name='72'>72.</a><br><a name='73'>73.</a><br><a name='74'>74.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'>@Echo&nbsp;Off</span><br>
<span style='color=#000000'>Setlocal&nbsp;Enabledelayedexpansion</span><br>
<span style='color=#000000'></span><br>
<span style='color=#000000'><span class=c_cmmt>REM&nbsp;--&nbsp;Define&nbsp;File&nbsp;Filter,&nbsp;i.e.&nbsp;files&nbsp;with&nbsp;extension&nbsp;.txt</span></span><br>
<span style='color=#000000'>Set&nbsp;FindStrArgs=/E&nbsp;/C:&quot;.txt&quot;</span><br>
<span style='color=#000000'></span><br>
<span style='color=#000000'><span class=c_cmmt>REM&nbsp;--&nbsp;Extract&nbsp;Ftp&nbsp;Script&nbsp;to&nbsp;create&nbsp;List&nbsp;of&nbsp;Files</span></span><br>
<span style='color=#000000'>Set&nbsp;&quot;FtpCommand=ls&quot;</span><br>
<span style='color=#000000'>Call:extractFileSection&nbsp;&quot;[Ftp&nbsp;Script&nbsp;1]&quot;&nbsp;&quot;-&quot;&gt;&quot;%temp%\<span class=c_pvar>%~n0</span>.ftp&quot;</span><br>
<span style='color=#000000'><span class=c_cmmt>Rem&nbsp;Notepad&nbsp;&quot;%temp%\<span class=c_pvar>%~n0</span>.ftp&quot;</span></span><br>
<span style='color=#000000'></span><br>
<span style='color=#000000'><span class=c_cmmt>REM&nbsp;--&nbsp;Execute&nbsp;Ftp&nbsp;Script,&nbsp;collect&nbsp;File&nbsp;Names</span></span><br>
<span style='color=#000000'>Set&nbsp;&quot;FileList=&quot;</span><br>
<span style='color=#000000'>For&nbsp;/F&nbsp;&quot;Delims=&quot;&nbsp;<span class=c_pvar>%%A</span>&nbsp;In&nbsp;('&quot;Ftp&nbsp;-v&nbsp;-i&nbsp;-s:&quot;%temp%\<span class=c_pvar>%~n0</span>.ftp&quot;|Findstr&nbsp;%FindStrArgs%&quot;')&nbsp;Do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;Call&nbsp;Set&nbsp;&quot;FileList=<span class=c_pvar>%%F</span>ileList%%&nbsp;&quot;<span class=c_pvar>%%A</span>&quot;&quot;</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'></span><br>
<span style='color=#000000'><span class=c_cmmt>REM&nbsp;--&nbsp;Extract&nbsp;Ftp&nbsp;Script&nbsp;to&nbsp;upload&nbsp;files&nbsp;that&nbsp;don't&nbsp;exist&nbsp;in&nbsp;remote&nbsp;folder</span></span><br>
<span style='color=#000000'>Set&nbsp;&quot;FtpCommand=mput&quot;</span><br>
<span style='color=#000000'>For&nbsp;<span class=c_pvar>%%A</span>&nbsp;In&nbsp;(%FileList%)&nbsp;Do&nbsp;set&nbsp;&quot;Exist[&quot;<span class=c_pvar>%%~A</span>&quot;]=Y&quot;</span><br>
<span style='color=#000000'>For&nbsp;/F&nbsp;&quot;Delims=&quot;&nbsp;<span class=c_pvar>%%A</span>&nbsp;In&nbsp;('&quot;dir&nbsp;/b&nbsp;&quot;%localdir%&quot;|Findstr&nbsp;%FindStrArgs%&quot;')&nbsp;Do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;Not&nbsp;defined&nbsp;Exist[&quot;<span class=c_pvar>%%~A</span>&quot;]&nbsp;Call&nbsp;Set&nbsp;&quot;FtpCommand=<span class=c_pvar>%%F</span>tpCommand%%&nbsp;&quot;<span class=c_pvar>%%~A</span>&quot;&quot;</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>Call:extractFileSection&nbsp;&quot;[Ftp&nbsp;Script&nbsp;1]&quot;&nbsp;&quot;-&quot;&gt;&quot;%temp%\<span class=c_pvar>%~n0</span>.ftp&quot;</span><br>
<span style='color=#000000'><span class=c_cmmt>rem&nbsp;&nbsp;Notepad&nbsp;&quot;%temp%\<span class=c_pvar>%~n0</span>.ftp&quot;</span></span><br>
<span style='color=#000000'></span><br>
<span style='color=#000000'>For&nbsp;<span class=c_pvar>%%A</span>&nbsp;In&nbsp;(%FtpCommand%)&nbsp;Do&nbsp;Echo.<span class=c_pvar>%%A</span></span><br>
<span style='color=#000000'></span><br>
<span style='color=#000000'><span class=c_cmmt>REM&nbsp;--&nbsp;Execute&nbsp;Ftp&nbsp;Script,&nbsp;download&nbsp;files</span></span><br>
<span style='color=#000000'>ftp&nbsp;-i&nbsp;-s:&quot;%temp%\<span class=c_pvar>%~n0</span>.ftp&quot;</span><br>
<span style='color=#000000'>Del&nbsp;&quot;%temp%\<span class=c_pvar>%~n0</span>.ftp&quot;</span><br>
<span style='color=#000000'>GOTO:EOF</span><br>
<span style='color=#000000'></span><br>
<span style='color=#000000'></span><br>
<span style='color=#000000'><span class=c_labl><a name='extractFileSection'>:extractFileSection</a></span><span class=c_cmmt>&nbsp;StartMark&nbsp;EndMark&nbsp;FileName&nbsp;--&nbsp;extract&nbsp;a&nbsp;section&nbsp;of&nbsp;file&nbsp;that&nbsp;is&nbsp;defined&nbsp;by&nbsp;a&nbsp;start&nbsp;and&nbsp;end&nbsp;mark</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;[IN]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;StartMark&nbsp;-&nbsp;start&nbsp;mark,&nbsp;use&nbsp;'...:S'&nbsp;mark&nbsp;to&nbsp;allow&nbsp;variable&nbsp;substitution</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;[IN,OPT]&nbsp;EndMark&nbsp;&nbsp;&nbsp;-&nbsp;optional&nbsp;end&nbsp;mark,&nbsp;default&nbsp;is&nbsp;first&nbsp;empty&nbsp;line</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;[IN,OPT]&nbsp;FileName&nbsp;&nbsp;-&nbsp;optional&nbsp;source&nbsp;file,&nbsp;default&nbsp;is&nbsp;THIS&nbsp;file</span></span><br>
<span style='color=#000000'>:$created&nbsp;20080219&nbsp;:$changed&nbsp;20100205&nbsp;:$categories&nbsp;ReadFile</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL&nbsp;Disabledelayedexpansion</span><br>
<span style='color=#000000'>set&nbsp;&quot;bmk=<span class=c_pvar>%~1</span>&quot;</span><br>
<span style='color=#000000'>set&nbsp;&quot;emk=<span class=c_pvar>%~2</span>&quot;</span><br>
<span style='color=#000000'>set&nbsp;&quot;src=<span class=c_pvar>%~3</span>&quot;</span><br>
<span style='color=#000000'>set&nbsp;&quot;bExtr=&quot;</span><br>
<span style='color=#000000'>set&nbsp;&quot;bSubs=&quot;</span><br>
<span style='color=#000000'>if&nbsp;&quot;%src%&quot;==&quot;&quot;&nbsp;set&nbsp;src=<span class=c_pvar>%~f0</span>&amp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=c_cmmt>rem&nbsp;if&nbsp;no&nbsp;source&nbsp;file&nbsp;then&nbsp;assume&nbsp;THIS&nbsp;file</span></span><br>
<span style='color=#000000'>for&nbsp;/f&nbsp;&quot;tokens=1,*&nbsp;delims=]&quot;&nbsp;<span class=c_pvar>%%A</span>&nbsp;in&nbsp;('find&nbsp;/n&nbsp;/v&nbsp;&quot;&quot;&nbsp;&quot;%src%&quot;')&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;/i&nbsp;&quot;<span class=c_pvar>%%B</span>&quot;==&quot;%emk%&quot;&nbsp;set&nbsp;&quot;bExtr=&quot;&amp;set&nbsp;&quot;bSubs=&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;defined&nbsp;bExtr&nbsp;if&nbsp;defined&nbsp;bSubs&nbsp;(call&nbsp;echo.<span class=c_pvar>%%B</span>)&nbsp;ELSE&nbsp;(echo.<span class=c_pvar>%%B</span>)</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;/i&nbsp;&quot;<span class=c_pvar>%%B</span>&quot;==&quot;%bmk%&quot;&nbsp;&nbsp;&nbsp;set&nbsp;&quot;bExtr=Y&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;/i&nbsp;&quot;<span class=c_pvar>%%B</span>&quot;==&quot;%bmk%:S&quot;&nbsp;set&nbsp;&quot;bExtr=Y&quot;&amp;set&nbsp;&quot;bSubs=Y&quot;</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
<span style='color=#000000'></span><br>
<span style='color=#000000'></span><br>
<span style='color=#000000'>[Ftp&nbsp;Script&nbsp;1]:S</span><br>
<span style='color=#000000'>!Title&nbsp;Connecting...</span><br>
<span style='color=#000000'>open&nbsp;example.com</span><br>
<span style='color=#000000'>username</span><br>
<span style='color=#000000'>password</span><br>
<span style='color=#000000'></span><br>
<span style='color=#000000'>!Title&nbsp;Preparing...</span><br>
<span style='color=#000000'>cd&nbsp;public_html/MyRemoteDirectory</span><br>
<span style='color=#000000'>lcd&nbsp;c:\MyLocalDirectory</span><br>
<span style='color=#000000'>binary</span><br>
<span style='color=#000000'>hash</span><br>
<span style='color=#000000'></span><br>
<span style='color=#000000'>!Title&nbsp;Processing...&nbsp;%FtpCommand%</span><br>
<span style='color=#000000'>%FtpCommand%</span><br>
<span style='color=#000000'></span><br>
<span style='color=#000000'>!Title&nbsp;Disconnecting...</span><br>
<span style='color=#000000'>disconnect</span><br>
<span style='color=#000000'>bye</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Batch.FtpBatchUsingVariables'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-10-17</font></font></div>
    <H2>FTP - Resolving Environment Variables - Creating FTP script on the fly at runtime and using variables within the FTP script</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'><p>This batch executed the FTP script embedded within the batch.  All variables in the FTP script will
be resolved.
<p>The <a href="DosCommandIndex-2.html#FOR">FOR</a> loop extracts the FTP script into a temporary file.  It the <a href="DosCommandIndex-2.html#ECHO">ECHO</a> command is 
being <a href="DosCommandIndex-2.html#CALL">CALL</a>ed for each line in order to resolve the variables.
<p>Variables can be used within the FTP script the same way as in a batch script, including 
any <a href="DtTipsStringManipulation.html">string manipulation</a> and command line arguments like %1 %2 %~n0 %* and so on.
<p>All batch lines start with semicolon so that they will be ignored by the <a href="DosCommandIndex-2.html#FOR">FOR</a> loop.  Semicolon
is the default end-of-line (EOL) character used by the <a href="DosCommandIndex-2.html#FOR">FOR</a> command.</td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br><a name='13'>13.</a><br><a name='14'>14.</a><br><a name='15'>15.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'>;@echo&nbsp;off</span><br>
<span style='color=#000000'>;(for&nbsp;/f&nbsp;&quot;usebackq&nbsp;delims=&quot;&nbsp;<span class=c_pvar>%%A</span>&nbsp;in&nbsp;(&quot;<span class=c_pvar>%~f0</span>&quot;)&nbsp;do&nbsp;call&nbsp;echo.<span class=c_pvar>%%A</span>)&gt;&quot;%temp%\<span class=c_pvar>%~n0</span>.ftp&quot;</span><br>
<span style='color=#000000'>;ftp&nbsp;-i&nbsp;-s:&quot;%temp%\<span class=c_pvar>%~n0</span>.ftp&quot;</span><br>
<span style='color=#000000'>;GOTO:EOF</span><br>
<span style='color=#000000'></span><br>
<span style='color=#000000'>open&nbsp;example.com</span><br>
<span style='color=#000000'>username</span><br>
<span style='color=#000000'>password</span><br>
<span style='color=#000000'>!:---&nbsp;FTP&nbsp;commands&nbsp;below&nbsp;here&nbsp;---</span><br>
<span style='color=#000000'>cd&nbsp;public_html/%COMPUTERNAME%</span><br>
<span style='color=#000000'>binary</span><br>
<span style='color=#000000'>hash&nbsp;on</span><br>
<span style='color=#000000'>%*</span><br>
<span style='color=#000000'>disconnect</span><br>
<span style='color=#000000'>bye</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Batch.FtpPure'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-01-01</font></font></div>
    <H2>Classic FTP - Executing a FTP script</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'><p>The FTP command support the "-s:ftpscript.txt" option.  The FTP commands listed in ftpscript.txt will automatically run after FTP starts.  The FTP command can be started from a batch file.</p>
Example:
<ul>
    <li>FTP -v -i -s:ftpscript.txt</li>
</ul>
See also command line help: "C:>ftp -?"</td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'>open&nbsp;example.com</span><br>
<span style='color=#000000'>username</span><br>
<span style='color=#000000'>password</span><br>
<span style='color=#000000'>!:---&nbsp;FTP&nbsp;commands&nbsp;below&nbsp;here&nbsp;---</span><br>
<span style='color=#000000'>lcd&nbsp;c:\MyLocalDirectory</span><br>
<span style='color=#000000'>cd&nbsp;&nbsp;public_html/MyRemoteDirectory</span><br>
<span style='color=#000000'>binary</span><br>
<span style='color=#000000'>mput&nbsp;&quot;*.*&quot;</span><br>
<span style='color=#000000'>disconnect</span><br>
<span style='color=#000000'>bye</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script Output:</td>
      <td class='text'  VALIGN='top'><table class="dosw" border="0" cellspacing="2" cellpadding="3">    <tr><td class="title">&nbsp;<img src="SysIcon.jpg" alt="DOS">&nbsp;Script Output    </td></tr>    <tr><td class="text"><pre>ftp&gt; open example.com
User (Username:(none)):

ftp&gt; !:--- FTP commands below here ---
ftp&gt; lcd c:\MyLocalDirectory
Local directory now c:\MyLocalDirectory.
ftp&gt; cd  public_html/MyRemoteDirectory
ftp&gt; binary
ftp&gt; !: mput &quot;*.*&quot;
ftp&gt; disconnect
ftp&gt; bye
</pre></td></tr></table></td>
    </tr>
  </table>
<br><br>
<!-- <a  href="https://www.amazon.com/gp/product/0692681310/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=0692681310&linkCode=as2&tag=dos01-20&linkId=55YDECJJE3E2RZBZ"><img border="0" src="https://ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=0692681310&Format=_SL250_&ID=AsinImage&MarketPlace=US&ServiceVersion=20070822&WS=1&tag=dos01-20" ></a><img src="https://ir-na.amazon-adsystem.com/e/ir?t=dos01-20&l=as2&o=1&a=0692681310" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" />
 -->
<a  href="https://www.amazon.com/gp/offer-listing/0692681310/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=0692681310&amp;linkCode=am2&amp;tag=dos01-20&amp;linkId=EM5WJJUFV5Z3RZTB"><img border="0" src="https://ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&amp;ASIN=0692681310&amp;Format=_SL250_&amp;ID=AsinImage&amp;MarketPlace=US&amp;ServiceVersion=20070822&amp;WS=1&amp;tag=dos01-20" ></a><img src="https://ir-na.amazon-adsystem.com/e/ir?t=dos01-20&amp;l=as2&amp;o=1&amp;a=0692681310" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" />
<div class='bot'>
<script type="text/javascript">
    /***********************************************
    * IFrame SSI script II- Copyright Dynamic Drive DHTML code library (http://www.dynamicdrive.com)
    * Visit DynamicDrive.com for hundreds of original DHTML scripts
    * This notice must stay intact for legal use
    ***********************************************/
    
    //Input the IDs of the IFRAMES you wish to dynamically resize to match its content height:
    //Separate each ID with a comma. Examples: ["myframe1", "myframe2"] or ["myframe"] or [] for none:
    var iframeids=["myframe"]
    
    //Should script hide iframe from browsers that don't support this script (non IE5+/NS6+ browsers. Recommended):
    var iframehide="yes"
    
    var getFFVersion=navigator.userAgent.substring(navigator.userAgent.indexOf("Firefox")).split("index.html")[1]
    var FFextraHeight=parseFloat(getFFVersion)>=0.1? 16 : 0 //extra height in px to add to iframe in FireFox 1.0+ browsers
    
    function resizeCaller() {
        var dyniframe=new Array()
        for (i=0; i<iframeids.length; i++){
            if (document.getElementById)
                resizeIframe(iframeids[i])
            //reveal iframe for lower end browsers? (see var above):
            if ((document.all || document.getElementById) && iframehide=="no"){
                var tempobj=document.all? document.all[iframeids[i]] : document.getElementById(iframeids[i])
                tempobj.style.display="block"
            }
        }
    }
    
    function resizeIframe(frameid){
        var currentfr=document.getElementById(frameid)
        if (currentfr && !window.opera){
            currentfr.style.display="block"
            if (currentfr.contentDocument && currentfr.contentDocument.body.offsetHeight) //ns6 syntax
                currentfr.height = currentfr.contentDocument.body.offsetHeight+FFextraHeight; 
            else if (currentfr.Document && currentfr.Document.body.scrollHeight) //ie5+ syntax
                currentfr.height = currentfr.Document.body.scrollHeight;
            if (currentfr.addEventListener)
                currentfr.addEventListener("load", readjustIframe, false)
            else if (currentfr.attachEvent){
                currentfr.detachEvent("onload", readjustIframe) // Bug fix line
                currentfr.attachEvent("onload", readjustIframe)
            }
        }
    }
    
    function readjustIframe(loadevt) {
        var crossevt=(window.event)? event : loadevt
        var iframeroot=(crossevt.currentTarget)? crossevt.currentTarget : crossevt.srcElement
        if (iframeroot)
            resizeIframe(iframeroot.id);
    }
    
    function loadintoIframe(iframeid, url){
        if (document.getElementById)
        document.getElementById(iframeid).src=url
    }
    
    if (window.addEventListener)
        window.addEventListener("load", resizeCaller, false)
    else if (window.attachEvent)
        window.attachEvent("onload", resizeCaller)
    else
        window.onload=resizeCaller
</script>
<iframe id="myframe" src="forum/viewforum4d6b.html?f=3"                  marginwidth="0" marginheight="0" frameborder="0" style="overflow:visible; " height=15000 width="100%" scrolling="no" ALLOWTRANSPARENCY="true"></iframe></div>

</body>

<!-- Mirrored from www.dostips.com/?t=Filter.FtpBatchScript by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 03:48:32 GMT -->
</html>
