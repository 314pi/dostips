<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html lang="en-US">

<!-- Mirrored from www.dostips.com/DtCodeCmdLib.php by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 03:23:51 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-280191-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-280191-1');
</script>

<META http-equiv=content-type content="text/html; charset=iso-8859-1">
<META content=TRUE name=MSSmartTagsPreventParsing>
<META http-equiv=expires content=-1>
<META http-equiv=pragma content=no-cache>
<META content=all name=robots>
<META name=keywords content='dos,functions,vista,xp,command line,batch,examples,substring,variables,copies,date'>
<link rel=Stylesheet type="text/css" media=all href="_style0b84.css?v=0001">
<link rel="shortcut icon" href="favicon.ico" >
<link rel="icon" href="animated_favicon1.gif" type="image/gif" >
<title>DOS Batch - Functions</title>
<!--zgen.php-->
</head>
<body>
<div class="nav">
        <br>
    <div class="navi">
        <a href='index.html'><img src='TitleDostips.jpg' height='80' alt='DosTips.com'></a>
        <br><span style="font-size: 9px; font-weight: bold;">for Windows10,Windows8,Windows7,VISTA,</span>
        <br><span style="font-size: 9px; font-weight: bold;">XP,NT,Server 2000,Server 2003,Server 2008</span>
        <br>
        <br>
            <!-- SiteSearch Google -->
<div class="search">
<script>
  (function() {
    var cx = 'partner-pub-4331089886589220:2001057635';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = '../cse.google.com/cse07b6.html?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:searchbox-only></gcse:searchbox-only>
</div>
<!-- SiteSearch Google -->
        <br>
            <ul>
        <li class='nsel'><a href='index.html'>Home</a>&nbsp;
            <ul>
                <li class='nsel'>&nbsp;</li>
            </ul>
        </li>
        <li class='nsel'><a>Source Script</a>&nbsp;
            <ul>
                <li class='nsel'><a href='DtCodeBatchFiles.html'>Batch Files</a>&nbsp;</li>
                <li class='nsel'><a href='DtCodeFunctions.html'>Functions</a>&nbsp;</li>
                <li class='ysel'><a href='DtCodeCmdLib.html'>Function Library</a>&nbsp;</li>
                <li class='nsel'><a href='DtCodeSnippets.html'>Script Snippets</a>&nbsp;</li>
                <li class='nsel'><a href='DtCodeInterfacing.html'>Interfacing</a>&nbsp;</li>
                <li class='nsel'>&nbsp;</li>
            </ul>
        </li>
        <li class='nsel'><a>Tips and Tricks</a>&nbsp;
            <ul>
                <li class='nsel'><a href='DtTipsXCopy.html'>Copy Tips</a>&nbsp;</li>
                <li class='nsel'><a href='DtTipsMenu.html'>Menu in Batch</a>&nbsp;</li>
                <li class='nsel'><a href='DtTipsStringManipulation.html'>String Manipulation</a>&nbsp;</li>
                <li class='nsel'><a href='DtTipsStringOperations.html'>String Operations</a>&nbsp;</li>
                <li class='nsel'><a href='DtTipsDateTime.html'>Date and Time</a>&nbsp;</li>
                <li class='nsel'><a href='DtTipsArithmetic.html'>Arithmetic</a>&nbsp;</li>
                <li class='nsel'><a href='DtTipsFtpBatchScript.html'>FTP Batch Script</a>&nbsp;</li>
                <li class='nsel'><a href='DosCommandIndex.html'>Command Index</a>&nbsp;</li>
                <li class='nsel'>&nbsp;</li>
            </ul>
        </li>
        <li class='nsel'><a>Tutorials</a>&nbsp;
            <ul>
                <li class='nsel'><a href='DtTutoFirstBatch.html'>My First Batch</a>&nbsp;</li>
                <li class='nsel'><a href='DtTutoFramework.html'>Solid Framework</a>&nbsp;</li>
                <li class='nsel'><a href='DtTutoFunctions.html'>Functions</a>&nbsp;</li>
                <li class='nsel'><a href='DtTutoPersistency.html'>Persistency</a>&nbsp;</li>
                <li class='nsel'>&nbsp;</li>
            </ul>
        </li>
        <li class='nsel'><a href='forum/viewforum4d6b.html?f=3'>Forum</a>&nbsp;
            <ul>
                <li class='nsel'>&nbsp;</li>
            </ul>
        </li>
        <li class='nsel'><a href='DtGeneGeneral.html'>General</a>&nbsp;
            <ul>
                <li class='nsel'><a href='DtGeneTermsOfUse.html'>Terms of Use</a>&nbsp;</li>
                <li class='nsel'><a href='DtGeneEnabler.html'>Enablers</a>&nbsp;</li>
                <li class='nsel'><a href='DtGeneAboutUs.html'>About Us</a>&nbsp;</li>
                <li class='nsel'><a href='forum/memberlist8733.html?mode=contactadmin'>Contact Us</a>&nbsp;</li>
                <li class='nsel'>&nbsp;</li>
            </ul>
        </li>
        <li class='nsel'><a>Others</a>&nbsp;
            <ul>
                <li class='nsel'><a href='https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&amp;hosted_button_id=9018663'><marquee width="120" scrollamount="2">Want donate a cup of Cafe? . click . </marquee></a>&nbsp;</li>
                <li class='nsel'>&nbsp;</li>
            </ul>
        </li>
    </ul>
    </div>
</div>
<H1>DOS Batch - Functions</H1>
<span class='shortText'>Keep your batch script clean, call DOS functions.</span><br><br>
  <table class='posts'>
  </table>
<br><table class='menu' cellpadding='0' cellspacing='0'>
<tr><td colspan='2'>
</td></tr>
<tr><td class='title'><a href='#Function.append'>:append</a></td>
<td class='text'>appends a string to a specific line in a text file</td>
</tr>
<tr><td class='title'><a href='#Function.bannerPingPong'>:bannerPingPong</a></td>
<td class='text'>moves text in varref one step left or right and updates title</td>
</tr>
<tr><td class='title'><a href='#Function.bannerRotate'>:bannerRotate</a></td>
<td class='text'>rotates text in varref one step and updates title</td>
</tr>
<tr><td class='title'><a href='#Function.choiceListInput'>:choiceListInput</a></td>
<td class='text'>lets the user choose from list of last entered values</td>
</tr>
<tr><td class='title'><a href='#Function.CmpFTime'>:CmpFTime</a></td>
<td class='text'>compares the time of two files, succeeds if condition is met, fails otherwise</td>
</tr>
<tr><td class='title'><a href='#Function.date2jdate'>:date2jdate</a></td>
<td class='text'>converts a gregorian calender date to julian day format</td>
</tr>
<tr><td class='title'><a href='#Function.dayOfYear'>:dayOfYear</a></td>
<td class='text'>returns the day of the year, i.e. 1 for 1/1/2008, 266 for 12/31/2008</td>
</tr>
<tr><td class='title'><a href='#Function.DeleteIfOld'>:DeleteIfOld</a></td>
<td class='text'>deletes file or directory if older than given number of days</td>
</tr>
<tr><td class='title'><a href='#Function.doProgress'>:doProgress</a></td>
<td class='text'>displays the next progress tick</td>
</tr>
<tr><td class='title'><a href='#Function.dumpArr'>:dumpArr</a></td>
<td class='text'>dumps the array content / under construction</td>
</tr>
<tr><td class='title'><a href='#Function.echo'>:echo</a></td>
<td class='text'>echoes text in a specific color</td>
</tr>
<tr><td class='title'><a href='#Function.echoLine'>:echoLine</a></td>
<td class='text'>outputs a formatted string, substitutes file name and line number</td>
</tr>
<tr><td class='title'><a href='#Function.extractFileSection'>:extractFileSection</a></td>
<td class='text'>extracts a section of file that is defined by a start and end mark</td>
</tr>
<tr><td class='title'><a href='#Function.ExtractFunction'>:ExtractFunction</a></td>
<td class='text'>extracts a function by label</td>
</tr>
<tr><td class='title'><a href='#Function.ExtractSimple'>:ExtractSimple</a></td>
<td class='text'>extracts a marked section from batch file, sustitutes variables during extraction</td>
</tr>
<tr><td class='title'><a href='#Function.false'>:false</a></td>
<td class='text'>returns failure</td>
</tr>
<tr><td class='title'><a href='#Function.Format'>:Format</a></td>
<td class='text'>outputs columns of strings right or left aligned</td>
</tr>
<tr><td class='title'><a href='#Function.fprop'>:fprop</a></td>
<td class='text'>returns a file property</td>
</tr>
<tr><td class='title'><a href='#Function.ftime'>:ftime</a></td>
<td class='text'>returns the file time in julian days</td>
</tr>
<tr><td class='title'><a href='#Function.getColorCode'>:getColorCode</a></td>
<td class='text'>converts color text to color code</td>
</tr>
<tr><td class='title'><a href='#Function.getDriveInfo'>:getDriveInfo</a></td>
<td class='text'>returns array of fsutil drive information</td>
</tr>
<tr><td class='title'><a href='#Function.getDrives'>:getDrives</a></td>
<td class='text'>This function has been replaced by :getDriveInfo</td>
</tr>
<tr><td class='title'><a href='#Function.getFunctions'>:getFunctions</a></td>
<td class='text'>returns a comma separated list of all functions</td>
</tr>
<tr><td class='title'><a href='#Function.getHostName'>:getHostName</a></td>
<td class='text'>resolves IP address to computer name</td>
</tr>
<tr><td class='title'><a href='#Function.getIP'>:getIP</a></td>
<td class='text'>return THIS computers IP address</td>
</tr>
<tr><td class='title'><a href='#Function.getIPConfig'>:getIPConfig</a></td>
<td class='text'>return IPCONFIG /ALL data in array variable</td>
</tr>
<tr><td class='title'><a href='#Function.getNextInList'>:getNextInList</a></td>
<td class='text'>return next value in list</td>
</tr>
<tr><td class='title'><a href='#Function.getRandomColor'>:getRandomColor</a></td>
<td class='text'>returns a random color</td>
</tr>
<tr><td class='title'><a href='#Function.GetRegKeys'>:GetRegKeys</a></td>
<td class='text'>returns all registry syb keys of a given registry key</td>
</tr>
<tr><td class='title'><a href='#Function.GetRegValue'>:GetRegValue</a></td>
<td class='text'>returns a registry value</td>
</tr>
<tr><td class='title'><a href='#Function.GetRegValues'>:GetRegValues</a></td>
<td class='text'>returns all registry values of a given registry key</td>
</tr>
<tr><td class='title'><a href='#Function.getServices'>:getServices</a></td>
<td class='text'>returns array of service information</td>
</tr>
<tr><td class='title'><a href='#Function.getVarsByAttr'>:getVarsByAttr</a></td>
<td class='text'>returns a comma separated list of variables based on an attribute name</td>
</tr>
<tr><td class='title'><a href='#Function.htmlhelp'>:htmlhelp</a></td>
<td class='text'>dumps html help to console</td>
</tr>
<tr><td class='title'><a href='#Function.Init'>:Init</a></td>
<td class='text'>initializes the environment for this command library</td>
</tr>
<tr><td class='title'><a href='#Function.initProgress'>:initProgress</a></td>
<td class='text'>initializes an internal progress counter and display the progress in percent</td>
</tr>
<tr><td class='title'><a href='#Function.initVarsByAttr'>:initVarsByAttr</a></td>
<td class='text'>restores the values of the persistent variables to defaults</td>
</tr>
<tr><td class='title'><a href='#Function.IsFileOpen'>:IsFileOpen</a></td>
<td class='text'>succeeds if file in use, fails otherwise</td>
</tr>
<tr><td class='title'><a href='#Function.IsRegKey'>:IsRegKey</a></td>
<td class='text'>succeeds if Key exists</td>
</tr>
<tr><td class='title'><a href='#Function.IsRegValue'>:IsRegValue</a></td>
<td class='text'>succeeds if Key and Value exists</td>
</tr>
<tr><td class='title'><a href='#Function.IsServiceRunning'>:IsServiceRunning</a></td>
<td class='text'>returns success if service is running, otherwise failure</td>
</tr>
<tr><td class='title'><a href='#Function.jdate'>:jdate</a></td>
<td class='text'>converts a date string to julian day number with respect to regional date format</td>
</tr>
<tr><td class='title'><a href='#Function.jdate2date'>:jdate2date</a></td>
<td class='text'>converts julian days to gregorian date format</td>
</tr>
<tr><td class='title'><a href='#Function.kBytesFree'>:kBytesFree</a></td>
<td class='text'>returns the free space of a drive in kilobytes</td>
</tr>
<tr><td class='title'><a href='#Function.l2a'>:l2a</a></td>
<td class='text'>converts a list to an array</td>
</tr>
<tr><td class='title'><a href='#Function.loadPersistentVars'>:loadPersistentVars</a></td>
<td class='text'>loads the values of the persistent variables</td>
</tr>
<tr><td class='title'><a href='#Function.loadRegVars'>:loadRegVars</a></td>
<td class='text'>loads the values of the persistent variables</td>
</tr>
<tr><td class='title'><a href='#Function.lookup'>:lookup</a></td>
<td class='text'>returns the value associated with a key in a map of key-value pairs</td>
</tr>
<tr><td class='title'><a href='#Function.lTrim'>:lTrim</a></td>
<td class='text'>strips white spaces (or other characters) from the beginning of a string</td>
</tr>
<tr><td class='title'><a href='#Function.MakeAbsolute'>:MakeAbsolute</a></td>
<td class='text'>makes a file name absolute considering a base path</td>
</tr>
<tr><td class='title'><a href='#Function.MakeRelative'>:MakeRelative</a></td>
<td class='text'>makes a file name relative to a base path</td>
</tr>
<tr><td class='title'><a href='#Function.NetworkDeviceGuid2Name'>:NetworkDeviceGuid2Name</a></td>
<td class='text'>gets a Network Device Name from its coresponding GUID</td>
</tr>
<tr><td class='title'><a href='#Function.NetworkDeviceName2Guid'>:NetworkDeviceName2Guid</a></td>
<td class='text'>gets a Network Device GUID from its corresponding Name</td>
</tr>
<tr><td class='title'><a href='#Function.parse'>:parse</a></td>
<td class='text'>parses a string matching a formatter</td>
</tr>
<tr><td class='title'><a href='#Function.pwd'>:pwd</a></td>
<td class='text'>shows a password dialog box</td>
</tr>
<tr><td class='title'><a href='#Function.regedit'>:regedit</a></td>
<td class='text'>opens regedit at predefined location</td>
</tr>
<tr><td class='title'><a href='#Function.removeArr'>:removeArr</a></td>
<td class='text'>removes an array</td>
</tr>
<tr><td class='title'><a href='#Function.rTrim'>:rTrim</a></td>
<td class='text'>strips white spaces (or other characters) from the end of a string</td>
</tr>
<tr><td class='title'><a href='#Function.savePersistentVars'>:savePersistentVars</a></td>
<td class='text'>save values of persistent variables into a file</td>
</tr>
<tr><td class='title'><a href='#Function.saveRegVars'>:saveRegVars</a></td>
<td class='text'>save values of persistent variables into a file</td>
</tr>
<tr><td class='title'><a href='#Function.set'>:set</a></td>
<td class='text'>sets var[] to output of command  / under construction</td>
</tr>
<tr><td class='title'><a href='#Function.SetRegValue'>:SetRegValue</a></td>
<td class='text'>sets a registry value</td>
</tr>
<tr><td class='title'><a href='#Function.sleep'>:sleep</a></td>
<td class='text'>waits some seconds before returning</td>
</tr>
<tr><td class='title'><a href='#Function.StartsWith'>:StartsWith</a></td>
<td class='text'>Tests if a text starts with a given string</td>
</tr>
<tr><td class='title'><a href='#Function.strLen'>:strLen</a></td>
<td class='text'>returns the length of a string</td>
</tr>
<tr><td class='title'><a href='#Function.substitute'>:substitute</a></td>
<td class='text'>substitutes a string in a text file</td>
</tr>
<tr><td class='title'><a href='#Function.ToANSI'>:ToANSI</a></td>
<td class='text'>converts a file to ANSI</td>
</tr>
<tr><td class='title'><a href='#Function.toCamelCase'>:toCamelCase</a></td>
<td class='text'>converts a string to camel case</td>
</tr>
<tr><td class='title'><a href='#Function.toDec'>:toDec</a></td>
<td class='text'>convert a hexadecimal number to decimal</td>
</tr>
<tr><td class='title'><a href='#Function.toHex'>:toHex</a></td>
<td class='text'>convert a decimal number to hexadecimal, i.e. -20 to FFFFFFEC or 26 to 0000001A</td>
</tr>
<tr><td class='title'><a href='#Function.toLower'>:toLower</a></td>
<td class='text'>converts uppercase character to lowercase</td>
</tr>
<tr><td class='title'><a href='#Function.ToUNICODE'>:ToUNICODE</a></td>
<td class='text'>converts a file to UNICODE</td>
</tr>
<tr><td class='title'><a href='#Function.toUpper'>:toUpper</a></td>
<td class='text'>converts lowercase character to uppercase</td>
</tr>
<tr><td class='title'><a href='#Function.Trim'>:Trim</a></td>
<td class='text'>strip white spaces (or other characters) from the beginning and end of a string</td>
</tr>
<tr><td class='title'><a href='#Function.trimSpaces'>:trimSpaces</a></td>
<td class='text'>trims spaces around string variable</td>
</tr>
<tr><td class='title'><a href='#Function.trimSpaces2'>:trimSpaces2</a></td>
<td class='text'>trims spaces around string and assigns result to variable</td>
</tr>
<tr><td class='title'><a href='#Function.true'>:true</a></td>
<td class='text'>returns success</td>
</tr>
<tr><td class='title'><a href='#Function.Unique'>:Unique</a></td>
<td class='text'>returns a unique string based on a date-time-stamp, YYYYMMDDhhmmsscc</td>
</tr>
<tr><td class='title'><a href='DtCodeCmdLib.html'>DOS Batch - Functions</a></td>
<td class='text'>Keep your batch script clean, call DOS functions.</td>
</tr>
<tr><td class='title'><a href='#Batch.FunctionTemplate'>DOS Function Template</a></td>
<td class='text'>A function template with all features of a true DOS function.</td>
</tr>
</table>    <hr>
    <a name=''></a>
    <a name='Function.append'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:append - appends a string to a specific line in a text file</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#append'>:append</a> str file line </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br><a name='13'>13.</a><br><a name='14'>14.</a><br><a name='15'>15.</a><br><a name='16'>16.</a><br><a name='17'>17.</a><br><a name='18'>18.</a><br><a name='19'>19.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='append'>:append</a></span><span class=c_cmmt>&nbsp;str&nbsp;file&nbsp;line&nbsp;--&nbsp;appends&nbsp;a&nbsp;string&nbsp;to&nbsp;a&nbsp;specific&nbsp;line&nbsp;in&nbsp;a&nbsp;text&nbsp;file</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;str&nbsp;&nbsp;[in]&nbsp;-&nbsp;string&nbsp;to&nbsp;be&nbsp;appended</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;file&nbsp;[in]&nbsp;-&nbsp;file&nbsp;name&nbsp;to&nbsp;append&nbsp;the&nbsp;string&nbsp;to</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;line&nbsp;[in]&nbsp;-&nbsp;line&nbsp;number&nbsp;to&nbsp;append&nbsp;the&nbsp;string&nbsp;to,&nbsp;first&nbsp;line&nbsp;is&nbsp;1,&nbsp;omit&nbsp;for&nbsp;last&nbsp;line</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219&nbsp;:$categories&nbsp;FileManipulation</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL</span><br>
<span style='color=#000000'>set&nbsp;ap=<span class=c_pvar>%~1</span></span><br>
<span style='color=#000000'>set&nbsp;f=<span class=c_pvar>%~2</span></span><br>
<span style='color=#000000'>set&nbsp;c=<span class=c_pvar>%~3</span></span><br>
<span style='color=#000000'>if&nbsp;not&nbsp;defined&nbsp;c&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;c=0</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;/f&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;('find&nbsp;/v&nbsp;/c&nbsp;&quot;&quot;^&lt;&quot;%f%&quot;')&nbsp;do&nbsp;set&nbsp;c=<span class=c_pvar>%%a</span></span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>(for&nbsp;/f&nbsp;&quot;tokens=1,*&nbsp;delims=:&quot;&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;('findstr&nbsp;/v&nbsp;/n&nbsp;&quot;$$&quot;^&lt;&quot;%f%&quot;')&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&quot;<span class=c_pvar>%%a</span>&quot;==&quot;%c%&quot;&nbsp;(echo.<span class=c_pvar>%%b</span>%ap%)&nbsp;ELSE&nbsp;echo.<span class=c_pvar>%%b</span></span><br>
<span style='color=#000000'>))&gt;&quot;%temp%.\t0815.txt&quot;</span><br>
<span style='color=#000000'>move&nbsp;/y&nbsp;&quot;%temp%.\t0815.txt&quot;&nbsp;&quot;%f%&quot;</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.bannerPingPong'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:bannerPingPong - moves text in varref one step left or right and updates title</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#bannerPingPong'>:bannerPingPong</a> varref </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br><a name='13'>13.</a><br><a name='14'>14.</a><br><a name='15'>15.</a><br><a name='16'>16.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='bannerPingPong'>:bannerPingPong</a></span><span class=c_cmmt>&nbsp;varref&nbsp;--&nbsp;moves&nbsp;text&nbsp;in&nbsp;varref&nbsp;one&nbsp;step&nbsp;left&nbsp;or&nbsp;right&nbsp;and&nbsp;updates&nbsp;title</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;varref&nbsp;[in,out]&nbsp;-&nbsp;variable&nbsp;name&nbsp;with&nbsp;banner&nbsp;text,&nbsp;format:&nbsp;&quot;Banner&nbsp;Text------&quot;</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL&nbsp;ENABLEDELAYEDEXPANSION</span><br>
<span style='color=#000000'>set&nbsp;s=!<span class=c_pvar>%~1</span>:&nbsp;=-!</span><br>
<span style='color=#000000'>if&nbsp;&quot;!s:~-1!&quot;&nbsp;NEQ&nbsp;&quot;-&quot;&nbsp;if&nbsp;&quot;!s:~-1!&quot;&nbsp;NEQ&nbsp;&quot;+&quot;&nbsp;set&nbsp;s=!s!--------</span><br>
<span style='color=#000000'>set&nbsp;d=!s:~-1!</span><br>
<span style='color=#000000'>if&nbsp;&quot;!s:~0,1!&quot;&nbsp;NEQ&nbsp;&quot;-&quot;&nbsp;set&nbsp;d=+</span><br>
<span style='color=#000000'>if&nbsp;&quot;!s:~-2,1!&quot;&nbsp;NEQ&nbsp;&quot;-&quot;&nbsp;set&nbsp;d=-</span><br>
<span style='color=#000000'>if&nbsp;&quot;!d!&quot;==&quot;+&quot;&nbsp;(set&nbsp;s=-!s:~0,-2!+)&nbsp;ELSE&nbsp;(set&nbsp;s=!s:~1,-1!--)</span><br>
<span style='color=#000000'>TITLE&nbsp;!s!</span><br>
<span style='color=#000000'>(&nbsp;ENDLOCAL&nbsp;&amp;&nbsp;<span class=c_cmmt>REM&nbsp;RETURN&nbsp;VALUES</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&quot;<span class=c_pvar>%~1</span>&quot;&nbsp;NEQ&nbsp;&quot;&quot;&nbsp;SET&nbsp;<span class=c_pvar>%~1</span>=%s%</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.bannerRotate'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:bannerRotate - rotates text in varref one step and updates title</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#bannerRotate'>:bannerRotate</a> varref </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='bannerRotate'>:bannerRotate</a></span><span class=c_cmmt>&nbsp;varref&nbsp;--&nbsp;rotates&nbsp;text&nbsp;in&nbsp;varref&nbsp;one&nbsp;step&nbsp;and&nbsp;updates&nbsp;title</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;varref&nbsp;[in,out]&nbsp;-&nbsp;variable&nbsp;name&nbsp;with&nbsp;banner&nbsp;text,&nbsp;format:&nbsp;&quot;Banner&nbsp;Text------&quot;</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL&nbsp;ENABLEDELAYEDEXPANSION</span><br>
<span style='color=#000000'>set&nbsp;s=!<span class=c_pvar>%~1</span>:&nbsp;=-!</span><br>
<span style='color=#000000'>set&nbsp;s=!s:~1!!s:~0,1!</span><br>
<span style='color=#000000'>TITLE&nbsp;!s!</span><br>
<span style='color=#000000'>(&nbsp;ENDLOCAL&nbsp;&amp;&nbsp;<span class=c_cmmt>REM&nbsp;RETURN&nbsp;VALUES</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&quot;<span class=c_pvar>%~1</span>&quot;&nbsp;NEQ&nbsp;&quot;&quot;&nbsp;SET&nbsp;<span class=c_pvar>%~1</span>=%s%</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.choiceListInput'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:choiceListInput - lets the user choose from list of last entered values</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#choiceListInput'>:choiceListInput</a> ret list title max </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br><a name='13'>13.</a><br><a name='14'>14.</a><br><a name='15'>15.</a><br><a name='16'>16.</a><br><a name='17'>17.</a><br><a name='18'>18.</a><br><a name='19'>19.</a><br><a name='20'>20.</a><br><a name='21'>21.</a><br><a name='22'>22.</a><br><a name='23'>23.</a><br><a name='24'>24.</a><br><a name='25'>25.</a><br><a name='26'>26.</a><br><a name='27'>27.</a><br><a name='28'>28.</a><br><a name='29'>29.</a><br><a name='30'>30.</a><br><a name='31'>31.</a><br><a name='32'>32.</a><br><a name='33'>33.</a><br><a name='34'>34.</a><br><a name='35'>35.</a><br><a name='36'>36.</a><br><a name='37'>37.</a><br><a name='38'>38.</a><br><a name='39'>39.</a><br><a name='40'>40.</a><br><a name='41'>41.</a><br><a name='42'>42.</a><br><a name='43'>43.</a><br><a name='44'>44.</a><br><a name='45'>45.</a><br><a name='46'>46.</a><br><a name='47'>47.</a><br><a name='48'>48.</a><br><a name='49'>49.</a><br><a name='50'>50.</a><br><a name='51'>51.</a><br><a name='52'>52.</a><br><a name='53'>53.</a><br><a name='54'>54.</a><br><a name='55'>55.</a><br><a name='56'>56.</a><br><a name='57'>57.</a><br><a name='58'>58.</a><br><a name='59'>59.</a><br><a name='60'>60.</a><br><a name='61'>61.</a><br><a name='62'>62.</a><br><a name='63'>63.</a><br><a name='64'>64.</a><br><a name='65'>65.</a><br><a name='66'>66.</a><br><a name='67'>67.</a><br><a name='68'>68.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='choiceListInput'>:choiceListInput</a></span><span class=c_cmmt>&nbsp;ret&nbsp;list&nbsp;title&nbsp;max&nbsp;--&nbsp;lets&nbsp;the&nbsp;user&nbsp;choose&nbsp;from&nbsp;list&nbsp;of&nbsp;last&nbsp;entered&nbsp;values</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;ret&nbsp;&nbsp;&nbsp;[out]&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;varref&nbsp;returns&nbsp;input&nbsp;value</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;list&nbsp;&nbsp;[in,out]&nbsp;-&nbsp;varref&nbsp;with&nbsp;choice&nbsp;list,&nbsp;returns&nbsp;trimmed&nbsp;reordered&nbsp;choice&nbsp;list</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;title&nbsp;[in]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;list&nbsp;title</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;max&nbsp;&nbsp;&nbsp;[in]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;maximum&nbsp;number&nbsp;of&nbsp;list&nbsp;entries</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219&nbsp;:$categories&nbsp;Input</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL&nbsp;ENABLEDELAYEDEXPANSION</span><br>
<span style='color=#000000'>set&nbsp;l=,!<span class=c_pvar>%~2</span>!,&amp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=c_cmmt>rem.--&nbsp;get&nbsp;the&nbsp;choice&nbsp;list</span></span><br>
<span style='color=#000000'>set&nbsp;t=<span class=c_pvar>%~3</span>&amp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=c_cmmt>rem.--&nbsp;get&nbsp;the&nbsp;list&nbsp;title</span></span><br>
<span style='color=#000000'>set&nbsp;c=<span class=c_pvar>%~4</span>&amp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=c_cmmt>rem.--&nbsp;get&nbsp;the&nbsp;list&nbsp;entry&nbsp;count&nbsp;limit</span></span><br>
<span style='color=#000000'>set&nbsp;m=&amp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=c_cmmt>rem.--&nbsp;a&nbsp;message</span></span><br>
<span style='color=#000000'>set&nbsp;l2=,</span><br>
<span style='color=#000000'>set&nbsp;v=</span><br>
<span style='color=#000000'><span class=c_labl><a name='choiceListInput_LOOP1'>:choiceListInput_LOOP1</a></span><span class=c_cmmt></span></span><br>
<span style='color=#000000'>echo.%t%</span><br>
<span style='color=#000000'>set&nbsp;i=0&amp;for&nbsp;/f&nbsp;&quot;delims=&quot;&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;('&quot;echo.%l:,=&amp;echo.%&quot;')&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;/a&nbsp;i+=1</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;l2=!l2!!i!;<span class=c_pvar>%%~a</span>,</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;v=<span class=c_pvar>%%~a</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;echo.&nbsp;&nbsp;!i!&nbsp;-&nbsp;<span class=c_pvar>%%~a</span></span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>if&nbsp;&quot;%m%&quot;&nbsp;NEQ&nbsp;&quot;&quot;&nbsp;echo.&nbsp;&nbsp;^&gt;^&gt;&nbsp;%m%</span><br>
<span style='color=#000000'>echo.&nbsp;&nbsp;Make&nbsp;a&nbsp;choice&nbsp;or&nbsp;enter&nbsp;a&nbsp;new&nbsp;value&nbsp;[%v%]</span><br>
<span style='color=#000000'>set&nbsp;v1=%v%</span><br>
<span style='color=#000000'>set&nbsp;/p&nbsp;v1=&nbsp;&nbsp;:</span><br>
<span style='color=#000000'>echo.</span><br>
<span style='color=#000000'>set&nbsp;v2=!v1!&amp;set&nbsp;v2=!v2:,=!&amp;set&nbsp;v2=!v2:@=!&amp;set&nbsp;v2=!v2:;=!&amp;set&nbsp;v2=!v2:&quot;=!</span><br>
<span style='color=#000000'><span class=c_cmmt>rem.--reject&nbsp;entry&nbsp;with&nbsp;illegal&nbsp;character</span></span><br>
<span style='color=#000000'>if&nbsp;&quot;!v1!&quot;&nbsp;NEQ&nbsp;&quot;!v2!&quot;&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;m=Note:&nbsp;,;@&quot;&nbsp;and&nbsp;empty&nbsp;string&nbsp;not&nbsp;allowed.&nbsp;&nbsp;Try&nbsp;again.</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;goto:choiceListInput_LOOP1</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'><span class=c_cmmt>rem.--if&nbsp;first&nbsp;character&nbsp;is&nbsp;minus&nbsp;then&nbsp;remove&nbsp;the&nbsp;entry</span></span><br>
<span style='color=#000000'>set&nbsp;remove=&amp;if&nbsp;&quot;%v1:~0,1%&quot;==&quot;-&quot;&nbsp;set&nbsp;remove=y&amp;set&nbsp;v1=%v1:~1%</span><br>
<span style='color=#000000'>set&nbsp;v=%v1%</span><br>
<span style='color=#000000'><span class=c_cmmt>rem.--if&nbsp;number&nbsp;chosen&nbsp;then&nbsp;find&nbsp;corresponding&nbsp;value</span></span><br>
<span style='color=#000000'>set&nbsp;l3=!l2:,%v%;=,@!</span><br>
<span style='color=#000000'>if&nbsp;&quot;%l3%&quot;&nbsp;NEQ&nbsp;&quot;%l2%&quot;&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;/f&nbsp;&quot;delims=@&nbsp;tokens=2&quot;&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;(&quot;!l3!&quot;)&nbsp;do&nbsp;set&nbsp;l3=<span class=c_pvar>%%a</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;/f&nbsp;&quot;delims=,&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;(&quot;!l3!&quot;)&nbsp;do&nbsp;set&nbsp;v=<span class=c_pvar>%%a</span></span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'><span class=c_cmmt>rem.--remove&nbsp;value&nbsp;from&nbsp;list&nbsp;if&nbsp;exist</span></span><br>
<span style='color=#000000'>set&nbsp;l3=%l%</span><br>
<span style='color=#000000'>set&nbsp;l=!l:,%v%,=,!</span><br>
<span style='color=#000000'>if&nbsp;&quot;%remove%&quot;==&quot;y&quot;&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&quot;%l%&quot;==&quot;%l3%&quot;&nbsp;(set&nbsp;m='%v%'&nbsp;cannot&nbsp;be&nbsp;removed&nbsp;from&nbsp;list</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;ELSE&nbsp;(set&nbsp;m='%v%'&nbsp;has&nbsp;been&nbsp;removed&nbsp;from&nbsp;list)</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;goto:choiceListInput_LOOP1</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>if&nbsp;&quot;%l%&quot;==&quot;%l3%&quot;&nbsp;echo.&nbsp;&nbsp;^&gt;^&gt;'%v%'&nbsp;has&nbsp;been&nbsp;added&nbsp;to&nbsp;the&nbsp;list</span><br>
<span style='color=#000000'><span class=c_cmmt>rem.--add&nbsp;to&nbsp;the&nbsp;value&nbsp;to&nbsp;the&nbsp;end</span></span><br>
<span style='color=#000000'>set&nbsp;l=!l:~1!%v%</span><br>
<span style='color=#000000'><span class=c_cmmt>rem.--enforce&nbsp;the&nbsp;list&nbsp;entry&nbsp;count&nbsp;limit&nbsp;if&nbsp;requested</span></span><br>
<span style='color=#000000'>if&nbsp;&quot;%c%&quot;&nbsp;NEQ&nbsp;&quot;&quot;&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;i=0&amp;for&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;(%l%)&nbsp;do&nbsp;set&nbsp;/a&nbsp;i+=1</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;/i&nbsp;!i!&nbsp;GTR&nbsp;!c!&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;/f&nbsp;&quot;delims=,&nbsp;tokens=1,*&quot;&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;(&quot;!l!&quot;)&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;l=<span class=c_pvar>%%b</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo.&nbsp;&nbsp;^&gt;^&gt;'<span class=c_pvar>%%a</span>'&nbsp;dropped&nbsp;out&nbsp;of&nbsp;the&nbsp;list</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;)</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>(&nbsp;ENDLOCAL&nbsp;&amp;&nbsp;<span class=c_cmmt>REM&nbsp;RETURN&nbsp;VALUES</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&quot;<span class=c_pvar>%~1</span>&quot;&nbsp;NEQ&nbsp;&quot;&quot;&nbsp;(SET&nbsp;<span class=c_pvar>%~1</span>=%v%)&nbsp;ELSE&nbsp;(echo.%v%)</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&quot;<span class=c_pvar>%~2</span>&quot;&nbsp;NEQ&nbsp;&quot;&quot;&nbsp;(SET&nbsp;<span class=c_pvar>%~2</span>=%l%)&nbsp;ELSE&nbsp;(echo.%l%)</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.CmpFTime'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:CmpFTime - compares the time of two files, succeeds if condition is met, fails otherwise</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#CmpFTime'>:CmpFTime</a> op file1 file2 attr1 attr2 </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br><a name='13'>13.</a><br><a name='14'>14.</a><br><a name='15'>15.</a><br><a name='16'>16.</a><br><a name='17'>17.</a><br><a name='18'>18.</a><br><a name='19'>19.</a><br><a name='20'>20.</a><br><a name='21'>21.</a><br><a name='22'>22.</a><br><a name='23'>23.</a><br><a name='24'>24.</a><br><a name='25'>25.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='CmpFTime'>:CmpFTime</a></span><span class=c_cmmt>&nbsp;op&nbsp;file1&nbsp;file2&nbsp;attr1&nbsp;attr2&nbsp;--&nbsp;compares&nbsp;the&nbsp;time&nbsp;of&nbsp;two&nbsp;files,&nbsp;succeeds&nbsp;if&nbsp;condition&nbsp;is&nbsp;met,&nbsp;fails&nbsp;otherwise</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;op&nbsp;&nbsp;&nbsp;&nbsp;[in]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;compare&nbsp;operator,&nbsp;see&nbsp;'IF&nbsp;/?',&nbsp;i.e.EQU,&nbsp;NEQ,&nbsp;LSS,&nbsp;LEQ,&nbsp;GTR,&nbsp;GEQ</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;fileL&nbsp;[in]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;file&nbsp;name,&nbsp;left&nbsp;side&nbsp;of&nbsp;comparisation</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;file2&nbsp;[in]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;file&nbsp;name,&nbsp;right&nbsp;side&nbsp;of&nbsp;comparisation</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;attrL&nbsp;[in,opt]&nbsp;-&nbsp;time&nbsp;field&nbsp;to&nbsp;be&nbsp;used&nbsp;for&nbsp;fileL,&nbsp;see&nbsp;'dir&nbsp;/?',&nbsp;i.e.&nbsp;/tc,&nbsp;/ta,&nbsp;/tw,&nbsp;default&nbsp;is&nbsp;/tw</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;attrR&nbsp;[in,opt]&nbsp;-&nbsp;time&nbsp;field&nbsp;to&nbsp;be&nbsp;used&nbsp;for&nbsp;fileR,&nbsp;default&nbsp;is&nbsp;attrL</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219&nbsp;:$categories&nbsp;DateAndTime,FileOperation</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL</span><br>
<span style='color=#000000'>set&nbsp;op=<span class=c_pvar>%~1</span></span><br>
<span style='color=#000000'>set&nbsp;fileL=<span class=c_pvar>%~2</span></span><br>
<span style='color=#000000'>set&nbsp;fileR=<span class=c_pvar>%~3</span></span><br>
<span style='color=#000000'>set&nbsp;attrL=<span class=c_pvar>%~4</span></span><br>
<span style='color=#000000'>set&nbsp;attrR=<span class=c_pvar>%~5</span></span><br>
<span style='color=#000000'>if&nbsp;&quot;%op%&quot;==&quot;&quot;&nbsp;set&nbsp;op===</span><br>
<span style='color=#000000'>if&nbsp;&quot;%attrL%&quot;==&quot;&quot;&nbsp;set&nbsp;attrL=/tw</span><br>
<span style='color=#000000'>if&nbsp;&quot;%attrR%&quot;==&quot;&quot;&nbsp;set&nbsp;attrR=%attrL%</span><br>
<span style='color=#000000'>for&nbsp;/f&nbsp;&quot;tokens=1-6&nbsp;delims=/:&nbsp;&quot;&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;('&quot;dir&nbsp;%attrL%&nbsp;/-c&nbsp;&quot;%fileL%&quot;|findstr&nbsp;&quot;^^[0-1]&quot;&quot;')&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;TL=<span class=c_pvar>%%c</span><span class=c_pvar>%%a</span><span class=c_pvar>%%b</span><span class=c_pvar>%%f</span><span class=c_pvar>%%d</span><span class=c_pvar>%%e</span></span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>for&nbsp;/f&nbsp;&quot;tokens=1-6&nbsp;delims=/:&nbsp;&quot;&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;('&quot;dir&nbsp;%attrR%&nbsp;/-c&nbsp;&quot;%fileR%&quot;|findstr&nbsp;&quot;^^[0-1]&quot;&quot;')&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;TR=<span class=c_pvar>%%c</span><span class=c_pvar>%%a</span><span class=c_pvar>%%b</span><span class=c_pvar>%%f</span><span class=c_pvar>%%d</span><span class=c_pvar>%%e</span></span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>if&nbsp;&quot;%TL%&quot;&nbsp;%op%&nbsp;&quot;%TR%&quot;&nbsp;(<span class=c_cmmt>rem.)&nbsp;ELSE&nbsp;set=2&gt;NUL</span></span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.date2jdate'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:date2jdate - converts a gregorian calender date to julian day format</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#date2jdate'>:date2jdate</a> JD YYYY MM DD </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br><a name='13'>13.</a><br><a name='14'>14.</a><br><a name='15'>15.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='date2jdate'>:date2jdate</a></span><span class=c_cmmt>&nbsp;JD&nbsp;YYYY&nbsp;MM&nbsp;DD&nbsp;--&nbsp;converts&nbsp;a&nbsp;gregorian&nbsp;calender&nbsp;date&nbsp;to&nbsp;julian&nbsp;day&nbsp;format</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;JD&nbsp;&nbsp;&nbsp;[out]&nbsp;-&nbsp;julian&nbsp;days</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;YYYY&nbsp;[in]&nbsp;&nbsp;-&nbsp;gregorian&nbsp;year,&nbsp;i.e.&nbsp;2006</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;MM&nbsp;&nbsp;&nbsp;[in]&nbsp;&nbsp;-&nbsp;gregorian&nbsp;month,&nbsp;i.e.&nbsp;12&nbsp;for&nbsp;december</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;DD&nbsp;&nbsp;&nbsp;[in]&nbsp;&nbsp;-&nbsp;gregorian&nbsp;day,&nbsp;i.e.&nbsp;31</span></span><br>
<span style='color=#000000'>:$reference&nbsp;https://aa.usno.navy.mil/faq/docs/JD_Formula.html</span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219&nbsp;:$categories&nbsp;DateAndTime</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL</span><br>
<span style='color=#000000'>set&nbsp;&quot;yy=<span class=c_pvar>%~2</span>&quot;&amp;set&nbsp;&quot;mm=<span class=c_pvar>%~3</span>&quot;&amp;set&nbsp;&quot;dd=<span class=c_pvar>%~4</span>&quot;</span><br>
<span style='color=#000000'>set&nbsp;/a&nbsp;&quot;yy=10000%yy%&nbsp;<span class=c_pvar>%%1</span>0000,mm=100%mm%&nbsp;%%&nbsp;100,dd=100%dd%&nbsp;%%&nbsp;100&quot;</span><br>
<span style='color=#000000'>if&nbsp;%yy%&nbsp;LSS&nbsp;100&nbsp;set&nbsp;/a&nbsp;yy+=2000&nbsp;&amp;<span class=c_cmmt>rem&nbsp;Adds&nbsp;2000&nbsp;to&nbsp;two&nbsp;digit&nbsp;years</span></span><br>
<span style='color=#000000'>set&nbsp;/a&nbsp;JD=dd-32075+1461*(yy+4800+(mm-14)/12)/4+367*(mm-2-(mm-14)/12*12)/12-3*((yy+4900+(mm-14)/12)/100)/4</span><br>
<span style='color=#000000'>ENDLOCAL&nbsp;&amp;&nbsp;IF&nbsp;&quot;<span class=c_pvar>%~1</span>&quot;&nbsp;NEQ&nbsp;&quot;&quot;&nbsp;(SET&nbsp;<span class=c_pvar>%~1</span>=%JD%)&nbsp;ELSE&nbsp;(echo.%JD%)</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.dayOfYear'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-06-12</font></font></div>
    <H2>:dayOfYear - returns the day of the year, i.e. 1 for 1/1/2008, 266 for 12/31/2008</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#dayOfYear'>:dayOfYear</a> JD DateStr </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br><a name='13'>13.</a><br><a name='14'>14.</a><br><a name='15'>15.</a><br><a name='16'>16.</a><br><a name='17'>17.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='dayOfYear'>:dayOfYear</a></span><span class=c_cmmt>&nbsp;JD&nbsp;DateStr&nbsp;--&nbsp;returns&nbsp;the&nbsp;day&nbsp;of&nbsp;the&nbsp;year,&nbsp;i.e.&nbsp;1&nbsp;for&nbsp;1/1/2008,&nbsp;266&nbsp;for&nbsp;12/31/2008</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;day&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[out,opt]&nbsp;-&nbsp;variable&nbsp;name&nbsp;to&nbsp;store&nbsp;resulting&nbsp;day&nbsp;of&nbsp;the&nbsp;year</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;DateStr&nbsp;[in,opt]&nbsp;&nbsp;-&nbsp;date&nbsp;string,&nbsp;e.g.&nbsp;&quot;3/31/2006&quot;&nbsp;or&nbsp;&quot;Fri&nbsp;03/31/2006&quot;&nbsp;or&nbsp;&quot;31.3.2006&quot;,&nbsp;or&nbsp;omit&nbsp;form&nbsp;current&nbsp;date</span></span><br>
<span style='color=#000000'>:$reference&nbsp;https://groups.google.com/group/alt.msdos.batch.nt/browse_frm/thread/a0c34d593e782e94/50ed3430b6446af8#50ed3430b6446af8</span><br>
<span style='color=#000000'>:$created&nbsp;20080612&nbsp;:$changed&nbsp;20080612&nbsp;:$categories&nbsp;DateAndTime</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL</span><br>
<span style='color=#000000'>set&nbsp;&quot;DateStr=<span class=c_pvar>%~2</span>&quot;&amp;if&nbsp;&quot;<span class=c_pvar>%~2</span>&quot;==&quot;&quot;&nbsp;set&nbsp;&quot;DateStr=%date%&quot;</span><br>
<span style='color=#000000'>for&nbsp;/f&nbsp;&quot;skip=1&nbsp;tokens=2-4&nbsp;delims=(-)&quot;&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;('&quot;echo.|date&quot;')&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;/f&nbsp;&quot;tokens=1-3&nbsp;delims=/.-&nbsp;&quot;&nbsp;<span class=c_pvar>%%A</span>&nbsp;in&nbsp;(&quot;%DateStr:*&nbsp;=%&quot;)&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;<span class=c_pvar>%%a</span>=<span class=c_pvar>%%A</span>&amp;set&nbsp;<span class=c_pvar>%%b</span>=<span class=c_pvar>%%B</span>&amp;set&nbsp;<span class=c_pvar>%%c</span>=<span class=c_pvar>%%C</span>))</span><br>
<span style='color=#000000'>set&nbsp;/a&nbsp;&quot;yy=10000%yy%&nbsp;<span class=c_pvar>%%1</span>0000,mm=100%mm%&nbsp;%%&nbsp;100,dd=100%dd%&nbsp;%%&nbsp;100&quot;</span><br>
<span style='color=#000000'>set&nbsp;/a&nbsp;JD=dd-32075+1461*(yy+4800+(mm-14)/12)/4+367*(mm-2-(mm-14)/12*12)/12-3*((yy+4900+(mm-14)/12)/100)/4</span><br>
<span style='color=#000000'>set&nbsp;/a&nbsp;&quot;yy=10000%yy%&nbsp;<span class=c_pvar>%%1</span>0000,mm=1,dd=1&quot;</span><br>
<span style='color=#000000'>set&nbsp;/a&nbsp;JD-=-1+dd-32075+1461*(yy+4800+(mm-14)/12)/4+367*(mm-2-(mm-14)/12*12)/12-3*((yy+4900+(mm-14)/12)/100)/4</span><br>
<span style='color=#000000'>ENDLOCAL&nbsp;&amp;&nbsp;IF&nbsp;&quot;<span class=c_pvar>%~1</span>&quot;&nbsp;NEQ&nbsp;&quot;&quot;&nbsp;(SET&nbsp;<span class=c_pvar>%~1</span>=%JD%)&nbsp;ELSE&nbsp;(echo.%JD%)</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.DeleteIfOld'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:DeleteIfOld - deletes file or directory if older than given number of days</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#DeleteIfOld'>:DeleteIfOld</a> name days tnow </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Dependencies:</td>
      <td class='text'  VALIGN='top'> <a href="#ftime">:ftime</a></td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br><a name='13'>13.</a><br><a name='14'>14.</a><br><a name='15'>15.</a><br><a name='16'>16.</a><br><a name='17'>17.</a><br><a name='18'>18.</a><br><a name='19'>19.</a><br><a name='20'>20.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='DeleteIfOld'>:DeleteIfOld</a></span><span class=c_cmmt>&nbsp;name&nbsp;days&nbsp;tnow&nbsp;--&nbsp;deletes&nbsp;file&nbsp;or&nbsp;directory&nbsp;if&nbsp;older&nbsp;than&nbsp;given&nbsp;number&nbsp;of&nbsp;days</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;name&nbsp;[in]&nbsp;-&nbsp;name&nbsp;of&nbsp;file&nbsp;or&nbsp;directory</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;days&nbsp;[in]&nbsp;-&nbsp;number&nbsp;of&nbsp;days&nbsp;to&nbsp;expire</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;tnow&nbsp;[in]&nbsp;-&nbsp;today's&nbsp;date&nbsp;in&nbsp;julia&nbsp;days</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219&nbsp;:$categories&nbsp;DateAndTime,FileOperation</span><br>
<span style='color=#000000'>:$source&nbsp;www.DosTips.com</span><br>
<span style='color=#000000'>SETLOCAL</span><br>
<span style='color=#000000'>set&nbsp;&quot;days=<span class=c_pvar>%~2</span>&quot;</span><br>
<span style='color=#000000'>set&nbsp;&quot;tnow=<span class=c_pvar>%~3</span>&quot;</span><br>
<span style='color=#000000'>call:ftime&nbsp;tfile&nbsp;&quot;<span class=c_pvar>%~1</span>&quot;</span><br>
<span style='color=#000000'>set&nbsp;/a&nbsp;&quot;diff=tnow-tfile&quot;</span><br>
<span style='color=#000000'>if&nbsp;%diff%&nbsp;LEQ&nbsp;%days%&nbsp;EXIT&nbsp;/b</span><br>
<span style='color=#000000'>set&nbsp;&quot;attr=<span class=c_pvar>%~a1</span>&quot;</span><br>
<span style='color=#000000'><span class=c_cmmt>rem&nbsp;ECHO.%attr%,&nbsp;%attr:~0,1%,&nbsp;<span class=c_pvar>%~nx1</span>&nbsp;is&nbsp;%diff%&nbsp;days&nbsp;old</span></span><br>
<span style='color=#000000'>if&nbsp;/i&nbsp;&quot;%attr:~0,1%&quot;==&quot;d&quot;&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;rd&nbsp;/Q&nbsp;/S&nbsp;&quot;<span class=c_pvar>%~1</span>&quot;</span><br>
<span style='color=#000000'>)&nbsp;ELSE&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;del&nbsp;/Q&nbsp;&quot;<span class=c_pvar>%~1</span>&quot;</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.doProgress'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-03-27</font></font></div>
    <H2>:doProgress - displays the next progress tick</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#doProgress'>:doProgress</a> </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br><a name='13'>13.</a><br><a name='14'>14.</a><br><a name='15'>15.</a><br><a name='16'>16.</a><br><a name='17'>17.</a><br><a name='18'>18.</a><br><a name='19'>19.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='doProgress'>:doProgress</a></span><span class=c_cmmt>&nbsp;--&nbsp;displays&nbsp;the&nbsp;next&nbsp;progress&nbsp;tick</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080327&nbsp;:$categories&nbsp;Progress</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>set&nbsp;/a&nbsp;&quot;ProgressCnt+=1&quot;</span><br>
<span style='color=#000000'>SETLOCAL&nbsp;ENABLEDELAYEDEXPANSION</span><br>
<span style='color=#000000'>set&nbsp;/a&nbsp;&quot;per100=100*ProgressCnt/ProgressMax&quot;</span><br>
<span style='color=#000000'>set&nbsp;/a&nbsp;&quot;per10=per100/10&quot;</span><br>
<span style='color=#000000'>set&nbsp;/a&nbsp;&quot;per10m=10-per100/10-1&quot;</span><br>
<span style='color=#000000'>set&nbsp;&quot;P=%per100%%%&quot;</span><br>
<span style='color=#000000'>set&nbsp;&quot;PP=&quot;</span><br>
<span style='color=#000000'>for&nbsp;/l&nbsp;<span class=c_pvar>%%N</span>&nbsp;in&nbsp;(0,1,%per10%)&nbsp;do&nbsp;call&nbsp;set&nbsp;&quot;PP=<span class=c_pvar>%%P</span>P%%*&quot;</span><br>
<span style='color=#000000'>for&nbsp;/l&nbsp;<span class=c_pvar>%%N</span>&nbsp;in&nbsp;(%per10%,1,9)&nbsp;do&nbsp;call&nbsp;set&nbsp;&quot;PP=<span class=c_pvar>%%P</span>P%%&nbsp;&quot;</span><br>
<span style='color=#000000'>set&nbsp;&quot;PPP=&quot;</span><br>
<span style='color=#000000'>for&nbsp;/l&nbsp;<span class=c_pvar>%%N</span>&nbsp;in&nbsp;(0,1,%per10m%)&nbsp;do&nbsp;call&nbsp;set&nbsp;&quot;PPP=<span class=c_pvar>%%P</span>PP%%*&quot;</span><br>
<span style='color=#000000'>set&nbsp;&quot;ProgressFormat=%ProgressFormat:[P]=!P!%&quot;</span><br>
<span style='color=#000000'>set&nbsp;&quot;ProgressFormat=%ProgressFormat:[PP]=!PP!%&quot;</span><br>
<span style='color=#000000'>set&nbsp;&quot;ProgressFormat=%ProgressFormat:[PPP]=!PPP!%&quot;</span><br>
<span style='color=#000000'>title&nbsp;%ProgressFormat%</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.dumpArr'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:dumpArr - dumps the array content / under construction</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#dumpArr'>:dumpArr</a> arr </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='dumpArr'>:dumpArr</a></span><span class=c_cmmt>&nbsp;arr&nbsp;--&nbsp;dumps&nbsp;the&nbsp;array&nbsp;content&nbsp;/&nbsp;under&nbsp;construction</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;arr&nbsp;[in]&nbsp;&nbsp;-&nbsp;array&nbsp;name</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219&nbsp;:$categories&nbsp;Array</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL</span><br>
<span style='color=#000000'>call&nbsp;set&nbsp;i=%<span class=c_pvar>%%~1</span>[#]%%</span><br>
<span style='color=#000000'>for&nbsp;/l&nbsp;<span class=c_pvar>%%n</span>&nbsp;in&nbsp;(1,1,%i%)&nbsp;do&nbsp;call&nbsp;echo.&quot;%<span class=c_pvar>%%~1</span>[<span class=c_pvar>%%n</span>]<span class=c_pvar>%~2</span>%%&quot;</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.echo'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:echo - echoes text in a specific color</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#echo'>:echo</a> col txt </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Dependencies:</td>
      <td class='text'  VALIGN='top'> <a href="#getColorCode">:getColorCode</a></td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br><a name='13'>13.</a><br><a name='14'>14.</a><br><a name='15'>15.</a><br><a name='16'>16.</a><br><a name='17'>17.</a><br><a name='18'>18.</a><br><a name='19'>19.</a><br><a name='20'>20.</a><br><a name='21'>21.</a><br><a name='22'>22.</a><br><a name='23'>23.</a><br><a name='24'>24.</a><br><a name='25'>25.</a><br><a name='26'>26.</a><br><a name='27'>27.</a><br><a name='28'>28.</a><br><a name='29'>29.</a><br><a name='30'>30.</a><br><a name='31'>31.</a><br><a name='32'>32.</a><br><a name='33'>33.</a><br><a name='34'>34.</a><br><a name='35'>35.</a><br><a name='36'>36.</a><br><a name='37'>37.</a><br><a name='38'>38.</a><br><a name='39'>39.</a><br><a name='40'>40.</a><br><a name='41'>41.</a><br><a name='42'>42.</a><br><a name='43'>43.</a><br><a name='44'>44.</a><br><a name='45'>45.</a><br><a name='46'>46.</a><br><a name='47'>47.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='echo'>:echo</a></span><span class=c_cmmt>&nbsp;col&nbsp;txt&nbsp;--&nbsp;echoes&nbsp;text&nbsp;in&nbsp;a&nbsp;specific&nbsp;color</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;col&nbsp;[in]&nbsp;&nbsp;-&nbsp;color&nbsp;code,&nbsp;append&nbsp;a&nbsp;DOT&nbsp;to&nbsp;omit&nbsp;line&nbsp;break,&nbsp;call&nbsp;'color&nbsp;/?'&nbsp;for&nbsp;color&nbsp;codes</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;txt&nbsp;[in]&nbsp;&nbsp;-&nbsp;text&nbsp;output</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219&nbsp;:$categories&nbsp;Echo,Color</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL</span><br>
<span style='color=#000000'>for&nbsp;/f&nbsp;&quot;tokens=1,*&quot;&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;(&quot;%*&quot;)&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;col=<span class=c_pvar>%%a</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;txt=<span class=c_pvar>%%~b</span></span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>set&nbsp;cr=Y</span><br>
<span style='color=#000000'>if&nbsp;&quot;%col:~-1%&quot;==&quot;.&quot;&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;cr=N</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;col=%col:~0,-1%</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>call:getColorCode&nbsp;&quot;%col%&quot;&nbsp;col</span><br>
<span style='color=#000000'>set&nbsp;com=%temp%.\color%col%.com</span><br>
<span style='color=#000000'>if&nbsp;not&nbsp;exist&nbsp;&quot;%com%&quot;&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;echo.N&nbsp;%COM%</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;echo.A&nbsp;100</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;echo.MOV&nbsp;BL,%col%</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;echo.MOV&nbsp;BH,0</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;echo.MOV&nbsp;SI,0082</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;echo.MOV&nbsp;AL,[SI]</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;echo.MOV&nbsp;CX,1</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;echo.MOV&nbsp;AH,09</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;echo.INT&nbsp;10</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;echo.MOV&nbsp;AH,3</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;echo.INT&nbsp;10</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;echo.INC&nbsp;DL</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;echo.MOV&nbsp;AH,2</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;echo.INT&nbsp;10</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;echo.INC&nbsp;SI</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;echo.MOV&nbsp;AL,[SI]</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;echo.CMP&nbsp;AL,0D</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;echo.JNZ&nbsp;109</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;echo.RET</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;echo.</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;echo.r&nbsp;cx</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;echo.22</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;echo.w</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;echo.q</span><br>
<span style='color=#000000'>)|debug&gt;NUL</span><br>
<span style='color=#000000'>&quot;%com%&quot;&nbsp;%txt%</span><br>
<span style='color=#000000'><span class=c_cmmt>rem&nbsp;del&nbsp;&quot;%com%&quot;&nbsp;/q</span></span><br>
<span style='color=#000000'>if&nbsp;&quot;%cr%&quot;==&quot;Y&quot;&nbsp;echo.</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.echoLine'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-05-12</font></font></div>
    <H2>:echoLine - outputs a formatted string, substitutes file name and line number</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#echoLine'>:echoLine</a> uniqueStr formatter offset </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br><a name='13'>13.</a><br><a name='14'>14.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='echoLine'>:echoLine</a></span><span class=c_cmmt>&nbsp;uniqueStr&nbsp;formatter&nbsp;offset&nbsp;--&nbsp;outputs&nbsp;a&nbsp;formatted&nbsp;string,&nbsp;substitutes&nbsp;file&nbsp;name&nbsp;and&nbsp;line&nbsp;number</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;uniqueStr&nbsp;[in]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;a&nbsp;unique&nbsp;string&nbsp;to&nbsp;identify&nbsp;the&nbsp;line</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;formatter&nbsp;[in,opt]&nbsp;-&nbsp;a&nbsp;string&nbsp;using&nbsp;__FILE__&nbsp;and/or&nbsp;__LINE__&nbsp;to&nbsp;be&nbsp;substituted&nbsp;and&nbsp;echoed</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;offset&nbsp;&nbsp;&nbsp;&nbsp;[in,opt]&nbsp;-&nbsp;offset&nbsp;to&nbsp;be&nbsp;added&nbsp;to&nbsp;the&nbsp;line&nbsp;number</span></span><br>
<span style='color=#000000'>:$reference&nbsp;https://www.dostips.com/forum/viewtopic.php?t=369</span><br>
<span style='color=#000000'>:$created&nbsp;20080512&nbsp;:$changed&nbsp;20080512&nbsp;:$categories&nbsp;Echo,Debug</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>Setlocal&nbsp;Disabledelayedexpansion</span><br>
<span style='color=#000000'>Set&nbsp;&quot;Fmt=<span class=c_pvar>%~2</span>&quot;</span><br>
<span style='color=#000000'>If&nbsp;Not&nbsp;Defined&nbsp;Fmt&nbsp;Set&nbsp;&quot;Fmt=__FILE__(__LINE__):&nbsp;ERROR&quot;</span><br>
<span style='color=#000000'>For&nbsp;/F&nbsp;&quot;Delims=:&quot;&nbsp;<span class=c_pvar>%%A</span>&nbsp;In&nbsp;('&quot;Findstr&nbsp;/N&nbsp;&quot;<span class=c_pvar>%~1</span>&quot;&nbsp;&quot;<span class=c_pvar>%~f0</span>&quot;&quot;')&nbsp;Do&nbsp;Set&nbsp;/A&nbsp;&quot;lineNr=<span class=c_pvar>%%A</span>+<span class=c_pvar>%~30</span>/10&quot;</span><br>
<span style='color=#000000'>Call&nbsp;Set&nbsp;&quot;Fmt=<span class=c_pvar>%%F</span>mt:__LINE__=%lineNr%%%&quot;</span><br>
<span style='color=#000000'>Call&nbsp;Echo.<span class=c_pvar>%%F</span>mt:__FILE__=<span class=c_pvar>%~nx0</span>%%</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.extractFileSection'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2010-02-05</font></font></div>
    <H2>:extractFileSection - extracts a section of file that is defined by a start and end mark</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#extractFileSection'>:extractFileSection</a> StartMark EndMark FileName </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br><a name='13'>13.</a><br><a name='14'>14.</a><br><a name='15'>15.</a><br><a name='16'>16.</a><br><a name='17'>17.</a><br><a name='18'>18.</a><br><a name='19'>19.</a><br><a name='20'>20.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='extractFileSection'>:extractFileSection</a></span><span class=c_cmmt>&nbsp;StartMark&nbsp;EndMark&nbsp;FileName&nbsp;--&nbsp;extracts&nbsp;a&nbsp;section&nbsp;of&nbsp;file&nbsp;that&nbsp;is&nbsp;defined&nbsp;by&nbsp;a&nbsp;start&nbsp;and&nbsp;end&nbsp;mark</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;[IN]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;StartMark&nbsp;-&nbsp;start&nbsp;mark,&nbsp;use&nbsp;'...:S'&nbsp;mark&nbsp;to&nbsp;allow&nbsp;variable&nbsp;substitution</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;[IN,OPT]&nbsp;EndMark&nbsp;&nbsp;&nbsp;-&nbsp;optional&nbsp;end&nbsp;mark,&nbsp;default&nbsp;is&nbsp;first&nbsp;empty&nbsp;line</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;[IN,OPT]&nbsp;FileName&nbsp;&nbsp;-&nbsp;optional&nbsp;source&nbsp;file,&nbsp;default&nbsp;is&nbsp;THIS&nbsp;file</span></span><br>
<span style='color=#000000'>:$created&nbsp;20080219&nbsp;:$changed&nbsp;20100205&nbsp;:$categories&nbsp;FileOperation</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL&nbsp;Disabledelayedexpansion</span><br>
<span style='color=#000000'>set&nbsp;&quot;bmk=<span class=c_pvar>%~1</span>&quot;</span><br>
<span style='color=#000000'>set&nbsp;&quot;emk=<span class=c_pvar>%~2</span>&quot;</span><br>
<span style='color=#000000'>set&nbsp;&quot;src=<span class=c_pvar>%~3</span>&quot;</span><br>
<span style='color=#000000'>set&nbsp;&quot;bExtr=&quot;</span><br>
<span style='color=#000000'>set&nbsp;&quot;bSubs=&quot;</span><br>
<span style='color=#000000'>if&nbsp;&quot;%src%&quot;==&quot;&quot;&nbsp;set&nbsp;src=<span class=c_pvar>%~f0</span>&amp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=c_cmmt>rem&nbsp;if&nbsp;no&nbsp;source&nbsp;file&nbsp;then&nbsp;assume&nbsp;THIS&nbsp;file</span></span><br>
<span style='color=#000000'>for&nbsp;/f&nbsp;&quot;tokens=1,*&nbsp;delims=]&quot;&nbsp;<span class=c_pvar>%%A</span>&nbsp;in&nbsp;('find&nbsp;/n&nbsp;/v&nbsp;&quot;&quot;&nbsp;&quot;%src%&quot;')&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;/i&nbsp;&quot;<span class=c_pvar>%%B</span>&quot;==&quot;%emk%&quot;&nbsp;set&nbsp;&quot;bExtr=&quot;&amp;set&nbsp;&quot;bSubs=&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;defined&nbsp;bExtr&nbsp;if&nbsp;defined&nbsp;bSubs&nbsp;(call&nbsp;echo.<span class=c_pvar>%%B</span>)&nbsp;ELSE&nbsp;(echo.<span class=c_pvar>%%B</span>)</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;/i&nbsp;&quot;<span class=c_pvar>%%B</span>&quot;==&quot;%bmk%&quot;&nbsp;&nbsp;&nbsp;set&nbsp;&quot;bExtr=Y&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;/i&nbsp;&quot;<span class=c_pvar>%%B</span>&quot;==&quot;%bmk%:S&quot;&nbsp;set&nbsp;&quot;bExtr=Y&quot;&amp;set&nbsp;&quot;bSubs=Y&quot;</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.ExtractFunction'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:ExtractFunction - extracts a function by label</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#ExtractFunction'>:ExtractFunction</a> func </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br><a name='13'>13.</a><br><a name='14'>14.</a><br><a name='15'>15.</a><br><a name='16'>16.</a><br><a name='17'>17.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='ExtractFunction'>:ExtractFunction</a></span><span class=c_cmmt>&nbsp;func&nbsp;--&nbsp;extracts&nbsp;a&nbsp;function&nbsp;by&nbsp;label</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;func&nbsp;[in]&nbsp;-&nbsp;name&nbsp;of&nbsp;the&nbsp;function&nbsp;to&nbsp;be&nbsp;extracted</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL&nbsp;ENABLEDELAYEDEXPANSION</span><br>
<span style='color=#000000'>set&nbsp;func=<span class=c_pvar>%~f0</span></span><br>
<span style='color=#000000'>set&nbsp;/a&nbsp;b=2000000000</span><br>
<span style='color=#000000'>set&nbsp;/a&nbsp;e=2000000000</span><br>
<span style='color=#000000'>for&nbsp;/f&nbsp;&quot;tokens=1,*&nbsp;delims=:&quot;&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;('&quot;findstr&nbsp;/n&nbsp;/b&nbsp;/c:&quot;<span class=c_pvar>%~1</span>&nbsp;&quot;&nbsp;&quot;%func%&quot;&quot;')&nbsp;do&nbsp;set&nbsp;/a&nbsp;b=<span class=c_pvar>%%a</span></span><br>
<span style='color=#000000'>for&nbsp;/f&nbsp;&quot;tokens=1,*&nbsp;delims=:&quot;&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;('&quot;findstr&nbsp;/n&nbsp;/b&nbsp;/c:&quot;EXIT&nbsp;/b&quot;&nbsp;&quot;%func%&quot;&quot;')&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;/i&nbsp;%b%&nbsp;LSS&nbsp;<span class=c_pvar>%%a</span>&nbsp;if&nbsp;/i&nbsp;<span class=c_pvar>%%a</span>&nbsp;LSS&nbsp;!e!&nbsp;set&nbsp;/a&nbsp;e=<span class=c_pvar>%%a</span></span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>SETLOCAL&nbsp;DISABLEDELAYEDEXPANSION&amp;&nbsp;&nbsp;<span class=c_cmmt>rem&nbsp;--disabling&nbsp;preserves&nbsp;excamation&nbsp;marks&nbsp;in&nbsp;<span class=c_pvar>%%b</span></span></span><br>
<span style='color=#000000'>for&nbsp;/f&nbsp;&quot;tokens=1,*&nbsp;delims=[]&quot;&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;('&quot;find&nbsp;/n&nbsp;/v&nbsp;&quot;&quot;&nbsp;&quot;%func%&quot;&quot;')&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;/i&nbsp;%b%&nbsp;LEQ&nbsp;<span class=c_pvar>%%a</span>&nbsp;if&nbsp;/i&nbsp;<span class=c_pvar>%%a</span>&nbsp;LEQ&nbsp;%e%&nbsp;echo.<span class=c_pvar>%%b</span></span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.ExtractSimple'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2009-11-13</font></font></div>
    <H2>:ExtractSimple - extracts a marked section from batch file, sustitutes variables during extraction</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#ExtractSimple'>:ExtractSimple</a> StartMark EndMark </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br><a name='13'>13.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='ExtractSimple'>:ExtractSimple</a></span><span class=c_cmmt>&nbsp;StartMark&nbsp;EndMark&nbsp;--&nbsp;extracts&nbsp;a&nbsp;marked&nbsp;section&nbsp;from&nbsp;batch&nbsp;file,&nbsp;sustitutes&nbsp;variables&nbsp;during&nbsp;extraction</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;[IN]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;StartMark&nbsp;-&nbsp;start&nbsp;mark</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;[IN,OPT]&nbsp;EndMark&nbsp;&nbsp;&nbsp;-&nbsp;optional&nbsp;end&nbsp;mark,&nbsp;default&nbsp;is&nbsp;first&nbsp;empty&nbsp;line</span></span><br>
<span style='color=#000000'>:$created&nbsp;20091113&nbsp;:$changed&nbsp;20091113&nbsp;:$categories&nbsp;FileOperation</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL</span><br>
<span style='color=#000000'>set&nbsp;&quot;cpy=&quot;</span><br>
<span style='color=#000000'>for&nbsp;/f&nbsp;&quot;tokens=1*&nbsp;delims=]&quot;&nbsp;<span class=c_pvar>%%A</span>&nbsp;in&nbsp;('find&nbsp;/v&nbsp;/n&nbsp;&quot;&quot;&nbsp;&quot;<span class=c_pvar>%~f0</span>&quot;')&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&quot;<span class=c_pvar>%%B</span>&quot;==&quot;<span class=c_pvar>%~1</span>&quot;&nbsp;set&nbsp;&quot;cpy=Y&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&quot;<span class=c_pvar>%%B</span>&quot;==&quot;<span class=c_pvar>%~2</span>&quot;&nbsp;set&nbsp;&quot;cpy=&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;defined&nbsp;cpy&nbsp;call&nbsp;echo.<span class=c_pvar>%%B</span></span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.false'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:false - returns failure</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#false'>:false</a> </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='false'>:false</a></span><span class=c_cmmt>&nbsp;--&nbsp;returns&nbsp;failure</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>set=2&gt;NUL</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.Format'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2009-11-30</font></font></div>
    <H2>:Format - outputs columns of strings right or left aligned</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#Format'>:Format</a> fmt str1 str2 ... </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br><a name='13'>13.</a><br><a name='14'>14.</a><br><a name='15'>15.</a><br><a name='16'>16.</a><br><a name='17'>17.</a><br><a name='18'>18.</a><br><a name='19'>19.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='Format'>:Format</a></span><span class=c_cmmt>&nbsp;fmt&nbsp;str1&nbsp;str2&nbsp;...&nbsp;--&nbsp;outputs&nbsp;columns&nbsp;of&nbsp;strings&nbsp;right&nbsp;or&nbsp;left&nbsp;aligned</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;fmt&nbsp;[in]&nbsp;-&nbsp;format&nbsp;string&nbsp;specifying&nbsp;column&nbsp;width&nbsp;and&nbsp;alignment,&nbsp;i.e.&nbsp;&quot;[-10][10][10]&quot;</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20091130&nbsp;:$categories&nbsp;Echo</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL</span><br>
<span style='color=#000000'>set&nbsp;&quot;fmt=<span class=c_pvar>%~1</span>&quot;</span><br>
<span style='color=#000000'>set&nbsp;&quot;line=&quot;</span><br>
<span style='color=#000000'>set&nbsp;&quot;spac=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;</span><br>
<span style='color=#000000'>set&nbsp;&quot;i=1&quot;</span><br>
<span style='color=#000000'>for&nbsp;/f&nbsp;&quot;tokens=1,2&nbsp;delims=[&quot;&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;('&quot;echo..%fmt:]=&amp;echo..%&quot;')&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;/a&nbsp;i+=1</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;call&nbsp;set&nbsp;&quot;subst=%%<span class=c_pvar>%%~%%</span>i%<span class=c_pvar>%%s</span>pac%%%<span class=c_pvar>%%~%%</span>i%%&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;<span class=c_pvar>%%b</span>0&nbsp;GEQ&nbsp;0&nbsp;(call&nbsp;set&nbsp;&quot;subst=<span class=c_pvar>%%s</span>ubst:~0,<span class=c_pvar>%%b</span>%%&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;ELSE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(call&nbsp;set&nbsp;&quot;subst=<span class=c_pvar>%%s</span>ubst:~<span class=c_pvar>%%b</span>%%&quot;)</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;set&nbsp;&quot;const=<span class=c_pvar>%%a</span>&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;set&nbsp;&quot;line=<span class=c_pvar>%%l</span>ine%%<span class=c_pvar>%%c</span>onst:~1%%<span class=c_pvar>%%s</span>ubst%%&quot;</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>echo.%line%</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.fprop'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:fprop - returns a file property</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#fprop'>:fprop</a> filename prop ret </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br><a name='13'>13.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='fprop'>:fprop</a></span><span class=c_cmmt>&nbsp;filename&nbsp;prop&nbsp;ret&nbsp;--&nbsp;returns&nbsp;a&nbsp;file&nbsp;property</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;filename&nbsp;&nbsp;[in]&nbsp;&nbsp;-&nbsp;file&nbsp;name</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;prop&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[in]&nbsp;&nbsp;-&nbsp;property,&nbsp;i.e.:&nbsp;d&nbsp;p&nbsp;n&nbsp;x&nbsp;a&nbsp;f&nbsp;s&nbsp;t&nbsp;z</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;ret&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[out]&nbsp;-&nbsp;return&nbsp;value</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219&nbsp;:$categories&nbsp;FileInfo</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL</span><br>
<span style='color=#000000'>set&nbsp;ret=</span><br>
<span style='color=#000000'>for&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;(&quot;<span class=c_pvar>%~1</span>&quot;)&nbsp;do&nbsp;set&nbsp;ret=<span class=c_pvar>%%~%~</span>2a</span><br>
<span style='color=#000000'>(&nbsp;ENDLOCAL&nbsp;&amp;&nbsp;<span class=c_cmmt>REM&nbsp;RETURN&nbsp;VALUES</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&quot;<span class=c_pvar>%~3</span>&quot;&nbsp;NEQ&nbsp;&quot;&quot;&nbsp;(SET&nbsp;<span class=c_pvar>%~3</span>=%ret%)&nbsp;ELSE&nbsp;echo.%ret%</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.ftime'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2009-03-22</font></font></div>
    <H2>:ftime - returns the file time in julian days</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#ftime'>:ftime</a> JD filename attr </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Dependencies:</td>
      <td class='text'  VALIGN='top'> <a href="#jdate">:jdate</a></td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br><a name='13'>13.</a><br><a name='14'>14.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='ftime'>:ftime</a></span><span class=c_cmmt>&nbsp;JD&nbsp;filename&nbsp;attr&nbsp;--&nbsp;returns&nbsp;the&nbsp;file&nbsp;time&nbsp;in&nbsp;julian&nbsp;days</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;JD&nbsp;&nbsp;&nbsp;&nbsp;[out]&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;valref&nbsp;file&nbsp;time&nbsp;in&nbsp;julian&nbsp;days</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;attr&nbsp;&nbsp;[in,opt]&nbsp;-&nbsp;time&nbsp;field&nbsp;to&nbsp;be&nbsp;used,&nbsp;creation/last-access/last-write,&nbsp;see&nbsp;'dir&nbsp;/?',&nbsp;i.e.&nbsp;/tc,&nbsp;/ta,&nbsp;/tw,&nbsp;default&nbsp;is&nbsp;/tw</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20090322&nbsp;:$categories&nbsp;DateAndTime</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL</span><br>
<span style='color=#000000'>set&nbsp;file=<span class=c_pvar>%~2</span></span><br>
<span style='color=#000000'>set&nbsp;attr=<span class=c_pvar>%~3</span></span><br>
<span style='color=#000000'>if&nbsp;not&nbsp;defined&nbsp;attr&nbsp;(call:jdate&nbsp;JD&nbsp;&quot;-&nbsp;<span class=c_pvar>%~t2</span>&quot;</span><br>
<span style='color=#000000'>)&nbsp;ELSE&nbsp;(for&nbsp;/f&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;('&quot;dir&nbsp;%attr%&nbsp;/-c&nbsp;&quot;%file%&quot;|findstr&nbsp;&quot;^^[0-9]&quot;&quot;')&nbsp;do&nbsp;call:jdate&nbsp;JD&nbsp;&quot;<span class=c_pvar>%%a</span>&quot;)</span><br>
<span style='color=#000000'>(&nbsp;ENDLOCAL&nbsp;&amp;&nbsp;<span class=c_cmmt>REM&nbsp;RETURN&nbsp;VALUES</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&quot;<span class=c_pvar>%~1</span>&quot;&nbsp;NEQ&nbsp;&quot;&quot;&nbsp;(SET&nbsp;<span class=c_pvar>%~1</span>=%JD%)&nbsp;ELSE&nbsp;(echo.%JD%)</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.getColorCode'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:getColorCode - converts color text to color code</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#getColorCode'>:getColorCode</a> col ret </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br><a name='13'>13.</a><br><a name='14'>14.</a><br><a name='15'>15.</a><br><a name='16'>16.</a><br><a name='17'>17.</a><br><a name='18'>18.</a><br><a name='19'>19.</a><br><a name='20'>20.</a><br><a name='21'>21.</a><br><a name='22'>22.</a><br><a name='23'>23.</a><br><a name='24'>24.</a><br><a name='25'>25.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='getColorCode'>:getColorCode</a></span><span class=c_cmmt>&nbsp;col&nbsp;ret&nbsp;--&nbsp;converts&nbsp;color&nbsp;text&nbsp;to&nbsp;color&nbsp;code</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;col&nbsp;[in]&nbsp;&nbsp;-&nbsp;color&nbsp;text&nbsp;BackgroundForeground,&nbsp;i.e.:&nbsp;BlueLYellow&nbsp;for&nbsp;1E</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;ret&nbsp;[out]&nbsp;-&nbsp;return&nbsp;variable&nbsp;to&nbsp;return&nbsp;color&nbsp;code&nbsp;in</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219&nbsp;:$categories&nbsp;Color,Echo</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL</span><br>
<span style='color=#000000'>set&nbsp;col=<span class=c_pvar>%~1</span></span><br>
<span style='color=#000000'>set&nbsp;col=%col:Gray=8%</span><br>
<span style='color=#000000'>set&nbsp;col=%col:LBlue=9%</span><br>
<span style='color=#000000'>set&nbsp;col=%col:LGreen=A%</span><br>
<span style='color=#000000'>set&nbsp;col=%col:LAqua=B%</span><br>
<span style='color=#000000'>set&nbsp;col=%col:LRed=C%</span><br>
<span style='color=#000000'>set&nbsp;col=%col:LPurple=D%</span><br>
<span style='color=#000000'>set&nbsp;col=%col:LYellow=E%</span><br>
<span style='color=#000000'>set&nbsp;col=%col:LWhite=F%</span><br>
<span style='color=#000000'>set&nbsp;col=%col:Black=0%</span><br>
<span style='color=#000000'>set&nbsp;col=%col:Blue=1%</span><br>
<span style='color=#000000'>set&nbsp;col=%col:Green=2%</span><br>
<span style='color=#000000'>set&nbsp;col=%col:Aqua=3%</span><br>
<span style='color=#000000'>set&nbsp;col=%col:Red=4%</span><br>
<span style='color=#000000'>set&nbsp;col=%col:Purple=5%</span><br>
<span style='color=#000000'>set&nbsp;col=%col:Yellow=6%</span><br>
<span style='color=#000000'>set&nbsp;col=%col:White=7%</span><br>
<span style='color=#000000'>ENDLOCAL&nbsp;&amp;&nbsp;IF&nbsp;&quot;<span class=c_pvar>%~2</span>&quot;&nbsp;NEQ&nbsp;&quot;&quot;&nbsp;(SET&nbsp;<span class=c_pvar>%~2</span>=%col%)&nbsp;ELSE&nbsp;(echo.%col%)</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.getDriveInfo'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2009-11-15</font></font></div>
    <H2>:getDriveInfo - returns array of fsutil drive information</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#getDriveInfo'>:getDriveInfo</a> var </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br><a name='13'>13.</a><br><a name='14'>14.</a><br><a name='15'>15.</a><br><a name='16'>16.</a><br><a name='17'>17.</a><br><a name='18'>18.</a><br><a name='19'>19.</a><br><a name='20'>20.</a><br><a name='21'>21.</a><br><a name='22'>22.</a><br><a name='23'>23.</a><br><a name='24'>24.</a><br><a name='25'>25.</a><br><a name='26'>26.</a><br><a name='27'>27.</a><br><a name='28'>28.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='getDriveInfo'>:getDriveInfo</a></span><span class=c_cmmt>&nbsp;var&nbsp;--&nbsp;returns&nbsp;array&nbsp;of&nbsp;fsutil&nbsp;drive&nbsp;information</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;var&nbsp;[out]&nbsp;-&nbsp;return&nbsp;variable,&nbsp;as&nbsp;array</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20091115&nbsp;:$categories&nbsp;DriveInfo,Array</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>if&nbsp;&quot;<span class=c_pvar>%~1</span>&quot;&nbsp;NEQ&nbsp;&quot;&quot;&nbsp;for&nbsp;/f&nbsp;&quot;delims==&quot;&nbsp;<span class=c_pvar>%%A</span>&nbsp;in&nbsp;('set&nbsp;<span class=c_pvar>%~1</span>[&nbsp;2^&gt;NUL')&nbsp;do&nbsp;@set&nbsp;&quot;<span class=c_pvar>%%A</span>=&quot;</span><br>
<span style='color=#000000'>SETLOCAL&nbsp;ENABLEDELAYEDEXPANSION</span><br>
<span style='color=#000000'>set&nbsp;&quot;data=&quot;</span><br>
<span style='color=#000000'>set&nbsp;/a&nbsp;n=-1</span><br>
<span style='color=#000000'>for&nbsp;/f&nbsp;&quot;tokens=1&nbsp;delims=&quot;&nbsp;<span class=c_pvar>%%A</span>&nbsp;in&nbsp;('fsutil&nbsp;fsinfo&nbsp;drives^|find&nbsp;&quot;\&quot;')&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;&quot;dr=<span class=c_pvar>%%~A</span>&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;&quot;dr=!dr:~-3,-1!&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;/a&nbsp;n+=1</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;&quot;data=!data!&amp;set&nbsp;<span class=c_pvar>%~1</span>[!n!].Drive=!dr!&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;/f&nbsp;&quot;tokens=1,*&nbsp;delims=-&nbsp;&quot;&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;('&quot;fsutil&nbsp;fsinfo&nbsp;drivetype&nbsp;!dr!&quot;')&nbsp;do&nbsp;set&nbsp;&quot;data=!data!&amp;set&nbsp;<span class=c_pvar>%~1</span>[!n!].DriveType=<span class=c_pvar>%%b</span>&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;/f&nbsp;&quot;tokens=1,*&nbsp;delims=:&quot;&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;('&quot;fsutil&nbsp;volume&nbsp;diskfree&nbsp;!dr!&quot;')&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;&quot;v=&nbsp;<span class=c_pvar>%%a</span>&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;&quot;v=!v:&nbsp;=!&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;&quot;d=&nbsp;<span class=c_pvar>%%b</span>&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;&quot;d=!d:~2!&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;&quot;data=!data!&amp;set&nbsp;<span class=c_pvar>%~1</span>[!n!].!v!=!d!&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;)</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>set&nbsp;&quot;data=<span class=c_cmmt>rem.%data:)=^)%&quot;</span></span><br>
<span style='color=#000000'>(&nbsp;ENDLOCAL&nbsp;&amp;&nbsp;<span class=c_cmmt>REM&nbsp;RETURN&nbsp;VALUES</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;%data%</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;&quot;<span class=c_pvar>%~1</span>[#]=%n%&quot;</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.getDrives'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2009-11-15</font></font></div>
    <H2>:getDrives - This function has been replaced by :getDriveInfo</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#getDrives'>:getDrives</a> var </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Dependencies:</td>
      <td class='text'  VALIGN='top'> <a href="#getDriveInfo">:getDriveInfo</a></td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='getDrives'>:getDrives</a></span><span class=c_cmmt>&nbsp;var&nbsp;--&nbsp;This&nbsp;function&nbsp;has&nbsp;been&nbsp;replaced&nbsp;by&nbsp;:getDriveInfo</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20091115</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>call:getDriveInfo&nbsp;<span class=c_pvar>%~1</span></span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.getFunctions'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:getFunctions - returns a comma separated list of all functions</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#getFunctions'>:getFunctions</a> ret </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='getFunctions'>:getFunctions</a></span><span class=c_cmmt>&nbsp;ret&nbsp;--&nbsp;returns&nbsp;a&nbsp;comma&nbsp;separated&nbsp;list&nbsp;of&nbsp;all&nbsp;functions</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;ret&nbsp;[out]&nbsp;-&nbsp;reference&nbsp;to&nbsp;return&nbsp;variable</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL</span><br>
<span style='color=#000000'>set&nbsp;ret=</span><br>
<span style='color=#000000'>for&nbsp;/f&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;('&quot;findstr&nbsp;&quot;^^:[a-z].*--&quot;&nbsp;&quot;<span class=c_pvar>%~f0</span>&quot;&nbsp;&quot;')&nbsp;do&nbsp;call&nbsp;set&nbsp;ret=<span class=c_pvar>%%r</span>et%%<span class=c_pvar>%%a</span>,</span><br>
<span style='color=#000000'>(&nbsp;ENDLOCAL&nbsp;&amp;&nbsp;<span class=c_cmmt>REM&nbsp;RETURN&nbsp;VALUES</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&quot;<span class=c_pvar>%~1</span>&quot;&nbsp;NEQ&nbsp;&quot;&quot;&nbsp;(SET&nbsp;<span class=c_pvar>%~1</span>=%ret%)&nbsp;ELSE&nbsp;ECHO.%ret%</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.getHostName'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:getHostName - resolves IP address to computer name</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#getHostName'>:getHostName</a> ip ret </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Dependencies:</td>
      <td class='text'  VALIGN='top'> <a href="#getIP">:getIP</a></td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='getHostName'>:getHostName</a></span><span class=c_cmmt>&nbsp;ip&nbsp;ret&nbsp;--&nbsp;resolves&nbsp;IP&nbsp;address&nbsp;to&nbsp;computer&nbsp;name</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;ip&nbsp;&nbsp;[in,opt]&nbsp;&nbsp;-&nbsp;ip,&nbsp;default&nbsp;is&nbsp;THIS&nbsp;computer's&nbsp;IP</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;ret&nbsp;[out,opt]&nbsp;-&nbsp;computer&nbsp;name</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219&nbsp;:$categories&nbsp;Network</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL</span><br>
<span style='color=#000000'>set&nbsp;ip=<span class=c_pvar>%~1</span></span><br>
<span style='color=#000000'>if&nbsp;&quot;%ip%&quot;==&quot;&quot;&nbsp;call:getIP&nbsp;&quot;&quot;&nbsp;ip</span><br>
<span style='color=#000000'>set&nbsp;name=</span><br>
<span style='color=#000000'>for&nbsp;/f&nbsp;&quot;tokens=2&quot;&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;('&quot;ping&nbsp;/a&nbsp;/n&nbsp;1&nbsp;%ip%|find&nbsp;&quot;Pinging&quot;&nbsp;2&gt;NUL&quot;')&nbsp;do&nbsp;set&nbsp;name=<span class=c_pvar>%%a</span></span><br>
<span style='color=#000000'>ENDLOCAL&nbsp;&amp;&nbsp;IF&nbsp;&quot;<span class=c_pvar>%~2</span>&quot;&nbsp;NEQ&nbsp;&quot;&quot;&nbsp;(SET&nbsp;<span class=c_pvar>%~2</span>=%name%)&nbsp;ELSE&nbsp;(echo.%name%)</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.getIP'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:getIP - return THIS computers IP address</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#getIP'>:getIP</a> host ret </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='getIP'>:getIP</a></span><span class=c_cmmt>&nbsp;host&nbsp;ret&nbsp;--&nbsp;return&nbsp;THIS&nbsp;computers&nbsp;IP&nbsp;address</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;host&nbsp;[in,opt]&nbsp;&nbsp;-&nbsp;host&nbsp;name,&nbsp;default&nbsp;is&nbsp;THIS&nbsp;computer</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;ret&nbsp;&nbsp;[out,opt]&nbsp;-&nbsp;IP</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219&nbsp;:$categories&nbsp;Network</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL</span><br>
<span style='color=#000000'>set&nbsp;host=<span class=c_pvar>%~1</span></span><br>
<span style='color=#000000'>set&nbsp;ip=</span><br>
<span style='color=#000000'>if&nbsp;&quot;%host%&quot;==&quot;&quot;&nbsp;(&nbsp;for&nbsp;/f&nbsp;&quot;tokens=2,*&nbsp;delims=:.&nbsp;&quot;&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;('&quot;ipconfig|find&nbsp;&quot;IP&nbsp;Address&quot;&quot;')&nbsp;do&nbsp;set&nbsp;ip=<span class=c_pvar>%%b</span></span><br>
<span style='color=#000000'>)&nbsp;ELSE&nbsp;(&nbsp;for&nbsp;/f&nbsp;&quot;tokens=2&nbsp;delims=[]&quot;&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;('&quot;ping&nbsp;/a&nbsp;/n&nbsp;1&nbsp;%host%|find&nbsp;&quot;Pinging&quot;&nbsp;2&gt;NUL&quot;')&nbsp;do&nbsp;set&nbsp;ip=<span class=c_pvar>%%a</span>)</span><br>
<span style='color=#000000'>ENDLOCAL&nbsp;&amp;&nbsp;IF&nbsp;&quot;<span class=c_pvar>%~2</span>&quot;&nbsp;NEQ&nbsp;&quot;&quot;&nbsp;(SET&nbsp;<span class=c_pvar>%~2</span>=%ip%)&nbsp;ELSE&nbsp;(echo.%ip%)</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.getIPConfig'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2009-11-11</font></font></div>
    <H2>:getIPConfig - return IPCONFIG /ALL data in array variable</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#getIPConfig'>:getIPConfig</a> arr </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br><a name='13'>13.</a><br><a name='14'>14.</a><br><a name='15'>15.</a><br><a name='16'>16.</a><br><a name='17'>17.</a><br><a name='18'>18.</a><br><a name='19'>19.</a><br><a name='20'>20.</a><br><a name='21'>21.</a><br><a name='22'>22.</a><br><a name='23'>23.</a><br><a name='24'>24.</a><br><a name='25'>25.</a><br><a name='26'>26.</a><br><a name='27'>27.</a><br><a name='28'>28.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='getIPConfig'>:getIPConfig</a></span><span class=c_cmmt>&nbsp;arr&nbsp;--&nbsp;return&nbsp;IPCONFIG&nbsp;/ALL&nbsp;data&nbsp;in&nbsp;array&nbsp;variable</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;arr&nbsp;[out]&nbsp;-&nbsp;target&nbsp;array&nbsp;variable&nbsp;for&nbsp;IPCONFIG&nbsp;data</span></span><br>
<span style='color=#000000'>:$created&nbsp;20091111&nbsp;:$changed&nbsp;20091111&nbsp;:$categories&nbsp;Network,Array</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>if&nbsp;&quot;<span class=c_pvar>%~1</span>&quot;&nbsp;NEQ&nbsp;&quot;&quot;&nbsp;for&nbsp;/f&nbsp;&quot;delims==&quot;&nbsp;<span class=c_pvar>%%A</span>&nbsp;in&nbsp;('set&nbsp;<span class=c_pvar>%~1</span>[&nbsp;2^&gt;NUL')&nbsp;do&nbsp;@set&nbsp;&quot;<span class=c_pvar>%%A</span>=&quot;</span><br>
<span style='color=#000000'>SETLOCAL&nbsp;ENABLEDELAYEDEXPANSION</span><br>
<span style='color=#000000'>set&nbsp;&quot;data=&quot;</span><br>
<span style='color=#000000'>set&nbsp;/a&nbsp;n=0</span><br>
<span style='color=#000000'>for&nbsp;/f&nbsp;&quot;tokens=1,*&nbsp;delims=:&quot;&nbsp;<span class=c_pvar>%%A</span>&nbsp;in&nbsp;('ipconfig&nbsp;/all^|find&nbsp;&quot;:&quot;')&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;&quot;v=<span class=c_pvar>%%~A</span>&nbsp;&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&quot;!v:~0,8!&quot;&nbsp;NEQ&nbsp;&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=c_cmmt>rem&nbsp;it's&nbsp;a&nbsp;new&nbsp;section</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;/a&nbsp;n+=1</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;&quot;data=!data!&amp;set&nbsp;<span class=c_pvar>%~1</span>[!n!].DisplayName=<span class=c_pvar>%%A</span>&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;ELSE&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;&quot;v=!v:~8!&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;&quot;v=!v:.=!&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;&quot;v=!v:&nbsp;=!&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;&quot;x=<span class=c_pvar>%%~B</span>&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;&quot;data=!data!&amp;set&nbsp;<span class=c_pvar>%~1</span>[!n!].!v!=!x:~1!&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;)</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>set&nbsp;&quot;data=<span class=c_cmmt>rem.%data:)=^)%&quot;</span></span><br>
<span style='color=#000000'>(&nbsp;ENDLOCAL&nbsp;&amp;&nbsp;<span class=c_cmmt>REM&nbsp;RETURN&nbsp;VALUES</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;%data%</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;&quot;<span class=c_pvar>%~1</span>[#]=%n%&quot;</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.getNextInList'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2009-05-31</font></font></div>
    <H2>:getNextInList - return next value in list</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#getNextInList'>:getNextInList</a> current list </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br><a name='13'>13.</a><br><a name='14'>14.</a><br><a name='15'>15.</a><br><a name='16'>16.</a><br><a name='17'>17.</a><br><a name='18'>18.</a><br><a name='19'>19.</a><br><a name='20'>20.</a><br><a name='21'>21.</a><br><a name='22'>22.</a><br><a name='23'>23.</a><br><a name='24'>24.</a><br><a name='25'>25.</a><br><a name='26'>26.</a><br><a name='27'>27.</a><br><a name='28'>28.</a><br><a name='29'>29.</a><br><a name='30'>30.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='getNextInList'>:getNextInList</a></span><span class=c_cmmt>&nbsp;current&nbsp;list&nbsp;--&nbsp;return&nbsp;next&nbsp;value&nbsp;in&nbsp;list</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;current&nbsp;[in,out]&nbsp;-&nbsp;iterator&nbsp;variable&nbsp;holding&nbsp;the&nbsp;current&nbsp;value&nbsp;to&nbsp;be&nbsp;replaced&nbsp;with&nbsp;the&nbsp;next&nbsp;value</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;list&nbsp;&nbsp;&nbsp;&nbsp;[in]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;choice&nbsp;list,&nbsp;must&nbsp;start&nbsp;and&nbsp;end&nbsp;with&nbsp;the&nbsp;delimiter</span></span><br>
<span style='color=#000000'>:$created&nbsp;20091207&nbsp;:$changed&nbsp;20091207&nbsp;:$categories&nbsp;List,Iterate,String</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>Setlocal&nbsp;Enabledelayedexpansion</span><br>
<span style='color=#000000'>set&nbsp;&quot;lst=<span class=c_pvar>%~2</span>&quot;</span><br>
<span style='color=#000000'>set&nbsp;&quot;lst=%lst:~-1<span class=c_pvar>%%l</span>st<span class=c_pvar>%%l</span>st:~1%&quot;</span><br>
<span style='color=#000000'>call&nbsp;set&nbsp;&quot;v=<span class=c_pvar>%%l</span>st:*%lst:~-1%!<span class=c_pvar>%~1</span>!%lst:~-1%=%%&quot;</span><br>
<span style='color=#000000'>set&nbsp;&quot;v=!v:%lst:~-1%=&amp;<span class=c_cmmt>rem.%!&quot;</span></span><br>
<span style='color=#000000'>(&nbsp;ENDLOCAL&nbsp;&amp;&nbsp;<span class=c_cmmt>REM&nbsp;RETURN&nbsp;VALUES</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&quot;<span class=c_pvar>%~1</span>&quot;&nbsp;NEQ&nbsp;&quot;&quot;&nbsp;(SET&nbsp;<span class=c_pvar>%~1</span>=%v%)&nbsp;ELSE&nbsp;(echo.%new%)</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>GOTO:EOF</span><br>
<span style='color=#000000'></span><br>
<span style='color=#000000'></span><br>
<span style='color=#000000'><span class=c_labl><a name='count'>:count</a></span><span class=c_cmmt>&nbsp;needle&nbsp;haystack&nbsp;ret&nbsp;--&nbsp;counts&nbsp;the&nbsp;number&nbsp;of&nbsp;occurrences&nbsp;of&nbsp;needle&nbsp;in&nbsp;haystack</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;needle&nbsp;&nbsp;&nbsp;[in]&nbsp;&nbsp;-&nbsp;string&nbsp;to&nbsp;find</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;haystack&nbsp;[in]&nbsp;&nbsp;-&nbsp;string&nbsp;to&nbsp;search&nbsp;in</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;ret&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[out]&nbsp;-&nbsp;valref&nbsp;for&nbsp;return&nbsp;value</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20090531&nbsp;:$categories&nbsp;String</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL</span><br>
<span style='color=#000000'>set&nbsp;&quot;haystack=<span class=c_pvar>%~2</span>&quot;</span><br>
<span style='color=#000000'>set&nbsp;/a&nbsp;ret=0</span><br>
<span style='color=#000000'>FOR&nbsp;/f&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;('&quot;(echo.<span class=c_pvar>%%h</span>aystack:<span class=c_pvar>%~1</span>=&amp;echo.%%)|find&nbsp;/c&nbsp;/v&nbsp;&quot;&quot;&quot;')&nbsp;DO&nbsp;set&nbsp;/a&nbsp;ret=<span class=c_pvar>%%a</span>-1</span><br>
<span style='color=#000000'>(&nbsp;ENDLOCAL&nbsp;&amp;&nbsp;<span class=c_cmmt>REM&nbsp;RETURN&nbsp;VALUES</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&quot;<span class=c_pvar>%~3</span>&quot;&nbsp;NEQ&nbsp;&quot;&quot;&nbsp;(SET&nbsp;<span class=c_pvar>%~3</span>=%ret%)&nbsp;ELSE&nbsp;ECHO.%ret%</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.getRandomColor'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:getRandomColor - returns a random color</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#getRandomColor'>:getRandomColor</a> ret </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='getRandomColor'>:getRandomColor</a></span><span class=c_cmmt>&nbsp;ret&nbsp;--&nbsp;returns&nbsp;a&nbsp;random&nbsp;color</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;ret&nbsp;[out,opt]&nbsp;-&nbsp;return&nbsp;variable&nbsp;to&nbsp;return&nbsp;color&nbsp;code&nbsp;in</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219&nbsp;:$categories&nbsp;Color</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL</span><br>
<span style='color=#000000'>set&nbsp;HEX=0123456789ABCDEF</span><br>
<span style='color=#000000'>set&nbsp;/a&nbsp;r1=%random%&nbsp;%%&nbsp;16</span><br>
<span style='color=#000000'>set&nbsp;/a&nbsp;r2=%random%&nbsp;%%&nbsp;16</span><br>
<span style='color=#000000'>call&nbsp;set&nbsp;rndcolor=<span class=c_pvar>%%H</span>EX:~%r1%,1%%<span class=c_pvar>%%H</span>EX:~%r2%,1%%</span><br>
<span style='color=#000000'>ENDLOCAL&nbsp;&amp;&nbsp;IF&nbsp;&quot;<span class=c_pvar>%~1</span>&quot;&nbsp;NEQ&nbsp;&quot;&quot;&nbsp;(SET&nbsp;<span class=c_pvar>%~1</span>=%rndcolor%)&nbsp;ELSE&nbsp;(echo.%rndcolor%)</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.GetRegKeys'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2009-11-23</font></font></div>
    <H2>:GetRegKeys - returns all registry syb keys of a given registry key</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#GetRegKeys'>:GetRegKeys</a> Key Data Type </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='GetRegKeys'>:GetRegKeys</a></span><span class=c_cmmt>&nbsp;Key&nbsp;Data&nbsp;Type&nbsp;--&nbsp;returns&nbsp;all&nbsp;registry&nbsp;syb&nbsp;keys&nbsp;of&nbsp;a&nbsp;given&nbsp;registry&nbsp;key</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;Key&nbsp;&nbsp;&nbsp;[in]&nbsp;&nbsp;-&nbsp;registry&nbsp;key</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;Arr&nbsp;&nbsp;&nbsp;[out]&nbsp;-&nbsp;array&nbsp;of&nbsp;sub&nbsp;keys</span></span><br>
<span style='color=#000000'>:$created&nbsp;20091123&nbsp;:$changed&nbsp;20091123&nbsp;:$categories&nbsp;Registry,&nbsp;Array</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>if&nbsp;&quot;<span class=c_pvar>%~2</span>&quot;&nbsp;NEQ&nbsp;&quot;&quot;&nbsp;for&nbsp;/f&nbsp;&quot;delims==&quot;&nbsp;<span class=c_pvar>%%A</span>&nbsp;in&nbsp;('set&nbsp;<span class=c_pvar>%~2</span>[&nbsp;2^&gt;NUL')&nbsp;do&nbsp;set&nbsp;&quot;<span class=c_pvar>%%A</span>=&quot;</span><br>
<span style='color=#000000'>set&nbsp;/a&nbsp;<span class=c_pvar>%~2</span>[#]=-1</span><br>
<span style='color=#000000'>for&nbsp;/f&nbsp;&quot;tokens=*&quot;&nbsp;<span class=c_pvar>%%A</span>&nbsp;in&nbsp;('reg&nbsp;query&nbsp;&quot;<span class=c_pvar>%~1</span>&quot;^|findstr&nbsp;/b&nbsp;/c:&quot;HKEY_&quot;')&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;/a&nbsp;<span class=c_pvar>%~2</span>[#]+=1</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;set&nbsp;<span class=c_pvar>%~2</span>[%<span class=c_pvar>%%~2</span>[#]%%]=<span class=c_pvar>%%A</span></span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.GetRegValue'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:GetRegValue - returns a registry value</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#GetRegValue'>:GetRegValue</a> Key Value Data Type </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br><a name='13'>13.</a><br><a name='14'>14.</a><br><a name='15'>15.</a><br><a name='16'>16.</a><br><a name='17'>17.</a><br><a name='18'>18.</a><br><a name='19'>19.</a><br><a name='20'>20.</a><br><a name='21'>21.</a><br><a name='22'>22.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='GetRegValue'>:GetRegValue</a></span><span class=c_cmmt>&nbsp;Key&nbsp;Value&nbsp;Data&nbsp;Type&nbsp;--&nbsp;returns&nbsp;a&nbsp;registry&nbsp;value</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;Key&nbsp;&nbsp;&nbsp;&nbsp;[in]&nbsp;&nbsp;-&nbsp;registry&nbsp;key</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;Value&nbsp;&nbsp;[in]&nbsp;&nbsp;-&nbsp;registry&nbsp;value</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;Data&nbsp;&nbsp;&nbsp;[out]&nbsp;-&nbsp;return&nbsp;variable&nbsp;for&nbsp;Data</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;Type&nbsp;&nbsp;&nbsp;[out]&nbsp;-&nbsp;return&nbsp;variable&nbsp;for&nbsp;Type,&nbsp;i.e.:&nbsp;REG_SZ,&nbsp;REG_MULTI_SZ,&nbsp;REG_DWORD_BIG_ENDIAN,&nbsp;REG_DWORD,&nbsp;REG_BINARY,&nbsp;REG_DWORD_LITTLE_ENDIAN,&nbsp;REG_NONE,&nbsp;REG_EXPAND_SZ</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219&nbsp;:$categories&nbsp;Registry</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL&nbsp;ENABLEDELAYEDEXPANSION</span><br>
<span style='color=#000000'>set&nbsp;Key=<span class=c_pvar>%~1</span></span><br>
<span style='color=#000000'>set&nbsp;Val=<span class=c_pvar>%~2</span></span><br>
<span style='color=#000000'>if&nbsp;&quot;%Val%&quot;==&quot;&quot;&nbsp;(set&nbsp;v=/ve)&nbsp;ELSE&nbsp;set&nbsp;v=/v&nbsp;&quot;%Val%&quot;</span><br>
<span style='color=#000000'>set&nbsp;Data=</span><br>
<span style='color=#000000'>set&nbsp;Type=</span><br>
<span style='color=#000000'>for&nbsp;/f&nbsp;&quot;tokens=2,*&nbsp;delims=&nbsp;&quot;&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;('reg&nbsp;query&nbsp;&quot;%Key%&quot;&nbsp;%v%^|findstr&nbsp;/b&nbsp;&quot;....%match%&quot;')&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;Type=<span class=c_pvar>%%a</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;Data=<span class=c_pvar>%%b</span></span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>(&nbsp;ENDLOCAL&nbsp;&amp;&nbsp;<span class=c_cmmt>REM&nbsp;RETURN&nbsp;VALUES</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&quot;<span class=c_pvar>%~3</span>&quot;&nbsp;NEQ&nbsp;&quot;&quot;&nbsp;(SET&nbsp;<span class=c_pvar>%~3</span>=%Data%)&nbsp;ELSE&nbsp;echo.%Data%</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&quot;<span class=c_pvar>%~4</span>&quot;&nbsp;NEQ&nbsp;&quot;&quot;&nbsp;(SET&nbsp;<span class=c_pvar>%~4</span>=%Type%)</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.GetRegValues'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2009-11-23</font></font></div>
    <H2>:GetRegValues - returns all registry values of a given registry key</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#GetRegValues'>:GetRegValues</a> Key Data Type </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='GetRegValues'>:GetRegValues</a></span><span class=c_cmmt>&nbsp;Key&nbsp;Data&nbsp;Type&nbsp;--&nbsp;returns&nbsp;all&nbsp;registry&nbsp;values&nbsp;of&nbsp;a&nbsp;given&nbsp;registry&nbsp;key</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;Key&nbsp;&nbsp;&nbsp;[in]&nbsp;&nbsp;-&nbsp;registry&nbsp;key</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;Stc&nbsp;&nbsp;&nbsp;[out]&nbsp;-&nbsp;struct&nbsp;of&nbsp;registry&nbsp;values</span></span><br>
<span style='color=#000000'>:$created&nbsp;20091123&nbsp;:$changed&nbsp;20091123&nbsp;:$categories&nbsp;Registry,&nbsp;Array</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>if&nbsp;&quot;<span class=c_pvar>%~2</span>&quot;&nbsp;NEQ&nbsp;&quot;&quot;&nbsp;for&nbsp;/f&nbsp;&quot;delims==&quot;&nbsp;<span class=c_pvar>%%A</span>&nbsp;in&nbsp;('&quot;set&nbsp;<span class=c_pvar>%~2</span>.&nbsp;2&gt;NUL&quot;')&nbsp;do&nbsp;set&nbsp;&quot;<span class=c_pvar>%%A</span>=&quot;</span><br>
<span style='color=#000000'>for&nbsp;/f&nbsp;&quot;tokens=1,2,*&nbsp;skip=4&nbsp;delims=&nbsp;&quot;&nbsp;<span class=c_pvar>%%A</span>&nbsp;in&nbsp;('reg&nbsp;query&nbsp;&quot;<span class=c_pvar>%~1</span>&quot;')&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;/f&nbsp;&quot;tokens=*&quot;&nbsp;<span class=c_pvar>%%X</span>&nbsp;in&nbsp;(&quot;<span class=c_pvar>%%A</span>&quot;)&nbsp;do&nbsp;(&nbsp;<span class=c_cmmt>rem&nbsp;this&nbsp;removes&nbsp;the&nbsp;leading&nbsp;tab</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;&quot;<span class=c_pvar>%~2</span>.<span class=c_pvar>%%X</span>=<span class=c_pvar>%%C</span>&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;)</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.getServices'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2009-11-13</font></font></div>
    <H2>:getServices - returns array of service information</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#getServices'>:getServices</a> var </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='getServices'>:getServices</a></span><span class=c_cmmt>&nbsp;var&nbsp;--&nbsp;returns&nbsp;array&nbsp;of&nbsp;service&nbsp;information</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;var&nbsp;[out]&nbsp;-&nbsp;return&nbsp;variable,&nbsp;as&nbsp;array</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20091113&nbsp;:$categories&nbsp;ServiceControl,Array</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>set&nbsp;/a&nbsp;<span class=c_pvar>%~1</span>[#]=-1</span><br>
<span style='color=#000000'>for&nbsp;/f&nbsp;&quot;tokens=*&quot;&nbsp;<span class=c_pvar>%%x</span>&nbsp;in&nbsp;('&quot;sc&nbsp;queryex&nbsp;state=&nbsp;all&nbsp;type=&nbsp;service&quot;')&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;/f&nbsp;&quot;tokens=1,*&nbsp;delims=:&nbsp;&quot;&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;(&quot;<span class=c_pvar>%%x</span>&quot;)&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&quot;<span class=c_pvar>%%a</span>&quot;==&quot;SERVICE_NAME&quot;&nbsp;set&nbsp;/a&nbsp;<span class=c_pvar>%~1</span>[#]+=1</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;set&nbsp;<span class=c_pvar>%~1</span>[%<span class=c_pvar>%%~1</span>[#]%%].<span class=c_pvar>%%a</span>=<span class=c_pvar>%%b</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;)</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.getVarsByAttr'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:getVarsByAttr - returns a comma separated list of variables based on an attribute name</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#getVarsByAttr'>:getVarsByAttr</a> attr ret </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br><a name='13'>13.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='getVarsByAttr'>:getVarsByAttr</a></span><span class=c_cmmt>&nbsp;attr&nbsp;ret&nbsp;--&nbsp;returns&nbsp;a&nbsp;comma&nbsp;separated&nbsp;list&nbsp;of&nbsp;variables&nbsp;based&nbsp;on&nbsp;an&nbsp;attribute&nbsp;name</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;attr&nbsp;[in]&nbsp;&nbsp;-&nbsp;attribute&nbsp;name</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;ret&nbsp;&nbsp;[out]&nbsp;-&nbsp;reference&nbsp;to&nbsp;return&nbsp;variable</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL</span><br>
<span style='color=#000000'>set&nbsp;varattr=<span class=c_pvar>%~1</span></span><br>
<span style='color=#000000'>set&nbsp;value=</span><br>
<span style='color=#000000'>FOR&nbsp;/F&nbsp;&quot;usebackq&nbsp;tokens=1,2&nbsp;delims=.=&quot;&nbsp;<span class=c_pvar>%%a</span>&nbsp;IN&nbsp;(`set`)&nbsp;DO&nbsp;if&nbsp;&quot;<span class=c_pvar>%%a</span>&quot;==&quot;%varattr%&quot;&nbsp;(set&nbsp;value=!value!<span class=c_pvar>%%b</span>,)</span><br>
<span style='color=#000000'>(&nbsp;ENDLOCAL&nbsp;&amp;&nbsp;<span class=c_cmmt>REM&nbsp;RETURN&nbsp;VALUES</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&quot;<span class=c_pvar>%~2</span>&quot;&nbsp;NEQ&nbsp;&quot;&quot;&nbsp;SET&nbsp;<span class=c_pvar>%~2</span>=%value%</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.htmlhelp'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:htmlhelp - dumps html help to console</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#htmlhelp'>:htmlhelp</a> </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Dependencies:</td>
      <td class='text'  VALIGN='top'> <a href="#ExtractFunction">:ExtractFunction</a></td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br><a name='13'>13.</a><br><a name='14'>14.</a><br><a name='15'>15.</a><br><a name='16'>16.</a><br><a name='17'>17.</a><br><a name='18'>18.</a><br><a name='19'>19.</a><br><a name='20'>20.</a><br><a name='21'>21.</a><br><a name='22'>22.</a><br><a name='23'>23.</a><br><a name='24'>24.</a><br><a name='25'>25.</a><br><a name='26'>26.</a><br><a name='27'>27.</a><br><a name='28'>28.</a><br><a name='29'>29.</a><br><a name='30'>30.</a><br><a name='31'>31.</a><br><a name='32'>32.</a><br><a name='33'>33.</a><br><a name='34'>34.</a><br><a name='35'>35.</a><br><a name='36'>36.</a><br><a name='37'>37.</a><br><a name='38'>38.</a><br><a name='39'>39.</a><br><a name='40'>40.</a><br><a name='41'>41.</a><br><a name='42'>42.</a><br><a name='43'>43.</a><br><a name='44'>44.</a><br><a name='45'>45.</a><br><a name='46'>46.</a><br><a name='47'>47.</a><br><a name='48'>48.</a><br><a name='49'>49.</a><br><a name='50'>50.</a><br><a name='51'>51.</a><br><a name='52'>52.</a><br><a name='53'>53.</a><br><a name='54'>54.</a><br><a name='55'>55.</a><br><a name='56'>56.</a><br><a name='57'>57.</a><br><a name='58'>58.</a><br><a name='59'>59.</a><br><a name='60'>60.</a><br><a name='61'>61.</a><br><a name='62'>62.</a><br><a name='63'>63.</a><br><a name='64'>64.</a><br><a name='65'>65.</a><br><a name='66'>66.</a><br><a name='67'>67.</a><br><a name='68'>68.</a><br><a name='69'>69.</a><br><a name='70'>70.</a><br><a name='71'>71.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='htmlhelp'>:htmlhelp</a></span><span class=c_cmmt>&nbsp;--&nbsp;dumps&nbsp;html&nbsp;help&nbsp;to&nbsp;console</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL&nbsp;ENABLEEXTENSIONS</span><br>
<span style='color=#000000'>SETLOCAL&nbsp;ENABLEDELAYEDEXPANSION</span><br>
<span style='color=#000000'><span class=c_cmmt>rem&nbsp;echo.^&lt;html^&gt;^&lt;body^&gt;</span></span><br>
<span style='color=#000000'>echo.^&lt;center^&gt;</span><br>
<span style='color=#000000'>echo.^&lt;table&nbsp;border=0^&gt;</span><br>
<span style='color=#000000'>for&nbsp;/f&nbsp;&quot;tokens=1,*&nbsp;delims=-&quot;&nbsp;<span class=c_pvar>%%b</span>&nbsp;in&nbsp;('&quot;findstr&nbsp;&quot;^^:[^^:].*--&quot;&nbsp;&quot;<span class=c_pvar>%~f0</span>&quot;&nbsp;&quot;')&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;/f&nbsp;&quot;tokens=1,*&nbsp;delims=&nbsp;&quot;&nbsp;<span class=c_pvar>%%m</span>&nbsp;in&nbsp;(&quot;<span class=c_pvar>%%b</span>&quot;)&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;func=<span class=c_pvar>%%m</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;args=<span class=c_pvar>%%n</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;)</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;sign=<span class=c_pvar>%%b</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;desc=<span class=c_pvar>%%c</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;echo.^&lt;tr^&gt;^&lt;td^&gt;^&lt;a&nbsp;href='#_!func:~1!'^&gt;!func!^&lt;/a^&gt;^&lt;/td^&gt;^&lt;td^&gt;&nbsp;!desc!^&lt;/td^&gt;^&lt;/tr^&gt;</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>echo.^&lt;/table^&gt;</span><br>
<span style='color=#000000'>echo.^&lt;/center^&gt;</span><br>
<span style='color=#000000'></span><br>
<span style='color=#000000'>for&nbsp;/f&nbsp;&quot;tokens=*&quot;&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;('&quot;findstr&nbsp;&quot;^^:.*--&nbsp;^^:\$&quot;&nbsp;&quot;<span class=c_pvar>%~f0</span>&quot;&nbsp;&quot;')&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;line=<span class=c_pvar>%%a</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&quot;!line:~1,1!&quot;==&quot;:&quot;&nbsp;(&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=c_cmmt>rem&nbsp;process&nbsp;function&nbsp;arguments&nbsp;section</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;/f&nbsp;&quot;tokens=1,2,*&nbsp;delims=-[]&nbsp;&quot;&nbsp;<span class=c_pvar>%%b</span>&nbsp;in&nbsp;(&quot;!line:*--=!&quot;)&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;pname=<span class=c_pvar>%%b</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;ptype=<span class=c_pvar>%%c</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;pdesc=<span class=c_pvar>%%d</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo.^&lt;tr^&gt;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo.^&lt;td^&gt;!pname!^&lt;/td^&gt;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo.^&lt;td^&gt;!ptype!^&lt;/td^&gt;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo.^&lt;td^&gt;!pdesc!^&lt;/td^&gt;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo.^&lt;/tr^&gt;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;ELSE&nbsp;if&nbsp;&quot;!line:~1,1!&quot;==&quot;$&quot;&nbsp;(&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=c_cmmt>rem&nbsp;process&nbsp;the&nbsp;end&nbsp;section</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&quot;!func!&quot;&nbsp;NEQ&nbsp;&quot;&quot;&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;depe=</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;/f&nbsp;&quot;tokens=*&quot;&nbsp;<span class=c_pvar>%%F</span>&nbsp;in&nbsp;('<span class=c_pvar>%~f0</span>&nbsp;:ExtractFunction&nbsp;!func!^|findstr&nbsp;/i&nbsp;&quot;call\:[a-z]&quot;')&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;line=&quot;<span class=c_pvar>%%F</span>&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;line=&quot;!line:*call:=!</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;/f&nbsp;&quot;delims=&amp;|&gt;&lt;&nbsp;&quot;&nbsp;<span class=c_pvar>%%G</span>&nbsp;in&nbsp;(!line!)&nbsp;do&nbsp;set&nbsp;depe=!depe!<span class=c_pvar>%%G</span>&nbsp;&amp;set&nbsp;line=<span class=c_pvar>%%G</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=c_cmmt>rem&nbsp;echo.!func!&nbsp;-&nbsp;!line!&gt;&amp;2</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=c_cmmt>rem&nbsp;echo.!func!&nbsp;&gt;&amp;2</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=c_cmmt>rem&nbsp;echo.^&lt;pre^&gt;&amp;call:ExtractFunction&nbsp;!func!&amp;echo.^&lt;/pre^&gt;</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo.^&lt;/table^&gt;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo.^&lt;p^&gt;Dependencies:</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;<span class=c_pvar>%%F</span>&nbsp;in&nbsp;(!depe!)&nbsp;do&nbsp;(echo.^&lt;a&nbsp;href='#_<span class=c_pvar>%%F</span>'^&gt;:<span class=c_pvar>%%F</span>^&lt;/a^&gt;&nbsp;)</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;defined&nbsp;depe&nbsp;echo.none</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo.^&lt;/p^&gt;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;func=&amp;<span class=c_cmmt>rem&nbsp;this&nbsp;makes&nbsp;sure&nbsp;we&nbsp;process&nbsp;the&nbsp;END&nbsp;only&nbsp;once</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;ELSE&nbsp;(&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=c_cmmt>rem&nbsp;process&nbsp;function&nbsp;title&nbsp;section</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;/f&nbsp;&quot;tokens=1,*&nbsp;delims=-&quot;&nbsp;<span class=c_pvar>%%b</span>&nbsp;in&nbsp;(&quot;!line!&quot;)&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;/f&nbsp;&quot;tokens=1,*&nbsp;delims=&nbsp;&quot;&nbsp;<span class=c_pvar>%%m</span>&nbsp;in&nbsp;(&quot;<span class=c_pvar>%%b</span>&quot;)&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;func=<span class=c_pvar>%%m</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;args=<span class=c_pvar>%%n</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TITLE&nbsp;processing&nbsp;!func!</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;sign=<span class=c_pvar>%%b</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;desc=<span class=c_pvar>%%c</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo.^&lt;br/^&gt;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo.^&lt;H2^&gt;^&lt;a&nbsp;name='_!func:~1!'^&gt;!func!&nbsp;--&nbsp;!desc!^&lt;/a^&gt;^&lt;/H2^&gt;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo.^&lt;span&nbsp;style='float:right;'^&gt;&nbsp;^&lt;a&nbsp;href='#!func:~1!'^&gt;View&nbsp;Script^&lt;/a^&gt;^&amp;nbsp;^&amp;nbsp;^&lt;/span^&gt;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo.^&lt;p^&gt;Call&nbsp;^&lt;b^&gt;^&lt;a&nbsp;href='#!func:~1!'^&gt;!func!^&lt;/a^&gt;^&lt;/b^&gt;&nbsp;^&lt;i^&gt;!args!^&lt;/i^&gt;^&lt;/p^&gt;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo.^&lt;table&nbsp;border=1^&gt;^&lt;tr^&gt;^&lt;td^&gt;Parameter^&lt;/td^&gt;^&lt;td^&gt;Type^&lt;/td^&gt;^&lt;td^&gt;Desc^&lt;/td^&gt;^&lt;/tr^&gt;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;)</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>TITLE&nbsp;processing&nbsp;done</span><br>
<span style='color=#000000'><span class=c_cmmt>rem&nbsp;echo.^&lt;/body^&gt;^&lt;/html^&gt;</span></span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.Init'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:Init - initializes the environment for this command library</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#Init'>:Init</a> </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='Init'>:Init</a></span><span class=c_cmmt>&nbsp;--&nbsp;initializes&nbsp;the&nbsp;environment&nbsp;for&nbsp;this&nbsp;command&nbsp;library</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>set&nbsp;&quot;.=<span class=c_pvar>%~f0</span>&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&nbsp;<span class=c_cmmt>rem&nbsp;set&nbsp;full&nbsp;name,&nbsp;i.e.&nbsp;type&nbsp;%.%</span></span><br>
<span style='color=#000000'>set&nbsp;&quot;:=call&nbsp;&quot;%.%&quot;&nbsp;&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&nbsp;<span class=c_cmmt>rem&nbsp;set&nbsp;cl&nbsp;call&nbsp;prefix,&nbsp;i.e.&nbsp;%:%:func</span></span><br>
<span style='color=#000000'>set&nbsp;&quot;?=&amp;&amp;echo.TRUE||echo.FALSE&quot;&nbsp;&amp;&nbsp;<span class=c_cmmt>rem&nbsp;set&nbsp;true/false&nbsp;check,&nbsp;i.e.&nbsp;%:%:true&nbsp;%?%</span></span><br>
<span style='color=#000000'>set&nbsp;&quot;*=%:%:set&nbsp;&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&nbsp;<span class=c_cmmt>rem&nbsp;set&nbsp;array&nbsp;setter&nbsp;for&nbsp;console&nbsp;output,&nbsp;i.e.&nbsp;%*%&nbsp;d=dir&nbsp;/b</span></span><br>
<span style='color=#000000'></span><br>
<span style='color=#000000'>if&nbsp;not&nbsp;exist&nbsp;&quot;%temp%&quot;&nbsp;set&nbsp;&quot;temp=%tmp%&quot;</span><br>
<span style='color=#000000'>if&nbsp;not&nbsp;exist&nbsp;&quot;%temp%&quot;&nbsp;set&nbsp;&quot;temp=c:\temp&quot;</span><br>
<span style='color=#000000'>if&nbsp;not&nbsp;exist&nbsp;&quot;%temp%&quot;&nbsp;md&nbsp;&quot;%temp%&quot;</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.initProgress'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-03-27</font></font></div>
    <H2>:initProgress - initializes an internal progress counter and display the progress in percent</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#initProgress'>:initProgress</a> max format </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Dependencies:</td>
      <td class='text'  VALIGN='top'> <a href="#doProgress">:doProgress</a></td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='initProgress'>:initProgress</a></span><span class=c_cmmt>&nbsp;max&nbsp;format&nbsp;--&nbsp;initializes&nbsp;an&nbsp;internal&nbsp;progress&nbsp;counter&nbsp;and&nbsp;display&nbsp;the&nbsp;progress&nbsp;in&nbsp;percent</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;max&nbsp;&nbsp;&nbsp;&nbsp;[in]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;progress&nbsp;counter&nbsp;maximum,&nbsp;equal&nbsp;to&nbsp;100&nbsp;percent</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;format&nbsp;[in,opt]&nbsp;-&nbsp;title&nbsp;string&nbsp;formatter,&nbsp;default&nbsp;is&nbsp;'[P]&nbsp;completed.'</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080327&nbsp;:$categories&nbsp;Progress</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>set&nbsp;/a&nbsp;&quot;ProgressCnt=-1&quot;</span><br>
<span style='color=#000000'>set&nbsp;/a&nbsp;&quot;ProgressMax=<span class=c_pvar>%~1</span>&quot;</span><br>
<span style='color=#000000'>set&nbsp;&quot;ProgressFormat=<span class=c_pvar>%~2</span>&quot;</span><br>
<span style='color=#000000'>if&nbsp;not&nbsp;defined&nbsp;ProgressFormat&nbsp;set&nbsp;&quot;ProgressFormat=[PPPP]&quot;</span><br>
<span style='color=#000000'>set&nbsp;&quot;ProgressFormat=%ProgressFormat:[PPPP]=[P]&nbsp;completed.%&quot;</span><br>
<span style='color=#000000'>call:doProgress</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.initVarsByAttr'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:initVarsByAttr - restores the values of the persistent variables to defaults</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#initVarsByAttr'>:initVarsByAttr</a> </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Dependencies:</td>
      <td class='text'  VALIGN='top'> <a href="#getVarsByAttr">:getVarsByAttr</a></td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='initVarsByAttr'>:initVarsByAttr</a></span><span class=c_cmmt>&nbsp;--&nbsp;restores&nbsp;the&nbsp;values&nbsp;of&nbsp;the&nbsp;persistent&nbsp;variables&nbsp;to&nbsp;defaults</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219&nbsp;:$categories&nbsp;Persistency</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL&nbsp;ENABLEDELAYEDEXPANSION</span><br>
<span style='color=#000000'>call:getVarsByAttr&nbsp;persist&nbsp;vars</span><br>
<span style='color=#000000'>(&nbsp;ENDLOCAL</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;(%vars%)&nbsp;do&nbsp;SET&nbsp;<span class=c_pvar>%%a</span>=!persist.<span class=c_pvar>%%a</span>!&amp;&nbsp;&nbsp;<span class=c_cmmt>rem&nbsp;AA=persist.AA</span></span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.IsFileOpen'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:IsFileOpen - succeeds if file in use, fails otherwise</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#IsFileOpen'>:IsFileOpen</a> filename </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='IsFileOpen'>:IsFileOpen</a></span><span class=c_cmmt>&nbsp;filename&nbsp;--&nbsp;succeeds&nbsp;if&nbsp;file&nbsp;in&nbsp;use,&nbsp;fails&nbsp;otherwise</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;filename&nbsp;[in]&nbsp;-&nbsp;name&nbsp;of&nbsp;file&nbsp;to&nbsp;be&nbsp;tested</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219&nbsp;:$categories&nbsp;FileOperation</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>echo.N|copy&nbsp;/-y&nbsp;NUL&nbsp;&quot;<span class=c_pvar>%~1</span>&quot;&gt;NUL</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.IsRegKey'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:IsRegKey - succeeds if Key exists</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#IsRegKey'>:IsRegKey</a> Key </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='IsRegKey'>:IsRegKey</a></span><span class=c_cmmt>&nbsp;Key&nbsp;--&nbsp;succeeds&nbsp;if&nbsp;Key&nbsp;exists</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;Key&nbsp;&nbsp;[in]&nbsp;&nbsp;-&nbsp;registry&nbsp;key</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219&nbsp;:$categories&nbsp;Registry</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>reg&nbsp;query&nbsp;&quot;<span class=c_pvar>%~1</span>&quot;&gt;NUL&nbsp;2&gt;NUL</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.IsRegValue'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:IsRegValue - succeeds if Key and Value exists</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#IsRegValue'>:IsRegValue</a> Key Value </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='IsRegValue'>:IsRegValue</a></span><span class=c_cmmt>&nbsp;Key&nbsp;Value&nbsp;--&nbsp;succeeds&nbsp;if&nbsp;Key&nbsp;and&nbsp;Value&nbsp;exists</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;Key&nbsp;&nbsp;&nbsp;&nbsp;[in]&nbsp;&nbsp;-&nbsp;registry&nbsp;key</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;Value&nbsp;&nbsp;[in]&nbsp;&nbsp;-&nbsp;registry&nbsp;value,&nbsp;return&nbsp;default&nbsp;value&nbsp;if&nbsp;omitted</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219&nbsp;:$categories&nbsp;Registry</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL</span><br>
<span style='color=#000000'>if&nbsp;&quot;<span class=c_pvar>%~2</span>&quot;==&quot;&quot;&nbsp;(set&nbsp;v=/ve)&nbsp;ELSE&nbsp;set&nbsp;v=/v&nbsp;&quot;<span class=c_pvar>%~2</span>&quot;</span><br>
<span style='color=#000000'>reg&nbsp;query&nbsp;&quot;<span class=c_pvar>%~1</span>&quot;&nbsp;%v%&gt;NUL&nbsp;2&gt;NUL</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.IsServiceRunning'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:IsServiceRunning - returns success if service is running, otherwise failure</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#IsServiceRunning'>:IsServiceRunning</a> service </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='IsServiceRunning'>:IsServiceRunning</a></span><span class=c_cmmt>&nbsp;service&nbsp;--&nbsp;returns&nbsp;success&nbsp;if&nbsp;service&nbsp;is&nbsp;running,&nbsp;otherwise&nbsp;failure</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;service&nbsp;&nbsp;[in]&nbsp;&nbsp;-&nbsp;name&nbsp;of&nbsp;the&nbsp;service&nbsp;to&nbsp;check</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219&nbsp;:$categories&nbsp;ServiceControl</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL&nbsp;ENABLEDELAYEDEXPANSION</span><br>
<span style='color=#000000'>sc&nbsp;query&nbsp;&quot;<span class=c_pvar>%~1</span>&quot;|findstr&nbsp;&quot;STATE.*:.*4.*RUNNING&quot;&gt;NUL</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.jdate'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2009-03-28</font></font></div>
    <H2>:jdate - converts a date string to julian day number with respect to regional date format</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#jdate'>:jdate</a> JD DateStr </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br><a name='13'>13.</a><br><a name='14'>14.</a><br><a name='15'>15.</a><br><a name='16'>16.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='jdate'>:jdate</a></span><span class=c_cmmt>&nbsp;JD&nbsp;DateStr&nbsp;--&nbsp;converts&nbsp;a&nbsp;date&nbsp;string&nbsp;to&nbsp;julian&nbsp;day&nbsp;number&nbsp;with&nbsp;respect&nbsp;to&nbsp;regional&nbsp;date&nbsp;format</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;JD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[out,opt]&nbsp;-&nbsp;julian&nbsp;days</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;DateStr&nbsp;[in,opt]&nbsp;&nbsp;-&nbsp;date&nbsp;string,&nbsp;e.g.&nbsp;&quot;03/31/2006&quot;&nbsp;or&nbsp;&quot;Fri&nbsp;03/31/2006&quot;&nbsp;or&nbsp;&quot;31.3.2006&quot;</span></span><br>
<span style='color=#000000'>:$reference&nbsp;https://groups.google.com/group/alt.msdos.batch.nt/browse_frm/thread/a0c34d593e782e94/50ed3430b6446af8#50ed3430b6446af8</span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20090328&nbsp;:$categories&nbsp;DateAndTime</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL</span><br>
<span style='color=#000000'>set&nbsp;DateStr=<span class=c_pvar>%~2</span>&amp;if&nbsp;&quot;<span class=c_pvar>%~2</span>&quot;==&quot;&quot;&nbsp;set&nbsp;DateStr=%date%</span><br>
<span style='color=#000000'>for&nbsp;/f&nbsp;&quot;skip=1&nbsp;tokens=2-4&nbsp;delims=(-)&quot;&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;('&quot;echo.|date&quot;')&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;/f&nbsp;&quot;tokens=1-3&nbsp;delims=/.-&nbsp;&quot;&nbsp;<span class=c_pvar>%%A</span>&nbsp;in&nbsp;(&quot;%DateStr:*&nbsp;=%&quot;)&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;<span class=c_pvar>%%a</span>=<span class=c_pvar>%%A</span>&amp;set&nbsp;<span class=c_pvar>%%b</span>=<span class=c_pvar>%%B</span>&amp;set&nbsp;<span class=c_pvar>%%c</span>=<span class=c_pvar>%%C</span>))</span><br>
<span style='color=#000000'>set&nbsp;/a&nbsp;&quot;yy=10000%yy%&nbsp;<span class=c_pvar>%%1</span>0000,mm=100%mm%&nbsp;%%&nbsp;100,dd=100%dd%&nbsp;%%&nbsp;100&quot;</span><br>
<span style='color=#000000'>if&nbsp;%yy%&nbsp;LSS&nbsp;100&nbsp;set&nbsp;/a&nbsp;yy+=2000&nbsp;&amp;<span class=c_cmmt>rem&nbsp;Adds&nbsp;2000&nbsp;to&nbsp;two&nbsp;digit&nbsp;years</span></span><br>
<span style='color=#000000'>set&nbsp;/a&nbsp;JD=dd-32075+1461*(yy+4800+(mm-14)/12)/4+367*(mm-2-(mm-14)/12*12)/12-3*((yy+4900+(mm-14)/12)/100)/4</span><br>
<span style='color=#000000'>ENDLOCAL&nbsp;&amp;&nbsp;IF&nbsp;&quot;<span class=c_pvar>%~1</span>&quot;&nbsp;NEQ&nbsp;&quot;&quot;&nbsp;(SET&nbsp;<span class=c_pvar>%~1</span>=%JD%)&nbsp;ELSE&nbsp;(echo.%JD%)</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.jdate2date'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:jdate2date - converts julian days to gregorian date format</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#jdate2date'>:jdate2date</a> JD YYYY MM DD </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br><a name='13'>13.</a><br><a name='14'>14.</a><br><a name='15'>15.</a><br><a name='16'>16.</a><br><a name='17'>17.</a><br><a name='18'>18.</a><br><a name='19'>19.</a><br><a name='20'>20.</a><br><a name='21'>21.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='jdate2date'>:jdate2date</a></span><span class=c_cmmt>&nbsp;JD&nbsp;YYYY&nbsp;MM&nbsp;DD&nbsp;--&nbsp;converts&nbsp;julian&nbsp;days&nbsp;to&nbsp;gregorian&nbsp;date&nbsp;format</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;JD&nbsp;&nbsp;&nbsp;[in]&nbsp;&nbsp;-&nbsp;julian&nbsp;days</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;YYYY&nbsp;[out]&nbsp;-&nbsp;gregorian&nbsp;year,&nbsp;i.e.&nbsp;2006</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;MM&nbsp;&nbsp;&nbsp;[out]&nbsp;-&nbsp;gregorian&nbsp;month,&nbsp;i.e.&nbsp;12&nbsp;for&nbsp;december</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;DD&nbsp;&nbsp;&nbsp;[out]&nbsp;-&nbsp;gregorian&nbsp;day,&nbsp;i.e.&nbsp;31</span></span><br>
<span style='color=#000000'>:$reference&nbsp;https://aa.usno.navy.mil/faq/docs/JD_Formula.html</span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219&nbsp;:$categories&nbsp;DateAndTime</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL&nbsp;ENABLEDELAYEDEXPANSION</span><br>
<span style='color=#000000'>set&nbsp;/a&nbsp;L=&nbsp;<span class=c_pvar>%~1</span>+68569,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=&nbsp;4*L/146097,&nbsp;L=&nbsp;L-(146097*N+3)/4,&nbsp;I=&nbsp;4000*(L+1)/1461001</span><br>
<span style='color=#000000'>set&nbsp;/a&nbsp;L=&nbsp;L-1461*I/4+31,&nbsp;J=&nbsp;80*L/2447,&nbsp;&nbsp;K=&nbsp;L-2447*J/80,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=&nbsp;J/11</span><br>
<span style='color=#000000'>set&nbsp;/a&nbsp;J=&nbsp;J+2-12*L,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I=&nbsp;100*(N-49)+I+L</span><br>
<span style='color=#000000'>set&nbsp;/a&nbsp;YYYY=&nbsp;I,&nbsp;&nbsp;MM=100+J,&nbsp;&nbsp;DD=100+K</span><br>
<span style='color=#000000'>set&nbsp;MM=%MM:~-2%</span><br>
<span style='color=#000000'>set&nbsp;DD=%DD:~-2%</span><br>
<span style='color=#000000'>(&nbsp;ENDLOCAL&nbsp;&amp;&nbsp;<span class=c_cmmt>REM&nbsp;RETURN&nbsp;VALUES</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&quot;<span class=c_pvar>%~2</span>&quot;&nbsp;NEQ&nbsp;&quot;&quot;&nbsp;(SET&nbsp;<span class=c_pvar>%~2</span>=%YYYY%)&nbsp;ELSE&nbsp;echo.%YYYY%</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&quot;<span class=c_pvar>%~3</span>&quot;&nbsp;NEQ&nbsp;&quot;&quot;&nbsp;(SET&nbsp;<span class=c_pvar>%~3</span>=%MM%)&nbsp;ELSE&nbsp;echo.%MM%</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&quot;<span class=c_pvar>%~4</span>&quot;&nbsp;NEQ&nbsp;&quot;&quot;&nbsp;(SET&nbsp;<span class=c_pvar>%~4</span>=%DD%)&nbsp;ELSE&nbsp;echo.%DD%</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.kBytesFree'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:kBytesFree - returns the free space of a drive in kilobytes</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#kBytesFree'>:kBytesFree</a> drive ret </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br><a name='13'>13.</a><br><a name='14'>14.</a><br><a name='15'>15.</a><br><a name='16'>16.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='kBytesFree'>:kBytesFree</a></span><span class=c_cmmt>&nbsp;drive&nbsp;ret&nbsp;--&nbsp;returns&nbsp;the&nbsp;free&nbsp;space&nbsp;of&nbsp;a&nbsp;drive&nbsp;in&nbsp;kilobytes</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;drive&nbsp;&nbsp;[in]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;drive&nbsp;letter,&nbsp;default&nbsp;is&nbsp;c:</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;ret&nbsp;&nbsp;&nbsp;&nbsp;[out,opt]&nbsp;-&nbsp;varref&nbsp;returns&nbsp;number&nbsp;of&nbsp;bytes&nbsp;free</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219&nbsp;:$categories&nbsp;FileInfo</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL</span><br>
<span style='color=#000000'>SET&nbsp;&quot;drive=<span class=c_pvar>%~1</span>&quot;</span><br>
<span style='color=#000000'>IF&nbsp;&quot;%drive%&quot;==&quot;&quot;&nbsp;SET&nbsp;&quot;drive=C:&quot;</span><br>
<span style='color=#000000'>FOR&nbsp;/f&nbsp;&quot;tokens=3&nbsp;delims=&nbsp;&quot;&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;('&quot;dir&nbsp;%drive%\|find&nbsp;&quot;bytes&nbsp;free&quot;&quot;')&nbsp;do&nbsp;set&nbsp;free=<span class=c_pvar>%%a</span></span><br>
<span style='color=#000000'>SET&nbsp;&quot;free=%free:,=%&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;<span class=c_cmmt>rem&nbsp;eleminate&nbsp;commas&nbsp;in&nbsp;number</span></span><br>
<span style='color=#000000'>SET&nbsp;&quot;free=%free:.=%&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;<span class=c_cmmt>rem&nbsp;eleminate&nbsp;dots&nbsp;in&nbsp;number</span></span><br>
<span style='color=#000000'>SET&nbsp;&quot;free=%free:~0,-3%&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;<span class=c_cmmt>rem&nbsp;divide&nbsp;by&nbsp;1000&nbsp;by&nbsp;cutting&nbsp;off&nbsp;the&nbsp;last&nbsp;3&nbsp;digits</span></span><br>
<span style='color=#000000'>(&nbsp;ENDLOCAL&nbsp;&amp;&nbsp;<span class=c_cmmt>REM&nbsp;RETURN&nbsp;VALUES</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&quot;<span class=c_pvar>%~2</span>&quot;&nbsp;NEQ&nbsp;&quot;&quot;&nbsp;(SET&nbsp;&quot;<span class=c_pvar>%~2</span>=%free%&quot;)&nbsp;ELSE&nbsp;echo.%free%</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.l2a'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:l2a - converts a list to an array</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#l2a'>:l2a</a> list arr </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br><a name='13'>13.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='l2a'>:l2a</a></span><span class=c_cmmt>&nbsp;list&nbsp;arr&nbsp;--&nbsp;converts&nbsp;a&nbsp;list&nbsp;to&nbsp;an&nbsp;array</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;list&nbsp;[in]&nbsp;&nbsp;-&nbsp;list&nbsp;name</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;arr&nbsp;&nbsp;[in]&nbsp;&nbsp;-&nbsp;array&nbsp;name</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219&nbsp;:$categories&nbsp;Array,List</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>call&nbsp;set&nbsp;l=,%<span class=c_pvar>%%~1</span>%%,</span><br>
<span style='color=#000000'>set&nbsp;/a&nbsp;i=0</span><br>
<span style='color=#000000'>for&nbsp;/f&nbsp;&quot;delims=&quot;&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;('&quot;echo.%l:,=&amp;echo.%&quot;')&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;set&nbsp;<span class=c_pvar>%~2</span>[<span class=c_pvar>%%i</span>%%]=<span class=c_pvar>%%a</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;/a&nbsp;i+=1</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>set&nbsp;<span class=c_pvar>%~2</span>=%i%</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.loadPersistentVars'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:loadPersistentVars - loads the values of the persistent variables</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#loadPersistentVars'>:loadPersistentVars</a> filename </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Dependencies:</td>
      <td class='text'  VALIGN='top'> <a href="#initVarsByAttr">:initVarsByAttr</a></td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='loadPersistentVars'>:loadPersistentVars</a></span><span class=c_cmmt>&nbsp;filename&nbsp;--&nbsp;loads&nbsp;the&nbsp;values&nbsp;of&nbsp;the&nbsp;persistent&nbsp;variables</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;filename&nbsp;[in]&nbsp;&nbsp;-&nbsp;batch&nbsp;file&nbsp;name&nbsp;to&nbsp;restore&nbsp;from</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219&nbsp;:$categories&nbsp;Persistency</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>call:initVarsByAttr</span><br>
<span style='color=#000000'>if&nbsp;exist&nbsp;&quot;%FilePersist%&quot;&nbsp;call&nbsp;&quot;%FilePersist%&quot;</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.loadRegVars'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:loadRegVars - loads the values of the persistent variables</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#loadRegVars'>:loadRegVars</a> key </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Dependencies:</td>
      <td class='text'  VALIGN='top'> <a href="#getVarsByAttr">:getVarsByAttr</a>, <a href="#GetRegValue">:GetRegValue</a></td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='loadRegVars'>:loadRegVars</a></span><span class=c_cmmt>&nbsp;key&nbsp;--&nbsp;loads&nbsp;the&nbsp;values&nbsp;of&nbsp;the&nbsp;persistent&nbsp;variables</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;key&nbsp;[in]&nbsp;&nbsp;-&nbsp;registry&nbsp;key&nbsp;to&nbsp;restore&nbsp;from</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219&nbsp;:$categories&nbsp;Registry,Persistency</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL&nbsp;ENABLEDELAYEDEXPANSION</span><br>
<span style='color=#000000'>call:getVarsByAttr&nbsp;reg&nbsp;vars</span><br>
<span style='color=#000000'>(&nbsp;ENDLOCAL</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;(%vars%)&nbsp;do&nbsp;SET&nbsp;<span class=c_pvar>%%a</span>=!reg.<span class=c_pvar>%%a</span>!&amp;&nbsp;&nbsp;<span class=c_cmmt>rem&nbsp;AA=reg.AA</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;(%vars%)&nbsp;do&nbsp;call:GetRegValue&nbsp;&quot;<span class=c_pvar>%~1</span>&quot;&nbsp;&quot;<span class=c_pvar>%%a</span>&quot;&nbsp;<span class=c_pvar>%%a</span></span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.lookup'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:lookup - returns the value associated with a key in a map of key-value pairs</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#lookup'>:lookup</a> key map ret </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br><a name='13'>13.</a><br><a name='14'>14.</a><br><a name='15'>15.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='lookup'>:lookup</a></span><span class=c_cmmt>&nbsp;key&nbsp;map&nbsp;ret&nbsp;--&nbsp;returns&nbsp;the&nbsp;value&nbsp;associated&nbsp;with&nbsp;a&nbsp;key&nbsp;in&nbsp;a&nbsp;map&nbsp;of&nbsp;key-value&nbsp;pairs</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;key&nbsp;[in]&nbsp;&nbsp;-&nbsp;key&nbsp;to&nbsp;lookup</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;map&nbsp;[in]&nbsp;&nbsp;-&nbsp;map&nbsp;with&nbsp;key-value&nbsp;pairs,&nbsp;i.e.&nbsp;key1-val1;key2-val2;key3-val3</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;ret&nbsp;[out]&nbsp;-&nbsp;valref&nbsp;for&nbsp;return&nbsp;value</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219&nbsp;:$categories&nbsp;Lookup</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL</span><br>
<span style='color=#000000'>SET&nbsp;map=<span class=c_pvar>%~2</span></span><br>
<span style='color=#000000'>CALL&nbsp;SET&nbsp;ret=<span class=c_pvar>%%m</span>ap:*<span class=c_pvar>%~1</span>-=%%</span><br>
<span style='color=#000000'>SET&nbsp;ret=%ret:;=&amp;:%</span><br>
<span style='color=#000000'>IF&nbsp;&quot;%ret%&quot;&nbsp;NEQ&nbsp;&quot;%ret:-=%&quot;&nbsp;set&nbsp;ret=</span><br>
<span style='color=#000000'>(&nbsp;ENDLOCAL&nbsp;&amp;&nbsp;<span class=c_cmmt>REM&nbsp;RETURN&nbsp;VALUES</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&quot;<span class=c_pvar>%~3</span>&quot;&nbsp;NEQ&nbsp;&quot;&quot;&nbsp;(SET&nbsp;<span class=c_pvar>%~3</span>=%ret%)&nbsp;ELSE&nbsp;ECHO.%ret%</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.lTrim'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-27</font></font></div>
    <H2>:lTrim - strips white spaces (or other characters) from the beginning of a string</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#lTrim'>:lTrim</a> string char </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br><a name='13'>13.</a><br><a name='14'>14.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='lTrim'>:lTrim</a></span><span class=c_cmmt>&nbsp;string&nbsp;char&nbsp;--&nbsp;strips&nbsp;white&nbsp;spaces&nbsp;(or&nbsp;other&nbsp;characters)&nbsp;from&nbsp;the&nbsp;beginning&nbsp;of&nbsp;a&nbsp;string</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;string&nbsp;[in,out]&nbsp;-&nbsp;string&nbsp;variable&nbsp;to&nbsp;be&nbsp;trimmed</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;char&nbsp;&nbsp;&nbsp;[in,opt]&nbsp;-&nbsp;character&nbsp;to&nbsp;be&nbsp;trimmed,&nbsp;default&nbsp;is&nbsp;space</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080227&nbsp;:$categories&nbsp;StringManipulation</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL&nbsp;ENABLEDELAYEDEXPANSION</span><br>
<span style='color=#000000'>call&nbsp;set&nbsp;&quot;string=%<span class=c_pvar>%%~1</span>%%&quot;</span><br>
<span style='color=#000000'>set&nbsp;&quot;charlist=<span class=c_pvar>%~2</span>&quot;</span><br>
<span style='color=#000000'>if&nbsp;not&nbsp;defined&nbsp;charlist&nbsp;set&nbsp;&quot;charlist=&nbsp;&quot;</span><br>
<span style='color=#000000'>for&nbsp;/f&nbsp;&quot;tokens=*&nbsp;delims=%charlist%&quot;&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;(&quot;%string%&quot;)&nbsp;do&nbsp;set&nbsp;&quot;string=<span class=c_pvar>%%a</span>&quot;</span><br>
<span style='color=#000000'>(&nbsp;ENDLOCAL&nbsp;&amp;&nbsp;<span class=c_cmmt>REM&nbsp;RETURN&nbsp;VALUES</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&quot;<span class=c_pvar>%~1</span>&quot;&nbsp;NEQ&nbsp;&quot;&quot;&nbsp;SET&nbsp;&quot;<span class=c_pvar>%~1</span>=%string%&quot;</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.MakeAbsolute'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:MakeAbsolute - makes a file name absolute considering a base path</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#MakeAbsolute'>:MakeAbsolute</a> file base </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br><a name='13'>13.</a><br><a name='14'>14.</a><br><a name='15'>15.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='MakeAbsolute'>:MakeAbsolute</a></span><span class=c_cmmt>&nbsp;file&nbsp;base&nbsp;--&nbsp;makes&nbsp;a&nbsp;file&nbsp;name&nbsp;absolute&nbsp;considering&nbsp;a&nbsp;base&nbsp;path</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;file&nbsp;[in,out]&nbsp;-&nbsp;variable&nbsp;with&nbsp;file&nbsp;name&nbsp;to&nbsp;be&nbsp;converted,&nbsp;or&nbsp;file&nbsp;name&nbsp;itself&nbsp;for&nbsp;result&nbsp;in&nbsp;stdout</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;base&nbsp;[in,opt]&nbsp;-&nbsp;base&nbsp;path,&nbsp;leave&nbsp;blank&nbsp;for&nbsp;current&nbsp;directory</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219&nbsp;:$categories&nbsp;Path</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL&nbsp;ENABLEDELAYEDEXPANSION</span><br>
<span style='color=#000000'>set&nbsp;&quot;src=<span class=c_pvar>%~1</span>&quot;</span><br>
<span style='color=#000000'>if&nbsp;defined&nbsp;%1&nbsp;set&nbsp;&quot;src=!<span class=c_pvar>%~1</span>!&quot;</span><br>
<span style='color=#000000'>set&nbsp;&quot;bas=<span class=c_pvar>%~2</span>&quot;</span><br>
<span style='color=#000000'>if&nbsp;not&nbsp;defined&nbsp;bas&nbsp;set&nbsp;&quot;bas=%cd%&quot;</span><br>
<span style='color=#000000'>for&nbsp;/f&nbsp;&quot;tokens=*&quot;&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;(&quot;%bas%.\%src%&quot;)&nbsp;do&nbsp;set&nbsp;&quot;src=<span class=c_pvar>%%~fa</span>&quot;</span><br>
<span style='color=#000000'>(&nbsp;ENDLOCAL&nbsp;&amp;&nbsp;<span class=c_cmmt>REM&nbsp;RETURN&nbsp;VALUES</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;defined&nbsp;%1&nbsp;(SET&nbsp;<span class=c_pvar>%~1</span>=%src%)&nbsp;ELSE&nbsp;ECHO.%src%</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.MakeRelative'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:MakeRelative - makes a file name relative to a base path</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#MakeRelative'>:MakeRelative</a> file base </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br><a name='13'>13.</a><br><a name='14'>14.</a><br><a name='15'>15.</a><br><a name='16'>16.</a><br><a name='17'>17.</a><br><a name='18'>18.</a><br><a name='19'>19.</a><br><a name='20'>20.</a><br><a name='21'>21.</a><br><a name='22'>22.</a><br><a name='23'>23.</a><br><a name='24'>24.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='MakeRelative'>:MakeRelative</a></span><span class=c_cmmt>&nbsp;file&nbsp;base&nbsp;--&nbsp;makes&nbsp;a&nbsp;file&nbsp;name&nbsp;relative&nbsp;to&nbsp;a&nbsp;base&nbsp;path</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;file&nbsp;[in,out]&nbsp;-&nbsp;variable&nbsp;with&nbsp;file&nbsp;name&nbsp;to&nbsp;be&nbsp;converted,&nbsp;or&nbsp;file&nbsp;name&nbsp;itself&nbsp;for&nbsp;result&nbsp;in&nbsp;stdout</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;base&nbsp;[in,opt]&nbsp;-&nbsp;base&nbsp;path,&nbsp;leave&nbsp;blank&nbsp;for&nbsp;current&nbsp;directory</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219&nbsp;:$categories&nbsp;Path</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL&nbsp;ENABLEDELAYEDEXPANSION</span><br>
<span style='color=#000000'>set&nbsp;src=<span class=c_pvar>%~1</span></span><br>
<span style='color=#000000'>if&nbsp;defined&nbsp;%1&nbsp;set&nbsp;src=!<span class=c_pvar>%~1</span>!</span><br>
<span style='color=#000000'>set&nbsp;bas=<span class=c_pvar>%~2</span></span><br>
<span style='color=#000000'>if&nbsp;not&nbsp;defined&nbsp;bas&nbsp;set&nbsp;bas=%cd%</span><br>
<span style='color=#000000'>for&nbsp;/f&nbsp;&quot;tokens=*&quot;&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;(&quot;%src%&quot;)&nbsp;do&nbsp;set&nbsp;src=<span class=c_pvar>%%~fa</span></span><br>
<span style='color=#000000'>for&nbsp;/f&nbsp;&quot;tokens=*&quot;&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;(&quot;%bas%&quot;)&nbsp;do&nbsp;set&nbsp;bas=<span class=c_pvar>%%~fa</span></span><br>
<span style='color=#000000'>set&nbsp;mat=&amp;<span class=c_cmmt>rem&nbsp;variable&nbsp;to&nbsp;store&nbsp;matching&nbsp;part&nbsp;of&nbsp;the&nbsp;name</span></span><br>
<span style='color=#000000'>set&nbsp;upp=&amp;<span class=c_cmmt>rem&nbsp;variable&nbsp;to&nbsp;reference&nbsp;a&nbsp;parent</span></span><br>
<span style='color=#000000'>for&nbsp;/f&nbsp;&quot;tokens=*&quot;&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;('echo.%bas:\=^&amp;echo.%')&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;sub=!sub!<span class=c_pvar>%%a</span>\</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;set&nbsp;tmp=<span class=c_pvar>%%s</span>rc:!sub!=%%</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&quot;!tmp!&quot;&nbsp;NEQ&nbsp;&quot;!src!&quot;&nbsp;(set&nbsp;mat=!sub!)ELSE&nbsp;(set&nbsp;upp=!upp!..\)</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>set&nbsp;src=%upp%!src:%mat%=!</span><br>
<span style='color=#000000'>(&nbsp;ENDLOCAL&nbsp;&amp;&nbsp;<span class=c_cmmt>REM&nbsp;RETURN&nbsp;VALUES</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;defined&nbsp;%1&nbsp;(SET&nbsp;<span class=c_pvar>%~1</span>=%src%)&nbsp;ELSE&nbsp;ECHO.%src%</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.NetworkDeviceGuid2Name'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:NetworkDeviceGuid2Name - gets a Network Device Name from its coresponding GUID</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#NetworkDeviceGuid2Name'>:NetworkDeviceGuid2Name</a> guid name </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br><a name='13'>13.</a><br><a name='14'>14.</a><br><a name='15'>15.</a><br><a name='16'>16.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='NetworkDeviceGuid2Name'>:NetworkDeviceGuid2Name</a></span><span class=c_cmmt>&nbsp;guid&nbsp;name&nbsp;--&nbsp;gets&nbsp;a&nbsp;Network&nbsp;Device&nbsp;Name&nbsp;from&nbsp;its&nbsp;coresponding&nbsp;GUID</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;guid&nbsp;[in]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;Network&nbsp;Device&nbsp;GUID</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;name&nbsp;[out,opt]&nbsp;-&nbsp;valref&nbsp;to&nbsp;return&nbsp;Name&nbsp;in</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL</span><br>
<span style='color=#000000'>set&nbsp;guid=<span class=c_pvar>%~1</span></span><br>
<span style='color=#000000'>set&nbsp;key=HKLM\SYSTEM\CurrentControlSet\Control\Network\{4D36E972-E325-11CE-BFC1-08002BE10318}</span><br>
<span style='color=#000000'>set&nbsp;ret=</span><br>
<span style='color=#000000'>for&nbsp;/f&nbsp;&quot;tokens=*&quot;&nbsp;<span class=c_pvar>%%k</span>&nbsp;in&nbsp;('&quot;reg&nbsp;query&nbsp;&quot;%key%&quot;&nbsp;/s|find&nbsp;/I&nbsp;&quot;}\Connection&quot;&nbsp;&quot;')&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;/f&nbsp;&quot;tokens=2,*&quot;&nbsp;<span class=c_pvar>%%m</span>&nbsp;in&nbsp;('&quot;reg&nbsp;query&nbsp;&quot;<span class=c_pvar>%%k</span>&quot;&nbsp;/v&nbsp;&quot;Name&quot;|findstr&nbsp;/b&nbsp;&quot;....Name&quot;&nbsp;&quot;')&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;/f&nbsp;&quot;tokens=7&nbsp;delims=\&quot;&nbsp;<span class=c_pvar>%%g</span>&nbsp;in&nbsp;(&quot;<span class=c_pvar>%%k</span>&quot;)&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&quot;<span class=c_pvar>%%g</span>&quot;==&quot;%guid%&quot;&nbsp;set&nbsp;ret=<span class=c_pvar>%%n</span></span><br>
<span style='color=#000000'>)))</span><br>
<span style='color=#000000'>ENDLOCAL&amp;if&nbsp;&quot;<span class=c_pvar>%~2</span>&quot;&nbsp;NEQ&nbsp;&quot;&quot;&nbsp;(SET&nbsp;<span class=c_pvar>%~2</span>=%ret%)&nbsp;ELSE&nbsp;ECHO.%ret%</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.NetworkDeviceName2Guid'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:NetworkDeviceName2Guid - gets a Network Device GUID from its corresponding Name</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#NetworkDeviceName2Guid'>:NetworkDeviceName2Guid</a> name guid </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br><a name='13'>13.</a><br><a name='14'>14.</a><br><a name='15'>15.</a><br><a name='16'>16.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='NetworkDeviceName2Guid'>:NetworkDeviceName2Guid</a></span><span class=c_cmmt>&nbsp;name&nbsp;guid&nbsp;--&nbsp;gets&nbsp;a&nbsp;Network&nbsp;Device&nbsp;GUID&nbsp;from&nbsp;its&nbsp;corresponding&nbsp;Name</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;name&nbsp;[in]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;Network&nbsp;Device&nbsp;Name</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;guid&nbsp;[out,opt]&nbsp;-&nbsp;valref&nbsp;to&nbsp;return&nbsp;GUID&nbsp;in</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL</span><br>
<span style='color=#000000'>set&nbsp;name=<span class=c_pvar>%~1</span></span><br>
<span style='color=#000000'>set&nbsp;key=HKLM\SYSTEM\CurrentControlSet\Control\Network\{4D36E972-E325-11CE-BFC1-08002BE10318}</span><br>
<span style='color=#000000'>set&nbsp;ret=</span><br>
<span style='color=#000000'>for&nbsp;/f&nbsp;&quot;tokens=*&quot;&nbsp;<span class=c_pvar>%%k</span>&nbsp;in&nbsp;('&quot;reg&nbsp;query&nbsp;&quot;%key%&quot;&nbsp;/s|find&nbsp;/I&nbsp;&quot;}\Connection&quot;&nbsp;&quot;')&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;/f&nbsp;&quot;tokens=2,*&quot;&nbsp;<span class=c_pvar>%%m</span>&nbsp;in&nbsp;('&quot;reg&nbsp;query&nbsp;&quot;<span class=c_pvar>%%k</span>&quot;&nbsp;/v&nbsp;&quot;Name&quot;|findstr&nbsp;/b&nbsp;&quot;....Name&quot;&nbsp;&quot;')&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;/f&nbsp;&quot;tokens=7&nbsp;delims=\&quot;&nbsp;<span class=c_pvar>%%g</span>&nbsp;in&nbsp;(&quot;<span class=c_pvar>%%k</span>&quot;)&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&quot;<span class=c_pvar>%%n</span>&quot;==&quot;%name%&quot;&nbsp;set&nbsp;ret=<span class=c_pvar>%%g</span></span><br>
<span style='color=#000000'>)))</span><br>
<span style='color=#000000'>ENDLOCAL&amp;if&nbsp;&quot;<span class=c_pvar>%~2</span>&quot;&nbsp;NEQ&nbsp;&quot;&quot;&nbsp;(SET&nbsp;<span class=c_pvar>%~2</span>=%ret%)&nbsp;ELSE&nbsp;ECHO.%ret%</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.parse'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:parse - parses a string matching a formatter</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#parse'>:parse</a> fmt str </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='parse'>:parse</a></span><span class=c_cmmt>&nbsp;fmt&nbsp;str&nbsp;--&nbsp;parses&nbsp;a&nbsp;string&nbsp;matching&nbsp;a&nbsp;formatter</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;fmt&nbsp;[in]&nbsp;-&nbsp;formatter&nbsp;containing&nbsp;return&nbsp;variable&nbsp;names&nbsp;and&nbsp;delimitters</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;str&nbsp;[in]&nbsp;-&nbsp;string&nbsp;to&nbsp;be&nbsp;parsed</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL</span><br>
<span style='color=#000000'>echo...under&nbsp;construction</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.pwd'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-26</font></font></div>
    <H2>:pwd - shows a password dialog box</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#pwd'>:pwd</a> var title color </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br><a name='13'>13.</a><br><a name='14'>14.</a><br><a name='15'>15.</a><br><a name='16'>16.</a><br><a name='17'>17.</a><br><a name='18'>18.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='pwd'>:pwd</a></span><span class=c_cmmt>&nbsp;var&nbsp;title&nbsp;color&nbsp;--&nbsp;shows&nbsp;a&nbsp;password&nbsp;dialog&nbsp;box</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;var&nbsp;&nbsp;&nbsp;[in]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;return&nbsp;variable</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;title&nbsp;[in,opt]&nbsp;-&nbsp;dialog&nbsp;title,&nbsp;default&nbsp;is&nbsp;&quot;Password:&quot;</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;color&nbsp;[in,opt]&nbsp;-&nbsp;color&nbsp;default&nbsp;is&nbsp;AB&nbsp;(Light&nbsp;Green&nbsp;on&nbsp;Light&nbsp;Aqua)</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080226&nbsp;:$categories&nbsp;Input,Password</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL</span><br>
<span style='color=#000000'>set&nbsp;&quot;tit=<span class=c_pvar>%~2</span>&quot;</span><br>
<span style='color=#000000'>set&nbsp;&quot;col=<span class=c_pvar>%~3</span>&quot;</span><br>
<span style='color=#000000'>set&nbsp;&quot;pwd=&quot;</span><br>
<span style='color=#000000'>if&nbsp;not&nbsp;defined&nbsp;col&nbsp;set&nbsp;&quot;col=EF&quot;</span><br>
<span style='color=#000000'>if&nbsp;not&nbsp;defined&nbsp;tit&nbsp;set&nbsp;&quot;tit=Password:&quot;</span><br>
<span style='color=#000000'>set&nbsp;&quot;f=%temp%\<span class=c_pvar>%~nx0</span>.tmp~0.tmp&quot;</span><br>
<span style='color=#000000'>start&nbsp;&quot;%tit%&quot;&nbsp;/wait&nbsp;cmd&nbsp;/c&nbsp;&quot;mode&nbsp;con&nbsp;cols=24&nbsp;lines=1&amp;color&nbsp;%col%&amp;set&nbsp;/p&nbsp;&quot;in=&quot;&amp;call&nbsp;echo.<span class=c_pvar>%%i</span>n%%&gt;&quot;%f%&quot;&quot;</span><br>
<span style='color=#000000'>for&nbsp;/f&nbsp;&quot;usebackq&nbsp;tokens=*&quot;&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;(&quot;%f%&quot;)&nbsp;do&nbsp;set&nbsp;&quot;pwd=<span class=c_pvar>%%a</span>&quot;</span><br>
<span style='color=#000000'>del&nbsp;/q&nbsp;&quot;%f%&quot;</span><br>
<span style='color=#000000'>ENDLOCAL&amp;if&nbsp;&quot;<span class=c_pvar>%~1</span>&quot;&nbsp;NEQ&nbsp;&quot;&quot;&nbsp;(SET&nbsp;<span class=c_pvar>%~1</span>=%pwd%)&nbsp;ELSE&nbsp;ECHO.%txt%</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.regedit'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-03-14</font></font></div>
    <H2>:regedit - opens regedit at predefined location</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#regedit'>:regedit</a> key </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='regedit'>:regedit</a></span><span class=c_cmmt>&nbsp;key&nbsp;--&nbsp;opens&nbsp;regedit&nbsp;at&nbsp;predefined&nbsp;location</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;[IN]&nbsp;key&nbsp;-&nbsp;registry&nbsp;key&nbsp;to&nbsp;be&nbsp;shown&nbsp;after&nbsp;opening&nbsp;regedit</span></span><br>
<span style='color=#000000'>:$created&nbsp;20080314&nbsp;:$changed&nbsp;20080314&nbsp;:$categories&nbsp;Regedit,Registry</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL</span><br>
<span style='color=#000000'>REG&nbsp;ADD&nbsp;&quot;HKCU\Software\Microsoft\Windows\CurrentVersion\Applets\Regedit&quot;&nbsp;/v&nbsp;&quot;LastKey&quot;&nbsp;/f&nbsp;/d&nbsp;&quot;<span class=c_pvar>%~1</span>&quot;&gt;NUL</span><br>
<span style='color=#000000'>start&nbsp;/b&nbsp;regedit</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.removeArr'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:removeArr - removes an array</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#removeArr'>:removeArr</a> arr </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='removeArr'>:removeArr</a></span><span class=c_cmmt>&nbsp;arr&nbsp;--&nbsp;removes&nbsp;an&nbsp;array</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;arr&nbsp;[in]&nbsp;&nbsp;-&nbsp;array&nbsp;name</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219&nbsp;:$categories&nbsp;Array</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>for&nbsp;/f&nbsp;&quot;delims==&quot;&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;('&quot;set&nbsp;<span class=c_pvar>%~1</span>[&nbsp;2&gt;NUL&quot;')&nbsp;do&nbsp;set&nbsp;&quot;<span class=c_pvar>%%a</span>=&quot;</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.rTrim'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:rTrim - strips white spaces (or other characters) from the end of a string</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#rTrim'>:rTrim</a> string char max </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br><a name='13'>13.</a><br><a name='14'>14.</a><br><a name='15'>15.</a><br><a name='16'>16.</a><br><a name='17'>17.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='rTrim'>:rTrim</a></span><span class=c_cmmt>&nbsp;string&nbsp;char&nbsp;max&nbsp;--&nbsp;strips&nbsp;white&nbsp;spaces&nbsp;(or&nbsp;other&nbsp;characters)&nbsp;from&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;string</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;string&nbsp;[in,out]&nbsp;-&nbsp;string&nbsp;variable&nbsp;to&nbsp;be&nbsp;trimmed</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;char&nbsp;&nbsp;&nbsp;[in,opt]&nbsp;-&nbsp;character&nbsp;to&nbsp;be&nbsp;trimmed,&nbsp;default&nbsp;is&nbsp;space</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;max&nbsp;&nbsp;&nbsp;&nbsp;[in,opt]&nbsp;-&nbsp;maximum&nbsp;number&nbsp;of&nbsp;characters&nbsp;to&nbsp;be&nbsp;trimmed&nbsp;from&nbsp;the&nbsp;end,&nbsp;default&nbsp;is&nbsp;32</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219&nbsp;:$categories&nbsp;StringManipulation</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL&nbsp;ENABLEDELAYEDEXPANSION</span><br>
<span style='color=#000000'>call&nbsp;set&nbsp;string=%<span class=c_pvar>%%~1</span>%%</span><br>
<span style='color=#000000'>set&nbsp;char=<span class=c_pvar>%~2</span></span><br>
<span style='color=#000000'>set&nbsp;max=<span class=c_pvar>%~3</span></span><br>
<span style='color=#000000'>if&nbsp;&quot;%char%&quot;==&quot;&quot;&nbsp;set&nbsp;char=&nbsp;&amp;<span class=c_cmmt>rem&nbsp;one&nbsp;space</span></span><br>
<span style='color=#000000'>if&nbsp;&quot;%max%&quot;==&quot;&quot;&nbsp;set&nbsp;max=32</span><br>
<span style='color=#000000'>for&nbsp;/l&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;(1,1,%max%)&nbsp;do&nbsp;if&nbsp;&quot;!string:~-1!&quot;==&quot;%char%&quot;&nbsp;set&nbsp;string=!string:~0,-1!</span><br>
<span style='color=#000000'>(&nbsp;ENDLOCAL&nbsp;&amp;&nbsp;<span class=c_cmmt>REM&nbsp;RETURN&nbsp;VALUES</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&quot;<span class=c_pvar>%~1</span>&quot;&nbsp;NEQ&nbsp;&quot;&quot;&nbsp;SET&nbsp;<span class=c_pvar>%~1</span>=%string%</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.savePersistentVars'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:savePersistentVars - save values of persistent variables into a file</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#savePersistentVars'>:savePersistentVars</a> filename </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Dependencies:</td>
      <td class='text'  VALIGN='top'> <a href="#getVarsByAttr">:getVarsByAttr</a></td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='savePersistentVars'>:savePersistentVars</a></span><span class=c_cmmt>&nbsp;filename&nbsp;--&nbsp;save&nbsp;values&nbsp;of&nbsp;persistent&nbsp;variables&nbsp;into&nbsp;a&nbsp;file</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;filename&nbsp;[in]&nbsp;&nbsp;-&nbsp;file&nbsp;name&nbsp;used&nbsp;for&nbsp;storage</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219&nbsp;:$categories&nbsp;Persistency</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL&nbsp;ENABLEDELAYEDEXPANSION</span><br>
<span style='color=#000000'>type&nbsp;nul&gt;&quot;<span class=c_pvar>%~1</span>&quot;</span><br>
<span style='color=#000000'>call:getVarsByAttr&nbsp;persist&nbsp;vars</span><br>
<span style='color=#000000'>for&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;(%vars%)&nbsp;do&nbsp;(echo.SET&nbsp;<span class=c_pvar>%%a</span>=!<span class=c_pvar>%%a</span>!&gt;&gt;&quot;<span class=c_pvar>%~1</span>&quot;)</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.saveRegVars'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:saveRegVars - save values of persistent variables into a file</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#saveRegVars'>:saveRegVars</a> key </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Dependencies:</td>
      <td class='text'  VALIGN='top'> <a href="#getVarsByAttr">:getVarsByAttr</a>, <a href="#SetRegValue">:SetRegValue</a></td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='saveRegVars'>:saveRegVars</a></span><span class=c_cmmt>&nbsp;key&nbsp;--&nbsp;save&nbsp;values&nbsp;of&nbsp;persistent&nbsp;variables&nbsp;into&nbsp;a&nbsp;file</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;key&nbsp;[in]&nbsp;&nbsp;-&nbsp;registry&nbsp;key&nbsp;used&nbsp;for&nbsp;storage</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219&nbsp;:$categories&nbsp;Registry,Persistency</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL&nbsp;ENABLEDELAYEDEXPANSION</span><br>
<span style='color=#000000'>call:getVarsByAttr&nbsp;reg&nbsp;vars</span><br>
<span style='color=#000000'>for&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;(%vars%)&nbsp;do&nbsp;call:SetRegValue&nbsp;&quot;<span class=c_pvar>%~1</span>&quot;&nbsp;&quot;<span class=c_pvar>%%a</span>&quot;&nbsp;&quot;!<span class=c_pvar>%%a</span>!&quot;</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.set'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:set - sets var[] to output of command  / under construction</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#set'>:set</a> var=command </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Dependencies:</td>
      <td class='text'  VALIGN='top'> <a href="#removeArr">:removeArr</a></td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br><a name='13'>13.</a><br><a name='14'>14.</a><br><a name='15'>15.</a><br><a name='16'>16.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='set'>:set</a></span><span class=c_cmmt>&nbsp;var=command&nbsp;--&nbsp;sets&nbsp;var[]&nbsp;to&nbsp;output&nbsp;of&nbsp;command&nbsp;&nbsp;/&nbsp;under&nbsp;construction</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;var&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[out]&nbsp;varref&nbsp;of&nbsp;target&nbsp;variable</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;command&nbsp;[in]&nbsp;&nbsp;command&nbsp;to&nbsp;be&nbsp;parsed,&nbsp;i.e.&nbsp;ipconfig&nbsp;/all</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>for&nbsp;/f&nbsp;&quot;tokens=1,*&nbsp;delims==&quot;&nbsp;<span class=c_pvar>%%x</span>&nbsp;in&nbsp;(&quot;%*&quot;)&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;call:removeArr&nbsp;&quot;<span class=c_pvar>%%x</span>&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&quot;<span class=c_pvar>%%y</span>&quot;&nbsp;NEQ&nbsp;&quot;&quot;&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;/f&nbsp;&quot;tokens=1,2&nbsp;delims=]&quot;&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;('&quot;<span class=c_pvar>%%y</span>|find&nbsp;/n&nbsp;/v&nbsp;&quot;&quot;&quot;')&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;&quot;<span class=c_pvar>%%x</span><span class=c_pvar>%%a</span>]=<span class=c_pvar>%%b</span>&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;&quot;<span class=c_pvar>%%x</span>[#]=<span class=c_pvar>%%a</span>&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)&amp;&amp;call&nbsp;set&nbsp;&quot;<span class=c_pvar>%%x</span>[#]=%%<span class=c_pvar>%%x</span>[#]:~1%%&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;)</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;set&nbsp;&quot;<span class=c_pvar>%%x</span>=%%<span class=c_pvar>%%x</span>[1]%%&quot;</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.SetRegValue'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:SetRegValue - sets a registry value</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#SetRegValue'>:SetRegValue</a> Key Value Data Type </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br><a name='13'>13.</a><br><a name='14'>14.</a><br><a name='15'>15.</a><br><a name='16'>16.</a><br><a name='17'>17.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='SetRegValue'>:SetRegValue</a></span><span class=c_cmmt>&nbsp;Key&nbsp;Value&nbsp;Data&nbsp;Type&nbsp;--&nbsp;sets&nbsp;a&nbsp;registry&nbsp;value</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;Key&nbsp;&nbsp;&nbsp;&nbsp;[in]&nbsp;&nbsp;-&nbsp;registry&nbsp;key</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;Value&nbsp;&nbsp;[in]&nbsp;&nbsp;-&nbsp;registry&nbsp;value</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;Data&nbsp;&nbsp;&nbsp;[in]&nbsp;&nbsp;-&nbsp;(optional)&nbsp;data</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;Type&nbsp;&nbsp;&nbsp;[in]&nbsp;&nbsp;-&nbsp;(optional)&nbsp;data&nbsp;type,&nbsp;i.e.:&nbsp;REG_SZ,&nbsp;REG_MULTI_SZ,&nbsp;REG_DWORD_BIG_ENDIAN,&nbsp;REG_DWORD,&nbsp;REG_BINARY,&nbsp;REG_DWORD_LITTLE_ENDIAN,&nbsp;REG_NONE,&nbsp;REG_EXPAND_SZ</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219&nbsp;:$categories&nbsp;Registry</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL</span><br>
<span style='color=#000000'>set&nbsp;Key=<span class=c_pvar>%~1</span></span><br>
<span style='color=#000000'>set&nbsp;Val=<span class=c_pvar>%~2</span></span><br>
<span style='color=#000000'>set&nbsp;Data=<span class=c_pvar>%~3</span></span><br>
<span style='color=#000000'>set&nbsp;Type=<span class=c_pvar>%~4</span></span><br>
<span style='color=#000000'>if&nbsp;&quot;%Val%&quot;&nbsp;NEQ&nbsp;&quot;&quot;&nbsp;set&nbsp;Val=/v&nbsp;&quot;%Val%&quot;</span><br>
<span style='color=#000000'>if&nbsp;&quot;%Data%&quot;&nbsp;NEQ&nbsp;&quot;&quot;&nbsp;set&nbsp;Data=/d&nbsp;&quot;%Data%&quot;</span><br>
<span style='color=#000000'>if&nbsp;&quot;%Type%&quot;&nbsp;NEQ&nbsp;&quot;&quot;&nbsp;set&nbsp;Type=/t&nbsp;%Type%</span><br>
<span style='color=#000000'>reg&nbsp;add&nbsp;&quot;%Key%&quot;&nbsp;%Val%&nbsp;%Type%&nbsp;%Data%&nbsp;/f&gt;NUL</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.sleep'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:sleep - waits some seconds before returning</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#sleep'>:sleep</a> seconds </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='sleep'>:sleep</a></span><span class=c_cmmt>&nbsp;seconds&nbsp;--&nbsp;waits&nbsp;some&nbsp;seconds&nbsp;before&nbsp;returning</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;seconds&nbsp;[in]&nbsp;&nbsp;-&nbsp;number&nbsp;of&nbsp;seconds&nbsp;to&nbsp;wait</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>FOR&nbsp;/l&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;(<span class=c_pvar>%~1</span>,-1,1)&nbsp;do&nbsp;(ping&nbsp;-n&nbsp;2&nbsp;-w&nbsp;1&nbsp;127.0.0.1&gt;NUL)</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.StartsWith'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-03-20</font></font></div>
    <H2>:StartsWith - Tests if a text starts with a given string</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#StartsWith'>:StartsWith</a> text string </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='StartsWith'>:StartsWith</a></span><span class=c_cmmt>&nbsp;text&nbsp;string&nbsp;--&nbsp;Tests&nbsp;if&nbsp;a&nbsp;text&nbsp;starts&nbsp;with&nbsp;a&nbsp;given&nbsp;string</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;[IN]&nbsp;text&nbsp;&nbsp;&nbsp;-&nbsp;text&nbsp;to&nbsp;be&nbsp;searched</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;[IN]&nbsp;string&nbsp;-&nbsp;string&nbsp;to&nbsp;be&nbsp;tested&nbsp;for</span></span><br>
<span style='color=#000000'>:$created&nbsp;20080320&nbsp;:$changed&nbsp;20080320&nbsp;:$categories&nbsp;StringOperation,Condition</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL</span><br>
<span style='color=#000000'>set&nbsp;&quot;txt=<span class=c_pvar>%~1</span>&quot;</span><br>
<span style='color=#000000'>set&nbsp;&quot;str=<span class=c_pvar>%~2</span>&quot;</span><br>
<span style='color=#000000'>if&nbsp;defined&nbsp;str&nbsp;call&nbsp;set&nbsp;&quot;s=%str%<span class=c_pvar>%%t</span>xt:*%str%=%%&quot;</span><br>
<span style='color=#000000'>if&nbsp;/i&nbsp;&quot;%txt%&quot;&nbsp;NEQ&nbsp;&quot;%s%&quot;&nbsp;set=2&gt;NUL</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.strLen'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2010-11-16</font></font></div>
    <H2>:strLen - returns the length of a string</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#strLen'>:strLen</a> string len </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br><a name='13'>13.</a><br><a name='14'>14.</a><br><a name='15'>15.</a><br><a name='16'>16.</a><br><a name='17'>17.</a><br><a name='18'>18.</a><br><a name='19'>19.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='strLen'>:strLen</a></span><span class=c_cmmt>&nbsp;string&nbsp;len&nbsp;--&nbsp;returns&nbsp;the&nbsp;length&nbsp;of&nbsp;a&nbsp;string</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;string&nbsp;[in]&nbsp;&nbsp;-&nbsp;variable&nbsp;name&nbsp;containing&nbsp;the&nbsp;string&nbsp;being&nbsp;measured&nbsp;for&nbsp;length</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;len&nbsp;&nbsp;&nbsp;&nbsp;[out]&nbsp;-&nbsp;variable&nbsp;to&nbsp;be&nbsp;used&nbsp;to&nbsp;return&nbsp;the&nbsp;string&nbsp;length</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;Many&nbsp;thanks&nbsp;to&nbsp;'sowgtsoi',&nbsp;but&nbsp;also&nbsp;'jeb'&nbsp;and&nbsp;'amel27'&nbsp;dostips&nbsp;forum&nbsp;users&nbsp;helped&nbsp;making&nbsp;this&nbsp;short&nbsp;and&nbsp;efficient</span></span><br>
<span style='color=#000000'>:$created&nbsp;20081122&nbsp;:$changed&nbsp;20101116&nbsp;:$categories&nbsp;StringOperation</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>(&nbsp;&nbsp;&nbsp;SETLOCAL&nbsp;ENABLEDELAYEDEXPANSION</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;&quot;str=A!<span class=c_pvar>%~1</span>!&quot;&amp;<span class=c_cmmt>rem&nbsp;keep&nbsp;the&nbsp;A&nbsp;up&nbsp;front&nbsp;to&nbsp;ensure&nbsp;we&nbsp;get&nbsp;the&nbsp;length&nbsp;and&nbsp;not&nbsp;the&nbsp;upper&nbsp;bound</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=c_cmmt>rem&nbsp;it&nbsp;also&nbsp;avoids&nbsp;trouble&nbsp;in&nbsp;case&nbsp;of&nbsp;empty&nbsp;string</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;&quot;len=0&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;/L&nbsp;<span class=c_pvar>%%A</span>&nbsp;in&nbsp;(12,-1,0)&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;/a&nbsp;&quot;len|=1&lt;&lt;<span class=c_pvar>%%A</span>&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;<span class=c_pvar>%%B</span>&nbsp;in&nbsp;(!len!)&nbsp;do&nbsp;if&nbsp;&quot;!str:~<span class=c_pvar>%%B</span>,1!&quot;==&quot;&quot;&nbsp;set&nbsp;/a&nbsp;&quot;len&amp;=~1&lt;&lt;<span class=c_pvar>%%A</span>&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;)</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>(&nbsp;ENDLOCAL&nbsp;&amp;&nbsp;<span class=c_cmmt>REM&nbsp;RETURN&nbsp;VALUES</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&quot;<span class=c_pvar>%~2</span>&quot;&nbsp;NEQ&nbsp;&quot;&quot;&nbsp;SET&nbsp;/a&nbsp;<span class=c_pvar>%~2</span>=%len%</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.substitute'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2010-11-22</font></font></div>
    <H2>:substitute - substitutes a string in a text file</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#substitute'>:substitute</a> OldStr NewStr File </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br><a name='13'>13.</a><br><a name='14'>14.</a><br><a name='15'>15.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='substitute'>:substitute</a></span><span class=c_cmmt>&nbsp;OldStr&nbsp;NewStr&nbsp;File&nbsp;--&nbsp;substitutes&nbsp;a&nbsp;string&nbsp;in&nbsp;a&nbsp;text&nbsp;file</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;OldStr&nbsp;[in]&nbsp;-&nbsp;string&nbsp;to&nbsp;be&nbsp;replaced</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;NewStr&nbsp;[in]&nbsp;-&nbsp;string&nbsp;to&nbsp;replace&nbsp;with</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;File&nbsp;&nbsp;&nbsp;[in]&nbsp;-&nbsp;file&nbsp;to&nbsp;be&nbsp;parsed</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20101122&nbsp;:$categories&nbsp;FileManipulation</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL&nbsp;DISABLEDELAYEDEXPANSION</span><br>
<span style='color=#000000'>for&nbsp;/f&nbsp;&quot;tokens=1,*&nbsp;delims=]&quot;&nbsp;<span class=c_pvar>%%A</span>&nbsp;in&nbsp;('&quot;type&nbsp;%3|find&nbsp;/n&nbsp;/v&nbsp;&quot;&quot;&quot;')&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;&quot;line=<span class=c_pvar>%%B</span>&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;defined&nbsp;line&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;set&nbsp;&quot;line=echo.<span class=c_pvar>%%l</span>ine:<span class=c_pvar>%~1</span>=<span class=c_pvar>%~2</span>%%&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;/f&nbsp;&quot;delims=&quot;&nbsp;<span class=c_pvar>%%X</span>&nbsp;in&nbsp;('&quot;echo.&quot;<span class=c_pvar>%%l</span>ine%%&quot;&quot;')&nbsp;do&nbsp;<span class=c_pvar>%%~X</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;ELSE&nbsp;echo.</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.ToANSI'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:ToANSI - converts a file to ANSI</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#ToANSI'>:ToANSI</a> src dst </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br><a name='13'>13.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='ToANSI'>:ToANSI</a></span><span class=c_cmmt>&nbsp;src&nbsp;dst&nbsp;--&nbsp;converts&nbsp;a&nbsp;file&nbsp;to&nbsp;ANSI</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;src&nbsp;[in]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;source&nbsp;file&nbsp;name&nbsp;to&nbsp;be&nbsp;converted</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;trg&nbsp;[in,opt]&nbsp;-&nbsp;target&nbsp;file&nbsp;name,&nbsp;leave&nbsp;blank&nbsp;for&nbsp;in-place&nbsp;conversion</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219&nbsp;:$categories&nbsp;Encoding</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL</span><br>
<span style='color=#000000'>set&nbsp;src=<span class=c_pvar>%~1</span></span><br>
<span style='color=#000000'>set&nbsp;trg=<span class=c_pvar>%~2</span></span><br>
<span style='color=#000000'>set&nbsp;tmp=%temp%.\<span class=c_pvar>%~nx1</span></span><br>
<span style='color=#000000'>if&nbsp;&quot;%trg%&quot;==&quot;&quot;&nbsp;set&nbsp;trg=%src%</span><br>
<span style='color=#000000'>cmd&nbsp;/A&nbsp;/c&nbsp;type&nbsp;&quot;%src%&quot;&gt;&quot;%tmp%&quot;</span><br>
<span style='color=#000000'>move&nbsp;/y&nbsp;&quot;%tmp%&quot;&nbsp;&quot;%trg%&quot;</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.toCamelCase'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:toCamelCase - converts a string to camel case</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#toCamelCase'>:toCamelCase</a> str </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br><a name='13'>13.</a><br><a name='14'>14.</a><br><a name='15'>15.</a><br><a name='16'>16.</a><br><a name='17'>17.</a><br><a name='18'>18.</a><br><a name='19'>19.</a><br><a name='20'>20.</a><br><a name='21'>21.</a><br><a name='22'>22.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='toCamelCase'>:toCamelCase</a></span><span class=c_cmmt>&nbsp;str&nbsp;--&nbsp;converts&nbsp;a&nbsp;string&nbsp;to&nbsp;camel&nbsp;case</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;str&nbsp;[in,out]&nbsp;-&nbsp;valref&nbsp;of&nbsp;string&nbsp;variable&nbsp;to&nbsp;be&nbsp;converted</span></span><br>
<span style='color=#000000'>:$created&nbsp;20080219&nbsp;:$changed&nbsp;20080219&nbsp;:$categories&nbsp;StringManipulation</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>if&nbsp;not&nbsp;defined&nbsp;<span class=c_pvar>%~1</span>&nbsp;EXIT&nbsp;/b</span><br>
<span style='color=#000000'><span class=c_cmmt>REM&nbsp;make&nbsp;all&nbsp;lower&nbsp;case</span></span><br>
<span style='color=#000000'>for&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;(&quot;A=a&quot;&nbsp;&quot;B=b&quot;&nbsp;&quot;C=c&quot;&nbsp;&quot;D=d&quot;&nbsp;&quot;E=e&quot;&nbsp;&quot;F=f&quot;&nbsp;&quot;G=g&quot;&nbsp;&quot;H=h&quot;&nbsp;&quot;I=i&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;J=j&quot;&nbsp;&quot;K=k&quot;&nbsp;&quot;L=l&quot;&nbsp;&quot;M=m&quot;&nbsp;&quot;N=n&quot;&nbsp;&quot;O=o&quot;&nbsp;&quot;P=p&quot;&nbsp;&quot;Q=q&quot;&nbsp;&quot;R=r&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;S=s&quot;&nbsp;&quot;T=t&quot;&nbsp;&quot;U=u&quot;&nbsp;&quot;V=v&quot;&nbsp;&quot;W=w&quot;&nbsp;&quot;X=x&quot;&nbsp;&quot;Y=y&quot;&nbsp;&quot;Z=z&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&Auml;=&auml;&quot;&nbsp;&quot;&Ouml;=&ouml;&quot;&nbsp;&quot;&Uuml;=&uuml;&quot;)&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;set&nbsp;&quot;<span class=c_pvar>%~1</span>=%<span class=c_pvar>%%~1</span>:<span class=c_pvar>%%~a</span>%%&quot;</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>call&nbsp;set&nbsp;&quot;<span class=c_pvar>%~1</span>=&nbsp;%<span class=c_pvar>%%~1</span>%%&quot;</span><br>
<span style='color=#000000'><span class=c_cmmt>REM&nbsp;make&nbsp;first&nbsp;character&nbsp;upper&nbsp;case</span></span><br>
<span style='color=#000000'>for&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;(&quot;&nbsp;a=A&quot;&nbsp;&quot;&nbsp;b=B&quot;&nbsp;&quot;&nbsp;c=C&quot;&nbsp;&quot;&nbsp;d=D&quot;&nbsp;&quot;&nbsp;e=E&quot;&nbsp;&quot;&nbsp;f=F&quot;&nbsp;&quot;&nbsp;g=G&quot;&nbsp;&quot;&nbsp;h=H&quot;&nbsp;&quot;&nbsp;i=I&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&nbsp;j=J&quot;&nbsp;&quot;&nbsp;k=K&quot;&nbsp;&quot;&nbsp;l=L&quot;&nbsp;&quot;&nbsp;m=M&quot;&nbsp;&quot;&nbsp;n=N&quot;&nbsp;&quot;&nbsp;o=O&quot;&nbsp;&quot;&nbsp;p=P&quot;&nbsp;&quot;&nbsp;q=Q&quot;&nbsp;&quot;&nbsp;r=R&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&nbsp;s=S&quot;&nbsp;&quot;&nbsp;t=T&quot;&nbsp;&quot;&nbsp;u=U&quot;&nbsp;&quot;&nbsp;v=V&quot;&nbsp;&quot;&nbsp;w=W&quot;&nbsp;&quot;&nbsp;x=X&quot;&nbsp;&quot;&nbsp;y=Y&quot;&nbsp;&quot;&nbsp;z=Z&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&nbsp;&auml;=&Auml;&quot;&nbsp;&quot;&nbsp;&ouml;=&Ouml;&quot;&nbsp;&quot;&nbsp;&uuml;=&Uuml;&quot;)&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;set&nbsp;&quot;<span class=c_pvar>%~1</span>=%<span class=c_pvar>%%~1</span>:<span class=c_pvar>%%~a</span>%%&quot;</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>call&nbsp;set&nbsp;&quot;<span class=c_pvar>%~1</span>=%<span class=c_pvar>%%~1</span>:&nbsp;=%%&quot;</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.toDec'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2009-12-03</font></font></div>
    <H2>:toDec - convert a hexadecimal number to decimal</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#toDec'>:toDec</a> hex dec </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='toDec'>:toDec</a></span><span class=c_cmmt>&nbsp;hex&nbsp;dec&nbsp;--&nbsp;convert&nbsp;a&nbsp;hexadecimal&nbsp;number&nbsp;to&nbsp;decimal</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;hex&nbsp;[in]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;hexadecimal&nbsp;number&nbsp;to&nbsp;convert</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;dec&nbsp;[out,opt]&nbsp;-&nbsp;variable&nbsp;to&nbsp;store&nbsp;the&nbsp;converted&nbsp;decimal&nbsp;number&nbsp;in</span></span><br>
<span style='color=#000000'>:$created&nbsp;20091203&nbsp;:$changed&nbsp;20091203&nbsp;:$categories&nbsp;Arithmetic,Encoding</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL</span><br>
<span style='color=#000000'>set&nbsp;/a&nbsp;dec=0x<span class=c_pvar>%~1</span></span><br>
<span style='color=#000000'>(&nbsp;ENDLOCAL&nbsp;&amp;&nbsp;<span class=c_cmmt>REM&nbsp;RETURN&nbsp;VALUES</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&quot;<span class=c_pvar>%~2</span>&quot;&nbsp;NEQ&nbsp;&quot;&quot;&nbsp;(SET&nbsp;<span class=c_pvar>%~2</span>=%dec%)&nbsp;ELSE&nbsp;ECHO.%dec%</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.toHex'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2011-03-30</font></font></div>
    <H2>:toHex - convert a decimal number to hexadecimal, i.e. -20 to FFFFFFEC or 26 to 0000001A</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#toHex'>:toHex</a> dec hex </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br><a name='13'>13.</a><br><a name='14'>14.</a><br><a name='15'>15.</a><br><a name='16'>16.</a><br><a name='17'>17.</a><br><a name='18'>18.</a><br><a name='19'>19.</a><br><a name='20'>20.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='toHex'>:toHex</a></span><span class=c_cmmt>&nbsp;dec&nbsp;hex&nbsp;--&nbsp;convert&nbsp;a&nbsp;decimal&nbsp;number&nbsp;to&nbsp;hexadecimal,&nbsp;i.e.&nbsp;-20&nbsp;to&nbsp;FFFFFFEC&nbsp;or&nbsp;26&nbsp;to&nbsp;0000001A</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;dec&nbsp;[in]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;decimal&nbsp;number&nbsp;to&nbsp;convert</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;hex&nbsp;[out,opt]&nbsp;-&nbsp;variable&nbsp;to&nbsp;store&nbsp;the&nbsp;converted&nbsp;hexadecimal&nbsp;number&nbsp;in</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::Thanks&nbsp;to&nbsp;'dbenham'&nbsp;dostips&nbsp;forum&nbsp;users&nbsp;who&nbsp;inspired&nbsp;to&nbsp;improve&nbsp;this&nbsp;function</span></span><br>
<span style='color=#000000'>:$created&nbsp;20091203&nbsp;:$changed&nbsp;20110330&nbsp;:$categories&nbsp;Arithmetic,Encoding</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL&nbsp;ENABLEDELAYEDEXPANSION</span><br>
<span style='color=#000000'>set&nbsp;/a&nbsp;dec=<span class=c_pvar>%~1</span></span><br>
<span style='color=#000000'>set&nbsp;&quot;hex=&quot;</span><br>
<span style='color=#000000'>set&nbsp;&quot;map=0123456789ABCDEF&quot;</span><br>
<span style='color=#000000'>for&nbsp;/L&nbsp;<span class=c_pvar>%%N</span>&nbsp;in&nbsp;(1,1,8)&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;/a&nbsp;&quot;d=dec&amp;15,dec&gt;&gt;=4&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;<span class=c_pvar>%%D</span>&nbsp;in&nbsp;(!d!)&nbsp;do&nbsp;set&nbsp;&quot;hex=!map:~<span class=c_pvar>%%D</span>,1!!hex!&quot;</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'><span class=c_cmmt>rem&nbsp;!!!!&nbsp;REMOVE&nbsp;LEADING&nbsp;ZEROS&nbsp;by&nbsp;activating&nbsp;the&nbsp;next&nbsp;line,&nbsp;e.g.&nbsp;will&nbsp;return&nbsp;1A&nbsp;instead&nbsp;of&nbsp;0000001A</span></span><br>
<span style='color=#000000'><span class=c_cmmt>rem&nbsp;for&nbsp;/f&nbsp;&quot;tokens=*&nbsp;delims=0&quot;&nbsp;<span class=c_pvar>%%A</span>&nbsp;in&nbsp;(&quot;%hex%&quot;)&nbsp;do&nbsp;set&nbsp;&quot;hex=<span class=c_pvar>%%A</span>&quot;&amp;if&nbsp;not&nbsp;defined&nbsp;hex&nbsp;set&nbsp;&quot;hex=0&quot;</span></span><br>
<span style='color=#000000'>(&nbsp;ENDLOCAL&nbsp;&amp;&nbsp;<span class=c_cmmt>REM&nbsp;RETURN&nbsp;VALUES</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&quot;<span class=c_pvar>%~2</span>&quot;&nbsp;NEQ&nbsp;&quot;&quot;&nbsp;(SET&nbsp;<span class=c_pvar>%~2</span>=%hex%)&nbsp;ELSE&nbsp;ECHO.%hex%</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.toLower'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:toLower - converts uppercase character to lowercase</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#toLower'>:toLower</a> str </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='toLower'>:toLower</a></span><span class=c_cmmt>&nbsp;str&nbsp;--&nbsp;converts&nbsp;uppercase&nbsp;character&nbsp;to&nbsp;lowercase</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;str&nbsp;[in,out]&nbsp;-&nbsp;valref&nbsp;of&nbsp;string&nbsp;variable&nbsp;to&nbsp;be&nbsp;converted</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219&nbsp;:$categories&nbsp;StringManipulation</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>if&nbsp;not&nbsp;defined&nbsp;<span class=c_pvar>%~1</span>&nbsp;EXIT&nbsp;/b</span><br>
<span style='color=#000000'>for&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;(&quot;A=a&quot;&nbsp;&quot;B=b&quot;&nbsp;&quot;C=c&quot;&nbsp;&quot;D=d&quot;&nbsp;&quot;E=e&quot;&nbsp;&quot;F=f&quot;&nbsp;&quot;G=g&quot;&nbsp;&quot;H=h&quot;&nbsp;&quot;I=i&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;J=j&quot;&nbsp;&quot;K=k&quot;&nbsp;&quot;L=l&quot;&nbsp;&quot;M=m&quot;&nbsp;&quot;N=n&quot;&nbsp;&quot;O=o&quot;&nbsp;&quot;P=p&quot;&nbsp;&quot;Q=q&quot;&nbsp;&quot;R=r&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;S=s&quot;&nbsp;&quot;T=t&quot;&nbsp;&quot;U=u&quot;&nbsp;&quot;V=v&quot;&nbsp;&quot;W=w&quot;&nbsp;&quot;X=x&quot;&nbsp;&quot;Y=y&quot;&nbsp;&quot;Z=z&quot;&nbsp;&quot;&Auml;=&auml;&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&Ouml;=&ouml;&quot;&nbsp;&quot;&Uuml;=&uuml;&quot;)&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;set&nbsp;<span class=c_pvar>%~1</span>=%<span class=c_pvar>%%~1</span>:<span class=c_pvar>%%~a</span>%%</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.ToUNICODE'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:ToUNICODE - converts a file to UNICODE</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#ToUNICODE'>:ToUNICODE</a> src dst </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br><a name='13'>13.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='ToUNICODE'>:ToUNICODE</a></span><span class=c_cmmt>&nbsp;src&nbsp;dst&nbsp;--&nbsp;converts&nbsp;a&nbsp;file&nbsp;to&nbsp;UNICODE</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;src&nbsp;[in]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;source&nbsp;file&nbsp;name&nbsp;to&nbsp;be&nbsp;converted</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;trg&nbsp;[in,opt]&nbsp;-&nbsp;target&nbsp;file&nbsp;name,&nbsp;leave&nbsp;blank&nbsp;for&nbsp;in-place&nbsp;conversion</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219&nbsp;:$categories&nbsp;Encoding</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL</span><br>
<span style='color=#000000'>set&nbsp;src=<span class=c_pvar>%~1</span></span><br>
<span style='color=#000000'>set&nbsp;trg=<span class=c_pvar>%~2</span></span><br>
<span style='color=#000000'>set&nbsp;tmp=%temp%.\<span class=c_pvar>%~nx1</span></span><br>
<span style='color=#000000'>if&nbsp;&quot;%trg%&quot;==&quot;&quot;&nbsp;set&nbsp;trg=%src%</span><br>
<span style='color=#000000'>cmd&nbsp;/U&nbsp;/c&nbsp;type&nbsp;&quot;%src%&quot;&gt;&quot;%tmp%&quot;</span><br>
<span style='color=#000000'>move&nbsp;/y&nbsp;&quot;%tmp%&quot;&nbsp;&quot;%trg%&quot;</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.toUpper'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:toUpper - converts lowercase character to uppercase</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#toUpper'>:toUpper</a> str </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='toUpper'>:toUpper</a></span><span class=c_cmmt>&nbsp;str&nbsp;--&nbsp;converts&nbsp;lowercase&nbsp;character&nbsp;to&nbsp;uppercase</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;str&nbsp;[in,out]&nbsp;-&nbsp;valref&nbsp;of&nbsp;string&nbsp;variable&nbsp;to&nbsp;be&nbsp;converted</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219&nbsp;:$categories&nbsp;StringManipulation</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>if&nbsp;not&nbsp;defined&nbsp;<span class=c_pvar>%~1</span>&nbsp;EXIT&nbsp;/b</span><br>
<span style='color=#000000'>for&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;(&quot;a=A&quot;&nbsp;&quot;b=B&quot;&nbsp;&quot;c=C&quot;&nbsp;&quot;d=D&quot;&nbsp;&quot;e=E&quot;&nbsp;&quot;f=F&quot;&nbsp;&quot;g=G&quot;&nbsp;&quot;h=H&quot;&nbsp;&quot;i=I&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;j=J&quot;&nbsp;&quot;k=K&quot;&nbsp;&quot;l=L&quot;&nbsp;&quot;m=M&quot;&nbsp;&quot;n=N&quot;&nbsp;&quot;o=O&quot;&nbsp;&quot;p=P&quot;&nbsp;&quot;q=Q&quot;&nbsp;&quot;r=R&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;s=S&quot;&nbsp;&quot;t=T&quot;&nbsp;&quot;u=U&quot;&nbsp;&quot;v=V&quot;&nbsp;&quot;w=W&quot;&nbsp;&quot;x=X&quot;&nbsp;&quot;y=Y&quot;&nbsp;&quot;z=Z&quot;&nbsp;&quot;&auml;=&Auml;&quot;</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&ouml;=&Ouml;&quot;&nbsp;&quot;&uuml;=&Uuml;&quot;)&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;set&nbsp;<span class=c_pvar>%~1</span>=%<span class=c_pvar>%%~1</span>:<span class=c_pvar>%%~a</span>%%</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.Trim'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:Trim - strip white spaces (or other characters) from the beginning and end of a string</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#Trim'>:Trim</a> string char max </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Dependencies:</td>
      <td class='text'  VALIGN='top'> <a href="#lTrim">:lTrim</a>, <a href="#rTrim">:rTrim</a></td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='Trim'>:Trim</a></span><span class=c_cmmt>&nbsp;string&nbsp;char&nbsp;max&nbsp;--&nbsp;strip&nbsp;white&nbsp;spaces&nbsp;(or&nbsp;other&nbsp;characters)&nbsp;from&nbsp;the&nbsp;beginning&nbsp;and&nbsp;end&nbsp;of&nbsp;a&nbsp;string</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;string&nbsp;[in,out]&nbsp;-&nbsp;string&nbsp;variable&nbsp;to&nbsp;be&nbsp;trimmed</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;char&nbsp;&nbsp;&nbsp;[in,opt]&nbsp;-&nbsp;character&nbsp;to&nbsp;be&nbsp;trimmed,&nbsp;default&nbsp;is&nbsp;space</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;max&nbsp;&nbsp;&nbsp;&nbsp;[in,opt]&nbsp;-&nbsp;maximum&nbsp;number&nbsp;of&nbsp;characters&nbsp;to&nbsp;be&nbsp;trimmed&nbsp;from&nbsp;the&nbsp;end,&nbsp;default&nbsp;is&nbsp;32</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219&nbsp;:$categories&nbsp;StringManipulation</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>call:lTrim&nbsp;&quot;<span class=c_pvar>%~1</span>&quot;&nbsp;&quot;<span class=c_pvar>%~2</span>&quot;</span><br>
<span style='color=#000000'>call:rTrim&nbsp;&quot;<span class=c_pvar>%~1</span>&quot;&nbsp;&quot;<span class=c_pvar>%~2</span>&quot;&nbsp;&quot;<span class=c_pvar>%~3</span>&quot;</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.trimSpaces'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-23</font></font></div>
    <H2>:trimSpaces - trims spaces around string variable</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#trimSpaces'>:trimSpaces</a> varref </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Dependencies:</td>
      <td class='text'  VALIGN='top'> <a href="#trimSpaces2">:trimSpaces2</a></td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='trimSpaces'>:trimSpaces</a></span><span class=c_cmmt>&nbsp;varref&nbsp;--&nbsp;trims&nbsp;spaces&nbsp;around&nbsp;string&nbsp;variable</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;varref&nbsp;[in,out]&nbsp;-&nbsp;variable&nbsp;to&nbsp;be&nbsp;trimmed</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080223&nbsp;:$categories&nbsp;StringManipulation</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>call&nbsp;call:trimSpaces2&nbsp;<span class=c_pvar>%~1</span>&nbsp;%<span class=c_pvar>%%~1</span>%%</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.trimSpaces2'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:trimSpaces2 - trims spaces around string and assigns result to variable</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#trimSpaces2'>:trimSpaces2</a> retval string </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='trimSpaces2'>:trimSpaces2</a></span><span class=c_cmmt>&nbsp;retval&nbsp;string&nbsp;--&nbsp;trims&nbsp;spaces&nbsp;around&nbsp;string&nbsp;and&nbsp;assigns&nbsp;result&nbsp;to&nbsp;variable</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;retvar&nbsp;[out]&nbsp;variable&nbsp;name&nbsp;to&nbsp;store&nbsp;the&nbsp;result&nbsp;in</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;string&nbsp;[in]&nbsp;&nbsp;string&nbsp;to&nbsp;trim,&nbsp;must&nbsp;not&nbsp;be&nbsp;in&nbsp;quotes</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219&nbsp;:$categories&nbsp;StringManipulation</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>for&nbsp;/f&nbsp;&quot;tokens=1*&quot;&nbsp;<span class=c_pvar>%%A</span>&nbsp;in&nbsp;(&quot;%*&quot;)&nbsp;do&nbsp;set&nbsp;&quot;<span class=c_pvar>%%A</span>=<span class=c_pvar>%%B</span>&quot;</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.true'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:true - returns success</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#true'>:true</a> </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='true'>:true</a></span><span class=c_cmmt>&nbsp;--&nbsp;returns&nbsp;success</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'><span class=c_cmmt>rem</span></span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name=''></a>
    <a name='Function.Unique'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-02-19</font></font></div>
    <H2>:Unique - returns a unique string based on a date-time-stamp, YYYYMMDDhhmmsscc</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>call<a href='#Unique'>:Unique</a> ret </td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br><a name='12'>12.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='Unique'>:Unique</a></span><span class=c_cmmt>&nbsp;ret&nbsp;--&nbsp;returns&nbsp;a&nbsp;unique&nbsp;string&nbsp;based&nbsp;on&nbsp;a&nbsp;date-time-stamp,&nbsp;YYYYMMDDhhmmsscc</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;ret&nbsp;&nbsp;&nbsp;&nbsp;[out,opt]&nbsp;-&nbsp;unique&nbsp;string</span></span><br>
<span style='color=#000000'>:$created&nbsp;20060101&nbsp;:$changed&nbsp;20080219&nbsp;:$categories&nbsp;StringOperation,DateAndTime</span><br>
<span style='color=#000000'>:$source&nbsp;https://www.dostips.com</span><br>
<span style='color=#000000'>SETLOCAL</span><br>
<span style='color=#000000'>for&nbsp;/f&nbsp;&quot;skip=1&nbsp;tokens=2-4&nbsp;delims=(-)&quot;&nbsp;<span class=c_pvar>%%a</span>&nbsp;in&nbsp;('&quot;echo.|date&quot;')&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;/f&nbsp;&quot;tokens=1-3&nbsp;delims=/.-&nbsp;&quot;&nbsp;<span class=c_pvar>%%A</span>&nbsp;in&nbsp;(&quot;%date:*&nbsp;=%&quot;)&nbsp;do&nbsp;(</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;<span class=c_pvar>%%a</span>=<span class=c_pvar>%%A</span>&amp;set&nbsp;<span class=c_pvar>%%b</span>=<span class=c_pvar>%%B</span>&amp;set&nbsp;<span class=c_pvar>%%c</span>=<span class=c_pvar>%%C</span>))</span><br>
<span style='color=#000000'>set&nbsp;/a&nbsp;&quot;yy=10000%yy%&nbsp;<span class=c_pvar>%%1</span>0000,mm=100%mm%&nbsp;%%&nbsp;100,dd=100%dd%&nbsp;%%&nbsp;100&quot;</span><br>
<span style='color=#000000'>for&nbsp;/f&nbsp;&quot;tokens=1-4&nbsp;delims=:.&nbsp;&quot;&nbsp;<span class=c_pvar>%%A</span>&nbsp;in&nbsp;(&quot;%time:&nbsp;=0%&quot;)&nbsp;do&nbsp;@set&nbsp;UNIQUE=%yy<span class=c_pvar>%%m</span>m<span class=c_pvar>%%d</span>d%<span class=c_pvar>%%A</span><span class=c_pvar>%%B</span><span class=c_pvar>%%C</span><span class=c_pvar>%%D</span></span><br>
<span style='color=#000000'>ENDLOCAL&nbsp;&amp;&nbsp;IF&nbsp;&quot;<span class=c_pvar>%~1</span>&quot;&nbsp;NEQ&nbsp;&quot;&quot;&nbsp;(SET&nbsp;<span class=c_pvar>%~1</span>=%UNIQUE%)&nbsp;ELSE&nbsp;echo.%UNIQUE%</span><br>
<span style='color=#000000'>EXIT&nbsp;/b</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
    <hr>
    <a name='_Toc145951131'></a>
    <a name='Batch.FunctionTemplate'></a>
    <div style='float: right;'><font color='darkblue'><a href='#'>TOP</a><br><font size=1>2008-01-01</font></font></div>
    <H2>DOS Function Template - A function template with all features of a true DOS function</H2>
  <table class='posts'>
    <tr>
      <td class='title' VALIGN='top'>Description:</td>
      <td class='text'  VALIGN='top'>The function template can be used as starting point for a new function.  Complete the template into a useful function like this:
<ul>
    <li>Rename the function</li>
    <li>Add proper description for the function and its arguments</li>
    <li>Fill in the function body</li>
    <li>Return desired values</li>
</ul></td>
    </tr>
    <tr>
      <td class='title' VALIGN='top'>Script:</td>
      <td class='text'  VALIGN='top'><span style='float:right;'>Download: <a href='BatchFunctionTmpl.bat'>BatchFunctionTmpl.bat</a>&nbsp;&nbsp;</span>    <table class='btchscr'><tr>
      <td class='numbrs' align='right' nowrap='nowrap'><code><a name='1'>1.</a><br><a name='2'>2.</a><br><a name='3'>3.</a><br><a name='4'>4.</a><br><a name='5'>5.</a><br><a name='6'>6.</a><br><a name='7'>7.</a><br><a name='8'>8.</a><br><a name='9'>9.</a><br><a name='10'>10.</a><br><a name='11'>11.</a><br></code></td>
      <td nowrap='nowrap' class='code'><code><span style='color=#000000'><span class=c_labl><a name='myFunctionName'>:myFunctionName</a></span><span class=c_cmmt>&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;function&nbsp;description&nbsp;here</span></span><br>
<span style='color=#000000'><span class=c_cmmt>::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;<span class=c_pvar>%~1</span>:&nbsp;argument&nbsp;description&nbsp;here</span></span><br>
<span style='color=#000000'>SETLOCAL</span><br>
<span style='color=#000000'><span class=c_cmmt>REM.--function&nbsp;body&nbsp;here</span></span><br>
<span style='color=#000000'>set&nbsp;LocalVar1=...</span><br>
<span style='color=#000000'>set&nbsp;LocalVar2=...</span><br>
<span style='color=#000000'>(ENDLOCAL&nbsp;&amp;&nbsp;<span class=c_cmmt>REM&nbsp;--&nbsp;RETURN&nbsp;VALUES</span></span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&quot;<span class=c_pvar>%~1</span>&quot;&nbsp;NEQ&nbsp;&quot;&quot;&nbsp;SET&nbsp;<span class=c_pvar>%~1</span>=%LocalVar1%</span><br>
<span style='color=#000000'>&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&quot;<span class=c_pvar>%~2</span>&quot;&nbsp;NEQ&nbsp;&quot;&quot;&nbsp;SET&nbsp;<span class=c_pvar>%~2</span>=%LocalVar2%</span><br>
<span style='color=#000000'>)</span><br>
<span style='color=#000000'>GOTO:EOF</span><br>
      </code></td>
    </tr></table>
</td>
    </tr>
  </table>
<br><br>
<!-- <a  href="https://www.amazon.com/gp/product/0692681310/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=0692681310&linkCode=as2&tag=dos01-20&linkId=55YDECJJE3E2RZBZ"><img border="0" src="https://ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=0692681310&Format=_SL250_&ID=AsinImage&MarketPlace=US&ServiceVersion=20070822&WS=1&tag=dos01-20" ></a><img src="https://ir-na.amazon-adsystem.com/e/ir?t=dos01-20&l=as2&o=1&a=0692681310" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" />
 -->
<a  href="https://www.amazon.com/gp/offer-listing/0692681310/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=0692681310&amp;linkCode=am2&amp;tag=dos01-20&amp;linkId=EM5WJJUFV5Z3RZTB"><img border="0" src="https://ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&amp;ASIN=0692681310&amp;Format=_SL250_&amp;ID=AsinImage&amp;MarketPlace=US&amp;ServiceVersion=20070822&amp;WS=1&amp;tag=dos01-20" ></a><img src="https://ir-na.amazon-adsystem.com/e/ir?t=dos01-20&amp;l=as2&amp;o=1&amp;a=0692681310" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" />
<div class='bot'>
<script type="text/javascript">
    /***********************************************
    * IFrame SSI script II- Copyright Dynamic Drive DHTML code library (http://www.dynamicdrive.com)
    * Visit DynamicDrive.com for hundreds of original DHTML scripts
    * This notice must stay intact for legal use
    ***********************************************/
    
    //Input the IDs of the IFRAMES you wish to dynamically resize to match its content height:
    //Separate each ID with a comma. Examples: ["myframe1", "myframe2"] or ["myframe"] or [] for none:
    var iframeids=["myframe"]
    
    //Should script hide iframe from browsers that don't support this script (non IE5+/NS6+ browsers. Recommended):
    var iframehide="yes"
    
    var getFFVersion=navigator.userAgent.substring(navigator.userAgent.indexOf("Firefox")).split("index.html")[1]
    var FFextraHeight=parseFloat(getFFVersion)>=0.1? 16 : 0 //extra height in px to add to iframe in FireFox 1.0+ browsers
    
    function resizeCaller() {
        var dyniframe=new Array()
        for (i=0; i<iframeids.length; i++){
            if (document.getElementById)
                resizeIframe(iframeids[i])
            //reveal iframe for lower end browsers? (see var above):
            if ((document.all || document.getElementById) && iframehide=="no"){
                var tempobj=document.all? document.all[iframeids[i]] : document.getElementById(iframeids[i])
                tempobj.style.display="block"
            }
        }
    }
    
    function resizeIframe(frameid){
        var currentfr=document.getElementById(frameid)
        if (currentfr && !window.opera){
            currentfr.style.display="block"
            if (currentfr.contentDocument && currentfr.contentDocument.body.offsetHeight) //ns6 syntax
                currentfr.height = currentfr.contentDocument.body.offsetHeight+FFextraHeight; 
            else if (currentfr.Document && currentfr.Document.body.scrollHeight) //ie5+ syntax
                currentfr.height = currentfr.Document.body.scrollHeight;
            if (currentfr.addEventListener)
                currentfr.addEventListener("load", readjustIframe, false)
            else if (currentfr.attachEvent){
                currentfr.detachEvent("onload", readjustIframe) // Bug fix line
                currentfr.attachEvent("onload", readjustIframe)
            }
        }
    }
    
    function readjustIframe(loadevt) {
        var crossevt=(window.event)? event : loadevt
        var iframeroot=(crossevt.currentTarget)? crossevt.currentTarget : crossevt.srcElement
        if (iframeroot)
            resizeIframe(iframeroot.id);
    }
    
    function loadintoIframe(iframeid, url){
        if (document.getElementById)
        document.getElementById(iframeid).src=url
    }
    
    if (window.addEventListener)
        window.addEventListener("load", resizeCaller, false)
    else if (window.attachEvent)
        window.attachEvent("onload", resizeCaller)
    else
        window.onload=resizeCaller
</script>
<iframe id="myframe" src="forum/viewforum4d6b.html?f=3"                  marginwidth="0" marginheight="0" frameborder="0" style="overflow:visible; " height=15000 width="100%" scrolling="no" ALLOWTRANSPARENCY="true"></iframe></div>

</body>

<!-- Mirrored from www.dostips.com/DtCodeCmdLib.php by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Oct 2018 03:23:52 GMT -->
</html>
